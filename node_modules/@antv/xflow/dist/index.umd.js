!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("react-dom"),require("lodash"),require("antd")):"function"==typeof define&&define.amd?define(["exports","react","react-dom","lodash","antd"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).XFlow={},e.React,e.ReactDOM,e.lodash,e.antd)}(this,(function(e,t,n,r,i){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var a=o(t),l=s(t),c=o(n),u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function h(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function d(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var f={},p={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NON_CUSTOM_TAG_KEYS=e.POST_CONSTRUCT=e.DESIGN_PARAM_TYPES=e.PARAM_TYPES=e.TAGGED_PROP=e.TAGGED=e.MULTI_INJECT_TAG=e.INJECT_TAG=e.OPTIONAL_TAG=e.UNMANAGED_TAG=e.NAME_TAG=e.NAMED_TAG=void 0,e.NAMED_TAG="named",e.NAME_TAG="name",e.UNMANAGED_TAG="unmanaged",e.OPTIONAL_TAG="optional",e.INJECT_TAG="inject",e.MULTI_INJECT_TAG="multi_inject",e.TAGGED="inversify:tagged",e.TAGGED_PROP="inversify:tagged_props",e.PARAM_TYPES="inversify:paramtypes",e.DESIGN_PARAM_TYPES="design:paramtypes",e.POST_CONSTRUCT="post_construct",e.NON_CUSTOM_TAG_KEYS=[e.INJECT_TAG,e.MULTI_INJECT_TAG,e.NAME_TAG,e.UNMANAGED_TAG,e.NAMED_TAG,e.OPTIONAL_TAG]}(p);var g={},m={},v={};Object.defineProperty(v,"__esModule",{value:!0}),v.TargetTypeEnum=v.BindingTypeEnum=v.BindingScopeEnum=void 0;v.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};v.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};v.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};var y={};Object.defineProperty(y,"__esModule",{value:!0}),y.id=void 0;var b=0;y.id=function(){return b++},Object.defineProperty(m,"__esModule",{value:!0}),m.Binding=void 0;var x=v,w=y,C=function(){function e(e,t){this.id=w.id(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=x.BindingTypeEnum.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===x.BindingScopeEnum.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}();m.Binding=C;var E={};Object.defineProperty(E,"__esModule",{value:!0}),E.STACK_OVERFLOW=E.CIRCULAR_DEPENDENCY_IN_FACTORY=E.POST_CONSTRUCT_ERROR=E.MULTIPLE_POST_CONSTRUCT_METHODS=E.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=E.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=E.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=E.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=E.ARGUMENTS_LENGTH_MISMATCH=E.INVALID_DECORATOR_OPERATION=E.INVALID_TO_SELF_VALUE=E.INVALID_FUNCTION_BINDING=E.INVALID_MIDDLEWARE_RETURN=E.NO_MORE_SNAPSHOTS_AVAILABLE=E.INVALID_BINDING_TYPE=E.NOT_IMPLEMENTED=E.CIRCULAR_DEPENDENCY=E.UNDEFINED_INJECT_ANNOTATION=E.MISSING_INJECT_ANNOTATION=E.MISSING_INJECTABLE_ANNOTATION=E.NOT_REGISTERED=E.CANNOT_UNBIND=E.AMBIGUOUS_MATCH=E.KEY_NOT_FOUND=E.NULL_ARGUMENT=E.DUPLICATED_METADATA=E.DUPLICATED_INJECTABLE_DECORATOR=void 0,E.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",E.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",E.NULL_ARGUMENT="NULL argument",E.KEY_NOT_FOUND="Key Not Found",E.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",E.CANNOT_UNBIND="Could not unbind serviceIdentifier:",E.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",E.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",E.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";E.UNDEFINED_INJECT_ANNOTATION=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},E.CIRCULAR_DEPENDENCY="Circular dependency found:",E.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",E.INVALID_BINDING_TYPE="Invalid binding type:",E.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",E.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",E.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",E.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",E.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";E.ARGUMENTS_LENGTH_MISMATCH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},E.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",E.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",E.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",E.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",E.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";E.POST_CONSTRUCT_ERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]};E.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."},E.STACK_OVERFLOW="Maximum call stack size exceeded";var _={};Object.defineProperty(_,"__esModule",{value:!0}),_.MetadataReader=void 0;var S=p,O=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(S.PARAM_TYPES,e),userGeneratedMetadata:Reflect.getMetadata(S.TAGGED,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(S.TAGGED_PROP,e)||[]},e}();_.MetadataReader=O;var A={},k={};Object.defineProperty(k,"__esModule",{value:!0}),k.BindingCount=void 0;k.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};var M={};Object.defineProperty(M,"__esModule",{value:!0}),M.isStackOverflowExeption=void 0;var T=E;M.isStackOverflowExeption=function(e){return e instanceof RangeError||e.message===T.STACK_OVERFLOW};var P={};Object.defineProperty(P,"__esModule",{value:!0}),P.circularDependencyToException=P.listMetadataForTarget=P.listRegisteredBindingsForServiceIdentifier=P.getServiceIdentifierAsString=P.getFunctionName=void 0;var D=E;function N(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function R(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||R(e.parentRequest,t))}function I(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}P.getServiceIdentifierAsString=N,P.listRegisteredBindingsForServiceIdentifier=function(e,t,n){var r="",i=n(e,t);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(e){var t="Object";null!==e.implementationType&&(t=I(e.implementationType)),r=r+"\n "+t,e.constraint.metaData&&(r=r+" - "+e.constraint.metaData)}))),r},P.circularDependencyToException=function e(t){t.childRequests.forEach((function(t){if(R(t,t.serviceIdentifier)){var n=function(e){var t=function e(t,n){void 0===n&&(n=[]);var r=N(t.serviceIdentifier);return n.push(r),null!==t.parentRequest?e(t.parentRequest,n):n}(e);return t.reverse().join(" --\x3e ")}(t);throw new Error(D.CIRCULAR_DEPENDENCY+" "+n)}e(t)}))},P.listMetadataForTarget=function(e,t){if(t.isTagged()||t.isNamed()){var n="",r=t.getNamedTag(),i=t.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e},P.getFunctionName=I;var j={};Object.defineProperty(j,"__esModule",{value:!0}),j.Context=void 0;var L=y,F=function(){function e(e){this.id=L.id(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}();j.Context=F;var G={};Object.defineProperty(G,"__esModule",{value:!0}),G.Metadata=void 0;var B=p,z=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===B.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}();G.Metadata=z;var U={};Object.defineProperty(U,"__esModule",{value:!0}),U.Plan=void 0;var V=function(e,t){this.parentContext=e,this.rootRequest=t};U.Plan=V;var H={},W={},$={};Object.defineProperty($,"__esModule",{value:!0}),$.tagProperty=$.tagParameter=$.decorate=void 0;var X=E,Y=p;function q(e,t,n,r,i){var o={},s="number"==typeof i,a=void 0!==i&&s?i.toString():n;if(s&&void 0!==n)throw new Error(X.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(e,t)&&(o=Reflect.getMetadata(e,t));var l=o[a];if(Array.isArray(l))for(var c=0,u=l;c<u.length;c++){var h=u[c];if(h.key===r.key)throw new Error(X.DUPLICATED_METADATA+" "+h.key.toString())}else l=[];l.push(r),o[a]=l,Reflect.defineMetadata(e,o,t)}function K(e,t){Reflect.decorate(e,t)}function Z(e,t){return function(n,r){t(n,r,e)}}$.tagParameter=function(e,t,n,r){q(Y.TAGGED,e,t,r,n)},$.tagProperty=function(e,t,n){q(Y.TAGGED_PROP,e.constructor,t,n)},$.decorate=function(e,t,n){"number"==typeof n?K([Z(n,e)],t):"string"==typeof n?Reflect.decorate([e],t,n):K([e],t)},Object.defineProperty(W,"__esModule",{value:!0}),W.inject=W.LazyServiceIdentifer=void 0;var J=E,Q=p,ee=G,te=$,ne=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}();W.LazyServiceIdentifer=ne,W.inject=function(e){return function(t,n,r){if(void 0===e)throw new Error(J.UNDEFINED_INJECT_ANNOTATION(t.name));var i=new ee.Metadata(Q.INJECT_TAG,e);"number"==typeof r?te.tagParameter(t,n,r,i):te.tagProperty(t,n,i)}};var re={},ie={};Object.defineProperty(ie,"__esModule",{value:!0}),ie.QueryableString=void 0;var oe=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}();ie.QueryableString=oe,Object.defineProperty(re,"__esModule",{value:!0}),re.Target=void 0;var se=p,ae=y,le=G,ce=ie,ue=function(){function e(e,t,n,r){this.id=ae.id(),this.type=e,this.serviceIdentifier=n,this.name=new ce.QueryableString(t||""),this.metadata=new Array;var i=null;"string"==typeof r?i=new le.Metadata(se.NAMED_TAG,r):r instanceof le.Metadata&&(i=r),null!==i&&this.metadata.push(i)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(se.MULTI_INJECT_TAG)},e.prototype.matchesArray=function(e){return this.matchesTag(se.MULTI_INJECT_TAG)(e)},e.prototype.isNamed=function(){return this.hasTag(se.NAMED_TAG)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return se.NON_CUSTOM_TAG_KEYS.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(se.OPTIONAL_TAG)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===se.NAMED_TAG}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return se.NON_CUSTOM_TAG_KEYS.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(se.NAMED_TAG)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var r=0,i=t.metadata;r<i.length;r++){var o=i[r];if(o.key===e&&o.value===n)return!0}return!1}},e}();re.Target=ue,function(e){var t=u&&u.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(e,"__esModule",{value:!0}),e.getFunctionName=e.getBaseClassDependencyCount=e.getDependencies=void 0;var n=W,r=E,i=v,o=p,s=P;Object.defineProperty(e,"getFunctionName",{enumerable:!0,get:function(){return s.getFunctionName}});var a=re;function l(e,n,i,o){var s=e.getConstructorMetadata(i),a=s.compilerGeneratedMetadata;if(void 0===a){var l=r.MISSING_INJECTABLE_ANNOTATION+" "+n+".";throw new Error(l)}var u=s.userGeneratedMetadata,d=Object.keys(u),f=0===i.length&&d.length>0,p=d.length>i.length,g=function(e,t,n,r,i){for(var o=[],s=0;s<i;s++){var a=c(s,e,t,n,r);null!==a&&o.push(a)}return o}(o,n,a,u,f||p?d.length:i.length),m=h(e,i);return t(t([],g),m)}function c(e,t,o,s,l){var c=l[e.toString()]||[],u=d(c),h=!0!==u.unmanaged,f=s[e],p=u.inject||u.multiInject;if((f=p||f)instanceof n.LazyServiceIdentifer&&(f=f.unwrap()),h){if(!t&&(f===Object||f===Function||void 0===f)){var g=r.MISSING_INJECT_ANNOTATION+" argument "+e+" in class "+o+".";throw new Error(g)}var m=new a.Target(i.TargetTypeEnum.ConstructorArgument,u.targetName,f);return m.metadata=c,m}return null}function h(e,n){for(var r=e.getPropertiesMetadata(n),o=[],s=0,l=Object.keys(r);s<l.length;s++){var c=l[s],u=r[c],f=d(r[c]),p=f.targetName||c,g=f.inject||f.multiInject,m=new a.Target(i.TargetTypeEnum.ClassProperty,p,g);m.metadata=u,o.push(m)}var v=Object.getPrototypeOf(n.prototype).constructor;if(v!==Object){var y=h(e,v);o=t(t([],o),y)}return o}function d(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[o.INJECT_TAG],multiInject:t[o.MULTI_INJECT_TAG],targetName:t[o.NAME_TAG],unmanaged:t[o.UNMANAGED_TAG]}}e.getDependencies=function(e,t){return l(e,s.getFunctionName(t),t,!1)},e.getBaseClassDependencyCount=function e(t,n){var r=Object.getPrototypeOf(n.prototype).constructor;if(r!==Object){var i=l(t,s.getFunctionName(r),r,!0),a=i.map((function(e){return e.metadata.filter((function(e){return e.key===o.UNMANAGED_TAG}))})),c=[].concat.apply([],a).length,u=i.length-c;return u>0?u:e(t,r)}return 0}}(H);var he={};Object.defineProperty(he,"__esModule",{value:!0}),he.Request=void 0;var de=y,fe=function(){function e(e,t,n,r,i){this.id=de.id(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=i,this.childRequests=[],this.bindings=Array.isArray(r)?r:[r],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,r){var i=new e(t,this.parentContext,this,n,r);return this.childRequests.push(i),i},e}();he.Request=fe,Object.defineProperty(A,"__esModule",{value:!0}),A.getBindingDictionary=A.createMockRequest=A.plan=void 0;var pe=k,ge=E,me=v,ve=p,ye=M,be=P,xe=j,we=G,Ce=U,Ee=H,_e=he,Se=re;function Oe(e){return e._bindingDictionary}function Ae(e,t,n,r,i){var o=Me(n.container,i.serviceIdentifier),s=[];return o.length===pe.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof i.serviceIdentifier&&e.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(i.serviceIdentifier).toSelf(),o=Me(n.container,i.serviceIdentifier)),s=t?o:o.filter((function(e){var t=new _e.Request(e.serviceIdentifier,n,r,e,i);return e.constraint(t)})),function(e,t,n,r){switch(t.length){case pe.BindingCount.NoBindingsAvailable:if(n.isOptional())return t;var i=be.getServiceIdentifierAsString(e),o=ge.NOT_REGISTERED;throw o+=be.listMetadataForTarget(i,n),o+=be.listRegisteredBindingsForServiceIdentifier(r,i,Me),new Error(o);case pe.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return t;case pe.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return t;i=be.getServiceIdentifierAsString(e),o=ge.AMBIGUOUS_MATCH+" "+i;throw o+=be.listRegisteredBindingsForServiceIdentifier(r,i,Me),new Error(o)}}(i.serviceIdentifier,s,i,n.container),s}function ke(e,t,n,r,i,o){var s,a;if(null===i){s=Ae(e,t,r,null,o),a=new _e.Request(n,r,null,s,o);var l=new Ce.Plan(r,a);r.addPlan(l)}else s=Ae(e,t,r,i,o),a=i.addChildRequest(o.serviceIdentifier,s,o);s.forEach((function(t){var n=null;if(o.isArray())n=a.addChildRequest(t.serviceIdentifier,t,o);else{if(t.cache)return;n=a}if(t.type===me.BindingTypeEnum.Instance&&null!==t.implementationType){var i=Ee.getDependencies(e,t.implementationType);if(!r.container.options.skipBaseClassChecks){var s=Ee.getBaseClassDependencyCount(e,t.implementationType);if(i.length<s){var l=ge.ARGUMENTS_LENGTH_MISMATCH(Ee.getFunctionName(t.implementationType));throw new Error(l)}}i.forEach((function(t){ke(e,!1,t.serviceIdentifier,r,n,t)}))}}))}function Me(e,t){var n=[],r=Oe(e);return r.hasKey(t)?n=r.get(t):null!==e.parent&&(n=Me(e.parent,t)),n}A.getBindingDictionary=Oe,A.plan=function(e,t,n,r,i,o,s,a){void 0===a&&(a=!1);var l=new xe.Context(t),c=function(e,t,n,r,i,o){var s=e?ve.MULTI_INJECT_TAG:ve.INJECT_TAG,a=new we.Metadata(s,n),l=new Se.Target(t,r,n,a);if(void 0!==i){var c=new we.Metadata(i,o);l.metadata.push(c)}return l}(n,r,i,"",o,s);try{return ke(e,a,i,l,null,c),l}catch(e){throw ye.isStackOverflowExeption(e)&&l.plan&&be.circularDependencyToException(l.plan.rootRequest),e}},A.createMockRequest=function(e,t,n,r){var i=new Se.Target(me.TargetTypeEnum.Variable,"",t,new we.Metadata(n,r)),o=new xe.Context(e);return new _e.Request(t,o,null,[],i)};var Te={},Pe={},De=u&&u.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.resolveInstance=void 0;var Ne=E,Re=v,Ie=p;Pe.resolveInstance=function(e,t,n){var r,i,o=null;if(t.length>0){var s=t.filter((function(e){return null!==e.target&&e.target.type===Re.TargetTypeEnum.ConstructorArgument})).map(n);i=s,o=function(e,t,n){var r=t.filter((function(e){return null!==e.target&&e.target.type===Re.TargetTypeEnum.ClassProperty})),i=r.map(n);return r.forEach((function(t,n){var r;r=t.target.name.value();var o=i[n];e[r]=o})),e}(o=new((r=e).bind.apply(r,De([void 0],i))),t,n)}else o=new e;return function(e,t){if(Reflect.hasMetadata(Ie.POST_CONSTRUCT,e)){var n=Reflect.getMetadata(Ie.POST_CONSTRUCT,e);try{t[n.value]()}catch(t){throw new Error(Ne.POST_CONSTRUCT_ERROR(e.name,t.message))}}}(e,o),o},Object.defineProperty(Te,"__esModule",{value:!0}),Te.resolve=void 0;var je=E,Le=v,Fe=M,Ge=P,Be=Pe,ze=function(e,t,n){try{return n()}catch(n){throw Fe.isStackOverflowExeption(n)?new Error(je.CIRCULAR_DEPENDENCY_IN_FACTORY(e,t.toString())):n}},Ue=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,r=t.childRequests,i=t.target&&t.target.isArray(),o=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(i&&o)return r.map((function(t){return Ue(e)(t)}));var s=null;if(!t.target.isOptional()||0!==n.length){var a=n[0],l=a.scope===Le.BindingScopeEnum.Singleton,c=a.scope===Le.BindingScopeEnum.Request;if(l&&a.activated)return a.cache;if(c&&null!==e&&e.has(a.id))return e.get(a.id);if(a.type===Le.BindingTypeEnum.ConstantValue)s=a.cache,a.activated=!0;else if(a.type===Le.BindingTypeEnum.Function)s=a.cache,a.activated=!0;else if(a.type===Le.BindingTypeEnum.Constructor)s=a.implementationType;else if(a.type===Le.BindingTypeEnum.DynamicValue&&null!==a.dynamicValue)s=ze("toDynamicValue",a.serviceIdentifier,(function(){return a.dynamicValue(t.parentContext)}));else if(a.type===Le.BindingTypeEnum.Factory&&null!==a.factory)s=ze("toFactory",a.serviceIdentifier,(function(){return a.factory(t.parentContext)}));else if(a.type===Le.BindingTypeEnum.Provider&&null!==a.provider)s=ze("toProvider",a.serviceIdentifier,(function(){return a.provider(t.parentContext)}));else{if(a.type!==Le.BindingTypeEnum.Instance||null===a.implementationType){var u=Ge.getServiceIdentifierAsString(t.serviceIdentifier);throw new Error(je.INVALID_BINDING_TYPE+" "+u)}s=Be.resolveInstance(a.implementationType,r,Ue(e))}return"function"==typeof a.onActivation&&(s=a.onActivation(t.parentContext,s)),l&&(a.cache=s,a.activated=!0),c&&null!==e&&!e.has(a.id)&&e.set(a.id,s),s}}};Te.resolve=function(e){return Ue(e.plan.rootRequest.requestScope)(e.plan.rootRequest)};var Ve={},He={},We={},$e={},Xe={},Ye={},qe={};Object.defineProperty(qe,"__esModule",{value:!0}),qe.typeConstraint=qe.namedConstraint=qe.taggedConstraint=qe.traverseAncerstors=void 0;var Ke=p,Ze=G,Je=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||Je(n,t))};qe.traverseAncerstors=Je;var Qe=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new Ze.Metadata(e,t),n}};qe.taggedConstraint=Qe;var et=Qe(Ke.NAMED_TAG);qe.namedConstraint=et;qe.typeConstraint=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var r=t.bindings[0].implementationType;return e===r}return!1}},Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.BindingWhenSyntax=void 0;var tt=Xe,nt=qe,rt=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new tt.BindingOnSyntax(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=nt.namedConstraint(e),new tt.BindingOnSyntax(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new tt.BindingOnSyntax(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=nt.taggedConstraint(e)(t),new tt.BindingOnSyntax(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return nt.typeConstraint(e)(t.parentRequest)},new tt.BindingOnSyntax(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return nt.namedConstraint(e)(t.parentRequest)},new tt.BindingOnSyntax(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return nt.taggedConstraint(e)(t)(n.parentRequest)},new tt.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return nt.traverseAncerstors(t,nt.typeConstraint(e))},new tt.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!nt.traverseAncerstors(t,nt.typeConstraint(e))},new tt.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return nt.traverseAncerstors(t,nt.namedConstraint(e))},new tt.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!nt.traverseAncerstors(t,nt.namedConstraint(e))},new tt.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return nt.traverseAncerstors(n,nt.taggedConstraint(e)(t))},new tt.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return!nt.traverseAncerstors(n,nt.taggedConstraint(e)(t))},new tt.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return nt.traverseAncerstors(t,e)},new tt.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!nt.traverseAncerstors(t,e)},new tt.BindingOnSyntax(this._binding)},e}();Ye.BindingWhenSyntax=rt,Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.BindingOnSyntax=void 0;var it=Ye,ot=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new it.BindingWhenSyntax(this._binding)},e}();Xe.BindingOnSyntax=ot,Object.defineProperty($e,"__esModule",{value:!0}),$e.BindingWhenOnSyntax=void 0;var st=Xe,at=Ye,lt=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new at.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new st.BindingOnSyntax(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();$e.BindingWhenOnSyntax=lt,Object.defineProperty(We,"__esModule",{value:!0}),We.BindingInSyntax=void 0;var ct=v,ut=$e,ht=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=ct.BindingScopeEnum.Request,new ut.BindingWhenOnSyntax(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=ct.BindingScopeEnum.Singleton,new ut.BindingWhenOnSyntax(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=ct.BindingScopeEnum.Transient,new ut.BindingWhenOnSyntax(this._binding)},e}();We.BindingInSyntax=ht,Object.defineProperty(He,"__esModule",{value:!0}),He.BindingInWhenOnSyntax=void 0;var dt=We,ft=Xe,pt=Ye,gt=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new pt.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new ft.BindingOnSyntax(this._binding),this._bindingInSyntax=new dt.BindingInSyntax(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();He.BindingInWhenOnSyntax=gt,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.BindingToSyntax=void 0;var mt=E,vt=v,yt=He,bt=$e,xt=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=vt.BindingTypeEnum.Instance,this._binding.implementationType=e,new yt.BindingInWhenOnSyntax(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+mt.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=vt.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=vt.BindingScopeEnum.Singleton,new bt.BindingWhenOnSyntax(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=vt.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new yt.BindingInWhenOnSyntax(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=vt.BindingTypeEnum.Constructor,this._binding.implementationType=e,this._binding.scope=vt.BindingScopeEnum.Singleton,new bt.BindingWhenOnSyntax(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=vt.BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=vt.BindingScopeEnum.Singleton,new bt.BindingWhenOnSyntax(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(mt.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=vt.BindingTypeEnum.Function,this._binding.scope=vt.BindingScopeEnum.Singleton,t},e.prototype.toAutoFactory=function(e){return this._binding.type=vt.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=vt.BindingScopeEnum.Singleton,new bt.BindingWhenOnSyntax(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=vt.BindingTypeEnum.Provider,this._binding.provider=e,this._binding.scope=vt.BindingScopeEnum.Singleton,new bt.BindingWhenOnSyntax(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}();Ve.BindingToSyntax=xt;var wt={};Object.defineProperty(wt,"__esModule",{value:!0}),wt.ContainerSnapshot=void 0;var Ct=function(){function e(){}return e.of=function(t,n){var r=new e;return r.bindings=t,r.middleware=n,r},e}();wt.ContainerSnapshot=Ct;var Et={};Object.defineProperty(Et,"__esModule",{value:!0}),Et.Lookup=void 0;var _t=E,St=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(_t.NULL_ARGUMENT);if(null==t)throw new Error(_t.NULL_ARGUMENT);var n=this._map.get(e);void 0!==n?(n.push(t),this._map.set(e,n)):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(_t.NULL_ARGUMENT);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(_t.KEY_NOT_FOUND)},e.prototype.remove=function(e){if(null==e)throw new Error(_t.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(_t.KEY_NOT_FOUND)},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(n,r){var i=n.filter((function(t){return!e(t)}));i.length>0?t._map.set(r,i):t._map.delete(r)}))},e.prototype.hasKey=function(e){if(null==e)throw new Error(_t.NULL_ARGUMENT);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e}();Et.Lookup=St;var Ot=u&&u.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},At=u&&u.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},kt=u&&u.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(g,"__esModule",{value:!0}),g.Container=void 0;var Mt=m,Tt=E,Pt=v,Dt=p,Nt=_,Rt=A,It=Te,jt=Ve,Lt=y,Ft=P,Gt=wt,Bt=Et,zt=function(){function e(e){this._appliedMiddleware=[];var t=e||{};if("object"!=typeof t)throw new Error(""+Tt.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===t.defaultScope)t.defaultScope=Pt.BindingScopeEnum.Transient;else if(t.defaultScope!==Pt.BindingScopeEnum.Singleton&&t.defaultScope!==Pt.BindingScopeEnum.Transient&&t.defaultScope!==Pt.BindingScopeEnum.Request)throw new Error(""+Tt.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+Tt.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+Tt.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=Lt.id(),this._bindingDictionary=new Bt.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new Nt.MetadataReader}return e.merge=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=new e,s=kt([t,n],r).map((function(e){return Rt.getBindingDictionary(e)})),a=Rt.getBindingDictionary(o);function l(e,t){e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}return s.forEach((function(e){l(e,a)})),o},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=e;r<i.length;r++){var o=i[r],s=n(o.id);o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ot(this,void 0,void 0,(function(){var t,n,r,i,o;return At(this,(function(s){switch(s.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,r=e,s.label=1;case 1:return n<r.length?(i=r[n],o=t(i.id),[4,i.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction)]):[3,4];case 2:s.sent(),s.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(e){return function(t){return t.moduleId===e}};t.forEach((function(t){var n=r(t.id);e._bindingDictionary.removeByCondition(n)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||Pt.BindingScopeEnum.Transient,n=new Mt.Binding(e,t);return this._bindingDictionary.add(e,n),new jt.BindingToSyntax(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(Tt.CANNOT_UNBIND+" "+Ft.getServiceIdentifierAsString(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new Bt.Lookup},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,Dt.NAMED_TAG,t)},e.prototype.isBoundTagged=function(e,t,n){var r=!1;if(this._bindingDictionary.hasKey(e)){var i=this._bindingDictionary.get(e),o=Rt.createMockRequest(this,e,t,n);r=i.some((function(e){return e.constraint(o)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(e,t,n)),r},e.prototype.snapshot=function(){this._snapshots.push(Gt.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(Tt.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._appliedMiddleware=this._appliedMiddleware.concat(e);var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,Pt.TargetTypeEnum.Variable,e)},e.prototype.getTagged=function(e,t,n){return this._get(!1,!1,Pt.TargetTypeEnum.Variable,e,t,n)},e.prototype.getNamed=function(e,t){return this.getTagged(e,Dt.NAMED_TAG,t)},e.prototype.getAll=function(e){return this._get(!0,!0,Pt.TargetTypeEnum.Variable,e)},e.prototype.getAllTagged=function(e,t,n){return this._get(!1,!0,Pt.TargetTypeEnum.Variable,e,t,n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,Dt.NAMED_TAG,t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),this._appliedMiddleware.forEach((function(e){t.applyMiddleware(e)})),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(r){var i=e.rebind.bind(e)(r);return t(i,n),i}};return function(r){return{bindFunction:(i=r,function(n){var r=e.bind.bind(e)(n);return t(r,i),r}),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:n(r),unbindFunction:function(t){e.unbind.bind(e)(t)}};var i}},e.prototype._get=function(e,t,n,r,i,o){var s=null,a={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:i,serviceIdentifier:r,targetType:n,value:o};if(this._middleware){if(null==(s=this._middleware(a)))throw new Error(Tt.INVALID_MIDDLEWARE_RETURN)}else s=this._planAndResolve()(a);return s},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=Rt.plan(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return n=t.contextInterceptor(n),It.resolve(n)}},e}();g.Container=zt;var Ut={};Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.AsyncContainerModule=Ut.ContainerModule=void 0;var Vt=y,Ht=function(e){this.id=Vt.id(),this.registry=e};Ut.ContainerModule=Ht;var Wt=function(e){this.id=Vt.id(),this.registry=e};Ut.AsyncContainerModule=Wt;var $t={};Object.defineProperty($t,"__esModule",{value:!0}),$t.injectable=void 0;var Xt=E,Yt=p;$t.injectable=function(){return function(e){if(Reflect.hasOwnMetadata(Yt.PARAM_TYPES,e))throw new Error(Xt.DUPLICATED_INJECTABLE_DECORATOR);var t=Reflect.getMetadata(Yt.DESIGN_PARAM_TYPES,e)||[];return Reflect.defineMetadata(Yt.PARAM_TYPES,t,e),e}};var qt={};Object.defineProperty(qt,"__esModule",{value:!0}),qt.tagged=void 0;var Kt=G,Zt=$;qt.tagged=function(e,t){return function(n,r,i){var o=new Kt.Metadata(e,t);"number"==typeof i?Zt.tagParameter(n,r,i,o):Zt.tagProperty(n,r,o)}};var Jt={};Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.named=void 0;var Qt=p,en=G,tn=$;Jt.named=function(e){return function(t,n,r){var i=new en.Metadata(Qt.NAMED_TAG,e);"number"==typeof r?tn.tagParameter(t,n,r,i):tn.tagProperty(t,n,i)}};var nn={};Object.defineProperty(nn,"__esModule",{value:!0}),nn.optional=void 0;var rn=p,on=G,sn=$;nn.optional=function(){return function(e,t,n){var r=new on.Metadata(rn.OPTIONAL_TAG,!0);"number"==typeof n?sn.tagParameter(e,t,n,r):sn.tagProperty(e,t,r)}};var an={};Object.defineProperty(an,"__esModule",{value:!0}),an.unmanaged=void 0;var ln=p,cn=G,un=$;an.unmanaged=function(){return function(e,t,n){var r=new cn.Metadata(ln.UNMANAGED_TAG,!0);un.tagParameter(e,t,n,r)}};var hn={};Object.defineProperty(hn,"__esModule",{value:!0}),hn.multiInject=void 0;var dn=p,fn=G,pn=$;hn.multiInject=function(e){return function(t,n,r){var i=new fn.Metadata(dn.MULTI_INJECT_TAG,e);"number"==typeof r?pn.tagParameter(t,n,r,i):pn.tagProperty(t,n,i)}};var gn={};Object.defineProperty(gn,"__esModule",{value:!0}),gn.targetName=void 0;var mn=p,vn=G,yn=$;gn.targetName=function(e){return function(t,n,r){var i=new vn.Metadata(mn.NAME_TAG,e);yn.tagParameter(t,n,r,i)}};var bn={};Object.defineProperty(bn,"__esModule",{value:!0}),bn.postConstruct=void 0;var xn=E,wn=p,Cn=G;bn.postConstruct=function(){return function(e,t,n){var r=new Cn.Metadata(wn.POST_CONSTRUCT,t);if(Reflect.hasOwnMetadata(wn.POST_CONSTRUCT,e.constructor))throw new Error(xn.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(wn.POST_CONSTRUCT,r,e.constructor)}};var En={};Object.defineProperty(En,"__esModule",{value:!0}),En.multiBindToService=void 0;var _n,Sn,On;function An(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?An(Object(n),!0).forEach((function(t){Nn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):An(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mn(e){return Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mn(e)}function Tn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dn(e,t,n){return t&&Pn(e.prototype,t),n&&Pn(e,n),e}function Nn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rn(e){return function(e){if(Array.isArray(e))return In(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return In(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return In(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}
/*! *****************************************************************************
	Copyright (C) Microsoft. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */()}function In(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jn(e,t){return t.lifecycle===Sn.Lifecycle.singleton?function(e){return e.inSingletonScope()}(e):function(e){return e.inTransientScope()}(e)}function Ln(e,t){e.whenTargetNamed(Bn(t))}function Fn(e,t){return t.container.bind(zn(e))}function Gn(e,t){var n=t.container.parent,r=n&&n.isBound(zn(e));return t.container.isBound(zn(e))&&!r?t.container.rebind(zn(e)):t.container.bind(zn(e))}function Bn(e){return On.isDefinedToken(e)?e.symbol:e}function zn(e){return On.isDefinedToken(e)?e.symbol:e}En.multiBindToService=function(e){return function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach((function(n){return e.bind(n).toService(t)}))}}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.multiBindToService=e.getServiceIdentifierAsString=e.typeConstraint=e.namedConstraint=e.taggedConstraint=e.traverseAncerstors=e.decorate=e.id=e.MetadataReader=e.postConstruct=e.targetName=e.multiInject=e.unmanaged=e.optional=e.LazyServiceIdentifer=e.inject=e.named=e.tagged=e.injectable=e.ContainerModule=e.AsyncContainerModule=e.TargetTypeEnum=e.BindingTypeEnum=e.BindingScopeEnum=e.Container=e.METADATA_KEY=void 0;var t=p;e.METADATA_KEY=t;var n=g;Object.defineProperty(e,"Container",{enumerable:!0,get:function(){return n.Container}});var r=v;Object.defineProperty(e,"BindingScopeEnum",{enumerable:!0,get:function(){return r.BindingScopeEnum}}),Object.defineProperty(e,"BindingTypeEnum",{enumerable:!0,get:function(){return r.BindingTypeEnum}}),Object.defineProperty(e,"TargetTypeEnum",{enumerable:!0,get:function(){return r.TargetTypeEnum}});var i=Ut;Object.defineProperty(e,"AsyncContainerModule",{enumerable:!0,get:function(){return i.AsyncContainerModule}}),Object.defineProperty(e,"ContainerModule",{enumerable:!0,get:function(){return i.ContainerModule}});var o=$t;Object.defineProperty(e,"injectable",{enumerable:!0,get:function(){return o.injectable}});var s=qt;Object.defineProperty(e,"tagged",{enumerable:!0,get:function(){return s.tagged}});var a=Jt;Object.defineProperty(e,"named",{enumerable:!0,get:function(){return a.named}});var l=W;Object.defineProperty(e,"inject",{enumerable:!0,get:function(){return l.inject}}),Object.defineProperty(e,"LazyServiceIdentifer",{enumerable:!0,get:function(){return l.LazyServiceIdentifer}});var c=nn;Object.defineProperty(e,"optional",{enumerable:!0,get:function(){return c.optional}});var u=an;Object.defineProperty(e,"unmanaged",{enumerable:!0,get:function(){return u.unmanaged}});var h=hn;Object.defineProperty(e,"multiInject",{enumerable:!0,get:function(){return h.multiInject}});var d=gn;Object.defineProperty(e,"targetName",{enumerable:!0,get:function(){return d.targetName}});var f=bn;Object.defineProperty(e,"postConstruct",{enumerable:!0,get:function(){return f.postConstruct}});var m=_;Object.defineProperty(e,"MetadataReader",{enumerable:!0,get:function(){return m.MetadataReader}});var b=y;Object.defineProperty(e,"id",{enumerable:!0,get:function(){return b.id}});var x=$;Object.defineProperty(e,"decorate",{enumerable:!0,get:function(){return x.decorate}});var w=qe;Object.defineProperty(e,"traverseAncerstors",{enumerable:!0,get:function(){return w.traverseAncerstors}}),Object.defineProperty(e,"taggedConstraint",{enumerable:!0,get:function(){return w.taggedConstraint}}),Object.defineProperty(e,"namedConstraint",{enumerable:!0,get:function(){return w.namedConstraint}}),Object.defineProperty(e,"typeConstraint",{enumerable:!0,get:function(){return w.typeConstraint}});var C=P;Object.defineProperty(e,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return C.getServiceIdentifierAsString}});var E=En;Object.defineProperty(e,"multiBindToService",{enumerable:!0,get:function(){return E.multiBindToService}})}(f),function(e){!function(t){var n="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=i(e);function i(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===n.Reflect?n.Reflect=e:r=i(n.Reflect,r),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,s={__proto__:[]}instanceof Array,a=!o&&!s,l={create:o?function(){return re(Object.create(null))}:s?function(){return re({__proto__:null})}:function(){return re({})},has:a?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:a?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),u="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,d=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,f=new(u||"function"!=typeof WeakMap?ne():WeakMap);function p(e,t,n,r){if(I(n)){if(!H(e))throw new TypeError;if(!$(t))throw new TypeError;return _(e,t)}if(!H(e))throw new TypeError;if(!F(t))throw new TypeError;if(!F(r)&&!I(r)&&!j(r))throw new TypeError;return j(r)&&(r=void 0),S(e,t,n=V(n),r)}function g(e,t){function n(n,r){if(!F(n))throw new TypeError;if(!I(r)&&!X(r))throw new TypeError;P(e,t,n,r)}return n}function m(e,t,n,r){if(!F(n))throw new TypeError;return I(r)||(r=V(r)),P(e,t,n,r)}function v(e,t,n){if(!F(t))throw new TypeError;return I(n)||(n=V(n)),A(e,t,n)}function y(e,t,n){if(!F(t))throw new TypeError;return I(n)||(n=V(n)),k(e,t,n)}function b(e,t,n){if(!F(t))throw new TypeError;return I(n)||(n=V(n)),M(e,t,n)}function x(e,t,n){if(!F(t))throw new TypeError;return I(n)||(n=V(n)),T(e,t,n)}function w(e,t){if(!F(e))throw new TypeError;return I(t)||(t=V(t)),D(e,t)}function C(e,t){if(!F(e))throw new TypeError;return I(t)||(t=V(t)),N(e,t)}function E(e,t,n){if(!F(t))throw new TypeError;I(n)||(n=V(n));var r=O(t,n,!1);if(I(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=f.get(t);return i.delete(n),i.size>0||f.delete(t),!0}function _(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!I(r)&&!j(r)){if(!$(r))throw new TypeError;t=r}}return t}function S(e,t,n,r){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,n,r);if(!I(o)&&!j(o)){if(!F(o))throw new TypeError;r=o}}return r}function O(e,t,n){var r=f.get(e);if(I(r)){if(!n)return;r=new h,f.set(e,r)}var i=r.get(t);if(I(i)){if(!n)return;i=new h,r.set(t,i)}return i}function A(e,t,n){if(k(e,t,n))return!0;var r=Q(t);return!j(r)&&A(e,r,n)}function k(e,t,n){var r=O(t,n,!1);return!I(r)&&z(r.has(e))}function M(e,t,n){if(k(e,t,n))return T(e,t,n);var r=Q(t);return j(r)?void 0:M(e,r,n)}function T(e,t,n){var r=O(t,n,!1);if(!I(r))return r.get(e)}function P(e,t,n,r){O(n,r,!0).set(e,t)}function D(e,t){var n=N(e,t),r=Q(e);if(null===r)return n;var i=D(r,t);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new d,s=[],a=0,l=n;a<l.length;a++){var c=l[a];o.has(c)||(o.add(c),s.push(c))}for(var u=0,h=i;u<h.length;u++){c=h[u];o.has(c)||(o.add(c),s.push(c))}return s}function N(e,t){var n=[],r=O(e,t,!1);if(I(r))return n;for(var i=q(r.keys()),o=0;;){var s=Z(i);if(!s)return n.length=o,n;var a=K(s);try{n[o]=a}catch(e){try{J(i)}finally{throw e}}o++}}function R(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function I(e){return void 0===e}function j(e){return null===e}function L(e){return"symbol"==typeof e}function F(e){return"object"==typeof e?null!==e:"function"==typeof e}function G(e,t){switch(R(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",i=Y(e,r);if(void 0!==i){var o=i.call(e,n);if(F(o))throw new TypeError;return o}return B(e,"default"===n?"number":n)}function B(e,t){if("string"===t){var n=e.toString;if(W(n))if(!F(i=n.call(e)))return i;if(W(r=e.valueOf))if(!F(i=r.call(e)))return i}else{var r;if(W(r=e.valueOf))if(!F(i=r.call(e)))return i;var i,o=e.toString;if(W(o))if(!F(i=o.call(e)))return i}throw new TypeError}function z(e){return!!e}function U(e){return""+e}function V(e){var t=G(e,3);return L(t)?t:U(t)}function H(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function W(e){return"function"==typeof e}function $(e){return"function"==typeof e}function X(e){switch(R(e)){case 3:case 4:return!0;default:return!1}}function Y(e,t){var n=e[t];if(null!=n){if(!W(n))throw new TypeError;return n}}function q(e){var t=Y(e,i);if(!W(t))throw new TypeError;var n=t.call(e);if(!F(n))throw new TypeError;return n}function K(e){return e.value}function Z(e){var t=e.next();return!t.done&&t}function J(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c)return t;if(t!==c)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!=typeof i||i===e?t:i}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,o)},t.prototype.entries=function(){return new n(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function o(e,t){return t}function s(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function ne(){var e=16,n=l.create(),r=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+c()}while(l.has(n,e));return n[e]=!0,e}function o(e,n){if(!t.call(e,r)){if(!n)return;Object.defineProperty(e,r,{value:l.create()})}return e[r]}function s(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e)}function c(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var i=t[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}function re(e){return e.__=void 0,delete e.__,e}e("decorate",p),e("metadata",g),e("defineMetadata",m),e("hasMetadata",v),e("hasOwnMetadata",y),e("getMetadata",b),e("getOwnMetadata",x),e("getMetadataKeys",w),e("getOwnMetadataKeys",C),e("deleteMetadata",E)}(r)}()}(_n||(_n={})),function(e){e.defineToken=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{multiple:!0};return new e.DefinedToken(t,n)};var t;e.DefinedToken=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Tn(this,e),this.prototype={},this.name=void 0,this.multiple=void 0,this.symbol=void 0;var r=n.multiple,i=void 0!==r&&r;this.name=t,this.symbol=Symbol(this.name),this.multiple=i},e.isModule=function(e){return!!e&&"object"===Mn(e)&&"id"in e&&"registry"in e},function(e){e.singleton="singleton",e.transient="transient"}(t=e.Lifecycle||(e.Lifecycle={})),e.ClassOptionSymbol=Symbol("SyringeClassOptionSymbol"),e.DefaultOption={lifecycle:t.transient}}(Sn||(Sn={})),function(e){e.maybeArrayToArray=function(e){return e instanceof Array?e:void 0!==e?[e]:[]},e.isClass=function(e){return!(!e||"function"!=typeof e||!("prototype"in e))},e.isDefinedToken=function(e){return!!(e&&"object"===Mn(e)&&"symbol"in e&&"multiple"in e)},e.isInjectOption=function(e){return!(!e||"object"!==Mn(e)||!("token"in e))},e.isNamedToken=function(e){return!!(e&&"object"===Mn(e)&&"token"in e&&"named"in e)},e.isMultipleEnabled=function(t){return e.isDefinedToken(t)&&t.multiple}}(On||(On={}));var Un=new f.Container;function Vn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=f.injectable();return function(n){Reflect.defineMetadata(Sn.ClassOptionSymbol,kn(kn({},e),{},{target:n}),n),t(n)}}function Hn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Vn(kn(kn({},e),{},{lifecycle:Sn.Lifecycle.singleton}))}function Wn(e){return f.inject(zn(e))}function $n(e){return f.named(Bn(e))}var Xn=Symbol("SyringeOptionSymbol");var Yn=function(){function e(t,n,r){Tn(this,e),this.token=void 0,this.rawToken=void 0,this.named=void 0,this.generalToken=void 0,this.option=void 0,this.context=void 0,this.mutiple=void 0,this.context=t,this.token=n,this.option=r,this.rawToken=On.isNamedToken(n)?n.token:n,this.named=On.isNamedToken(n)?n.named:void 0,this.mutiple=!!this.named||On.isMultipleEnabled(this.rawToken),this.generalToken=this.rawToken}return Dn(e,[{key:"resolve",value:function(){var e,t=this,n=this.context;(e=n)&&"object"===Mn(e)&&"container"in e&&"inversify"in e&&(this.mutiple?this.resolveMutilple(n):(this.resolveMono(n),!this.named&&this.option.contrib.length>0&&this.option.contrib.forEach((function(e){On.isMultipleEnabled(e)?Fn(e,n).toService(t.generalToken):Gn(e,n).toService(t.generalToken)}))))}},{key:"resolveMono",value:function(e){var t=this;if("useValue"in this.option)return Gn(this.generalToken,e).toConstantValue(this.option.useValue);if(this.option.useDynamic.length>0){var n=this.option.useDynamic[this.option.useDynamic.length-1];return jn(Gn(this.generalToken,e).toDynamicValue((function(){return n({container:t.context})})),this.option)}if(this.option.useFactory.length>0){var r=this.option.useFactory[this.option.useFactory.length-1];return Gn(this.generalToken,e).toFactory((function(){return r({container:t.context})}))}if(this.option.useClass.length>0){var i=this.option.useClass[this.option.useClass.length-1];return jn(Gn(this.generalToken,e).to(i),this.option)}}},{key:"resolveMutilple",value:function(e){var t=this,n=this.option.useClass.map((function(n){return jn(Fn(t.generalToken,e).to(n),t.option)})),r=this.option.useDynamic.map((function(n){return jn(Fn(t.generalToken,e).toDynamicValue((function(){return n({container:t.context})})),t.option)})),i=this.option.useFactory.map((function(n){return Fn(t.generalToken,e).toFactory((function(){return n({container:t.context})}))})),o="useValue"in this.option?Fn(this.generalToken,e).toConstantValue(this.option.useValue):void 0;this.named&&(n.forEach((function(e){return t.named&&Ln(e,t.named)})),r.forEach((function(e){return t.named&&Ln(e,t.named)})),i.forEach((function(e){return t.named&&Ln(e,t.named)})),o&&Ln(o,this.named))}}],[{key:"resolveTarget",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{try{var i=Reflect.getMetadata(Xn,n);i&&e.resolveOption(t,i)}catch(e){}if(On.isClass(n))if(r.useClass){var o=On.maybeArrayToArray(r.useClass);o.unshift(n),r.useClass=o}else r.useClass=[n];var s;try{s=Reflect.getMetadata(Sn.ClassOptionSymbol,n)}catch(e){}if((s=kn(kn({},s||{}),r)).token){var a=On.maybeArrayToArray(s.token);a.unshift(n),s.token=a}else s.token=[n];e.resolveOption(t,s)}catch(e){}}},{key:"resolveOption",value:function(t,n){var r=function(e){var t=On.maybeArrayToArray(e.token),n=On.maybeArrayToArray(e.useClass),r=On.maybeArrayToArray(e.useDynamic),i=On.maybeArrayToArray(e.useFactory),o=On.maybeArrayToArray(e.contrib),s=e.lifecycle||Sn.Lifecycle.transient,a={token:t,useClass:n,lifecycle:o.length>0?Sn.Lifecycle.singleton:s,contrib:o,useDynamic:r,useFactory:i};return"useValue"in e&&(a.useValue=e.useValue),a}(kn(kn({},e.globalConfig),n));(0!==r.useClass.length||0!==r.useDynamic.length||0!==r.useFactory.length||"useValue"in r)&&r.token.forEach((function(n){new e(t,n,kn({},r)).resolve()}))}}]),e}();Yn.globalConfig=Sn.DefaultOption;var qn=function(){function e(t){Tn(this,e),this.loadedModules=[],this.container=void 0,this.inversify=!0,this.parent=void 0,this.container=t||new f.Container}return Dn(e,[{key:"load",value:function(e,t){!t&&this.loadedModules.includes(e.id)||(e.registry(this.register.bind(this),this.resolveContext()),this.loadedModules.push(e.id))}},{key:"remove",value:function(e){return this.container.unbind(zn(e))}},{key:"get",value:function(e){return this.container.get(zn(e))}},{key:"getNamed",value:function(e,t){return this.container.getNamed(zn(e),Bn(t))}},{key:"getAll",value:function(e){return this.container.getAll(zn(e))}},{key:"getAllNamed",value:function(e,t){return this.container.getAllNamed(zn(e),Bn(t))}},{key:"isBound",value:function(e){return this.container.isBound(zn(e))}},{key:"isBoundNamed",value:function(e,t){return this.container.isBoundNamed(zn(e),Bn(t))}},{key:"createChild",value:function(){var t=new e(this.container.createChild());return t.parent=this,t}},{key:"register",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};On.isInjectOption(e)?Yn.resolveOption(this,e):Yn.resolveTarget(this,e,t)}},{key:"resolveContext",value:function(){return{container:this}}}],[{key:"config",value:function(e){Yn.globalConfig=e}}]),e}(),Kn=new qn(Un),Zn=Kn.register.bind(Kn),Jn=Sn.defineToken("ContributionProvider"),Qn=function(){function e(t,n,r){Tn(this,e),this.option={recursive:!1,cache:!0},this.services=void 0,this.serviceIdentifier=void 0,this.container=void 0,this.container=n,this.serviceIdentifier=t,r&&(this.option=kn(kn({},this.option),r))}return Dn(e,[{key:"setServices",value:function(e){for(var t=[],n=this.container;n;){if(n.isBound(this.serviceIdentifier)){var r=n.getAll(this.serviceIdentifier);t.push.apply(t,Rn(r))}n=e?n.parent:void 0}return t}},{key:"getContributions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=kn(kn({},this.option),e),n=t.cache,r=t.recursive;return n&&void 0!==this.services||(this.services=this.setServices(!!r)),this.services}}]),e}();function er(e,t){return{token:{token:Jn,named:e},useDynamic:function(n){return new Qn(e,n.container,t)},lifecycle:Sn.Lifecycle.singleton}}function tr(e,t,n){e({token:{token:Jn,named:t},useDynamic:function(e){return new Qn(t,e.container,n)},lifecycle:Sn.Lifecycle.singleton})}var nr=function(){function e(t){Tn(this,e),this.id=void 0,this.baseRegistry=void 0,this.optionCollection=void 0,e.moduleId+=1,this.id=e.moduleId,this.baseRegistry=t}return Dn(e,[{key:"registry",get:function(){var e=this;return function(t,n){e.baseRegistry&&e.baseRegistry(t,n),e.optionCollection&&e.optionCollection.forEach((function(e){return t(e)}))}}},{key:"options",get:function(){return this.optionCollection||(this.optionCollection=[]),this.optionCollection}},{key:"register",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){return e.options.push(t)})),this}},{key:"contribution",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){return e.options.push(er(t))})),this}}]),e}();function rr(e){return new nr(e)}nr.moduleId=0;var ir,or=function(e){return function(t,n,r){$n(e)(t,n,r),Wn(Jn)(t,n,r)}};!function(e){e.Provider=Jn,e.register=tr}(ir||(ir={}));var sr,ar,lr=Object.freeze({__proto__:null,Container:qn,get Contribution(){return ir},DefaultContributionProvider:Qn,GlobalContainer:Kn,Module:rr,OptionSymbol:Xn,Provider:Jn,get Syringe(){return Sn},SyringeModule:nr,get Utils(){return On},contrib:or,inject:Wn,injectable:Vn,named:$n,register:Zn,registerSideOption:function(e,t){Reflect.defineMetadata(Xn,e,t)},singleton:Hn,transient:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Vn(kn(kn({},e),{},{lifecycle:Sn.Lifecycle.transient}))},decorate:f.decorate,optional:f.optional,postConstruct:f.postConstruct,unmanaged:f.unmanaged});e.NsGraph=void 0,function(e){e.TOP="top",e.BOTTOM="bottom",e.RIGHT="right",e.LEFT="left"}((sr=e.NsGraph||(e.NsGraph={})).AnchorGroup||(sr.AnchorGroup={})),(ar=sr.AnchorType||(sr.AnchorType={})).INPUT="input",ar.OUTPUT="output";var cr={exports:{}};
/*!
	  Copyright (c) 2018 Jed Watson.
	  Licensed under the MIT License (MIT), see
	  http://jedwatson.github.io/classnames
	*/!function(e){!function(){var t={}.hasOwnProperty;function n(){for(var e=[],r=0;r<arguments.length;r++){var i=arguments[r];if(i){var o=typeof i;if("string"===o||"number"===o)e.push(i);else if(Array.isArray(i)){if(i.length){var s=n.apply(null,i);s&&e.push(s)}}else if("object"===o)if(i.toString===Object.prototype.toString)for(var a in i)t.call(i,a)&&i[a]&&e.push(a);else e.push(i.toString())}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):window.classNames=n}()}(cr);var ur,hr=cr.exports;
/*! *****************************************************************************
	Copyright (C) Microsoft. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */!function(e){!function(t){var n="object"==typeof u?u:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=i(e);function i(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===n.Reflect?n.Reflect=e:r=i(n.Reflect,r),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,s={__proto__:[]}instanceof Array,a=!o&&!s,l={create:o?function(){return re(Object.create(null))}:s?function(){return re({__proto__:null})}:function(){return re({})},has:a?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:a?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),u="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,d=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,f=new(u||"function"!=typeof WeakMap?ne():WeakMap);function p(e,t,n,r){if(I(n)){if(!H(e))throw new TypeError;if(!$(t))throw new TypeError;return _(e,t)}if(!H(e))throw new TypeError;if(!F(t))throw new TypeError;if(!F(r)&&!I(r)&&!j(r))throw new TypeError;return j(r)&&(r=void 0),S(e,t,n=V(n),r)}function g(e,t){function n(n,r){if(!F(n))throw new TypeError;if(!I(r)&&!X(r))throw new TypeError;P(e,t,n,r)}return n}function m(e,t,n,r){if(!F(n))throw new TypeError;return I(r)||(r=V(r)),P(e,t,n,r)}function v(e,t,n){if(!F(t))throw new TypeError;return I(n)||(n=V(n)),A(e,t,n)}function y(e,t,n){if(!F(t))throw new TypeError;return I(n)||(n=V(n)),k(e,t,n)}function b(e,t,n){if(!F(t))throw new TypeError;return I(n)||(n=V(n)),M(e,t,n)}function x(e,t,n){if(!F(t))throw new TypeError;return I(n)||(n=V(n)),T(e,t,n)}function w(e,t){if(!F(e))throw new TypeError;return I(t)||(t=V(t)),D(e,t)}function C(e,t){if(!F(e))throw new TypeError;return I(t)||(t=V(t)),N(e,t)}function E(e,t,n){if(!F(t))throw new TypeError;I(n)||(n=V(n));var r=O(t,n,!1);if(I(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=f.get(t);return i.delete(n),i.size>0||f.delete(t),!0}function _(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!I(r)&&!j(r)){if(!$(r))throw new TypeError;t=r}}return t}function S(e,t,n,r){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,n,r);if(!I(o)&&!j(o)){if(!F(o))throw new TypeError;r=o}}return r}function O(e,t,n){var r=f.get(e);if(I(r)){if(!n)return;r=new h,f.set(e,r)}var i=r.get(t);if(I(i)){if(!n)return;i=new h,r.set(t,i)}return i}function A(e,t,n){if(k(e,t,n))return!0;var r=Q(t);return!j(r)&&A(e,r,n)}function k(e,t,n){var r=O(t,n,!1);return!I(r)&&z(r.has(e))}function M(e,t,n){if(k(e,t,n))return T(e,t,n);var r=Q(t);return j(r)?void 0:M(e,r,n)}function T(e,t,n){var r=O(t,n,!1);if(!I(r))return r.get(e)}function P(e,t,n,r){O(n,r,!0).set(e,t)}function D(e,t){var n=N(e,t),r=Q(e);if(null===r)return n;var i=D(r,t);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new d,s=[],a=0,l=n;a<l.length;a++){var c=l[a];o.has(c)||(o.add(c),s.push(c))}for(var u=0,h=i;u<h.length;u++){c=h[u];o.has(c)||(o.add(c),s.push(c))}return s}function N(e,t){var n=[],r=O(e,t,!1);if(I(r))return n;for(var i=q(r.keys()),o=0;;){var s=Z(i);if(!s)return n.length=o,n;var a=K(s);try{n[o]=a}catch(e){try{J(i)}finally{throw e}}o++}}function R(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function I(e){return void 0===e}function j(e){return null===e}function L(e){return"symbol"==typeof e}function F(e){return"object"==typeof e?null!==e:"function"==typeof e}function G(e,t){switch(R(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",i=Y(e,r);if(void 0!==i){var o=i.call(e,n);if(F(o))throw new TypeError;return o}return B(e,"default"===n?"number":n)}function B(e,t){if("string"===t){var n=e.toString;if(W(n))if(!F(i=n.call(e)))return i;if(W(r=e.valueOf))if(!F(i=r.call(e)))return i}else{var r;if(W(r=e.valueOf))if(!F(i=r.call(e)))return i;var i,o=e.toString;if(W(o))if(!F(i=o.call(e)))return i}throw new TypeError}function z(e){return!!e}function U(e){return""+e}function V(e){var t=G(e,3);return L(t)?t:U(t)}function H(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function W(e){return"function"==typeof e}function $(e){return"function"==typeof e}function X(e){switch(R(e)){case 3:case 4:return!0;default:return!1}}function Y(e,t){var n=e[t];if(null!=n){if(!W(n))throw new TypeError;return n}}function q(e){var t=Y(e,i);if(!W(t))throw new TypeError;var n=t.call(e);if(!F(n))throw new TypeError;return n}function K(e){return e.value}function Z(e){var t=e.next();return!t.done&&t}function J(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c)return t;if(t!==c)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!=typeof i||i===e?t:i}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,o)},t.prototype.entries=function(){return new n(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function o(e,t){return t}function s(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function ne(){var e=16,n=l.create(),r=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+c()}while(l.has(n,e));return n[e]=!0,e}function o(e,n){if(!t.call(e,r)){if(!n)return;Object.defineProperty(e,r,{value:l.create()})}return e[r]}function s(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e)}function c(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var i=t[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}function re(e){return e.__=void 0,delete e.__,e}e("decorate",p),e("metadata",g),e("defineMetadata",m),e("hasMetadata",v),e("hasOwnMetadata",y),e("getMetadata",b),e("getOwnMetadata",x),e("getMetadataKeys",w),e("getOwnMetadataKeys",C),e("deleteMetadata",E)}(r)}()}(ur||(ur={}));var dr={exports:{}};
/*!
	 * jQuery JavaScript Library v3.6.0
	 * https://jquery.com/
	 *
	 * Includes Sizzle.js
	 * https://sizzlejs.com/
	 *
	 * Copyright OpenJS Foundation and other contributors
	 * Released under the MIT license
	 * https://jquery.org/license
	 *
	 * Date: 2021-03-02T17:08Z
	 */!function(e){!function(t,n){e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}}("undefined"!=typeof window?window:u,(function(e,t){var n=[],r=Object.getPrototypeOf,i=n.slice,o=function(e){return n.concat.apply([],e)},s=n.push,a=n.indexOf,l={},c=l.toString,u=l.hasOwnProperty,h=u.toString,d=h.call(Object),f={},p=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},g=function(e){return null!=e&&e===e.window},m=e.document,v={type:!0,src:!0,nonce:!0,noModule:!0};function y(e,t,n){var r,i,o=(n=n||m).createElement("script");if(o.text=e,t)for(r in v)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function b(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[c.call(e)]||"object":typeof e}var x="3.6.0",w=function(e,t){return new w.fn.init(e,t)};function C(e){var t=!!e&&"length"in e&&e.length,n=b(e);return!p(e)&&!g(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}w.fn=w.prototype={jquery:x,constructor:w,length:0,toArray:function(){return i.call(this)},get:function(e){return null==e?i.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(i.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(w.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(w.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,r,i,o,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||p(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(e=arguments[a]))for(t in e)r=e[t],"__proto__"!==t&&s!==r&&(c&&r&&(w.isPlainObject(r)||(i=Array.isArray(r)))?(n=s[t],o=i&&!Array.isArray(n)?[]:i||w.isPlainObject(n)?n:{},i=!1,s[t]=w.extend(c,o,r)):void 0!==r&&(s[t]=r));return s},w.extend({expando:"jQuery"+(x+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==c.call(e))&&(!(t=r(e))||"function"==typeof(n=u.call(t,"constructor")&&t.constructor)&&h.call(n)===d)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){y(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(C(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(C(Object(e))?w.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:a.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,s=!n;i<o;i++)!t(e[i],i)!==s&&r.push(e[i]);return r},map:function(e,t,n){var r,i,s=0,a=[];if(C(e))for(r=e.length;s<r;s++)null!=(i=t(e[s],s,n))&&a.push(i);else for(s in e)null!=(i=t(e[s],s,n))&&a.push(i);return o(a)},guid:1,support:f}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){l["[object "+t+"]"]=t.toLowerCase()}));var E=
/*!
	 * Sizzle CSS Selector Engine v2.3.6
	 * https://sizzlejs.com/
	 *
	 * Copyright JS Foundation and other contributors
	 * Released under the MIT license
	 * https://js.foundation/
	 *
	 * Date: 2021-02-16
	 */
function(e){var t,n,r,i,o,s,a,l,c,u,h,d,f,p,g,m,v,y,b,x="sizzle"+1*new Date,w=e.document,C=0,E=0,_=le(),S=le(),O=le(),A=le(),k=function(e,t){return e===t&&(h=!0),0},M={}.hasOwnProperty,T=[],P=T.pop,D=T.push,N=T.push,R=T.slice,I=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},j="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",F="(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",G="\\[[\\x20\\t\\r\\n\\f]*("+F+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+L+"*\\]",B=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+G+")*)|.*)\\)|)",z=new RegExp(L+"+","g"),U=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),V=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),H=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),W=new RegExp(L+"|>"),$=new RegExp(B),X=new RegExp("^"+F+"$"),Y={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F+"|[*])"),ATTR:new RegExp("^"+G),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+j+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},q=/HTML$/i,K=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){d()},se=xe((function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{N.apply(T=R.call(w.childNodes),w.childNodes),T[w.childNodes.length].nodeType}catch(e){N={apply:T.length?function(e,t){D.apply(e,R.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function ae(e,t,r,i){var o,a,c,u,h,p,v,y=t&&t.ownerDocument,w=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==w&&9!==w&&11!==w)return r;if(!i&&(d(t),t=t||f,g)){if(11!==w&&(h=Q.exec(e)))if(o=h[1]){if(9===w){if(!(c=t.getElementById(o)))return r;if(c.id===o)return r.push(c),r}else if(y&&(c=y.getElementById(o))&&b(t,c)&&c.id===o)return r.push(c),r}else{if(h[2])return N.apply(r,t.getElementsByTagName(e)),r;if((o=h[3])&&n.getElementsByClassName&&t.getElementsByClassName)return N.apply(r,t.getElementsByClassName(o)),r}if(n.qsa&&!A[e+" "]&&(!m||!m.test(e))&&(1!==w||"object"!==t.nodeName.toLowerCase())){if(v=e,y=t,1===w&&(W.test(e)||H.test(e))){for((y=ee.test(e)&&ve(t.parentNode)||t)===t&&n.scope||((u=t.getAttribute("id"))?u=u.replace(re,ie):t.setAttribute("id",u=x)),a=(p=s(e)).length;a--;)p[a]=(u?"#"+u:":scope")+" "+be(p[a]);v=p.join(",")}try{return N.apply(r,y.querySelectorAll(v)),r}catch(t){A(e,!0)}finally{u===x&&t.removeAttribute("id")}}}return l(e.replace(U,"$1"),t,r,i)}function le(){var e=[];return function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}}function ce(e){return e[x]=!0,e}function ue(e){var t=f.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function he(e,t){for(var n=e.split("|"),i=n.length;i--;)r.attrHandle[n[i]]=t}function de(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function fe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function pe(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ge(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&se(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function me(e){return ce((function(t){return t=+t,ce((function(n,r){for(var i,o=e([],n.length,t),s=o.length;s--;)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))}))}))}function ve(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=ae.support={},o=ae.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!q.test(t||n&&n.nodeName||"HTML")},d=ae.setDocument=function(e){var t,i,s=e?e.ownerDocument||e:w;return s!=f&&9===s.nodeType&&s.documentElement?(p=(f=s).documentElement,g=!o(f),w!=f&&(i=f.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",oe,!1):i.attachEvent&&i.attachEvent("onunload",oe)),n.scope=ue((function(e){return p.appendChild(e).appendChild(f.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length})),n.attributes=ue((function(e){return e.className="i",!e.getAttribute("className")})),n.getElementsByTagName=ue((function(e){return e.appendChild(f.createComment("")),!e.getElementsByTagName("*").length})),n.getElementsByClassName=J.test(f.getElementsByClassName),n.getById=ue((function(e){return p.appendChild(e).id=x,!f.getElementsByName||!f.getElementsByName(x).length})),n.getById?(r.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(r.filter.ID=function(e){var t=e.replace(te,ne);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),r.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&g)return t.getElementsByClassName(e)},v=[],m=[],(n.qsa=J.test(f.querySelectorAll))&&(ue((function(e){var t;p.appendChild(e).innerHTML="<a id='"+x+"'></a><select id='"+x+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+j+")"),e.querySelectorAll("[id~="+x+"-]").length||m.push("~="),(t=f.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||m.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+x+"+*").length||m.push(".#.+[+~]"),e.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")})),ue((function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=f.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),p.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")}))),(n.matchesSelector=J.test(y=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ue((function(e){n.disconnectedMatch=y.call(e,"*"),y.call(e,"[s!='']:x"),v.push("!=",B)})),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),t=J.test(p.compareDocumentPosition),b=t||J.test(p.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},k=t?function(e,t){if(e===t)return h=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===r?e==f||e.ownerDocument==w&&b(w,e)?-1:t==f||t.ownerDocument==w&&b(w,t)?1:u?I(u,e)-I(u,t):0:4&r?-1:1)}:function(e,t){if(e===t)return h=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,s=[e],a=[t];if(!i||!o)return e==f?-1:t==f?1:i?-1:o?1:u?I(u,e)-I(u,t):0;if(i===o)return de(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;s[r]===a[r];)r++;return r?de(s[r],a[r]):s[r]==w?-1:a[r]==w?1:0},f):f},ae.matches=function(e,t){return ae(e,null,null,t)},ae.matchesSelector=function(e,t){if(d(e),n.matchesSelector&&g&&!A[t+" "]&&(!v||!v.test(t))&&(!m||!m.test(t)))try{var r=y.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){A(t,!0)}return ae(t,f,null,[e]).length>0},ae.contains=function(e,t){return(e.ownerDocument||e)!=f&&d(e),b(e,t)},ae.attr=function(e,t){(e.ownerDocument||e)!=f&&d(e);var i=r.attrHandle[t.toLowerCase()],o=i&&M.call(r.attrHandle,t.toLowerCase())?i(e,t,!g):void 0;return void 0!==o?o:n.attributes||!g?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},ae.escape=function(e){return(e+"").replace(re,ie)},ae.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ae.uniqueSort=function(e){var t,r=[],i=0,o=0;if(h=!n.detectDuplicates,u=!n.sortStable&&e.slice(0),e.sort(k),h){for(;t=e[o++];)t===e[o]&&(i=r.push(o));for(;i--;)e.splice(r[i],1)}return u=null,e},i=ae.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=i(t);return n},r=ae.selectors={cacheLength:50,createPseudo:ce,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ae.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ae.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return Y.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&$.test(n)&&(t=s(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=_[e+" "];return t||(t=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+e+"("+L+"|$)"))&&_(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var i=ae.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(z," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,l){var c,u,h,d,f,p,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,v=a&&t.nodeName.toLowerCase(),y=!l&&!a,b=!1;if(m){if(o){for(;g;){for(d=t;d=d[g];)if(a?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[s?m.firstChild:m.lastChild],s&&y){for(b=(f=(c=(u=(h=(d=m)[x]||(d[x]={}))[d.uniqueID]||(h[d.uniqueID]={}))[e]||[])[0]===C&&c[1])&&c[2],d=f&&m.childNodes[f];d=++f&&d&&d[g]||(b=f=0)||p.pop();)if(1===d.nodeType&&++b&&d===t){u[e]=[C,f,b];break}}else if(y&&(b=f=(c=(u=(h=(d=t)[x]||(d[x]={}))[d.uniqueID]||(h[d.uniqueID]={}))[e]||[])[0]===C&&c[1]),!1===b)for(;(d=++f&&d&&d[g]||(b=f=0)||p.pop())&&((a?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++b||(y&&((u=(h=d[x]||(d[x]={}))[d.uniqueID]||(h[d.uniqueID]={}))[e]=[C,b]),d!==t)););return(b-=i)===r||b%r==0&&b/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||ae.error("unsupported pseudo: "+e);return i[x]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?ce((function(e,n){for(var r,o=i(e,t),s=o.length;s--;)e[r=I(e,o[s])]=!(n[r]=o[s])})):function(e){return i(e,0,n)}):i}},pseudos:{not:ce((function(e){var t=[],n=[],r=a(e.replace(U,"$1"));return r[x]?ce((function(e,t,n,i){for(var o,s=r(e,null,i,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))})):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}})),has:ce((function(e){return function(t){return ae(e,t).length>0}})),contains:ce((function(e){return e=e.replace(te,ne),function(t){return(t.textContent||i(t)).indexOf(e)>-1}})),lang:ce((function(e){return X.test(e||"")||ae.error("unsupported lang: "+e),e=e.replace(te,ne).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return Z.test(e.nodeName)},input:function(e){return K.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:me((function(){return[0]})),last:me((function(e,t){return[t-1]})),eq:me((function(e,t,n){return[n<0?n+t:n]})),even:me((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:me((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:me((function(e,t,n){for(var r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e})),gt:me((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}},r.pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=fe(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=pe(t);function ye(){}function be(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function xe(e,t,n){var r=t.dir,i=t.next,o=i||r,s=n&&"parentNode"===o,a=E++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||s)return e(t,n,i);return!1}:function(t,n,l){var c,u,h,d=[C,a];if(l){for(;t=t[r];)if((1===t.nodeType||s)&&e(t,n,l))return!0}else for(;t=t[r];)if(1===t.nodeType||s)if(u=(h=t[x]||(t[x]={}))[t.uniqueID]||(h[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((c=u[o])&&c[0]===C&&c[1]===a)return d[2]=c[2];if(u[o]=d,d[2]=e(t,n,l))return!0}return!1}}function we(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function Ce(e,t,n,r,i){for(var o,s=[],a=0,l=e.length,c=null!=t;a<l;a++)(o=e[a])&&(n&&!n(o,r,i)||(s.push(o),c&&t.push(a)));return s}function Ee(e,t,n,r,i,o){return r&&!r[x]&&(r=Ee(r)),i&&!i[x]&&(i=Ee(i,o)),ce((function(o,s,a,l){var c,u,h,d=[],f=[],p=s.length,g=o||function(e,t,n){for(var r=0,i=t.length;r<i;r++)ae(e,t[r],n);return n}(t||"*",a.nodeType?[a]:a,[]),m=!e||!o&&t?g:Ce(g,d,e,a,l),v=n?i||(o?e:p||r)?[]:s:m;if(n&&n(m,v,a,l),r)for(c=Ce(v,f),r(c,[],a,l),u=c.length;u--;)(h=c[u])&&(v[f[u]]=!(m[f[u]]=h));if(o){if(i||e){if(i){for(c=[],u=v.length;u--;)(h=v[u])&&c.push(m[u]=h);i(null,v=[],c,l)}for(u=v.length;u--;)(h=v[u])&&(c=i?I(o,h):d[u])>-1&&(o[c]=!(s[c]=h))}}else v=Ce(v===s?v.splice(p,v.length):v),i?i(null,s,v,l):N.apply(s,v)}))}function _e(e){for(var t,n,i,o=e.length,s=r.relative[e[0].type],a=s||r.relative[" "],l=s?1:0,u=xe((function(e){return e===t}),a,!0),h=xe((function(e){return I(t,e)>-1}),a,!0),d=[function(e,n,r){var i=!s&&(r||n!==c)||((t=n).nodeType?u(e,n,r):h(e,n,r));return t=null,i}];l<o;l++)if(n=r.relative[e[l].type])d=[xe(we(d),n)];else{if((n=r.filter[e[l].type].apply(null,e[l].matches))[x]){for(i=++l;i<o&&!r.relative[e[i].type];i++);return Ee(l>1&&we(d),l>1&&be(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(U,"$1"),n,l<i&&_e(e.slice(l,i)),i<o&&_e(e=e.slice(i)),i<o&&be(e))}d.push(n)}return we(d)}return ye.prototype=r.filters=r.pseudos,r.setFilters=new ye,s=ae.tokenize=function(e,t){var n,i,o,s,a,l,c,u=S[e+" "];if(u)return t?0:u.slice(0);for(a=e,l=[],c=r.preFilter;a;){for(s in n&&!(i=V.exec(a))||(i&&(a=a.slice(i[0].length)||a),l.push(o=[])),n=!1,(i=H.exec(a))&&(n=i.shift(),o.push({value:n,type:i[0].replace(U," ")}),a=a.slice(n.length)),r.filter)!(i=Y[s].exec(a))||c[s]&&!(i=c[s](i))||(n=i.shift(),o.push({value:n,type:s,matches:i}),a=a.slice(n.length));if(!n)break}return t?a.length:a?ae.error(e):S(e,l).slice(0)},a=ae.compile=function(e,t){var n,i=[],o=[],a=O[e+" "];if(!a){for(t||(t=s(e)),n=t.length;n--;)(a=_e(t[n]))[x]?i.push(a):o.push(a);a=O(e,function(e,t){var n=t.length>0,i=e.length>0,o=function(o,s,a,l,u){var h,p,m,v=0,y="0",b=o&&[],x=[],w=c,E=o||i&&r.find.TAG("*",u),_=C+=null==w?1:Math.random()||.1,S=E.length;for(u&&(c=s==f||s||u);y!==S&&null!=(h=E[y]);y++){if(i&&h){for(p=0,s||h.ownerDocument==f||(d(h),a=!g);m=e[p++];)if(m(h,s||f,a)){l.push(h);break}u&&(C=_)}n&&((h=!m&&h)&&v--,o&&b.push(h))}if(v+=y,n&&y!==v){for(p=0;m=t[p++];)m(b,x,s,a);if(o){if(v>0)for(;y--;)b[y]||x[y]||(x[y]=P.call(l));x=Ce(x)}N.apply(l,x),u&&!o&&x.length>0&&v+t.length>1&&ae.uniqueSort(l)}return u&&(C=_,c=w),b};return n?ce(o):o}(o,i)),a.selector=e}return a},l=ae.select=function(e,t,n,i){var o,l,c,u,h,d="function"==typeof e&&e,f=!i&&s(e=d.selector||e);if(n=n||[],1===f.length){if((l=f[0]=f[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===t.nodeType&&g&&r.relative[l[1].type]){if(!(t=(r.find.ID(c.matches[0].replace(te,ne),t)||[])[0]))return n;d&&(t=t.parentNode),e=e.slice(l.shift().value.length)}for(o=Y.needsContext.test(e)?0:l.length;o--&&(c=l[o],!r.relative[u=c.type]);)if((h=r.find[u])&&(i=h(c.matches[0].replace(te,ne),ee.test(l[0].type)&&ve(t.parentNode)||t))){if(l.splice(o,1),!(e=i.length&&be(l)))return N.apply(n,i),n;break}}return(d||a(e,f))(i,t,!g,n,!t||ee.test(e)&&ve(t.parentNode)||t),n},n.sortStable=x.split("").sort(k).join("")===x,n.detectDuplicates=!!h,d(),n.sortDetached=ue((function(e){return 1&e.compareDocumentPosition(f.createElement("fieldset"))})),ue((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||he("type|href|height|width",(function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),n.attributes&&ue((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||he("value",(function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),ue((function(e){return null==e.getAttribute("disabled")}))||he(j,(function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null})),ae}(e);w.find=E,w.expr=E.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=E.uniqueSort,w.text=E.getText,w.isXMLDoc=E.isXML,w.contains=E.contains,w.escapeSelector=E.escape;var _=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&w(e).is(n))break;r.push(e)}return r},S=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},O=w.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var k=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function M(e,t,n){return p(t)?w.grep(e,(function(e,r){return!!t.call(e,r,e)!==n})):t.nodeType?w.grep(e,(function(e){return e===t!==n})):"string"!=typeof t?w.grep(e,(function(e){return a.call(t,e)>-1!==n})):w.filter(t,e,n)}w.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,(function(e){return 1===e.nodeType})))},w.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(w(e).filter((function(){for(t=0;t<r;t++)if(w.contains(i[t],this))return!0})));for(n=this.pushStack([]),t=0;t<r;t++)w.find(e,i[t],n);return r>1?w.uniqueSort(n):n},filter:function(e){return this.pushStack(M(this,e||[],!1))},not:function(e){return this.pushStack(M(this,e||[],!0))},is:function(e){return!!M(this,"string"==typeof e&&O.test(e)?w(e):e||[],!1).length}});var T,P=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,D=w.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||T,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:P.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:m,!0)),k.test(r[1])&&w.isPlainObject(t))for(r in t)p(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=m.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):p(e)?void 0!==n.ready?n.ready(e):e(w):w.makeArray(e,this)};D.prototype=w.fn,T=w(m);var N=/^(?:parents|prev(?:Until|All))/,R={children:!0,contents:!0,next:!0,prev:!0};function I(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}w.fn.extend({has:function(e){var t=w(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(w.contains(this,t[e]))return!0}))},closest:function(e,t){var n,r=0,i=this.length,o=[],s="string"!=typeof e&&w(e);if(!O.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?w.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?a.call(w(e),this[0]):a.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return _(e,"parentNode")},parentsUntil:function(e,t,n){return _(e,"parentNode",n)},next:function(e){return I(e,"nextSibling")},prev:function(e){return I(e,"previousSibling")},nextAll:function(e){return _(e,"nextSibling")},prevAll:function(e){return _(e,"previousSibling")},nextUntil:function(e,t,n){return _(e,"nextSibling",n)},prevUntil:function(e,t,n){return _(e,"previousSibling",n)},siblings:function(e){return S((e.parentNode||{}).firstChild,e)},children:function(e){return S(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),w.merge([],e.childNodes))}},(function(e,t){w.fn[e]=function(n,r){var i=w.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=w.filter(r,i)),this.length>1&&(R[e]||w.uniqueSort(i),N.test(e)&&i.reverse()),this.pushStack(i)}}));var j=/[^\x20\t\r\n\f]+/g;function L(e){return e}function F(e){throw e}function G(e,t,n,r){var i;try{e&&p(i=e.promise)?i.call(e).done(t).fail(n):e&&p(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}w.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return w.each(e.match(j)||[],(function(e,n){t[n]=!0})),t}(e):w.extend({},e);var t,n,r,i,o=[],s=[],a=-1,l=function(){for(i=i||e.once,r=t=!0;s.length;a=-1)for(n=s.shift();++a<o.length;)!1===o[a].apply(n[0],n[1])&&e.stopOnFalse&&(a=o.length,n=!1);e.memory||(n=!1),t=!1,i&&(o=n?[]:"")},c={add:function(){return o&&(n&&!t&&(a=o.length-1,s.push(n)),function t(n){w.each(n,(function(n,r){p(r)?e.unique&&c.has(r)||o.push(r):r&&r.length&&"string"!==b(r)&&t(r)}))}(arguments),n&&!t&&l()),this},remove:function(){return w.each(arguments,(function(e,t){for(var n;(n=w.inArray(t,o,n))>-1;)o.splice(n,1),n<=a&&a--})),this},has:function(e){return e?w.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=s=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=s=[],n||t||(o=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],s.push(n),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},w.extend({Deferred:function(t){var n=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return i.then(null,e)},pipe:function(){var e=arguments;return w.Deferred((function(t){w.each(n,(function(n,r){var i=p(e[r[4]])&&e[r[4]];o[r[1]]((function(){var e=i&&i.apply(this,arguments);e&&p(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[r[0]+"With"](this,i?[e]:arguments)}))})),e=null})).promise()},then:function(t,r,i){var o=0;function s(t,n,r,i){return function(){var a=this,l=arguments,c=function(){var e,c;if(!(t<o)){if((e=r.apply(a,l))===n.promise())throw new TypeError("Thenable self-resolution");c=e&&("object"==typeof e||"function"==typeof e)&&e.then,p(c)?i?c.call(e,s(o,n,L,i),s(o,n,F,i)):(o++,c.call(e,s(o,n,L,i),s(o,n,F,i),s(o,n,L,n.notifyWith))):(r!==L&&(a=void 0,l=[e]),(i||n.resolveWith)(a,l))}},u=i?c:function(){try{c()}catch(e){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(e,u.stackTrace),t+1>=o&&(r!==F&&(a=void 0,l=[e]),n.rejectWith(a,l))}};t?u():(w.Deferred.getStackHook&&(u.stackTrace=w.Deferred.getStackHook()),e.setTimeout(u))}}return w.Deferred((function(e){n[0][3].add(s(0,e,p(i)?i:L,e.notifyWith)),n[1][3].add(s(0,e,p(t)?t:L)),n[2][3].add(s(0,e,p(r)?r:F))})).promise()},promise:function(e){return null!=e?w.extend(e,i):i}},o={};return w.each(n,(function(e,t){var s=t[2],a=t[5];i[t[1]]=s.add,a&&s.add((function(){r=a}),n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),s.add(t[3].fire),o[t[0]]=function(){return o[t[0]+"With"](this===o?void 0:this,arguments),this},o[t[0]+"With"]=s.fireWith})),i.promise(o),t&&t.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),o=i.call(arguments),s=w.Deferred(),a=function(e){return function(n){r[e]=this,o[e]=arguments.length>1?i.call(arguments):n,--t||s.resolveWith(r,o)}};if(t<=1&&(G(e,s.done(a(n)).resolve,s.reject,!t),"pending"===s.state()||p(o[n]&&o[n].then)))return s.then();for(;n--;)G(o[n],a(n),s.reject);return s.promise()}});var B=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&B.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},w.readyException=function(t){e.setTimeout((function(){throw t}))};var z=w.Deferred();function U(){m.removeEventListener("DOMContentLoaded",U),e.removeEventListener("load",U),w.ready()}w.fn.ready=function(e){return z.then(e).catch((function(e){w.readyException(e)})),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||z.resolveWith(m,[w]))}}),w.ready.then=z.then,"complete"===m.readyState||"loading"!==m.readyState&&!m.documentElement.doScroll?e.setTimeout(w.ready):(m.addEventListener("DOMContentLoaded",U),e.addEventListener("load",U));var V=function(e,t,n,r,i,o,s){var a=0,l=e.length,c=null==n;if("object"===b(n))for(a in i=!0,n)V(e,t,a,n[a],!0,o,s);else if(void 0!==r&&(i=!0,p(r)||(s=!0),c&&(s?(t.call(e,r),t=null):(c=t,t=function(e,t,n){return c.call(w(e),n)})),t))for(;a<l;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:c?t.call(e):l?t(e[0],n):o},H=/^-ms-/,W=/-([a-z])/g;function $(e,t){return t.toUpperCase()}function X(e){return e.replace(H,"ms-").replace(W,$)}var Y=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function q(){this.expando=w.expando+q.uid++}q.uid=1,q.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Y(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(j)||[]).length;for(;n--;)delete r[t[n]]}(void 0===t||w.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!w.isEmptyObject(t)}};var K=new q,Z=new q,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Q=/[A-Z]/g;function ee(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(Q,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:J.test(e)?JSON.parse(e):e)}(n)}catch(e){}Z.set(e,t,n)}else n=void 0;return n}w.extend({hasData:function(e){return Z.hasData(e)||K.hasData(e)},data:function(e,t,n){return Z.access(e,t,n)},removeData:function(e,t){Z.remove(e,t)},_data:function(e,t,n){return K.access(e,t,n)},_removeData:function(e,t){K.remove(e,t)}}),w.fn.extend({data:function(e,t){var n,r,i,o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(i=Z.get(o),1===o.nodeType&&!K.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(r=s[n].name).indexOf("data-")&&(r=X(r.slice(5)),ee(o,r,i[r]));K.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each((function(){Z.set(this,e)})):V(this,(function(t){var n;if(o&&void 0===t)return void 0!==(n=Z.get(o,e))||void 0!==(n=ee(o,e))?n:void 0;this.each((function(){Z.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){Z.remove(this,e)}))}}),w.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=K.get(e,t),n&&(!r||Array.isArray(n)?r=K.access(e,t,w.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,i=n.shift(),o=w._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,(function(){w.dequeue(e,t)}),o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return K.get(e,n)||K.access(e,n,{empty:w.Callbacks("once memory").add((function(){K.remove(e,[t+"queue",n])}))})}}),w.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?w.queue(this[0],e):void 0===t?this:this.each((function(){var n=w.queue(this,e,t);w._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&w.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){w.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=w.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(n=K.get(o[s],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var te=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ne=new RegExp("^(?:([+-])=|)("+te+")([a-z%]*)$","i"),re=["Top","Right","Bottom","Left"],ie=m.documentElement,oe=function(e){return w.contains(e.ownerDocument,e)},se={composed:!0};ie.getRootNode&&(oe=function(e){return w.contains(e.ownerDocument,e)||e.getRootNode(se)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&oe(e)&&"none"===w.css(e,"display")};function le(e,t,n,r){var i,o,s=20,a=r?function(){return r.cur()}:function(){return w.css(e,t,"")},l=a(),c=n&&n[3]||(w.cssNumber[t]?"":"px"),u=e.nodeType&&(w.cssNumber[t]||"px"!==c&&+l)&&ne.exec(w.css(e,t));if(u&&u[3]!==c){for(l/=2,c=c||u[3],u=+l||1;s--;)w.style(e,t,u+c),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),u/=o;u*=2,w.style(e,t,u+c),n=n||[]}return n&&(u=+u||+l||0,i=n[1]?u+(n[1]+1)*n[2]:+n[2],r&&(r.unit=c,r.start=u,r.end=i)),i}var ce={};function ue(e){var t,n=e.ownerDocument,r=e.nodeName,i=ce[r];return i||(t=n.body.appendChild(n.createElement(r)),i=w.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),ce[r]=i,i)}function he(e,t){for(var n,r,i=[],o=0,s=e.length;o<s;o++)(r=e[o]).style&&(n=r.style.display,t?("none"===n&&(i[o]=K.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&ae(r)&&(i[o]=ue(r))):"none"!==n&&(i[o]="none",K.set(r,"display",n)));for(o=0;o<s;o++)null!=i[o]&&(e[o].style.display=i[o]);return e}w.fn.extend({show:function(){return he(this,!0)},hide:function(){return he(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){ae(this)?w(this).show():w(this).hide()}))}});var de=/^(?:checkbox|radio)$/i,fe=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,pe=/^$|^module$|\/(?:java|ecma)script/i;!function(){var e=m.createDocumentFragment().appendChild(m.createElement("div")),t=m.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),f.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",f.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,e.innerHTML="<option></option>",f.option=!!e.lastChild}();var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function me(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?w.merge([e],n):n}function ve(e,t){for(var n=0,r=e.length;n<r;n++)K.set(e[n],"globalEval",!t||K.get(t[n],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,f.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var ye=/<|&#?\w+;/;function be(e,t,n,r,i){for(var o,s,a,l,c,u,h=t.createDocumentFragment(),d=[],f=0,p=e.length;f<p;f++)if((o=e[f])||0===o)if("object"===b(o))w.merge(d,o.nodeType?[o]:o);else if(ye.test(o)){for(s=s||h.appendChild(t.createElement("div")),a=(fe.exec(o)||["",""])[1].toLowerCase(),l=ge[a]||ge._default,s.innerHTML=l[1]+w.htmlPrefilter(o)+l[2],u=l[0];u--;)s=s.lastChild;w.merge(d,s.childNodes),(s=h.firstChild).textContent=""}else d.push(t.createTextNode(o));for(h.textContent="",f=0;o=d[f++];)if(r&&w.inArray(o,r)>-1)i&&i.push(o);else if(c=oe(o),s=me(h.appendChild(o),"script"),c&&ve(s),n)for(u=0;o=s[u++];)pe.test(o.type||"")&&n.push(o);return h}var xe=/^([^.]*)(?:\.(.+)|)/;function we(){return!0}function Ce(){return!1}function Ee(e,t){return e===function(){try{return m.activeElement}catch(e){}}()==("focus"===t)}function _e(e,t,n,r,i,o){var s,a;if("object"==typeof t){for(a in"string"!=typeof n&&(r=r||n,n=void 0),t)_e(e,a,n,r,t[a],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Ce;else if(!i)return e;return 1===o&&(s=i,i=function(e){return w().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=w.guid++)),e.each((function(){w.event.add(this,t,i,r,n)}))}function Se(e,t,n){n?(K.set(e,t,!1),w.event.add(e,t,{namespace:!1,handler:function(e){var r,o,s=K.get(this,t);if(1&e.isTrigger&&this[t]){if(s.length)(w.event.special[t]||{}).delegateType&&e.stopPropagation();else if(s=i.call(arguments),K.set(this,t,s),r=n(this,t),this[t](),s!==(o=K.get(this,t))||r?K.set(this,t,!1):o={},s!==o)return e.stopImmediatePropagation(),e.preventDefault(),o&&o.value}else s.length&&(K.set(this,t,{value:w.event.trigger(w.extend(s[0],w.Event.prototype),s.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===K.get(e,t)&&w.event.add(e,t,we)}w.event={global:{},add:function(e,t,n,r,i){var o,s,a,l,c,u,h,d,f,p,g,m=K.get(e);if(Y(e))for(n.handler&&(n=(o=n).handler,i=o.selector),i&&w.find.matchesSelector(ie,i),n.guid||(n.guid=w.guid++),(l=m.events)||(l=m.events=Object.create(null)),(s=m.handle)||(s=m.handle=function(t){return void 0!==w&&w.event.triggered!==t.type?w.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(j)||[""]).length;c--;)f=g=(a=xe.exec(t[c])||[])[1],p=(a[2]||"").split(".").sort(),f&&(h=w.event.special[f]||{},f=(i?h.delegateType:h.bindType)||f,h=w.event.special[f]||{},u=w.extend({type:f,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&w.expr.match.needsContext.test(i),namespace:p.join(".")},o),(d=l[f])||((d=l[f]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(e,r,p,s)||e.addEventListener&&e.addEventListener(f,s)),h.add&&(h.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),i?d.splice(d.delegateCount++,0,u):d.push(u),w.event.global[f]=!0)},remove:function(e,t,n,r,i){var o,s,a,l,c,u,h,d,f,p,g,m=K.hasData(e)&&K.get(e);if(m&&(l=m.events)){for(c=(t=(t||"").match(j)||[""]).length;c--;)if(f=g=(a=xe.exec(t[c])||[])[1],p=(a[2]||"").split(".").sort(),f){for(h=w.event.special[f]||{},d=l[f=(r?h.delegateType:h.bindType)||f]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)u=d[o],!i&&g!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||r&&r!==u.selector&&("**"!==r||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(e,u));s&&!d.length&&(h.teardown&&!1!==h.teardown.call(e,p,m.handle)||w.removeEvent(e,f,m.handle),delete l[f])}else for(f in l)w.event.remove(e,f+t[c],n,r,!0);w.isEmptyObject(l)&&K.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,s,a=new Array(arguments.length),l=w.event.fix(e),c=(K.get(this,"events")||Object.create(null))[l.type]||[],u=w.event.special[l.type]||{};for(a[0]=l,t=1;t<arguments.length;t++)a[t]=arguments[t];if(l.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,l)){for(s=w.event.handlers.call(this,l,c),t=0;(i=s[t++])&&!l.isPropagationStopped();)for(l.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==o.namespace&&!l.rnamespace.test(o.namespace)||(l.handleObj=o,l.data=o.data,void 0!==(r=((w.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,a))&&!1===(l.result=r)&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(e,t){var n,r,i,o,s,a=[],l=t.delegateCount,c=e.target;if(l&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(o=[],s={},n=0;n<l;n++)void 0===s[i=(r=t[n]).selector+" "]&&(s[i]=r.needsContext?w(i,this).index(c)>-1:w.find(i,this,null,[c]).length),s[i]&&o.push(r);o.length&&a.push({elem:c,handlers:o})}return c=this,l<t.length&&a.push({elem:c,handlers:t.slice(l)}),a},addProp:function(e,t){Object.defineProperty(w.Event.prototype,e,{enumerable:!0,configurable:!0,get:p(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[w.expando]?e:new w.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return de.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click",we),!1},trigger:function(e){var t=this||e;return de.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click"),!0},_default:function(e){var t=e.target;return de.test(t.type)&&t.click&&A(t,"input")&&K.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},w.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?we:Ce,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:Ce,isPropagationStopped:Ce,isImmediatePropagationStopped:Ce,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=we,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=we,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=we,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},w.event.addProp),w.each({focus:"focusin",blur:"focusout"},(function(e,t){w.event.special[e]={setup:function(){return Se(this,e,Ee),!1},trigger:function(){return Se(this,e),!0},_default:function(){return!0},delegateType:t}})),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return i&&(i===r||w.contains(r,i))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}})),w.fn.extend({on:function(e,t,n,r){return _e(this,e,t,n,r)},one:function(e,t,n,r){return _e(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,w(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Ce),this.each((function(){w.event.remove(this,e,n,t)}))}});var Oe=/<script|<style|<link/i,Ae=/checked\s*(?:[^=]|=\s*.checked.)/i,ke=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Me(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&w(e).children("tbody")[0]||e}function Te(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Pe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function De(e,t){var n,r,i,o,s,a;if(1===t.nodeType){if(K.hasData(e)&&(a=K.get(e).events))for(i in K.remove(t,"handle events"),a)for(n=0,r=a[i].length;n<r;n++)w.event.add(t,i,a[i][n]);Z.hasData(e)&&(o=Z.access(e),s=w.extend({},o),Z.set(t,s))}}function Ne(e,t){var n=t.nodeName.toLowerCase();"input"===n&&de.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Re(e,t,n,r){t=o(t);var i,s,a,l,c,u,h=0,d=e.length,g=d-1,m=t[0],v=p(m);if(v||d>1&&"string"==typeof m&&!f.checkClone&&Ae.test(m))return e.each((function(i){var o=e.eq(i);v&&(t[0]=m.call(this,i,o.html())),Re(o,t,n,r)}));if(d&&(s=(i=be(t,e[0].ownerDocument,!1,e,r)).firstChild,1===i.childNodes.length&&(i=s),s||r)){for(l=(a=w.map(me(i,"script"),Te)).length;h<d;h++)c=i,h!==g&&(c=w.clone(c,!0,!0),l&&w.merge(a,me(c,"script"))),n.call(e[h],c,h);if(l)for(u=a[a.length-1].ownerDocument,w.map(a,Pe),h=0;h<l;h++)c=a[h],pe.test(c.type||"")&&!K.access(c,"globalEval")&&w.contains(u,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?w._evalUrl&&!c.noModule&&w._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},u):y(c.textContent.replace(ke,""),c,u))}return e}function Ie(e,t,n){for(var r,i=t?w.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||w.cleanData(me(r)),r.parentNode&&(n&&oe(r)&&ve(me(r,"script")),r.parentNode.removeChild(r));return e}w.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,s,a=e.cloneNode(!0),l=oe(e);if(!(f.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(s=me(a),r=0,i=(o=me(e)).length;r<i;r++)Ne(o[r],s[r]);if(t)if(n)for(o=o||me(e),s=s||me(a),r=0,i=o.length;r<i;r++)De(o[r],s[r]);else De(e,a);return(s=me(a,"script")).length>0&&ve(s,!l&&me(e,"script")),a},cleanData:function(e){for(var t,n,r,i=w.event.special,o=0;void 0!==(n=e[o]);o++)if(Y(n)){if(t=n[K.expando]){if(t.events)for(r in t.events)i[r]?w.event.remove(n,r):w.removeEvent(n,r,t.handle);n[K.expando]=void 0}n[Z.expando]&&(n[Z.expando]=void 0)}}}),w.fn.extend({detach:function(e){return Ie(this,e,!0)},remove:function(e){return Ie(this,e)},text:function(e){return V(this,(function(e){return void 0===e?w.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return Re(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Me(this,e).appendChild(e)}))},prepend:function(){return Re(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Me(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return Re(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return Re(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(me(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return w.clone(this,e,t)}))},html:function(e){return V(this,(function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Oe.test(e)&&!ge[(fe.exec(e)||["",""])[1].toLowerCase()]){e=w.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(w.cleanData(me(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return Re(this,arguments,(function(t){var n=this.parentNode;w.inArray(this,e)<0&&(w.cleanData(me(this)),n&&n.replaceChild(t,this))}),e)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){w.fn[e]=function(e){for(var n,r=[],i=w(e),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),w(i[a])[t](n),s.apply(r,n.get());return this.pushStack(r)}}));var je=new RegExp("^("+te+")(?!px)[a-z%]+$","i"),Le=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},Fe=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Ge=new RegExp(re.join("|"),"i");function Be(e,t,n){var r,i,o,s,a=e.style;return(n=n||Le(e))&&(""!==(s=n.getPropertyValue(t)||n[t])||oe(e)||(s=w.style(e,t)),!f.pixelBoxStyles()&&je.test(s)&&Ge.test(t)&&(r=a.width,i=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=r,a.minWidth=i,a.maxWidth=o)),void 0!==s?s+"":s}function ze(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function t(){if(u){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ie.appendChild(c).appendChild(u);var t=e.getComputedStyle(u);r="1%"!==t.top,l=12===n(t.marginLeft),u.style.right="60%",s=36===n(t.right),i=36===n(t.width),u.style.position="absolute",o=12===n(u.offsetWidth/3),ie.removeChild(c),u=null}}function n(e){return Math.round(parseFloat(e))}var r,i,o,s,a,l,c=m.createElement("div"),u=m.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",f.clearCloneStyle="content-box"===u.style.backgroundClip,w.extend(f,{boxSizingReliable:function(){return t(),i},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),r},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),o},reliableTrDimensions:function(){var t,n,r,i;return null==a&&(t=m.createElement("table"),n=m.createElement("tr"),r=m.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",n.style.cssText="border:1px solid",n.style.height="1px",r.style.height="9px",r.style.display="block",ie.appendChild(t).appendChild(n).appendChild(r),i=e.getComputedStyle(n),a=parseInt(i.height,10)+parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)===n.offsetHeight,ie.removeChild(t)),a}}))}();var Ue=["Webkit","Moz","ms"],Ve=m.createElement("div").style,He={};function We(e){var t=w.cssProps[e]||He[e];return t||(e in Ve?e:He[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=Ue.length;n--;)if((e=Ue[n]+t)in Ve)return e}(e)||e)}var $e=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ye={position:"absolute",visibility:"hidden",display:"block"},qe={letterSpacing:"0",fontWeight:"400"};function Ke(e,t,n){var r=ne.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ze(e,t,n,r,i,o){var s="width"===t?1:0,a=0,l=0;if(n===(r?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(l+=w.css(e,n+re[s],!0,i)),r?("content"===n&&(l-=w.css(e,"padding"+re[s],!0,i)),"margin"!==n&&(l-=w.css(e,"border"+re[s]+"Width",!0,i))):(l+=w.css(e,"padding"+re[s],!0,i),"padding"!==n?l+=w.css(e,"border"+re[s]+"Width",!0,i):a+=w.css(e,"border"+re[s]+"Width",!0,i));return!r&&o>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-l-a-.5))||0),l}function Je(e,t,n){var r=Le(e),i=(!f.boxSizingReliable()||n)&&"border-box"===w.css(e,"boxSizing",!1,r),o=i,s=Be(e,t,r),a="offset"+t[0].toUpperCase()+t.slice(1);if(je.test(s)){if(!n)return s;s="auto"}return(!f.boxSizingReliable()&&i||!f.reliableTrDimensions()&&A(e,"tr")||"auto"===s||!parseFloat(s)&&"inline"===w.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===w.css(e,"boxSizing",!1,r),(o=a in e)&&(s=e[a])),(s=parseFloat(s)||0)+Ze(e,t,n||(i?"border":"content"),o,r,s)+"px"}function Qe(e,t,n,r,i){return new Qe.prototype.init(e,t,n,r,i)}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Be(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=X(t),l=Xe.test(t),c=e.style;if(l||(t=We(a)),s=w.cssHooks[t]||w.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(i=s.get(e,!1,r))?i:c[t];"string"===(o=typeof n)&&(i=ne.exec(n))&&i[1]&&(n=le(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||l||(n+=i&&i[3]||(w.cssNumber[a]?"":"px")),f.clearCloneStyle||""!==n||0!==t.indexOf("background")||(c[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,r))||(l?c.setProperty(t,n):c[t]=n))}},css:function(e,t,n,r){var i,o,s,a=X(t);return Xe.test(t)||(t=We(a)),(s=w.cssHooks[t]||w.cssHooks[a])&&"get"in s&&(i=s.get(e,!0,n)),void 0===i&&(i=Be(e,t,r)),"normal"===i&&t in qe&&(i=qe[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),w.each(["height","width"],(function(e,t){w.cssHooks[t]={get:function(e,n,r){if(n)return!$e.test(w.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Je(e,t,r):Fe(e,Ye,(function(){return Je(e,t,r)}))},set:function(e,n,r){var i,o=Le(e),s=!f.scrollboxSize()&&"absolute"===o.position,a=(s||r)&&"border-box"===w.css(e,"boxSizing",!1,o),l=r?Ze(e,t,r,a,o):0;return a&&s&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-Ze(e,t,"border",!1,o)-.5)),l&&(i=ne.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=w.css(e,t)),Ke(0,n,l)}}})),w.cssHooks.marginLeft=ze(f.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(Be(e,"marginLeft"))||e.getBoundingClientRect().left-Fe(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),w.each({margin:"",padding:"",border:"Width"},(function(e,t){w.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+re[r]+t]=o[r]||o[r-2]||o[0];return i}},"margin"!==e&&(w.cssHooks[e+t].set=Ke)})),w.fn.extend({css:function(e,t){return V(this,(function(e,t,n){var r,i,o={},s=0;if(Array.isArray(t)){for(r=Le(e),i=t.length;s<i;s++)o[t[s]]=w.css(e,t[s],!1,r);return o}return void 0!==n?w.style(e,t,n):w.css(e,t)}),e,t,arguments.length>1)}}),w.Tween=Qe,Qe.prototype={constructor:Qe,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(w.cssNumber[n]?"":"px")},cur:function(){var e=Qe.propHooks[this.prop];return e&&e.get?e.get(this):Qe.propHooks._default.get(this)},run:function(e){var t,n=Qe.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Qe.propHooks._default.set(this),this}},Qe.prototype.init.prototype=Qe.prototype,Qe.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||!w.cssHooks[e.prop]&&null==e.elem.style[We(e.prop)]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}},Qe.propHooks.scrollTop=Qe.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=Qe.prototype.init,w.fx.step={};var et,tt,nt,rt,it=/^(?:toggle|show|hide)$/,ot=/queueHooks$/;function st(){tt&&(!1===m.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(st):e.setTimeout(st,w.fx.interval),w.fx.tick())}function at(){return e.setTimeout((function(){et=void 0})),et=Date.now()}function lt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=re[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ct(e,t,n){for(var r,i=(ut.tweeners[t]||[]).concat(ut.tweeners["*"]),o=0,s=i.length;o<s;o++)if(r=i[o].call(n,t,e))return r}function ut(e,t,n){var r,i,o=0,s=ut.prefilters.length,a=w.Deferred().always((function(){delete l.elem})),l=function(){if(i)return!1;for(var t=et||at(),n=Math.max(0,c.startTime+c.duration-t),r=1-(n/c.duration||0),o=0,s=c.tweens.length;o<s;o++)c.tweens[o].run(r);return a.notifyWith(e,[c,r,n]),r<1&&s?n:(s||a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},n),originalProperties:t,originalOptions:n,startTime:et||at(),duration:n.duration,tweens:[],createTween:function(t,n){var r=w.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(r),r},stop:function(t){var n=0,r=t?c.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)c.tweens[n].run(1);return t?(a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c,t])):a.rejectWith(e,[c,t]),this}}),u=c.props;for(!function(e,t){var n,r,i,o,s;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(s=w.cssHooks[r])&&"expand"in s)for(n in o=s.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(u,c.opts.specialEasing);o<s;o++)if(r=ut.prefilters[o].call(c,e,u,c.opts))return p(r.stop)&&(w._queueHooks(c.elem,c.opts.queue).stop=r.stop.bind(r)),r;return w.map(u,ct,c),p(c.opts.start)&&c.opts.start.call(e,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),w.fx.timer(w.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c}w.Animation=w.extend(ut,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return le(n.elem,e,ne.exec(t),n),n}]},tweener:function(e,t){p(e)?(t=e,e=["*"]):e=e.match(j);for(var n,r=0,i=e.length;r<i;r++)n=e[r],ut.tweeners[n]=ut.tweeners[n]||[],ut.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,s,a,l,c,u,h="width"in t||"height"in t,d=this,f={},p=e.style,g=e.nodeType&&ae(e),m=K.get(e,"fxshow");for(r in n.queue||(null==(s=w._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always((function(){d.always((function(){s.unqueued--,w.queue(e,"fx").length||s.empty.fire()}))}))),t)if(i=t[r],it.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!m||void 0===m[r])continue;g=!0}f[r]=m&&m[r]||w.style(e,r)}if((l=!w.isEmptyObject(t))||!w.isEmptyObject(f))for(r in h&&1===e.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(c=m&&m.display)&&(c=K.get(e,"display")),"none"===(u=w.css(e,"display"))&&(c?u=c:(he([e],!0),c=e.style.display||c,u=w.css(e,"display"),he([e]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===w.css(e,"float")&&(l||(d.done((function(){p.display=c})),null==c&&(u=p.display,c="none"===u?"":u)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",d.always((function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}))),l=!1,f)l||(m?"hidden"in m&&(g=m.hidden):m=K.access(e,"fxshow",{display:c}),o&&(m.hidden=!g),g&&he([e],!0),d.done((function(){for(r in g||he([e]),K.remove(e,"fxshow"),f)w.style(e,r,f[r])}))),l=ct(g?m[r]:0,r,d),r in m||(m[r]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?ut.prefilters.unshift(e):ut.prefilters.push(e)}}),w.speed=function(e,t,n){var r=e&&"object"==typeof e?w.extend({},e):{complete:n||!n&&t||p(e)&&e,duration:e,easing:n&&t||t&&!p(t)&&t};return w.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in w.fx.speeds?r.duration=w.fx.speeds[r.duration]:r.duration=w.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){p(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=w.isEmptyObject(e),o=w.speed(t,n,r),s=function(){var t=ut(this,w.extend({},e),o);(i||K.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,i=null!=e&&e+"queueHooks",o=w.timers,s=K.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&ot.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||w.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=K.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=w.timers,s=r?r.length:0;for(n.finish=!0,w.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<s;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish}))}}),w.each(["toggle","show","hide"],(function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(lt(t,!0),e,r,i)}})),w.each({slideDown:lt("show"),slideUp:lt("hide"),slideToggle:lt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}})),w.timers=[],w.fx.tick=function(){var e,t=0,n=w.timers;for(et=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||w.fx.stop(),et=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){tt||(tt=!0,st())},w.fx.stop=function(){tt=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(t,n){return t=w.fx&&w.fx.speeds[t]||t,n=n||"fx",this.queue(n,(function(n,r){var i=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(i)}}))},nt=m.createElement("input"),rt=m.createElement("select").appendChild(m.createElement("option")),nt.type="checkbox",f.checkOn=""!==nt.value,f.optSelected=rt.selected,(nt=m.createElement("input")).value="t",nt.type="radio",f.radioValue="t"===nt.value;var ht,dt=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return V(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){w.removeAttr(this,e)}))}}),w.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?w.prop(e,t,n):(1===o&&w.isXMLDoc(e)||(i=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?ht:void 0)),void 0!==n?null===n?void w.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=w.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!f.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(j);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),ht={set:function(e,t,n){return!1===t?w.removeAttr(e,n):e.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=dt[t]||w.find.attr;dt[t]=function(e,t,r){var i,o,s=t.toLowerCase();return r||(o=dt[s],dt[s]=i,i=null!=n(e,t,r)?s:null,dt[s]=o),i}}));var ft=/^(?:input|select|textarea|button)$/i,pt=/^(?:a|area)$/i;function gt(e){return(e.match(j)||[]).join(" ")}function mt(e){return e.getAttribute&&e.getAttribute("class")||""}function vt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(j)||[]}w.fn.extend({prop:function(e,t){return V(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[w.propFix[e]||e]}))}}),w.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&w.isXMLDoc(e)||(t=w.propFix[t]||t,i=w.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):ft.test(e.nodeName)||pt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),f.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){w.propFix[this.toLowerCase()]=this})),w.fn.extend({addClass:function(e){var t,n,r,i,o,s,a,l=0;if(p(e))return this.each((function(t){w(this).addClass(e.call(this,t,mt(this)))}));if((t=vt(e)).length)for(;n=this[l++];)if(i=mt(n),r=1===n.nodeType&&" "+gt(i)+" "){for(s=0;o=t[s++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(a=gt(r))&&n.setAttribute("class",a)}return this},removeClass:function(e){var t,n,r,i,o,s,a,l=0;if(p(e))return this.each((function(t){w(this).removeClass(e.call(this,t,mt(this)))}));if(!arguments.length)return this.attr("class","");if((t=vt(e)).length)for(;n=this[l++];)if(i=mt(n),r=1===n.nodeType&&" "+gt(i)+" "){for(s=0;o=t[s++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");i!==(a=gt(r))&&n.setAttribute("class",a)}return this},toggleClass:function(e,t){var n=typeof e,r="string"===n||Array.isArray(e);return"boolean"==typeof t&&r?t?this.addClass(e):this.removeClass(e):p(e)?this.each((function(n){w(this).toggleClass(e.call(this,n,mt(this),t),t)})):this.each((function(){var t,i,o,s;if(r)for(i=0,o=w(this),s=vt(e);t=s[i++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else void 0!==e&&"boolean"!==n||((t=mt(this))&&K.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":K.get(this,"__className__")||""))}))},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+gt(mt(n))+" ").indexOf(t)>-1)return!0;return!1}});var yt=/\r/g;w.fn.extend({val:function(e){var t,n,r,i=this[0];return arguments.length?(r=p(e),this.each((function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,w(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=w.map(i,(function(e){return null==e?"":e+""}))),(t=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))}))):i?(t=w.valHooks[i.type]||w.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(yt,""):null==n?"":n:void 0}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:gt(w.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,s="select-one"===e.type,a=s?null:[],l=s?o+1:i.length;for(r=o<0?l:s?o:0;r<l;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=w(n).val(),s)return t;a.push(t)}return a},set:function(e,t){for(var n,r,i=e.options,o=w.makeArray(t),s=i.length;s--;)((r=i[s]).selected=w.inArray(w.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),w.each(["radio","checkbox"],(function(){w.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=w.inArray(w(e).val(),t)>-1}},f.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})})),f.focusin="onfocusin"in e;var bt=/^(?:focusinfocus|focusoutblur)$/,xt=function(e){e.stopPropagation()};w.extend(w.event,{trigger:function(t,n,r,i){var o,s,a,l,c,h,d,f,v=[r||m],y=u.call(t,"type")?t.type:t,b=u.call(t,"namespace")?t.namespace.split("."):[];if(s=f=a=r=r||m,3!==r.nodeType&&8!==r.nodeType&&!bt.test(y+w.event.triggered)&&(y.indexOf(".")>-1&&(b=y.split("."),y=b.shift(),b.sort()),c=y.indexOf(":")<0&&"on"+y,(t=t[w.expando]?t:new w.Event(y,"object"==typeof t&&t)).isTrigger=i?2:3,t.namespace=b.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:w.makeArray(n,[t]),d=w.event.special[y]||{},i||!d.trigger||!1!==d.trigger.apply(r,n))){if(!i&&!d.noBubble&&!g(r)){for(l=d.delegateType||y,bt.test(l+y)||(s=s.parentNode);s;s=s.parentNode)v.push(s),a=s;a===(r.ownerDocument||m)&&v.push(a.defaultView||a.parentWindow||e)}for(o=0;(s=v[o++])&&!t.isPropagationStopped();)f=s,t.type=o>1?l:d.bindType||y,(h=(K.get(s,"events")||Object.create(null))[t.type]&&K.get(s,"handle"))&&h.apply(s,n),(h=c&&s[c])&&h.apply&&Y(s)&&(t.result=h.apply(s,n),!1===t.result&&t.preventDefault());return t.type=y,i||t.isDefaultPrevented()||d._default&&!1!==d._default.apply(v.pop(),n)||!Y(r)||c&&p(r[y])&&!g(r)&&((a=r[c])&&(r[c]=null),w.event.triggered=y,t.isPropagationStopped()&&f.addEventListener(y,xt),r[y](),t.isPropagationStopped()&&f.removeEventListener(y,xt),w.event.triggered=void 0,a&&(r[c]=a)),t.result}},simulate:function(e,t,n){var r=w.extend(new w.Event,n,{type:e,isSimulated:!0});w.event.trigger(r,null,t)}}),w.fn.extend({trigger:function(e,t){return this.each((function(){w.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return w.event.trigger(e,t,n,!0)}}),f.focusin||w.each({focus:"focusin",blur:"focusout"},(function(e,t){var n=function(e){w.event.simulate(t,e.target,w.event.fix(e))};w.event.special[t]={setup:function(){var r=this.ownerDocument||this.document||this,i=K.access(r,t);i||r.addEventListener(e,n,!0),K.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,i=K.access(r,t)-1;i?K.access(r,t,i):(r.removeEventListener(e,n,!0),K.remove(r,t))}}}));var wt=e.location,Ct={guid:Date.now()},Et=/\?/;w.parseXML=function(t){var n,r;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){}return r=n&&n.getElementsByTagName("parsererror")[0],n&&!r||w.error("Invalid XML: "+(r?w.map(r.childNodes,(function(e){return e.textContent})).join("\n"):t)),n};var _t=/\[\]$/,St=/\r?\n/g,Ot=/^(?:submit|button|image|reset|file)$/i,At=/^(?:input|select|textarea|keygen)/i;function kt(e,t,n,r){var i;if(Array.isArray(t))w.each(t,(function(t,i){n||_t.test(e)?r(e,i):kt(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)}));else if(n||"object"!==b(t))r(e,t);else for(i in t)kt(e+"["+i+"]",t[i],n,r)}w.param=function(e,t){var n,r=[],i=function(e,t){var n=p(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,(function(){i(this.name,this.value)}));else for(n in e)kt(n,e[n],t,i);return r.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&At.test(this.nodeName)&&!Ot.test(e)&&(this.checked||!de.test(e))})).map((function(e,t){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,(function(e){return{name:t.name,value:e.replace(St,"\r\n")}})):{name:t.name,value:n.replace(St,"\r\n")}})).get()}});var Mt=/%20/g,Tt=/#.*$/,Pt=/([?&])_=[^&]*/,Dt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Nt=/^(?:GET|HEAD)$/,Rt=/^\/\//,It={},jt={},Lt="*/".concat("*"),Ft=m.createElement("a");function Gt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(j)||[];if(p(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Bt(e,t,n,r){var i={},o=e===jt;function s(a){var l;return i[a]=!0,w.each(e[a]||[],(function(e,a){var c=a(t,n,r);return"string"!=typeof c||o||i[c]?o?!(l=c):void 0:(t.dataTypes.unshift(c),s(c),!1)})),l}return s(t.dataTypes[0])||!i["*"]&&s("*")}function zt(e,t){var n,r,i=w.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&w.extend(!0,e,r),e}Ft.href=wt.href,w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:wt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(wt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Lt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?zt(zt(e,w.ajaxSettings),t):zt(w.ajaxSettings,e)},ajaxPrefilter:Gt(It),ajaxTransport:Gt(jt),ajax:function(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var r,i,o,s,a,l,c,u,h,d,f=w.ajaxSetup({},n),p=f.context||f,g=f.context&&(p.nodeType||p.jquery)?w(p):w.event,v=w.Deferred(),y=w.Callbacks("once memory"),b=f.statusCode||{},x={},C={},E="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(c){if(!s)for(s={};t=Dt.exec(o);)s[t[1].toLowerCase()+" "]=(s[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=s[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return c?o:null},setRequestHeader:function(e,t){return null==c&&(e=C[e.toLowerCase()]=C[e.toLowerCase()]||e,x[e]=t),this},overrideMimeType:function(e){return null==c&&(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)_.always(e[_.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||E;return r&&r.abort(t),S(0,t),this}};if(v.promise(_),f.url=((t||f.url||wt.href)+"").replace(Rt,wt.protocol+"//"),f.type=n.method||n.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(j)||[""],null==f.crossDomain){l=m.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=Ft.protocol+"//"+Ft.host!=l.protocol+"//"+l.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=w.param(f.data,f.traditional)),Bt(It,f,n,_),c)return _;for(h in(u=w.event&&f.global)&&0==w.active++&&w.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Nt.test(f.type),i=f.url.replace(Tt,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Mt,"+")):(d=f.url.slice(i.length),f.data&&(f.processData||"string"==typeof f.data)&&(i+=(Et.test(i)?"&":"?")+f.data,delete f.data),!1===f.cache&&(i=i.replace(Pt,"$1"),d=(Et.test(i)?"&":"?")+"_="+Ct.guid+++d),f.url=i+d),f.ifModified&&(w.lastModified[i]&&_.setRequestHeader("If-Modified-Since",w.lastModified[i]),w.etag[i]&&_.setRequestHeader("If-None-Match",w.etag[i])),(f.data&&f.hasContent&&!1!==f.contentType||n.contentType)&&_.setRequestHeader("Content-Type",f.contentType),_.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Lt+"; q=0.01":""):f.accepts["*"]),f.headers)_.setRequestHeader(h,f.headers[h]);if(f.beforeSend&&(!1===f.beforeSend.call(p,_,f)||c))return _.abort();if(E="abort",y.add(f.complete),_.done(f.success),_.fail(f.error),r=Bt(jt,f,n,_)){if(_.readyState=1,u&&g.trigger("ajaxSend",[_,f]),c)return _;f.async&&f.timeout>0&&(a=e.setTimeout((function(){_.abort("timeout")}),f.timeout));try{c=!1,r.send(x,S)}catch(e){if(c)throw e;S(-1,e)}}else S(-1,"No Transport");function S(t,n,s,l){var h,d,m,x,C,E=n;c||(c=!0,a&&e.clearTimeout(a),r=void 0,o=l||"",_.readyState=t>0?4:0,h=t>=200&&t<300||304===t,s&&(x=function(e,t,n){for(var r,i,o,s,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){l.unshift(i);break}if(l[0]in n)o=l[0];else{for(i in n){if(!l[0]||e.converters[i+" "+l[0]]){o=i;break}s||(s=i)}o=o||s}if(o)return o!==l[0]&&l.unshift(o),n[o]}(f,_,s)),!h&&w.inArray("script",f.dataTypes)>-1&&w.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),x=function(e,t,n,r){var i,o,s,a,l,c={},u=e.dataTypes.slice();if(u[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(o=u.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(s=c[l+" "+o]||c["* "+o]))for(i in c)if((a=i.split(" "))[1]===o&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[i]:!0!==c[i]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}(f,x,_,h),h?(f.ifModified&&((C=_.getResponseHeader("Last-Modified"))&&(w.lastModified[i]=C),(C=_.getResponseHeader("etag"))&&(w.etag[i]=C)),204===t||"HEAD"===f.type?E="nocontent":304===t?E="notmodified":(E=x.state,d=x.data,h=!(m=x.error))):(m=E,!t&&E||(E="error",t<0&&(t=0))),_.status=t,_.statusText=(n||E)+"",h?v.resolveWith(p,[d,E,_]):v.rejectWith(p,[_,E,m]),_.statusCode(b),b=void 0,u&&g.trigger(h?"ajaxSuccess":"ajaxError",[_,f,h?d:m]),y.fireWith(p,[_,E]),u&&(g.trigger("ajaxComplete",[_,f]),--w.active||w.event.trigger("ajaxStop")))}return _},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],(function(e,t){w[t]=function(e,n,r,i){return p(n)&&(i=i||r,r=n,n=void 0),w.ajax(w.extend({url:e,type:t,dataType:i,data:n,success:r},w.isPlainObject(e)&&e))}})),w.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),w._evalUrl=function(e,t,n){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){w.globalEval(e,t,n)}})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(p(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return p(e)?this.each((function(t){w(this).wrapInner(e.call(this,t))})):this.each((function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)}))},wrap:function(e){var t=p(e);return this.each((function(n){w(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){w(this).replaceWith(this.childNodes)})),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Ut={0:200,1223:204},Vt=w.ajaxSettings.xhr();f.cors=!!Vt&&"withCredentials"in Vt,f.ajax=Vt=!!Vt,w.ajaxTransport((function(t){var n,r;if(f.cors||Vt&&!t.crossDomain)return{send:function(i,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];for(s in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)a.setRequestHeader(s,i[s]);n=function(e){return function(){n&&(n=r=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Ut[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=n(),r=a.onerror=a.ontimeout=n("error"),void 0!==a.onabort?a.onabort=r:a.onreadystatechange=function(){4===a.readyState&&e.setTimeout((function(){n&&r()}))},n=n("abort");try{a.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}})),w.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),w.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(r,i){t=w("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),m.head.appendChild(t[0])},abort:function(){n&&n()}}}));var Ht,Wt=[],$t=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Wt.pop()||w.expando+"_"+Ct.guid++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",(function(t,n,r){var i,o,s,a=!1!==t.jsonp&&($t.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&$t.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return i=t.jsonpCallback=p(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace($t,"$1"+i):!1!==t.jsonp&&(t.url+=(Et.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||w.error(i+" was not called"),s[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){s=arguments},r.always((function(){void 0===o?w(e).removeProp(i):e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,Wt.push(i)),s&&p(o)&&o(s[0]),s=o=void 0})),"script"})),f.createHTMLDocument=((Ht=m.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ht.childNodes.length),w.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(f.createHTMLDocument?((r=(t=m.implementation.createHTMLDocument("")).createElement("base")).href=m.location.href,t.head.appendChild(r)):t=m),o=!n&&[],(i=k.exec(e))?[t.createElement(i[1])]:(i=be([e],t,o),o&&o.length&&w(o).remove(),w.merge([],i.childNodes)));var r,i,o},w.fn.load=function(e,t,n){var r,i,o,s=this,a=e.indexOf(" ");return a>-1&&(r=gt(e.slice(a)),e=e.slice(0,a)),p(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),s.length>0&&w.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done((function(e){o=arguments,s.html(r?w("<div>").append(w.parseHTML(e)).find(r):e)})).always(n&&function(e,t){s.each((function(){n.apply(this,o||[e.responseText,t,e])}))}),this},w.expr.pseudos.animated=function(e){return w.grep(w.timers,(function(t){return e===t.elem})).length},w.offset={setOffset:function(e,t,n){var r,i,o,s,a,l,c=w.css(e,"position"),u=w(e),h={};"static"===c&&(e.style.position="relative"),a=u.offset(),o=w.css(e,"top"),l=w.css(e,"left"),("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1?(s=(r=u.position()).top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(l)||0),p(t)&&(t=t.call(e,n,w.extend({},a))),null!=t.top&&(h.top=t.top-a.top+s),null!=t.left&&(h.left=t.left-a.left+i),"using"in t?t.using.call(e,h):u.css(h)}},w.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){w.offset.setOffset(this,e,t)}));var t,n,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===w.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===w.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=w(e).offset()).top+=w.css(e,"borderTopWidth",!0),i.left+=w.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-w.css(r,"marginTop",!0),left:t.left-i.left-w.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===w.css(e,"position");)e=e.offsetParent;return e||ie}))}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;w.fn[e]=function(r){return V(this,(function(e,r,i){var o;if(g(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===i)return o?o[t]:e[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i}),e,r,arguments.length)}})),w.each(["top","left"],(function(e,t){w.cssHooks[t]=ze(f.pixelPosition,(function(e,n){if(n)return n=Be(e,t),je.test(n)?w(e).position()[t]+"px":n}))})),w.each({Height:"height",Width:"width"},(function(e,t){w.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,r){w.fn[r]=function(i,o){var s=arguments.length&&(n||"boolean"!=typeof i),a=n||(!0===i||!0===o?"margin":"border");return V(this,(function(t,n,i){var o;return g(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?w.css(t,n,a):w.style(t,n,i,a)}),t,s?i:void 0,s)}}))})),w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){w.fn[t]=function(e){return this.on(t,e)}})),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}));var Xt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;w.proxy=function(e,t){var n,r,o;if("string"==typeof t&&(n=e[t],t=e,e=n),p(e))return r=i.call(arguments,2),o=function(){return e.apply(t||this,r.concat(i.call(arguments)))},o.guid=e.guid=e.guid||w.guid++,o},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=A,w.isFunction=p,w.isWindow=g,w.camelCase=X,w.type=b,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},w.trim=function(e){return null==e?"":(e+"").replace(Xt,"")};var Yt=e.jQuery,qt=e.$;return w.noConflict=function(t){return e.$===w&&(e.$=qt),t&&e.jQuery===w&&(e.jQuery=Yt),w},void 0===t&&(e.jQuery=e.$=w),w}))}(dr);var fr=dr.exports;
/*!
	 * jQuery Mousewheel 3.1.13
	 *
	 * Copyright jQuery Foundation and other contributors
	 * Released under the MIT license
	 * http://jquery.org/license
	 */
!function(e,t){e.exports=function(e){var t,n,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],i="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],o=Array.prototype.slice;if(e.event.fixHooks)for(var s=r.length;s;)e.event.fixHooks[r[--s]]=e.event.mouseHooks;var a=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=i.length;t;)this.addEventListener(i[--t],l,!1);else this.onmousewheel=l;e.data(this,"mousewheel-line-height",a.getLineHeight(this)),e.data(this,"mousewheel-page-height",a.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=i.length;t;)this.removeEventListener(i[--t],l,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t),r=n["offsetParent"in e.fn?"offsetParent":"parent"]();return r.length||(r=e("body")),parseInt(r.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function l(r){var i=r||window.event,s=o.call(arguments,1),l=0,h=0,d=0,f=0,p=0,g=0;if((r=e.event.fix(i)).type="mousewheel","detail"in i&&(d=-1*i.detail),"wheelDelta"in i&&(d=i.wheelDelta),"wheelDeltaY"in i&&(d=i.wheelDeltaY),"wheelDeltaX"in i&&(h=-1*i.wheelDeltaX),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(h=-1*d,d=0),l=0===d?h:d,"deltaY"in i&&(l=d=-1*i.deltaY),"deltaX"in i&&(h=i.deltaX,0===d&&(l=-1*h)),0!==d||0!==h){if(1===i.deltaMode){var m=e.data(this,"mousewheel-line-height");l*=m,d*=m,h*=m}else if(2===i.deltaMode){var v=e.data(this,"mousewheel-page-height");l*=v,d*=v,h*=v}if(f=Math.max(Math.abs(d),Math.abs(h)),(!n||f<n)&&(n=f,u(i,f)&&(n/=40)),u(i,f)&&(l/=40,h/=40,d/=40),l=Math[l>=1?"floor":"ceil"](l/n),h=Math[h>=1?"floor":"ceil"](h/n),d=Math[d>=1?"floor":"ceil"](d/n),a.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();p=r.clientX-y.left,g=r.clientY-y.top}return r.deltaX=h,r.deltaY=d,r.deltaFactor=n,r.offsetX=p,r.offsetY=g,r.deltaMode=0,s.unshift(r,l,h,d),t&&clearTimeout(t),t=setTimeout(c,200),(e.event.dispatch||e.event.handle).apply(this,s)}}function c(){n=null}function u(e,t){return a.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}}({exports:{}});const pr=navigator.userAgent;var gr;if(function(e){e.IS_MAC=navigator.appVersion.indexOf("Mac")>0,e.IS_IOS=!!pr.match(/(iPad|iPhone|iPod)/g),e.IS_WINDOWS=navigator.appVersion.indexOf("Win")>0,e.IS_IE=pr.indexOf("MSIE")>=0,e.IS_IE11=!!pr.match(/Trident\/7\./),e.IS_EDGE=!!pr.match(/Edge\//),e.IS_NETSCAPE=pr.indexOf("Mozilla/")>=0&&pr.indexOf("MSIE")<0&&pr.indexOf("Edge/")<0,e.IS_CHROME_APP=null!=window.chrome&&null!=window.chrome.app&&null!=window.chrome.app.runtime,e.IS_CHROME=pr.indexOf("Chrome/")>=0&&pr.indexOf("Edge/")<0,e.IS_OPERA=pr.indexOf("Opera/")>=0||pr.indexOf("OPR/")>=0,e.IS_FIREFOX=pr.indexOf("Firefox/")>=0,e.IS_SAFARI=pr.indexOf("AppleWebKit/")>=0&&pr.indexOf("Chrome/")<0&&pr.indexOf("Edge/")<0,e.SUPPORT_TOUCH="ontouchstart"in document.documentElement,e.SUPPORT_POINTER=null!=window.PointerEvent&&!e.IS_MAC,e.SUPPORT_PASSIVE=!1;try{const t=Object.defineProperty({},"passive",{get(){e.SUPPORT_PASSIVE=!0}}),n=document.createElement("div");n.addEventListener&&n.addEventListener("click",(()=>{}),t)}catch(e){}e.NO_FOREIGNOBJECT=!document.createElementNS||"[object SVGForeignObjectElement]"!=`${document.createElementNS("http://www.w3.org/2000/svg","foreignObject")}`||pr.indexOf("Opera/")>=0,e.SUPPORT_FOREIGNOBJECT=!e.NO_FOREIGNOBJECT}(gr||(gr={})),function(e){function t(){const e=window.module;return null!=e&&null!=e.hot&&null!=e.hot.status?e.hot.status():"unkonwn"}e.getHMRStatus=t,e.isApplyingHMR=function(){return"apply"===t()};const n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};e.isEventSupported=function(e){const t=document.createElement(n[e]||"div"),r=`on${e}`;let i=r in t;return i||(t.setAttribute(r,"return;"),i="function"==typeof t[r]),i}}(gr||(gr={})),gr.SUPPORT_PASSIVE){fr.event.special.touchstart={setup(e,t,n){if(!this.addEventListener)return!1;this.addEventListener("touchstart",n,{passive:!0})}};const e=fr.event.special.mousewheel;if(e){const t=e.setup;e.setup=function(){const e=this.addEventListener;if(!e)return!1;this.addEventListener=(t,n)=>{e.call(this,t,n,{passive:!0})},t.call(this),this.addEventListener=e}}}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach((e=>{Object.prototype.hasOwnProperty.call(e,"append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value(...e){const t=document.createDocumentFragment();e.forEach((e=>{const n=e instanceof Node;t.appendChild(n?e:document.createTextNode(String(e)))})),this.appendChild(t)}})}));var mr="object"==typeof global&&global&&global.Object===Object&&global,vr="object"==typeof self&&self&&self.Object===Object&&self,yr=mr||vr||Function("return this")(),br=yr.Symbol,xr=Object.prototype,wr=xr.hasOwnProperty,Cr=xr.toString,Er=br?br.toStringTag:void 0;var _r=Object.prototype.toString;var Sr=br?br.toStringTag:void 0;function Or(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Sr&&Sr in Object(e)?function(e){var t=wr.call(e,Er),n=e[Er];try{e[Er]=void 0;var r=!0}catch(e){}var i=Cr.call(e);return r&&(t?e[Er]=n:delete e[Er]),i}(e):function(e){return _r.call(e)}(e)}function Ar(e){return null!=e&&"object"==typeof e}function kr(e){return"symbol"==typeof e||Ar(e)&&"[object Symbol]"==Or(e)}function Mr(e){return"number"==typeof e?e:kr(e)?NaN:+e}function Tr(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var Pr=Array.isArray,Dr=br?br.prototype:void 0,Nr=Dr?Dr.toString:void 0;function Rr(e){if("string"==typeof e)return e;if(Pr(e))return Tr(e,Rr)+"";if(kr(e))return Nr?Nr.call(e):"";var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}function Ir(e,t){return function(n,r){var i;if(void 0===n&&void 0===r)return t;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=Rr(n),r=Rr(r)):(n=Mr(n),r=Mr(r)),i=e(n,r)}return i}}var jr=Ir((function(e,t){return e+t}),0),Lr=/\s/;function Fr(e){for(var t=e.length;t--&&Lr.test(e.charAt(t)););return t}var Gr=/^\s+/;function Br(e){return e?e.slice(0,Fr(e)+1).replace(Gr,""):e}function zr(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var Ur=/^[-+]0x[0-9a-f]+$/i,Vr=/^0b[01]+$/i,Hr=/^0o[0-7]+$/i,Wr=parseInt;function $r(e){if("number"==typeof e)return e;if(kr(e))return NaN;if(zr(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=zr(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Br(e);var n=Vr.test(e);return n||Hr.test(e)?Wr(e.slice(2),n?2:8):Ur.test(e)?NaN:+e}var Xr=1/0;function Yr(e){return e?(e=$r(e))===Xr||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function qr(e){var t=Yr(e),n=t%1;return t==t?n?t-n:t:0}function Kr(e){return e}function Zr(e){if(!zr(e))return!1;var t=Or(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var Jr,Qr=yr["__core-js_shared__"],ei=(Jr=/[^.]+$/.exec(Qr&&Qr.keys&&Qr.keys.IE_PROTO||""))?"Symbol(src)_1."+Jr:"";var ti=Function.prototype.toString;function ni(e){if(null!=e){try{return ti.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var ri=/^\[object .+?Constructor\]$/,ii=Function.prototype,oi=Object.prototype,si=ii.toString,ai=oi.hasOwnProperty,li=RegExp("^"+si.call(ai).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ci(e){return!(!zr(e)||function(e){return!!ei&&ei in e}(e))&&(Zr(e)?li:ri).test(ni(e))}function ui(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return ci(n)?n:void 0}var hi=ui(yr,"WeakMap"),di=hi&&new hi,fi=di?function(e,t){return di.set(e,t),e}:Kr,pi=Object.create,gi=function(){function e(){}return function(t){if(!zr(t))return{};if(pi)return pi(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function mi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=gi(e.prototype),r=e.apply(n,t);return zr(r)?r:n}}function vi(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var yi=Math.max;function bi(e,t,n,r){for(var i=-1,o=e.length,s=n.length,a=-1,l=t.length,c=yi(o-s,0),u=Array(l+c),h=!r;++a<l;)u[a]=t[a];for(;++i<s;)(h||i<o)&&(u[n[i]]=e[i]);for(;c--;)u[a++]=e[i++];return u}var xi=Math.max;function wi(e,t,n,r){for(var i=-1,o=e.length,s=-1,a=n.length,l=-1,c=t.length,u=xi(o-a,0),h=Array(u+c),d=!r;++i<u;)h[i]=e[i];for(var f=i;++l<c;)h[f+l]=t[l];for(;++s<a;)(d||i<o)&&(h[f+n[s]]=e[i++]);return h}function Ci(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}function Ei(){}function _i(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Si(){}_i.prototype=gi(Ei.prototype),_i.prototype.constructor=_i;var Oi=di?function(e){return di.get(e)}:Si,Ai={},ki=Object.prototype.hasOwnProperty;function Mi(e){for(var t=e.name+"",n=Ai[t],r=ki.call(Ai,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function Ti(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function Pi(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function Di(e){if(e instanceof _i)return e.clone();var t=new Ti(e.__wrapped__,e.__chain__);return t.__actions__=Pi(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}Ti.prototype=gi(Ei.prototype),Ti.prototype.constructor=Ti;var Ni=Object.prototype.hasOwnProperty;function Ri(e){if(Ar(e)&&!Pr(e)&&!(e instanceof _i)){if(e instanceof Ti)return e;if(Ni.call(e,"__wrapped__"))return Di(e)}return new Ti(e)}function Ii(e){var t=Mi(e),n=Ri[t];if("function"!=typeof n||!(t in _i.prototype))return!1;if(e===n)return!0;var r=Oi(n);return!!r&&e===r[0]}Ri.prototype=Ei.prototype,Ri.prototype.constructor=Ri;var ji=Date.now;function Li(e){var t=0,n=0;return function(){var r=ji(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Fi=Li(fi),Gi=/\{\n\/\* \[wrapped with (.+)\] \*/,Bi=/,? & /;var zi=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function Ui(e){return function(){return e}}var Vi=function(){try{var e=ui(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Hi=Vi?function(e,t){return Vi(e,"toString",{configurable:!0,enumerable:!1,value:Ui(t),writable:!0})}:Kr,Wi=Li(Hi);function $i(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Xi(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Yi(e){return e!=e}function qi(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Xi(e,Yi,n)}function Ki(e,t){return!!(null==e?0:e.length)&&qi(e,t,0)>-1}var Zi=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];function Ji(e,t,n){var r=t+"";return Wi(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(zi,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return $i(Zi,(function(n){var r="_."+n[0];t&n[1]&&!Ki(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(Gi);return t?t[1].split(Bi):[]}(r),n)))}function Qi(e,t,n,r,i,o,s,a,l,c){var u=8&t;t|=u?32:64,4&(t&=~(u?64:32))||(t&=-4);var h=[e,t,i,u?o:void 0,u?s:void 0,u?void 0:o,u?void 0:s,a,l,c],d=n.apply(void 0,h);return Ii(e)&&Fi(d,h),d.placeholder=r,Ji(d,e,t)}function eo(e){return e.placeholder}var to=/^(?:0|[1-9]\d*)$/;function no(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&to.test(e))&&e>-1&&e%1==0&&e<t}var ro=Math.min;function io(e,t){for(var n=e.length,r=ro(t.length,n),i=Pi(e);r--;){var o=t[r];e[r]=no(o,n)?i[o]:void 0}return e}var oo="__lodash_placeholder__";function so(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n];s!==t&&s!==oo||(e[n]=oo,o[i++]=n)}return o}function ao(e,t,n,r,i,o,s,a,l,c){var u=128&t,h=1&t,d=2&t,f=24&t,p=512&t,g=d?void 0:mi(e);return function m(){for(var v=arguments.length,y=Array(v),b=v;b--;)y[b]=arguments[b];if(f)var x=eo(m),w=Ci(y,x);if(r&&(y=bi(y,r,i,f)),o&&(y=wi(y,o,s,f)),v-=w,f&&v<c){var C=so(y,x);return Qi(e,t,ao,m.placeholder,n,y,C,a,l,c-v)}var E=h?n:this,_=d?E[e]:e;return v=y.length,a?y=io(y,a):p&&v>1&&y.reverse(),u&&l<v&&(y.length=l),this&&this!==yr&&this instanceof m&&(_=g||mi(_)),_.apply(E,y)}}var lo="__lodash_placeholder__",co=128,uo=Math.min;var ho=Math.max;function fo(e,t,n,r,i,o,s,a){var l=2&t;if(!l&&"function"!=typeof e)throw new TypeError("Expected a function");var c=r?r.length:0;if(c||(t&=-97,r=i=void 0),s=void 0===s?s:ho(qr(s),0),a=void 0===a?a:qr(a),c-=i?i.length:0,64&t){var u=r,h=i;r=i=void 0}var d=l?void 0:Oi(e),f=[e,t,n,r,i,u,h,o,s,a];if(d&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,s=r==co&&8==n||r==co&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!s)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var a=t[3];if(a){var l=e[3];e[3]=l?bi(l,a,t[4]):a,e[4]=l?so(e[3],lo):t[4]}(a=t[5])&&(l=e[5],e[5]=l?wi(l,a,t[6]):a,e[6]=l?so(e[5],lo):t[6]),(a=t[7])&&(e[7]=a),r&co&&(e[8]=null==e[8]?t[8]:uo(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(f,d),e=f[0],t=f[1],n=f[2],r=f[3],i=f[4],!(a=f[9]=void 0===f[9]?l?0:e.length:ho(f[9]-c,0))&&24&t&&(t&=-25),t&&1!=t)p=8==t||16==t?function(e,t,n){var r=mi(e);return function i(){for(var o=arguments.length,s=Array(o),a=o,l=eo(i);a--;)s[a]=arguments[a];var c=o<3&&s[0]!==l&&s[o-1]!==l?[]:so(s,l);return(o-=c.length)<n?Qi(e,t,ao,i.placeholder,void 0,s,c,void 0,void 0,n-o):vi(this&&this!==yr&&this instanceof i?r:e,this,s)}}(e,t,a):32!=t&&33!=t||i.length?ao.apply(void 0,f):function(e,t,n,r){var i=1&t,o=mi(e);return function t(){for(var s=-1,a=arguments.length,l=-1,c=r.length,u=Array(c+a),h=this&&this!==yr&&this instanceof t?o:e;++l<c;)u[l]=r[l];for(;a--;)u[l++]=arguments[++s];return vi(h,i?n:this,u)}}(e,t,n,r);else var p=function(e,t,n){var r=1&t,i=mi(e);return function t(){return(this&&this!==yr&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return Ji((d?fi:Fi)(p,f),e,t)}function po(e,t,n){return t=n?void 0:t,fo(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function go(e,t,n){"__proto__"==t&&Vi?Vi(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function mo(e,t){return e===t||e!=e&&t!=t}var vo=Object.prototype.hasOwnProperty;function yo(e,t,n){var r=e[t];vo.call(e,t)&&mo(r,n)&&(void 0!==n||t in e)||go(e,t,n)}function bo(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var a=t[o],l=r?r(n[a],e[a],a,n,e):void 0;void 0===l&&(l=e[a]),i?go(n,a,l):yo(n,a,l)}return n}var xo=Math.max;function wo(e,t,n){return t=xo(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=xo(r.length-t,0),s=Array(o);++i<o;)s[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(s),vi(e,this,a)}}function Co(e,t){return Wi(wo(e,t,Kr),e+"")}function Eo(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function _o(e){return null!=e&&Eo(e.length)&&!Zr(e)}function So(e,t,n){if(!zr(n))return!1;var r=typeof t;return!!("number"==r?_o(n)&&no(t,n.length):"string"==r&&t in n)&&mo(n[t],e)}function Oo(e){return Co((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&So(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var a=n[r];a&&e(t,a,r,o)}return t}))}var Ao=Object.prototype;function ko(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ao)}function Mo(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function To(e){return Ar(e)&&"[object Arguments]"==Or(e)}var Po=Object.prototype,Do=Po.hasOwnProperty,No=Po.propertyIsEnumerable,Ro=To(function(){return arguments}())?To:function(e){return Ar(e)&&Do.call(e,"callee")&&!No.call(e,"callee")};function Io(){return!1}var jo="object"==typeof e&&e&&!e.nodeType&&e,Lo=jo&&"object"==typeof module&&module&&!module.nodeType&&module,Fo=Lo&&Lo.exports===jo?yr.Buffer:void 0,Go=(Fo?Fo.isBuffer:void 0)||Io,Bo={};function zo(e){return function(t){return e(t)}}Bo["[object Float32Array]"]=Bo["[object Float64Array]"]=Bo["[object Int8Array]"]=Bo["[object Int16Array]"]=Bo["[object Int32Array]"]=Bo["[object Uint8Array]"]=Bo["[object Uint8ClampedArray]"]=Bo["[object Uint16Array]"]=Bo["[object Uint32Array]"]=!0,Bo["[object Arguments]"]=Bo["[object Array]"]=Bo["[object ArrayBuffer]"]=Bo["[object Boolean]"]=Bo["[object DataView]"]=Bo["[object Date]"]=Bo["[object Error]"]=Bo["[object Function]"]=Bo["[object Map]"]=Bo["[object Number]"]=Bo["[object Object]"]=Bo["[object RegExp]"]=Bo["[object Set]"]=Bo["[object String]"]=Bo["[object WeakMap]"]=!1;var Uo="object"==typeof e&&e&&!e.nodeType&&e,Vo=Uo&&"object"==typeof module&&module&&!module.nodeType&&module,Ho=Vo&&Vo.exports===Uo&&mr.process,Wo=function(){try{var e=Vo&&Vo.require&&Vo.require("util").types;return e||Ho&&Ho.binding&&Ho.binding("util")}catch(e){}}(),$o=Wo&&Wo.isTypedArray,Xo=$o?zo($o):function(e){return Ar(e)&&Eo(e.length)&&!!Bo[Or(e)]},Yo=Object.prototype.hasOwnProperty;function qo(e,t){var n=Pr(e),r=!n&&Ro(e),i=!n&&!r&&Go(e),o=!n&&!r&&!i&&Xo(e),s=n||r||i||o,a=s?Mo(e.length,String):[],l=a.length;for(var c in e)!t&&!Yo.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||no(c,l))||a.push(c);return a}function Ko(e,t){return function(n){return e(t(n))}}var Zo=Ko(Object.keys,Object),Jo=Object.prototype.hasOwnProperty;function Qo(e){if(!ko(e))return Zo(e);var t=[];for(var n in Object(e))Jo.call(e,n)&&"constructor"!=n&&t.push(n);return t}function es(e){return _o(e)?qo(e):Qo(e)}var ts=Object.prototype.hasOwnProperty,ns=Oo((function(e,t){if(ko(t)||_o(t))bo(t,es(t),e);else for(var n in t)ts.call(t,n)&&yo(e,n,t[n])}));var rs=Object.prototype.hasOwnProperty;function is(e){if(!zr(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=ko(e),n=[];for(var r in e)("constructor"!=r||!t&&rs.call(e,r))&&n.push(r);return n}function os(e){return _o(e)?qo(e,!0):is(e)}var ss=Oo((function(e,t){bo(t,os(t),e)})),as=Oo((function(e,t,n,r){bo(t,os(t),e,r)})),ls=Oo((function(e,t,n,r){bo(t,es(t),e,r)})),cs=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,us=/^\w*$/;function hs(e,t){if(Pr(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!kr(e))||(us.test(e)||!cs.test(e)||null!=t&&e in Object(t))}var ds=ui(Object,"create");var fs=Object.prototype.hasOwnProperty;var ps=Object.prototype.hasOwnProperty;function gs(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ms(e,t){for(var n=e.length;n--;)if(mo(e[n][0],t))return n;return-1}gs.prototype.clear=function(){this.__data__=ds?ds(null):{},this.size=0},gs.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},gs.prototype.get=function(e){var t=this.__data__;if(ds){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return fs.call(t,e)?t[e]:void 0},gs.prototype.has=function(e){var t=this.__data__;return ds?void 0!==t[e]:ps.call(t,e)},gs.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ds&&void 0===t?"__lodash_hash_undefined__":t,this};var vs=Array.prototype.splice;function ys(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ys.prototype.clear=function(){this.__data__=[],this.size=0},ys.prototype.delete=function(e){var t=this.__data__,n=ms(t,e);return!(n<0)&&(n==t.length-1?t.pop():vs.call(t,n,1),--this.size,!0)},ys.prototype.get=function(e){var t=this.__data__,n=ms(t,e);return n<0?void 0:t[n][1]},ys.prototype.has=function(e){return ms(this.__data__,e)>-1},ys.prototype.set=function(e,t){var n=this.__data__,r=ms(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var bs=ui(yr,"Map");function xs(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function ws(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ws.prototype.clear=function(){this.size=0,this.__data__={hash:new gs,map:new(bs||ys),string:new gs}},ws.prototype.delete=function(e){var t=xs(this,e).delete(e);return this.size-=t?1:0,t},ws.prototype.get=function(e){return xs(this,e).get(e)},ws.prototype.has=function(e){return xs(this,e).has(e)},ws.prototype.set=function(e,t){var n=xs(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function Cs(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Cs.Cache||ws),n}Cs.Cache=ws;var Es=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,_s=/\\(\\)?/g,Ss=function(e){var t=Cs(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Es,(function(e,n,r,i){t.push(r?i.replace(_s,"$1"):n||e)})),t}));function Os(e){return null==e?"":Rr(e)}function As(e,t){return Pr(e)?e:hs(e,t)?[e]:Ss(Os(e))}function ks(e){if("string"==typeof e||kr(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}function Ms(e,t){for(var n=0,r=(t=As(t,e)).length;null!=e&&n<r;)e=e[ks(t[n++])];return n&&n==r?e:void 0}function Ts(e,t,n){var r=null==e?void 0:Ms(e,t);return void 0===r?n:r}function Ps(e,t){for(var n=-1,r=t.length,i=Array(r),o=null==e;++n<r;)i[n]=o?void 0:Ts(e,t[n]);return i}function Ds(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var Ns=br?br.isConcatSpreadable:void 0;function Rs(e){return Pr(e)||Ro(e)||!!(Ns&&e&&e[Ns])}function Is(e,t,n,r,i){var o=-1,s=e.length;for(n||(n=Rs),i||(i=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?Is(a,t-1,n,r,i):Ds(i,a):r||(i[i.length]=a)}return i}function js(e){return(null==e?0:e.length)?Is(e,1):[]}function Ls(e){return Wi(wo(e,void 0,js),e+"")}var Fs=Ls(Ps),Gs=Ko(Object.getPrototypeOf,Object),Bs=Function.prototype,zs=Object.prototype,Us=Bs.toString,Vs=zs.hasOwnProperty,Hs=Us.call(Object);function Ws(e){if(!Ar(e)||"[object Object]"!=Or(e))return!1;var t=Gs(e);if(null===t)return!0;var n=Vs.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Us.call(n)==Hs}function $s(e){if(!Ar(e))return!1;var t=Or(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Ws(e)}var Xs=Co((function(e,t){try{return vi(e,void 0,t)}catch(e){return $s(e)?e:new Error(e)}}));function Ys(e,t){var n;if("function"!=typeof t)throw new TypeError("Expected a function");return e=qr(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var qs=Co((function(e,t,n){var r=1;if(n.length){var i=so(n,eo(qs));r|=32}return fo(e,r,t,n,i)}));qs.placeholder={};var Ks=Ls((function(e,t){return $i(t,(function(t){t=ks(t),go(e,t,qs(e[t],e))})),e})),Zs=Co((function(e,t,n){var r=3;if(n.length){var i=so(n,eo(Zs));r|=32}return fo(t,r,e,n,i)}));function Js(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}function Qs(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:Js(e,t,n)}Zs.placeholder={};var ea=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function ta(e){return ea.test(e)}var na="[\\ud800-\\udfff]",ra="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ia="\\ud83c[\\udffb-\\udfff]",oa="[^\\ud800-\\udfff]",sa="(?:\\ud83c[\\udde6-\\uddff]){2}",aa="[\\ud800-\\udbff][\\udc00-\\udfff]",la="(?:"+ra+"|"+ia+")"+"?",ca="[\\ufe0e\\ufe0f]?",ua=ca+la+("(?:\\u200d(?:"+[oa,sa,aa].join("|")+")"+ca+la+")*"),ha="(?:"+[oa+ra+"?",ra,sa,aa,na].join("|")+")",da=RegExp(ia+"(?="+ia+")|"+ha+ua,"g");function fa(e){return ta(e)?function(e){return e.match(da)||[]}(e):function(e){return e.split("")}(e)}function pa(e){return function(t){var n=ta(t=Os(t))?fa(t):void 0,r=n?n[0]:t.charAt(0),i=n?Qs(n,1).join(""):t.slice(1);return r[e]()+i}}var ga=pa("toUpperCase");function ma(e){return ga(Os(e).toLowerCase())}function va(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function ya(e){return function(t){return null==e?void 0:e[t]}}var ba=ya({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),xa=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,wa=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");function Ca(e){return(e=Os(e))&&e.replace(xa,ba).replace(wa,"")}var Ea=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var _a=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var Sa="\\u2700-\\u27bf",Oa="a-z\\xdf-\\xf6\\xf8-\\xff",Aa="A-Z\\xc0-\\xd6\\xd8-\\xde",ka="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ma="["+ka+"]",Ta="\\d+",Pa="[\\u2700-\\u27bf]",Da="["+Oa+"]",Na="[^\\ud800-\\udfff"+ka+Ta+Sa+Oa+Aa+"]",Ra="(?:\\ud83c[\\udde6-\\uddff]){2}",Ia="[\\ud800-\\udbff][\\udc00-\\udfff]",ja="["+Aa+"]",La="(?:"+Da+"|"+Na+")",Fa="(?:"+ja+"|"+Na+")",Ga="(?:['’](?:d|ll|m|re|s|t|ve))?",Ba="(?:['’](?:D|LL|M|RE|S|T|VE))?",za="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",Ua="[\\ufe0e\\ufe0f]?",Va=Ua+za+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",Ra,Ia].join("|")+")"+Ua+za+")*"),Ha="(?:"+[Pa,Ra,Ia].join("|")+")"+Va,Wa=RegExp([ja+"?"+Da+"+"+Ga+"(?="+[Ma,ja,"$"].join("|")+")",Fa+"+"+Ba+"(?="+[Ma,ja+La,"$"].join("|")+")",ja+"?"+La+"+"+Ga,ja+"+"+Ba,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ta,Ha].join("|"),"g");function $a(e,t,n){return e=Os(e),void 0===(t=n?void 0:t)?function(e){return _a.test(e)}(e)?function(e){return e.match(Wa)||[]}(e):function(e){return e.match(Ea)||[]}(e):e.match(t)||[]}var Xa=RegExp("['’]","g");function Ya(e){return function(t){return va($a(Ca(t).replace(Xa,"")),e,"")}}var qa=Ya((function(e,t,n){return t=t.toLowerCase(),e+(n?ma(t):t)}));var Ka=yr.isFinite,Za=Math.min;function Ja(e){var t=Math[e];return function(e,n){if(e=$r(e),(n=null==n?0:Za(qr(n),292))&&Ka(e)){var r=(Os(e)+"e").split("e");return+((r=(Os(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Qa=Ja("ceil");function el(e){var t=Ri(e);return t.__chain__=!0,t}var tl=Math.ceil,nl=Math.max;function rl(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function il(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=$r(n))==n?n:0),void 0!==t&&(t=(t=$r(t))==t?t:0),rl($r(e),t,n)}function ol(e){var t=this.__data__=new ys(e);this.size=t.size}function sl(e,t){return e&&bo(t,es(t),e)}ol.prototype.clear=function(){this.__data__=new ys,this.size=0},ol.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},ol.prototype.get=function(e){return this.__data__.get(e)},ol.prototype.has=function(e){return this.__data__.has(e)},ol.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ys){var r=n.__data__;if(!bs||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new ws(r)}return n.set(e,t),this.size=n.size,this};var al="object"==typeof e&&e&&!e.nodeType&&e,ll=al&&"object"==typeof module&&module&&!module.nodeType&&module,cl=ll&&ll.exports===al?yr.Buffer:void 0,ul=cl?cl.allocUnsafe:void 0;function hl(e,t){if(t)return e.slice();var n=e.length,r=ul?ul(n):new e.constructor(n);return e.copy(r),r}function dl(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}function fl(){return[]}var pl=Object.prototype.propertyIsEnumerable,gl=Object.getOwnPropertySymbols,ml=gl?function(e){return null==e?[]:(e=Object(e),dl(gl(e),(function(t){return pl.call(e,t)})))}:fl;var vl=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Ds(t,ml(e)),e=Gs(e);return t}:fl;function yl(e,t,n){var r=t(e);return Pr(e)?r:Ds(r,n(e))}function bl(e){return yl(e,es,ml)}function xl(e){return yl(e,os,vl)}var wl=ui(yr,"DataView"),Cl=ui(yr,"Promise"),El=ui(yr,"Set"),_l="[object Map]",Sl="[object Promise]",Ol="[object Set]",Al="[object WeakMap]",kl="[object DataView]",Ml=ni(wl),Tl=ni(bs),Pl=ni(Cl),Dl=ni(El),Nl=ni(hi),Rl=Or;(wl&&Rl(new wl(new ArrayBuffer(1)))!=kl||bs&&Rl(new bs)!=_l||Cl&&Rl(Cl.resolve())!=Sl||El&&Rl(new El)!=Ol||hi&&Rl(new hi)!=Al)&&(Rl=function(e){var t=Or(e),n="[object Object]"==t?e.constructor:void 0,r=n?ni(n):"";if(r)switch(r){case Ml:return kl;case Tl:return _l;case Pl:return Sl;case Dl:return Ol;case Nl:return Al}return t});var Il=Rl,jl=Object.prototype.hasOwnProperty;var Ll=yr.Uint8Array;function Fl(e){var t=new e.constructor(e.byteLength);return new Ll(t).set(new Ll(e)),t}var Gl=/\w*$/;var Bl=br?br.prototype:void 0,zl=Bl?Bl.valueOf:void 0;function Ul(e,t){var n=t?Fl(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Vl(e,t,n){var r,i=e.constructor;switch(t){case"[object ArrayBuffer]":return Fl(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return function(e,t){var n=t?Fl(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Ul(e,n);case"[object Map]":case"[object Set]":return new i;case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,Gl.exec(e));return t.lastIndex=e.lastIndex,t}(e);case"[object Symbol]":return r=e,zl?Object(zl.call(r)):{}}}function Hl(e){return"function"!=typeof e.constructor||ko(e)?{}:gi(Gs(e))}var Wl=Wo&&Wo.isMap,$l=Wl?zo(Wl):function(e){return Ar(e)&&"[object Map]"==Il(e)};var Xl=Wo&&Wo.isSet,Yl=Xl?zo(Xl):function(e){return Ar(e)&&"[object Set]"==Il(e)},ql="[object Arguments]",Kl="[object Function]",Zl="[object Object]",Jl={};function Ql(e,t,n,r,i,o){var s,a=1&t,l=2&t,c=4&t;if(n&&(s=i?n(e,r,i,o):n(e)),void 0!==s)return s;if(!zr(e))return e;var u=Pr(e);if(u){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&jl.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!a)return Pi(e,s)}else{var h=Il(e),d=h==Kl||"[object GeneratorFunction]"==h;if(Go(e))return hl(e,a);if(h==Zl||h==ql||d&&!i){if(s=l||d?{}:Hl(e),!a)return l?function(e,t){return bo(e,vl(e),t)}(e,function(e,t){return e&&bo(t,os(t),e)}(s,e)):function(e,t){return bo(e,ml(e),t)}(e,sl(s,e))}else{if(!Jl[h])return i?e:{};s=Vl(e,h,a)}}o||(o=new ol);var f=o.get(e);if(f)return f;o.set(e,s),Yl(e)?e.forEach((function(r){s.add(Ql(r,t,n,r,e,o))})):$l(e)&&e.forEach((function(r,i){s.set(i,Ql(r,t,n,i,e,o))}));var p=u?void 0:(c?l?xl:bl:l?os:es)(e);return $i(p||e,(function(r,i){p&&(r=e[i=r]),yo(s,i,Ql(r,t,n,i,e,o))})),s}Jl[ql]=Jl["[object Array]"]=Jl["[object ArrayBuffer]"]=Jl["[object DataView]"]=Jl["[object Boolean]"]=Jl["[object Date]"]=Jl["[object Float32Array]"]=Jl["[object Float64Array]"]=Jl["[object Int8Array]"]=Jl["[object Int16Array]"]=Jl["[object Int32Array]"]=Jl["[object Map]"]=Jl["[object Number]"]=Jl[Zl]=Jl["[object RegExp]"]=Jl["[object Set]"]=Jl["[object String]"]=Jl["[object Symbol]"]=Jl["[object Uint8Array]"]=Jl["[object Uint8ClampedArray]"]=Jl["[object Uint16Array]"]=Jl["[object Uint32Array]"]=!0,Jl["[object Error]"]=Jl[Kl]=Jl["[object WeakMap]"]=!1;function ec(e){return Ql(e,4)}function tc(e){return Ql(e,5)}function nc(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new ws;++t<n;)this.add(e[t])}function rc(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function ic(e,t){return e.has(t)}nc.prototype.add=nc.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},nc.prototype.has=function(e){return this.__data__.has(e)};function oc(e,t,n,r,i,o){var s=1&n,a=e.length,l=t.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var h=-1,d=!0,f=2&n?new nc:void 0;for(o.set(e,t),o.set(t,e);++h<a;){var p=e[h],g=t[h];if(r)var m=s?r(g,p,h,t,e,o):r(p,g,h,e,t,o);if(void 0!==m){if(m)continue;d=!1;break}if(f){if(!rc(t,(function(e,t){if(!ic(f,t)&&(p===e||i(p,e,n,r,o)))return f.push(t)}))){d=!1;break}}else if(p!==g&&!i(p,g,n,r,o)){d=!1;break}}return o.delete(e),o.delete(t),d}function sc(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function ac(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var lc=br?br.prototype:void 0,cc=lc?lc.valueOf:void 0;var uc=Object.prototype.hasOwnProperty;var hc="[object Arguments]",dc="[object Array]",fc="[object Object]",pc=Object.prototype.hasOwnProperty;function gc(e,t,n,r,i,o){var s=Pr(e),a=Pr(t),l=s?dc:Il(e),c=a?dc:Il(t),u=(l=l==hc?fc:l)==fc,h=(c=c==hc?fc:c)==fc,d=l==c;if(d&&Go(e)){if(!Go(t))return!1;s=!0,u=!1}if(d&&!u)return o||(o=new ol),s||Xo(e)?oc(e,t,n,r,i,o):function(e,t,n,r,i,o,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new Ll(e),new Ll(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return mo(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=sc;case"[object Set]":var l=1&r;if(a||(a=ac),e.size!=t.size&&!l)return!1;var c=s.get(e);if(c)return c==t;r|=2,s.set(e,t);var u=oc(a(e),a(t),r,i,o,s);return s.delete(e),u;case"[object Symbol]":if(cc)return cc.call(e)==cc.call(t)}return!1}(e,t,l,n,r,i,o);if(!(1&n)){var f=u&&pc.call(e,"__wrapped__"),p=h&&pc.call(t,"__wrapped__");if(f||p){var g=f?e.value():e,m=p?t.value():t;return o||(o=new ol),i(g,m,n,r,o)}}return!!d&&(o||(o=new ol),function(e,t,n,r,i,o){var s=1&n,a=bl(e),l=a.length;if(l!=bl(t).length&&!s)return!1;for(var c=l;c--;){var u=a[c];if(!(s?u in t:uc.call(t,u)))return!1}var h=o.get(e),d=o.get(t);if(h&&d)return h==t&&d==e;var f=!0;o.set(e,t),o.set(t,e);for(var p=s;++c<l;){var g=e[u=a[c]],m=t[u];if(r)var v=s?r(m,g,u,t,e,o):r(g,m,u,e,t,o);if(!(void 0===v?g===m||i(g,m,n,r,o):v)){f=!1;break}p||(p="constructor"==u)}if(f&&!p){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(f=!1)}return o.delete(e),o.delete(t),f}(e,t,n,r,i,o))}function mc(e,t,n,r,i){return e===t||(null==e||null==t||!Ar(e)&&!Ar(t)?e!=e&&t!=t:gc(e,t,n,r,mc,i))}function vc(e,t,n,r){var i=n.length,o=i,s=!r;if(null==e)return!o;for(e=Object(e);i--;){var a=n[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var l=(a=n[i])[0],c=e[l],u=a[1];if(s&&a[2]){if(void 0===c&&!(l in e))return!1}else{var h=new ol;if(r)var d=r(c,u,l,e,t,h);if(!(void 0===d?mc(u,c,3,r,h):d))return!1}}return!0}function yc(e){return e==e&&!zr(e)}function bc(e){for(var t=es(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,yc(i)]}return t}function xc(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}function wc(e){var t=bc(e);return 1==t.length&&t[0][2]?xc(t[0][0],t[0][1]):function(n){return n===e||vc(n,e,t)}}function Cc(e,t){return null!=e&&t in Object(e)}function Ec(e,t,n){for(var r=-1,i=(t=As(t,e)).length,o=!1;++r<i;){var s=ks(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Eo(i)&&no(s,i)&&(Pr(e)||Ro(e))}function _c(e,t){return null!=e&&Ec(e,t,Cc)}function Sc(e,t){return hs(e)&&yc(t)?xc(ks(e),t):function(n){var r=Ts(n,e);return void 0===r&&r===t?_c(n,e):mc(t,r,3)}}function Oc(e){return function(t){return null==t?void 0:t[e]}}function Ac(e){return hs(e)?Oc(ks(e)):function(e){return function(t){return Ms(t,e)}}(e)}function kc(e){return"function"==typeof e?e:null==e?Kr:"object"==typeof e?Pr(e)?Sc(e[0],e[1]):wc(e):Ac(e)}function Mc(e,t,n){var r=n.length;if(null==e)return!r;for(e=Object(e);r--;){var i=n[r],o=t[i],s=e[i];if(void 0===s&&!(i in e)||!o(s))return!1}return!0}function Tc(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r}function Pc(e){return function(t,n,r){for(var i=-1,o=Object(t),s=r(t),a=s.length;a--;){var l=s[e?a:++i];if(!1===n(o[l],l,o))break}return t}}var Dc=Pc();function Nc(e,t){return e&&Dc(e,t,es)}function Rc(e,t){return function(n,r){if(null==n)return n;if(!_o(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=Object(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}}var Ic=Rc(Nc);function jc(e,t,n,r){return Ic(e,(function(e,i,o){t(r,e,n(e),o)})),r}function Lc(e,t){return function(n,r){var i=Pr(n)?Tc:jc,o=t?t():{};return i(n,e,kc(r),o)}}var Fc=Object.prototype.hasOwnProperty,Gc=Lc((function(e,t,n){Fc.call(e,n)?++e[n]:go(e,n,1)}));function Bc(e,t,n){var r=fo(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return r.placeholder=Bc.placeholder,r}Bc.placeholder={};function zc(e,t,n){var r=fo(e,16,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return r.placeholder=zc.placeholder,r}zc.placeholder={};var Uc=function(){return yr.Date.now()},Vc=Math.max,Hc=Math.min;function Wc(e,t,n){var r,i,o,s,a,l,c=0,u=!1,h=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var n=r,o=i;return r=i=void 0,c=t,s=e.apply(o,n)}function p(e){return c=e,a=setTimeout(m,t),u?f(e):s}function g(e){var n=e-l;return void 0===l||n>=t||n<0||h&&e-c>=o}function m(){var e=Uc();if(g(e))return v(e);a=setTimeout(m,function(e){var n=t-(e-l);return h?Hc(n,o-(e-c)):n}(e))}function v(e){return a=void 0,d&&r?f(e):(r=i=void 0,s)}function y(){var e=Uc(),n=g(e);if(r=arguments,i=this,l=e,n){if(void 0===a)return p(l);if(h)return clearTimeout(a),a=setTimeout(m,t),f(l)}return void 0===a&&(a=setTimeout(m,t)),s}return t=$r(t)||0,zr(n)&&(u=!!n.leading,o=(h="maxWait"in n)?Vc($r(n.maxWait)||0,t):o,d="trailing"in n?!!n.trailing:d),y.cancel=function(){void 0!==a&&clearTimeout(a),c=0,r=l=i=a=void 0},y.flush=function(){return void 0===a?s:v(Uc())},y}var $c=Object.prototype,Xc=$c.hasOwnProperty,Yc=Co((function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&So(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],s=os(o),a=-1,l=s.length;++a<l;){var c=s[a],u=e[c];(void 0===u||mo(u,$c[c])&&!Xc.call(e,c))&&(e[c]=o[c])}return e}));function qc(e,t,n){(void 0!==n&&!mo(e[t],n)||void 0===n&&!(t in e))&&go(e,t,n)}function Kc(e){return Ar(e)&&_o(e)}function Zc(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Jc(e){return bo(e,os(e))}function Qc(e,t,n,r,i){e!==t&&Dc(t,(function(o,s){if(i||(i=new ol),zr(o))!function(e,t,n,r,i,o,s){var a=Zc(e,n),l=Zc(t,n),c=s.get(l);if(c)qc(e,n,c);else{var u=o?o(a,l,n+"",e,t,s):void 0,h=void 0===u;if(h){var d=Pr(l),f=!d&&Go(l),p=!d&&!f&&Xo(l);u=l,d||f||p?Pr(a)?u=a:Kc(a)?u=Pi(a):f?(h=!1,u=hl(l,!0)):p?(h=!1,u=Ul(l,!0)):u=[]:Ws(l)||Ro(l)?(u=a,Ro(a)?u=Jc(a):zr(a)&&!Zr(a)||(u=Hl(l))):h=!1}h&&(s.set(l,u),i(u,l,r,o,s),s.delete(l)),qc(e,n,u)}}(e,t,s,n,Qc,r,i);else{var a=r?r(Zc(e,s),o,s+"",e,t,i):void 0;void 0===a&&(a=o),qc(e,s,a)}}),os)}function eu(e,t,n,r,i,o){return zr(e)&&zr(t)&&(o.set(t,e),Qc(e,t,void 0,eu,o),o.delete(t)),e}var tu=Oo((function(e,t,n,r){Qc(e,t,n,r)})),nu=Co((function(e){return e.push(void 0,eu),vi(tu,void 0,e)}));function ru(e,t,n){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,n)}),t)}var iu=Co((function(e,t){return ru(e,1,t)})),ou=Co((function(e,t,n){return ru(e,$r(t)||0,n)}));function su(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function au(e,t,n,r){var i=-1,o=Ki,s=!0,a=e.length,l=[],c=t.length;if(!a)return l;n&&(t=Tr(t,zo(n))),r?(o=su,s=!1):t.length>=200&&(o=ic,s=!1,t=new nc(t));e:for(;++i<a;){var u=e[i],h=null==n?u:n(u);if(u=r||0!==u?u:0,s&&h==h){for(var d=c;d--;)if(t[d]===h)continue e;l.push(u)}else o(t,h,r)||l.push(u)}return l}var lu=Co((function(e,t){return Kc(e)?au(e,Is(t,1,Kc,!0)):[]}));function cu(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var uu=Co((function(e,t){var n=cu(t);return Kc(n)&&(n=void 0),Kc(e)?au(e,Is(t,1,Kc,!0),kc(n)):[]})),hu=Co((function(e,t){var n=cu(t);return Kc(n)&&(n=void 0),Kc(e)?au(e,Is(t,1,Kc,!0),void 0,n):[]})),du=Ir((function(e,t){return e/t}),1);function fu(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Js(e,r?0:o,r?o+1:i):Js(e,r?o+1:0,r?i:o)}function pu(e){return"function"==typeof e?e:Kr}function gu(e,t){return(Pr(e)?$i:Ic)(e,pu(t))}function mu(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}var vu=Pc(!0);function yu(e,t){return e&&vu(e,t,es)}var bu=Rc(yu,!0);function xu(e,t){return(Pr(e)?mu:bu)(e,pu(t))}function wu(e){return function(t){var n=Il(t);return"[object Map]"==n?sc(t):"[object Set]"==n?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return Tr(t,(function(t){return[t,e[t]]}))}(t,e(t))}}var Cu=wu(es),Eu=wu(os),_u=ya({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Su=/[&<>"']/g,Ou=RegExp(Su.source);function Au(e){return(e=Os(e))&&Ou.test(e)?e.replace(Su,_u):e}var ku=/[\\^$.*+?()[\]{}|]/g,Mu=RegExp(ku.source);function Tu(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Pu(e,t){var n=!0;return Ic(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function Du(e){return e?rl(qr(e),0,4294967295):0}function Nu(e,t){var n=[];return Ic(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function Ru(e){return function(t,n,r){var i=Object(t);if(!_o(t)){var o=kc(n);t=es(t),n=function(e){return o(i[e],e,i)}}var s=e(t,n,r);return s>-1?i[o?t[s]:s]:void 0}}var Iu=Math.max;function ju(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:qr(n);return i<0&&(i=Iu(r+i,0)),Xi(e,kc(t),i)}var Lu=Ru(ju);function Fu(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}var Gu=Math.max,Bu=Math.min;function zu(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=qr(n),i=n<0?Gu(r+i,0):Bu(i,r-1)),Xi(e,kc(t),i,!0)}var Uu=Ru(zu);function Vu(e){return e&&e.length?e[0]:void 0}function Hu(e,t){var n=-1,r=_o(e)?Array(e.length):[];return Ic(e,(function(e,i,o){r[++n]=t(e,i,o)})),r}function Wu(e,t){return(Pr(e)?Tr:Hu)(e,kc(t))}var $u=Ja("floor");function Xu(e){return Ls((function(t){var n=t.length,r=n,i=Ti.prototype.thru;for(e&&t.reverse();r--;){var o=t[r];if("function"!=typeof o)throw new TypeError("Expected a function");if(i&&!s&&"wrapper"==Mi(o))var s=new Ti([],!0)}for(r=s?r:n;++r<n;){var a=Mi(o=t[r]),l="wrapper"==a?Oi(o):void 0;s=l&&Ii(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?s[Mi(l[0])].apply(s,l[3]):1==o.length&&Ii(o)?s[a]():s.thru(o)}return function(){var e=arguments,r=e[0];if(s&&1==e.length&&Pr(r))return s.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}var Yu=Xu(),qu=Xu(!0);function Ku(e,t){return dl(t,(function(t){return Zr(e[t])}))}var Zu=Object.prototype.hasOwnProperty,Ju=Lc((function(e,t,n){Zu.call(e,n)?e[n].push(t):go(e,n,[t])}));function Qu(e,t){return e>t}function eh(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=$r(t),n=$r(n)),e(t,n)}}var th=eh(Qu),nh=eh((function(e,t){return e>=t})),rh=Object.prototype.hasOwnProperty;function ih(e,t){return null!=e&&rh.call(e,t)}function oh(e,t){return null!=e&&Ec(e,t,ih)}var sh=Math.max,ah=Math.min;function lh(e){return"string"==typeof e||!Pr(e)&&Ar(e)&&"[object String]"==Or(e)}function ch(e,t){return Tr(t,(function(t){return e[t]}))}function uh(e){return null==e?[]:ch(e,es(e))}var hh=Math.max;var dh=Math.max;var fh=Math.min;function ph(e,t,n){for(var r=n?su:Ki,i=e[0].length,o=e.length,s=o,a=Array(o),l=1/0,c=[];s--;){var u=e[s];s&&t&&(u=Tr(u,zo(t))),l=fh(u.length,l),a[s]=!n&&(t||i>=120&&u.length>=120)?new nc(s&&u):void 0}u=e[0];var h=-1,d=a[0];e:for(;++h<i&&c.length<l;){var f=u[h],p=t?t(f):f;if(f=n||0!==f?f:0,!(d?ic(d,p):r(c,p,n))){for(s=o;--s;){var g=a[s];if(!(g?ic(g,p):r(e[s],p,n)))continue e}d&&d.push(p),c.push(f)}}return c}function gh(e){return Kc(e)?e:[]}var mh=Co((function(e){var t=Tr(e,gh);return t.length&&t[0]===e[0]?ph(t):[]})),vh=Co((function(e){var t=cu(e),n=Tr(e,gh);return t===cu(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?ph(n,kc(t)):[]})),yh=Co((function(e){var t=cu(e),n=Tr(e,gh);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?ph(n,void 0,t):[]}));function bh(e,t){return function(n,r){return function(e,t,n,r){return Nc(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}var xh=Object.prototype.toString,wh=bh((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=xh.call(t)),e[t]=n}),Ui(Kr)),Ch=Object.prototype,Eh=Ch.hasOwnProperty,_h=Ch.toString,Sh=bh((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=_h.call(t)),Eh.call(e,t)?e[t].push(n):e[t]=[n]}),kc);function Oh(e,t){return t.length<2?e:Ms(e,Js(t,0,-1))}function Ah(e,t,n){var r=null==(e=Oh(e,t=As(t,e)))?e:e[ks(cu(t))];return null==r?void 0:vi(r,e,n)}var kh=Co(Ah),Mh=Co((function(e,t,n){var r=-1,i="function"==typeof t,o=_o(e)?Array(e.length):[];return Ic(e,(function(e){o[++r]=i?vi(t,e,n):Ah(e,t,n)})),o}));var Th=Wo&&Wo.isArrayBuffer,Ph=Th?zo(Th):function(e){return Ar(e)&&"[object ArrayBuffer]"==Or(e)};var Dh=Wo&&Wo.isDate,Nh=Dh?zo(Dh):function(e){return Ar(e)&&"[object Date]"==Or(e)};var Rh=Object.prototype.hasOwnProperty;function Ih(e){if(null==e)return!0;if(_o(e)&&(Pr(e)||"string"==typeof e||"function"==typeof e.splice||Go(e)||Xo(e)||Ro(e)))return!e.length;var t=Il(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(ko(e))return!Qo(e).length;for(var n in e)if(Rh.call(e,n))return!1;return!0}function jh(e,t){return mc(e,t)}var Lh=yr.isFinite;function Fh(e){return"number"==typeof e&&e==qr(e)}function Gh(e){return"number"==typeof e||Ar(e)&&"[object Number]"==Or(e)}var Bh=Qr?Zr:Io;var zh=Wo&&Wo.isRegExp,Uh=zh?zo(zh):function(e){return Ar(e)&&"[object RegExp]"==Or(e)},Vh=9007199254740991;var Hh=Array.prototype.join;var Wh=Ya((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),$h=Lc((function(e,t,n){go(e,n,t)}));var Xh=Math.max,Yh=Math.min;var qh=Ya((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Kh=pa("toLowerCase");function Zh(e,t){return e<t}var Jh=eh(Zh),Qh=eh((function(e,t){return e<=t}));function ed(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],s=t(o);if(null!=s&&(void 0===a?s==s&&!kr(s):n(s,a)))var a=s,l=o}return l}function td(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}function nd(e,t){var n=null==e?0:e.length;return n?td(e,t)/n:NaN}var rd=Oo((function(e,t,n){Qc(e,t,n)})),id=Co((function(e,t){return function(n){return Ah(n,e,t)}})),od=Co((function(e,t){return function(n){return Ah(e,n,t)}}));function sd(e,t,n){var r=es(t),i=Ku(t,r),o=!(zr(n)&&"chain"in n&&!n.chain),s=Zr(e);return $i(i,(function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),i=n.__actions__=Pi(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Ds([this.value()],arguments))})})),e}var ad=Ir((function(e,t){return e*t}),1);function ld(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}var cd=br?br.iterator:void 0;function ud(e){if(!e)return[];if(_o(e))return lh(e)?fa(e):Pi(e);if(cd&&e[cd])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[cd]());var t=Il(e);return("[object Map]"==t?sc:"[object Set]"==t?ac:uh)(e)}function hd(e,t){var n=e.length;if(n)return no(t+=t<0?n:0,n)?e[t]:void 0}function dd(e,t){return null==(e=Oh(e,t=As(t,e)))||delete e[ks(cu(t))]}function fd(e){return Ws(e)?void 0:e}var pd=Ls((function(e,t){var n={};if(null==e)return n;var r=!1;t=Tr(t,(function(t){return t=As(t,e),r||(r=t.length>1),t})),bo(e,xl(e),n),r&&(n=Ql(n,7,fd));for(var i=t.length;i--;)dd(n,t[i]);return n}));function gd(e,t,n,r){if(!zr(e))return e;for(var i=-1,o=(t=As(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var l=ks(t[i]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=s){var u=a[l];void 0===(c=r?r(u,l,a):void 0)&&(c=zr(u)?u:no(t[i+1])?[]:{})}yo(a,l,c),a=a[l]}return e}function md(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=Ms(e,s);n(a,s)&&gd(o,As(s,e),a)}return o}function vd(e,t){if(null==e)return{};var n=Tr(xl(e),(function(e){return[e]}));return t=kc(t),md(e,n,(function(e,n){return t(e,n[0])}))}function yd(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=kr(e),s=void 0!==t,a=null===t,l=t==t,c=kr(t);if(!a&&!c&&!o&&e>t||o&&s&&l&&!a&&!c||r&&s&&l||!n&&l||!i)return 1;if(!r&&!o&&!c&&e<t||c&&n&&i&&!r&&!o||a&&n&&i||!s&&i||!l)return-1}return 0}function bd(e,t,n){t=t.length?Tr(t,(function(e){return Pr(e)?function(t){return Ms(t,1===e.length?e[0]:e)}:e})):[Kr];var r=-1;t=Tr(t,zo(kc));var i=Hu(e,(function(e,n,i){var o=Tr(t,(function(t){return t(e)}));return{criteria:o,index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(i,(function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;++r<s;){var l=yd(i[r],o[r]);if(l)return r>=a?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function xd(e){return Ls((function(t){return t=Tr(t,zo(kc)),Co((function(n){var r=this;return e(t,(function(e){return vi(e,r,n)}))}))}))}var wd=xd(Tr),Cd=Co,Ed=Math.min,_d=Cd((function(e,t){var n=(t=1==t.length&&Pr(t[0])?Tr(t[0],zo(kc)):Tr(Is(t,1),zo(kc))).length;return Co((function(r){for(var i=-1,o=Ed(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return vi(e,this,r)}))})),Sd=xd(Tu),Od=xd(rc),Ad=Math.floor;function kd(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=Ad(t/2))&&(e+=e)}while(t);return n}var Md=Oc("length"),Td="[\\ud800-\\udfff]",Pd="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Dd="\\ud83c[\\udffb-\\udfff]",Nd="[^\\ud800-\\udfff]",Rd="(?:\\ud83c[\\udde6-\\uddff]){2}",Id="[\\ud800-\\udbff][\\udc00-\\udfff]",jd="(?:"+Pd+"|"+Dd+")"+"?",Ld="[\\ufe0e\\ufe0f]?",Fd=Ld+jd+("(?:\\u200d(?:"+[Nd,Rd,Id].join("|")+")"+Ld+jd+")*"),Gd="(?:"+[Nd+Pd+"?",Pd,Rd,Id,Td].join("|")+")",Bd=RegExp(Dd+"(?="+Dd+")|"+Gd+Fd,"g");function zd(e){return ta(e)?function(e){for(var t=Bd.lastIndex=0;Bd.test(e);)++t;return t}(e):Md(e)}var Ud=Math.ceil;function Vd(e,t){var n=(t=void 0===t?" ":Rr(t)).length;if(n<2)return n?kd(t,e):t;var r=kd(t,Ud(e/zd(t)));return ta(t)?Qs(fa(r),0,e).join(""):r.slice(0,e)}var Hd=Math.ceil,Wd=Math.floor;var $d=/^\s+/,Xd=yr.parseInt;var Yd=Co((function(e,t){return fo(e,32,void 0,t,so(t,eo(Yd)))}));Yd.placeholder={};var qd=Co((function(e,t){return fo(e,64,void 0,t,so(t,eo(qd)))}));qd.placeholder={};var Kd=Lc((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var Zd=Ls((function(e,t){return null==e?{}:function(e,t){return md(e,t,(function(t,n){return _c(e,n)}))}(e,t)}));function Jd(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}var Qd=Array.prototype.splice;function ef(e,t,n,r){var i=r?Jd:qi,o=-1,s=t.length,a=e;for(e===t&&(t=Pi(t)),n&&(a=Tr(e,zo(n)));++o<s;)for(var l=0,c=t[o],u=n?n(c):c;(l=i(a,u,l,r))>-1;)a!==e&&Qd.call(a,l,1),Qd.call(e,l,1);return e}function tf(e,t){return e&&e.length&&t&&t.length?ef(e,t):e}var nf=Co(tf);var rf=Array.prototype.splice;function of(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;no(i)?rf.call(e,i,1):dd(e,i)}}return e}var sf=Ls((function(e,t){var n=null==e?0:e.length,r=Ps(e,t);return of(e,Tr(t,(function(e){return no(e,n)?+e:e})).sort(yd)),r})),af=Math.floor,lf=Math.random;function cf(e,t){return e+af(lf()*(t-e+1))}var uf=parseFloat,hf=Math.min,df=Math.random;var ff=Math.ceil,pf=Math.max;function gf(e){return function(t,n,r){return r&&"number"!=typeof r&&So(t,n,r)&&(n=r=void 0),t=Yr(t),void 0===n?(n=t,t=0):n=Yr(n),function(e,t,n,r){for(var i=-1,o=pf(ff((t-e)/(n||1)),0),s=Array(o);o--;)s[r?o:++i]=e,e+=n;return s}(t,n,r=void 0===r?t<n?1:-1:Yr(r),e)}}var mf=gf(),vf=gf(!0),yf=Ls((function(e,t){return fo(e,256,void 0,void 0,void 0,t)}));function bf(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function xf(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}var wf=Array.prototype.reverse;function Cf(e){return null==e?e:wf.call(e)}var Ef=Ja("round");function _f(e){var t=e.length;return t?e[cf(0,t-1)]:void 0}function Sf(e){return _f(uh(e))}function Of(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){var o=cf(n,i),s=e[o];e[o]=e[n],e[n]=s}return e.length=t,e}function Af(e,t){return Of(Pi(e),rl(t,0,e.length))}function kf(e,t){var n=uh(e);return Of(n,rl(t,0,n.length))}function Mf(e){return Of(Pi(e))}function Tf(e){return Of(uh(e))}var Pf=Ya((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));function Df(e,t){var n;return Ic(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}var Nf=Co((function(e,t){if(null==e)return[];var n=t.length;return n>1&&So(e,t[0],t[1])?t=[]:n>2&&So(t[0],t[1],t[2])&&(t=[t[0]]),bd(e,Is(t,1),[])})),Rf=Math.floor,If=Math.min;function jf(e,t,n,r){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var s=(t=n(t))!=t,a=null===t,l=kr(t),c=void 0===t;i<o;){var u=Rf((i+o)/2),h=n(e[u]),d=void 0!==h,f=null===h,p=h==h,g=kr(h);if(s)var m=r||p;else m=c?p&&(r||d):a?p&&d&&(r||!f):l?p&&d&&!f&&(r||!g):!f&&!g&&(r?h<=t:h<t);m?i=u+1:o=u}return If(o,4294967294)}function Lf(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=e[o];null!==s&&!kr(s)&&(n?s<=t:s<t)?r=o+1:i=o}return i}return jf(e,t,Kr,n)}function Ff(e,t){return Lf(e,t)}function Gf(e,t,n){return jf(e,t,kc(n))}function Bf(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n],a=t?t(s):s;if(!n||!mo(a,l)){var l=a;o[i++]=0===s?0:s}}return o}var zf=Math.max;var Uf=Ya((function(e,t,n){return e+(n?" ":"")+ga(t)}));var Vf=Ir((function(e,t){return e-t}),0);var Hf=Object.prototype,Wf=Hf.hasOwnProperty;function $f(e,t,n,r){return void 0===e||mo(e,Hf[n])&&!Wf.call(r,n)?t:e}var Xf={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function Yf(e){return"\\"+Xf[e]}var qf=/<%=([\s\S]+?)%>/g,Kf={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:qf,variable:"",imports:{_:{escape:Au}}},Zf=/\b__p \+= '';/g,Jf=/\b(__p \+=) '' \+/g,Qf=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ep=/[()=,{}\[\]\/\s]/,tp=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,np=/($^)/,rp=/['\n\r\u2028\u2029\\]/g,ip=Object.prototype.hasOwnProperty;function op(e,t,n){var r=Kf.imports._.templateSettings||Kf;n&&So(e,t,n)&&(t=void 0),e=Os(e),t=as({},t,r,$f);var i,o,s=as({},t.imports,r.imports,$f),a=es(s),l=ch(s,a),c=0,u=t.interpolate||np,h="__p += '",d=RegExp((t.escape||np).source+"|"+u.source+"|"+(u===qf?tp:np).source+"|"+(t.evaluate||np).source+"|$","g"),f=ip.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(d,(function(t,n,r,s,a,l){return r||(r=s),h+=e.slice(c,l).replace(rp,Yf),n&&(i=!0,h+="' +\n__e("+n+") +\n'"),a&&(o=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=l+t.length,t})),h+="';\n";var p=ip.call(t,"variable")&&t.variable;if(p){if(ep.test(p))throw new Error("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(o?h.replace(Zf,""):h).replace(Jf,"$1").replace(Qf,"$1;"),h="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var g=Xs((function(){return Function(a,f+"return "+h).apply(void 0,l)}));if(g.source=h,$s(g))throw g;return g}function sp(e,t){return t(e)}var ap=4294967295,lp=Math.min;function cp(e,t){var n=e;return n instanceof _i&&(n=n.value()),va(t,(function(e,t){return t.func.apply(t.thisArg,Ds([e],t.args))}),n)}function up(){return cp(this.__wrapped__,this.__actions__)}var hp=9007199254740991;function dp(e,t){for(var n=e.length;n--&&qi(t,e[n],0)>-1;);return n}function fp(e,t){for(var n=-1,r=e.length;++n<r&&qi(t,e[n],0)>-1;);return n}var pp=/^\s+/;var gp=/\w*$/;var mp=ya({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),vp=/&(?:amp|lt|gt|quot|#39);/g,yp=RegExp(vp.source);var bp=El&&1/ac(new El([,-0]))[1]==1/0?function(e){return new El(e)}:Si;function xp(e,t,n){var r=-1,i=Ki,o=e.length,s=!0,a=[],l=a;if(n)s=!1,i=su;else if(o>=200){var c=t?null:bp(e);if(c)return ac(c);s=!1,i=ic,l=new nc}else l=t?[]:a;e:for(;++r<o;){var u=e[r],h=t?t(u):u;if(u=n||0!==u?u:0,s&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue e;t&&l.push(h),a.push(u)}else i(l,h,n)||(l!==a&&l.push(h),a.push(u))}return a}var wp=Co((function(e){return xp(Is(e,1,Kc,!0))})),Cp=Co((function(e){var t=cu(e);return Kc(t)&&(t=void 0),xp(Is(e,1,Kc,!0),kc(t))})),Ep=Co((function(e){var t=cu(e);return t="function"==typeof t?t:void 0,xp(Is(e,1,Kc,!0),void 0,t)}));function _p(e){return e&&e.length?xp(e):[]}var Sp=0;function Op(e){var t=++Sp;return Os(e)+t}var Ap=Math.max;function kp(e){if(!e||!e.length)return[];var t=0;return e=dl(e,(function(e){if(Kc(e))return t=Ap(e.length,t),!0})),Mo(t,(function(t){return Tr(e,Oc(t))}))}function Mp(e,t){if(!e||!e.length)return[];var n=kp(e);return null==t?n:Tr(n,(function(e){return vi(t,void 0,e)}))}function Tp(e,t,n,r){return gd(e,t,n(Ms(e,t)),r)}var Pp=Ya((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}));var Dp=Co((function(e,t){return Kc(e)?au(e,t):[]}));var Np=Ls((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return Ps(t,e)};return!(t>1||this.__actions__.length)&&r instanceof _i&&no(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:sp,args:[i],thisArg:void 0}),new Ti(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(i)}));function Rp(e,t,n){var r=e.length;if(r<2)return r?xp(e[0]):[];for(var i=-1,o=Array(r);++i<r;)for(var s=e[i],a=-1;++a<r;)a!=i&&(o[i]=au(o[i]||s,e[a],t,n));return xp(Is(o,1),t,n)}var Ip=Co((function(e){return Rp(dl(e,Kc))})),jp=Co((function(e){var t=cu(e);return Kc(t)&&(t=void 0),Rp(dl(e,Kc),kc(t))})),Lp=Co((function(e){var t=cu(e);return t="function"==typeof t?t:void 0,Rp(dl(e,Kc),void 0,t)})),Fp=Co(kp);function Gp(e,t,n){for(var r=-1,i=e.length,o=t.length,s={};++r<i;){var a=r<o?t[r]:void 0;n(s,e[r],a)}return s}var Bp=Co((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,Mp(e,n)})),zp={chunk:function(e,t,n){t=(n?So(e,t,n):void 0===t)?1:nl(qr(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var i=0,o=0,s=Array(tl(r/t));i<r;)s[o++]=Js(e,i,i+=t);return s},compact:function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},concat:function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return Ds(Pr(n)?Pi(n):[n],Is(t,1))},difference:lu,differenceBy:uu,differenceWith:hu,drop:function(e,t,n){var r=null==e?0:e.length;return r?Js(e,(t=n||void 0===t?1:qr(t))<0?0:t,r):[]},dropRight:function(e,t,n){var r=null==e?0:e.length;return r?Js(e,0,(t=r-(t=n||void 0===t?1:qr(t)))<0?0:t):[]},dropRightWhile:function(e,t){return e&&e.length?fu(e,kc(t),!0,!0):[]},dropWhile:function(e,t){return e&&e.length?fu(e,kc(t),!0):[]},fill:function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&So(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=qr(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:qr(r))<0&&(r+=i),r=n>r?0:Du(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},findIndex:ju,findLastIndex:zu,first:Vu,flatten:js,flattenDeep:function(e){return(null==e?0:e.length)?Is(e,Infinity):[]},flattenDepth:function(e,t){return(null==e?0:e.length)?Is(e,t=void 0===t?1:qr(t)):[]},fromPairs:function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},head:Vu,indexOf:function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:qr(n);return i<0&&(i=dh(r+i,0)),qi(e,t,i)},initial:function(e){return(null==e?0:e.length)?Js(e,0,-1):[]},intersection:mh,intersectionBy:vh,intersectionWith:yh,join:function(e,t){return null==e?"":Hh.call(e,t)},last:cu,lastIndexOf:function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=qr(n))<0?Xh(r+i,0):Yh(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):Xi(e,Yi,i,!0)},nth:function(e,t){return e&&e.length?hd(e,qr(t)):void 0},pull:nf,pullAll:tf,pullAllBy:function(e,t,n){return e&&e.length&&t&&t.length?ef(e,t,kc(n)):e},pullAllWith:function(e,t,n){return e&&e.length&&t&&t.length?ef(e,t,void 0,n):e},pullAt:sf,remove:function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=kc(t);++r<o;){var s=e[r];t(s,r,e)&&(n.push(s),i.push(r))}return of(e,i),n},reverse:Cf,slice:function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&So(e,t,n)?(t=0,n=r):(t=null==t?0:qr(t),n=void 0===n?r:qr(n)),Js(e,t,n)):[]},sortedIndex:Ff,sortedIndexBy:Gf,sortedIndexOf:function(e,t){var n=null==e?0:e.length;if(n){var r=Lf(e,t);if(r<n&&mo(e[r],t))return r}return-1},sortedLastIndex:function(e,t){return Lf(e,t,!0)},sortedLastIndexBy:function(e,t,n){return jf(e,t,kc(n),!0)},sortedLastIndexOf:function(e,t){if(null==e?0:e.length){var n=Lf(e,t,!0)-1;if(mo(e[n],t))return n}return-1},sortedUniq:function(e){return e&&e.length?Bf(e):[]},sortedUniqBy:function(e,t){return e&&e.length?Bf(e,kc(t)):[]},tail:function(e){var t=null==e?0:e.length;return t?Js(e,1,t):[]},take:function(e,t,n){return e&&e.length?Js(e,0,(t=n||void 0===t?1:qr(t))<0?0:t):[]},takeRight:function(e,t,n){var r=null==e?0:e.length;return r?Js(e,(t=r-(t=n||void 0===t?1:qr(t)))<0?0:t,r):[]},takeRightWhile:function(e,t){return e&&e.length?fu(e,kc(t),!1,!0):[]},takeWhile:function(e,t){return e&&e.length?fu(e,kc(t)):[]},union:wp,unionBy:Cp,unionWith:Ep,uniq:_p,uniqBy:function(e,t){return e&&e.length?xp(e,kc(t)):[]},uniqWith:function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?xp(e,void 0,t):[]},unzip:kp,unzipWith:Mp,without:Dp,xor:Ip,xorBy:jp,xorWith:Lp,zip:Fp,zipObject:function(e,t){return Gp(e||[],t||[],yo)},zipObjectDeep:function(e,t){return Gp(e||[],t||[],gd)},zipWith:Bp},Up={countBy:Gc,each:gu,eachRight:xu,every:function(e,t,n){var r=Pr(e)?Tu:Pu;return n&&So(e,t,n)&&(t=void 0),r(e,kc(t))},filter:function(e,t){return(Pr(e)?dl:Nu)(e,kc(t))},find:Lu,findLast:Uu,flatMap:function(e,t){return Is(Wu(e,t),1)},flatMapDeep:function(e,t){return Is(Wu(e,t),Infinity)},flatMapDepth:function(e,t,n){return n=void 0===n?1:qr(n),Is(Wu(e,t),n)},forEach:gu,forEachRight:xu,groupBy:Ju,includes:function(e,t,n,r){e=_o(e)?e:uh(e),n=n&&!r?qr(n):0;var i=e.length;return n<0&&(n=hh(i+n,0)),lh(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&qi(e,t,n)>-1},invokeMap:Mh,keyBy:$h,map:Wu,orderBy:function(e,t,n,r){return null==e?[]:(Pr(t)||(t=null==t?[]:[t]),Pr(n=r?void 0:n)||(n=null==n?[]:[n]),bd(e,t,n))},partition:Kd,reduce:function(e,t,n){var r=Pr(e)?va:bf,i=arguments.length<3;return r(e,kc(t),n,i,Ic)},reduceRight:function(e,t,n){var r=Pr(e)?xf:bf,i=arguments.length<3;return r(e,kc(t),n,i,bu)},reject:function(e,t){return(Pr(e)?dl:Nu)(e,ld(kc(t)))},sample:function(e){return(Pr(e)?_f:Sf)(e)},sampleSize:function(e,t,n){return t=(n?So(e,t,n):void 0===t)?1:qr(t),(Pr(e)?Af:kf)(e,t)},shuffle:function(e){return(Pr(e)?Mf:Tf)(e)},size:function(e){if(null==e)return 0;if(_o(e))return lh(e)?zd(e):e.length;var t=Il(e);return"[object Map]"==t||"[object Set]"==t?e.size:Qo(e).length},some:function(e,t,n){var r=Pr(e)?rc:Df;return n&&So(e,t,n)&&(t=void 0),r(e,kc(t))},sortBy:Nf},Vp=Uc,Hp={after:function(e,t){if("function"!=typeof t)throw new TypeError("Expected a function");return e=qr(e),function(){if(--e<1)return t.apply(this,arguments)}},ary:po,before:Ys,bind:qs,bindKey:Zs,curry:Bc,curryRight:zc,debounce:Wc,defer:iu,delay:ou,flip:function(e){return fo(e,512)},memoize:Cs,negate:ld,once:function(e){return Ys(2,e)},overArgs:_d,partial:Yd,partialRight:qd,rearg:yf,rest:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return Co(e,t=void 0===t?t:qr(t))},spread:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return t=null==t?0:zf(qr(t),0),Co((function(n){var r=n[t],i=Qs(n,0,t);return r&&Ds(i,r),vi(e,this,i)}))},throttle:function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return zr(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Wc(e,t,{leading:r,maxWait:t,trailing:i})},unary:function(e){return po(e,1)},wrap:function(e,t){return Yd(pu(t),e)}},Wp={castArray:function(){if(!arguments.length)return[];var e=arguments[0];return Pr(e)?e:[e]},clone:ec,cloneDeep:tc,cloneDeepWith:function(e,t){return Ql(e,5,t="function"==typeof t?t:void 0)},cloneWith:function(e,t){return Ql(e,4,t="function"==typeof t?t:void 0)},conformsTo:function(e,t){return null==t||Mc(e,t,es(t))},eq:mo,gt:th,gte:nh,isArguments:Ro,isArray:Pr,isArrayBuffer:Ph,isArrayLike:_o,isArrayLikeObject:Kc,isBoolean:function(e){return!0===e||!1===e||Ar(e)&&"[object Boolean]"==Or(e)},isBuffer:Go,isDate:Nh,isElement:function(e){return Ar(e)&&1===e.nodeType&&!Ws(e)},isEmpty:Ih,isEqual:jh,isEqualWith:function(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?mc(e,t,void 0,n):!!r},isError:$s,isFinite:function(e){return"number"==typeof e&&Lh(e)},isFunction:Zr,isInteger:Fh,isLength:Eo,isMap:$l,isMatch:function(e,t){return e===t||vc(e,t,bc(t))},isMatchWith:function(e,t,n){return n="function"==typeof n?n:void 0,vc(e,t,bc(t),n)},isNaN:function(e){return Gh(e)&&e!=+e},isNative:function(e){if(Bh(e))throw new Error("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return ci(e)},isNil:function(e){return null==e},isNull:function(e){return null===e},isNumber:Gh,isObject:zr,isObjectLike:Ar,isPlainObject:Ws,isRegExp:Uh,isSafeInteger:function(e){return Fh(e)&&e>=-9007199254740991&&e<=Vh},isSet:Yl,isString:lh,isSymbol:kr,isTypedArray:Xo,isUndefined:function(e){return void 0===e},isWeakMap:function(e){return Ar(e)&&"[object WeakMap]"==Il(e)},isWeakSet:function(e){return Ar(e)&&"[object WeakSet]"==Or(e)},lt:Jh,lte:Qh,toArray:ud,toFinite:Yr,toInteger:qr,toLength:Du,toNumber:$r,toPlainObject:Jc,toSafeInteger:function(e){return e?rl(qr(e),-9007199254740991,hp):0===e?e:0},toString:Os},$p={add:jr,ceil:Qa,divide:du,floor:$u,max:function(e){return e&&e.length?ed(e,Kr,Qu):void 0},maxBy:function(e,t){return e&&e.length?ed(e,kc(t),Qu):void 0},mean:function(e){return nd(e,Kr)},meanBy:function(e,t){return nd(e,kc(t))},min:function(e){return e&&e.length?ed(e,Kr,Zh):void 0},minBy:function(e,t){return e&&e.length?ed(e,kc(t),Zh):void 0},multiply:ad,round:Ef,subtract:Vf,sum:function(e){return e&&e.length?td(e,Kr):0},sumBy:function(e,t){return e&&e.length?td(e,kc(t)):0}},Xp=il,Yp=function(e,t,n){return t=Yr(t),void 0===n?(n=t,t=0):n=Yr(n),function(e,t,n){return e>=ah(t,n)&&e<sh(t,n)}(e=$r(e),t,n)},qp=function(e,t,n){if(n&&"boolean"!=typeof n&&So(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=Yr(e),void 0===t?(t=e,e=0):t=Yr(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=df();return hf(e+i*(t-e+uf("1e-"+((i+"").length-1))),t)}return cf(e,t)},Kp={assign:ns,assignIn:ss,assignInWith:as,assignWith:ls,at:Fs,create:function(e,t){var n=gi(e);return null==t?n:sl(n,t)},defaults:Yc,defaultsDeep:nu,entries:Cu,entriesIn:Eu,extend:ss,extendWith:as,findKey:function(e,t){return Fu(e,kc(t),Nc)},findLastKey:function(e,t){return Fu(e,kc(t),yu)},forIn:function(e,t){return null==e?e:Dc(e,pu(t),os)},forInRight:function(e,t){return null==e?e:vu(e,pu(t),os)},forOwn:function(e,t){return e&&Nc(e,pu(t))},forOwnRight:function(e,t){return e&&yu(e,pu(t))},functions:function(e){return null==e?[]:Ku(e,es(e))},functionsIn:function(e){return null==e?[]:Ku(e,os(e))},get:Ts,has:oh,hasIn:_c,invert:wh,invertBy:Sh,invoke:kh,keys:es,keysIn:os,mapKeys:function(e,t){var n={};return t=kc(t),Nc(e,(function(e,r,i){go(n,t(e,r,i),e)})),n},mapValues:function(e,t){var n={};return t=kc(t),Nc(e,(function(e,r,i){go(n,r,t(e,r,i))})),n},merge:rd,mergeWith:tu,omit:pd,omitBy:function(e,t){return vd(e,ld(kc(t)))},pick:Zd,pickBy:vd,result:function(e,t,n){var r=-1,i=(t=As(t,e)).length;for(i||(i=1,e=void 0);++r<i;){var o=null==e?void 0:e[ks(t[r])];void 0===o&&(r=i,o=n),e=Zr(o)?o.call(e):o}return e},set:function(e,t,n){return null==e?e:gd(e,t,n)},setWith:function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:gd(e,t,n,r)},toPairs:Cu,toPairsIn:Eu,transform:function(e,t,n){var r=Pr(e),i=r||Go(e)||Xo(e);if(t=kc(t),null==n){var o=e&&e.constructor;n=i?r?new o:[]:zr(e)&&Zr(o)?gi(Gs(e)):{}}return(i?$i:Nc)(e,(function(e,r,i){return t(n,e,r,i)})),n},unset:function(e,t){return null==e||dd(e,t)},update:function(e,t,n){return null==e?e:Tp(e,t,pu(n))},updateWith:function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:Tp(e,t,pu(n),r)},values:uh,valuesIn:function(e){return null==e?[]:ch(e,os(e))}},Zp={at:Np,chain:el,commit:function(){return new Ti(this.value(),this.__chain__)},lodash:Ri,next:function(){void 0===this.__values__&&(this.__values__=ud(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},plant:function(e){for(var t,n=this;n instanceof Ei;){var r=Di(n);r.__index__=0,r.__values__=void 0,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},reverse:function(){var e=this.__wrapped__;if(e instanceof _i){var t=e;return this.__actions__.length&&(t=new _i(this)),(t=t.reverse()).__actions__.push({func:sp,args:[Cf],thisArg:void 0}),new Ti(t,this.__chain__)}return this.thru(Cf)},tap:function(e,t){return t(e),e},thru:sp,toIterator:function(){return this},toJSON:up,value:up,valueOf:up,wrapperChain:function(){return el(this)}},Jp={camelCase:qa,capitalize:ma,deburr:Ca,endsWith:function(e,t,n){e=Os(e),t=Rr(t);var r=e.length,i=n=void 0===n?r:rl(qr(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},escape:Au,escapeRegExp:function(e){return(e=Os(e))&&Mu.test(e)?e.replace(ku,"\\$&"):e},kebabCase:Wh,lowerCase:qh,lowerFirst:Kh,pad:function(e,t,n){e=Os(e);var r=(t=qr(t))?zd(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Vd(Wd(i),n)+e+Vd(Hd(i),n)},padEnd:function(e,t,n){e=Os(e);var r=(t=qr(t))?zd(e):0;return t&&r<t?e+Vd(t-r,n):e},padStart:function(e,t,n){e=Os(e);var r=(t=qr(t))?zd(e):0;return t&&r<t?Vd(t-r,n)+e:e},parseInt:function(e,t,n){return n||null==t?t=0:t&&(t=+t),Xd(Os(e).replace($d,""),t||0)},repeat:function(e,t,n){return t=(n?So(e,t,n):void 0===t)?1:qr(t),kd(Os(e),t)},replace:function(){var e=arguments,t=Os(e[0]);return e.length<3?t:t.replace(e[1],e[2])},snakeCase:Pf,split:function(e,t,n){return n&&"number"!=typeof n&&So(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=Os(e))&&("string"==typeof t||null!=t&&!Uh(t))&&!(t=Rr(t))&&ta(e)?Qs(fa(e),0,n):e.split(t,n):[]},startCase:Uf,startsWith:function(e,t,n){return e=Os(e),n=null==n?0:rl(qr(n),0,e.length),t=Rr(t),e.slice(n,n+t.length)==t},template:op,templateSettings:Kf,toLower:function(e){return Os(e).toLowerCase()},toUpper:function(e){return Os(e).toUpperCase()},trim:function(e,t,n){if((e=Os(e))&&(n||void 0===t))return Br(e);if(!e||!(t=Rr(t)))return e;var r=fa(e),i=fa(t);return Qs(r,fp(r,i),dp(r,i)+1).join("")},trimEnd:function(e,t,n){if((e=Os(e))&&(n||void 0===t))return e.slice(0,Fr(e)+1);if(!e||!(t=Rr(t)))return e;var r=fa(e);return Qs(r,0,dp(r,fa(t))+1).join("")},trimStart:function(e,t,n){if((e=Os(e))&&(n||void 0===t))return e.replace(pp,"");if(!e||!(t=Rr(t)))return e;var r=fa(e);return Qs(r,fp(r,fa(t))).join("")},truncate:function(e,t){var n=30,r="...";if(zr(t)){var i="separator"in t?t.separator:i;n="length"in t?qr(t.length):n,r="omission"in t?Rr(t.omission):r}var o=(e=Os(e)).length;if(ta(e)){var s=fa(e);o=s.length}if(n>=o)return e;var a=n-zd(r);if(a<1)return r;var l=s?Qs(s,0,a).join(""):e.slice(0,a);if(void 0===i)return l+r;if(s&&(a+=l.length-a),Uh(i)){if(e.slice(a).search(i)){var c,u=l;for(i.global||(i=RegExp(i.source,Os(gp.exec(i))+"g")),i.lastIndex=0;c=i.exec(u);)var h=c.index;l=l.slice(0,void 0===h?a:h)}}else if(e.indexOf(Rr(i),a)!=a){var d=l.lastIndexOf(i);d>-1&&(l=l.slice(0,d))}return l+r},unescape:function(e){return(e=Os(e))&&yp.test(e)?e.replace(vp,mp):e},upperCase:Pp,upperFirst:ga,words:$a},Qp={attempt:Xs,bindAll:Ks,cond:function(e){var t=null==e?0:e.length,n=kc;return e=t?Tr(e,(function(e){if("function"!=typeof e[1])throw new TypeError("Expected a function");return[n(e[0]),e[1]]})):[],Co((function(n){for(var r=-1;++r<t;){var i=e[r];if(vi(i[0],this,n))return vi(i[1],this,n)}}))},conforms:function(e){return function(e){var t=es(e);return function(n){return Mc(n,e,t)}}(Ql(e,1))},constant:Ui,defaultTo:function(e,t){return null==e||e!=e?t:e},flow:Yu,flowRight:qu,identity:Kr,iteratee:function(e){return kc("function"==typeof e?e:Ql(e,1))},matches:function(e){return wc(Ql(e,1))},matchesProperty:function(e,t){return Sc(e,Ql(t,1))},method:id,methodOf:od,mixin:sd,noop:Si,nthArg:function(e){return e=qr(e),Co((function(t){return hd(t,e)}))},over:wd,overEvery:Sd,overSome:Od,property:Ac,propertyOf:function(e){return function(t){return null==e?void 0:Ms(e,t)}},range:mf,rangeRight:vf,stubArray:fl,stubFalse:Io,stubObject:function(){return{}},stubString:function(){return""},stubTrue:function(){return!0},times:function(e,t){if((e=qr(e))<1||e>9007199254740991)return[];var n=ap,r=lp(e,ap);t=pu(t),e-=ap;for(var i=Mo(r,t);++n<e;)t(n);return i},toPath:function(e){return Pr(e)?Tr(e,ks):kr(e)?[e]:Pi(Ss(Os(e)))},uniqueId:Op};var eg=Math.max,tg=Math.min;var ng=Math.min;
/**
	 * @license
	 * Lodash (Custom Build) <https://lodash.com/>
	 * Build: `lodash modularize exports="es" -o ./`
	 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
	 * Released under MIT license <https://lodash.com/license>
	 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
	 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
	 */
var rg,ig=4294967295,og=Array.prototype,sg=Object.prototype.hasOwnProperty,ag=br?br.iterator:void 0,lg=Math.max,cg=Math.min,ug=function(e){return function(t,n,r){if(null==r){var i=zr(n),o=i&&es(n),s=o&&o.length&&Ku(n,o);(s?s.length:i)||(r=n,n=t,t=this)}return e(t,n,r)}}(sd);function hg(e,...t){t.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((n=>{"constructor"!==n&&Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))}))}))}Ri.after=Hp.after,Ri.ary=Hp.ary,Ri.assign=Kp.assign,Ri.assignIn=Kp.assignIn,Ri.assignInWith=Kp.assignInWith,Ri.assignWith=Kp.assignWith,Ri.at=Kp.at,Ri.before=Hp.before,Ri.bind=Hp.bind,Ri.bindAll=Qp.bindAll,Ri.bindKey=Hp.bindKey,Ri.castArray=Wp.castArray,Ri.chain=Zp.chain,Ri.chunk=zp.chunk,Ri.compact=zp.compact,Ri.concat=zp.concat,Ri.cond=Qp.cond,Ri.conforms=Qp.conforms,Ri.constant=Qp.constant,Ri.countBy=Up.countBy,Ri.create=Kp.create,Ri.curry=Hp.curry,Ri.curryRight=Hp.curryRight,Ri.debounce=Hp.debounce,Ri.defaults=Kp.defaults,Ri.defaultsDeep=Kp.defaultsDeep,Ri.defer=Hp.defer,Ri.delay=Hp.delay,Ri.difference=zp.difference,Ri.differenceBy=zp.differenceBy,Ri.differenceWith=zp.differenceWith,Ri.drop=zp.drop,Ri.dropRight=zp.dropRight,Ri.dropRightWhile=zp.dropRightWhile,Ri.dropWhile=zp.dropWhile,Ri.fill=zp.fill,Ri.filter=Up.filter,Ri.flatMap=Up.flatMap,Ri.flatMapDeep=Up.flatMapDeep,Ri.flatMapDepth=Up.flatMapDepth,Ri.flatten=zp.flatten,Ri.flattenDeep=zp.flattenDeep,Ri.flattenDepth=zp.flattenDepth,Ri.flip=Hp.flip,Ri.flow=Qp.flow,Ri.flowRight=Qp.flowRight,Ri.fromPairs=zp.fromPairs,Ri.functions=Kp.functions,Ri.functionsIn=Kp.functionsIn,Ri.groupBy=Up.groupBy,Ri.initial=zp.initial,Ri.intersection=zp.intersection,Ri.intersectionBy=zp.intersectionBy,Ri.intersectionWith=zp.intersectionWith,Ri.invert=Kp.invert,Ri.invertBy=Kp.invertBy,Ri.invokeMap=Up.invokeMap,Ri.iteratee=Qp.iteratee,Ri.keyBy=Up.keyBy,Ri.keys=es,Ri.keysIn=Kp.keysIn,Ri.map=Up.map,Ri.mapKeys=Kp.mapKeys,Ri.mapValues=Kp.mapValues,Ri.matches=Qp.matches,Ri.matchesProperty=Qp.matchesProperty,Ri.memoize=Hp.memoize,Ri.merge=Kp.merge,Ri.mergeWith=Kp.mergeWith,Ri.method=Qp.method,Ri.methodOf=Qp.methodOf,Ri.mixin=ug,Ri.negate=ld,Ri.nthArg=Qp.nthArg,Ri.omit=Kp.omit,Ri.omitBy=Kp.omitBy,Ri.once=Hp.once,Ri.orderBy=Up.orderBy,Ri.over=Qp.over,Ri.overArgs=Hp.overArgs,Ri.overEvery=Qp.overEvery,Ri.overSome=Qp.overSome,Ri.partial=Hp.partial,Ri.partialRight=Hp.partialRight,Ri.partition=Up.partition,Ri.pick=Kp.pick,Ri.pickBy=Kp.pickBy,Ri.property=Qp.property,Ri.propertyOf=Qp.propertyOf,Ri.pull=zp.pull,Ri.pullAll=zp.pullAll,Ri.pullAllBy=zp.pullAllBy,Ri.pullAllWith=zp.pullAllWith,Ri.pullAt=zp.pullAt,Ri.range=Qp.range,Ri.rangeRight=Qp.rangeRight,Ri.rearg=Hp.rearg,Ri.reject=Up.reject,Ri.remove=zp.remove,Ri.rest=Hp.rest,Ri.reverse=zp.reverse,Ri.sampleSize=Up.sampleSize,Ri.set=Kp.set,Ri.setWith=Kp.setWith,Ri.shuffle=Up.shuffle,Ri.slice=zp.slice,Ri.sortBy=Up.sortBy,Ri.sortedUniq=zp.sortedUniq,Ri.sortedUniqBy=zp.sortedUniqBy,Ri.split=Jp.split,Ri.spread=Hp.spread,Ri.tail=zp.tail,Ri.take=zp.take,Ri.takeRight=zp.takeRight,Ri.takeRightWhile=zp.takeRightWhile,Ri.takeWhile=zp.takeWhile,Ri.tap=Zp.tap,Ri.throttle=Hp.throttle,Ri.thru=sp,Ri.toArray=Wp.toArray,Ri.toPairs=Kp.toPairs,Ri.toPairsIn=Kp.toPairsIn,Ri.toPath=Qp.toPath,Ri.toPlainObject=Wp.toPlainObject,Ri.transform=Kp.transform,Ri.unary=Hp.unary,Ri.union=zp.union,Ri.unionBy=zp.unionBy,Ri.unionWith=zp.unionWith,Ri.uniq=zp.uniq,Ri.uniqBy=zp.uniqBy,Ri.uniqWith=zp.uniqWith,Ri.unset=Kp.unset,Ri.unzip=zp.unzip,Ri.unzipWith=zp.unzipWith,Ri.update=Kp.update,Ri.updateWith=Kp.updateWith,Ri.values=Kp.values,Ri.valuesIn=Kp.valuesIn,Ri.without=zp.without,Ri.words=Jp.words,Ri.wrap=Hp.wrap,Ri.xor=zp.xor,Ri.xorBy=zp.xorBy,Ri.xorWith=zp.xorWith,Ri.zip=zp.zip,Ri.zipObject=zp.zipObject,Ri.zipObjectDeep=zp.zipObjectDeep,Ri.zipWith=zp.zipWith,Ri.entries=Kp.toPairs,Ri.entriesIn=Kp.toPairsIn,Ri.extend=Kp.assignIn,Ri.extendWith=Kp.assignInWith,ug(Ri,Ri),Ri.add=$p.add,Ri.attempt=Qp.attempt,Ri.camelCase=Jp.camelCase,Ri.capitalize=Jp.capitalize,Ri.ceil=$p.ceil,Ri.clamp=Xp,Ri.clone=Wp.clone,Ri.cloneDeep=Wp.cloneDeep,Ri.cloneDeepWith=Wp.cloneDeepWith,Ri.cloneWith=Wp.cloneWith,Ri.conformsTo=Wp.conformsTo,Ri.deburr=Jp.deburr,Ri.defaultTo=Qp.defaultTo,Ri.divide=$p.divide,Ri.endsWith=Jp.endsWith,Ri.eq=Wp.eq,Ri.escape=Jp.escape,Ri.escapeRegExp=Jp.escapeRegExp,Ri.every=Up.every,Ri.find=Up.find,Ri.findIndex=zp.findIndex,Ri.findKey=Kp.findKey,Ri.findLast=Up.findLast,Ri.findLastIndex=zp.findLastIndex,Ri.findLastKey=Kp.findLastKey,Ri.floor=$p.floor,Ri.forEach=Up.forEach,Ri.forEachRight=Up.forEachRight,Ri.forIn=Kp.forIn,Ri.forInRight=Kp.forInRight,Ri.forOwn=Kp.forOwn,Ri.forOwnRight=Kp.forOwnRight,Ri.get=Kp.get,Ri.gt=Wp.gt,Ri.gte=Wp.gte,Ri.has=Kp.has,Ri.hasIn=Kp.hasIn,Ri.head=zp.head,Ri.identity=Kr,Ri.includes=Up.includes,Ri.indexOf=zp.indexOf,Ri.inRange=Yp,Ri.invoke=Kp.invoke,Ri.isArguments=Wp.isArguments,Ri.isArray=Pr,Ri.isArrayBuffer=Wp.isArrayBuffer,Ri.isArrayLike=Wp.isArrayLike,Ri.isArrayLikeObject=Wp.isArrayLikeObject,Ri.isBoolean=Wp.isBoolean,Ri.isBuffer=Wp.isBuffer,Ri.isDate=Wp.isDate,Ri.isElement=Wp.isElement,Ri.isEmpty=Wp.isEmpty,Ri.isEqual=Wp.isEqual,Ri.isEqualWith=Wp.isEqualWith,Ri.isError=Wp.isError,Ri.isFinite=Wp.isFinite,Ri.isFunction=Wp.isFunction,Ri.isInteger=Wp.isInteger,Ri.isLength=Wp.isLength,Ri.isMap=Wp.isMap,Ri.isMatch=Wp.isMatch,Ri.isMatchWith=Wp.isMatchWith,Ri.isNaN=Wp.isNaN,Ri.isNative=Wp.isNative,Ri.isNil=Wp.isNil,Ri.isNull=Wp.isNull,Ri.isNumber=Wp.isNumber,Ri.isObject=zr,Ri.isObjectLike=Wp.isObjectLike,Ri.isPlainObject=Wp.isPlainObject,Ri.isRegExp=Wp.isRegExp,Ri.isSafeInteger=Wp.isSafeInteger,Ri.isSet=Wp.isSet,Ri.isString=Wp.isString,Ri.isSymbol=Wp.isSymbol,Ri.isTypedArray=Wp.isTypedArray,Ri.isUndefined=Wp.isUndefined,Ri.isWeakMap=Wp.isWeakMap,Ri.isWeakSet=Wp.isWeakSet,Ri.join=zp.join,Ri.kebabCase=Jp.kebabCase,Ri.last=cu,Ri.lastIndexOf=zp.lastIndexOf,Ri.lowerCase=Jp.lowerCase,Ri.lowerFirst=Jp.lowerFirst,Ri.lt=Wp.lt,Ri.lte=Wp.lte,Ri.max=$p.max,Ri.maxBy=$p.maxBy,Ri.mean=$p.mean,Ri.meanBy=$p.meanBy,Ri.min=$p.min,Ri.minBy=$p.minBy,Ri.stubArray=Qp.stubArray,Ri.stubFalse=Qp.stubFalse,Ri.stubObject=Qp.stubObject,Ri.stubString=Qp.stubString,Ri.stubTrue=Qp.stubTrue,Ri.multiply=$p.multiply,Ri.nth=zp.nth,Ri.noop=Qp.noop,Ri.now=Vp,Ri.pad=Jp.pad,Ri.padEnd=Jp.padEnd,Ri.padStart=Jp.padStart,Ri.parseInt=Jp.parseInt,Ri.random=qp,Ri.reduce=Up.reduce,Ri.reduceRight=Up.reduceRight,Ri.repeat=Jp.repeat,Ri.replace=Jp.replace,Ri.result=Kp.result,Ri.round=$p.round,Ri.sample=Up.sample,Ri.size=Up.size,Ri.snakeCase=Jp.snakeCase,Ri.some=Up.some,Ri.sortedIndex=zp.sortedIndex,Ri.sortedIndexBy=zp.sortedIndexBy,Ri.sortedIndexOf=zp.sortedIndexOf,Ri.sortedLastIndex=zp.sortedLastIndex,Ri.sortedLastIndexBy=zp.sortedLastIndexBy,Ri.sortedLastIndexOf=zp.sortedLastIndexOf,Ri.startCase=Jp.startCase,Ri.startsWith=Jp.startsWith,Ri.subtract=$p.subtract,Ri.sum=$p.sum,Ri.sumBy=$p.sumBy,Ri.template=Jp.template,Ri.times=Qp.times,Ri.toFinite=Wp.toFinite,Ri.toInteger=qr,Ri.toLength=Wp.toLength,Ri.toLower=Jp.toLower,Ri.toNumber=Wp.toNumber,Ri.toSafeInteger=Wp.toSafeInteger,Ri.toString=Wp.toString,Ri.toUpper=Jp.toUpper,Ri.trim=Jp.trim,Ri.trimEnd=Jp.trimEnd,Ri.trimStart=Jp.trimStart,Ri.truncate=Jp.truncate,Ri.unescape=Jp.unescape,Ri.uniqueId=Qp.uniqueId,Ri.upperCase=Jp.upperCase,Ri.upperFirst=Jp.upperFirst,Ri.each=Up.forEach,Ri.eachRight=Up.forEachRight,Ri.first=zp.head,ug(Ri,(rg={},Nc(Ri,(function(e,t){sg.call(Ri.prototype,t)||(rg[t]=e)})),rg),{chain:!1}),Ri.VERSION="4.17.21",(Ri.templateSettings=Jp.templateSettings).imports._=Ri,$i(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Ri[e].placeholder=Ri})),$i(["drop","take"],(function(e,t){_i.prototype[e]=function(n){n=void 0===n?1:lg(qr(n),0);var r=this.__filtered__&&!t?new _i(this):this.clone();return r.__filtered__?r.__takeCount__=cg(n,r.__takeCount__):r.__views__.push({size:cg(n,ig),type:e+(r.__dir__<0?"Right":"")}),r},_i.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),$i(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;_i.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:kc(e),type:n}),t.__filtered__=t.__filtered__||r,t}})),$i(["head","last"],(function(e,t){var n="take"+(t?"Right":"");_i.prototype[e]=function(){return this[n](1).value()[0]}})),$i(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");_i.prototype[e]=function(){return this.__filtered__?new _i(this):this[n](1)}})),_i.prototype.compact=function(){return this.filter(Kr)},_i.prototype.find=function(e){return this.filter(e).head()},_i.prototype.findLast=function(e){return this.reverse().find(e)},_i.prototype.invokeMap=Co((function(e,t){return"function"==typeof e?new _i(this):this.map((function(n){return Ah(n,e,t)}))})),_i.prototype.reject=function(e){return this.filter(ld(kc(e)))},_i.prototype.slice=function(e,t){e=qr(e);var n=this;return n.__filtered__&&(e>0||t<0)?new _i(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=qr(t))<0?n.dropRight(-t):n.take(t-e)),n)},_i.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},_i.prototype.toArray=function(){return this.take(ig)},Nc(_i.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=Ri[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(Ri.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,a=t instanceof _i,l=s[0],c=a||Pr(t),u=function(e){var t=i.apply(Ri,Ds([e],s));return r&&h?t[0]:t};c&&n&&"function"==typeof l&&1!=l.length&&(a=c=!1);var h=this.__chain__,d=!!this.__actions__.length,f=o&&!h,p=a&&!d;if(!o&&c){t=p?t:new _i(this);var g=e.apply(t,s);return g.__actions__.push({func:sp,args:[u],thisArg:void 0}),new Ti(g,h)}return f&&p?e.apply(this,s):(g=this.thru(u),f?r?g.value()[0]:g.value():g)})})),$i(["pop","push","shift","sort","splice","unshift"],(function(e){var t=og[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Ri.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Pr(i)?i:[],e)}return this[n]((function(n){return t.apply(Pr(n)?n:[],e)}))}})),Nc(_i.prototype,(function(e,t){var n=Ri[t];if(n){var r=n.name+"";sg.call(Ai,r)||(Ai[r]=[]),Ai[r].push({name:t,func:n})}})),Ai[ao(void 0,2).name]=[{name:"wrapper",func:void 0}],_i.prototype.clone=function(){var e=new _i(this.__wrapped__);return e.__actions__=Pi(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Pi(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Pi(this.__views__),e},_i.prototype.reverse=function(){if(this.__filtered__){var e=new _i(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},_i.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Pr(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=tg(t,e+s);break;case"takeRight":e=eg(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,l=a-s,c=r?a:s-1,u=this.__iteratees__,h=u.length,d=0,f=ng(l,this.__takeCount__);if(!n||!r&&i==l&&f==l)return cp(e,this.__actions__);var p=[];e:for(;l--&&d<f;){for(var g=-1,m=e[c+=t];++g<h;){var v=u[g],y=v.iteratee,b=v.type,x=y(m);if(2==b)m=x;else if(!x){if(1==b)continue e;break e}}p[d++]=m}return p},Ri.prototype.at=Zp.at,Ri.prototype.chain=Zp.wrapperChain,Ri.prototype.commit=Zp.commit,Ri.prototype.next=Zp.next,Ri.prototype.plant=Zp.plant,Ri.prototype.reverse=Zp.reverse,Ri.prototype.toJSON=Ri.prototype.valueOf=Ri.prototype.value=Zp.value,Ri.prototype.first=Ri.prototype.head,ag&&(Ri.prototype[ag]=Zp.toIterator);const dg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};const fg=/^\s*class\s+/.test(`${class{}}`)||/^\s*class\s*\{/.test(`${class{}}`);function pg(e,t){let n;return fg?n=new Function("base",`return class ${e} extends base { }`)(t):(n=new Function("base",`return function ${e}() { return base.apply(this, arguments) }`)(t),function(e,t){function n(){this.constructor=e}dg(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(n,t)),n}function gg(e,t,n="/"){let r;const i=Array.isArray(t)?t:t.split(n);if(i.length)for(r=e;i.length;){const e=i.shift();if(Object(r)!==r||!e||!(e in r))return;r=r[e]}return r}function mg(e,t,n,r="/"){const i=Array.isArray(t)?t:t.split(r),o=i.pop();if(o){let t=e;i.forEach((e=>{null==t[e]&&(t[e]={}),t=t[e]})),t[o]=n}return e}function vg(e,t,n="/"){const r=Array.isArray(t)?t.slice():t.split(n),i=r.pop();if(i)if(r.length>0){const t=gg(e,r);t&&delete t[i]}else delete e[i];return e}const yg=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},bg=yg((e=>e.replace(/\B([A-Z])/g,"-$1").toLowerCase())),xg=yg((e=>Uf(qa(e)).replace(/ /g,"")));function wg(e){let t=2166136261,n=!1,r=e;for(let e=0,i=r.length;e<i;e+=1){let i=r.charCodeAt(e);i>127&&!n&&(r=unescape(encodeURIComponent(r)),i=r.charCodeAt(e),n=!0),t^=i,t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24)}return t>>>0}function Cg(){let e="";const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";for(let n=0,r=t.length;n<r;n+=1){const r=t[n],i=16*Math.random()|0;e+=("x"===r?i:"y"===r?3&i|8:r).toString(16)}return e}function Eg(e,t={}){const n=fr.parseHTML(e,null,!1);return n.forEach((e=>{const t=e;if(t){const e=t.attributes;if(e)for(let n=0,r=e.length;n<r;n+=1){const r=e.item(n);if(r){const e=r.value.toLowerCase(),n=r.name.toLowerCase();(n.startsWith("on")||e.startsWith("javascript:")||e.startsWith("data:")||e.startsWith("vbscript:"))&&t.removeAttribute(n)}}}})),t.raw?n:fr("<div/>").append(n).html()}function _g(e,t,n){let r=new Array(t.length+1),i=new Array(t.length+1);const o=n+1;for(let e=0;e<=t.length;e+=1)r[e]=e;for(let s=1;s<=e.length;s+=1){const a=e.charCodeAt(s-1),l=s>n?s-n:1,c=t.length>n+s?n+s:t.length;i[0]=s;let u=s;for(let e=1;e<l;e+=1)i[e]=o;for(let e=l;e<=c;e+=1){const n=a===t.charCodeAt(e-1)?r[e-1]:Math.min(r[e]+1,i[e-1]+1,r[e-1]+2);i[e]=n,u=Math.min(u,n)}for(let e=c+1;e<=t.length;e+=1)i[e]=o;if(u>n)return;const h=r;r=i,i=h}const s=r[t.length];return s>n?void 0:s}function Sg(e){return"string"==typeof e&&"%"===e.slice(-1)}function Og(e,t){if(null==e)return 0;let n;if("string"==typeof e){if(n=parseFloat(e),Sg(e)&&(n/=100,Number.isFinite(n)))return n*t}else n=e;return Number.isFinite(n)?n>0&&n<1?n*t:n:0}function Ag(e,t){const n=parseFloat(e);if(Number.isNaN(n))return null;let r;if(null==t)r="[A-Za-z]*";else if(Array.isArray(t)){if(0===t.length)return null;r=t.join("|")}else"string"==typeof t&&(r=t);const i=function(t){const n=new RegExp(`(?:\\d+(?:\\.\\d+)*)(${t})$`).exec(e);return n?n[1]:null}(r);return null===i?null:{unit:i,value:n}}function kg(e){if("object"==typeof e){let t=0,n=0,r=0,i=0;return null!=e.vertical&&Number.isFinite(e.vertical)&&(n=i=e.vertical),null!=e.horizontal&&Number.isFinite(e.horizontal)&&(r=t=e.horizontal),null!=e.left&&Number.isFinite(e.left)&&(t=e.left),null!=e.top&&Number.isFinite(e.top)&&(n=e.top),null!=e.right&&Number.isFinite(e.right)&&(r=e.right),null!=e.bottom&&Number.isFinite(e.bottom)&&(i=e.bottom),{top:n,right:r,bottom:i,left:t}}let t=0;return null!=e&&Number.isFinite(e)&&(t=e),{top:t,right:t,bottom:t,left:t}}function Mg(e,t,n){if(n)switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2]);case 4:return e.call(t,n[0],n[1],n[2],n[3]);case 5:return e.call(t,n[0],n[1],n[2],n[3],n[4]);case 6:return e.call(t,n[0],n[1],n[2],n[3],n[4],n[5]);default:return e.apply(t,n)}return e.call(t)}function Tg(e,t,...n){return Mg(e,t,n)}function Pg(e){return null!=e&&(e instanceof Promise||function(e){return"object"==typeof e&&e.then&&"function"==typeof e.then}(e))}function Dg(...e){const t=[];e.forEach((e=>{Array.isArray(e)?t.push(...e):t.push(e)}));if(t.some((e=>Pg(e)))){const e=t.map((e=>Pg(e)?e:Promise.resolve(!1!==e)));return Promise.all(e).then((e=>e.reduce(((e,t)=>!1!==t&&e),!0)))}return t.every((e=>!1!==e))}const Ng=/[\t\r\n\f]/g,Rg=/\S+/g,Ig=e=>` ${e} `;function jg(e){return e&&e.getAttribute&&e.getAttribute("class")||""}function Lg(e,t){if(null==e||null==t)return!1;const n=Ig(jg(e)),r=Ig(t);return 1===e.nodeType&&n.replace(Ng," ").includes(r)}function Fg(e,t){if(null!=e&&null!=t){if("function"==typeof t)return Fg(e,t(jg(e)));if("string"==typeof t&&1===e.nodeType){const n=t.match(Rg)||[],r=Ig(jg(e)).replace(Ng," ");let i=n.reduce(((e,t)=>e.indexOf(Ig(t))<0?`${e}${t} `:e),r);i=i.trim(),r!==i&&e.setAttribute("class",i)}}}function Gg(e,t){if(null!=e){if("function"==typeof t)return Gg(e,t(jg(e)));if((!t||"string"==typeof t)&&1===e.nodeType){const n=(t||"").match(Rg)||[],r=Ig(jg(e)).replace(Ng," ");let i=n.reduce(((e,t)=>{const n=Ig(t);return e.indexOf(n)>-1?e.replace(n," "):e}),r);i=t?i.trim():"",r!==i&&e.setAttribute("class",i)}}}function Bg(e,t,n){if(null!=e&&null!=t)if(null==n||"string"!=typeof t){if("function"==typeof t)return Bg(e,t(jg(e),n),n);if("string"==typeof t){(t.match(Rg)||[]).forEach((t=>{Lg(e,t)?Gg(e,t):Fg(e,t)}))}}else n?Fg(e,t):Gg(e,t)}let zg=0;function Ug(e){return null!=e.id&&""!==e.id||(e.id=(zg+=1,`v${zg}`)),e.id}function Vg(e){return null!=e&&("function"==typeof e.getScreenCTM&&e instanceof SVGElement)}const Hg={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"};function Wg(e,t=document){return t.createElement(e)}function $g(e,t=Hg.xhtml,n=document){return n.createElementNS(t,e)}function Xg(e,t=document){return $g(e,Hg.svg,t)}function Yg(e){if(e){const t=`<svg xmlns="${Hg.svg}" xmlns:xlink="${Hg.xlink}" version="1.1">${e}</svg>`,{documentElement:n}=qg(t,{async:!1});return n}const t=document.createElementNS(Hg.svg,"svg");return t.setAttributeNS(Hg.xmlns,"xmlns:xlink",Hg.xlink),t.setAttribute("version","1.1"),t}function qg(e,t={}){let n;try{const r=new DOMParser;if(null!=t.async){r.async=t.async}n=r.parseFromString(e,t.mimeType||"text/xml")}catch(e){n=void 0}if(!n||n.getElementsByTagName("parsererror").length)throw new Error(`Invalid XML: ${e}`);return n}function Kg(e){let t=0,n=e.previousSibling;for(;n;)1===n.nodeType&&(t+=1),n=n.previousSibling;return t}function Zg(e,t){return e.querySelector(t)}function Jg(e,t,n){const r=e.ownerSVGElement;let i=e.parentNode;for(;i&&i!==n&&i!==r;){if(Lg(i,t))return i;i=i.parentNode}return null}function Qg(e,t){const n=t&&t.parentNode;return e===n||!!(n&&1===n.nodeType&&16&e.compareDocumentPosition(n))}function em(e){e.parentNode&&e.parentNode.removeChild(e)}function tm(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function nm(e,t){(Array.isArray(t)?t:[t]).forEach((t=>{null!=t&&e.appendChild(t)}))}function rm(e,t){const n=e.parentNode;if(n){(Array.isArray(t)?t:[t]).forEach((t=>{null!=t&&n.insertBefore(t,e)}))}}function im(e){try{return e instanceof HTMLElement}catch(t){return"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument}}function om(e,t){const n=cm(t);n.ns?e.hasAttributeNS(n.ns,n.local)&&e.removeAttributeNS(n.ns,n.local):e.hasAttribute(t)&&e.removeAttribute(t)}function sm(e,t,n){if(null==n)return om(e,t);const r=cm(t);r.ns&&"string"==typeof n?e.setAttributeNS(r.ns,t,n):"id"===t?e.id=`${n}`:e.setAttribute(t,`${n}`)}function am(e,t){Object.keys(t).forEach((n=>{sm(e,n,t[n])}))}function lm(e,t,n){if(null==t){const t=e.attributes,n={};for(let e=0;e<t.length;e+=1)n[t[e].name]=t[e].value;return n}if("string"==typeof t&&void 0===n)return e.getAttribute(t);"object"==typeof t?am(e,t):sm(e,t,n)}function cm(e){if(-1!==e.indexOf(":")){const t=e.split(":");return{ns:Hg[t[0]],local:t[1]}}return{ns:null,local:e}}function um(e){const t={};return Object.keys(e).forEach((n=>{const r=bg(n);t[r]=e[n]})),t}function hm(e){const t={};return e.split(";").forEach((e=>{const n=e.trim();if(n){const e=n.split("=");e.length&&(t[e[0].trim()]=e[1]?e[1].trim():"")}})),t}function dm(e,t){return Object.keys(t).forEach((n=>{if("class"===n)e[n]=e[n]?`${e[n]} ${t[n]}`:t[n];else if("style"===n){const r="object"==typeof e[n],i="object"==typeof t[n];let o,s;r&&i?(o=e[n],s=t[n]):r?(o=e[n],s=hm(t[n])):i?(o=hm(e[n]),s=t[n]):(o=hm(e[n]),s=hm(t[n])),e[n]=dm(o,s)}else e[n]=t[n]})),e}function fm(e,t,n={}){const r=n.offset||0,i=[],o=[];let s,a,l=null;for(let c=0;c<e.length;c+=1){s=o[c]=e[c];for(let i=0,a=t.length;i<a;i+=1){const a=t[i],l=a.start+r,u=a.end+r;c>=l&&c<u&&("string"==typeof s?s=o[c]={t:e[c],attrs:a.attrs}:s.attrs=dm(dm({},s.attrs),a.attrs),n.includeAnnotationIndices&&(null==s.annotations&&(s.annotations=[]),s.annotations.push(i)))}a=o[c-1],a?zr(s)&&zr(a)?(l=l,JSON.stringify(s.attrs)===JSON.stringify(a.attrs)?l.t+=s.t:(i.push(l),l=s)):zr(s)||zr(a)?(l=l,i.push(l),l=s):l=(l||"")+s:l=s}return null!=l&&i.push(l),i}var pm,gm;let mm;!function(e){function t(e){return null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e}function n(e){return Array.isArray(e)}function r(e,i){if(e===i)return!0;if(t(e)||t(i))return!1;const o=n(e),s=n(i);return o===s&&(o&&s?function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n+=1)if(!r(e[n],t[n]))return!1;return!0}(e,i):function(e,t){if(e===t)return!0;for(const n in e)if(!(n in t))return!1;for(const n in t)if(!(n in e))return!1;for(const n in e)if(!r(e[n],t[n]))return!1;return!0}(e,i))}function i(e){return t(e)?e:n(e)?function(e){const t=new Array(e.length);for(let n=0,r=e.length;n<r;n+=1)t[n]=i(e[n]);return t}(e):function(e){const t={};return Object.keys(e).forEach((n=>{t[n]=i(e[n])})),t}(e)}e.emptyObject=Object.freeze({}),e.emptyArray=Object.freeze([]),e.isPrimitive=t,e.isArray=n,e.isObject=function(e){return!t(e)&&!n(e)},e.deepEqual=r,e.deepCopy=i}(pm||(pm={})),function(e){function t(e){const t="data:";return e.substr(0,t.length)===t}function n(e){let t=e.replace(/\s/g,"");t=decodeURIComponent(t);const n=t.indexOf(","),r=t.slice(0,n),i=r.split(":")[1].split(";")[0],o=t.slice(n+1);let s;s=r.indexOf("base64")>=0?atob(o):unescape(encodeURIComponent(o));const a=new Uint8Array(s.length);for(let e=0;e<s.length;e+=1)a[e]=s.charCodeAt(e);return new Blob([a],{type:i})}function r(e,t){const n=window.navigator.msSaveBlob;if(n)n(e,t);else{const n=window.URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}}function i(e){const t=parseFloat(e);return Number.isNaN(t)?null:t}e.isDataUrl=t,e.imageToDataUri=function(e,n){if(!e||t(e))return void setTimeout((()=>n(null,e)));const r=()=>{n(new Error(`Failed to load image: ${e}`))},i=window.FileReader?e=>{if(200===e.status){const t=new FileReader;t.onload=e=>{const t=e.target.result;n(null,t)},t.onerror=r,t.readAsDataURL(e.response)}else r()}:t=>{if(200===t.status){let r=e.split(".").pop()||"png";"svg"===r&&(r="svg+xml");const i=`data:image/${r};base64,`,o=new Uint8Array(t.response),s=i+btoa((e=>{const t=[];for(let n=0;n<e.length;n+=32768)t.push(String.fromCharCode.apply(null,e.subarray(n,n+32768)));return t.join("")})(o));n(null,s)}else r()},o=new XMLHttpRequest;o.responseType=window.FileReader?"blob":"arraybuffer",o.open("GET",e,!0),o.addEventListener("error",r),o.addEventListener("load",(()=>i(o))),o.send()},e.dataUriToBlob=n,e.downloadBlob=r,e.downloadDataUri=function(e,t){r(n(e),t)},e.svgToDataUrl=function(e,t={}){let n=null;const r=t=>(null==n&&(n=function(e){const t=e.match(/<svg[^>]*viewBox\s*=\s*(["']?)(.+?)\1[^>]*>/i);return t&&t[2]?t[2].replace(/\s+/," ").split(" "):null}(e)),null!=n?i(n[t]):null),o=t=>{const n=e.match(t);return n&&n[2]?i(n[2]):null};let s=t.width;if(null==s&&(s=o(/<svg[^>]*width\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==s&&(s=r(2)),null==s)throw new Error("Can not parse width from svg string");let a=t.height;if(null==a&&(a=o(/<svg[^>]*height\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==a&&(a=r(3)),null==a)throw new Error("Can not parse height from svg string");return`data:image/svg+xml,${encodeURIComponent(e).replace(/'/g,"%27").replace(/"/g,"%22")}`}}(gm||(gm={}));const vm={px:e=>e,mm:e=>mm*e,cm:e=>mm*e*10,in:e=>mm*e*25.4,pt:e=>mm*(25.4*e/72),pc:e=>mm*(25.4*e/6)};var ym;!function(e){function t(e,t,n){const r=fr("<div/>").css({display:"inline-block",position:"absolute",left:-15e3,top:-15e3,width:e+(n||""),height:t+(n||"")}).appendTo(document.body),i={width:r.width()||0,height:r.height()||0};return r.remove(),i}e.measure=t,e.toPx=function(e,n){null==mm&&(mm=t("1","1","mm").width);const r=n?vm[n]:null;return r?r(e):e}}(ym||(ym={}));const bm=function(){let e;const t=window;if(null!=t&&(e=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame,null!=e&&(e=e.bind(t))),null==e){let t=0;e=e=>{const n=(new Date).getTime(),r=Math.max(0,16-(n-t)),i=setTimeout((()=>{e(n+r)}),r);return t=n+r,i}}return e}(),xm=function(){let e;const t=window;return null!=t&&(e=t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.webkitCancelRequestAnimationFrame||t.msCancelAnimationFrame||t.msCancelRequestAnimationFrame||t.oCancelAnimationFrame||t.oCancelRequestAnimationFrame||t.mozCancelAnimationFrame||t.mozCancelRequestAnimationFrame,e&&(e=e.bind(t))),null==e&&(e=clearTimeout),e}();function wm(e,t){const n=e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):window.getComputedStyle(e,null);return n&&t?n.getPropertyValue(t)||n[t]:n}var Cm;function Em(e,t=0){return Number.isInteger(e)?e:+e.toFixed(t)}function _m(e,t){let n,r;if(null==t?(r=null==e?1:e,n=0):(r=t,n=null==e?0:e),r<n){const e=n;n=r,r=e}return Math.floor(Math.random()*(r-n+1)+n)}function Sm(e,t,n){return Number.isNaN(e)?NaN:Number.isNaN(t)||Number.isNaN(n)?0:t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e}function Om(e,t){return t*Math.round(e/t)}function Am(e,t){return null!=t&&null!=e&&t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height}function km(e,t){const n=e.x-t.x,r=e.y-t.y;return n*n+r*r}!document||document.createElement("div").style,function(e){e.toDeg=function(e){return 180*e/Math.PI%360},e.toRad=function(e,t=!1){return(t?e:e%360)*Math.PI/180},e.normalize=function(e){return e%360+(e<0?360:0)}}(Cm||(Cm={}));class Mm{valueOf(){return this.toJSON()}toString(){return JSON.stringify(this.toJSON())}}class Tm extends Mm{constructor(e,t){super(),this.x=null==e?0:e,this.y=null==t?0:t}get[Symbol.toStringTag](){return Tm.toStringTag}round(e=0){return this.x=Em(this.x,e),this.y=Em(this.y,e),this}add(e,t){const n=Tm.create(e,t);return this.x+=n.x,this.y+=n.y,this}update(e,t){const n=Tm.create(e,t);return this.x=n.x,this.y=n.y,this}translate(e,t){const n=Tm.create(e,t);return this.x+=n.x,this.y+=n.y,this}rotate(e,t){const n=Tm.rotate(this,e,t);return this.x=n.x,this.y=n.y,this}scale(e,t,n=new Tm){const r=Tm.create(n);return this.x=r.x+e*(this.x-r.x),this.y=r.y+t*(this.y-r.y),this}closest(e){if(1===e.length)return Tm.create(e[0]);let t=null,n=1/0;return e.forEach((e=>{const r=this.squaredDistance(e);r<n&&(t=e,n=r)})),t?Tm.create(t):null}distance(e){return Math.sqrt(this.squaredDistance(e))}squaredDistance(e){const t=Tm.create(e),n=this.x-t.x,r=this.y-t.y;return n*n+r*r}manhattanDistance(e){const t=Tm.create(e);return Math.abs(t.x-this.x)+Math.abs(t.y-this.y)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}theta(e=new Tm){const t=Tm.create(e),n=-(t.y-this.y),r=t.x-this.x;let i=Math.atan2(n,r);return i<0&&(i=2*Math.PI+i),180*i/Math.PI}angleBetween(e,t){if(this.equals(e)||this.equals(t))return NaN;let n=this.theta(t)-this.theta(e);return n<0&&(n+=360),n}vectorAngle(e){return new Tm(0,0).angleBetween(this,e)}toPolar(e){return this.update(Tm.toPolar(this,e)),this}changeInAngle(e,t,n=new Tm){return this.clone().translate(-e,-t).theta(n)-this.theta(n)}adhereToRect(e){return Am(e,this)||(this.x=Math.min(Math.max(this.x,e.x),e.x+e.width),this.y=Math.min(Math.max(this.y,e.y),e.y+e.height)),this}bearing(e){const t=Tm.create(e),n=Cm.toRad(this.y),r=Cm.toRad(t.y),i=this.x,o=t.x,s=Cm.toRad(o-i),a=Math.sin(s)*Math.cos(r),l=Math.cos(n)*Math.sin(r)-Math.sin(n)*Math.cos(r)*Math.cos(s);let c=Cm.toDeg(Math.atan2(a,l))-22.5;return c<0&&(c+=360),c=parseInt(c/45,10),["NE","E","SE","S","SW","W","NW","N"][c]}cross(e,t){if(null!=e&&null!=t){const n=Tm.create(e),r=Tm.create(t);return(r.x-this.x)*(n.y-this.y)-(r.y-this.y)*(n.x-this.x)}return NaN}dot(e){const t=Tm.create(e);return this.x*t.x+this.y*t.y}diff(e,t){if("number"==typeof e)return new Tm(this.x-e,this.y-t);const n=Tm.create(e);return new Tm(this.x-n.x,this.y-n.y)}lerp(e,t){const n=Tm.create(e);return new Tm((1-t)*this.x+t*n.x,(1-t)*this.y+t*n.y)}normalize(e=1){const t=e/this.magnitude();return this.scale(t,t)}move(e,t){const n=Tm.create(e),r=Cm.toRad(n.theta(this));return this.translate(Math.cos(r)*t,-Math.sin(r)*t)}reflection(e){return Tm.create(e).move(this,this.distance(e))}snapToGrid(e,t){return this.x=Om(this.x,e),this.y=Om(this.y,null==t?e:t),this}equals(e){const t=Tm.create(e);return null!=t&&t.x===this.x&&t.y===this.y}clone(){return Tm.clone(this)}toJSON(){return Tm.toJSON(this)}serialize(){return`${this.x} ${this.y}`}}!function(e){e.toStringTag=`X6.Geometry.${e.name}`,e.isPoint=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"number"==typeof r.x&&"number"==typeof r.y&&"function"==typeof r.toPolar}}(Tm||(Tm={})),function(e){e.isPointLike=function(e){return null!=e&&"object"==typeof e&&"number"==typeof e.x&&"number"==typeof e.y},e.isPointData=function(e){return null!=e&&Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}}(Tm||(Tm={})),function(e){function t(t){return e.isPoint(t)?new e(t.x,t.y):Array.isArray(t)?new e(t[0],t[1]):new e(t.x,t.y)}function n(e,t){return e===t||null!=e&&null!=t&&(e.x===t.x&&e.y===t.y)}function r(n,r,i,o=new e){const s=t(n),a=t(o),l=s.x-a.x,c=s.y-a.y,u=c*r+l*i;return new e(l*r-c*i+a.x,u+a.y)}e.create=function(n,r){return null==n||"number"==typeof n?new e(n,r):t(n)},e.clone=t,e.toJSON=function(t){return e.isPoint(t)?{x:t.x,y:t.y}:Array.isArray(t)?{x:t[0],y:t[1]}:{x:t.x,y:t.y}},e.fromPolar=function(n,r,i=new e){let o=Math.abs(n*Math.cos(r)),s=Math.abs(n*Math.sin(r));const a=t(i),l=Cm.normalize(Cm.toDeg(r));return l<90?s=-s:l<180?(o=-o,s=-s):l<270&&(o=-o),new e(a.x+o,a.y+s)},e.toPolar=function(n,r=new e){const i=t(n),o=t(r),s=i.x-o.x,a=i.y-o.y;return new e(Math.sqrt(s*s+a*a),Cm.toRad(o.theta(i)))},e.equals=n,e.equalPoints=function(e,t){if(null==e&&null!=t||null!=e&&null==t||null!=e&&null!=t&&e.length!==t.length)return!1;if(null!=e&&null!=t)for(let r=0,i=e.length;r<i;r+=1)if(!n(e[r],t[r]))return!1;return!0},e.random=function(t,n,r,i){return new e(_m(t,n),_m(r,i))},e.rotate=function(e,t,n){const i=Cm.toRad(Cm.normalize(-t)),o=Math.sin(i);return r(e,Math.cos(i),o,n)},e.rotateEx=r}(Tm||(Tm={}));class Pm extends Mm{constructor(e,t,n,r){super(),this.x=null==e?0:e,this.y=null==t?0:t,this.width=null==n?0:n,this.height=null==r?0:r}get[Symbol.toStringTag](){return Pm.toStringTag}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get origin(){return new Tm(this.x,this.y)}get topLeft(){return new Tm(this.x,this.y)}get topCenter(){return new Tm(this.x+this.width/2,this.y)}get topRight(){return new Tm(this.x+this.width,this.y)}get center(){return new Tm(this.x+this.width/2,this.y+this.height/2)}get bottomLeft(){return new Tm(this.x,this.y+this.height)}get bottomCenter(){return new Tm(this.x+this.width/2,this.y+this.height)}get bottomRight(){return new Tm(this.x+this.width,this.y+this.height)}get corner(){return new Tm(this.x+this.width,this.y+this.height)}get rightMiddle(){return new Tm(this.x+this.width,this.y+this.height/2)}get leftMiddle(){return new Tm(this.x,this.y+this.height/2)}get topLine(){return new Dm(this.topLeft,this.topRight)}get rightLine(){return new Dm(this.topRight,this.bottomRight)}get bottomLine(){return new Dm(this.bottomLeft,this.bottomRight)}get leftLine(){return new Dm(this.topLeft,this.bottomLeft)}getOrigin(){return this.origin}getTopLeft(){return this.topLeft}getTopCenter(){return this.topCenter}getTopRight(){return this.topRight}getCenter(){return this.center}getCenterX(){return this.x+this.width/2}getCenterY(){return this.y+this.height/2}getBottomLeft(){return this.bottomLeft}getBottomCenter(){return this.bottomCenter}getBottomRight(){return this.bottomRight}getCorner(){return this.corner}getRightMiddle(){return this.rightMiddle}getLeftMiddle(){return this.leftMiddle}getTopLine(){return this.topLine}getRightLine(){return this.rightLine}getBottomLine(){return this.bottomLine}getLeftLine(){return this.leftLine}bbox(e){if(!e)return this.clone();const t=Cm.toRad(e),n=Math.abs(Math.sin(t)),r=Math.abs(Math.cos(t)),i=this.width*r+this.height*n,o=this.width*n+this.height*r;return new Pm(this.x+(this.width-i)/2,this.y+(this.height-o)/2,i,o)}round(e=0){return this.x=Em(this.x,e),this.y=Em(this.y,e),this.width=Em(this.width,e),this.height=Em(this.height,e),this}add(e,t,n,r){const i=Pm.create(e,t,n,r),o=Math.min(this.x,i.x),s=Math.min(this.y,i.y),a=Math.max(this.x+this.width,i.x+i.width),l=Math.max(this.y+this.height,i.y+i.height);return this.x=o,this.y=s,this.width=a-o,this.height=l-s,this}update(e,t,n,r){const i=Pm.create(e,t,n,r);return this.x=i.x,this.y=i.y,this.width=i.width,this.height=i.height,this}inflate(e,t){const n=e,r=null!=t?t:e;return this.x-=n,this.y-=r,this.width+=2*n,this.height+=2*r,this}snapToGrid(e,t){const n=this.origin.snapToGrid(e,t),r=this.corner.snapToGrid(e,t);return this.x=n.x,this.y=n.y,this.width=r.x-n.x,this.height=r.y-n.y,this}translate(e,t){const n=Tm.create(e,t);return this.x+=n.x,this.y+=n.y,this}scale(e,t,n=new Tm){const r=this.origin.scale(e,t,n);return this.x=r.x,this.y=r.y,this.width*=e,this.height*=t,this}rotate(e,t=this.getCenter()){if(0!==e){const n=Cm.toRad(e),r=Math.cos(n),i=Math.sin(n);let o=this.getOrigin(),s=this.getTopRight(),a=this.getBottomRight(),l=this.getBottomLeft();o=Tm.rotateEx(o,r,i,t),s=Tm.rotateEx(s,r,i,t),a=Tm.rotateEx(a,r,i,t),l=Tm.rotateEx(l,r,i,t);const c=new Pm(o.x,o.y,0,0);c.add(s.x,s.y,0,0),c.add(a.x,a.y,0,0),c.add(l.x,l.y,0,0),this.update(c)}return this}rotate90(){const e=(this.width-this.height)/2;this.x+=e,this.y-=e;const t=this.width;return this.width=this.height,this.height=t,this}moveAndExpand(e){const t=Pm.clone(e);return this.x+=t.x||0,this.y+=t.y||0,this.width+=t.width||0,this.height+=t.height||0,this}getMaxScaleToFit(e,t=this.center){const n=Pm.clone(e),r=t.x,i=t.y;let o=1/0,s=1/0,a=1/0,l=1/0,c=1/0,u=1/0,h=1/0,d=1/0;const f=n.topLeft;f.x<r&&(o=(this.x-r)/(f.x-r)),f.y<i&&(c=(this.y-i)/(f.y-i));const p=n.bottomRight;p.x>r&&(s=(this.x+this.width-r)/(p.x-r)),p.y>i&&(u=(this.y+this.height-i)/(p.y-i));const g=n.topRight;g.x>r&&(a=(this.x+this.width-r)/(g.x-r)),g.y<i&&(h=(this.y-i)/(g.y-i));const m=n.bottomLeft;return m.x<r&&(l=(this.x-r)/(m.x-r)),m.y>i&&(d=(this.y+this.height-i)/(m.y-i)),{sx:Math.min(o,s,a,l),sy:Math.min(c,u,h,d)}}getMaxUniformScaleToFit(e,t=this.center){const n=this.getMaxScaleToFit(e,t);return Math.min(n.sx,n.sy)}containsPoint(e,t){return Am(this,Tm.create(e,t))}containsRect(e,t,n,r){const i=Pm.create(e,t,n,r),o=this.x,s=this.y,a=this.width,l=this.height,c=i.x,u=i.y,h=i.width,d=i.height;return 0!==a&&0!==l&&0!==h&&0!==d&&(c>=o&&u>=s&&c+h<=o+a&&u+d<=s+l)}intersectsWithLine(e){const t=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],n=[],r=[];return t.forEach((t=>{const i=e.intersectsWithLine(t);null!==i&&r.indexOf(i.toString())<0&&(n.push(i),r.push(i.toString()))})),n.length>0?n:null}intersectsWithLineFromCenterToPoint(e,t){const n=Tm.clone(e),r=this.center;let i=null;null!=t&&0!==t&&n.rotate(t,r);const o=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],s=new Dm(r,n);for(let e=o.length-1;e>=0;e-=1){const t=o[e].intersectsWithLine(s);if(null!==t){i=t;break}}return i&&null!=t&&0!==t&&i.rotate(-t,r),i}intersectsWithRect(e,t,n,r){const i=Pm.create(e,t,n,r);if(!this.isIntersectWithRect(i))return null;const o=this.origin,s=this.corner,a=i.origin,l=i.corner,c=Math.max(o.x,a.x),u=Math.max(o.y,a.y);return new Pm(c,u,Math.min(s.x,l.x)-c,Math.min(s.y,l.y)-u)}isIntersectWithRect(e,t,n,r){const i=Pm.create(e,t,n,r),o=this.origin,s=this.corner,a=i.origin,l=i.corner;return!(l.x<=o.x||l.y<=o.y||a.x>=s.x||a.y>=s.y)}normalize(){let e=this.x,t=this.y,n=this.width,r=this.height;return this.width<0&&(e=this.x+this.width,n=-this.width),this.height<0&&(t=this.y+this.height,r=-this.height),this.x=e,this.y=t,this.width=n,this.height=r,this}union(e){const t=Pm.clone(e),n=this.origin,r=this.corner,i=t.origin,o=t.corner,s=Math.min(n.x,i.x),a=Math.min(n.y,i.y),l=Math.max(r.x,o.x),c=Math.max(r.y,o.y);return new Pm(s,a,l-s,c-a)}getNearestSideToPoint(e){const t=Tm.clone(e),n=t.x-this.x,r=this.x+this.width-t.x,i=t.y-this.y;let o=n,s="left";return r<o&&(o=r,s="right"),i<o&&(o=i,s="top"),this.y+this.height-t.y<o&&(s="bottom"),s}getNearestPointToPoint(e){const t=Tm.clone(e);if(this.containsPoint(t)){switch(this.getNearestSideToPoint(t)){case"right":return new Tm(this.x+this.width,t.y);case"left":return new Tm(this.x,t.y);case"bottom":return new Tm(t.x,this.y+this.height);case"top":return new Tm(t.x,this.y)}}return t.adhereToRect(this)}equals(e){return null!=e&&e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height}clone(){return new Pm(this.x,this.y,this.width,this.height)}toJSON(){return{x:this.x,y:this.y,width:this.width,height:this.height}}serialize(){return`${this.x} ${this.y} ${this.width} ${this.height}`}}!function(e){e.toStringTag=`X6.Geometry.${e.name}`,e.isRectangle=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"number"==typeof r.x&&"number"==typeof r.y&&"number"==typeof r.width&&"number"==typeof r.height&&"function"==typeof r.inflate&&"function"==typeof r.moveAndExpand}}(Pm||(Pm={})),function(e){e.isRectangleLike=function(e){return null!=e&&"object"==typeof e&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.width&&"number"==typeof e.height}}(Pm||(Pm={})),function(e){function t(t){return e.isRectangle(t)?t.clone():Array.isArray(t)?new e(t[0],t[1],t[2],t[3]):new e(t.x,t.y,t.width,t.height)}e.create=function(n,r,i,o){return null==n||"number"==typeof n?new e(n,r,i,o):t(n)},e.clone=t,e.fromSize=function(t){return new e(0,0,t.width,t.height)},e.fromPositionAndSize=function(t,n){return new e(t.x,t.y,n.width,n.height)},e.fromEllipse=function(t){return new e(t.x-t.a,t.y-t.b,2*t.a,2*t.b)}}(Pm||(Pm={}));class Dm extends Mm{constructor(e,t,n,r){super(),"number"==typeof e&&"number"==typeof t?(this.start=new Tm(e,t),this.end=new Tm(n,r)):(this.start=Tm.create(e),this.end=Tm.create(t))}get[Symbol.toStringTag](){return Dm.toStringTag}get center(){return new Tm((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}getCenter(){return this.center}round(e=0){return this.start.round(e),this.end.round(e),this}translate(e,t){return"number"==typeof e?(this.start.translate(e,t),this.end.translate(e,t)):(this.start.translate(e),this.end.translate(e)),this}rotate(e,t){return this.start.rotate(e,t),this.end.rotate(e,t),this}scale(e,t,n){return this.start.scale(e,t,n),this.end.scale(e,t,n),this}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const e=this.start.x-this.end.x,t=this.start.y-this.end.y;return e*e+t*t}setLength(e){const t=this.length();if(!t)return this;const n=e/t;return this.scale(n,n,this.start)}parallel(e){const t=this.clone();if(!t.isDifferentiable())return t;const{start:n,end:r}=t,i=n.clone().rotate(270,r),o=r.clone().rotate(90,n);return n.move(o,e),r.move(i,e),t}vector(){return new Tm(this.end.x-this.start.x,this.end.y-this.start.y)}angle(){const e=new Tm(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,e)}bbox(){const e=Math.min(this.start.x,this.end.x),t=Math.min(this.start.y,this.end.y),n=Math.max(this.start.x,this.end.x),r=Math.max(this.start.y,this.end.y);return new Pm(e,t,n-e,r-t)}bearing(){return this.start.bearing(this.end)}closestPoint(e){return this.pointAt(this.closestPointNormalizedLength(e))}closestPointLength(e){return this.closestPointNormalizedLength(e)*this.length()}closestPointTangent(e){return this.tangentAt(this.closestPointNormalizedLength(e))}closestPointNormalizedLength(e){const t=this.vector().dot(new Dm(this.start,e).vector()),n=Math.min(1,Math.max(0,t/this.squaredLength()));return Number.isNaN(n)?0:n}pointAt(e){const t=this.start,n=this.end;return e<=0?t.clone():e>=1?n.clone():t.lerp(n,e)}pointAtLength(e){const t=this.start,n=this.end;let r=!0;e<0&&(r=!1,e=-e);const i=this.length();if(e>=i)return r?n.clone():t.clone();const o=(r?e:i-e)/i;return this.pointAt(o)}divideAt(e){const t=this.pointAt(e);return[new Dm(this.start,t),new Dm(t,this.end)]}divideAtLength(e){const t=this.pointAtLength(e);return[new Dm(this.start,t),new Dm(t,this.end)]}containsPoint(e){const t=this.start,n=this.end;if(0!==t.cross(e,n))return!1;const r=this.length();return!(new Dm(t,e).length()>r)&&!(new Dm(e,n).length()>r)}intersect(e,t){const n=e.intersectsWithLine(this,t);return n?Array.isArray(n)?n:[n]:null}intersectsWithLine(e){const t=new Tm(this.end.x-this.start.x,this.end.y-this.start.y),n=new Tm(e.end.x-e.start.x,e.end.y-e.start.y),r=t.x*n.y-t.y*n.x,i=new Tm(e.start.x-this.start.x,e.start.y-this.start.y),o=i.x*n.y-i.y*n.x,s=i.x*t.y-i.y*t.x;if(0===r||o*r<0||s*r<0)return null;if(r>0){if(o>r||s>r)return null}else if(o<r||s<r)return null;return new Tm(this.start.x+o*t.x/r,this.start.y+o*t.y/r)}isDifferentiable(){return!this.start.equals(this.end)}pointOffset(e){const t=Tm.clone(e),n=this.start,r=this.end;return((r.x-n.x)*(t.y-n.y)-(r.y-n.y)*(t.x-n.x))/this.length()}pointSquaredDistance(e,t){const n=Tm.create(e,t);return this.closestPoint(n).squaredDistance(n)}pointDistance(e,t){const n=Tm.create(e,t);return this.closestPoint(n).distance(n)}tangentAt(e){if(!this.isDifferentiable())return null;const t=this.start,n=this.end,r=this.pointAt(e),i=new Dm(t,n);return i.translate(r.x-t.x,r.y-t.y),i}tangentAtLength(e){if(!this.isDifferentiable())return null;const t=this.start,n=this.end,r=this.pointAtLength(e),i=new Dm(t,n);return i.translate(r.x-t.x,r.y-t.y),i}relativeCcw(e,t){const n=Tm.create(e,t);let r=n.x-this.start.x,i=n.y-this.start.y;const o=this.end.x-this.start.x,s=this.end.y-this.start.y;let a=r*s-i*o;return 0===a&&(a=r*o+i*s,a>0&&(r-=o,i-=s,a=r*o+i*s,a<0&&(a=0))),a<0?-1:a>0?1:0}equals(e){return null!=e&&this.start.x===e.start.x&&this.start.y===e.start.y&&this.end.x===e.end.x&&this.end.y===e.end.y}clone(){return new Dm(this.start,this.end)}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.end.serialize()].join(" ")}}!function(e){e.toStringTag=`X6.Geometry.${e.name}`,e.isLine=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return!(null!=n&&n!==e.toStringTag||!Tm.isPoint(r.start)||!Tm.isPoint(r.end)||"function"!=typeof r.vector||"function"!=typeof r.bearing||"function"!=typeof r.parallel||"function"!=typeof r.intersect)}}(Dm||(Dm={}));class Nm extends Mm{constructor(e,t,n,r){super(),this.x=null==e?0:e,this.y=null==t?0:t,this.a=null==n?0:n,this.b=null==r?0:r}get[Symbol.toStringTag](){return Nm.toStringTag}get center(){return new Tm(this.x,this.y)}bbox(){return Pm.fromEllipse(this)}getCenter(){return this.center}inflate(e,t){const n=e,r=null!=t?t:e;return this.a+=2*n,this.b+=2*r,this}normalizedDistance(e,t){const n=Tm.create(e,t),r=n.x-this.x,i=n.y-this.y,o=this.a,s=this.b;return r*r/(o*o)+i*i/(s*s)}containsPoint(e,t){return this.normalizedDistance(e,t)<=1}intersectsWithLine(e){const t=[],n=this.a,r=this.b,i=e.start,o=e.end,s=e.vector(),a=i.diff(new Tm(this.x,this.y)),l=new Tm(s.x/(n*n),s.y/(r*r)),c=new Tm(a.x/(n*n),a.y/(r*r)),u=s.dot(l),h=s.dot(c),d=h*h-u*(a.dot(c)-1);if(d<0)return null;if(d>0){const e=Math.sqrt(d),n=(-h-e)/u,r=(-h+e)/u;if((n<0||n>1)&&(r<0||r>1))return null;n>=0&&n<=1&&t.push(i.lerp(o,n)),r>=0&&r<=1&&t.push(i.lerp(o,r))}else{const e=-h/u;if(!(e>=0&&e<=1))return null;t.push(i.lerp(o,e))}return t}intersectsWithLineFromCenterToPoint(e,t=0){const n=Tm.clone(e);t&&n.rotate(t,this.getCenter());const r=n.x-this.x,i=n.y-this.y;let o;if(0===r)return o=this.bbox().getNearestPointToPoint(n),t?o.rotate(-t,this.getCenter()):o;const s=i/r,a=s*s,l=this.a*this.a,c=this.b*this.b;let u=Math.sqrt(1/(1/l+a/c));u=r<0?-u:u;const h=s*u;return o=new Tm(this.x+u,this.y+h),t?o.rotate(-t,this.getCenter()):o}tangentTheta(e){const t=Tm.clone(e),n=t.x,r=t.y,i=this.a,o=this.b,s=this.bbox().center,a=s.x,l=s.y,c=n>s.x+i/2,u=n<s.x-i/2;let h,d;return c||u?(d=n>s.x?r-30:r+30,h=i*i/(n-a)-i*i*(r-l)*(d-l)/(o*o*(n-a))+a):(h=r>s.y?n+30:n-30,d=o*o/(r-l)-o*o*(n-a)*(h-a)/(i*i*(r-l))+l),new Tm(h,d).theta(t)}scale(e,t){return this.a*=e,this.b*=t,this}rotate(e,t){const n=Pm.fromEllipse(this);n.rotate(e,t);const r=Nm.fromRect(n);return this.a=r.a,this.b=r.b,this.x=r.x,this.y=r.y,this}translate(e,t){const n=Tm.create(e,t);return this.x+=n.x,this.y+=n.y,this}equals(e){return null!=e&&e.x===this.x&&e.y===this.y&&e.a===this.a&&e.b===this.b}clone(){return new Nm(this.x,this.y,this.a,this.b)}toJSON(){return{x:this.x,y:this.y,a:this.a,b:this.b}}serialize(){return`${this.x} ${this.y} ${this.a} ${this.b}`}}!function(e){e.toStringTag=`X6.Geometry.${e.name}`,e.isEllipse=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"number"==typeof r.x&&"number"==typeof r.y&&"number"==typeof r.a&&"number"==typeof r.b&&"function"==typeof r.inflate&&"function"==typeof r.normalizedDistance}}(Nm||(Nm={})),function(e){function t(t){return e.isEllipse(t)?t.clone():Array.isArray(t)?new e(t[0],t[1],t[2],t[3]):new e(t.x,t.y,t.a,t.b)}e.create=function(n,r,i,o){return null==n||"number"==typeof n?new e(n,r,i,o):t(n)},e.parse=t,e.fromRect=function(t){const n=t.center;return new e(n.x,n.y,t.width/2,t.height/2)}}(Nm||(Nm={}));class Rm extends Mm{constructor(e){if(super(),null!=e){if("string"==typeof e)return Rm.parse(e);this.points=e.map((e=>Tm.create(e)))}else this.points=[]}get[Symbol.toStringTag](){return Rm.toStringTag}get start(){return 0===this.points.length?null:this.points[0]}get end(){return 0===this.points.length?null:this.points[this.points.length-1]}scale(e,t,n=new Tm){return this.points.forEach((r=>r.scale(e,t,n))),this}rotate(e,t){return this.points.forEach((n=>n.rotate(e,t))),this}translate(e,t){const n=Tm.create(e,t);return this.points.forEach((e=>e.translate(n.x,n.y))),this}bbox(){if(0===this.points.length)return new Pm;let e=1/0,t=-1/0,n=1/0,r=-1/0;const i=this.points;for(let o=0,s=i.length;o<s;o+=1){const s=i[o],a=s.x,l=s.y;a<e&&(e=a),a>t&&(t=a),l<n&&(n=l),l>r&&(r=l)}return new Pm(e,n,t-e,r-n)}closestPoint(e){const t=this.closestPointLength(e);return this.pointAtLength(t)}closestPointLength(e){const t=this.points,n=t.length;if(0===n||1===n)return 0;let r=0,i=0,o=1/0;for(let s=0,a=n-1;s<a;s+=1){const n=new Dm(t[s],t[s+1]),a=n.length(),l=n.closestPointNormalizedLength(e),c=n.pointAt(l).squaredDistance(e);c<o&&(o=c,i=r+l*a),r+=a}return i}closestPointNormalizedLength(e){const t=this.closestPointLength(e);if(0===t)return 0;const n=this.length();return 0===n?0:t/n}closestPointTangent(e){const t=this.closestPointLength(e);return this.tangentAtLength(t)}containsPoint(e){if(0===this.points.length)return!1;const t=Tm.clone(e),n=t.x,r=t.y,i=this.points,o=i.length;let s=o-1,a=0;for(let l=0;l<o;l+=1){const o=i[s],c=i[l];if(t.equals(o))return!0;const u=new Dm(o,c);if(u.containsPoint(e))return!0;if(r<=o.y&&r>c.y||r>o.y&&r<=c.y){const t=o.x-n>c.x-n?o.x-n:c.x-n;if(t>=0){const i=new Tm(n+t,r),o=new Dm(e,i);u.intersectsWithLine(o)&&(a+=1)}}s=l}return a%2==1}intersectsWithLine(e){const t=[];for(let n=0,r=this.points.length-1;n<r;n+=1){const r=this.points[n],i=this.points[n+1],o=e.intersectsWithLine(new Dm(r,i));o&&t.push(o)}return t.length>0?t:null}isDifferentiable(){for(let e=0,t=this.points.length-1;e<t;e+=1){const t=this.points[e],n=this.points[e+1];if(new Dm(t,n).isDifferentiable())return!0}return!1}length(){let e=0;for(let t=0,n=this.points.length-1;t<n;t+=1){const n=this.points[t],r=this.points[t+1];e+=n.distance(r)}return e}pointAt(e){const t=this.points,n=t.length;if(0===n)return null;if(1===n)return t[0].clone();if(e<=0)return t[0].clone();if(e>=1)return t[n-1].clone();const r=this.length()*e;return this.pointAtLength(r)}pointAtLength(e){const t=this.points,n=t.length;if(0===n)return null;if(1===n)return t[0].clone();let r=!0;e<0&&(r=!1,e=-e);let i=0;for(let o=0,s=n-1;o<s;o+=1){const n=r?o:s-1-o,a=t[n],l=t[n+1],c=new Dm(a,l),u=a.distance(l);if(e<=i+u)return c.pointAtLength((r?1:-1)*(e-i));i+=u}return(r?t[n-1]:t[0]).clone()}tangentAt(e){const t=this.points.length;if(0===t||1===t)return null;e<0&&(e=0),e>1&&(e=1);const n=this.length()*e;return this.tangentAtLength(n)}tangentAtLength(e){const t=this.points,n=t.length;if(0===n||1===n)return null;let r,i=!0;e<0&&(i=!1,e=-e);let o=0;for(let s=0,a=n-1;s<a;s+=1){const n=i?s:a-1-s,l=t[n],c=t[n+1],u=new Dm(l,c),h=l.distance(c);if(u.isDifferentiable()){if(e<=o+h)return u.tangentAtLength((i?1:-1)*(e-o));r=u}o+=h}if(r){const e=i?1:0;return r.tangentAt(e)}return null}simplify(e={}){const t=this.points;if(t.length<3)return this;const n=e.threshold||0;let r=0;for(;t[r+2];){const e=r+1,i=r+2,o=t[r],s=t[e],a=t[i];new Dm(o,a).closestPoint(s).distance(s)<=n?t.splice(e,1):r+=1}return this}toHull(){const e=this.points,t=e.length;if(0===t)return new Rm;let n=e[0];for(let r=1;r<t;r+=1)(e[r].y<n.y||e[r].y===n.y&&e[r].x>n.x)&&(n=e[r]);const r=[];for(let i=0;i<t;i+=1){let t=n.theta(e[i]);0===t&&(t=360),r.push([e[i],i,t])}if(r.sort(((e,t)=>{let n=e[2]-t[2];return 0===n&&(n=t[1]-e[1]),n})),r.length>2){const e=r[r.length-1];r.unshift(e)}const i={},o=[],s=e=>`${e[0].toString()}@${e[1]}`;for(;0!==r.length;){const e=r.pop(),t=e[0];if(i[s(e)])continue;let n=!1;for(;!n;)if(o.length<2)o.push(e),n=!0;else{const a=o.pop(),l=a[0],c=o.pop(),u=c[0],h=u.cross(l,t);if(h<0)o.push(c),o.push(a),o.push(e),n=!0;else if(0===h){const e=1e-10,n=l.angleBetween(u,t);Math.abs(n-180)<e||l.equals(t)||u.equals(l)?(i[s(a)]=l,o.push(c)):Math.abs((n+1)%360-1)<e&&(o.push(c),r.push(a))}else i[s(a)]=l,o.push(c)}}let a;o.length>2&&o.pop();let l=-1;for(let e=0,t=o.length;e<t;e+=1){const t=o[e][1];(void 0===a||t<a)&&(a=t,l=e)}let c=[];if(l>0){const e=o.slice(l),t=o.slice(0,l);c=e.concat(t)}else c=o;const u=[];for(let e=0,t=c.length;e<t;e+=1)u.push(c[e][0]);return new Rm(u)}equals(e){return null!=e&&(e.points.length===this.points.length&&e.points.every(((e,t)=>e.equals(this.points[t]))))}clone(){return new Rm(this.points.map((e=>e.clone())))}toJSON(){return this.points.map((e=>e.toJSON()))}serialize(){return this.points.map((e=>`${e.x}, ${e.y}`)).join(" ")}}!function(e){e.toStringTag=`X6.Geometry.${e.name}`,e.isPolyline=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.toHull&&"function"==typeof r.simplify}}(Rm||(Rm={})),function(e){e.parse=function(t){const n=t.trim();if(""===n)return new e;const r=[],i=n.split(/\s*,\s*|\s+/);for(let e=0,t=i.length;e<t;e+=2)r.push({x:+i[e],y:+i[e+1]});return new e(r)}}(Rm||(Rm={}));class Im extends Mm{constructor(e,t,n,r){super(),this.PRECISION=3,this.start=Tm.create(e),this.controlPoint1=Tm.create(t),this.controlPoint2=Tm.create(n),this.end=Tm.create(r)}get[Symbol.toStringTag](){return Im.toStringTag}bbox(){const e=this.start,t=this.controlPoint1,n=this.controlPoint2,r=this.end,i=e.x,o=e.y,s=t.x,a=t.y,l=n.x,c=n.y,u=r.x,h=r.y,d=[],f=[],p=[[],[]];let g,m,v,y,b,x,w,C,E,_,S;for(let e=0;e<2;e+=1)if(0===e?(m=6*i-12*s+6*l,g=-3*i+9*s-9*l+3*u,v=3*s-3*i):(m=6*o-12*a+6*c,g=-3*o+9*a-9*c+3*h,v=3*a-3*o),Math.abs(g)<1e-12){if(Math.abs(m)<1e-12)continue;y=-v/m,y>0&&y<1&&f.push(y)}else w=m*m-4*v*g,C=Math.sqrt(w),w<0||(b=(-m+C)/(2*g),b>0&&b<1&&f.push(b),x=(-m-C)/(2*g),x>0&&x<1&&f.push(x));let O=f.length;const A=O;for(;O;)O-=1,y=f[O],S=1-y,E=S*S*S*i+3*S*S*y*s+3*S*y*y*l+y*y*y*u,p[0][O]=E,_=S*S*S*o+3*S*S*y*a+3*S*y*y*c+y*y*y*h,p[1][O]=_,d[O]={X:E,Y:_};f[A]=0,f[A+1]=1,d[A]={X:i,Y:o},d[A+1]={X:u,Y:h},p[0][A]=i,p[1][A]=o,p[0][A+1]=u,p[1][A+1]=h,f.length=A+2,p[0].length=A+2,p[1].length=A+2,d.length=A+2;const k=Math.min.apply(null,p[0]),M=Math.min.apply(null,p[1]),T=Math.max.apply(null,p[0]),P=Math.max.apply(null,p[1]);return new Pm(k,M,T-k,P-M)}closestPoint(e,t={}){return this.pointAtT(this.closestPointT(e,t))}closestPointLength(e,t={}){const n=this.getOptions(t);return this.lengthAtT(this.closestPointT(e,n),n)}closestPointNormalizedLength(e,t={}){const n=this.getOptions(t),r=this.closestPointLength(e,n);if(!r)return 0;const i=this.length(n);return 0===i?0:r/i}closestPointT(e,t={}){const n=this.getPrecision(t),r=this.getDivisions(t),i=Math.pow(10,-n);let o=null,s=0,a=0,l=0,c=0,u=0,h=null;const d=r.length;let f=d>0?1/d:0;for(r.forEach(((t,n)=>{const r=t.start.distance(e),i=t.end.distance(e),d=r+i;(null==h||d<h)&&(o=t,s=n*f,a=(n+1)*f,l=r,c=i,h=d,u=t.endpointDistance())}));;){const t=l?Math.abs(l-c)/l:0,n=null!=c?Math.abs(l-c)/c:0,r=!c||c<u*i,h=!l||l<u*i||r;if(t<i||n<i||h)return l<=c?s:a;const d=o.divide(.5);f/=2;const p=d[0].start.distance(e),g=d[0].end.distance(e),m=p+g,v=d[1].start.distance(e),y=d[1].end.distance(e);m<=v+y?(o=d[0],a-=f,l=p,c=g):(o=d[1],s+=f,l=v,c=y)}}closestPointTangent(e,t={}){return this.tangentAtT(this.closestPointT(e,t))}containsPoint(e,t={}){return this.toPolyline(t).containsPoint(e)}divideAt(e,t={}){if(e<=0)return this.divideAtT(0);if(e>=1)return this.divideAtT(1);const n=this.tAt(e,t);return this.divideAtT(n)}divideAtLength(e,t={}){const n=this.tAtLength(e,t);return this.divideAtT(n)}divide(e){return this.divideAtT(e)}divideAtT(e){const t=this.start,n=this.controlPoint1,r=this.controlPoint2,i=this.end;if(e<=0)return[new Im(t,t,t,t),new Im(t,n,r,i)];if(e>=1)return[new Im(t,n,r,i),new Im(i,i,i,i)];const o=this.getSkeletonPoints(e),s=o.startControlPoint1,a=o.startControlPoint2,l=o.divider,c=o.dividerControlPoint1,u=o.dividerControlPoint2;return[new Im(t,s,a,l),new Im(l,c,u,i)]}endpointDistance(){return this.start.distance(this.end)}getSkeletonPoints(e){const t=this.start,n=this.controlPoint1,r=this.controlPoint2,i=this.end;if(e<=0)return{startControlPoint1:t.clone(),startControlPoint2:t.clone(),divider:t.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:r.clone()};if(e>=1)return{startControlPoint1:n.clone(),startControlPoint2:r.clone(),divider:i.clone(),dividerControlPoint1:i.clone(),dividerControlPoint2:i.clone()};const o=new Dm(t,n).pointAt(e),s=new Dm(n,r).pointAt(e),a=new Dm(r,i).pointAt(e),l=new Dm(o,s).pointAt(e),c=new Dm(s,a).pointAt(e);return{startControlPoint1:o,startControlPoint2:l,divider:new Dm(l,c).pointAt(e),dividerControlPoint1:c,dividerControlPoint2:a}}getSubdivisions(e={}){const t=this.getPrecision(e);let n=[new Im(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(0===t)return n;let r=this.endpointDistance();const i=Math.pow(10,-t);let o=0;for(;;){o+=1;const e=[];n.forEach((t=>{const n=t.divide(.5);e.push(n[0],n[1])}));const t=e.reduce(((e,t)=>e+t.endpointDistance()),0),s=0!==t?(t-r)/t:0;if(o>1&&s<i)return e;n=e,r=t}}length(e={}){return this.getDivisions(e).reduce(((e,t)=>e+t.endpointDistance()),0)}lengthAtT(e,t={}){if(e<=0)return 0;const n=void 0===t.precision?this.PRECISION:t.precision;return this.divide(e)[0].length({precision:n})}pointAt(e,t={}){if(e<=0)return this.start.clone();if(e>=1)return this.end.clone();const n=this.tAt(e,t);return this.pointAtT(n)}pointAtLength(e,t={}){const n=this.tAtLength(e,t);return this.pointAtT(n)}pointAtT(e){return e<=0?this.start.clone():e>=1?this.end.clone():this.getSkeletonPoints(e).divider}isDifferentiable(){const e=this.start,t=this.controlPoint1,n=this.controlPoint2,r=this.end;return!(e.equals(t)&&t.equals(n)&&n.equals(r))}tangentAt(e,t={}){if(!this.isDifferentiable())return null;e<0?e=0:e>1&&(e=1);const n=this.tAt(e,t);return this.tangentAtT(n)}tangentAtLength(e,t={}){if(!this.isDifferentiable())return null;const n=this.tAtLength(e,t);return this.tangentAtT(n)}tangentAtT(e){if(!this.isDifferentiable())return null;e<0&&(e=0),e>1&&(e=1);const t=this.getSkeletonPoints(e),n=t.startControlPoint2,r=t.dividerControlPoint1,i=t.divider,o=new Dm(n,r);return o.translate(i.x-n.x,i.y-n.y),o}getPrecision(e={}){return null==e.precision?this.PRECISION:e.precision}getDivisions(e={}){if(null!=e.subdivisions)return e.subdivisions;const t=this.getPrecision(e);return this.getSubdivisions({precision:t})}getOptions(e={}){return{precision:this.getPrecision(e),subdivisions:this.getDivisions(e)}}tAt(e,t={}){if(e<=0)return 0;if(e>=1)return 1;const n=this.getOptions(t),r=this.length(n)*e;return this.tAtLength(r,n)}tAtLength(e,t={}){let n=!0;e<0&&(n=!1,e=-e);const r=this.getPrecision(t),i=this.getDivisions(t),o={precision:r,subdivisions:i};let s,a,l=null,c=0,u=0,h=0;const d=i.length;let f=d>0?1/d:0;for(let t=0;t<d;t+=1){const r=n?t:d-1-t,o=i[t],p=o.endpointDistance();if(e<=h+p){l=o,s=r*f,a=(r+1)*f,c=n?e-h:p+h-e,u=n?p+h-e:e-h;break}h+=p}if(null==l)return n?1:0;const p=this.length(o),g=Math.pow(10,-r);for(;;){let e,t,n;if(e=0!==p?c/p:0,e<g)return s;if(e=0!==p?u/p:0,e<g)return a;const r=l.divide(.5);f/=2;const i=r[0].endpointDistance(),o=r[1].endpointDistance();c<=i?(l=r[0],a-=f,t=c,n=i-t):(l=r[1],s+=f,t=c-i,n=o-t),c=t,u=n}}toPoints(e={}){const t=this.getDivisions(e),n=[t[0].start.clone()];return t.forEach((e=>n.push(e.end.clone()))),n}toPolyline(e={}){return new Rm(this.toPoints(e))}scale(e,t,n){return this.start.scale(e,t,n),this.controlPoint1.scale(e,t,n),this.controlPoint2.scale(e,t,n),this.end.scale(e,t,n),this}rotate(e,t){return this.start.rotate(e,t),this.controlPoint1.rotate(e,t),this.controlPoint2.rotate(e,t),this.end.rotate(e,t),this}translate(e,t){return"number"==typeof e?(this.start.translate(e,t),this.controlPoint1.translate(e,t),this.controlPoint2.translate(e,t),this.end.translate(e,t)):(this.start.translate(e),this.controlPoint1.translate(e),this.controlPoint2.translate(e),this.end.translate(e)),this}equals(e){return null!=e&&this.start.equals(e.start)&&this.controlPoint1.equals(e.controlPoint1)&&this.controlPoint2.equals(e.controlPoint2)&&this.end.equals(e.end)}clone(){return new Im(this.start,this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.controlPoint1.serialize(),this.controlPoint2.serialize(),this.end.serialize()].join(" ")}}!function(e){e.toStringTag=`X6.Geometry.${e.name}`,e.isCurve=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return!(null!=n&&n!==e.toStringTag||!Tm.isPoint(r.start)||!Tm.isPoint(r.controlPoint1)||!Tm.isPoint(r.controlPoint2)||!Tm.isPoint(r.end)||"function"!=typeof r.toPoints||"function"!=typeof r.toPolyline)}}(Im||(Im={})),function(e){function t(e){const t=e.length,n=[],r=[];let i=2;n[0]=e[0]/i;for(let o=1;o<t;o+=1)r[o]=1/i,i=(o<t-1?4:3.5)-r[o],n[o]=(e[o]-n[o-1])/i;for(let e=1;e<t;e+=1)n[t-e-1]-=r[t-e]*n[t-e];return n}e.throughPoints=function(n){if(null==n||Array.isArray(n)&&n.length<2)throw new Error("At least 2 points are required");const r=function(e){const n=e.map((e=>Tm.clone(e))),r=[],i=[],o=n.length-1;if(1===o)return r[0]=new Tm((2*n[0].x+n[1].x)/3,(2*n[0].y+n[1].y)/3),i[0]=new Tm(2*r[0].x-n[0].x,2*r[0].y-n[0].y),[r,i];const s=[];for(let e=1;e<o-1;e+=1)s[e]=4*n[e].x+2*n[e+1].x;s[0]=n[0].x+2*n[1].x,s[o-1]=(8*n[o-1].x+n[o].x)/2;const a=t(s);for(let e=1;e<o-1;e+=1)s[e]=4*n[e].y+2*n[e+1].y;s[0]=n[0].y+2*n[1].y,s[o-1]=(8*n[o-1].y+n[o].y)/2;const l=t(s);for(let e=0;e<o;e+=1)r.push(new Tm(a[e],l[e])),e<o-1?i.push(new Tm(2*n[e+1].x-a[e+1],2*n[e+1].y-l[e+1])):i.push(new Tm((n[o].x+a[o-1])/2,(n[o].y+l[o-1])/2));return[r,i]}(n),i=[];for(let t=0,o=r[0].length;t<o;t+=1){const o=new Tm(r[0][t].x,r[0][t].y),s=new Tm(r[1][t].x,r[1][t].y);i.push(new e(n[t],o,s,n[t+1]))}return i}}(Im||(Im={}));class jm extends Mm{constructor(){super(...arguments),this.isVisible=!0,this.isSegment=!0,this.isSubpathStart=!1}get end(){return this.endPoint}get start(){if(null==this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path, or segment has not yet been added to a path.)");return this.previousSegment.end}closestPointT(e,t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(e);throw new Error("Neither `closestPointT` nor `closestPointNormalizedLength` method is implemented.")}lengthAtT(e,t){if(e<=0)return 0;const n=this.length();return e>=1?n:n*e}divideAtT(e){if(this.divideAt)return this.divideAt(e);throw new Error("Neither `divideAtT` nor `divideAt` method is implemented.")}pointAtT(e){if(this.pointAt)return this.pointAt(e);throw new Error("Neither `pointAtT` nor `pointAt` method is implemented.")}tangentAtT(e){if(this.tangentAt)return this.tangentAt(e);throw new Error("Neither `tangentAtT` nor `tangentAt` method is implemented.")}}class Lm extends jm{constructor(e,t){super(),Dm.isLine(e)?this.endPoint=e.end.clone().round(2):this.endPoint=Tm.create(e,t).round(2)}get type(){return"L"}get line(){return new Dm(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(e){return this.line.closestPoint(e)}closestPointLength(e){return this.line.closestPointLength(e)}closestPointNormalizedLength(e){return this.line.closestPointNormalizedLength(e)}closestPointTangent(e){return this.line.closestPointTangent(e)}length(){return this.line.length()}divideAt(e){const t=this.line.divideAt(e);return[new Lm(t[0]),new Lm(t[1])]}divideAtLength(e){const t=this.line.divideAtLength(e);return[new Lm(t[0]),new Lm(t[1])]}getSubdivisions(){return[]}pointAt(e){return this.line.pointAt(e)}pointAtLength(e){return this.line.pointAtLength(e)}tangentAt(e){return this.line.tangentAt(e)}tangentAtLength(e){return this.line.tangentAtLength(e)}isDifferentiable(){return null!=this.previousSegment&&!this.start.equals(this.end)}clone(){return new Lm(this.end)}scale(e,t,n){return this.end.scale(e,t,n),this}rotate(e,t){return this.end.rotate(e,t),this}translate(e,t){return"number"==typeof e?this.end.translate(e,t):this.end.translate(e),this}equals(e){return this.type===e.type&&this.start.equals(e.start)&&this.end.equals(e.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){const e=this.end;return`${this.type} ${e.x} ${e.y}`}}!function(e){e.create=function(...t){const n=t.length,r=t[0];if(Dm.isLine(r))return new e(r);if(Tm.isPointLike(r))return 1===n?new e(r):t.map((t=>new e(t)));if(2===n)return new e(+t[0],+t[1]);const i=[];for(let r=0;r<n;r+=2){const n=+t[r],o=+t[r+1];i.push(new e(n,o))}return i}}(Lm||(Lm={}));class Fm extends jm{get end(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. MoveTo), or segment has not yet been added to a path.)");return this.subpathStartSegment.end}get type(){return"Z"}get line(){return new Dm(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(e){return this.line.closestPoint(e)}closestPointLength(e){return this.line.closestPointLength(e)}closestPointNormalizedLength(e){return this.line.closestPointNormalizedLength(e)}closestPointTangent(e){return this.line.closestPointTangent(e)}length(){return this.line.length()}divideAt(e){const t=this.line.divideAt(e);return[t[1].isDifferentiable()?new Lm(t[0]):this.clone(),new Lm(t[1])]}divideAtLength(e){const t=this.line.divideAtLength(e);return[t[1].isDifferentiable()?new Lm(t[0]):this.clone(),new Lm(t[1])]}getSubdivisions(){return[]}pointAt(e){return this.line.pointAt(e)}pointAtLength(e){return this.line.pointAtLength(e)}tangentAt(e){return this.line.tangentAt(e)}tangentAtLength(e){return this.line.tangentAtLength(e)}isDifferentiable(){return!(!this.previousSegment||!this.subpathStartSegment)&&!this.start.equals(this.end)}scale(){return this}rotate(){return this}translate(){return this}equals(e){return this.type===e.type&&this.start.equals(e.start)&&this.end.equals(e.end)}clone(){return new Fm}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return this.type}}!function(e){e.create=function(){return new e}}(Fm||(Fm={}));class Gm extends jm{constructor(e,t){super(),this.isVisible=!1,this.isSubpathStart=!0,Dm.isLine(e)||Im.isCurve(e)?this.endPoint=e.end.clone().round(2):this.endPoint=Tm.create(e,t).round(2)}get start(){throw new Error("Illegal access. Moveto segments should not need a start property.")}get type(){return"M"}bbox(){return null}closestPoint(){return this.end.clone()}closestPointLength(){return 0}closestPointNormalizedLength(){return 0}closestPointT(){return 1}closestPointTangent(){return null}length(){return 0}lengthAtT(){return 0}divideAt(){return[this.clone(),this.clone()]}divideAtLength(){return[this.clone(),this.clone()]}getSubdivisions(){return[]}pointAt(){return this.end.clone()}pointAtLength(){return this.end.clone()}pointAtT(){return this.end.clone()}tangentAt(){return null}tangentAtLength(){return null}tangentAtT(){return null}isDifferentiable(){return!1}scale(e,t,n){return this.end.scale(e,t,n),this}rotate(e,t){return this.end.rotate(e,t),this}translate(e,t){return"number"==typeof e?this.end.translate(e,t):this.end.translate(e),this}clone(){return new Gm(this.end)}equals(e){return this.type===e.type&&this.end.equals(e.end)}toJSON(){return{type:this.type,end:this.end.toJSON()}}serialize(){const e=this.end;return`${this.type} ${e.x} ${e.y}`}}!function(e){e.create=function(...t){const n=t.length,r=t[0];if(Dm.isLine(r))return new e(r);if(Im.isCurve(r))return new e(r);if(Tm.isPointLike(r)){if(1===n)return new e(r);const i=[];for(let r=0;r<n;r+=1)0===r?i.push(new e(t[r])):i.push(new Lm(t[r]));return i}if(2===n)return new e(+t[0],+t[1]);const i=[];for(let r=0;r<n;r+=2){const n=+t[r],o=+t[r+1];0===r?i.push(new e(n,o)):i.push(new Lm(n,o))}return i}}(Gm||(Gm={}));class Bm extends jm{constructor(e,t,n,r,i,o){super(),Im.isCurve(e)?(this.controlPoint1=e.controlPoint1.clone().round(2),this.controlPoint2=e.controlPoint2.clone().round(2),this.endPoint=e.end.clone().round(2)):"number"==typeof e?(this.controlPoint1=new Tm(e,t).round(2),this.controlPoint2=new Tm(n,r).round(2),this.endPoint=new Tm(i,o).round(2)):(this.controlPoint1=Tm.create(e).round(2),this.controlPoint2=Tm.create(t).round(2),this.endPoint=Tm.create(n).round(2))}get type(){return"C"}get curve(){return new Im(this.start,this.controlPoint1,this.controlPoint2,this.end)}bbox(){return this.curve.bbox()}closestPoint(e){return this.curve.closestPoint(e)}closestPointLength(e){return this.curve.closestPointLength(e)}closestPointNormalizedLength(e){return this.curve.closestPointNormalizedLength(e)}closestPointTangent(e){return this.curve.closestPointTangent(e)}length(){return this.curve.length()}divideAt(e,t={}){const n=this.curve.divideAt(e,t);return[new Bm(n[0]),new Bm(n[1])]}divideAtLength(e,t={}){const n=this.curve.divideAtLength(e,t);return[new Bm(n[0]),new Bm(n[1])]}divideAtT(e){const t=this.curve.divideAtT(e);return[new Bm(t[0]),new Bm(t[1])]}getSubdivisions(){return[]}pointAt(e){return this.curve.pointAt(e)}pointAtLength(e){return this.curve.pointAtLength(e)}tangentAt(e){return this.curve.tangentAt(e)}tangentAtLength(e){return this.curve.tangentAtLength(e)}isDifferentiable(){if(!this.previousSegment)return!1;const e=this.start,t=this.controlPoint1,n=this.controlPoint2,r=this.end;return!(e.equals(t)&&t.equals(n)&&n.equals(r))}scale(e,t,n){return this.controlPoint1.scale(e,t,n),this.controlPoint2.scale(e,t,n),this.end.scale(e,t,n),this}rotate(e,t){return this.controlPoint1.rotate(e,t),this.controlPoint2.rotate(e,t),this.end.rotate(e,t),this}translate(e,t){return"number"==typeof e?(this.controlPoint1.translate(e,t),this.controlPoint2.translate(e,t),this.end.translate(e,t)):(this.controlPoint1.translate(e),this.controlPoint2.translate(e),this.end.translate(e)),this}equals(e){return this.start.equals(e.start)&&this.end.equals(e.end)&&this.controlPoint1.equals(e.controlPoint1)&&this.controlPoint2.equals(e.controlPoint2)}clone(){return new Bm(this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){const e=this.controlPoint1,t=this.controlPoint2,n=this.end;return[this.type,e.x,e.y,t.x,t.y,n.x,n.y].join(" ")}}function zm(e,t,n){return{x:e*Math.cos(n)-t*Math.sin(n),y:e*Math.sin(n)+t*Math.cos(n)}}function Um(e,t,n,r,i,o){const s=1/3,a=2/3;return[s*e+a*n,s*t+a*r,s*i+a*n,s*o+a*r,i,o]}function Vm(e,t,n,r,i,o,s,a,l,c){const u=120*Math.PI/180,h=Math.PI/180*(+i||0);let d,f,p,g,m,v=[];if(c)f=c[0],p=c[1],g=c[2],m=c[3];else{d=zm(e,t,-h),e=d.x,t=d.y,d=zm(a,l,-h);const i=(e-(a=d.x))/2,c=(t-(l=d.y))/2;let u=i*i/(n*n)+c*c/(r*r);u>1&&(u=Math.sqrt(u),n*=u,r*=u);const v=n*n,y=r*r,b=(o===s?-1:1)*Math.sqrt(Math.abs((v*y-v*c*c-y*i*i)/(v*c*c+y*i*i)));g=b*n*c/r+(e+a)/2,m=b*-r*i/n+(t+l)/2,f=Math.asin((t-m)/r),p=Math.asin((l-m)/r),f=e<g?Math.PI-f:f,p=a<g?Math.PI-p:p,f<0&&(f=2*Math.PI+f),p<0&&(p=2*Math.PI+p),s&&f>p&&(f-=2*Math.PI),!s&&p>f&&(p-=2*Math.PI)}let y=p-f;if(Math.abs(y)>u){const e=p,t=a,o=l;p=f+u*(s&&p>f?1:-1),v=Vm(a=g+n*Math.cos(p),l=m+r*Math.sin(p),n,r,i,0,s,t,o,[p,e,g,m])}y=p-f;const b=Math.cos(f),x=Math.sin(f),w=Math.cos(p),C=Math.sin(p),E=Math.tan(y/4),_=4/3*(n*E),S=4/3*(r*E),O=[e,t],A=[e+_*x,t-S*b],k=[a+_*C,l-S*w],M=[a,l];if(A[0]=2*O[0]-A[0],A[1]=2*O[1]-A[1],c)return[A,k,M].concat(v);{v=[A,k,M].concat(v).join().split(",");const e=[],t=v.length;for(let n=0;n<t;n+=1)e[n]=n%2?zm(+v[n-1],+v[n],h).y:zm(+v[n],+v[n+1],h).x;return e}}function Hm(e){const t=function(e){if(!e)return null;const t="\t\n\v\f\r   ᠎             　\u2028\u2029",n=new RegExp(`([a-z])[${t},]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[${t}]*,?[${t}]*)+)`,"ig"),r=new RegExp(`(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[${t}]*,?[${t}]*`,"ig"),i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=[];return e.replace(n,((e,t,n)=>{const s=[];let a=t.toLowerCase();n.replace(r,((e,t)=>(t&&s.push(+t),e))),"m"===a&&s.length>2&&(o.push([t,...s.splice(0,2)]),a="l",t="m"===t?"l":"L");const l=i[a];for(;s.length>=l&&(o.push([t,...s.splice(0,l)]),l););return e})),o}(e);if(!t||!t.length)return[["M",0,0]];let n=0,r=0,i=0,o=0;const s=[];for(let e=0,a=t.length;e<a;e+=1){const a=[];s.push(a);const l=t[e],c=l[0];if(c!==c.toUpperCase())switch(a[0]=c.toUpperCase(),a[0]){case"A":a[1]=l[1],a[2]=l[2],a[3]=l[3],a[4]=l[4],a[5]=l[5],a[6]=+l[6]+n,a[7]=+l[7]+r;break;case"V":a[1]=+l[1]+r;break;case"H":a[1]=+l[1]+n;break;case"M":i=+l[1]+n,o=+l[2]+r;for(let e=1,t=l.length;e<t;e+=1)a[e]=+l[e]+(e%2?n:r);break;default:for(let e=1,t=l.length;e<t;e+=1)a[e]=+l[e]+(e%2?n:r)}else for(let e=0,t=l.length;e<t;e+=1)a[e]=l[e];switch(a[0]){case"Z":n=+i,r=+o;break;case"H":n=a[1];break;case"V":r=a[1];break;case"M":i=a[a.length-2],o=a[a.length-1],n=a[a.length-2],r=a[a.length-1];break;default:n=a[a.length-2],r=a[a.length-1]}}return s}function Wm(e){const t=Hm(e),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function r(e,t,n){let r,i;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(e[0]in{T:1,Q:1}||(t.qx=null,t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":return 0===parseFloat(e[1])||0===parseFloat(e[2])?["L",e[6],e[7]]:["C"].concat(Vm.apply(0,[t.x,t.y].concat(e.slice(1))));case"S":return"C"===n||"S"===n?(r=2*t.x-t.bx,i=2*t.y-t.by):(r=t.x,i=t.y),["C",r,i].concat(e.slice(1));case"T":return"Q"===n||"T"===n?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),["C"].concat(Um(t.x,t.y,t.qx,t.qy,e[1],e[2]));case"Q":return t.qx=e[1],t.qy=e[2],["C"].concat(Um(t.x,t.y,e[1],e[2],e[3],e[4]));case"H":return["L"].concat(e[1],t.y);case"V":return["L"].concat(t.x,e[1])}return e}function i(e,n){if(e[n].length>7){e[n].shift();const r=e[n];for(;r.length;)o[n]="A",n+=1,e.splice(n,0,["C"].concat(r.splice(0,6)));e.splice(n,1),a=t.length}}const o=[];let s="",a=t.length;for(let e=0;e<a;e+=1){let a="";t[e]&&(a=t[e][0]),"C"!==a&&(o[e]=a,e>0&&(s=o[e-1])),t[e]=r(t[e],n,s),"A"!==o[e]&&"C"===a&&(o[e]="C"),i(t,e);const l=t[e],c=l.length;n.x=l[c-2],n.y=l[c-1],n.bx=parseFloat(l[c-4])||n.x,n.by=parseFloat(l[c-3])||n.y}return t[0][0]&&"M"===t[0][0]||t.unshift(["M",0,0]),t}function $m(e){return Wm(e).map((e=>e.map((e=>"string"==typeof e?e:Em(e,2))))).join(",").split(",").join(" ")}!function(e){e.create=function(...t){const n=t.length,r=t[0];if(Im.isCurve(r))return new e(r);if(Tm.isPointLike(r)){if(3===n)return new e(t[0],t[1],t[2]);const r=[];for(let i=0;i<n;i+=3)r.push(new e(t[i],t[i+1],t[i+2]));return r}if(6===n)return new e(t[0],t[1],t[2],t[3],t[4],t[5]);const i=[];for(let r=0;r<n;r+=6)i.push(new e(t[r],t[r+1],t[r+2],t[r+3],t[r+4],t[r+5]));return i}}(Bm||(Bm={}));const Xm=new RegExp("^[\\s\\dLMCZz,.]*$");function Ym(e){return"string"==typeof e&&Xm.test(e)}function qm(e,t){return(e%t+t)%t}function Km(e,t={}){const n=[];return e&&e.length&&e.forEach((e=>{Array.isArray(e)?n.push({x:e[0],y:e[1]}):n.push({x:e.x,y:e.y})})),function(e,t,n,r,i){const o=[],s=e[e.length-1],a=null!=t&&t>0,l=t||0;if(r&&a){const t=(e=e.slice())[0],n=new Tm(s.x+(t.x-s.x)/2,s.y+(t.y-s.y)/2);e.splice(0,0,n)}let c=e[0],u=1;for(n?o.push("M",c.x,c.y):o.push("L",c.x,c.y);u<(r?e.length:e.length-1);){let t=e[qm(u,e.length)],n=c.x-t.x,r=c.y-t.y;if(a&&(0!==n||0!==r)&&(null==i||i.indexOf(u-1)<0)){let i=Math.sqrt(n*n+r*r);const s=n*Math.min(l,i/2)/i,a=r*Math.min(l,i/2)/i,c=t.x+s,h=t.y+a;o.push("L",c,h);let d=e[qm(u+1,e.length)];for(;u<e.length-2&&0===Math.round(d.x-t.x)&&0===Math.round(d.y-t.y);)d=e[qm(u+2,e.length)],u+=1;n=d.x-t.x,r=d.y-t.y,i=Math.max(1,Math.sqrt(n*n+r*r));const f=n*Math.min(l,i/2)/i,p=r*Math.min(l,i/2)/i,g=t.x+f,m=t.y+p;o.push("Q",t.x,t.y,g,m),t=new Tm(g,m)}else o.push("L",t.x,t.y);c=t,u+=1}return r?o.push("Z"):o.push("L",s.x,s.y),o.map((e=>"string"==typeof e?e:+e.toFixed(3))).join(" ")}(n,t.round,null==t.initialMove||t.initialMove,t.close,t.exclude)}function Zm(e,t,n,r,i=0,o=0,s=0,a,l){if(0===n||0===r)return[];a-=e,l-=t,n=Math.abs(n),r=Math.abs(r);const c=-a/2,u=-l/2,h=Math.cos(i*Math.PI/180),d=Math.sin(i*Math.PI/180),f=h*c+d*u,p=-1*d*c+h*u,g=f*f,m=p*p,v=n*n,y=r*r,b=g/v+m/y;let x;if(b>1)n=Math.sqrt(b)*n,r=Math.sqrt(b)*r,x=0;else{let e=1;o===s&&(e=-1),x=e*Math.sqrt((v*y-v*m-y*g)/(v*m+y*g))}const w=x*n*p/r,C=-1*x*r*f/n,E=h*w-d*C+a/2,_=d*w+h*C+l/2;let S=Math.atan2((p-C)/r,(f-w)/n)-Math.atan2(0,1),O=S>=0?S:2*Math.PI+S;S=Math.atan2((-p-C)/r,(-f-w)/n)-Math.atan2((p-C)/r,(f-w)/n);let A=S>=0?S:2*Math.PI+S;0===s&&A>0?A-=2*Math.PI:0!==s&&A<0&&(A+=2*Math.PI);const k=2*A/Math.PI,M=Math.ceil(k<0?-1*k:k),T=A/M,P=8/3*Math.sin(T/4)*Math.sin(T/4)/Math.sin(T/2),D=h*n,N=h*r,R=d*n,I=d*r;let j=Math.cos(O),L=Math.sin(O),F=-P*(D*L+I*j),G=-P*(R*L-N*j),B=0,z=0;const U=[];for(let n=0;n<M;n+=1){O+=T,j=Math.cos(O),L=Math.sin(O),B=D*j-I*L+E,z=R*j+N*L+_;const r=-P*(D*L+I*j),i=-P*(R*L-N*j),o=6*n;U[o]=Number(F+e),U[o+1]=Number(G+t),U[o+2]=Number(B-r+e),U[o+3]=Number(z-i+t),U[o+4]=Number(B+e),U[o+5]=Number(z+t),F=B+r,G=z+i}return U.map((e=>+e.toFixed(2)))}function Jm(e,t,n,r,i=0,o=0,s=0,a,l){const c=[],u=Zm(e,t,n,r,i,o,s,a,l);if(null!=u)for(let e=0,t=u.length;e<t;e+=6)c.push("C",u[e],u[e+1],u[e+2],u[e+3],u[e+4],u[e+5]);return c.join(" ")}class Qm extends Mm{constructor(e){if(super(),this.PRECISION=3,this.segments=[],Array.isArray(e))if(Dm.isLine(e[0])||Im.isCurve(e[0])){let t=null;e.forEach(((e,n)=>{0===n&&this.appendSegment(Qm.createSegment("M",e.start)),null==t||t.end.equals(e.start)||this.appendSegment(Qm.createSegment("M",e.start)),Dm.isLine(e)?this.appendSegment(Qm.createSegment("L",e.end)):Im.isCurve(e)&&this.appendSegment(Qm.createSegment("C",e.controlPoint1,e.controlPoint2,e.end)),t=e}))}else{e.forEach((e=>{e.isSegment&&this.appendSegment(e)}))}else null!=e&&(Dm.isLine(e)?(this.appendSegment(Qm.createSegment("M",e.start)),this.appendSegment(Qm.createSegment("L",e.end))):Im.isCurve(e)?(this.appendSegment(Qm.createSegment("M",e.start)),this.appendSegment(Qm.createSegment("C",e.controlPoint1,e.controlPoint2,e.end))):Rm.isPolyline(e)?e.points&&e.points.length&&e.points.forEach(((e,t)=>{const n=0===t?Qm.createSegment("M",e):Qm.createSegment("L",e);this.appendSegment(n)})):e.isSegment&&this.appendSegment(e))}get[Symbol.toStringTag](){return Qm.toStringTag}get start(){const e=this.segments,t=e.length;if(0===t)return null;for(let n=0;n<t;n+=1){const t=e[n];if(t.isVisible)return t.start}return e[t-1].end}get end(){const e=this.segments,t=e.length;if(0===t)return null;for(let n=t-1;n>=0;n-=1){const t=e[n];if(t.isVisible)return t.end}return e[t-1].end}moveTo(...e){return this.appendSegment(Gm.create.call(null,...e))}lineTo(...e){return this.appendSegment(Lm.create.call(null,...e))}curveTo(...e){return this.appendSegment(Bm.create.call(null,...e))}arcTo(e,t,n,r,i,o,s){const a=this.end||new Tm,l="number"==typeof o?Zm(a.x,a.y,e,t,n,r,i,o,s):Zm(a.x,a.y,e,t,n,r,i,o.x,o.y);if(null!=l)for(let e=0,t=l.length;e<t;e+=6)this.curveTo(l[e],l[e+1],l[e+2],l[e+3],l[e+4],l[e+5]);return this}quadTo(e,t,n,r){const i=this.end||new Tm,o=["M",i.x,i.y];if("number"==typeof e)o.push("Q",e,t,n,r);else{const n=t;o.push("Q",e.x,e.y,n.x,n.y)}const s=Qm.parse(o.join(" "));return this.appendSegment(s.segments.slice(1)),this}close(){return this.appendSegment(Fm.create())}drawPoints(e,t={}){const n=Km(e,t),r=Qm.parse(n);r&&r.segments&&this.appendSegment(r.segments)}bbox(){const e=this.segments,t=e.length;if(0===t)return null;let n;for(let r=0;r<t;r+=1){const t=e[r];if(t.isVisible){const e=t.bbox();null!=e&&(n=n?n.union(e):e)}}if(null!=n)return n;const r=e[t-1];return new Pm(r.end.x,r.end.y,0,0)}appendSegment(e){const t=this.segments.length;let n,r=0!==t?this.segments[t-1]:null;if(Array.isArray(e))for(let t=0,i=e.length;t<i;t+=1){const i=e[t];n=this.prepareSegment(i,r,null),this.segments.push(n),r=n}else null!=e&&e.isSegment&&(n=this.prepareSegment(e,r,null),this.segments.push(n));return this}insertSegment(e,t){const n=this.segments.length;if(e<0&&(e=n+e+1),e>n||e<0)throw new Error("Index out of range.");let r,i=null,o=null;if(0!==n&&(e>=1?(i=this.segments[e-1],o=i.nextSegment):(i=null,o=this.segments[0])),Array.isArray(t))for(let n=0,s=t.length;n<s;n+=1){const s=t[n];r=this.prepareSegment(s,i,o),this.segments.splice(e+n,0,r),i=r}else r=this.prepareSegment(t,i,o),this.segments.splice(e,0,r);return this}removeSegment(e){const t=this.fixIndex(e),n=this.segments.splice(t,1)[0],r=n.previousSegment,i=n.nextSegment;return r&&(r.nextSegment=i),i&&(i.previousSegment=r),n.isSubpathStart&&i&&this.updateSubpathStartSegment(i),n}replaceSegment(e,t){const n=this.fixIndex(e);let r;const i=this.segments[n];let o=i.previousSegment;const s=i.nextSegment;let a=i.isSubpathStart;if(Array.isArray(t)){this.segments.splice(e,1);for(let n=0,i=t.length;n<i;n+=1){const i=t[n];r=this.prepareSegment(i,o,s),this.segments.splice(e+n,0,r),o=r,a&&r.isSubpathStart&&(a=!1)}}else r=this.prepareSegment(t,o,s),this.segments.splice(n,1,r),a&&r.isSubpathStart&&(a=!1);a&&s&&this.updateSubpathStartSegment(s)}getSegment(e){const t=this.fixIndex(e);return this.segments[t]}fixIndex(e){const t=this.segments.length;if(0===t)throw new Error("Path has no segments.");let n=e;for(;n<0;)n=t+n;if(n>=t||n<0)throw new Error("Index out of range.");return n}segmentAt(e,t={}){const n=this.segmentIndexAt(e,t);return n?this.getSegment(n):null}segmentAtLength(e,t={}){const n=this.segmentIndexAtLength(e,t);return n?this.getSegment(n):null}segmentIndexAt(e,t={}){if(0===this.segments.length)return null;const n=Sm(e,0,1),r=this.getOptions(t),i=this.length(r)*n;return this.segmentIndexAtLength(i,r)}segmentIndexAtLength(e,t={}){const n=this.segments.length;if(0===n)return null;let r=!0;e<0&&(r=!1,e=-e);const i=this.getPrecision(t),o=this.getSubdivisions(t);let s=0,a=null;for(let t=0;t<n;t+=1){const l=r?t:n-1-t,c=this.segments[l],u=o[l],h=c.length({precision:i,subdivisions:u});if(c.isVisible){if(e<=s+h)return l;a=l}s+=h}return a}getSegmentSubdivisions(e={}){const t=this.getPrecision(e),n=[];for(let e=0,r=this.segments.length;e<r;e+=1){const r=this.segments[e].getSubdivisions({precision:t});n.push(r)}return n}updateSubpathStartSegment(e){let t=e.previousSegment,n=e;for(;n&&!n.isSubpathStart;)n.subpathStartSegment=null!=t?t.subpathStartSegment:null,t=n,n=n.nextSegment}prepareSegment(e,t,n){e.previousSegment=t,e.nextSegment=n,null!=t&&(t.nextSegment=e),null!=n&&(n.previousSegment=e);let r=e;return e.isSubpathStart&&(e.subpathStartSegment=e,r=n),null!=r&&this.updateSubpathStartSegment(r),e}closestPoint(e,t={}){const n=this.closestPointT(e,t);return n?this.pointAtT(n):null}closestPointLength(e,t={}){const n=this.getOptions(t),r=this.closestPointT(e,n);return r?this.lengthAtT(r,n):0}closestPointNormalizedLength(e,t={}){const n=this.getOptions(t),r=this.closestPointLength(e,n);if(0===r)return 0;const i=this.length(n);return 0===i?0:r/i}closestPointT(e,t={}){if(0===this.segments.length)return null;const n=this.getPrecision(t),r=this.getSubdivisions(t);let i,o=1/0;for(let t=0,s=this.segments.length;t<s;t+=1){const s=this.segments[t],a=r[t];if(s.isVisible){const r=s.closestPointT(e,{precision:n,subdivisions:a}),l=km(s.pointAtT(r),e);l<o&&(i={segmentIndex:t,value:r},o=l)}}return i||{segmentIndex:this.segments.length-1,value:1}}closestPointTangent(e,t={}){if(0===this.segments.length)return null;const n=this.getPrecision(t),r=this.getSubdivisions(t);let i,o=1/0;for(let t=0,s=this.segments.length;t<s;t+=1){const s=this.segments[t],a=r[t];if(s.isDifferentiable()){const t=s.closestPointT(e,{precision:n,subdivisions:a}),r=km(s.pointAtT(t),e);r<o&&(i=s.tangentAtT(t),o=r)}}return i||null}containsPoint(e,t={}){const n=this.toPolylines(t);if(!n)return!1;let r=0;for(let t=0,i=n.length;t<i;t+=1){n[t].containsPoint(e)&&(r+=1)}return r%2==1}pointAt(e,t={}){if(0===this.segments.length)return null;if(e<=0)return this.start.clone();if(e>=1)return this.end.clone();const n=this.getOptions(t),r=this.length(n)*e;return this.pointAtLength(r,n)}pointAtLength(e,t={}){if(0===this.segments.length)return null;if(0===e)return this.start.clone();let n=!0;e<0&&(n=!1,e=-e);const r=this.getPrecision(t),i=this.getSubdivisions(t);let o,s=0;for(let t=0,a=this.segments.length;t<a;t+=1){const l=n?t:a-1-t,c=this.segments[l],u=i[l],h=c.length({precision:r,subdivisions:u});if(c.isVisible){if(e<=s+h)return c.pointAtLength((n?1:-1)*(e-s),{precision:r,subdivisions:u});o=c}s+=h}if(o)return n?o.end:o.start;return this.segments[this.segments.length-1].end.clone()}pointAtT(e){const t=this.segments,n=t.length;if(0===n)return null;const r=e.segmentIndex;if(r<0)return t[0].pointAtT(0);if(r>=n)return t[n-1].pointAtT(1);const i=Sm(e.value,0,1);return t[r].pointAtT(i)}divideAt(e,t={}){if(0===this.segments.length)return null;const n=Sm(e,0,1),r=this.getOptions(t),i=this.length(r)*n;return this.divideAtLength(i,r)}divideAtLength(e,t={}){if(0===this.segments.length)return null;let n=!0;e<0&&(n=!1,e=-e);const r=this.getPrecision(t),i=this.getSubdivisions(t);let o,s,a,l,c,u=0;for(let t=0,c=this.segments.length;t<c;t+=1){const h=n?t:c-1-t,d=this.getSegment(h),f={precision:r,subdivisions:i[h]},p=d.length(f);if(d.isDifferentiable()&&(a=d,l=h,e<=u+p)){s=h,o=d.divideAtLength((n?1:-1)*(e-u),f);break}u+=p}if(!a)return null;o||(s=l,c=n?1:0,o=a.divideAtT(c));const h=this.clone(),d=s;h.replaceSegment(d,o);const f=d;let p=d+1,g=d+2;o[0].isDifferentiable()||(h.removeSegment(f),p-=1,g-=1);const m=h.getSegment(p).start;h.insertSegment(p,Qm.createSegment("M",m)),g+=1,o[1].isDifferentiable()||(h.removeSegment(g-1),g-=1);const v=g-f-1;for(let e=g,t=h.segments.length;e<t;e+=1){const t=this.getSegment(e-v),n=h.getSegment(e);if("Z"===n.type&&!t.subpathStartSegment.end.equals(n.subpathStartSegment.end)){const n=Qm.createSegment("L",t.end);h.replaceSegment(e,n)}}return[new Qm(h.segments.slice(0,p)),new Qm(h.segments.slice(p))]}intersectsWithLine(e,t={}){const n=this.toPolylines(t);if(null==n)return null;let r=null;for(let t=0,i=n.length;t<i;t+=1){const i=n[t],o=e.intersect(i);o&&(null==r&&(r=[]),Array.isArray(o)?r.push(...o):r.push(o))}return r}isDifferentiable(){for(let e=0,t=this.segments.length;e<t;e+=1){if(this.segments[e].isDifferentiable())return!0}return!1}isValid(){const e=this.segments;return 0===e.length||"M"===e[0].type}length(e={}){if(0===this.segments.length)return 0;const t=this.getSubdivisions(e);let n=0;for(let e=0,r=this.segments.length;e<r;e+=1){const r=this.segments[e],i=t[e];n+=r.length({subdivisions:i})}return n}lengthAtT(e,t={}){const n=this.segments.length;if(0===n)return 0;let r=e.segmentIndex;if(r<0)return 0;let i=Sm(e.value,0,1);r>=n&&(r=n-1,i=1);const o=this.getPrecision(t),s=this.getSubdivisions(t);let a=0;for(let e=0;e<r;e+=1){const t=this.segments[e],n=s[e];a+=t.length({precision:o,subdivisions:n})}const l=this.segments[r],c=s[r];return a+=l.lengthAtT(i,{precision:o,subdivisions:c}),a}tangentAt(e,t={}){if(0===this.segments.length)return null;const n=Sm(e,0,1),r=this.getOptions(t),i=this.length(r)*n;return this.tangentAtLength(i,r)}tangentAtLength(e,t={}){if(0===this.segments.length)return null;let n=!0;e<0&&(n=!1,e=-e);const r=this.getPrecision(t),i=this.getSubdivisions(t);let o,s=0;for(let t=0,a=this.segments.length;t<a;t+=1){const l=n?t:a-1-t,c=this.segments[l],u=i[l],h=c.length({precision:r,subdivisions:u});if(c.isDifferentiable()){if(e<=s+h)return c.tangentAtLength((n?1:-1)*(e-s),{precision:r,subdivisions:u});o=c}s+=h}if(o){const e=n?1:0;return o.tangentAtT(e)}return null}tangentAtT(e){const t=this.segments.length;if(0===t)return null;const n=e.segmentIndex;if(n<0)return this.segments[0].tangentAtT(0);if(n>=t)return this.segments[t-1].tangentAtT(1);const r=Sm(e.value,0,1);return this.segments[n].tangentAtT(r)}getPrecision(e={}){return null==e.precision?this.PRECISION:e.precision}getSubdivisions(e={}){if(null==e.segmentSubdivisions){const t=this.getPrecision(e);return this.getSegmentSubdivisions({precision:t})}return e.segmentSubdivisions}getOptions(e={}){return{precision:this.getPrecision(e),segmentSubdivisions:this.getSubdivisions(e)}}toPoints(e={}){const t=this.segments,n=t.length;if(0===n)return null;const r=this.getSubdivisions(e),i=[];let o=[];for(let e=0;e<n;e+=1){const n=t[e];if(n.isVisible){const t=r[e];t.length>0?t.forEach((e=>o.push(e.start))):o.push(n.start)}else o.length>0&&(o.push(t[e-1].end),i.push(o),o=[])}return o.length>0&&(o.push(this.end),i.push(o)),i}toPolylines(e={}){const t=this.toPoints(e);return t?t.map((e=>new Rm(e))):null}scale(e,t,n){return this.segments.forEach((r=>r.scale(e,t,n))),this}rotate(e,t){return this.segments.forEach((n=>n.rotate(e,t))),this}translate(e,t){return"number"==typeof e?this.segments.forEach((n=>n.translate(e,t))):this.segments.forEach((t=>t.translate(e))),this}clone(){const e=new Qm;return this.segments.forEach((t=>e.appendSegment(t.clone()))),e}equals(e){if(null==e)return!1;const t=this.segments,n=e.segments,r=t.length;if(n.length!==r)return!1;for(let e=0;e<r;e+=1){const r=t[e],i=n[e];if(r.type!==i.type||!r.equals(i))return!1}return!0}toJSON(){return this.segments.map((e=>e.toJSON()))}serialize(){if(!this.isValid())throw new Error("Invalid path segments.");return this.segments.map((e=>e.serialize())).join(" ")}toString(){return this.serialize()}}!function(e){e.toStringTag=`X6.Geometry.${e.name}`,e.isPath=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return!(null!=n&&n!==e.toStringTag||!Array.isArray(r.segments)||"function"!=typeof r.moveTo||"function"!=typeof r.lineTo||"function"!=typeof r.curveTo)}}(Qm||(Qm={})),function(e){function t(e,...t){if("M"===e)return Gm.create.call(null,...t);if("L"===e)return Lm.create.call(null,...t);if("C"===e)return Bm.create.call(null,...t);if("z"===e||"Z"===e)return Fm.create();throw new Error(`Invalid path segment type "${e}"`)}e.parse=function(n){if(!n)return new e;const r=new e,i=e.normalize(n).match(/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g);if(null!=i)for(let e=0,n=i.length;e<n;e+=1){const n=/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g,o=i[e].match(n);if(null!=o){const e=o[0],n=o.slice(1).map((e=>+e)),i=t.call(null,e,...n);r.appendSegment(i)}}return r},e.createSegment=t}(Qm||(Qm={})),function(e){e.normalize=$m,e.isValid=Ym,e.drawArc=Jm,e.drawPoints=Km,e.arcToCurves=Zm}(Qm||(Qm={}));class ev{constructor(e,t,n){if(!e)throw new TypeError("Invalid element to create vector");let r;if(ev.isVector(e))r=e.node;else if("string"==typeof e)if("svg"===e.toLowerCase())r=Yg();else if("<"===e[0]){const t=Yg(e);r=document.importNode(t.firstChild,!0)}else r=document.createElementNS(Hg.svg,e);else r=e;this.node=r,t&&this.setAttributes(t),n&&this.append(n)}get[Symbol.toStringTag](){return ev.toStringTag}get type(){return this.node.nodeName}get id(){return this.node.id}set id(e){this.node.id=e}transform(e,t){return null==e?Tv(this.node):(Tv(this.node,e,t),this)}translate(e,t=0,n={}){return null==e?Pv(this.node):(Pv(this.node,e,t,n),this)}rotate(e,t,n,r={}){return null==e?Dv(this.node):(Dv(this.node,e,t,n,r),this)}scale(e,t){return null==e?Nv(this.node):(Nv(this.node,e,t),this)}getTransformToElement(e){const t=ev.toNode(e);return Ov(this.node,t)}removeAttribute(e){return om(this.node,e),this}getAttribute(e){return function(e,t){return e.getAttribute(t)}(this.node,e)}setAttribute(e,t){return sm(this.node,e,t),this}setAttributes(e){return am(this.node,e),this}attr(e,t){return null==e?lm(this.node):"string"==typeof e&&void 0===t?lm(this.node,e):("object"==typeof e?lm(this.node,e):lm(this.node,e,t),this)}svg(){return this.node instanceof SVGSVGElement?this:ev.create(this.node.ownerSVGElement)}defs(){const e=this.svg()||this,t=e.node.getElementsByTagName("defs")[0];return t?ev.create(t):ev.create("defs").appendTo(e)}text(e,t={}){return iv(this.node,e,t),this}tagName(){return function(e,t=!0){const n=e.nodeName;return t?n.toLowerCase():n.toUpperCase()}(this.node)}clone(){return ev.create(this.node.cloneNode(!0))}remove(){return em(this.node),this}empty(){return tm(this.node),this}append(e){return nm(this.node,ev.toNodes(e)),this}appendTo(e){return function(e,t){null!=t&&t.appendChild(e)}(this.node,ev.isVector(e)?e.node:e),this}prepend(e){return function(e,t){const n=e.firstChild;n?rm(n,t):nm(e,t)}(this.node,ev.toNodes(e)),this}before(e){return rm(this.node,ev.toNodes(e)),this}replace(e){return this.node.parentNode&&this.node.parentNode.replaceChild(ev.toNode(e),this.node),ev.create(e)}first(){return this.node.firstChild?ev.create(this.node.firstChild):null}last(){return this.node.lastChild?ev.create(this.node.lastChild):null}get(e){const t=this.node.childNodes[e];return t?ev.create(t):null}indexOf(e){return Array.prototype.slice.call(this.node.childNodes).indexOf(ev.toNode(e))}find(e){const t=[],n=function(e,t){return e.querySelectorAll(t)}(this.node,e);if(n)for(let e=0,r=n.length;e<r;e+=1)t.push(ev.create(n[e]));return t}findOne(e){const t=Zg(this.node,e);return t?ev.create(t):null}findParentByClass(e,t){const n=Jg(this.node,e,t);return n?ev.create(n):null}matches(e){const t=this.node;this.node.matches;const n=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector||null;return n&&n.call(t,e)}contains(e){return Qg(this.node,ev.isVector(e)?e.node:e)}wrap(e){const t=ev.create(e),n=this.node.parentNode;return null!=n&&n.insertBefore(t.node,this.node),t.append(this)}parent(e){let t=this;if(null==t.node.parentNode)return null;if(t=ev.create(t.node.parentNode),null==e)return t;do{if("string"==typeof e?t.matches(e):t instanceof e)return t}while(t=ev.create(t.node.parentNode));return t}children(){const e=this.node.childNodes,t=[];for(let n=0;n<e.length;n+=1){1===e[n].nodeType&&t.push(ev.create(e[n]))}return t}eachChild(e,t){const n=this.children();for(let r=0,i=n.length;r<i;r+=1)e.call(n[r],n[r],r,n),t&&n[r].eachChild(e,t);return this}index(){return Kg(this.node)}hasClass(e){return Lg(this.node,e)}addClass(e){return Fg(this.node,e),this}removeClass(e){return Gg(this.node,e),this}toggleClass(e,t){return Bg(this.node,e,t),this}toLocalPoint(e,t){return function(e,t,n){const r=e instanceof SVGSVGElement?e:e.ownerSVGElement,i=r.createSVGPoint();i.x=t,i.y=n;try{const t=r.getScreenCTM(),n=i.matrixTransform(t.inverse()),o=Ov(e,r).inverse();return n.matrixTransform(o)}catch(e){return i}}(this.node,e,t)}toGeometryShape(){return Av(this.node)}translateCenterToPoint(e){const t=this.getBBox({target:this.svg()}).getCenter();return this.translate(e.x-t.x,e.y-t.y),this}translateAndAutoOrient(e,t,n){return Rv(this.node,e,t,n),this}animate(e){return function(e,t){return kv(e,t,"animate")}(this.node,e)}animateTransform(e){return function(e,t){return kv(e,t,"animateTransform")}(this.node,e)}animateAlongPath(e,t){return function(e,t,n){const r=Ug(n),i=Xg("animateMotion"),o=Xg("mpath");lm(o,{"xlink:href":`#${r}`}),i.appendChild(o),e.appendChild(i);try{return Mv(i,t)}catch(e){if("fake"===document.documentElement.getAttribute("smiling")){const e=i;e.animators=[];const t=window,n=e.getAttribute("id");n&&(t.id2anim[n]=e);const r=t.getTargets(e);for(let n=0,i=r.length;n<i;n+=1){const i=r[n],o=new t.Animator(e,i,n);t.animators.push(o),e.animators[n]=o,o.register()}}}return()=>{}}(this.node,e,t)}normalizePath(){return"path"===this.tagName()&&this.attr("d",Qm.normalize(this.attr("d"))),this}bbox(e,t){return function(e,t,n){let r;const i=e.ownerSVGElement;if(!i)return new Pm(0,0,0,0);try{r=e.getBBox()}catch(t){r={x:e.clientLeft,y:e.clientTop,width:e.clientWidth,height:e.clientHeight}}if(t)return Pm.create(r);const o=Ov(e,n||i);return Ev(r,o)}(this.node,e,t)}getBBox(e={}){return Sv(this.node,{recursive:e.recursive,target:e.target?ev.toNode(e.target):null})}sample(e=1){return this.node instanceof SVGPathElement?function(e,t=1){const n=e.getTotalLength(),r=[];let i,o=0;for(;o<n;)i=e.getPointAtLength(o),r.push({distance:o,x:i.x,y:i.y}),o+=t;return r}(this.node,e):[]}toPath(){return ev.create(function(e){const t=Xg("path");lm(t,lm(e));const n=hv(e);n&&t.setAttribute("d",n);return t}(this.node))}toPathData(){return hv(this.node)}}function tv(e,t,n){const r=n.eol,i=n.baseSize,o=n.lineHeight;let s,a=0;const l={},c=t.length-1;for(let o=0;o<=c;o+=1){let l=t[o],u=null;if("object"==typeof l){const e=l.attrs,t=ev.create("tspan",e);s=t.node;let h=l.t;r&&o===c&&(h+=r),s.textContent=h;const d=e.class;d&&t.addClass(d),n.includeAnnotationIndices&&t.attr("annotations",l.annotations.join(",")),u=parseFloat(e["font-size"]),void 0===u&&(u=i),u&&u>a&&(a=u)}else r&&o===c&&(l+=r),s=document.createTextNode(l||" "),i&&i>a&&(a=i);e.appendChild(s)}return a&&(l.maxFontSize=a),o?l.lineHeight=o:a&&(l.lineHeight=1.2*a),l}!function(e){function t(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&r.node instanceof SVGElement&&"function"==typeof r.animate&&"function"==typeof r.sample&&"function"==typeof r.normalizePath&&"function"==typeof r.toPath}function n(t,n,r){return new e(t,n,r)}function r(e){return t(e)?e.node:e}e.toStringTag=`X6.${e.name}`,e.isVector=t,e.create=n,e.createVectors=function(e){if("<"===e[0]){const t=Yg(e),r=[];for(let e=0,i=t.childNodes.length;e<i;e+=1){const i=t.childNodes[e];r.push(n(document.importNode(i,!0)))}return r}return[n(e)]},e.toNode=r,e.toNodes=function(e){return Array.isArray(e)?e.map((e=>r(e))):[r(e)]}}(ev||(ev={}));const nv=/em$/;function rv(e,t){const n=parseFloat(e);return nv.test(e)?n*t:n}function iv(e,t,n={}){t=function(e){return e.replace(/ /g," ")}(t);const r=n.eol;let i=n.textPath;const o=n.textVerticalAnchor,s="middle"===o||"bottom"===o||"top"===o;let a=n.x;void 0===a&&(a=e.getAttribute("x")||0);const l=n.includeAnnotationIndices;let c=n.annotations;c&&!Array.isArray(c)&&(c=[c]);const u=n.lineHeight,h="auto"===u,d=h?"1.5em":u||"1em";tm(e),lm(e,{"xml:space":"preserve",display:t||n.displayEmpty?null:"none"});const f=lm(e,"font-size");let p,g,m=parseFloat(f);m||(m=16,!s&&!c||f||lm(e,"font-size",`${m}`)),i?("string"==typeof i&&(i={d:i}),p=function(e,t){const n=ev.create(t),r=ev.create("textPath"),i=e.d;if(i&&void 0===e["xlink:href"]){const e=ev.create("path").attr("d",i).appendTo(n.defs());r.attr("xlink:href",`#${e.id}`)}return"object"==typeof e&&r.attr(e),r.node}(i,e)):p=document.createDocumentFragment();let v,y=0;const b=t.split("\n"),x=[],w=b.length-1;for(let e=0;e<=w;e+=1){g=d;let t="v-line";const n=Xg("tspan");let o,s=b[e];if(s)if(c){o=tv(n,fm(s,c,{offset:-y,includeAnnotationIndices:l}),{eol:e!==w&&r,baseSize:m,lineHeight:h?null:d,includeAnnotationIndices:l});const t=o.lineHeight;t&&h&&0!==e&&(g=t),0===e&&(v=.8*o.maxFontSize)}else r&&e!==w&&(s+=r),n.textContent=s;else{n.textContent="-",t+=" v-empty-line";const e=n.style;e.fillOpacity=0,e.strokeOpacity=0,c&&(o={})}o&&x.push(o),e>0&&n.setAttribute("dy",g),(e>0||i)&&n.setAttribute("x",a),n.className.baseVal=t,p.appendChild(n),y+=s.length+1}if(s)if(c)g=function(e,t,n,r){if(!Array.isArray(t))return 0;const i=t.length;if(!i)return 0;let o=t[0];const s=rv(o.maxFontSize,n)||n;let a=0;const l=rv(r,n);for(let e=1;e<i;e+=1)o=t[e],a+=rv(o.lineHeight,n)||l;const c=rv(o.maxFontSize,n)||n;let u;switch(e){case"middle":u=s/2-.15*c-a/2;break;case"bottom":u=-.25*c-a;break;default:u=.8*s}return u}(o,x,m,d);else if("top"===o)g="0.8em";else{let e;switch(w>0?(e=parseFloat(d)||1,e*=w,nv.test(d)||(e/=m)):e=0,o){case"middle":g=.3-e/2+"em";break;case"bottom":g=-e-.3+"em"}}else 0===o?g="0em":o?g=o:(g=0,null==e.getAttribute("y")&&e.setAttribute("y",`${v||"0.8em"}`));p.firstChild.setAttribute("dy",g),e.appendChild(p)}function ov(e,t,n={},r={}){const i=t.width,o=t.height,s=r.svgDocument||Xg("svg"),a=Xg("text"),l=Xg("tspan"),c=document.createTextNode("");lm(a,n),a.appendChild(l),a.style.opacity="0",a.style.display="block",l.style.display="block",l.appendChild(c),s.appendChild(a);const u=null==s.parentNode;u&&document.body.appendChild(s);const h=r.eol||"\n",d=r.separator||" ",f=r.hyphen?new RegExp(r.hyphen):/[^\w\d]/,p=!1!==r.breakWord,g=[],m={};let v,y,b,x=[];const{words:w,separators:C}=function(e,t,n,r){const i=[],o=[];if(null!=t){const n=e.split(t);if(i.push(...n),"string"==typeof t)for(let e=0,r=n.length-1;e<r;e+=1)o.push(t);else{const r=e.match(new RegExp(t,"g"));for(let e=0,t=n.length-1;e<t;e+=1)o.push(r?r[e]:"")}}else{let t="";for(let n=0,r=e.length;n<r;n+=1){const r=e[n];" "===r?(i.push(t),o.push(" "),t=""):r.match(/[^\x00-\xff]/)?(t.length&&(i.push(t),o.push("")),i.push(r),o.push(""),t=""):t+=r}t.length&&i.push(t)}for(let e=0;e<i.length;e+=1){const t=i[e];if(t.indexOf(n)>=0&&t.length>1){const r=t.split(n);for(let e=0,t=r.length-1;e<t;e+=1)r.splice(2*e+1,0,n);const s=r.filter((e=>""!==e));i.splice(e,1,...s);const a=s.map((()=>""));a.pop(),o.splice(e,0,...a)}}for(let e=0;e<i.length;e+=1){const t=i[e],n=t.search(r);n>0&&n<t.length-1&&(i.splice(e,1,t.substring(0,n+1),t.substring(n+1)),o.splice(e,0,""))}return{words:i,separators:o}}(e,r.separator,h,f);for(let e=0,t=0,s=w.length;e<s;e+=1){const u=w[e];if(u)if(u!==h){if(null!=x[t]?(b=C[e-1]||"",c.data=`${x[t]}${b}${u}`):c.data=u,l.getComputedTextLength()<=i)x[t]=c.data,m[t]=C[e],v&&(g[t]=!0,t+=1,v=0);else{if(p){if(!x[t]||v){const n=!!v,r=1===u.length;if(v=u.length-1,n||r){if(r){if(!x[t]){x=[];break}w.splice(e,2,u+w[e+1]),C.splice(e+1,1),g[t]=!0,t+=1,s-=1,e-=1;continue}w[e]=u.substring(0,v),w[e+1]=u.substring(v)+w[e+1]}else w.splice(e,1,u.substring(0,v),u.substring(v)),C.splice(e,0,""),s+=1,t&&!g[t-1]&&(t-=1);e-=1;continue}}else if(!x[t]){x[t]=u,g[t]=!0,t+=1;continue}t+=1,e-=1}if(null!=o){if(null==y){let e;e="auto"===n.lineHeight?{value:1.5,unit:"em"}:Ag(n.lineHeight,["em"])||{value:1,unit:"em"},y=e.value,"em"===e.unit&&(gr.IS_FIREFOX?y*=l.getBBox().height:y*=a.getBBox().height)}if(y*x.length>o){const e=Math.floor(o/y)-1,t=x[e],n=x[e+1];if(x.splice(e+1),null==t)break;let s=r.ellipsis;if(!s)break;"string"!=typeof s&&(s="…");let a=t;n&&p&&(a+=b+n);let u,h,f=a.length;do{if(h=a[f],u=a.substring(0,f),h?h.match(d)&&(u+=h):u+=m[e],u+=s,c.data=u,l.getComputedTextLength()<=i){x[e]=u;break}f-=1}while(f>=0);break}}}else g[t]=!0,t+=1,x[t]=""}return em(u?s:a),x.join(h)}const sv=.551784;function av(e,t,n=NaN){const r=e.getAttribute(t);if(null==r)return n;const i=parseFloat(r);return Number.isNaN(i)?n:i}function lv(e){const t=e.map((e=>`${e.x} ${e.y}`));return`M ${t.join(" L")}`}function cv(e){const t=[],n=e.points;if(n)for(let e=0,r=n.numberOfItems;e<r;e+=1)t.push(n.getItem(e));return t}function uv(e){let t;const n=e.x,r=e.y,i=e.width,o=e.height,s=Math.min(e.rx||e["top-rx"]||0,i/2),a=Math.min(e.rx||e["bottom-rx"]||0,i/2),l=Math.min(e.ry||e["top-ry"]||0,o/2),c=Math.min(e.ry||e["bottom-ry"]||0,o/2);return t=s||a||l||c?["M",n,r+l,"v",o-l-c,"a",a,c,0,0,0,a,c,"h",i-2*a,"a",a,c,0,0,0,a,-c,"v",-(o-c-l),"a",s,l,0,0,0,-s,-l,"h",-(i-2*s),"a",s,l,0,0,0,-s,l,"Z"]:["M",n,r,"H",n+i,"V",r+o,"H",n,"V",r,"Z"],t.join(" ")}function hv(e){const t=e.tagName.toLowerCase();switch(t){case"path":return e.getAttribute("d");case"line":return function(e){return["M",av(e,"x1"),av(e,"y1"),"L",av(e,"x2"),av(e,"y2")].join(" ")}(e);case"polygon":return function(e){const t=cv(e);return 0===t.length?null:`${lv(t)} Z`}(e);case"polyline":return function(e){const t=cv(e);return 0===t.length?null:lv(t)}(e);case"ellipse":return function(e){const t=av(e,"cx",0),n=av(e,"cy",0),r=av(e,"rx"),i=av(e,"ry")||r,o=r*sv,s=i*sv;return["M",t,n-i,"C",t+o,n-i,t+r,n-s,t+r,n,"C",t+r,n+s,t+o,n+i,t,n+i,"C",t-o,n+i,t-r,n+s,t-r,n,"C",t-r,n-s,t-o,n-i,t,n-i,"Z"].join(" ")}(e);case"circle":return function(e){const t=av(e,"cx",0),n=av(e,"cy",0),r=av(e,"r"),i=r*sv;return["M",t,n-r,"C",t+i,n-r,t+r,n-i,t+r,n,"C",t+r,n+i,t+i,n+r,t,n+r,"C",t-i,n+r,t-r,n+i,t-r,n,"C",t-r,n-i,t-i,n-r,t,n-r,"Z"].join(" ")}(e);case"rect":return function(e){return uv({x:av(e,"x",0),y:av(e,"y",0),width:av(e,"width",0),height:av(e,"height",0),rx:av(e,"rx",0),ry:av(e,"ry",0)})}(e)}throw new Error(`"${t}" cannot be converted to svg path element.`)}const dv=Xg("svg"),fv=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,pv=/[ ,]+/,gv=/^(\w+)\((.*)\)/;function mv(e){const t=dv.createSVGMatrix();if(null!=e){const n=e,r=t;for(const e in n)r[e]=n[e]}return t}function vv(e){return null!=e?(e instanceof DOMMatrix||(e=mv(e)),dv.createSVGTransformFromMatrix(e)):dv.createSVGTransform()}function yv(e){let t=mv();const n=null!=e&&e.match(fv);if(!n)return t;for(let e=0,r=n.length;e<r;e+=1){const r=n[e].match(gv);if(r){let e,n,i,o,s,a=mv();const l=r[2].split(pv);switch(r[1].toLowerCase()){case"scale":e=parseFloat(l[0]),n=void 0===l[1]?e:parseFloat(l[1]),a=a.scaleNonUniform(e,n);break;case"translate":i=parseFloat(l[0]),o=parseFloat(l[1]),a=a.translate(i,o);break;case"rotate":s=parseFloat(l[0]),i=parseFloat(l[1])||0,o=parseFloat(l[2])||0,a=0!==i||0!==o?a.translate(i,o).rotate(s).translate(-i,-o):a.rotate(s);break;case"skewx":s=parseFloat(l[0]),a=a.skewX(s);break;case"skewy":s=parseFloat(l[0]),a=a.skewY(s);break;case"matrix":a.a=parseFloat(l[0]),a.b=parseFloat(l[1]),a.c=parseFloat(l[2]),a.d=parseFloat(l[3]),a.e=parseFloat(l[4]),a.f=parseFloat(l[5]);break;default:continue}t=t.multiply(a)}}return t}function bv(e){const t=e||{};return`matrix(${null!=t.a?t.a:1},${null!=t.b?t.b:0},${null!=t.c?t.c:0},${null!=t.d?t.d:1},${null!=t.e?t.e:0},${null!=t.f?t.f:0})`}function xv(e){let t,n,r;if(e){const i=pv;if(e.trim().indexOf("matrix")>=0){const i=function(e){const t=wv(e,{x:0,y:1}),n=wv(e,{x:1,y:0}),r=180/Math.PI*Math.atan2(t.y,t.x)-90,i=180/Math.PI*Math.atan2(n.y,n.x);return{skewX:r,skewY:i,translateX:e.e,translateY:e.f,scaleX:Math.sqrt(e.a*e.a+e.b*e.b),scaleY:Math.sqrt(e.c*e.c+e.d*e.d),rotation:r}}(yv(e));t=[i.translateX,i.translateY],n=[i.rotation],r=[i.scaleX,i.scaleY];const o=[];0===t[0]&&0===t[1]||o.push(`translate(${t.join(",")})`),1===r[0]&&1===r[1]||o.push(`scale(${r.join(",")})`),0!==n[0]&&o.push(`rotate(${n[0]})`),e=o.join(" ")}else{const o=e.match(/translate\((.*?)\)/);o&&(t=o[1].split(i));const s=e.match(/rotate\((.*?)\)/);s&&(n=s[1].split(i));const a=e.match(/scale\((.*?)\)/);a&&(r=a[1].split(i))}}const i=r&&r[0]?parseFloat(r[0]):1;return{raw:e||"",translation:{tx:t&&t[0]?parseInt(t[0],10):0,ty:t&&t[1]?parseInt(t[1],10):0},rotation:{angle:n&&n[0]?parseInt(n[0],10):0,cx:n&&n[1]?parseInt(n[1],10):void 0,cy:n&&n[2]?parseInt(n[2],10):void 0},scale:{sx:i,sy:r&&r[1]?parseFloat(r[1]):i}}}function wv(e,t){return{x:t.x*e.a+t.y*e.c+0,y:t.x*e.b+t.y*e.d+0}}function Cv(e,t){const n=function(e,t){const n=dv.createSVGPoint();return n.x=e,n.y=t,n}(e.x,e.y).matrixTransform(t);return new Tm(n.x,n.y)}function Ev(e,t){const n=dv.createSVGPoint();n.x=e.x,n.y=e.y;const r=n.matrixTransform(t);n.x=e.x+e.width,n.y=e.y;const i=n.matrixTransform(t);n.x=e.x+e.width,n.y=e.y+e.height;const o=n.matrixTransform(t);n.x=e.x,n.y=e.y+e.height;const s=n.matrixTransform(t),a=Math.min(r.x,i.x,o.x,s.x),l=Math.max(r.x,i.x,o.x,s.x),c=Math.min(r.y,i.y,o.y,s.y),u=Math.max(r.y,i.y,o.y,s.y);return new Pm(a,c,l-a,u-c)}var _v=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Sv(e,t={}){let n;if(!e.ownerSVGElement||!Vg(e)){if(im(e)){const{left:t,top:n,width:r,height:i}=function(e){let t=0,n=0,r=0,i=0;if(e){let o=e;for(;o;)t+=o.offsetLeft,n+=o.offsetTop,o=o.offsetParent,o&&(t+=parseInt(wm(o,"borderLeft"),10),n+=parseInt(wm(o,"borderTop"),10));r=e.offsetWidth,i=e.offsetHeight}return{left:t,top:n,width:r,height:i}}(e);return new Pm(t,n,r,i)}return new Pm(0,0,0,0)}let r=t.target;if(!t.recursive){try{n=e.getBBox()}catch(t){n={x:e.clientLeft,y:e.clientTop,width:e.clientWidth,height:e.clientHeight}}if(!r)return Pm.create(n);return Ev(n,Ov(e,r))}{const t=e.childNodes,i=t.length;if(0===i)return Sv(e,{target:r});r||(r=e);for(let e=0;e<i;e+=1){const i=t[e];let o;o=0===i.childNodes.length?Sv(i,{target:r}):Sv(i,{target:r,recursive:!0}),n=n?n.union(o):o}return n}}function Ov(e,t){if(Vg(t)&&Vg(e)){const n=t.getScreenCTM(),r=e.getScreenCTM();if(n&&r)return n.inverse().multiply(r)}return mv()}function Av(e){const t=t=>{const n=e.getAttribute(t),r=n?parseFloat(n):0;return Number.isNaN(r)?0:r};switch(e instanceof SVGElement&&e.nodeName.toLowerCase()){case"rect":return new Pm(t("x"),t("y"),t("width"),t("height"));case"circle":return new Nm(t("cx"),t("cy"),t("r"),t("r"));case"ellipse":return new Nm(t("cx"),t("cy"),t("rx"),t("ry"));case"polyline":{const t=cv(e);return new Rm(t)}case"polygon":{const t=cv(e);return t.length>1&&t.push(t[0]),new Rm(t)}case"path":{let t=e.getAttribute("d");return Qm.isValid(t)||(t=Qm.normalize(t)),Qm.parse(t)}case"line":return new Dm(t("x1"),t("y1"),t("x2"),t("y2"))}return Sv(e)}function kv(e,t,n){const r=Xg(n);e.appendChild(r);try{return Mv(r,t)}catch(e){}return()=>{}}function Mv(e,t){const{start:n,complete:r,repeat:i}=t;lm(e,_v(t,["start","complete","repeat"])),n&&e.addEventListener("beginEvent",n),r&&e.addEventListener("endEvent",r),i&&e.addEventListener("repeatEvent",i);const o=e;return o.beginElement(),()=>o.endElement()}function Tv(e,t,n={}){if(null==t)return yv(lm(e,"transform"));if(n.absolute)return void e.setAttribute("transform",bv(t));const r=e.transform,i=vv(t);r.baseVal.appendItem(i)}function Pv(e,t,n=0,r={}){let i=lm(e,"transform");const o=xv(i);if(null==t)return o.translation;i=o.raw,i=i.replace(/translate\([^)]*\)/g,"").trim();const s=`translate(${r.absolute?t:o.translation.tx+t},${r.absolute?n:o.translation.ty+n})`;e.setAttribute("transform",`${s} ${i}`.trim())}function Dv(e,t,n,r,i={}){let o=lm(e,"transform");const s=xv(o);if(null==t)return s.rotation;o=s.raw,o=o.replace(/rotate\([^)]*\)/g,"").trim(),t%=360;const a=`rotate(${i.absolute?t:s.rotation.angle+t}${null!=n&&null!=r?`,${n},${r}`:""})`;e.setAttribute("transform",`${o} ${a}`.trim())}function Nv(e,t,n){let r=lm(e,"transform");const i=xv(r);if(null==t)return i.scale;n=null==n?t:n,r=i.raw,r=r.replace(/scale\([^)]*\)/g,"").trim();const o=`scale(${t},${n})`;e.setAttribute("transform",`${r} ${o}`.trim())}function Rv(e,t,n,r){const i=Tm.create(t),o=Tm.create(n);if(!r){r=e instanceof SVGSVGElement?e:e.ownerSVGElement}const s=Nv(e);e.setAttribute("transform","");const a=Sv(e,{target:r}).scale(s.sx,s.sy),l=vv();l.setTranslate(-a.x-a.width/2,-a.y-a.height/2);const c=vv(),u=i.angleBetween(o,i.clone().translate(1,0));u&&c.setRotate(u,0,0);const h=vv(),d=i.clone().move(o,a.width/2);h.setTranslate(2*i.x-d.x,2*i.y-d.y);const f=Ov(e,r),p=vv();p.setMatrix(h.matrix.multiply(c.matrix.multiply(l.matrix.multiply(f.scale(s.sx,s.sy))))),e.setAttribute("transform",bv(p.matrix))}class Iv{constructor(e,t,n){this.animationFrameId=0,this.deltaX=0,this.deltaY=0,this.eventName=gr.isEventSupported("wheel")?"wheel":"mousewheel",this.target=e,this.onWheelCallback=t,this.onWheelGuard=n,this.onWheel=this.onWheel.bind(this),this.didWheel=this.didWheel.bind(this)}enable(){gr.SUPPORT_PASSIVE?this.target.addEventListener(this.eventName,this.onWheel,{passive:!1}):fr(this.target).on("mousewheel",this.onWheel)}disable(){gr.SUPPORT_PASSIVE?this.target.removeEventListener(this.eventName,this.onWheel):fr(this.target).off("mousewheel")}onWheel(e){if(null!=this.onWheelGuard&&!this.onWheelGuard(e))return;let t;this.deltaX+=e.deltaX,this.deltaY+=e.deltaY,e.preventDefault(),0===this.deltaX&&0===this.deltaY||(e.stopPropagation(),t=!0),!0===t&&0===this.animationFrameId&&(this.animationFrameId=requestAnimationFrame((()=>{this.didWheel(e)})))}didWheel(e){this.animationFrameId=0,this.onWheelCallback(e,this.deltaX,this.deltaY),this.deltaX=0,this.deltaY=0}}function jv(e,t=60){let n=null;return(...r)=>{n&&clearTimeout(n),n=window.setTimeout((()=>{e.apply(this,r)}),t)}}ev.isVector,ev.create,ev.createVectors;const Lv="undefined"!=typeof ResizeObserver?function(e){let t=null,n=[];const r=jv((()=>{n.forEach((t=>{t(e)}))})),i=()=>{t&&(t.disconnect(),n=[],t=null)};return{element:e,bind:i=>{t||(t=(()=>{const t=new ResizeObserver(r);return t.observe(e),r(),t})()),-1===n.indexOf(i)&&n.push(i)},destroy:i,unbind:e=>{const r=n.indexOf(e);-1!==r&&n.splice(r,1),0===n.length&&t&&i()}}}:function(e){let t=null,n=[];const r=jv((()=>{n.forEach((t=>t(e)))})),i=()=>{t&&t.parentNode&&(t.contentDocument&&t.contentDocument.defaultView.removeEventListener("resize",r),t.parentNode.removeChild(t),t=null,n=[])};return{element:e,bind:i=>{t||(t=(()=>{"static"===getComputedStyle(e).position&&(e.style.position="relative");const t=document.createElement("object");return t.onload=()=>{t.contentDocument.defaultView.addEventListener("resize",r),r()},t.style.display="block",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.height="100%",t.style.width="100%",t.style.overflow="hidden",t.style.pointerEvents="none",t.style.zIndex="-1",t.style.opacity="0",t.setAttribute("tabindex","-1"),t.type="text/html",e.appendChild(t),t.data="about:blank",t})()),-1===n.indexOf(i)&&n.push(i)},destroy:i,unbind:e=>{const r=n.indexOf(e);-1!==r&&n.splice(r,1),0===n.length&&t&&i()}}};var Fv,Gv;!function(e){const t=new WeakMap;function n(e){let n=t.get(e);return n||(n=Lv(e),t.set(e,n),n)}e.bind=(e,t)=>{const r=n(e);return r.bind(t),()=>r.unbind(t)},e.clear=e=>{!function(e){e.destroy(),t.delete(e.element)}(n(e))}}(Fv||(Fv={})),function(e){const t=[],n=[];let r=0;const i=()=>performance.now(),o=e=>e[0],s=e=>1===n.push(e)&&a(),a=(()=>{const e=()=>n.splice(0,n.length).forEach((e=>e()));if("undefined"!=typeof MessageChannel){const{port1:t,port2:n}=new MessageChannel;return t.onmessage=e,()=>n.postMessage(null)}return()=>setTimeout(e)})(),l=()=>{r=i()+16.666666666666668;let n=o(t);for(;n&&!e.shouldYield();){const{callback:e,data:r}=n;n.callback=null;const i=e&&e(r);i?n.callback=i:t.shift(),n=o(t)}n&&s(l)};e.scheduleTask=(e,n)=>{const r={callback:e,data:n};t.push(r),s(l)},e.shouldYield=()=>{var e,t;return(null===(t=null===(e=navigator)||void 0===e?void 0:e.scheduling)||void 0===t?void 0:t.isInputPending())||i()>=r}}(Gv||(Gv={}));class Bv{constructor(e){this.options=Object.assign({},e),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this)}get names(){return Object.keys(this.data)}register(e,t,n=!1){if("object"==typeof e)return void Object.keys(e).forEach((n=>{this.register(n,e[n],t)}));!this.exist(e)||n||gr.isApplyingHMR()||this.onDuplicated(e);const r=this.options.process,i=r?Tg(r,this,e,t):t;return this.data[e]=i,i}unregister(e){const t=e?this.data[e]:null;return delete this.data[e],t}get(e){return e?this.data[e]:null}exist(e){return!!e&&null!=this.data[e]}onDuplicated(e){try{throw this.options.onConflict&&Tg(this.options.onConflict,this,e),new Error(`${ga(this.options.type)} with name '${e}' already registered.`)}catch(e){throw e}}onNotFound(e,t){throw new Error(this.getSpellingSuggestion(e,t))}getSpellingSuggestion(e,t){const n=this.getSpellingSuggestionForName(e),r=t?`${t} ${Kh(this.options.type)}`:this.options.type;return`${ga(r)} with name '${e}' does not exist.${n?` Did you mean '${n}'?`:""}`}getSpellingSuggestionForName(e){return function(e,t,n){const r=Math.min(2,Math.floor(.34*e.length));let i,o=Math.floor(.4*e.length)+1,s=!1;const a=e.toLowerCase();for(const l of t){const t=n(l);if(void 0!==t&&Math.abs(t.length-a.length)<=r){const n=t.toLowerCase();if(n===a){if(t===e)continue;return l}if(s)continue;if(t.length<3)continue;const r=_g(a,n,o-1);if(void 0===r)continue;r<3?(s=!0,i=l):(o=r,i=l)}}return i}(e,Object.keys(this.data),(e=>e))}}!function(e){e.create=function(t){return new e(t)}}(Bv||(Bv={}));const zv={xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"},Uv={position:hy("x","width","origin")},Vv={position:hy("y","height","origin")},Hv={position:hy("x","width","corner")},Wv={position:hy("y","height","corner")},$v={set:dy("width","width")},Xv={set:dy("height","height")},Yv={set:dy("rx","width")},qv={set:dy("ry","height")},Kv={set:(e=>{const t=dy("r","width"),n=dy("r","height");return function(e,r){const i=r.refBBox;return Tg(i.height>i.width?t:n,this,e,r)}})()},Zv={set(e,{refBBox:t}){let n=parseFloat(e);const r=Sg(e);r&&(n/=100);const i=Math.sqrt(t.height*t.height+t.width*t.width);let o;return Number.isFinite(n)&&(o=r||n>=0&&n<=1?n*i:Math.max(n+i,0)),{r:o}}},Jv={set:dy("cx","width")},Qv={set:dy("cy","height")},ey={set:py({resetOffset:!0})},ty={set:py({resetOffset:!1})},ny={set:gy({resetOffset:!0})},ry={set:gy({resetOffset:!1})},iy=Kv,oy=ey,sy=ny,ay=Uv,ly=Vv,cy=$v,uy=Xv;function hy(e,t,n){return(r,{refBBox:i})=>{if(null==r)return null;let o=parseFloat(r);const s=Sg(r);let a;if(s&&(o/=100),Number.isFinite(o)){const r=i[n];a=s||o>0&&o<1?r[e]+i[t]*o:r[e]+o}const l=new Tm;return l[e]=a||0,l}}function dy(e,t){return function(n,{refBBox:r}){let i=parseFloat(n);const o=Sg(n);o&&(i/=100);const s={};if(Number.isFinite(i)){const n=o||i>=0&&i<=1?i*r[t]:Math.max(i+r[t],0);s[e]=n}return s}}function fy(e,t){const n="x6-shape",r=t&&t.resetOffset;return function(t,{view:i,elem:o,refBBox:s}){const a=i.$(o);let l=a.data(n);if(!l||l.value!==t){const r=e(t);l={value:t,shape:r,shapeBBox:r.bbox()},a.data(n,l)}const c=l.shape.clone(),u=l.shapeBBox.clone(),h=u.getOrigin(),d=s.getOrigin();u.x=d.x,u.y=d.y;const f=s.getMaxScaleToFit(u,d),p=0===u.width||0===s.width?1:f.sx,g=0===u.height||0===s.height?1:f.sy;return c.scale(p,g,h),r&&c.translate(-h.x,-h.y),c}}function py(e){const t=fy((function(e){return Qm.parse(e)}),e);return(e,n)=>({d:t(e,n).serialize()})}function gy(e){const t=fy((e=>new Rm(e)),e);return(e,n)=>({points:t(e,n).serialize()})}const my={qualify:Ws,set:(e,{view:t})=>`url(#${t.graph.defineGradient(e)})`},vy={qualify:Ws,set(e,{view:t}){const n=t.cell,r=Object.assign({},e);if(n.isEdge()&&"linearGradient"===r.type){const e=t,i=e.sourcePoint,o=e.targetPoint;r.id=`gradient-${r.type}-${n.id}`,r.attrs=Object.assign(Object.assign({},r.attrs),{x1:i.x,y1:i.y,x2:o.x,y2:o.y,gradientUnits:"userSpaceOnUse"}),t.graph.defs.remove(r.id)}return`url(#${t.graph.defineGradient(r)})`}},yy={qualify:(e,{attrs:t})=>null==t.textWrap||!Ws(t.textWrap),set(e,{view:t,elem:n,attrs:r}){const i="x6-text",o=t.$(n),s=o.data(i),a=e=>{try{return JSON.parse(e)}catch(t){return e}},l={x:r.x,eol:r.eol,annotations:a(r.annotations),textPath:a(r["text-path"]||r.textPath),textVerticalAnchor:r["text-vertical-anchor"]||r.textVerticalAnchor,displayEmpty:"true"===(r["display-empty"]||r.displayEmpty),lineHeight:r["line-height"]||r.lineHeight},c=r["font-size"]||r.fontSize,u=JSON.stringify([e,l]);if(c&&n.setAttribute("font-size",c),null==s||s!==u){const r=l.textPath;if(null!=r&&"object"==typeof r){const e=r.selector;if("string"==typeof e){const n=t.find(e)[0];n instanceof SVGPathElement&&(Ug(n),l.textPath=Object.assign({"xlink:href":`#${n.id}`},r))}}iv(n,`${e}`,l),o.data(i,u)}}},by={qualify:Ws,set(e,{view:t,elem:n,attrs:r,refBBox:i}){const o=e,s=o.width||0;Sg(s)?i.width*=parseFloat(s)/100:s<=0?i.width+=s:i.width=s;const a=o.height||0;let l;Sg(a)?i.height*=parseFloat(a)/100:a<=0?i.height+=a:i.height=a;let c=o.text;null==c&&(c=r.text),l=null!=c?ov(`${c}`,i,{"font-weight":r["font-weight"]||r.fontWeight,"font-size":r["font-size"]||r.fontSize,"font-family":r["font-family"]||r.fontFamily,lineHeight:r.lineHeight},{svgDocument:t.graph.view.svg,ellipsis:o.ellipsis,hyphen:o.hyphen,breakWord:o.breakWord}):"",Tg(yy.set,this,l,{view:t,elem:n,attrs:r,refBBox:i,cell:t.cell})}},xy=(e,{attrs:t})=>void 0!==t.text,wy={qualify:xy},Cy={qualify:xy},Ey={qualify:xy},_y={qualify:xy},Sy={qualify:xy},Oy={qualify:xy},Ay={qualify:(e,{elem:t})=>t instanceof SVGElement,set(e,{view:t,elem:n}){const r="x6-title",i=`${e}`,o=t.$(n),s=o.data(r);if(null==s||s!==i){o.data(r,i);const e=n.firstChild;if(e&&"TITLE"===e.tagName.toUpperCase()){e.textContent=i}else{const t=document.createElementNS(n.namespaceURI,"title");t.textContent=i,n.insertBefore(t,e)}}}},ky={offset:Py("x","width","right")},My={offset:Py("y","height","bottom")},Ty={offset:(e,{refBBox:t})=>e?{x:-t.x,y:-t.y}:{x:0,y:0}};function Py(e,t,n){return(r,{refBBox:i})=>{const o=new Tm;let s;return s="middle"===r?i[t]/2:r===n?i[t]:"number"==typeof r&&Number.isFinite(r)?r>-1&&r<1?-i[t]*r:-r:Sg(r)?i[t]*parseFloat(r)/100:0,o[e]=-(i[e]+s),o}}const Dy={qualify:Ws,set(e,{view:t,elem:n}){t.$(n).css(e)}},Ny={set(e,{view:t,elem:n}){t.$(n).html(`${e}`)}},Ry={qualify:Ws,set:(e,{view:t})=>`url(#${t.graph.defineFilter(e)})`},Iy={set:e=>null!=e&&"object"==typeof e&&e.id?e.id:e};function jy(e,t,n){let r,i;"object"==typeof t?(r=t.x,i=t.y):(r=t,i=n);const o=Qm.parse(e),s=o.bbox();if(s){let e=-s.height/2-s.y,t=-s.width/2-s.x;"number"==typeof r&&(t-=r),"number"==typeof i&&(e-=i),o.translate(t,e)}return o.serialize()}var Ly=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Fy(e,t,n,r=3/4,i={}){const o=e.size||10,s=e.width||o,a=e.height||o,l=new Qm,c={};if(t)l.moveTo(s,0).lineTo(0,a/2).lineTo(s,a),c.fill="none";else{if(l.moveTo(0,a/2),l.lineTo(s,0),!n){const e=il(r,0,1);l.lineTo(s*e,a/2)}l.lineTo(s,a),l.close()}return Object.assign(Object.assign(Object.assign({},c),i),{tagName:"path",d:jy(l.serialize(),{x:null!=e.offset?e.offset:-s/2})})}var Gy=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};var By=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};var zy=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};var Uy=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};var Vy=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Hy=e=>{var{r:t}=e,n=Vy(e,["r"]);const r=t||5;return Object.assign(Object.assign({cx:r},n),{tagName:"circle",r:r})};var Wy=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};var $y,Xy=Object.freeze({__proto__:null,block:e=>{var{size:t,width:n,height:r,offset:i,open:o}=e;return Fy({size:t,width:n,height:r,offset:i},!0===o,!0,void 0,Ly(e,["size","width","height","offset","open"]))},classic:e=>{var{size:t,width:n,height:r,offset:i,factor:o}=e;return Fy({size:t,width:n,height:r,offset:i},!1,!1,o,Ly(e,["size","width","height","offset","factor"]))},diamond:e=>{var{size:t,width:n,height:r,offset:i}=e,o=Gy(e,["size","width","height","offset"]);const s=t||10,a=n||s,l=r||s,c=new Qm;return c.moveTo(0,l/2).lineTo(a/2,0).lineTo(a,l/2).lineTo(a/2,l).close(),Object.assign(Object.assign({},o),{tagName:"path",d:jy(c.serialize(),null==i?-a/2:i)})},path:e=>{var{d:t,offsetX:n,offsetY:r}=e,i=By(e,["d","offsetX","offsetY"]);return Object.assign(Object.assign({},i),{tagName:"path",d:jy(t,n,r)})},cross:e=>{var{size:t,width:n,height:r,offset:i}=e,o=zy(e,["size","width","height","offset"]);const s=t||10,a=n||s,l=r||s,c=new Qm;return c.moveTo(0,0).lineTo(a,l).moveTo(0,l).lineTo(a,0),Object.assign(Object.assign({},o),{tagName:"path",fill:"none",d:jy(c.serialize(),i||-a/2)})},async:e=>{var{width:t,height:n,offset:r,open:i,flip:o}=e,s=Uy(e,["width","height","offset","open","flip"]);let a=n||6;const l=t||10,c=!0===i,u=!0===o,h=Object.assign(Object.assign({},s),{tagName:"path"});u&&(a=-a);const d=new Qm;return d.moveTo(0,a).lineTo(l,0),c?h.fill="none":(d.lineTo(l,a),d.close()),h.d=jy(d.serialize(),{x:r||-l/2,y:a/2}),h},circle:Hy,circlePlus:e=>{var{r:t}=e,n=Vy(e,["r"]);const r=t||5,i=new Qm;return i.moveTo(r,0).lineTo(r,2*r),i.moveTo(0,r).lineTo(2*r,r),{children:[Object.assign(Object.assign({},Hy({r:r})),{fill:"none"}),Object.assign(Object.assign({},n),{tagName:"path",d:jy(i.serialize(),-r)})]}},ellipse:e=>{var{rx:t,ry:n}=e,r=Wy(e,["rx","ry"]);const i=t||5,o=n||5;return Object.assign(Object.assign({cx:i},r),{tagName:"ellipse",rx:i,ry:o})}});!function(e){e.presets=Xy,e.registry=Bv.create({type:"marker"}),e.registry.register(e.presets,!0)}($y||($y={})),function(e){e.normalize=jy}($y||($y={}));var Yy=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function qy(e){return"string"==typeof e||Ws(e)}const Ky={qualify:qy,set:(e,{view:t,attrs:n})=>Qy("marker-start",e,t,n)},Zy={qualify:qy,set:(e,{view:t,attrs:n})=>Qy("marker-end",e,t,n,{transform:"rotate(180)"})},Jy={qualify:qy,set:(e,{view:t,attrs:n})=>Qy("marker-mid",e,t,n)};function Qy(e,t,n,r,i={}){const o="string"==typeof t?{name:t}:t,{name:s,args:a}=o,l=Yy(o,["name","args"]);let c=l;if(s&&"string"==typeof s){const e=$y.registry.get(s);if(!e)return $y.registry.onNotFound(s);c=e(Object.assign(Object.assign({},l),a))}const u=Object.assign(Object.assign(Object.assign({},function(e,t){const n={},r=e.stroke;"string"==typeof r&&(n.stroke=r,n.fill=r);let i=e.strokeOpacity;null==i&&(i=e["stroke-opacity"]);null==i&&(i=e.opacity);null!=i&&(n["stroke-opacity"]=i,n["fill-opacity"]=i);if("marker-mid"!==t){const r=parseFloat(e.strokeWidth||e["stroke-width"]);if(Number.isFinite(r)&&r>1){const e=Math.ceil(r/2);n.refX="marker-start"===t?e:-e}}return n}(r,e)),i),c);return{[e]:`url(#${n.graph.defineMarker(u)})`}}const eb=(e,{view:t})=>t.cell.isEdge(),tb={qualify:eb,set(e,t){const n=t.view,r=e.stubs||0;let i;if(Number.isFinite(r)&&0!==r){let e;if(r<0){e=((n.getConnectionLength()||0)+r)/2}else e=r;const t=n.getConnection();if(t){const n=t.divideAtLength(e),r=t.divideAtLength(-e);n&&r&&(i=`${n[0].serialize()} ${r[1].serialize()}`)}}return{d:i||n.getConnectionPathData()}}},nb={qualify:eb,set:lb("getTangentAtLength",{rotate:!0})},rb={qualify:eb,set:lb("getTangentAtLength",{rotate:!1})},ib={qualify:eb,set:lb("getTangentAtRatio",{rotate:!0})},ob={qualify:eb,set:lb("getTangentAtRatio",{rotate:!1})},sb=nb,ab=ib;function lb(e,t){const n={x:1,y:0};return(r,i)=>{let o,s;const a=i.view,l=a[e](Number(r));return l?(s=t.rotate?l.vector().vectorAngle(n):0,o=l.start):(o=a.path.start,s=0),0===s?{transform:`translate(${o.x},${o.y}')`}:{transform:`translate(${o.x},${o.y}') rotate(${s})`}}}var cb,ub=Object.freeze({__proto__:null,ref:{},refX:Uv,refY:Vv,refDx:Hv,refDy:Wv,refWidth:$v,refHeight:Xv,refRx:Yv,refRy:qv,refRInscribed:Kv,refRCircumscribed:Zv,refCx:Jv,refCy:Qv,refDResetOffset:ey,refDKeepOffset:ty,refPointsResetOffset:ny,refPointsKeepOffset:ry,refR:iy,refD:oy,refPoints:sy,refX2:ay,refY2:ly,refWidth2:cy,refHeight2:uy,fill:my,stroke:vy,text:yy,textWrap:by,lineHeight:wy,textVerticalAnchor:Cy,textPath:Ey,annotations:_y,eol:Sy,displayEmpty:Oy,title:Ay,xAlign:ky,yAlign:My,resetOffset:Ty,style:Dy,html:Ny,filter:Ry,port:Iy,sourceMarker:Ky,targetMarker:Zy,vertexMarker:Jy,connection:tb,atConnectionLengthKeepGradient:nb,atConnectionLengthIgnoreGradient:rb,atConnectionRatioKeepGradient:ib,atConnectionRatioIgnoreGradient:ob,atConnectionLength:sb,atConnectionRatio:ab});!function(e){e.isValidDefinition=function(e,t,n){if(null!=e){if("string"==typeof e)return!0;if("function"!=typeof e.qualify||Tg(e.qualify,this,t,n))return!0}return!1}}(cb||(cb={})),function(e){e.presets=Object.assign(Object.assign({},zv),ub),e.registry=Bv.create({type:"attribute definition"}),e.registry.register(e.presets,!0)}(cb||(cb={}));const hb={color:"#aaaaaa",thickness:1,markup:"rect",update(e,t){const n=t.thickness*t.sx,r=t.thickness*t.sy;lm(e,{width:n,height:r,rx:n,ry:r,fill:t.color})}},db={color:"#aaaaaa",thickness:1,markup:"rect",update(e,t){const n=t.sx<=1?t.thickness*t.sx:t.thickness;lm(e,{width:n,height:n,rx:n,ry:n,fill:t.color})}},fb={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(e,t){let n;const r=t.width,i=t.height,o=t.thickness;n=r-o>=0&&i-o>=0?["M",r,0,"H0 M0 0 V0",i].join(" "):"M 0 0 0 0",lm(e,{d:n,stroke:t.color,"stroke-width":t.thickness})}},pb=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(e,t){let n;const r=t.width,i=t.height,o=t.thickness;n=r-o>=0&&i-o>=0?["M",r,0,"H0 M0 0 V0",i].join(" "):"M 0 0 0 0",lm(e,{d:n,stroke:t.color,"stroke-width":t.thickness})}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update(e,t){let n;const r=t.factor||1,i=t.width*r,o=t.height*r,s=t.thickness;n=i-s>=0&&o-s>=0?["M",i,0,"H0 M0 0 V0",o].join(" "):"M 0 0 0 0",t.width=i,t.height=o,lm(e,{d:n,stroke:t.color,"stroke-width":t.thickness})}}];var gb=Object.freeze({__proto__:null,dot:hb,fixedDot:db,mesh:fb,doubleMesh:pb});class mb{constructor(){this.patterns={},this.root=ev.create(Yg(),{width:"100%",height:"100%"},[Xg("defs")]).node}add(e,t){const n=this.root.childNodes[0];n&&n.appendChild(t),this.patterns[e]=t,ev.create("rect",{width:"100%",height:"100%",fill:`url(#${e})`}).appendTo(this.root)}get(e){return this.patterns[e]}has(e){return null!=this.patterns[e]}}function vb(e,t){return null!=e?e:t}function yb(e,t){return null!=e&&Number.isFinite(e)?e:t}!function(e){e.presets=gb,e.registry=Bv.create({type:"grid"}),e.registry.register(e.presets,!0)}(mb||(mb={}));var bb,xb=Object.freeze({__proto__:null,outline:function(e={}){const t=vb(e.color,"blue"),n=yb(e.width,1),r=yb(e.margin,2);return`\n    <filter>\n      <feFlood flood-color="${t}" flood-opacity="${yb(e.opacity,1)}" result="colored"/>\n      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${r+n}" />\n      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${r}" />\n      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>\n      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>\n      <feMerge>\n        <feMergeNode in="outline"/>\n        <feMergeNode in="SourceGraphic"/>\n      </feMerge>\n    </filter>\n  `.trim()},highlight:function(e={}){const t=vb(e.color,"red"),n=yb(e.blur,0),r=yb(e.width,1);return`\n      <filter>\n        <feFlood flood-color="${t}" flood-opacity="${yb(e.opacity,1)}" result="colored"/>\n        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${r}"/>\n        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>\n        <feGaussianBlur result="blured" in="composed" stdDeviation="${n}"/>\n        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>\n      </filter>\n    `.trim()},blur:function(e={}){const t=yb(e.x,2);return`\n    <filter>\n      <feGaussianBlur stdDeviation="${null!=e.y&&Number.isFinite(e.y)?[t,e.y]:t}"/>\n    </filter>\n  `.trim()},dropShadow:function(e={}){const t=yb(e.dx,0),n=yb(e.dy,0),r=vb(e.color,"black"),i=yb(e.blur,4),o=yb(e.opacity,1);return"SVGFEDropShadowElement"in window?`<filter>\n         <feDropShadow stdDeviation="${i}" dx="${t}" dy="${n}" flood-color="${r}" flood-opacity="${o}" />\n       </filter>`.trim():`<filter>\n         <feGaussianBlur in="SourceAlpha" stdDeviation="${i}" />\n         <feOffset dx="${t}" dy="${n}" result="offsetblur" />\n         <feFlood flood-color="${r}" />\n         <feComposite in2="offsetblur" operator="in" />\n         <feComponentTransfer>\n           <feFuncA type="linear" slope="${o}" />\n         </feComponentTransfer>\n         <feMerge>\n           <feMergeNode/>\n           <feMergeNode in="SourceGraphic"/>\n         </feMerge>\n       </filter>`.trim()},grayScale:function(e={}){const t=yb(e.amount,1),n=.7152-.7152*(1-t);return`\n    <filter>\n      <feColorMatrix type="matrix" values="${.2126+.7874*(1-t)} ${n} ${.0722-.0722*(1-t)} 0 0 ${.2126-.2126*(1-t)} ${.7152+.2848*(1-t)} ${.0722-.0722*(1-t)} 0 0 ${.2126-.2126*(1-t)} ${n} ${.0722+.9278*(1-t)} 0 0 0 0 0 1 0"/>\n    </filter>\n  `.trim()},sepia:function(e={}){const t=yb(e.amount,1);return`\n      <filter>\n        <feColorMatrix type="matrix" values="${.393+.607*(1-t)} ${.769-.769*(1-t)} ${.189-.189*(1-t)} 0 0 ${.349-.349*(1-t)} ${.686+.314*(1-t)} ${.168-.168*(1-t)} 0 0 ${.272-.272*(1-t)} ${.534-.534*(1-t)} ${.131+.869*(1-t)} 0 0 0 0 0 1 0"/>\n      </filter>\n    `.trim()},saturate:function(e={}){return`\n      <filter>\n        <feColorMatrix type="saturate" values="${1-yb(e.amount,1)}"/>\n      </filter>\n    `.trim()},hueRotate:function(e={}){return`\n      <filter>\n        <feColorMatrix type="hueRotate" values="${yb(e.angle,0)}"/>\n      </filter>\n    `.trim()},invert:function(e={}){const t=yb(e.amount,1),n=1-t;return`\n      <filter>\n        <feComponentTransfer>\n          <feFuncR type="table" tableValues="${t} ${n}"/>\n          <feFuncG type="table" tableValues="${t} ${n}"/>\n          <feFuncB type="table" tableValues="${t} ${n}"/>\n        </feComponentTransfer>\n      </filter>\n    `.trim()},brightness:function(e={}){const t=yb(e.amount,1);return`\n    <filter>\n      <feComponentTransfer>\n        <feFuncR type="linear" slope="${t}"/>\n        <feFuncG type="linear" slope="${t}"/>\n        <feFuncB type="linear" slope="${t}"/>\n      </feComponentTransfer>\n    </filter>\n  `.trim()},contrast:function(e={}){const t=yb(e.amount,1),n=.5-t/2;return`\n    <filter>\n     <feComponentTransfer>\n        <feFuncR type="linear" slope="${t}" intercept="${n}"/>\n        <feFuncG type="linear" slope="${t}" intercept="${n}"/>\n        <feFuncB type="linear" slope="${t}" intercept="${n}"/>\n      </feComponentTransfer>\n    </filter>\n  `.trim()}});!function(e){e.presets=xb,e.registry=Bv.create({type:"filter"}),e.registry.register(e.presets,!0)}(bb||(bb={}));const wb=function(e){const t=document.createElement("canvas"),n=e.width,r=e.height;t.width=2*n,t.height=r;const i=t.getContext("2d");return i.drawImage(e,0,0,n,r),i.translate(2*n,0),i.scale(-1,1),i.drawImage(e,0,0,n,r),t},Cb=function(e){const t=document.createElement("canvas"),n=e.width,r=e.height;t.width=n,t.height=2*r;const i=t.getContext("2d");return i.drawImage(e,0,0,n,r),i.translate(0,2*r),i.scale(1,-1),i.drawImage(e,0,0,n,r),t},Eb=function(e){const t=document.createElement("canvas"),n=e.width,r=e.height;t.width=2*n,t.height=2*r;const i=t.getContext("2d");return i.drawImage(e,0,0,n,r),i.setTransform(-1,0,0,-1,t.width,t.height),i.drawImage(e,0,0,n,r),i.setTransform(-1,0,0,1,t.width,0),i.drawImage(e,0,0,n,r),i.setTransform(1,0,0,-1,0,t.height),i.drawImage(e,0,0,n,r),t};var _b,Sb=Object.freeze({__proto__:null,flipX:wb,flipY:Cb,flipXY:Eb,watermark:function(e,t){const n=e.width,r=e.height,i=document.createElement("canvas");i.width=3*n,i.height=3*r;const o=i.getContext("2d"),s=null!=t.angle?-t.angle:-20,a=Cm.toRad(s),l=i.width/4,c=i.height/4;for(let t=0;t<4;t+=1)for(let i=0;i<4;i+=1)(t+i)%2>0&&(o.setTransform(1,0,0,1,(2*t-1)*l,(2*i-1)*c),o.rotate(a),o.drawImage(e,-n/2,-r/2,n,r));return i}});!function(e){e.presets=Object.assign({},Sb),e.presets["flip-x"]=wb,e.presets["flip-y"]=Cb,e.presets["flip-xy"]=Eb,e.registry=Bv.create({type:"background pattern"}),e.registry.register(e.presets,!0)}(_b||(_b={}));const Ob={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,trackable:!1,trackInfo:{},track(e){Ob.trackable=e}};var Ab;!function(e){e.snapToGrid=Om,e.normalizeMarker=jy,e.prefix=function(e){return`${Ob.prefixCls}-${e}`}}(Ab||(Ab={})),function(e){e.makeTree=function(e,t,n,r=[]){const i="function"==typeof t.children?t.children(e):e[t.children||"children"];return n||(n=t.createNode(e),r.push(n)),Array.isArray(i)&&i.forEach((e=>{const i=t.createNode(e),o=t.createEdge(n,i);r.push(i,o),this.makeTree(e,t,i,r)})),r}}(Ab||(Ab={}));const kb=Ab.prefix("highlighted"),Mb={highlight(e,t,n){Fg(t,n&&n.className||kb)},unhighlight(e,t,n){Gg(t,n&&n.className||kb)}},Tb=Ab.prefix("highlight-opacity"),Pb={highlight(e,t){Fg(t,Tb)},unhighlight(e,t){Gg(t,Tb)}},Db={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},Nb={highlight(e,t,n){const r=Rb.getHighlighterId(t,n);if(Rb.hasCache(r))return;n=nu({},n,Db);const i=ev.create(t);let o,s;try{o=i.toPathData()}catch(e){s=i.bbox(!0),o=uv(Object.assign(Object.assign({},n),s))}const a=Xg("path");if(lm(a,Object.assign({d:o,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},n.attrs?um(n.attrs):null)),e.isEdgeElement(t))lm(a,"d",e.getConnectionPathData());else{let t=i.getTransformToElement(e.container);const r=n.padding;if(r){null==s&&(s=i.bbox(!0));const e=s.x+s.width/2,n=s.y+s.height/2;s=Ev(s,t);const o=Math.max(s.width,1),a=Math.max(s.height,1),l=(o+r)/o,c=(a+r)/a,u=mv({a:l,b:0,c:0,d:c,e:e-l*e,f:n-c*n});t=t.multiply(u)}Tv(a,t)}Fg(a,Ab.prefix("highlight-stroke"));const l=e.cell,c=()=>Rb.removeHighlighter(r);l.on("removed",c),l.model&&l.model.on("reseted",c),e.container.appendChild(a),Rb.setCache(r,a)},unhighlight(e,t,n){Rb.removeHighlighter(Rb.getHighlighterId(t,n))}};var Rb;!function(e){e.getHighlighterId=function(e,t){return Ug(e),e.id+JSON.stringify(t)};const t={};e.setCache=function(e,n){t[e]=n},e.hasCache=function(e){return null!=t[e]},e.removeHighlighter=function(e){const n=t[e];n&&(em(n),delete t[e])}}(Rb||(Rb={}));var Ib,jb=Object.freeze({__proto__:null,className:Mb,opacity:Pb,stroke:Nb});function Lb(e,t={}){return new Tm(Og(t.x,e.width),Og(t.y,e.height))}function Fb(e,t,n){return Object.assign({angle:t,position:e.toJSON()},n)}!function(e){e.check=function(e,t){if("function"!=typeof t.highlight)throw new Error(`Highlighter '${e}' is missing required \`highlight()\` method`);if("function"!=typeof t.unhighlight)throw new Error(`Highlighter '${e}' is missing required \`unhighlight()\` method`)}}(Ib||(Ib={})),function(e){e.presets=jb,e.registry=Bv.create({type:"highlighter"}),e.registry.register(e.presets,!0)}(Ib||(Ib={}));function Gb(e,t,n,r){const i=t.getCenter(),o=t.getTopCenter(),s=t.width/t.height,a=Nm.fromRect(t),l=e.length;return e.map(((e,t)=>{const c=n+r(t,l),u=o.clone().rotate(-c,i).scale(s,1,i),h=e.compensateRotate?-a.tangentTheta(u):0;return(e.dx||e.dy)&&u.translate(e.dx||0,e.dy||0),e.dr&&u.move(i,e.dr),Fb(u.round(),h,e)}))}var Bb=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function zb(e,t,n,r){const i=new Dm(t,n),o=e.length;return e.map(((e,t)=>{var{strict:n}=e,s=Bb(e,["strict"]);const a=n||r.strict?(t+1)/(o+1):(t+.5)/o,l=i.pointAt(a);return(s.dx||s.dy)&&l.translate(s.dx||0,s.dy||0),Fb(l.round(),0,s)}))}var Ub,Vb=Object.freeze({__proto__:null,absolute:(e,t)=>e.map((({x:e,y:n,angle:r})=>Fb(Lb(t,{x:e,y:n}),r||0))),ellipse:(e,t,n)=>{const r=n.start||0,i=n.step||20;return Gb(e,t,r,((e,t)=>(e+.5-t/2)*i))},ellipseSpread:(e,t,n)=>{const r=n.start||0,i=n.step||360/e.length;return Gb(e,t,r,(e=>e*i))},line:(e,t,n)=>zb(e,Lb(t,n.start||t.getOrigin()),Lb(t,n.end||t.getCorner()),n),left:(e,t,n)=>zb(e,t.getTopLeft(),t.getBottomLeft(),n),right:(e,t,n)=>zb(e,t.getTopRight(),t.getBottomRight(),n),top:(e,t,n)=>zb(e,t.getTopLeft(),t.getTopRight(),n),bottom:(e,t,n)=>zb(e,t.getBottomLeft(),t.getBottomRight(),n)});!function(e){e.presets=Vb,e.registry=Bv.create({type:"port layout"}),e.registry.register(e.presets,!0)}(Ub||(Ub={}));const Hb={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function Wb(e,t){const{x:n,y:r,angle:i,attrs:o}=t||{};return nu({},{angle:i,attrs:o,position:{x:n,y:r}},e,Hb)}function $b(e,t,n,r){const i=null!=r.offset?r.offset:15,o=t.getCenter().theta(e),s=Yb(t);let a,l,c,u,h=0;return o<s[1]||o>s[2]?(a=".3em",l=i,c=0,u="start"):o<s[0]?(a="0",l=0,c=-i,n?(h=-90,u="start"):u="middle"):o<s[3]?(a=".3em",l=-i,c=0,u="end"):(a=".6em",l=0,c=i,n?(h=90,u="start"):u="middle"),Wb({position:{x:Math.round(l),y:Math.round(c)},angle:h,attrs:{".":{y:a,"text-anchor":u}}},r)}function Xb(e,t,n,r){const i=null!=r.offset?r.offset:15,o=t.getCenter().theta(e),s=Yb(t);let a,l,c,u,h=0;return o<s[1]||o>s[2]?(a=".3em",l=-i,c=0,u="end"):o<s[0]?(a=".6em",l=0,c=i,n?(h=90,u="start"):u="middle"):o<s[3]?(a=".3em",l=i,c=0,u="start"):(a="0em",l=0,c=-i,n?(h=-90,u="start"):u="middle"),Wb({position:{x:Math.round(l),y:Math.round(c)},angle:h,attrs:{".":{y:a,"text-anchor":u}}},r)}function Yb(e){const t=e.getCenter(),n=t.theta(e.getTopLeft()),r=t.theta(e.getBottomLeft()),i=t.theta(e.getBottomRight());return[n,t.theta(e.getTopRight()),i,r]}function qb(e,t,n){const r=null!=n.offset?n.offset:20,i=new Tm(0,0),o=-e.theta(i);let s,a=".3em",l=o;return(o+90)%180==0?(s=t?"end":"middle",t||-270!==o||(a="0em")):o>-270&&o<-90?(s="start",l=o-180):s="end",Wb({position:e.clone().move(i,r).diff(e).round().round().toJSON(),angle:t?l:0,attrs:{".":{y:a,"text-anchor":s}}},n)}var Kb,Zb,Jb=Object.freeze({__proto__:null,manual:(e,t,n)=>Wb({position:t.getTopLeft()},n),left:(e,t,n)=>Wb({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},n),right:(e,t,n)=>Wb({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},n),top:(e,t,n)=>Wb({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},n),bottom:(e,t,n)=>Wb({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},n),outside:(e,t,n)=>$b(e,t,!1,n),outsideOriented:(e,t,n)=>$b(e,t,!0,n),inside:(e,t,n)=>Xb(e,t,!1,n),insideOriented:(e,t,n)=>Xb(e,t,!0,n),radial:(e,t,n)=>qb(e.diff(t.getCenter()),!1,n),radialOriented:(e,t,n)=>qb(e.diff(t.getCenter()),!0,n)});!function(e){e.presets=Jb,e.registry=Bv.create({type:"port label layout"}),e.registry.register(e.presets,!0)}(Kb||(Kb={}));class Qb{constructor(e,t,n,r){return null==e?this.set(255,255,255,1):"number"==typeof e?this.set(e,t,n,r):"string"==typeof e?Qb.fromString(e)||this:Array.isArray(e)?this.set(e):void this.set(e.r,e.g,e.b,null==e.a?1:e.a)}blend(e,t,n){this.set(e.r+(t.r-e.r)*n,e.g+(t.g-e.g)*n,e.b+(t.b-e.b)*n,e.a+(t.a-e.a)*n)}lighten(e){const t=Qb.lighten(this.toArray(),e);this.r=t[0],this.g=t[1],this.b=t[2],this.a=t[3]}darken(e){this.lighten(-e)}set(e,t,n,r){const i=Array.isArray(e)?e[0]:e,o=Array.isArray(e)?e[1]:t,s=Array.isArray(e)?e[2]:n,a=Array.isArray(e)?e[3]:r;return this.r=Math.round(il(i,0,255)),this.g=Math.round(il(o,0,255)),this.b=Math.round(il(s,0,255)),this.a=null==a?1:il(a,0,1),this}toHex(){return`#${["r","g","b"].map((e=>{const t=this[e].toString(16);return t.length<2?`0${t}`:t})).join("")}`}toRGBA(){return this.toArray()}toHSLA(){return Qb.rgba2hsla(this.r,this.g,this.b,this.a)}toCSS(e){const t=`${this.r},${this.g},${this.b},`;return e?`rgb(${t})`:`rgba(${t},${this.a})`}toGrey(){return Qb.makeGrey(Math.round((this.r+this.g+this.b)/3),this.a)}toArray(){return[this.r,this.g,this.b,this.a]}toString(){return this.toCSS()}}!function(e){function t(t){return new e([...a(t),1])}function n(t){const n=t.toLowerCase().match(/^rgba?\(([\s.,0-9]+)\)/);if(n){const t=n[1].split(/\s*,\s*/).map((e=>parseInt(e,10)));return new e(t)}return null}function r(e,t,n){n<0&&++n,n>1&&--n;const r=6*n;return r<1?e+(t-e)*r:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function i(t){const n=t.toLowerCase().match(/^hsla?\(([\s.,0-9]+)\)/);if(n){const t=n[2].split(/\s*,\s*/),r=(parseFloat(t[0])%360+360)%360/360,i=parseFloat(t[1])/100,s=parseFloat(t[2])/100,a=null==t[3]?1:parseInt(t[3],10);return new e(o(r,i,s,a))}return null}function o(e,t,n,i){const o=Array.isArray(e)?e[0]:e,s=Array.isArray(e)?e[1]:t,a=Array.isArray(e)?e[2]:n,l=Array.isArray(e)?e[3]:i,c=a<=.5?a*(s+1):a+s-a*s,u=2*a-c;return[256*r(u,c,o+1/3),256*r(u,c,o),256*r(u,c,o-1/3),null==l?1:l]}function s(t){return new e(Math.round(256*Math.random()),Math.round(256*Math.random()),Math.round(256*Math.random()),t?void 0:parseFloat(Math.random().toFixed(2)))}function a(e){const t=0===e.indexOf("#")?e:`#${e}`;let n=Number(`0x${t.substr(1)}`);if(4!==t.length&&7!==t.length||Number.isNaN(n))throw new Error("Invalid hex color.");const r=4===t.length?4:8,i=(1<<r)-1,o=["b","g","r"].map((()=>{const e=n&i;return n>>=r,4===r?17*e:e}));return[o[2],o[1],o[0]]}function l(e,t,n){const r=e=>e.length<2?`0${e}`:e;return`${r(e.toString(16))}${r(t.toString(16))}${r(n.toString(16))}`}function c(e,t){if("string"==typeof e){const n="#"===e[0],r=parseInt(n?e.substr(1):e,16),i=il((r>>16)+t,0,255),o=il((r>>8&255)+t,0,255);return`${n?"#":""}${(il((255&r)+t,0,255)|o<<8|i<<16).toString(16)}`}const n=a(c(l(e[0],e[1],e[2]),t));return[n[0],n[1],n[2],e[3]]}e.fromArray=function(t){return new e(t)},e.fromHex=t,e.fromRGBA=n,e.fromHSLA=i,e.fromString=function(r){if(r.startsWith("#"))return t(r);if(r.startsWith("rgb"))return n(r);const o=e.named[r];return o?t(o):i(r)},e.makeGrey=function(t,n){return e.fromArray([t,t,t,n])},e.rgba2hsla=function(e,t,n,r){const i=Array.isArray(e)?e[0]:e,o=Array.isArray(e)?e[1]:t,s=Array.isArray(e)?e[2]:n,a=Array.isArray(e)?e[3]:r,l=Math.max(i,o,s),c=Math.min(i,o,s),u=(l+c)/2;let h=0,d=0;if(c!==l){const e=l-c;switch(d=u>.5?e/(2-l-c):e/(l+c),l){case i:h=(o-s)/e+(o<s?6:0);break;case o:h=(s-i)/e+2;break;case s:h=(i-o)/e+4}h/=6}return[h,d,u,null==a?1:a]},e.hsla2rgba=o,e.random=s,e.randomHex=function(){let e="#";for(let t=0;t<6;t+=1)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},e.randomRGBA=function(e){return s(e).toString()},e.invert=function(e,t){if("string"==typeof e){const n="#"===e[0],[r,i,o]=a(e);return t?.299*r+.587*i+.114*o>186?"#000000":"#ffffff":`${n?"#":""}${l(255-r,255-i,255-o)}`}const n=e[0],r=e[1],i=e[2],o=e[3];return t?.299*n+.587*r+.114*i>186?[0,0,0,o]:[255,255,255,o]:[255-n,255-r,255-i,o]},e.lighten=function(e,t){return c(e,t)},e.darken=function(e,t){return c(e,-t)}}(Qb||(Qb={})),function(e){e.named={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",burntsienna:"#ea7e5d",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}}(Qb||(Qb={}));!function(e){e.call=function(e,t){const n=[];for(let r=0;r<e.length;r+=2){const i=Mg(e[r],e[r+1],Array.isArray(t)?t:[t]);n.push(i)}return Dg(n)}}(Zb||(Zb={}));class ex{get disposed(){return!0===this._disposed}dispose(){this._disposed=!0}}!function(e){e.dispose=function(){return(e,t,n)=>{const r=n.value,i=e.__proto__;n.value=function(){this.disposed||(r.call(this),i.dispose.call(this))}}}}(ex||(ex={}));class tx{constructor(){this.isDisposed=!1,this.items=new Set}get disposed(){return this.isDisposed}dispose(){this.isDisposed||(this.isDisposed=!0,this.items.forEach((e=>{e.dispose()})),this.items.clear())}contains(e){return this.items.has(e)}add(e){this.items.add(e)}remove(e){this.items.delete(e)}clear(){this.items.clear()}}!function(e){e.from=function(t){const n=new e;return t.forEach((e=>{n.add(e)})),n}}(tx||(tx={}));class nx extends class{constructor(){this.listeners={}}on(e,t,n){if(null==t)return this;this.listeners[e]||(this.listeners[e]=[]);return this.listeners[e].push(t,n),this}once(e,t,n){const r=(...i)=>(this.off(e,r),Zb.call([t,n],i));return this.on(e,r,this)}off(e,t,n){if(!(e||t||n))return this.listeners={},this;const r=this.listeners;return(e?[e]:Object.keys(r)).forEach((e=>{const i=r[e];if(i)if(t||n)for(let e=i.length-2;e>=0;e-=2)t&&i[e]!==t||n&&i[e+1]!==n||i.splice(e,2);else delete r[e]})),this}trigger(e,...t){let n=!0;if("*"!==e){const r=this.listeners[e];null!=r&&(n=Zb.call([...r],t))}const r=this.listeners["*"];return null!=r?Dg([n,Zb.call([...r],[e,...t])]):n}emit(e,...t){return this.trigger(e,...t)}}{}!function(e){e.dispose=ex.dispose}(nx||(nx={})),hg(nx,ex);class rx extends nx{get disabled(){return!0===this._disabled}enable(){delete this._disabled}disable(){this._disabled=!0}}var ix,ox,sx,ax,lx,cx=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class ux extends ex{constructor(){super(),this.clear()}clear(){this.map=new WeakMap,this.arr=[]}has(e){return this.map.has(e)}get(e){return this.map.get(e)}set(e,t){this.map.set(e,t),this.arr.push(e)}delete(e){const t=this.arr.indexOf(e);t>=0&&this.arr.splice(t,1);const n=this.map.get(e);return this.map.delete(e),n}each(e){this.arr.forEach((t=>{const n=this.map.get(t);e(n,t)}))}dispose(){this.clear()}}cx([ex.dispose()],ux.prototype,"dispose",null);class hx{constructor(e={}){this.comparator=e.comparator||hx.defaultComparator,this.index={},this.data=e.data||[],this.heapify()}isEmpty(){return 0===this.data.length}insert(e,t,n){const r={priority:e,value:t},i=this.data.length-1;return n&&(r.id=n,this.index[n]=i),this.data.push(r),this.bubbleUp(i),this}peek(){return this.data[0]?this.data[0].value:null}peekPriority(){return this.data[0]?this.data[0].priority:null}updatePriority(e,t){const n=this.index[e];if(void 0===n)throw new Error(`Node with id '${e}' was not found in the heap.`);const r=this.data,i=r[n].priority,o=this.comparator(t,i);o<0?(r[n].priority=t,this.bubbleUp(n)):o>0&&(r[n].priority=t,this.bubbleDown(n))}remove(){const e=this.data,t=e[0],n=e.pop();return delete this.index[e.length],e.length>0&&(e[0]=n,n.id&&(this.index[n.id]=0),this.bubbleDown(0)),t?t.value:null}heapify(){for(let e=0;e<this.data.length;e+=1)this.bubbleUp(e)}bubbleUp(e){const t=this.data;let n,r,i=e;for(;i>0&&(r=i-1>>>1,this.comparator(t[i].priority,t[r].priority)<0);){n=t[r],t[r]=t[i];let e=t[i].id;null!=e&&(this.index[e]=r),t[i]=n,e=t[i].id,null!=e&&(this.index[e]=i),i=r}}bubbleDown(e){const t=this.data,n=t.length-1;let r=e;for(;;){const e=1+(r<<1),i=e+1;let o=r;if(e<=n&&this.comparator(t[e].priority,t[o].priority)<0&&(o=e),i<=n&&this.comparator(t[i].priority,t[o].priority)<0&&(o=i),o===r)break;{const e=t[o];t[o]=t[r];let n=t[r].id;null!=n&&(this.index[n]=o),t[r]=e,n=t[r].id,null!=n&&(this.index[n]=r),r=o}}}}!function(e){e.defaultComparator=(e,t)=>e-t}(hx||(hx={})),function(e){e.run=function(e,t,n=((e,t)=>1)){const r={},i={},o={},s=new hx;for(r[t]=0,Object.keys(e).forEach((e=>{e!==t&&(r[e]=1/0),s.insert(r[e],e,e)}));!s.isEmpty();){const t=s.remove();o[t]=!0;const a=e[t]||[];for(let e=0;e<a.length;e+=1){const l=a[e];if(!o[l]){const e=r[t]+n(t,l);e<r[l]&&(r[l]=e,i[l]=t,s.updatePriority(l,e))}}}return i}}(ix||(ix={})),function(e){e.linear=e=>e,e.quad=e=>e*e,e.cubic=e=>e*e*e,e.inout=e=>{if(e<=0)return 0;if(e>=1)return 1;const t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)},e.exponential=e=>Math.pow(2,10*(e-1)),e.bounce=e=>{for(let t=0,n=1;;t+=n,n/=2)if(e>=(7-4*t)/11){const r=(11-6*t-11*e)/4;return-r*r+n*n}}}(ox||(ox={})),function(e){e.decorators={reverse:e=>t=>1-e(1-t),reflect:e=>t=>.5*(t<.5?e(2*t):2-e(2-2*t)),clamp:(e,t=0,n=1)=>r=>{const i=e(r);return i<t?t:i>n?n:i},back:(e=1.70158)=>t=>t*t*((e+1)*t-e),elastic:(e=1.5)=>t=>Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*e/3*t)}}(ox||(ox={})),function(e){function t(e){const t=e/1;if(t<1/2.75)return 7.5625*t*t;if(t<2/2.75){const e=t-1.5/2.75;return 7.5625*e*e+.75}if(t<2.5/2.75){const e=t-2.25/2.75;return 7.5625*e*e+.9375}{const e=t-2.625/2.75;return 7.5625*e*e+.984375}}function n(e){return 1-t(1-e)}e.easeInSine=function(e){return-1*Math.cos(e*(Math.PI/2))+1},e.easeOutSine=function(e){return Math.sin(e*(Math.PI/2))},e.easeInOutSine=function(e){return-.5*(Math.cos(Math.PI*e)-1)},e.easeInQuad=function(e){return e*e},e.easeOutQuad=function(e){return e*(2-e)},e.easeInOutQuad=function(e){return e<.5?2*e*e:(4-2*e)*e-1},e.easeInCubic=function(e){return e*e*e},e.easeOutCubic=function(e){const t=e-1;return t*t*t+1},e.easeInOutCubic=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},e.easeInQuart=function(e){return e*e*e*e},e.easeOutQuart=function(e){const t=e-1;return 1-t*t*t*t},e.easeInOutQuart=function(e){const t=e-1;return e<.5?8*e*e*e*e:1-8*t*t*t*t},e.easeInQuint=function(e){return e*e*e*e*e},e.easeOutQuint=function(e){const t=e-1;return 1+t*t*t*t*t},e.easeInOutQuint=function(e){const t=e-1;return e<.5?16*e*e*e*e*e:1+16*t*t*t*t*t},e.easeInExpo=function(e){return 0===e?0:Math.pow(2,10*(e-1))},e.easeOutExpo=function(e){return 1===e?1:1-Math.pow(2,-10*e)},e.easeInOutExpo=function(e){if(0===e||1===e)return e;const t=2*e,n=t-1;return t<1?.5*Math.pow(2,10*n):.5*(2-Math.pow(2,-10*n))},e.easeInCirc=function(e){const t=e/1;return-1*(Math.sqrt(1-t*e)-1)},e.easeOutCirc=function(e){const t=e-1;return Math.sqrt(1-t*t)},e.easeInOutCirc=function(e){const t=2*e,n=t-2;return t<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-n*n)+1)},e.easeInBack=function(e,t=1.70158){return e*e*((t+1)*e-t)},e.easeOutBack=function(e,t=1.70158){const n=e/1-1;return n*n*((t+1)*n+t)+1},e.easeInOutBack=function(e,t=1.70158){const n=2*e,r=n-2,i=1.525*t;return n<1?.5*n*n*((i+1)*n-i):.5*(r*r*((i+1)*r+i)+2)},e.easeInElastic=function(e,t=.7){if(0===e||1===e)return e;const n=e/1-1,r=1-t,i=r/(2*Math.PI)*Math.asin(1);return-Math.pow(2,10*n)*Math.sin((n-i)*(2*Math.PI)/r)},e.easeOutElastic=function(e,t=.7){const n=1-t,r=2*e;if(0===e||1===e)return e;const i=n/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*r)*Math.sin((r-i)*(2*Math.PI)/n)+1},e.easeInOutElastic=function(e,t=.65){const n=1-t;if(0===e||1===e)return e;const r=2*e,i=r-1,o=n/(2*Math.PI)*Math.asin(1);return r<1?Math.pow(2,10*i)*Math.sin((i-o)*(2*Math.PI)/n)*-.5:Math.pow(2,-10*i)*Math.sin((i-o)*(2*Math.PI)/n)*.5+1},e.easeOutBounce=t,e.easeInBounce=n,e.easeInOutBounce=function(e){return e<.5?.5*n(2*e):.5*t(2*e-1)+.5}}(ox||(ox={})),function(e){e.number=(e,t)=>{const n=t-e;return t=>e+n*t},e.object=(e,t)=>{const n=Object.keys(e);return r=>{const i={};for(let o=n.length-1;-1!==o;o-=1){const s=n[o];i[s]=e[s]+(t[s]-e[s])*r}return i}},e.unit=(e,t)=>{const n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,r=n.exec(e),i=n.exec(t),o=i?i[1]:"",s=r?+r[1]:0,a=i?+i[1]:0,l=o.indexOf("."),c=l>0?o[1].length-l-1:0,u=a-s,h=r?r[2]:"";return e=>(s+u*e).toFixed(c)+h},e.color=(e,t)=>{const n=parseInt(e.slice(1),16),r=parseInt(t.slice(1),16),i=255&n,o=(255&r)-i,s=65280&n,a=(65280&r)-s,l=16711680&n,c=(16711680&r)-l;return e=>`#${(1<<24|i+o*e&255|s+a*e&65280|l+c*e&16711680).toString(16).slice(1)}`}}(sx||(sx={})),function(e){const t=`${Ob.prefixCls}.storage`;function n(e,t,n){e&&iu((()=>{e(t,n)}))}function r(e,t){localStorage.setItem(e,JSON.stringify(t))}function i(e){const t=localStorage.getItem(e);return t?JSON.parse(t):null}function o(e){const t=i(a(e));return t?(null==t.keys&&(t.keys=[]),t):{keys:[]}}function s(e,n){return`${t}.${e}.docs.${n}`}function a(e){return`${t}.${e}.index`}e.insert=function(e,t,i){const l=t.id||Op("doc-"),c=o(e);c.keys.push(l),r(s(e,l),t),r(a(e),c),n(i,null,Object.assign(Object.assign({},t),{id:l}))},e.find=function(e,t,r){const a=o(e),l=[];if(null==t)a.keys.forEach((t=>{const o=i(s(e,t));o?l.push(o):n(r,new Error(`No document found for an ID '${t}' from index.`))})),n(r,null,l);else if(t.id){const o=i(s(e,t.id));n(r,null,o?[o]:[])}else n(r,null,[])},e.remove=function(e,t,i){const l=o(e);if(null==t)l.keys.forEach((t=>{localStorage.removeItem(s(e,t))})),localStorage.removeItem(a(e)),n(i,null);else if(t.id){const o=l.keys.indexOf(t.id);o>=0&&l.keys.splice(o,1),localStorage.removeItem(s(e,t.id)),r(a(e),l),n(i,null)}}}(ax||(ax={}));class dx extends nx{constructor(){super(),this.cid=lx.uniqueId(),dx.views[this.cid]=this}get priority(){return 2}confirmUpdate(e,t){return 0}$(e){return dx.$(e)}empty(e=this.container){return this.$(e).empty(),this}unmount(e=this.container){return this.$(e).remove(),this}remove(e=this.container){return e===this.container&&(this.removeEventListeners(document),this.onRemove(),delete dx.views[this.cid]),this.unmount(e),this}onRemove(){}setClass(e,t=this.container){t.classList.value=Array.isArray(e)?e.join(" "):e}addClass(e,t=this.container){return this.$(t).addClass(Array.isArray(e)?e.join(" "):e),this}removeClass(e,t=this.container){return this.$(t).removeClass(Array.isArray(e)?e.join(" "):e),this}setStyle(e,t=this.container){return this.$(t).css(e),this}setAttrs(e,t=this.container){return null!=e&&null!=t&&(t instanceof SVGElement?lm(t,e):this.$(t).attr(e)),this}findAttr(e,t=this.container){let n=t;for(;n&&1===n.nodeType;){const t=n.getAttribute(e);if(null!=t)return t;if(n===this.container)return null;n=n.parentNode}return null}find(e,t=this.container,n=this.selectors){return dx.find(e,t,n).elems}findOne(e,t=this.container,n=this.selectors){const r=this.find(e,t,n);return r.length>0?r[0]:null}findByAttr(e,t=this.container){let n=t;for(;n&&n.getAttribute;){const t=n.getAttribute(e);if((null!=t||n===this.container)&&"false"!==t)return n;n=n.parentNode}return null}getSelector(e,t){let n;if(e===this.container)return"string"==typeof t&&(n=`> ${t}`),n;if(e){const r=Kg(e)+1;n=`${e.tagName.toLowerCase()}:nth-child(${r})`,t&&(n+=` > ${t}`),n=this.getSelector(e.parentNode,n)}return n}prefixClassName(e){return Ab.prefix(e)}delegateEvents(e,t){if(null==e)return this;t||this.undelegateEvents();const n=/^(\S+)\s*(.*)$/;return Object.keys(e).forEach((t=>{const r=t.match(n);if(null==r)return;const i=this.getEventHandler(e[t]);"function"==typeof i&&this.delegateEvent(r[1],r[2],i)})),this}undelegateEvents(){return this.$(this.container).off(this.getEventNamespace()),this}delegateDocumentEvents(e,t){return this.addEventListeners(document,e,t),this}undelegateDocumentEvents(){return this.removeEventListeners(document),this}delegateEvent(e,t,n){return this.$(this.container).on(e+this.getEventNamespace(),t,n),this}undelegateEvent(e,t,n){const r=e+this.getEventNamespace();return null==t?this.$(this.container).off(r):"string"==typeof t?this.$(this.container).off(r,t,n):this.$(this.container).off(r,t),this}addEventListeners(e,t,n){if(null==t)return this;const r=this.getEventNamespace(),i=this.$(e);return Object.keys(t).forEach((e=>{const o=this.getEventHandler(t[e]);"function"==typeof o&&i.on(e+r,n,o)})),this}removeEventListeners(e){return null!=e&&this.$(e).off(this.getEventNamespace()),this}getEventNamespace(){return`.${Ob.prefixCls}-event-${this.cid}`}getEventHandler(e){let t;if("string"==typeof e){const n=this[e];"function"==typeof n&&(t=(...e)=>n.call(this,...e))}else t=(...t)=>e.call(this,...t);return t}getEventTarget(e,t={}){const{target:n,type:r,clientX:i=0,clientY:o=0}=e;return t.fromPoint||"touchmove"===r||"touchend"===r?document.elementFromPoint(i,o):n}stopPropagation(e){return this.setEventData(e,{propagationStopped:!0}),this}isPropagationStopped(e){return!0===this.getEventData(e).propagationStopped}getEventData(e){return this.eventData(e)}setEventData(e,t){return this.eventData(e,t)}eventData(e,t){if(null==e)throw new TypeError("Event object required");let n=e.data;const r=`__${this.cid}__`;return null==t?null==n?{}:n[r]||{}:(null==n&&(n=e.data={}),null==n[r]?n[r]=Object.assign({},t):n[r]=Object.assign(Object.assign({},n[r]),t),n[r])}normalizeEvent(e){return dx.normalizeEvent(e)}}!function(e){function t(e){return fr(e)}e.$=t,e.createElement=function(e,t){return t?Xg(e||"g"):$g(e||"div")},e.find=function(e,n,r){if(!e||"."===e)return{elems:[n]};if(r){const t=r[e];if(t)return{elems:Array.isArray(t)?t:[t]}}return{isCSSSelector:!0,elems:t(n).find(e).toArray()}},e.normalizeEvent=function(e){let t=e;const n=e.originalEvent,r=n&&n.changedTouches&&n.changedTouches[0];if(r){for(const t in e)void 0===r[t]&&(r[t]=e[t]);t=r}const i=t.target;if(i){const e=i.correspondingUseElement;e&&(t.target=e)}return t}}(dx||(dx={})),function(e){e.views={},e.getView=function(t){return e.views[t]||null}}(dx||(dx={})),function(e){let t=0;e.uniqueId=function(){const e=`v${t}`;return t+=1,e}}(lx||(lx={}));function fx(e,t){return 0===t?"0%":`${Math.round(e/t*100)}%`}function px(e){return(t,n,r,i)=>n.isEdgeElement(r)?function(e,t,n,r,i){const o=n.getConnection();if(!o)return t;const s=o.closestPointLength(i);if(e){const e=o.length();t.anchor={name:"ratio",args:{ratio:s/e}}}else t.anchor={name:"length",args:{length:s}};return t}(e,t,n,0,i):function(e,t,n,r,i){const o=n.cell,s=o.getAngle(),a=n.getUnrotatedBBoxOfElement(r),l=o.getBBox().getCenter(),c=Tm.create(i).rotate(s,l);let u=c.x-a.x,h=c.y-a.y;e&&(u=fx(u,a.width),h=fx(h,a.height));return t.anchor={name:"topLeft",args:{dx:u,dy:h,rotate:!0}},t}(e,t,n,r,i)}const gx=px(!0),mx=px(!1);var vx,yx,bx=Object.freeze({__proto__:null,noop:e=>e,pinRelative:gx,pinAbsolute:mx});!function(e){e.presets=bx,e.registry=Bv.create({type:"connection strategy"}),e.registry.register(e.presets,!0)}(vx||(vx={}));class xx{constructor(e){this.view=e,this.clean()}clean(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new ux,this.pathCache={}}get(e){return this.elemCache.has(e)||this.elemCache.set(e,{}),this.elemCache.get(e)}getData(e){const t=this.get(e);return t.data||(t.data={}),t.data}getMatrix(e){const t=this.get(e);if(null==t.matrix){const n=this.view.rotatableNode||this.view.container;t.matrix=Ov(e,n)}return mv(t.matrix)}getShape(e){const t=this.get(e);return null==t.shape&&(t.shape=Av(e)),t.shape.clone()}getBoundingRect(e){const t=this.get(e);return null==t.boundingRect&&(t.boundingRect=Sv(e)),t.boundingRect.clone()}}!function(e){function t(e){return null!=e&&"string"==typeof e}function n(e){return`${e}`.trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><")}function r(e,t={ns:Hg.svg}){const n=document.createDocumentFragment(),r={},i={},o=[{markup:Array.isArray(e)?e:[e],parent:n,ns:t.ns}];for(;o.length>0;){const e=o.pop();let t=e.ns||Hg.svg;const n=e.markup,s=e.parent;n.forEach((e=>{const n=e.tagName;if(!n)throw new TypeError("Invalid tagName");e.ns&&(t=e.ns);const a=t===Hg.svg,l=t?$g(n,t):Wg(n),c=e.attrs;c&&(a?lm(l,um(c)):fr(l).attr(c));const u=e.style;u&&fr(l).css(u);const h=e.className;null!=h&&l.setAttribute("class",Array.isArray(h)?h.join(" "):h),e.textContent&&(l.textContent=e.textContent);const d=e.selector;if(null!=d){if(i[d])throw new TypeError("Selector must be unique");i[d]=l}if(e.groupSelector){let t=e.groupSelector;Array.isArray(t)||(t=[t]),t.forEach((e=>{r[e]||(r[e]=[]),r[e].push(l)}))}s.appendChild(l);const f=e.children;Array.isArray(f)&&o.push({ns:t,markup:f,parent:l})}))}return Object.keys(r).forEach((e=>{if(i[e])throw new Error("Ambiguous group selector");i[e]=r[e]})),{fragment:n,selectors:i,groups:r}}function i(e){return e instanceof SVGElement?Xg("g"):Wg("div")}e.isJSONMarkup=function(e){return null!=e&&!t(e)},e.isStringMarkup=t,e.clone=function(e){return null==e||t(e)?e:tc(e)},e.sanitize=n,e.parseStringMarkup=function(e){const t=document.createDocumentFragment();return Eg(n(e),{raw:!0}).forEach((e=>{t.appendChild(e)})),{fragment:t,selectors:{},groups:{}}},e.parseJSONMarkup=r,e.renderMarkup=function(e){if(t(e)){const t=ev.createVectors(e),n=t.length;if(1===n)return{elem:t[0].node};if(n>1){const e=i(t[0].node);return t.forEach((t=>{e.appendChild(t.node)})),{elem:e}}return{}}const n=r(e),o=n.fragment;let s=null;return o.childNodes.length>1?(s=i(o.firstChild),s.appendChild(o)):s=o.firstChild,{elem:s,selectors:n.selectors}},e.parseLabelStringMarkup=function(e){const t=ev.createVectors(e),n=document.createDocumentFragment();for(let e=0,r=t.length;e<r;e+=1){const r=t[e].node;n.appendChild(r)}return{fragment:n,selectors:{}}}}(yx||(yx={})),function(e){function t(e,n,r){if(null!=e){let i;const o=e.tagName.toLowerCase();if(e===n)return i="string"==typeof r?`> ${o} > ${r}`:`> ${o}`,i;const s=e.parentNode;if(s&&s.childNodes.length>1){i=`${o}:nth-child(${Kg(e)+1})`}else i=o;return r&&(i+=` > ${r}`),t(e.parentNode,n,i)}return r}function n(e,n,r){if("#text"===e.nodeName)return null;let i=null,o=null,s=null,a=!1;const l={tagName:e.tagName};if(e.attributes){s={};for(let t=0,n=e.attributes.length;t<n;t+=1){const n=e.attributes[t],r=n.nodeName,a=n.nodeValue;"selector"===r?i=a:"groupSelector"===r?o=a:"class"===r?l.attrs={class:a}:s[r]=a}}return null==i&&(a=!0,i=t(e,n)),e.namespaceURI&&(l.ns=e.namespaceURI),null==l.ns&&(["body","div","section","main","nav","footer","span","p","h1","h2","h3","h4","h5","h6","ul","ol","dl","center","strong","pre","form","select","textarea","fieldset","marquee","bgsound","iframe","frameset"].includes(e.tagName)?l.ns=Hg.xhtml:r&&(l.ns=r)),i&&(l.selector=i),null!=o&&(l.groupSelector=o),{markup:l,attrs:s,isCSSSelector:a}}e.getSelector=t,e.xml2json=function(t){const r=qg(e.sanitize(t),{mimeType:"image/svg+xml"}),i=Array.prototype.slice.call(r.childNodes),o={},s=new WeakMap,a=(e,t,r)=>{const i=n(e,t,r);if(null!=i){const{markup:n,attrs:r,isCSSSelector:l}=i;if(s.set(e,n),n.selector&&null!=r&&(Object.keys(r).length&&(o[n.selector]=r),l&&delete n.selector),e.childNodes&&e.childNodes.length>0)for(let r=0,i=e.childNodes.length;r<i;r+=1){const i=e.childNodes[r],o=a(i,t,n.ns);o&&(null==n.children&&(n.children=[]),n.children.push(o))}return n}{const t=s.get(e.parentNode);t&&e.textContent&&(t.textContent=e.textContent)}};return{markup:i.map((e=>a(e,e))).filter((e=>null!=e)),attrs:o}}}(yx||(yx={})),function(e){e.getPortContainerMarkup=function(){return"g"},e.getPortMarkup=function(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}}},e.getPortLabelMarkup=function(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}}}}(yx||(yx={})),function(e){e.getEdgeMarkup=function(){return e.sanitize('\n    <path class="connection" stroke="black" d="M 0 0 0 0"/>\n    <path class="source-marker" fill="black" stroke="black" d="M 0 0 0 0"/>\n    <path class="target-marker" fill="black" stroke="black" d="M 0 0 0 0"/>\n    <path class="connection-wrap" d="M 0 0 0 0"/>\n    <g class="labels"/>\n    <g class="vertices"/>\n    <g class="arrowheads"/>\n    <g class="tools"/>\n  ')},e.getEdgeToolMarkup=function(){return e.sanitize('\n    <g class="edge-tool">\n      <g class="tool-remove" event="edge:remove">\n        <circle r="11" />\n        <path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z" />\n        <title>Remove edge.</title>\n      </g>\n      <g class="tool-options" event="edge:options">\n        <circle r="11" transform="translate(25)"/>\n        <path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>\n        <title>Edge options.</title>\n      </g>\n    </g>\n  ')},e.getEdgeVertexMarkup=function(){return e.sanitize('\n    <g class="vertex-group" transform="translate(<%= x %>, <%= y %>)">\n      <circle class="vertex" data-index="<%= index %>" r="10" />\n      <path class="vertex-remove-area" data-index="<%= index %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>\n      <path class="vertex-remove" data-index="<%= index %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">\n      <title>Remove vertex.</title>\n      </path>\n    </g>\n  ')},e.getEdgeArrowheadMarkup=function(){return e.sanitize('\n    <g class="arrowhead-group arrowhead-group-<%= end %>">\n      <path class="arrowhead" data-terminal="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />\n    </g>\n  ')}}(yx||(yx={})),function(e){e.getForeignObjectMarkup=function(e=!1){return{tagName:"foreignObject",selector:"fo",children:[{ns:Hg.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:Hg.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:e?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]}}}(yx||(yx={}));class wx{constructor(e){this.view=e}get cell(){return this.view.cell}getDefinition(e){return this.cell.getAttrDefinition(e)}processAttrs(e,t){let n,r,i,o,s;const a=[];return Object.keys(t).forEach((r=>{const i=t[r],o=this.getDefinition(r),s=Tg(cb.isValidDefinition,this.view,o,i,{elem:e,attrs:t,cell:this.cell,view:this.view});if(o&&s)"string"==typeof o?(null==n&&(n={}),n[o]=i):null!==i&&a.push({name:r,definition:o});else{null==n&&(n={});const e=wx.CASE_SENSITIVE_ATTR.includes(r)?r:bg(r);n[e]=i}})),a.forEach((({name:n,definition:a})=>{const l=t[n];"function"==typeof a.set&&(!im(e)&&wx.DELAY_ATTRS.includes(n)?(null==s&&(s={}),s[n]=l):(null==r&&(r={}),r[n]=l));"function"==typeof a.offset&&(null==i&&(i={}),i[n]=l);"function"==typeof a.position&&(null==o&&(o={}),o[n]=l)})),{raw:t,normal:n,set:r,offset:i,position:o,delay:s}}mergeProcessedAttrs(e,t){e.set=Object.assign(Object.assign({},e.set),t.set),e.position=Object.assign(Object.assign({},e.position),t.position),e.offset=Object.assign(Object.assign({},e.offset),t.offset);const n=e.normal&&e.normal.transform;null!=n&&t.normal&&(t.normal.transform=n),e.normal=t.normal}findAttrs(e,t,n,r){const i=[],o=new ux;return Object.keys(e).forEach((s=>{const a=e[s];if(!Ws(a))return;const{isCSSSelector:l,elems:c}=dx.find(s,t,r);n[s]=c;for(let e=0,t=c.length;e<t;e+=1){const n=c[e],u=r&&r[s]===n,h=o.get(n);if(h){h.array||(i.push(n),h.array=!0,h.attrs=[h.attrs],h.priority=[h.priority]);const e=h.attrs,r=h.priority;if(u)e.unshift(a),r.unshift(-1);else{const n=Ff(r,l?-1:t);e.splice(n,0,a),r.splice(n,0,t)}}else o.set(n,{elem:n,attrs:a,priority:u?-1:t,array:!1})}})),i.forEach((e=>{const t=o.get(e),n=t.attrs;t.attrs=n.reduceRight(((e,t)=>rd(e,t)),{})})),o}updateRelativeAttrs(e,t,n,r){const i=t.raw||{};let o=t.normal||{};const s=t.set,a=t.position,l=t.offset,c=t.delay,u=()=>({elem:e,cell:this.cell,view:this.view,attrs:i,refBBox:n.clone()});if(null!=s&&Object.keys(s).forEach((e=>{const t=s[e],n=this.getDefinition(e);if(null!=n){const r=Tg(n.set,this.view,t,u());"object"==typeof r?o=Object.assign(Object.assign({},o),r):null!=r&&(o[e]=r)}})),im(e))return void this.view.setAttrs(o,e);const h=o.transform,d=yv(h?`${h}`:null),f=new Tm(d.e,d.f);h&&(delete o.transform,d.e=0,d.f=0);let p=1,g=1;if(a||l){const t=this.view.getScaleOfElement(e,r.scalableNode);p=t.sx,g=t.sy}let m=!1;null!=a&&Object.keys(a).forEach((e=>{const t=a[e],n=this.getDefinition(e);if(null!=n){const e=Tg(n.position,this.view,t,u());null!=e&&(m=!0,f.translate(Tm.create(e).scale(p,g)))}})),this.view.setAttrs(o,e);let v=!1;if(null!=l){const t=this.view.getBoundingRectOfElement(e);if(t.width>0&&t.height>0){const n=Ev(t,d).scale(1/p,1/g);Object.keys(l).forEach((t=>{const r=l[t],o=this.getDefinition(t);if(null!=o){const t=Tg(o.offset,this.view,r,{elem:e,cell:this.cell,view:this.view,attrs:i,refBBox:n});null!=t&&(v=!0,f.translate(Tm.create(t).scale(p,g)))}}))}}(null!=h||m||v)&&(f.round(1),d.e=f.x,d.f=f.y,e.setAttribute("transform",bv(d)));const y=()=>{null!=c&&Object.keys(c).forEach((t=>{const n=c[t],r=this.getDefinition(t);if(null!=r){const i=Tg(r.set,this.view,n,u());"object"==typeof i?this.view.setAttrs(i,e):null!=i&&this.view.setAttrs({[t]:i},e)}}))};r.forceSync?y():Gv.scheduleTask(y)}update(e,t,n){const r={},i=this.findAttrs(n.attrs||t,e,r,n.selectors),o=n.attrs?this.findAttrs(t,e,r,n.selectors):i,s=[];i.each((t=>{const i=t.elem,a=t.attrs,l=this.processAttrs(i,a);if(null==l.set&&null==l.position&&null==l.offset&&null==l.delay)this.view.setAttrs(l.normal,i);else{const t=o.get(i),c=t?t.attrs:null,u=c&&null==a.ref?c.ref:a.ref;let h;if(u){if(h=(r[u]||this.view.find(u,e,n.selectors))[0],!h)throw new Error(`"${u}" reference does not exist.`)}else h=null;const d={node:i,refNode:h,attributes:c,processedAttributes:l},f=s.findIndex((e=>e.refNode===i));f>-1?s.splice(f,0,d):s.push(d)}}));const a=new ux;let l;s.forEach((t=>{const r=t.node,i=t.refNode;let o;const c=null!=i&&null!=n.rotatableNode&&Qg(n.rotatableNode,i);if(i&&(o=a.get(i)),!o){const t=c?n.rotatableNode:e;o=i?Sv(i,{target:t}):n.rootBBox,i&&a.set(i,o)}let u;n.attrs&&t.attributes?(u=this.processAttrs(r,t.attributes),this.mergeProcessedAttrs(u,t.processedAttributes)):u=t.processedAttributes;let h=o;c&&null!=n.rotatableNode&&!n.rotatableNode.contains(r)&&(l||(l=yv(lm(n.rotatableNode,"transform"))),h=Ev(o,l));const d=s.find((e=>e.refNode===r));d&&(n.forceSync=!0),this.updateRelativeAttrs(r,u,h,n)}))}}!function(e){e.CASE_SENSITIVE_ATTR=["viewBox"],e.DELAY_ATTRS=["text","textWrap","sourceMarker","targetMarker"]}(wx||(wx={}));class Cx{constructor(e,t,n=[]){this.view=e;const r={},i={};let o=0;Object.keys(t).forEach((e=>{let n=t[e];Array.isArray(n)||(n=[n]),n.forEach((t=>{let n=r[t];n||(o+=1,n=r[t]=1<<o),i[e]|=n}))}));let s=n;if(Array.isArray(s)||(s=[s]),s.forEach((e=>{r[e]||(o+=1,r[e]=1<<o)})),o>25)throw new Error("Maximum number of flags exceeded.");this.flags=r,this.attrs=i,this.bootstrap=n}get cell(){return this.view.cell}getFlag(e){const t=this.flags;return null==t?0:Array.isArray(e)?e.reduce(((e,n)=>e|t[n]),0):0|t[e]}hasAction(e,t){return e&this.getFlag(t)}removeAction(e,t){return e^e&this.getFlag(t)}getBootstrapFlag(){return this.getFlag(this.bootstrap)}getChangedFlag(){let e=0;return this.attrs?(Object.keys(this.attrs).forEach((t=>{this.cell.hasChanged(t)&&(e|=this.attrs[t])})),e):e}}var Ex=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class _x extends dx{constructor(e,t={}){super(),this.cell=e,this.options=this.ensureOptions(t),this.graph=this.options.graph,this.attr=new wx(this),this.flag=new Cx(this,this.options.actions,this.options.bootstrap),this.cache=new xx(this),this.setContainer(this.ensureContainer()),this.setup(),this.$(this.container).data("view",this),this.init()}static getDefaults(){return this.defaults}static config(e){this.defaults=this.getOptions(e)}static getOptions(e){const t=(e,t)=>null!=t?_p([...Array.isArray(e)?e:[e],...Array.isArray(t)?t:[t]]):Array.isArray(e)?[...e]:[e],n=tc(this.getDefaults()),{bootstrap:r,actions:i,events:o,documentEvents:s}=e,a=Ex(e,["bootstrap","actions","events","documentEvents"]);return r&&(n.bootstrap=t(n.bootstrap,r)),i&&Object.keys(i).forEach((e=>{const r=i[e],o=n.actions[e];r&&o?n.actions[e]=t(o,r):r&&(n.actions[e]=t(r))})),o&&(n.events=Object.assign(Object.assign({},n.events),o)),e.documentEvents&&(n.documentEvents=Object.assign(Object.assign({},n.documentEvents),s)),rd(n,a)}get[Symbol.toStringTag](){return _x.toStringTag}init(){}onRemove(){this.removeTools()}get priority(){return this.options.priority}get rootSelector(){return this.options.rootSelector}getConstructor(){return this.constructor}ensureOptions(e){return this.getConstructor().getOptions(e)}getContainerTagName(){return this.options.isSvgElement?"g":"div"}getContainerStyle(){}getContainerAttrs(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape}}getContainerClassName(){return this.prefixClassName("cell")}ensureContainer(){return dx.createElement(this.getContainerTagName(),this.options.isSvgElement)}setContainer(e){if(this.container!==e){this.undelegateEvents(),this.container=e,null!=this.options.events&&this.delegateEvents(this.options.events);const t=this.getContainerAttrs();null!=t&&this.setAttrs(t,e);const n=this.getContainerStyle();null!=n&&this.setStyle(n,e);const r=this.getContainerClassName();null!=r&&this.addClass(r,e)}return this}isNodeView(){return!1}isEdgeView(){return!1}render(){return this}confirmUpdate(e,t={}){return 0}getBootstrapFlag(){return this.flag.getBootstrapFlag()}getFlag(e){return this.flag.getFlag(e)}hasAction(e,t){return this.flag.hasAction(e,t)}removeAction(e,t){return this.flag.removeAction(e,t)}handleAction(e,t,n,r){if(this.hasAction(e,t)){n();const i=[t];return r&&("string"==typeof r?i.push(r):i.push(...r)),this.removeAction(e,i)}return e}setup(){this.cell.on("changed",(({options:e})=>this.onAttrsChange(e)))}onAttrsChange(e){let t=this.flag.getChangedFlag();!e.updated&&t&&(e.dirty&&this.hasAction(t,"update")&&(t|=this.getFlag("render")),e.toolId&&(e.async=!1),null!=this.graph&&this.graph.renderer.requestViewUpdate(this,t,this.priority,e))}parseJSONMarkup(e,t){const n=yx.parseJSONMarkup(e),r=n.selectors,i=this.rootSelector;if(t&&i){if(r[i])throw new Error("Invalid root selector");r[i]=t}return n}can(e){let t=this.graph.options.interacting;if("function"==typeof t&&(t=Tg(t,this.graph,this)),"object"==typeof t){let n=t[e];return"function"==typeof n&&(n=Tg(n,this.graph,this)),!1!==n}return"boolean"==typeof t&&t}cleanCache(){return this.cache.clean(),this}getCache(e){return this.cache.get(e)}getDataOfElement(e){return this.cache.getData(e)}getMatrixOfElement(e){return this.cache.getMatrix(e)}getShapeOfElement(e){return this.cache.getShape(e)}getScaleOfElement(e,t){let n,r;if(t&&t.contains(e)){const e=Nv(t);n=1/e.sx,r=1/e.sy}else n=1,r=1;return{sx:n,sy:r}}getBoundingRectOfElement(e){return this.cache.getBoundingRect(e)}getBBoxOfElement(e){const t=this.getBoundingRectOfElement(e),n=this.getMatrixOfElement(e),r=this.getRootRotatedMatrix();return Ev(t,this.getRootTranslatedMatrix().multiply(r).multiply(n))}getUnrotatedBBoxOfElement(e){const t=this.getBoundingRectOfElement(e),n=this.getMatrixOfElement(e);return Ev(t,this.getRootTranslatedMatrix().multiply(n))}getBBox(e={}){let t;if(e.useCellGeometry){const e=this.cell,n=e.isNode()?e.getAngle():0;t=e.getBBox().bbox(n)}else t=this.getBBoxOfElement(this.container);return this.graph.localToGraph(t)}getRootTranslatedMatrix(){const e=this.cell,t=e.isNode()?e.getPosition():{x:0,y:0};return mv().translate(t.x,t.y)}getRootRotatedMatrix(){let e=mv();const t=this.cell,n=t.isNode()?t.getAngle():0;if(n){const r=t.getBBox(),i=r.width/2,o=r.height/2;e=e.translate(i,o).rotate(n).translate(-i,-o)}return e}findMagnet(e=this.container){return this.findByAttr("magnet",e)}updateAttrs(e,t,n={}){null==n.rootBBox&&(n.rootBBox=new Pm),null==n.selectors&&(n.selectors=this.selectors),this.attr.update(e,t,n)}isEdgeElement(e){return this.cell.isEdge()&&(null==e||e===this.container)}prepareHighlight(e,t={}){const n=e&&this.$(e)[0]||this.container;return t.partial=n===this.container,n}highlight(e,t={}){const n=this.prepareHighlight(e,t);return this.notify("cell:highlight",{magnet:n,options:t,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet:n,options:t,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet:n,options:t,view:this,node:this.cell,cell:this.cell}),this}unhighlight(e,t={}){const n=this.prepareHighlight(e,t);return this.notify("cell:unhighlight",{magnet:n,options:t,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet:n,options:t,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet:n,options:t,view:this,edge:this.cell,cell:this.cell}),this}notifyUnhighlight(e,t){}getEdgeTerminal(e,t,n,r,i){const o=this.cell,s=this.findAttr("port",e),a=e.getAttribute("data-selector"),l={cell:o.id};return null!=a&&(l.magnet=a),null!=s?(l.port=s,o.isNode()&&(o.hasPort(s)||null!=a||(l.selector=this.getSelector(e)))):null==a&&this.container!==e&&(l.selector=this.getSelector(e)),this.customizeEdgeTerminal(l,e,t,n,r,i)}customizeEdgeTerminal(e,t,n,r,i,o){const s=i.getStrategy()||this.graph.options.connecting.strategy;if(s){const a="string"==typeof s?s:s.name,l="string"==typeof s?{}:s.args||{},c=vx.registry;if(a){const s=c.get(a);if(null==s)return c.onNotFound(a);const u=Tg(s,this.graph,e,this,t,new Tm(n,r),i,o,l);if(u)return u}}return e}getMagnetFromEdgeTerminal(e){const t=this.cell,n=this.container,r=e.port;let i,o=e.magnet;return null!=r&&t.isNode()&&t.hasPort(r)?i=this.findPortElem(r,o)||n:(o||(o=e.selector),o||null==r||(o=`[port="${r}"]`),i=this.findOne(o,n,this.selectors)),i}animate(e,t){const n="string"==typeof e?this.findOne(e):e;if(null==n)throw new Error("Invalid animation element.");const r=n.parentNode,i=ev.create(n);r||i.appendTo(this.graph.view.stage);const o=t.complete;return t.complete=e=>{r||em(n),o&&o(e)},i.animate(t)}animateTransform(e,t){const n="string"==typeof e?this.findOne(e):e;if(null==n)throw new Error("Invalid animation element.");const r=n.parentNode,i=ev.create(n);r||i.appendTo(this.graph.view.stage);const o=t.complete;return t.complete=e=>{r||em(n),o&&o(e)},i.animateTransform(t)}hasTools(e){const t=this.tools;return null!=t&&(null==e||t.name===e)}addTools(e){if(!this.can("toolsAddable"))return this;if(this.removeTools(),e){const t=Sx.isToolsView(e)?e:new Sx(e);this.tools=t,this.graph.on("tools:hide",this.hideTools,this),this.graph.on("tools:show",this.showTools,this),this.graph.on("tools:remove",this.removeTools,this),t.config({view:this}),t.mount()}return this}updateTools(e={}){return this.tools&&this.tools.update(e),this}removeTools(){return this.tools&&(this.tools.remove(),this.graph.off("tools:hide",this.hideTools,this),this.graph.off("tools:show",this.showTools,this),this.graph.off("tools:remove",this.removeTools,this),this.tools=null),this}hideTools(){return this.tools&&this.tools.hide(),this}showTools(){return this.tools&&this.tools.show(),this}renderTools(){const e=this.cell.getTools();return this.addTools(e),this}notify(e,t){return this.trigger(e,t),this.graph.trigger(e,t),this}getEventArgs(e,t,n){const r=this,i=r.cell;return null==t||null==n?{e:e,view:r,cell:i}:{e:e,x:t,y:n,view:r,cell:i}}onClick(e,t,n){this.notify("cell:click",this.getEventArgs(e,t,n))}onDblClick(e,t,n){this.notify("cell:dblclick",this.getEventArgs(e,t,n))}onContextMenu(e,t,n){this.notify("cell:contextmenu",this.getEventArgs(e,t,n))}onMouseDown(e,t,n){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(e,t,n))}onMouseUp(e,t,n){this.notify("cell:mouseup",this.getEventArgs(e,t,n)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null)}onMouseMove(e,t,n){this.notify("cell:mousemove",this.getEventArgs(e,t,n))}onMouseOver(e){this.notify("cell:mouseover",this.getEventArgs(e))}onMouseOut(e){this.notify("cell:mouseout",this.getEventArgs(e))}onMouseEnter(e){this.notify("cell:mouseenter",this.getEventArgs(e))}onMouseLeave(e){this.notify("cell:mouseleave",this.getEventArgs(e))}onMouseWheel(e,t,n,r){this.notify("cell:mousewheel",Object.assign({delta:r},this.getEventArgs(e,t,n)))}onCustomEvent(e,t,n,r){this.notify("cell:customevent",Object.assign({name:t},this.getEventArgs(e,n,r))),this.notify(t,Object.assign({},this.getEventArgs(e,n,r)))}onMagnetMouseDown(e,t,n,r){}onMagnetDblClick(e,t,n,r){}onMagnetContextMenu(e,t,n,r){}onLabelMouseDown(e,t,n){}checkMouseleave(e){const t=this.graph;t.renderer.isAsync()&&t.renderer.dumpView(this);const n=this.getEventTarget(e,{fromPoint:!0}),r=t.renderer.findViewByElem(n);r!==this&&(this.onMouseLeave(e),r&&r.onMouseEnter(e))}}_x.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}},function(e){e.Flag=Cx,e.Attr=wx}(_x||(_x={})),function(e){e.toStringTag=`X6.${e.name}`,e.isCellView=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.isNodeView&&"function"==typeof r.isEdgeView&&"function"==typeof r.confirmUpdate}}(_x||(_x={})),function(e){e.priority=function(e){return function(t){t.config({priority:e})}},e.bootstrap=function(e){return function(t){t.config({bootstrap:e})}}}(_x||(_x={})),function(e){e.registry=Bv.create({type:"view"})}(_x||(_x={}));class Sx extends dx{constructor(e={}){super(),this.svgContainer=this.createContainer(!0,e),this.htmlContainer=this.createContainer(!1,e),this.config(e)}get name(){return this.options.name}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get[Symbol.toStringTag](){return Sx.toStringTag}createContainer(e,t){const n=e?dx.createElement("g",!0):dx.createElement("div",!1);return Fg(n,this.prefixClassName("cell-tools")),t.className&&Fg(n,t.className),n}config(e){if(this.options=Object.assign(Object.assign({},this.options),e),!_x.isCellView(e.view)||e.view===this.cellView)return this;this.cellView=e.view,this.cell.isEdge()?(Fg(this.svgContainer,this.prefixClassName("edge-tools")),Fg(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(Fg(this.svgContainer,this.prefixClassName("node-tools")),Fg(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name));const t=this.options.items;if(!Array.isArray(t))return this;this.tools=[];const n=[];t.forEach((e=>{if(Sx.ToolItem.isToolItem(e))"vertices"===e.name?n.unshift(e):n.push(e);else{"vertices"===("object"==typeof e?e.name:e)?n.unshift(e):n.push(e)}}));for(let e=0;e<n.length;e+=1){const t=n[e];let r;if(Sx.ToolItem.isToolItem(t))r=t;else{const e="object"==typeof t?t.name:t,n="object"==typeof t&&t.args||{};if(e)if(this.cell.isNode()){const t=zx.registry.get(e);if(!t)return zx.registry.onNotFound(e);r=new t(n)}else if(this.cell.isEdge()){const t=Ux.registry.get(e);if(!t)return Ux.registry.onNotFound(e);r=new t(n)}}if(r){r.config(this.cellView,this),r.render();(!1!==r.options.isSVGElement?this.svgContainer:this.htmlContainer).appendChild(r.container),this.tools.push(r)}}return this}update(e={}){const t=this.tools;return t&&t.forEach((t=>{e.toolId!==t.cid&&t.isVisible()&&t.update()})),this}focus(e){const t=this.tools;return t&&t.forEach((t=>{e===t?t.show():t.hide()})),this}blur(e){const t=this.tools;return t&&t.forEach((t=>{t===e||t.isVisible()||(t.show(),t.update())})),this}hide(){return this.focus(null)}show(){return this.blur(null)}remove(){const e=this.tools;return e&&(e.forEach((e=>e.remove())),this.tools=null),em(this.svgContainer),em(this.htmlContainer),super.remove()}mount(){const e=this.tools,t=this.cellView;if(t&&e){const n=e.some((e=>!1!==e.options.isSVGElement)),r=e.some((e=>!1===e.options.isSVGElement));if(n){(this.options.local?t.container:t.graph.view.decorator).appendChild(this.svgContainer)}r&&this.graph.container.appendChild(this.htmlContainer)}return this}}function Ox(e,t,n,r){return Tg(vx.presets.pinRelative,this.graph,{},t,n,e,this.cell,r,{}).anchor}function Ax(e,t){return t?e.cell.getBBox():e.cell.isEdge()?e.getConnection().bbox():e.getUnrotatedBBoxOfElement(e.container)}!function(e){e.toStringTag=`X6.${e.name}`,e.isToolsView=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&null!=r.graph&&null!=r.cell&&"function"==typeof r.config&&"function"==typeof r.update&&"function"==typeof r.focus&&"function"==typeof r.blur&&"function"==typeof r.show&&"function"==typeof r.hide}}(Sx||(Sx={})),function(e){class t extends dx{constructor(e={}){super(),this.options=this.getOptions(e),this.container=dx.createElement(this.options.tagName||"g",!1!==this.options.isSVGElement),Fg(this.container,this.prefixClassName("cell-tool")),"string"==typeof this.options.className&&Fg(this.container,this.options.className),this.init()}static getDefaults(){return this.defaults}static config(e){this.defaults=this.getOptions(e)}static getOptions(e){return rd(tc(this.getDefaults()),e)}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get name(){return this.options.name}get[Symbol.toStringTag](){return t.toStringTag}init(){}getOptions(e){return this.constructor.getOptions(e)}delegateEvents(){return this.options.events&&super.delegateEvents(this.options.events),this}config(e,t){return this.cellView=e,this.parent=t,this.stamp(this.container),this.cell.isEdge()?Fg(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&Fg(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this}render(){this.empty();const e=this.options.markup;if(e){const t=yx.isStringMarkup(e)?yx.parseStringMarkup(e):yx.parseJSONMarkup(e);this.container.appendChild(t.fragment),this.childNodes=t.selectors}return this.onRender(),this}onRender(){}update(){return this}stamp(e=this.container){e&&e.setAttribute("data-cell-id",this.cellView.cell.id)}show(){return this.container.style.display="",this.visible=!0,this}hide(){return this.container.style.display="none",this.visible=!1,this}isVisible(){return this.visible}focus(){const e=this.options.focusOpacity;return null!=e&&Number.isFinite(e)&&(this.container.style.opacity=`${e}`),this.parent.focus(this),this}blur(){return this.container.style.opacity="",this.parent.blur(this),this}guard(e){return null==this.graph||null==this.cellView||this.graph.view.guard(e,this.cellView)}}t.defaults={isSVGElement:!0,tagName:"g"},e.ToolItem=t,function(e){let t=0;e.define=function(e){const n=pg((r=e.name)?xg(r):(t+=1,`CustomTool${t}`),this);var r;return n.config(e),n}}(t=e.ToolItem||(e.ToolItem={})),function(e){e.toStringTag=`X6.${e.name}`,e.isToolItem=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&null!=r.graph&&null!=r.cell&&"function"==typeof r.config&&"function"==typeof r.update&&"function"==typeof r.focus&&"function"==typeof r.blur&&"function"==typeof r.show&&"function"==typeof r.hide&&"function"==typeof r.isVisible}}(t=e.ToolItem||(e.ToolItem={}))}(Sx||(Sx={}));class kx extends Sx.ToolItem{onRender(){Fg(this.container,this.prefixClassName("cell-tool-button")),this.update()}update(){return this.updatePosition(),this}updatePosition(){const e=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();Tv(this.container,e,{absolute:!0})}getNodeMatrix(){const e=this.cellView,t=this.options;let{x:n=0,y:r=0}=t;const{offset:i,useCellGeometry:o,rotate:s}=t;let a=Ax(e,o);const l=e.cell.getAngle();s||(a=a.bbox(l));let c=0,u=0;"number"==typeof i?(c=i,u=i):"object"==typeof i&&(c=i.x,u=i.y),n=Og(n,a.width),r=Og(r,a.height);let h=mv().translate(a.x+a.width/2,a.y+a.height/2);return s&&(h=h.rotate(l)),h=h.translate(n+c-a.width/2,r+u-a.height/2),h}getEdgeMatrix(){const e=this.cellView,t=this.options,{offset:n=0,distance:r=0,rotate:i}=t;let o,s,a;o=Sg(r)?e.getTangentAtRatio(parseFloat(r)/100):e.getTangentAtLength(r),o?(s=o.start,a=o.vector().vectorAngle(new Tm(1,0))||0):(s=e.getConnection().start,a=0);let l=mv().translate(s.x,s.y).rotate(a);return l="object"==typeof n?l.translate(n.x||0,n.y||0):l.translate(0,n),i||(l=l.rotate(-a)),l}onMouseDown(e){if(this.guard(e))return;e.stopPropagation(),e.preventDefault();const t=this.options.onClick;"function"==typeof t&&Tg(t,this.cellView,{e:e,view:this.cellView,cell:this.cellView.cell,btn:this})}}!function(e){e.config({name:"button",events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}})}(kx||(kx={})),function(e){e.Remove=e.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,onClick({view:e,btn:t}){t.parent.remove(),e.cell.remove({ui:!0,toolId:t.cid})}})}(kx||(kx={}));var Mx=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class Tx extends Sx.ToolItem{onRender(){if(Fg(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs){const e=this.options.attrs,{class:t}=e,n=Mx(e,["class"]);lm(this.container,um(n)),t&&Fg(this.container,t)}this.update()}update(){const e=this.cellView,t=this.options,{useCellGeometry:n,rotate:r}=t,i=kg(t.padding);let o=Ax(e,n).moveAndExpand({x:-i.left,y:-i.top,width:i.left+i.right,height:i.top+i.bottom});const s=e.cell;if(s.isNode()){const e=s.getAngle();if(e)if(r){const t=s.getBBox().getCenter();Dv(this.container,e,t.x,t.y,{absolute:!0})}else o=o.bbox(e)}return lm(this.container,o.toJSON()),this}}!function(e){e.config({name:"boundary",tagName:"rect",padding:10,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}})}(Tx||(Tx={}));class Px extends Sx.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}onRender(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this}update(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this}resetHandles(){const e=this.handles;this.handles=[],e&&e.forEach((e=>{this.stopHandleListening(e),e.remove()}))}renderHandles(){const e=this.vertices;for(let t=0,n=e.length;t<n;t+=1){const n=e[t],r=this.options.createHandle,i=this.options.processHandle,o=r({index:t,graph:this.graph,guard:e=>this.guard(e),attrs:this.options.attrs||{}});i&&i(o),this.graph.hook.onToolItemCreated({name:"vertices",cell:this.cell,view:this.cellView,tool:o}),o.updatePosition(n.x,n.y),this.stamp(o.container),this.container.appendChild(o.container),this.handles.push(o),this.startHandleListening(o)}}updateHandles(){const e=this.vertices;for(let t=0,n=e.length;t<n;t+=1){const n=e[t],r=this.handles[t];r&&r.updatePosition(n.x,n.y)}}updatePath(){const e=this.childNodes.connection;e&&e.setAttribute("d",this.cellView.getConnectionPathData())}startHandleListening(e){const t=this.cellView;t.can("vertexMovable")&&(e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.on("remove",this.onHandleRemove,this)}stopHandleListening(e){const t=this.cellView;t.can("vertexMovable")&&(e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.off("remove",this.onHandleRemove,this)}getNeighborPoints(e){const t=this.cellView,n=this.vertices,r=e>0?n[e-1]:t.sourceAnchor,i=e<n.length-1?n[e+1]:t.targetAnchor;return{prev:Tm.create(r),next:Tm.create(i)}}getMouseEventArgs(e){const t=this.normalizeEvent(e),{x:n,y:r}=this.graph.snapToGrid(t.clientX,t.clientY);return{e:t,x:n,y:r}}onHandleChange({e:e}){this.focus();const t=this.cellView;if(t.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),!this.options.stopPropagation){const{e:n,x:r,y:i}=this.getMouseEventArgs(e);t.notifyMouseDown(n,r,i)}}onHandleChanging({handle:e,e:t}){const n=this.cellView,r=e.options.index,{e:i,x:o,y:s}=this.getMouseEventArgs(t),a={x:o,y:s};this.snapVertex(a,r),n.cell.setVertexAt(r,a,{ui:!0,toolId:this.cid}),e.updatePosition(a.x,a.y),this.options.stopPropagation||n.notifyMouseMove(i,o,s)}onHandleChanged({e:e}){const t=this.options,n=this.cellView;if(t.addable&&this.updatePath(),!t.removeRedundancies)return;n.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),n.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),this.eventData(e).vertexAdded&&n.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid});const{e:r,x:i,y:o}=this.getMouseEventArgs(e);this.options.stopPropagation||n.notifyMouseUp(r,i,o),n.checkMouseleave(r),t.onChanged&&t.onChanged({edge:n.cell,edgeView:n})}snapVertex(e,t){const n=this.options.snapRadius||0;if(n>0){const r=this.getNeighborPoints(t),i=r.prev,o=r.next;Math.abs(e.x-i.x)<n?e.x=i.x:Math.abs(e.x-o.x)<n&&(e.x=o.x),Math.abs(e.y-i.y)<n?e.y=r.prev.y:Math.abs(e.y-o.y)<n&&(e.y=o.y)}}onHandleRemove({handle:e,e:t}){if(this.options.removable){const n=e.options.index,r=this.cellView;r.cell.removeVertexAt(n,{ui:!0}),this.options.addable&&this.updatePath(),r.checkMouseleave(this.normalizeEvent(t))}}onPathMouseDown(e){const t=this.cellView;if(this.guard(e)||!this.options.addable||!t.can("vertexAddable"))return;e.stopPropagation(),e.preventDefault();const n=this.normalizeEvent(e),r=this.graph.snapToGrid(n.clientX,n.clientY).toJSON();t.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid});const i=t.getVertexIndex(r.x,r.y);this.snapVertex(r,i),t.cell.setVertexAt(i,r,{ui:!0,toolId:this.cid}),this.render();const o=this.handles[i];this.eventData(n,{vertexAdded:!0}),o.onMouseDown(n)}onRemove(){this.resetHandles()}}!function(e){e.Handle=class extends dx{constructor(e){super(),this.options=e,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"})}get graph(){return this.options.graph}render(){this.container=dx.createElement("circle",!0);const t=this.options.attrs;if("function"==typeof t){const n=e.getDefaults();this.setAttrs(Object.assign(Object.assign({},n.attrs),t(this)))}else this.setAttrs(t);this.addClass(this.prefixClassName("edge-tool-vertex"))}updatePosition(e,t){this.setAttrs({cx:e,cy:t})}onMouseDown(e){this.options.guard(e)||(e.stopPropagation(),e.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},e.data),this.emit("change",{e:e,handle:this}))}onMouseMove(e){this.emit("changing",{e:e,handle:this})}onMouseUp(e){this.emit("changed",{e:e,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents()}onDoubleClick(e){this.emit("remove",{e:e,handle:this})}}}(Px||(Px={})),function(e){const t=Ab.prefix("edge-tool-vertex-path");e.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:t=>new e.Handle(t),markup:[{tagName:"path",selector:"connection",className:t,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:{[`mousedown .${t}`]:"onPathMouseDown",[`touchstart .${t}`]:"onPathMouseDown"}})}(Px||(Px={}));class Dx extends Sx.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}update(){return this.render(),this}onRender(){Fg(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();const e=this.cellView,t=[...this.vertices];t.unshift(e.sourcePoint),t.push(e.targetPoint);for(let e=0,n=t.length;e<n-1;e+=1){const n=t[e],r=t[e+1],i=this.renderHandle(n,r,e);this.stamp(i.container),this.handles.push(i)}return this}renderHandle(e,t,n){const r=this.options.createHandle({index:n,graph:this.graph,guard:e=>this.guard(e),attrs:this.options.attrs||{}});return this.options.processHandle&&this.options.processHandle(r),this.graph.hook.onToolItemCreated({name:"segments",cell:this.cell,view:this.cellView,tool:r}),this.updateHandle(r,e,t),this.container.appendChild(r.container),this.startHandleListening(r),r}startHandleListening(e){e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this)}stopHandleListening(e){e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this)}resetHandles(){const e=this.handles;this.handles=[],e&&e.forEach((e=>{this.stopHandleListening(e),e.remove()}))}shiftHandleIndexes(e){const t=this.handles;for(let n=0,r=t.length;n<r;n+=1)t[n].options.index+=e}resetAnchor(e,t){const n=this.cellView.cell,r={ui:!0,toolId:this.cid};t?n.prop([e,"anchor"],t,r):n.removeProp([e,"anchor"],r)}snapHandle(e,t,n){const r=e.options.axis,i=e.options.index,o=this.cellView.cell.getVertices(),s=o[i-2]||n.sourceAnchor,a=o[i+1]||n.targetAnchor,l=this.options.snapRadius;return Math.abs(t[r]-s[r])<l?t[r]=s[r]:Math.abs(t[r]-a[r])<l&&(t[r]=a[r]),t}onHandleChanging({handle:e,e:t}){const n=this.graph,r=this.options,i=this.cellView,o=r.anchor,s=e.options.axis,a=e.options.index-1,l=this.getEventData(t),c=this.normalizeEvent(t),u=n.snapToGrid(c.clientX,c.clientY),h=this.snapHandle(e,u.clone(),l),d=tc(this.vertices);let f=d[a],p=d[a+1];const g=i.sourceView,m=i.sourceBBox;let v=!1,y=!1;if(f?0===a?m.containsPoint(f)?(d.shift(),this.shiftHandleIndexes(-1),v=!0):(f[s]=h[s],y=!0):f[s]=h[s]:(f=i.sourceAnchor.toJSON(),f[s]=h[s],m.containsPoint(f)?v=!0:(d.unshift(f),this.shiftHandleIndexes(1),y=!0)),"function"==typeof o&&g){if(v){const e=l.sourceAnchor.clone();e[s]=h[s];const t=Tg(o,i,e,g,i.sourceMagnet||g.container,"source",i,this);this.resetAnchor("source",t)}y&&this.resetAnchor("source",l.sourceAnchorDef)}const b=i.targetView,x=i.targetBBox;let w=!1,C=!1;if(p?a===d.length-2?x.containsPoint(p)?(d.pop(),w=!0):(p[s]=h[s],C=!0):p[s]=h[s]:(p=i.targetAnchor.toJSON(),p[s]=h[s],x.containsPoint(p)?w=!0:(d.push(p),C=!0)),"function"==typeof o&&b){if(w){const e=l.targetAnchor.clone();e[s]=h[s];const t=Tg(o,i,e,b,i.targetMagnet||b.container,"target",i,this);this.resetAnchor("target",t)}C&&this.resetAnchor("target",l.targetAnchorDef)}Tm.equalPoints(d,this.vertices)||this.cellView.cell.setVertices(d,{ui:!0,toolId:this.cid}),this.updateHandle(e,f,p,0),r.stopPropagation||i.notifyMouseMove(c,u.x,u.y)}onHandleChange({handle:e,e:t}){const n=this.options,r=this.handles,i=this.cellView,o=e.options.index;if(Array.isArray(r)){for(let e=0,t=r.length;e<t;e+=1)e!==o&&r[e].hide();if(this.focus(),this.setEventData(t,{sourceAnchor:i.sourceAnchor.clone(),targetAnchor:i.targetAnchor.clone(),sourceAnchorDef:tc(this.cell.prop(["source","anchor"])),targetAnchorDef:tc(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),!n.stopPropagation){const e=this.normalizeEvent(t),n=this.graph.snapToGrid(e.clientX,e.clientY);i.notifyMouseDown(e,n.x,n.y)}}}onHandleChanged({e:e}){const t=this.options,n=this.cellView;t.removeRedundancies&&n.removeRedundantLinearVertices({ui:!0,toolId:this.cid});const r=this.normalizeEvent(e),i=this.graph.snapToGrid(r.clientX,r.clientY);this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),t.stopPropagation||n.notifyMouseUp(r,i.x,i.y),n.checkMouseleave(r),t.onChanged&&t.onChanged({edge:n.cell,edgeView:n})}updateHandle(e,t,n,r=0){const i=this.options.precision||0,o=Math.abs(t.x-n.x)<i,s=Math.abs(t.y-n.y)<i;if(o||s){const i=new Dm(t,n);if(i.length()<this.options.threshold)e.hide();else{const t=i.getCenter(),n=o?"x":"y";t[n]+=r||0;const s=i.vector().vectorAngle(new Tm(1,0));e.updatePosition(t.x,t.y,s,this.cellView),e.show(),e.options.axis=n}}else e.hide()}onRemove(){this.resetHandles()}}!function(e){e.Handle=class extends dx{constructor(e){super(),this.options=e,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"})}render(){this.container=dx.createElement("rect",!0);const t=this.options.attrs;if("function"==typeof t){const n=e.getDefaults();this.setAttrs(Object.assign(Object.assign({},n.attrs),t(this)))}else this.setAttrs(t);this.addClass(this.prefixClassName("edge-tool-segment"))}updatePosition(e,t,n,r){const i=r.getClosestPoint(new Tm(e,t))||new Tm(e,t);let o=mv().translate(i.x,i.y);if(i.equals({x:e,y:t}))o=o.rotate(n);else{let n=new Dm(e,t,i.x,i.y).vector().vectorAngle(new Tm(1,0));0!==n&&(n+=90),o=o.rotate(n)}this.setAttrs({transform:bv(o),cursor:n%180==0?"row-resize":"col-resize"})}onMouseDown(e){this.options.guard(e)||(this.trigger("change",{e:e,handle:this}),e.stopPropagation(),e.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},e.data))}onMouseMove(e){this.emit("changing",{e:e,handle:this})}onMouseUp(e){this.emit("changed",{e:e,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents()}show(){this.container.style.display=""}hide(){this.container.style.display="none"}}}(Dx||(Dx={})),function(e){e.config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:t=>new e.Handle(t),anchor:Ox})}(Dx||(Dx={}));class Nx extends Sx.ToolItem{get type(){return this.options.type}onRender(){Fg(this.container,this.prefixClassName(`edge-tool-${this.type}-anchor`)),this.toggleArea(!1),this.update()}update(){const e=this.type;return this.cellView.getTerminalView(e)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this}updateAnchor(){const e=this.childNodes;if(!e)return;const t=e.anchor;if(!t)return;const n=this.type,r=this.cellView,i=this.options,o=r.getTerminalAnchor(n),s=r.cell.prop([n,"anchor"]);t.setAttribute("transform",`translate(${o.x}, ${o.y})`);const a=s?i.customAnchorAttrs:i.defaultAnchorAttrs;a&&Object.keys(a).forEach((e=>{t.setAttribute(e,a[e])}))}updateArea(){const e=this.childNodes;if(!e)return;const t=e.area;if(!t)return;const n=this.type,r=this.cellView,i=r.getTerminalView(n);if(i){const e=i.cell,o=r.getTerminalMagnet(n);let s,a,l,c=this.options.areaPadding||0;Number.isFinite(c)||(c=0),i.isEdgeElement(o)?(s=i.getBBox(),a=0,l=s.getCenter()):(s=i.getUnrotatedBBoxOfElement(o),a=e.getAngle(),l=s.getCenter(),a&&l.rotate(-a,e.getBBox().getCenter())),s.inflate(c),lm(t,{x:-s.width/2,y:-s.height/2,width:s.width,height:s.height,transform:`translate(${l.x}, ${l.y}) rotate(${a})`})}}toggleArea(e){if(this.childNodes){const t=this.childNodes.area;t&&(t.style.display=e?"":"none")}}onMouseDown(e){this.guard(e)||(e.stopPropagation(),e.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}))}resetAnchor(e){const t=this.type,n=this.cell;e?n.prop([t,"anchor"],e,{rewrite:!0,ui:!0,toolId:this.cid}):n.removeProp([t,"anchor"],{ui:!0,toolId:this.cid})}onMouseMove(e){const t=this.type,n=this.cellView,r=n.getTerminalView(t);if(null==r)return;const i=this.normalizeEvent(e),o=r.cell,s=n.getTerminalMagnet(t);let a=this.graph.clientToLocal(i.clientX,i.clientY);const l=this.options.snap;if("function"==typeof l){const e=Tg(l,n,a,r,s,t,n,this);a=Tm.create(e)}if(this.options.restrictArea)if(r.isEdgeElement(s)){const e=r.getClosestPoint(a);e&&(a=e)}else{const e=r.getUnrotatedBBoxOfElement(s),t=o.getAngle(),n=o.getBBox().getCenter(),i=a.clone().rotate(t,n);e.containsPoint(i)||(a=e.getNearestPointToPoint(i).rotate(-t,n))}let c;const u=this.options.anchor;"function"==typeof u&&(c=Tg(u,n,a,r,s,t,n,this)),this.resetAnchor(c),this.update()}onMouseUp(e){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);const t=this.cellView;this.options.removeRedundancies&&t.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid})}onDblClick(){const e=this.options.resetAnchor;e&&this.resetAnchor(!0===e?void 0:e),this.update()}}!function(e){e.config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:Ox,snap(e,t,n,r,i,o){const s=o.options.snapRadius||0,a="source"===r,l=a?0:-1,c=this.cell.getVertexAt(l)||this.getTerminalAnchor(a?"target":"source");return c&&(Math.abs(c.x-e.x)<s&&(e.x=c.x),Math.abs(c.y-e.y)<s&&(e.y=c.y)),e}})}(Nx||(Nx={}));const Rx=Nx.define({name:"source-anchor",type:"source"}),Ix=Nx.define({name:"target-anchor",type:"target"});var jx=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class Lx extends Sx.ToolItem{get type(){return this.options.type}get ratio(){return this.options.ratio}init(){if(this.options.attrs){const e=this.options.attrs,{class:t}=e,n=jx(e,["class"]);this.setAttrs(n,this.container),t&&Fg(this.container,t)}}onRender(){Fg(this.container,this.prefixClassName(`edge-tool-${this.type}-arrowhead`)),this.update()}update(){const e=this.ratio,t=this.cellView,n=t.getTangentAtRatio(e),r=n?n.start:t.getPointAtRatio(e),i=n&&n.vector().vectorAngle(new Tm(1,0))||0;if(!r)return this;const o=mv().translate(r.x,r.y).rotate(i);return Tv(this.container,o,{absolute:!0}),this}onMouseDown(e){if(this.guard(e))return;e.stopPropagation(),e.preventDefault();const t=this.cellView;if(t.can("arrowheadMovable")){t.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid});const n=this.graph.snapToGrid(e.clientX,e.clientY),r=t.prepareArrowheadDragging(this.type,{x:n.x,y:n.y,options:{toolId:this.cid}});this.cellView.setEventData(e,r),this.delegateDocumentEvents(this.options.documentEvents,e.data),t.graph.view.undelegateEvents(),this.container.style.pointerEvents="none"}this.focus()}onMouseMove(e){const t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY);this.cellView.onMouseMove(t,n.x,n.y),this.update()}onMouseUp(e){this.undelegateDocumentEvents();const t=this.normalizeEvent(e),n=this.cellView,r=this.graph.snapToGrid(t.clientX,t.clientY);n.onMouseUp(t,r.x,r.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",n.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid})}}!function(e){e.config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}})}(Lx||(Lx={}));const Fx=Lx.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),Gx=Lx.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}});class Bx extends Sx.ToolItem{constructor(){super(...arguments),this.labelIndex=-1,this.distance=.5}render(){return this.createElement(),this.update(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents),this}createElement(){const{cell:e}=this,t=[this.prefixClassName((e.isEdge()?"edge":"node")+"-tool-editor"),this.prefixClassName("cell-tool-editor")];this.editor=Sx.createElement("div",!1),this.addClass(t,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor)}update(){const{graph:e,cell:t,editor:n}=this,r=n.style;let i=new Tm,o=20;if(t.isNode())i=t.getBBox().center,o=t.size().width-4;else if(t.isEdge()){const t=this.options.event,n=t.target,r=n.parentElement;if(r&&Lg(r,this.prefixClassName("edge-label"))){const e=r.getAttribute("data-index")||"0";this.labelIndex=parseInt(e,10);const t=r.getAttribute("transform"),{translation:s}=xv(t);i=new Tm(s.tx,s.ty),o=Sv(n).width}else{i=e.clientToLocal(Tm.create(t.clientX,t.clientY));const n=this.cellView.path.closestPointLength(i);this.distance=n}}i=e.localToGraph(i),r.left=`${i.x}px`,r.top=`${i.y}px`,r.minWidth=`${o}px`;const s=e.scale();r.transform=`scale(${s.sx}, ${s.sy}) translate(-50%, -50%)`;const a=this.options.attrs;r.fontSize=`${a.fontSize}px`,r.fontFamily=a.fontFamily,r.color=a.color,r.backgroundColor=a.backgroundColor;const l=this.options.getText;let c;return"function"==typeof l&&(c=Tg(l,this.cellView,{cell:this.cell,index:this.labelIndex})),n.innerText=c||"",this}onDocumentMouseDown(e){if(e.target!==this.editor){const e=this.cell,t=this.editor.innerText.replace(/\n$/,"")||"",n=this.options.setText;"function"==typeof n&&Tg(n,this.cellView,{cell:this.cell,value:t,index:this.labelIndex,distance:this.distance}),e.removeTool(e.isEdge()?"edge-editor":"node-editor"),this.undelegateDocumentEvents()}}onDblClick(e){e.stopPropagation()}onMouseDown(e){e.stopPropagation()}autoFocus(){setTimeout((()=>{this.editor.focus(),this.selectText()}))}selectText(){if(window.getSelection){const e=document.createRange(),t=window.getSelection();e.selectNodeContents(this.editor),t.removeAllRanges(),t.addRange(e)}}}!function(e){e.config({tagName:"div",isSVGElement:!1,events:{dblclick:"onDblClick",mousedown:"onMouseDown"},documentEvents:{mousedown:"onDocumentMouseDown"}})}(Bx||(Bx={})),function(e){e.NodeEditor=e.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText:({cell:e})=>e.attr("text/text"),setText({cell:e,value:t}){e.attr("text/text",t)}}),e.EdgeEditor=e.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText:({cell:e,index:t})=>-1===t?"":e.prop(`labels/${t}/attrs/label/text`),setText({cell:e,value:t,index:n,distance:r}){const i=e;-1===n?i.appendLabel({position:{distance:r},attrs:{label:{text:t}}}):i.prop(`labels/${n}/attrs/label/text`,t)}})}(Bx||(Bx={}));var zx,Ux,Vx=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};!function(e){e.presets={boundary:Tx,button:kx,"button-remove":kx.Remove,"node-editor":Bx.NodeEditor},e.registry=Bv.create({type:"node tool",process(e,t){if("function"==typeof t)return t;let n=Sx.ToolItem;const{inherit:r}=t,i=Vx(t,["inherit"]);if(r){const e=this.get(r);null==e?this.onNotFound(r,"inherited"):n=e}return null==i.name&&(i.name=e),n.define.call(n,i)}}),e.registry.register(e.presets,!0)}(zx||(zx={})),function(e){e.presets={boundary:Tx,vertices:Px,segments:Dx,button:kx,"button-remove":kx.Remove,"source-anchor":Rx,"target-anchor":Ix,"source-arrowhead":Fx,"target-arrowhead":Gx,"edge-editor":Bx.EdgeEditor},e.registry=Bv.create({type:"edge tool",process(e,t){if("function"==typeof t)return t;let n=Sx.ToolItem;const{inherit:r}=t,i=Vx(t,["inherit"]);if(r){const e=this.get(r);null==e?this.onNotFound(r,"inherited"):n=e}return null==i.name&&(i.name=e),n.define.call(n,i)}}),e.registry.register(e.presets,!0)}(Ux||(Ux={}));const Hx=Qx("center"),Wx=Qx("topCenter"),$x=Qx("bottomCenter"),Xx=Qx("leftMiddle"),Yx=Qx("rightMiddle"),qx=Qx("topLeft"),Kx=Qx("topRight"),Zx=Qx("bottomLeft"),Jx=Qx("bottomRight");function Qx(e){return function(t,n,r,i={}){const o=i.rotate?t.getUnrotatedBBoxOfElement(n):t.getBBoxOfElement(n),s=o[e];s.x+=Og(i.dx,o.width),s.y+=Og(i.dy,o.height);const a=t.cell;return i.rotate?s.rotate(-a.getAngle(),a.getBBox().getCenter()):s}}function ew(e){return function(t,n,r,i){if(r instanceof Element){const o=this.graph.renderer.findViewByElem(r);let s;if(o)if(o.isEdgeElement(r)){s=tw(o,null!=i.fixedAt?i.fixedAt:"50%")}else s=o.getBBoxOfElement(r).getCenter();else s=new Tm;return e.call(this,t,n,s,i)}return e.apply(this,arguments)}}function tw(e,t){const n=Sg(t),r="string"==typeof t?parseFloat(t):t;return n?e.getPointAtRatio(r/100):e.getPointAtLength(r)}const nw=ew((function(e,t,n,r){const i=e.cell.getAngle(),o=e.getBBoxOfElement(t),s=o.getCenter(),a=o.getTopLeft(),l=o.getBottomRight();let c=r.padding;if(Number.isFinite(c)||(c=0),a.y+c<=n.y&&n.y<=l.y-c){const e=n.y-s.y;s.x+=0===i||180===i?0:1*e/Math.tan(Cm.toRad(i)),s.y+=e}else if(a.x+c<=n.x&&n.x<=l.x-c){const e=n.x-s.x;s.y+=90===i||270===i?0:e*Math.tan(Cm.toRad(i)),s.x+=e}return s})),rw=ew((function(e,t,n,r){let i,o,s=0;const a=e.cell;r.rotate?(i=e.getUnrotatedBBoxOfElement(t),o=a.getBBox().getCenter(),s=a.getAngle()):i=e.getBBoxOfElement(t);const l=r.padding;null!=l&&Number.isFinite(l)&&i.inflate(l),r.rotate&&n.rotate(s,o);const c=i.getNearestSideToPoint(n);let u;switch(c){case"left":u=i.getLeftMiddle();break;case"right":u=i.getRightMiddle();break;case"top":u=i.getTopCenter();break;case"bottom":u=i.getBottomCenter()}const h=r.direction;return"H"===h?"top"!==c&&"bottom"!==c||(u=n.x<=i.x+i.width?i.getLeftMiddle():i.getRightMiddle()):"V"===h&&(u=n.y<=i.y+i.height?i.getTopCenter():i.getBottomCenter()),r.rotate?u.rotate(-s,o):u}));var iw,ow=Object.freeze({__proto__:null,center:Hx,top:Wx,bottom:$x,left:Xx,right:Yx,topLeft:qx,topRight:Kx,bottomLeft:Zx,bottomRight:Jx,orth:nw,nodeCenter:function(e,t,n,r,i){const o=e.cell.getConnectionPoint(this.cell,i);return(r.dx||r.dy)&&o.translate(r.dx||0,r.dy||0),o},midSide:rw});!function(e){e.presets=ow,e.registry=Bv.create({type:"node endpoint"}),e.registry.register(e.presets,!0)}(iw||(iw={}));const sw=function(e,t,n,r){const i=e.getClosestPoint(n);return null!=i?i:new Tm},aw=ew(sw),lw=ew((function(e,t,n,r){const i=1e6,o=e.getConnection(),s=e.getConnectionSubdivisions(),a=new Dm(n.clone().translate(0,i),n.clone().translate(0,-i)),l=new Dm(n.clone().translate(i,0),n.clone().translate(-i,0)),c=a.intersect(o,{segmentSubdivisions:s}),u=l.intersect(o,{segmentSubdivisions:s}),h=[];return c&&h.push(...c),u&&h.push(...u),h.length>0?n.closest(h):null!=r.fallbackAt?tw(e,r.fallbackAt):Tg(sw,this,e,t,n,r)}));var cw,uw=Object.freeze({__proto__:null,closest:aw,ratio:function(e,t,n,r){let i=null!=r.ratio?r.ratio:.5;return i>1&&(i/=100),e.getPointAtRatio(i)},length:function(e,t,n,r){const i=null!=r.length?r.length:20;return e.getPointAtLength(i)},orth:lw});function hw(e,t,n){let r;if("object"==typeof n){if(Number.isFinite(n.y)){const r=new Dm(t,e),{start:i,end:o}=r.parallel(n.y);t=i,e=o}r=n.x}else r=n;if(null==r||!Number.isFinite(r))return e;const i=e.distance(t);return 0===r&&i>0?e:e.move(t,-Math.min(r,i-1))}function dw(e){const t=e.getAttribute("stroke-width");return null===t?0:parseFloat(t)||0}!function(e){e.presets=uw,e.registry=Bv.create({type:"edge endpoint"}),e.registry.register(e.presets,!0)}(cw||(cw={}));const fw=function(e,t,n,r){const i=t.getBBoxOfElement(n);r.stroked&&i.inflate(dw(n)/2);const o=e.intersect(i);return hw(o&&o.length?e.start.closest(o):e.end,e.start,r.offset)};var pw,gw=Object.freeze({__proto__:null,bbox:fw,rect:function(e,t,n,r,i){const o=t.cell,s=o.isNode()?o.getAngle():0;if(0===s)return Tg(fw,this,e,t,n,r,i);const a=t.getUnrotatedBBoxOfElement(n);r.stroked&&a.inflate(dw(n)/2);const l=a.getCenter(),c=e.clone().rotate(s,l),u=c.setLength(1e6).intersect(a);return hw(u&&u.length?c.start.closest(u).rotate(-s,l):e.end,e.start,r.offset)},boundary:function(e,t,n,r){let i,o;const s=e.end,a=r.selector;if(i="string"==typeof a?t.findOne(a):Array.isArray(a)?gg(n,a):function(e){if(null==e)return null;let t=e;do{let e=t.tagName;if("string"!=typeof e)return null;if(e=e.toUpperCase(),"G"===e)t=t.firstElementChild;else{if("TITLE"!==e)break;t=t.nextElementSibling}}while(t);return t}(n),!Vg(i)){if(i===n||!Vg(n))return s;i=n}const l=t.getShapeOfElement(i),c=t.getMatrixOfElement(i),u=t.getRootTranslatedMatrix(),h=t.getRootRotatedMatrix(),d=u.multiply(h).multiply(c),f=function(e,t){return new Dm(Cv(e.start,t),Cv(e.end,t))}(e,d.inverse()),p=f.start.clone(),g=t.getDataOfElement(i);if(!1===r.insideout){null==g.shapeBBox&&(g.shapeBBox=l.bbox());const e=g.shapeBBox;if(null!=e&&e.containsPoint(p))return s}let m;if(!0===r.extrapolate&&f.setLength(1e6),Qm.isPath(l)){const e=r.precision||2;null==g.segmentSubdivisions&&(g.segmentSubdivisions=l.getSegmentSubdivisions({precision:e})),m={precision:e,segmentSubdivisions:g.segmentSubdivisions},o=f.intersect(l,m)}else o=f.intersect(l);o?Array.isArray(o)&&(o=p.closest(o)):!0===r.sticky&&(o=Pm.isRectangle(l)?l.getNearestPointToPoint(p):Nm.isEllipse(l)?l.intersectsWithLineFromCenterToPoint(p):l.closestPoint(p,m));const v=o?Cv(o,d):s;let y=r.offset||0;return!1!==r.stroked&&("object"==typeof y?(y=Object.assign({},y),null==y.x&&(y.x=0),y.x+=dw(i)/2):y+=dw(i)/2),hw(v,e.start,y)},anchor:function(e,t,n,r){const{alignOffset:i,align:o}=r;return o&&function(e,t,n=0){const{start:r,end:i}=e;let o,s,a,l;switch(t){case"left":l="x",o=i,s=r,a=-1;break;case"right":l="x",o=r,s=i,a=1;break;case"top":l="y",o=i,s=r,a=-1;break;case"bottom":l="y",o=r,s=i,a=1;break;default:return}r[l]<i[l]?o[l]=s[l]:s[l]=o[l],Number.isFinite(n)&&(o[l]+=a*n,s[l]+=a*n)}(e,o,i),hw(e.end,e.start,r.offset)}});!function(e){e.presets=gw,e.registry=Bv.create({type:"connection point"}),e.registry.register(e.presets,!0)}(pw||(pw={}));function mw(e){return new Pm(e.x,e.y,0,0)}function vw(e={}){const t=kg(e.padding||20);return{x:-t.left,y:-t.top,width:t.left+t.right,height:t.top+t.bottom}}function yw(e,t={}){return e.sourceBBox.clone().moveAndExpand(vw(t))}function bw(e,t={}){return e.targetBBox.clone().moveAndExpand(vw(t))}const xw=function(e,t,n){let r=yw(n,t),i=bw(n,t);const o=function(e,t={}){return e.sourceAnchor?e.sourceAnchor:yw(e,t).getCenter()}(n,t),s=function(e,t={}){return e.targetAnchor?e.targetAnchor:bw(e,t).getCenter()}(n,t);r=r.union(mw(o)),i=i.union(mw(s));const a=e.map((e=>Tm.create(e)));a.unshift(o),a.push(s);let l=null;const c=[];for(let e=0,n=a.length-1;e<n;e+=1){let o=null;const s=a[e],u=a[e+1],h=null!=ww.getBearing(s,u);if(0===e)e+1===n?r.intersectsWithRect(i.clone().inflate(1))?o=ww.insideNode(s,u,r,i):h||(o=ww.nodeToNode(s,u,r,i)):r.containsPoint(u)?o=ww.insideNode(s,u,r,mw(u).moveAndExpand(vw(t))):h||(o=ww.nodeToVertex(s,u,r));else if(e+1===n){const e=h&&ww.getBearing(u,s)===l;i.containsPoint(s)||e?o=ww.insideNode(s,u,mw(s).moveAndExpand(vw(t)),i,l):h||(o=ww.vertexToNode(s,u,i,l))}else h||(o=ww.vertexToVertex(s,u,l));o?(c.push(...o.points),l=o.direction):l=ww.getBearing(s,u),e+1<n&&c.push(u)}return c};var ww;!function(e){const t={N:"S",S:"N",E:"W",W:"E"},n={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function r(e,t,n){let r=new Tm(e.x,t.y);return n.containsPoint(r)&&(r=new Tm(t.x,e.y)),r}function i(e,t){return e["W"===t||"E"===t?"width":"height"]}function o(e,t){return e.x===t.x?e.y>t.y?"N":"S":e.y===t.y?e.x>t.x?"W":"E":null}function s(e,n,r){const i=new Tm(e.x,n.y),s=new Tm(n.x,e.y),a=o(e,i),l=o(e,s),c=r?t[r]:null,u=a===r||a!==c&&(l===c||l!==r)?i:s;return{points:[u],direction:o(u,n)}}function a(e,t,n){const i=r(e,t,n);return{points:[i],direction:o(i,t)}}e.getBBoxSize=i,e.getBearing=o,e.vertexToVertex=s,e.nodeToVertex=a,e.vertexToNode=function(e,t,n,s){const a=[new Tm(e.x,t.y),new Tm(t.x,e.y)],l=a.filter((e=>!n.containsPoint(e))),c=l.filter((t=>o(t,e)!==s));let u;if(c.length>0)return u=c.filter((t=>o(e,t)===s)).pop(),u=u||c[0],{points:[u],direction:o(u,t)};{u=lu(a,l)[0];const c=Tm.create(t).move(u,-i(n,s)/2);return{points:[r(c,e,n),c],direction:o(c,t)}}},e.nodeToNode=function(e,t,n,r){let l=a(t,e,r);const c=l.points[0];if(n.containsPoint(c)){l=a(e,t,n);const u=l.points[0];if(r.containsPoint(u)){const h=Tm.create(e).move(u,-i(n,o(e,u))/2),d=Tm.create(t).move(c,-i(r,o(t,c))/2),f=new Dm(h,d).getCenter(),p=a(e,f,n),g=s(f,t,p.direction);l.points=[p.points[0],g.points[0]],l.direction=g.direction}}return l},e.insideNode=function(e,t,i,s,a){const l=i.union(s).inflate(1),c=l.getCenter(),u=c.distance(t)>c.distance(e),h=u?t:e,d=u?e:t;let f,p,g,m;return a?(f=Tm.fromPolar(l.width+l.height,n[a],h),f=l.getNearestPointToPoint(f).move(f,-1)):f=l.getNearestPointToPoint(h).move(h,1),p=r(f,d,l),f.round().equals(p.round())?(p=Tm.fromPolar(l.width+l.height,Cm.toRad(f.theta(h))+Math.PI/2,d),p=l.getNearestPointToPoint(p).move(d,1).round(),g=r(f,p,l),m=u?[p,g,f]:[f,g,p]):m=u?[p,f]:[f,p],{points:m,direction:o(u?f:p,t)}}}(ww||(ww={}));const Cw={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeShapes:[],excludeHiddenNodes:!1,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost(){return Ew(this.step,this)},directions(){const e=Ew(this.step,this),t=Ew(this.cost,this);return[{cost:t,offsetX:e,offsetY:0},{cost:t,offsetX:0,offsetY:e},{cost:t,offsetX:-e,offsetY:0},{cost:t,offsetX:0,offsetY:-e}]},penalties(){const e=Ew(this.step,this);return{0:0,45:e/2,90:e/2}},paddingBox(){const e=Ew(this.step,this);return{x:-e,y:-e,width:2*e,height:2*e}},fallbackRouter:xw,draggingRouter:null};function Ew(e,t){return"function"==typeof e?e.call(t):e}class _w{constructor(){this.items=[],this.hash={},this.values={}}add(e,t){this.hash[e]?this.items.splice(this.items.indexOf(e),1):this.hash[e]=1,this.values[e]=t;const n=Gf(this.items,e,(e=>this.values[e]));this.items.splice(n,0,e)}pop(){const e=this.items.shift();return e&&(this.hash[e]=2),e}isOpen(e){return 1===this.hash[e]}isClose(e){return 2===this.hash[e]}isEmpty(){return 0===this.items.length}}class Sw{constructor(e){this.options=e,this.mapGridSize=100,this.map={}}build(e,t){const n=this.options,r=n.excludeTerminals.reduce(((n,r)=>{const i=t[r];if(i){const t=e.getCell(i.cell);t&&n.push(t)}return n}),[]);let i=[];const o=e.getCell(t.getSourceCellId());o&&(i=wp(i,o.getAncestors().map((e=>e.id))));const s=e.getCell(t.getTargetCellId());s&&(i=wp(i,s.getAncestors().map((e=>e.id))));const a=this.mapGridSize;return e.getNodes().reduce(((e,t)=>{const o=t.shape,s=n.excludeShapes,l=!!o&&s.includes(o),c=r.some((e=>e.id===t.id)),u=i.includes(t.id),h=n.excludeHiddenNodes&&!t.isVisible();if(!(l||c||u||h)){const r=t.getBBox().moveAndExpand(n.paddingBox),i=r.getOrigin().snapToGrid(a),o=r.getCorner().snapToGrid(a);for(let t=i.x;t<=o.x;t+=a)for(let n=i.y;n<=o.y;n+=a){const i=new Tm(t,n).toString();null==e[i]&&(e[i]=[]),e[i].push(r)}}return e}),this.map),this}isAccessible(e){const t=e.clone().snapToGrid(this.mapGridSize).toString(),n=this.map[t];return!n||n.every((t=>!t.containsPoint(e)))}}function Ow(e,t){const n=e.sourceBBox.clone();return t&&t.paddingBox?n.moveAndExpand(t.paddingBox):n}function Aw(e,t){const n=e.targetBBox.clone();return t&&t.paddingBox?n.moveAndExpand(t.paddingBox):n}function kw(e,t){if(e.sourceAnchor)return e.sourceAnchor;return Ow(e,t).getCenter()}function Mw(e,t,n,r,i){const o=360/n,s=e.theta(function(e,t,n,r){const i=r.step,o=t.x-e.x,s=t.y-e.y,a=o/n.x,l=s/n.y,c=a*i,u=l*i;return new Tm(e.x+c,e.y+u)}(e,t,r,i)),a=Cm.normalize(s+o/2);return o*Math.floor(a/o)}function Tw(e,t){const n=Math.abs(e-t);return n>180?360-n:n}function Pw(e,t){if(!e)return t;const n=Math.abs(e),r=Math.round(n/t);if(!r)return n;return t+(n-r*t)/r}function Dw(e,t){return e.round(t)}function Nw(e,t,n){return Dw(function(e,t){const n=t.source,r=Ab.snapToGrid(e.x-n.x,t.x)+n.x,i=Ab.snapToGrid(e.y-n.y,t.y)+n.y;return new Tm(r,i)}(e.clone(),t),n)}function Rw(e){return e.toString()}function Iw(e){return new Tm(0===e.x?0:Math.abs(e.x)/e.x,0===e.y?0:Math.abs(e.y)/e.y)}function jw(e,t){let n=1/0;for(let r=0,i=t.length;r<i;r+=1){const i=e.manhattanDistance(t[r]);i<n&&(n=i)}return n}function Lw(e,t,n,r,i){const o=i.precision,s=i.directionMap,a=e.diff(t.getCenter()),l=Object.keys(s).reduce(((i,l)=>{if(n.includes(l)){const n=s[l],c=new Tm(e.x+n.x*(Math.abs(a.x)+t.width),e.y+n.y*(Math.abs(a.y)+t.height)),u=new Dm(e,c).intersect(t)||[];let h,d=null;for(let t=0;t<u.length;t+=1){const n=u[t],r=e.squaredDistance(n);(null==h||r>h)&&(h=r,d=n)}if(d){let e=Nw(d,r,o);t.containsPoint(e)&&(e=Nw(e.translate(n.x*r.x,n.y*r.y),r,o)),i.push(e)}}return i}),[]);return t.containsPoint(e)||l.push(Nw(e,r,o)),l}function Fw(e,t,n,r,i){const o=[];let s,a=Iw(i.diff(n)),l=Rw(n),c=e[l];for(;c;){s=t[l];const n=Iw(s.diff(c));n.equals(a)||(o.unshift(s),a=n),l=Rw(c),c=e[l]}const u=t[l];return Iw(u.diff(r)).equals(a)||o.unshift(u),o}function Gw(e,t,n,r,i){const o=i.precision;let s,a;s=Pm.isRectangle(t)?Dw(kw(e,i).clone(),o):Dw(t.clone(),o),a=Pm.isRectangle(n)?Dw(function(e,t){return e.targetAnchor?e.targetAnchor:Aw(e,t).getCenter()}(e,i).clone(),o):Dw(n.clone(),o);const l=function(e,t,n){return{source:t.clone(),x:Pw(n.x-t.x,e),y:Pw(n.y-t.y,e)}}(i.step,s,a),c=s,u=a;let h,d;if(h=Pm.isRectangle(t)?Lw(c,t,i.startDirections,l,i):[c],d=Pm.isRectangle(n)?Lw(a,n,i.endDirections,l,i):[u],h=h.filter((e=>r.isAccessible(e))),d=d.filter((e=>r.isAccessible(e))),h.length>0&&d.length>0){const e=new _w,t={},n={},s={};for(let n=0,r=h.length;n<r;n+=1){const r=h[n],i=Rw(r);e.add(i,jw(r,d)),t[i]=r,s[i]=0}const a=i.previousDirectionAngle,f=void 0===a;let p,g;const m=function(e,t){const n=t.step;return t.directions.forEach((t=>{t.gridOffsetX=t.offsetX/n*e.x,t.gridOffsetY=t.offsetY/n*e.y})),t.directions}(l,i),v=m.length,y=d.reduce(((e,t)=>{const n=Rw(t);return e.push(n),e}),[]),b=Tm.equalPoints(h,d);let x=i.maxLoopCount;for(;!e.isEmpty()&&x>0;){const h=e.pop(),w=t[h],C=n[h],E=s[h],_=w.equals(c),S=null==C;let O;O=S?f?_?null:Mw(c,w,v,l,i):a:Mw(C,w,v,l,i);if(!(S&&b)&&y.indexOf(h)>=0)return i.previousDirectionAngle=O,Fw(n,t,w,c,u);for(let a=0;a<v;a+=1){p=m[a];const c=p.angle;if(g=Tw(O,c),(!f||!_)&&g>i.maxDirectionChange)continue;const h=Nw(w.clone().translate(p.gridOffsetX||0,p.gridOffsetY||0),l,o),b=Rw(h);if(e.isClose(b)||!r.isAccessible(h))continue;if(y.indexOf(b)>=0){if(!h.equals(u)){if(Tw(c,Mw(h,u,v,l,i))>i.maxDirectionChange)continue}}const x=E+p.cost+(_?0:i.penalties[g]);(!e.isOpen(b)||x<s[b])&&(t[b]=h,n[b]=w,s[b]=x,e.add(b,x+jw(h,d)))}x-=1}}return i.fallbackRoute?Tg(i.fallbackRoute,this,c,u,i):null}const Bw=function(e,t,n){const r=function(e){const t=Object.keys(e).reduce(((t,n)=>(t[n]="fallbackRouter"===n||"draggingRouter"===n||"fallbackRoute"===n?e[n]:Ew(e[n],e),t)),{});if(t.padding){const n=kg(t.padding);e.paddingBox={x:-n.left,y:-n.top,width:n.left+n.right,height:n.top+n.bottom}}return t.directions.forEach((e=>{const t=new Tm(0,0),n=new Tm(e.offsetX,e.offsetY);e.angle=Cm.normalize(t.theta(n))})),t}(t),i=Ow(n,r),o=Aw(n,r),s=kw(n,r),a=new Sw(r).build(n.graph.model,n.cell),l=e.map((e=>Tm.create(e))),c=[];let u,h,d=s;for(let t=0,f=l.length;t<=f;t+=1){let f=null;if(u=h||i,h=l[t],null==h){h=o;const e=n.cell;if((null==e.getSourceCellId()||null==e.getTargetCellId())&&"function"==typeof r.draggingRouter){const e=u===i?s:u,t=h.getOrigin();f=Tg(r.draggingRouter,n,e,t,r)}}if(null==f&&(f=Gw(n,u,h,a,r)),null===f)return Tg(r.fallbackRouter,this,e,r,n);const p=f[0];p&&p.equals(d)&&f.shift(),d=f[f.length-1]||d,c.push(...f)}return c},zw=function(e,t,n){return Tg(Bw,this,e,Object.assign(Object.assign({},Cw),t),n)},Uw={maxDirectionChange:45,directions(){const e=Ew(this.step,this),t=Ew(this.cost,this),n=Math.ceil(Math.sqrt(e*e<<1));return[{cost:t,offsetX:e,offsetY:0},{cost:n,offsetX:e,offsetY:e},{cost:t,offsetX:0,offsetY:e},{cost:n,offsetX:-e,offsetY:e},{cost:t,offsetX:-e,offsetY:0},{cost:n,offsetX:-e,offsetY:-e},{cost:t,offsetX:0,offsetY:-e},{cost:n,offsetX:e,offsetY:-e}]},fallbackRoute(e,t,n){const r=e.theta(t),i=[];let o={x:t.x,y:e.y},s={x:e.x,y:t.y};if(r%180>90){const e=o;o=s,s=e}const a=r%90<45?o:s,l=new Dm(e,a),c=90*Math.ceil(r/90),u=Tm.fromPolar(l.squaredLength(),Cm.toRad(c+135),a),h=new Dm(t,u),d=l.intersectsWithLine(h),f=d||t,p=d?f:e,g=360/n.directions.length,m=p.theta(t),v=Cm.normalize(m+g/2),y=g*Math.floor(v/g);return n.previousDirectionAngle=y,f&&i.push(f.round()),i.push(t),i}};function Vw(e,t){if(null!=t&&!1!==t){const n="boolean"==typeof t?0:t;if(n>0){const t=Tm.create(e[1]).move(e[2],n),r=Tm.create(e[1]).move(e[0],n);return[t.toJSON(),...e,r.toJSON()]}{const t=e[1];return[Object.assign({},t),...e,Object.assign({},t)]}}return e}var Hw,Ww=Object.freeze({__proto__:null,normal:function(e){return[...e]},oneSide:function(e,t,n){const r=t.side||"bottom",i=kg(t.padding||40),o=n.sourceBBox,s=n.targetBBox,a=o.getCenter(),l=s.getCenter();let c,u,h;switch(r){case"top":h=-1,c="y",u="height";break;case"left":h=-1,c="x",u="width";break;case"right":h=1,c="x",u="width";break;default:h=1,c="y",u="height"}return a[c]+=h*(o[u]/2+i[r]),l[c]+=h*(s[u]/2+i[r]),h*(a[c]-l[c])>0?l[c]=a[c]:a[c]=l[c],[a.toJSON(),...e,l.toJSON()]},orth:xw,metro:function(e,t,n){return Tg(zw,this,e,Object.assign(Object.assign({},Uw),t),n)},manhattan:zw,er:function(e,t,n){const r=t.offset||32,i=null==t.min?16:t.min;let o=0,s=t.direction;const a=n.sourceBBox,l=n.targetBBox,c=a.getCenter(),u=l.getCenter();if("number"==typeof r&&(o=r),null==s){let e=l.left-a.right,t=l.top-a.bottom;e>=0&&t>=0?s=e>=t?"L":"T":e<=0&&t>=0?(e=a.left-l.right,s=e>=0&&e>=t?"R":"T"):e>=0&&t<=0?(t=a.top-l.bottom,s=t>=0?e>=t?"L":"B":"L"):(e=a.left-l.right,t=a.top-l.bottom,s=e>=0&&t>=0?e>=t?"R":"B":e<=0&&t>=0?"B":e>=0&&t<=0||Math.abs(e)>Math.abs(t)?"R":"B")}let h,d,f;"H"===s?s=u.x-c.x>=0?"L":"R":"V"===s&&(s=u.y-c.y>=0?"T":"B"),"center"===r&&("L"===s?o=(l.left-a.right)/2:"R"===s?o=(a.left-l.right)/2:"T"===s?o=(l.top-a.bottom)/2:"B"===s&&(o=(a.top-l.bottom)/2));const p="L"===s||"R"===s;if(p){if(u.y===c.y)return[...e];f="L"===s?1:-1,h="x",d="width"}else{if(u.x===c.x)return[...e];f="T"===s?1:-1,h="y",d="height"}const g=c.clone(),m=u.clone();if(g[h]+=f*(a[d]/2+o),m[h]-=f*(l[d]/2+o),p){const e=g.x,t=m.x,n=a.width/2+i,r=l.width/2+i;u.x>c.x?t<=e&&(g.x=Math.max(t,c.x+n),m.x=Math.min(e,u.x-r)):t>=e&&(g.x=Math.min(t,c.x-n),m.x=Math.max(e,u.x+r))}else{const e=g.y,t=m.y,n=a.height/2+i,r=l.height/2+i;u.y>c.y?t<=e&&(g.y=Math.max(t,c.y+n),m.y=Math.min(e,u.y-r)):t>=e&&(g.y=Math.min(t,c.y-n),m.y=Math.max(e,u.y+r))}return[g.toJSON(),...e,m.toJSON()]},loop:function(e,t,n){const r=t.width||50,i=(t.height||80)/2,o=t.angle||"auto",s=n.sourceAnchor,a=n.targetAnchor,l=n.sourceBBox,c=n.targetBBox;if(s.equals(a)){const e=e=>{const t=Cm.toRad(e),n=Math.sin(t),o=Math.cos(t),a=new Tm(s.x+o*r,s.y+n*r),l=new Tm(a.x-o*i,a.y-n*i),c=l.clone().rotate(-90,a),u=l.clone().rotate(90,a);return[c.toJSON(),a.toJSON(),u.toJSON()]},n=e=>{const t=s.clone().move(e,-1),n=new Dm(t,e);return!l.containsPoint(e)&&!l.intersectsWithLine(n)},a=[0,90,180,270,45,135,225,315];if("number"==typeof o)return Vw(e(o),t.merge);const c=l.getCenter();if(c.equals(s))return Vw(e(0),t.merge);const u=c.angleBetween(s,c.clone().translate(1,0));let h=e(u);if(n(h[1]))return Vw(h,t.merge);for(let r=1,i=a.length;r<i;r+=1)if(h=e(u+a[r]),n(h[1]))return Vw(h,t.merge);return Vw(h,t.merge)}{const e=new Dm(s,a);let o=e.parallel(-r),u=o.getCenter(),h=o.start.clone().move(o.end,i),d=o.end.clone().move(o.start,i);const f=e.parallel(-1),p=new Dm(f.start,u),g=new Dm(f.end,u);if((l.containsPoint(u)||c.containsPoint(u)||l.intersectsWithLine(p)||l.intersectsWithLine(g)||c.intersectsWithLine(p)||c.intersectsWithLine(g))&&(o=e.parallel(r),u=o.getCenter(),h=o.start.clone().move(o.end,i),d=o.end.clone().move(o.start,i)),t.merge){const e=new Dm(s,a),t=new Dm(u,e.center).setLength(Number.MAX_SAFE_INTEGER),r=l.intersectsWithLine(t),i=c.intersectsWithLine(t),o=r?Array.isArray(r)?r:[r]:[];i&&(Array.isArray(i)?o.push(...i):o.push(i));const h=e.center.closest(o);h?(n.sourceAnchor=h.clone(),n.targetAnchor=h.clone()):(n.sourceAnchor=e.center.clone(),n.targetAnchor=e.center.clone())}return Vw([h.toJSON(),u.toJSON(),d.toJSON()],t.merge)}}});!function(e){e.presets=Ww,e.registry=Bv.create({type:"router"}),e.registry.register(e.presets,!0)}(Hw||(Hw={}));const $w=1/3,Xw=2/3;function Yw(e,t,n=[]){const r=[e,...n,t],i=[];return r.forEach(((e,t)=>{const n=r[t+1];null!=n&&i.push(new Dm(e,n))})),i}function qw(e,t){return new Dm(e,t).squaredLength()}function Kw(e,t,n,r){const i=new Qm;let o;return o=Qm.createSegment("M",e[0].start),i.appendSegment(o),e.forEach(((s,a)=>{if(Zw.includes(s)){let e,r,a,l;if("arc"===n){e=-90,r=s.start.diff(s.end);(r.x<0||0===r.x&&r.y<0)&&(e+=180);const t=s.getCenter(),n=new Dm(t,s.end).rotate(e,t);let c;c=new Dm(s.start,t),a=c.pointAt(2/3).rotate(e,s.start),l=n.pointAt(1/3).rotate(-e,n.end),o=Qm.createSegment("C",a,l,n.end),i.appendSegment(o),c=new Dm(t,s.end),a=n.pointAt(1/3).rotate(e,n.end),l=c.pointAt(1/3).rotate(-e,s.end),o=Qm.createSegment("C",a,l,s.end),i.appendSegment(o)}else if("gap"===n)o=Qm.createSegment("M",s.end),i.appendSegment(o);else if("cubic"===n){e=s.start.theta(s.end);const n=.6*t;let c=1.35*t;r=s.start.diff(s.end);(r.x<0||0===r.x&&r.y<0)&&(c*=-1),a=new Tm(s.start.x+n,s.start.y+c).rotate(e,s.start),l=new Tm(s.end.x-n,s.end.y+c).rotate(e,s.end),o=Qm.createSegment("C",a,l,s.end),i.appendSegment(o)}}else{const t=e[a+1];0===r||!t||Zw.includes(t)?(o=Qm.createSegment("L",s.end),i.appendSegment(o)):function(e,t,n,r,i){const o=n.distance(r)/2,s=n.distance(i)/2,a=-Math.min(e,o),l=-Math.min(e,s),c=n.clone().move(r,a).round(),u=n.clone().move(i,l).round(),h=new Tm($w*c.x+Xw*n.x,Xw*n.y+$w*c.y),d=new Tm($w*u.x+Xw*n.x,Xw*n.y+$w*u.y);let f;f=Qm.createSegment("L",c),t.appendSegment(f),f=Qm.createSegment("C",h,d,u),t.appendSegment(f)}(r,i,s.end,s.start,t.end)}})),i}let Zw,Jw;var Qw,eC=Object.freeze({__proto__:null,normal:function(e,t,n,r={}){const i=[e,...n,t],o=new Rm(i),s=new Qm(o);return r.raw?s:s.serialize()},loop:function(e,t,n,r={}){const i=3===n.length?0:1,o=Tm.create(n[0+i]),s=Tm.create(n[2+i]),a=Tm.create(n[1+i]);if(!Tm.equals(e,t)){const n=new Tm((e.x+t.x)/2,(e.y+t.y)/2),r=n.angleBetween(Tm.create(e).rotate(90,n),a);r>1&&(o.rotate(180-r,n),s.rotate(180-r,n),a.rotate(180-r,n))}const l=`\n     M ${e.x} ${e.y}\n     Q ${o.x} ${o.y} ${a.x} ${a.y}\n     Q ${s.x} ${s.y} ${t.x} ${t.y}\n  `;return r.raw?Qm.parse(l):l},rounded:function(e,t,n,r={}){const i=new Qm;i.appendSegment(Qm.createSegment("M",e));const o=1/3,s=2/3,a=r.radius||10;let l,c;for(let r=0,u=n.length;r<u;r+=1){const u=Tm.create(n[r]),h=n[r-1]||e,d=n[r+1]||t;l=c||u.distance(h)/2,c=u.distance(d)/2;const f=-Math.min(a,l),p=-Math.min(a,c),g=u.clone().move(h,f).round(),m=u.clone().move(d,p).round(),v=new Tm(o*g.x+s*u.x,s*u.y+o*g.y),y=new Tm(o*m.x+s*u.x,s*u.y+o*m.y);i.appendSegment(Qm.createSegment("L",g)),i.appendSegment(Qm.createSegment("C",v,y,m))}return i.appendSegment(Qm.createSegment("L",t)),r.raw?i:i.serialize()},smooth:function(e,t,n,r={}){let i,o=r.direction;if(n&&0!==n.length){const r=[e,...n,t],o=Im.throughPoints(r);i=new Qm(o)}else if(i=new Qm,i.appendSegment(Qm.createSegment("M",e)),o||(o=Math.abs(e.x-t.x)>=Math.abs(e.y-t.y)?"H":"V"),"H"===o){const n=(e.x+t.x)/2;i.appendSegment(Qm.createSegment("C",n,e.y,n,t.y,t.x,t.y))}else{const n=(e.y+t.y)/2;i.appendSegment(Qm.createSegment("C",e.x,n,t.x,n,t.x,t.y))}return r.raw?i:i.serialize()},jumpover:function(e,t,n,r={}){Zw=[],Jw=[],function(e){let t=e.graph._jumpOverUpdateList;if(null==t&&(t=e.graph._jumpOverUpdateList=[],e.graph.on("cell:mouseup",(()=>{const t=e.graph._jumpOverUpdateList;for(let e=0;e<t.length;e+=1)t[e].update()})),e.graph.on("model:reseted",(()=>{t=e.graph._jumpOverUpdateList=[]}))),t.indexOf(e)<0){t.push(e);const n=()=>t.splice(t.indexOf(e),1);e.cell.once("change:connector",n),e.cell.once("removed",n)}}(this);const i=r.size||5,o=r.type||"arc",s=r.radius||0,a=r.ignoreConnectors||["smooth"],l=this.graph,c=l.model.getEdges();if(1===c.length)return Kw(Yw(e,t,n),i,o,s);const u=this.cell,h=c.indexOf(u),d=l.options.connecting.connector||{},f=c.filter(((e,t)=>{const n=e.getConnector()||d;return!a.includes(n.name)&&(!(t>h)||"jumpover"!==n.name)})),p=f.map((e=>l.renderer.findViewByCell(e))),g=Yw(e,t,n),m=p.map((e=>null==e?[]:e===this?g:Yw(e.sourcePoint,e.targetPoint,e.routePoints))),v=[];g.forEach((e=>{const t=f.reduce(((t,n,r)=>{if(n!==u){const n=function(e,t){const n=[];return t.forEach((t=>{const r=e.intersectsWithLine(t);r&&n.push(r)})),n}(e,m[r]);t.push(...n)}return t}),[]).sort(((t,n)=>qw(e.start,t)-qw(e.start,n)));t.length>0?v.push(...function(e,t,n){return t.reduce(((r,i,o)=>{if(Jw.includes(i))return r;const s=r.pop()||e,a=Tm.create(i).move(s.start,-n);let l=Tm.create(i).move(s.start,+n);const c=t[o+1];if(null!=c){const e=l.distance(c);e<=n&&(l=c.move(s.start,e),Jw.push(c))}else if(a.distance(s.end)<2*n+1)return r.push(s),r;if(l.distance(s.start)<2*n+1)return r.push(s),r;const u=new Dm(a,l);return Zw.push(u),r.push(new Dm(s.start,a),u,new Dm(l,s.end)),r}),[])}(e,t,i)):v.push(e)}));const y=Kw(v,i,o,s);return Zw=[],Jw=[],r.raw?y:y.serialize()}});!function(e){e.presets=eC,e.registry=Bv.create({type:"connector"}),e.registry.register(e.presets,!0)}(Qw||(Qw={}));const tC=Bv.create;class nC{constructor(e){this.cell=e,this.ids={},this.cache={}}get(){return Object.keys(this.ids)}start(e,t,n={},r="/"){const i=this.cell.getPropByPath(e),o=Yc(n,nC.defaultOptions),s=this.getTiming(o.timing),a=this.getInterp(o.interp,i,t);let l=0;const c=Array.isArray(e)?e.join(r):e,u=Array.isArray(e)?e:e.split(r),h=()=>{const e=(new Date).getTime();0===l&&(l=e);let t=(e-l)/o.duration;t<1?this.ids[c]=bm(h):t=1;const r=a(s(t));this.cell.setPropByPath(u,r),n.progress&&n.progress(Object.assign({progress:t,currentValue:r},this.getArgs(c))),1===t&&(this.cell.notify("transition:end",this.getArgs(c)),this.cell.notify("transition:complete",this.getArgs(c)),n.complete&&n.complete(this.getArgs(c)),this.cell.notify("transition:finish",this.getArgs(c)),n.finish&&n.finish(this.getArgs(c)),this.clean(c))};return setTimeout((()=>{this.stop(e,void 0,r),this.cache[c]={startValue:i,targetValue:t,options:o},this.ids[c]=bm(h),this.cell.notify("transition:begin",this.getArgs(c)),this.cell.notify("transition:start",this.getArgs(c)),n.start&&n.start(this.getArgs(c))}),n.delay),this.stop.bind(this,e,r,n)}stop(e,t={},n="/"){const r=Array.isArray(e)?e:e.split(n);return Object.keys(this.ids).filter((e=>jh(r,e.split(n).slice(0,r.length)))).forEach((e=>{xm(this.ids[e]);const n=this.cache[e],r=this.getArgs(e),i=Object.assign(Object.assign({},n.options),t),o=i.jumpedToEnd;o&&null!=n.targetValue&&(this.cell.setPropByPath(e,n.targetValue),this.cell.notify("transition:end",Object.assign({},r)),this.cell.notify("transition:complete",Object.assign({},r)),i.complete&&i.complete(Object.assign({},r)));const s=Object.assign({jumpedToEnd:o},r);this.cell.notify("transition:stop",Object.assign({},s)),i.stop&&i.stop(Object.assign({},s)),this.cell.notify("transition:finish",Object.assign({},r)),i.finish&&i.finish(Object.assign({},r)),this.clean(e)})),this}clean(e){delete this.ids[e],delete this.cache[e]}getTiming(e){return"string"==typeof e?ox[e]:e}getInterp(e,t,n){return e?e(t,n):"number"==typeof n?sx.number(t,n):"string"==typeof n?"#"===n[0]?sx.color(t,n):sx.unit(t,n):sx.object(t,n)}getArgs(e){const t=this.cache[e];return{path:e,startValue:t.startValue,targetValue:t.targetValue,cell:this.cell}}}!function(e){e.defaultOptions={delay:10,duration:100,timing:"linear"}}(nC||(nC={}));var rC=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class iC extends nx{constructor(e={}){super(),this.pending=!1,this.changing=!1,this.data={},this.mutate(tc(e)),this.changed={}}mutate(e,t={}){const n=!0===t.unset,r=!0===t.silent,i=[],o=this.changing;this.changing=!0,o||(this.previous=tc(this.data),this.changed={});const s=this.data,a=this.previous,l=this.changed;if(Object.keys(e).forEach((t=>{const r=t,o=e[r];jh(s[r],o)||i.push(r),jh(a[r],o)?delete l[r]:l[r]=o,n?delete s[r]:s[r]=o})),!r&&i.length>0&&(this.pending=!0,this.pendingOptions=t,i.forEach((e=>{this.emit("change:*",{key:e,options:t,store:this,current:s[e],previous:a[e]})}))),o)return this;if(!r)for(;this.pending;)this.pending=!1,this.emit("changed",{current:s,previous:a,store:this,options:this.pendingOptions});return this.pending=!1,this.changing=!1,this.pendingOptions=null,this}get(e,t){if(null==e)return this.data;const n=this.data[e];return null==n?t:n}getPrevious(e){if(this.previous){const t=this.previous[e];return null==t?void 0:t}}set(e,t,n){return null!=e&&("object"==typeof e?this.mutate(e,t):this.mutate({[e]:t},n)),this}remove(e,t){const n=void 0,r={};let i;if("string"==typeof e)r[e]=n,i=t;else if(Array.isArray(e))e.forEach((e=>r[e]=n)),i=t;else{for(const e in this.data)r[e]=n;i=e}return this.mutate(r,Object.assign(Object.assign({},i),{unset:!0})),this}getByPath(e){return gg(this.data,e,"/")}setByPath(e,t,n={}){const r="/",i=Array.isArray(e)?[...e]:e.split(r),o=Array.isArray(e)?e.join(r):e,s=i[0],a=i.length;if(n.propertyPath=o,n.propertyValue=t,n.propertyPathArray=i,1===a)this.set(s,t,n);else{const o={};let l=o,c=s;for(let e=1;e<a;e+=1){const t=i[e],n=Number.isFinite(Number(t));l=l[c]=n?[]:{},c=t}mg(o,i,t,r);const u=tc(this.data);n.rewrite&&vg(u,e,r);const h=rd(u,o);this.set(s,h[s],n)}return this}removeByPath(e,t){const n=Array.isArray(e)?e:e.split("/"),r=n[0];if(1===n.length)this.remove(r,t);else{const e=n.slice(1),i=tc(this.get(r));i&&vg(i,e),this.set(r,i,t)}return this}hasChanged(e){return null==e?Object.keys(this.changed).length>0:e in this.changed}getChanges(e){if(null==e)return this.hasChanged()?tc(this.changed):null;const t=this.changing?this.previous:this.data,n={};let r;for(const i in e){const o=e[i];jh(t[i],o)||(n[i]=o,r=!0)}return r?tc(n):null}toJSON(){return tc(this.data)}clone(){return new(0,this.constructor)(this.data)}dispose(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this})}}rC([nx.dispose()],iC.prototype,"dispose",null);var oC,sC=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},aC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class lC extends nx{constructor(e={}){super();const t=this.constructor.getDefaults(!0),n=rd({},this.preprocess(t),this.preprocess(e));this.id=n.id||Cg(),this.store=new iC(n),this.animation=new nC(this),this.setup(),this.init(),this.postprocess(e)}static config(e){const{markup:t,propHooks:n,attrHooks:r}=e,i=aC(e,["markup","propHooks","attrHooks"]);null!=t&&(this.markup=t),n&&(this.propHooks=this.propHooks.slice(),Array.isArray(n)?this.propHooks.push(...n):"function"==typeof n?this.propHooks.push(n):Object.keys(n).forEach((e=>{const t=n[e];"function"==typeof t&&this.propHooks.push(t)}))),r&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),r)),this.defaults=rd({},this.defaults,i)}static getMarkup(){return this.markup}static getDefaults(e){return e?this.defaults:tc(this.defaults)}static getAttrHooks(){return this.attrHooks}static applyPropHooks(e,t){return this.propHooks.reduce(((t,n)=>n?Tg(n,e,t):t),t)}get[Symbol.toStringTag](){return lC.toStringTag}init(){}get model(){return this._model}set model(e){this._model!==e&&(this._model=e)}preprocess(e,t){const n=e.id,r=this.constructor.applyPropHooks(this,e);return null==n&&!0!==t&&(r.id=Cg()),r}postprocess(e){}setup(){this.store.on("change:*",(e=>{const{key:t,current:n,previous:r,options:i}=e;this.notify("change:*",{key:t,options:i,current:n,previous:r,cell:this}),this.notify(`change:${t}`,{options:i,current:n,previous:r,cell:this});const o=t;"source"!==o&&"target"!==o||this.notify("change:terminal",{type:o,current:n,previous:r,options:i,cell:this})})),this.store.on("changed",(({options:e})=>this.notify("changed",{options:e,cell:this})))}notify(e,t){this.trigger(e,t);const n=this.model;return n&&(n.notify(`cell:${e}`,t),this.isNode()?n.notify(`node:${e}`,Object.assign(Object.assign({},t),{node:this})):this.isEdge()&&n.notify(`edge:${e}`,Object.assign(Object.assign({},t),{edge:this}))),this}isNode(){return!1}isEdge(){return!1}isSameStore(e){return this.store===e.store}get view(){return this.store.get("view")}get shape(){return this.store.get("shape","")}getProp(e,t){return null==e?this.store.get():this.store.get(e,t)}setProp(e,t,n){if("string"==typeof e)this.store.set(e,t,n);else{const n=this.preprocess(e,!0);this.store.set(rd({},this.getProp(),n),t),this.postprocess(e)}return this}removeProp(e,t){return"string"==typeof e||Array.isArray(e)?this.store.removeByPath(e,t):this.store.remove(t),this}hasChanged(e){return null==e?this.store.hasChanged():this.store.hasChanged(e)}getPropByPath(e){return this.store.getByPath(e)}setPropByPath(e,t,n={}){return this.model&&("children"===e?this._children=t?t.map((e=>this.model.getCell(e))).filter((e=>null!=e)):null:"parent"===e&&(this._parent=t?this.model.getCell(t):null)),this.store.setByPath(e,t,n),this}removePropByPath(e,t={}){const n=Array.isArray(e)?e:e.split("/");return"attrs"===n[0]&&(t.dirty=!0),this.store.removeByPath(n,t),this}prop(e,t,n){return null==e?this.getProp():"string"==typeof e||Array.isArray(e)?1===arguments.length?this.getPropByPath(e):null==t?this.removePropByPath(e,n||{}):this.setPropByPath(e,t,n||{}):this.setProp(e,t||{})}previous(e){return this.store.getPrevious(e)}get zIndex(){return this.getZIndex()}set zIndex(e){null==e?this.removeZIndex():this.setZIndex(e)}getZIndex(){return this.store.get("zIndex")}setZIndex(e,t={}){return this.store.set("zIndex",e,t),this}removeZIndex(e={}){return this.store.remove("zIndex",e),this}toFront(e={}){const t=this.model;if(t){let n,r=t.getMaxZIndex();e.deep?(n=this.getDescendants({deep:!0,breadthFirst:!0}),n.unshift(this)):n=[this],r=r-n.length+1;const i=t.total();let o=t.indexOf(this)!==i-n.length;o||(o=n.some(((e,t)=>e.getZIndex()!==r+t))),o&&this.batchUpdate("to-front",(()=>{r+=n.length,n.forEach(((t,n)=>{t.setZIndex(r+n,e)}))}))}return this}toBack(e={}){const t=this.model;if(t){let n,r=t.getMinZIndex();e.deep?(n=this.getDescendants({deep:!0,breadthFirst:!0}),n.unshift(this)):n=[this];let i=0!==t.indexOf(this);i||(i=n.some(((e,t)=>e.getZIndex()!==r+t))),i&&this.batchUpdate("to-back",(()=>{r-=n.length,n.forEach(((t,n)=>{t.setZIndex(r+n,e)}))}))}return this}get markup(){return this.getMarkup()}set markup(e){null==e?this.removeMarkup():this.setMarkup(e)}getMarkup(){let e=this.store.get("markup");if(null==e){e=this.constructor.getMarkup()}return e}setMarkup(e,t={}){return this.store.set("markup",e,t),this}removeMarkup(e={}){return this.store.remove("markup",e),this}get attrs(){return this.getAttrs()}set attrs(e){null==e?this.removeAttrs():this.setAttrs(e)}getAttrs(){const e=this.store.get("attrs");return e?Object.assign({},e):{}}setAttrs(e,t={}){if(null==e)this.removeAttrs(t);else{const n=e=>this.store.set("attrs",e,t);if(!0===t.overwrite)n(e);else{const r=this.getAttrs();!1===t.deep?n(Object.assign(Object.assign({},r),e)):n(rd({},r,e))}}return this}replaceAttrs(e,t={}){return this.setAttrs(e,Object.assign(Object.assign({},t),{overwrite:!0}))}updateAttrs(e,t={}){return this.setAttrs(e,Object.assign(Object.assign({},t),{deep:!1}))}removeAttrs(e={}){return this.store.remove("attrs",e),this}getAttrDefinition(e){if(!e)return null;const t=this.constructor.getAttrHooks()||{};let n=t[e]||cb.registry.get(e);if(!n){const r=qa(e);n=t[r]||cb.registry.get(r)}return n||null}getAttrByPath(e){return null==e||""===e?this.getAttrs():this.getPropByPath(this.prefixAttrPath(e))}setAttrByPath(e,t,n={}){return this.setPropByPath(this.prefixAttrPath(e),t,n),this}removeAttrByPath(e,t={}){return this.removePropByPath(this.prefixAttrPath(e),t),this}prefixAttrPath(e){return Array.isArray(e)?["attrs"].concat(e):`attrs/${e}`}attr(e,t,n){return null==e?this.getAttrByPath():"string"==typeof e||Array.isArray(e)?1===arguments.length?this.getAttrByPath(e):null==t?this.removeAttrByPath(e,n||{}):this.setAttrByPath(e,t,n||{}):this.setAttrs(e,t||{})}get visible(){return this.isVisible()}set visible(e){this.setVisible(e)}setVisible(e,t={}){return this.store.set("visible",e,t),this}isVisible(){return!1!==this.store.get("visible")}show(e={}){return this.isVisible()||this.setVisible(!0,e),this}hide(e={}){return this.isVisible()&&this.setVisible(!1,e),this}toggleVisible(e,t={}){const n="boolean"==typeof e?t:e;return("boolean"==typeof e?e:!this.isVisible())?this.show(n):this.hide(n),this}get data(){return this.getData()}set data(e){this.setData(e)}getData(){return this.store.get("data")}setData(e,t={}){if(null==e)this.removeData(t);else{const n=e=>this.store.set("data",e,t);if(!0===t.overwrite)n(e);else{const r=this.getData();!1===t.deep?n("object"==typeof e?Object.assign(Object.assign({},r),e):e):n(rd({},r,e))}}return this}replaceData(e,t={}){return this.setData(e,Object.assign(Object.assign({},t),{overwrite:!0}))}updateData(e,t={}){return this.setData(e,Object.assign(Object.assign({},t),{deep:!1}))}removeData(e={}){return this.store.remove("data",e),this}get parent(){return this.getParent()}get children(){return this.getChildren()}getParentId(){return this.store.get("parent")}getParent(){let e=this._parent;if(null==e&&this.store){const t=this.getParentId();null!=t&&this.model&&(e=this.model.getCell(t),this._parent=e)}return e}getChildren(){let e=this._children;if(null==e){const t=this.store.get("children");t&&t.length&&this.model&&(e=t.map((e=>{var t;return null===(t=this.model)||void 0===t?void 0:t.getCell(e)})).filter((e=>null!=e)),this._children=e)}return e?[...e]:null}hasParent(){return null!=this.parent}isParentOf(e){return null!=e&&e.getParent()===this}isChildOf(e){return null!=e&&this.getParent()===e}eachChild(e,t){return this.children&&this.children.forEach(e,t),this}filterChild(e,t){return this.children?this.children.filter(e,t):[]}getChildCount(){return null==this.children?0:this.children.length}getChildIndex(e){return null==this.children?-1:this.children.indexOf(e)}getChildAt(e){return null!=this.children&&e>=0?this.children[e]:null}getAncestors(e={}){const t=[];let n=this.getParent();for(;n;)t.push(n),n=!1!==e.deep?n.getParent():null;return t}getDescendants(e={}){if(!1!==e.deep){if(e.breadthFirst){const e=[],t=this.getChildren()||[];for(;t.length>0;){const n=t.shift(),r=n.getChildren();e.push(n),r&&t.push(...r)}return e}{const t=this.getChildren()||[];return t.forEach((n=>{t.push(...n.getDescendants(e))})),t}}return this.getChildren()||[]}isDescendantOf(e,t={}){if(null==e)return!1;if(!1!==t.deep){let t=this.getParent();for(;t;){if(t===e)return!0;t=t.getParent()}return!1}return this.isChildOf(e)}isAncestorOf(e,t={}){return null!=e&&e.isDescendantOf(this,t)}contains(e){return this.isAncestorOf(e)}getCommonAncestor(...e){return lC.getCommonAncestor(this,...e)}setParent(e,t={}){return this._parent=e,e?this.store.set("parent",e.id,t):this.store.remove("parent",t),this}setChildren(e,t={}){return this._children=e,null!=e?this.store.set("children",e.map((e=>e.id)),t):this.store.remove("children",t),this}unembed(e,t={}){const n=this.children;if(null!=n&&null!=e){const r=this.getChildIndex(e);-1!==r&&(n.splice(r,1),e.setParent(null,t),this.setChildren(n,t))}return this}embed(e,t={}){return e.addTo(this,t),this}addTo(e,t={}){return lC.isCell(e)?e.addChild(this,t):e.addCell(this,t),this}insertTo(e,t,n={}){return e.insertChild(this,t,n),this}addChild(e,t={}){return this.insertChild(e,void 0,t)}insertChild(e,t,n={}){if(null!=e&&e!==this){const r=e.getParent(),i=this!==r;let o=t;if(null==o&&(o=this.getChildCount(),i||(o-=1)),r){const t=r.getChildren();if(t){const i=t.indexOf(e);i>=0&&(e.setParent(null,n),t.splice(i,1),r.setChildren(t,n))}}let s=this.children;if(null==s?(s=[],s.push(e)):s.splice(o,0,e),e.setParent(this,n),this.setChildren(s,n),i&&this.model){const e=this.model.getIncomingEdges(this),t=this.model.getOutgoingEdges(this);e&&e.forEach((e=>e.updateParent(n))),t&&t.forEach((e=>e.updateParent(n)))}this.model&&this.model.addCell(e,n)}return this}removeFromParent(e={}){const t=this.getParent();if(null!=t){const n=t.getChildIndex(this);t.removeChildAt(n,e)}return this}removeChild(e,t={}){const n=this.getChildIndex(e);return this.removeChildAt(n,t)}removeChildAt(e,t={}){const n=this.getChildAt(e);return null!=this.children&&null!=n&&(this.unembed(n,t),n.remove(t)),n}remove(e={}){return this.batchUpdate("remove",(()=>{const t=this.getParent();t&&t.removeChild(this,e),!1!==e.deep&&this.eachChild((t=>t.remove(e))),this.model&&this.model.removeCell(this,e)})),this}transition(e,t,n={},r="/"){return this.animation.start(e,t,n,r)}stopTransition(e,t,n="/"){return this.animation.stop(e,t,n),this}getTransitions(){return this.animation.get()}translate(e,t,n){return this}scale(e,t,n,r){return this}addTools(e,t,n){const r=Array.isArray(e)?e:[e],i="string"==typeof t?t:null,o="object"==typeof t?t:"object"==typeof n?n:{};if(o.reset)return this.setTools({name:i,items:r,local:o.local},o);let s=tc(this.getTools());return null==s||null==i||s.name===i?(null==s&&(s={}),s.items||(s.items=[]),s.name=i,s.items=[...s.items,...r],this.setTools(Object.assign({},s),o)):void 0}setTools(e,t={}){return null==e?this.removeTools():this.store.set("tools",lC.normalizeTools(e),t),this}getTools(){return this.store.get("tools")}removeTools(e={}){return this.store.remove("tools",e),this}hasTools(e){const t=this.getTools();return null!=t&&(null==e||t.name===e)}hasTool(e){const t=this.getTools();return null!=t&&t.items.some((t=>"string"==typeof t?t===e:t.name===e))}removeTool(e,t={}){const n=tc(this.getTools());if(n){let r=!1;const i=n.items.slice(),o=e=>{i.splice(e,1),r=!0};if("number"==typeof e)o(e);else for(let t=i.length-1;t>=0;t-=1){const n=i[t];("string"==typeof n?n===e:n.name===e)&&o(t)}r&&(n.items=i,this.setTools(n,t))}return this}getBBox(e){return new Pm}getConnectionPoint(e,t){return new Tm}toJSON(e={}){const t=Object.assign({},this.store.get()),n=Object.prototype.toString,r=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!t.shape){const e=this.constructor;throw new Error(`Unable to serialize ${r} missing "shape" prop, check the ${r} "${e.name||n.call(e)}"`)}const i=this.constructor,o=!0===e.diff,s=t.attrs||{},a=i.getDefaults(!0),l=o?this.preprocess(a,!0):a,c=l.attrs||{},u={};Object.keys(t).forEach((e=>{const i=t[e];if(null!=i&&!Array.isArray(i)&&"object"==typeof i&&!Ws(i))throw new Error(`Can only serialize ${r} with plain-object props, but got a "${n.call(i)}" type of key "${e}" on ${r} "${this.id}"`);if("attrs"!==e&&"shape"!==e&&o){jh(i,l[e])&&delete t[e]}})),Object.keys(s).forEach((e=>{const t=s[e],n=c[e];Object.keys(t).forEach((r=>{const i=t[r],o=n?n[r]:null;null==i||"object"!=typeof i||Array.isArray(i)?null!=n&&jh(o,i)||(null==u[e]&&(u[e]={}),u[e][r]=i):Object.keys(i).forEach((t=>{const s=i[t];if(null==n||null==o||!zr(o)||!jh(o[t],s)){null==u[e]&&(u[e]={}),null==u[e][r]&&(u[e][r]={});u[e][r][t]=s}}))}))}));const h=Object.assign(Object.assign({},t),{attrs:Ih(u)?void 0:u});null==h.attrs&&delete h.attrs;const d=h;return 0===d.angle&&delete d.angle,tc(d)}clone(e={}){if(!e.deep){const t=Object.assign({},this.store.get());e.keepId||delete t.id,delete t.parent,delete t.children;return new(0,this.constructor)(t)}return lC.deepClone(this)[this.id]}findView(e){return e.renderer.findViewByCell(this)}startBatch(e,t={},n=this.model){return this.notify("batch:start",{name:e,data:t,cell:this}),n&&n.startBatch(e,Object.assign(Object.assign({},t),{cell:this})),this}stopBatch(e,t={},n=this.model){return n&&n.stopBatch(e,Object.assign(Object.assign({},t),{cell:this})),this.notify("batch:stop",{name:e,data:t,cell:this}),this}batchUpdate(e,t,n){const r=this.model;this.startBatch(e,n,r);const i=t();return this.stopBatch(e,n,r),i}dispose(){this.removeFromParent(),this.store.dispose()}}lC.defaults={},lC.attrHooks={},lC.propHooks=[],sC([nx.dispose()],lC.prototype,"dispose",null),function(e){e.normalizeTools=function(e){return"string"==typeof e?{items:[e]}:Array.isArray(e)?{items:e}:e.items?e:{items:[e]}}}(lC||(lC={})),function(e){e.toStringTag=`X6.${e.name}`,e.isCell=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.isNode&&"function"==typeof r.isEdge&&"function"==typeof r.prop&&"function"==typeof r.attr}}(lC||(lC={})),function(e){e.getCommonAncestor=function(...e){const t=e.filter((e=>null!=e)).map((e=>e.getAncestors())).sort(((e,t)=>e.length-t.length));return t.shift().find((e=>t.every((t=>t.includes(e)))))||null},e.getCellsBBox=function(e,t={}){let n=null;for(let r=0,i=e.length;r<i;r+=1){const i=e[r];let o=i.getBBox(t);if(o){if(i.isNode()){const e=i.getAngle();null!=e&&0!==e&&(o=o.bbox(e))}n=null==n?o:n.union(o)}}return n},e.deepClone=function(t){const n=[t,...t.getDescendants({deep:!0})];return e.cloneCells(n)},e.cloneCells=function(e){const t=_p(e),n=t.reduce(((e,t)=>(e[t.id]=t.clone(),e)),{});return t.forEach((e=>{const t=n[e.id];if(t.isEdge()){const e=t.getSourceCellId(),r=t.getTargetCellId();e&&n[e]&&t.setSource(Object.assign(Object.assign({},t.getSource()),{cell:n[e].id})),r&&n[r]&&t.setTarget(Object.assign(Object.assign({},t.getTarget()),{cell:n[r].id}))}const r=e.getParent();r&&n[r.id]&&t.setParent(n[r.id]);const i=e.getChildren();if(i&&i.length){const e=i.reduce(((e,t)=>(n[t.id]&&e.push(n[t.id]),e)),[]);e.length>0&&t.setChildren(e)}})),n}}(lC||(lC={})),function(e){e.config({propHooks(t){var{tools:n}=t,r=aC(t,["tools"]);return n&&(r.tools=e.normalizeTools(n)),r}})}(lC||(lC={})),function(e){let t,n;e.exist=function(e,r){return r?null!=t&&t.exist(e):null!=n&&n.exist(e)},e.setEdgeRegistry=function(e){t=e},e.setNodeRegistry=function(e){n=e}}(oC||(oC={}));class cC{constructor(e){this.ports=[],this.groups={},this.init(tc(e))}getPorts(){return this.ports}getGroup(e){return null!=e?this.groups[e]:null}getPortsByGroup(e){return this.ports.filter((t=>t.group===e||null==t.group&&null==e))}getPortsLayoutByGroup(e,t){const n=this.getPortsByGroup(e),r=e?this.getGroup(e):null,i=r?r.position:null,o=i?i.name:null;let s;if(null!=o){const e=Ub.registry.get(o);if(null==e)return Ub.registry.onNotFound(o);s=e}else s=Ub.presets.left;const a=n.map((e=>e&&e.position&&e.position.args||{})),l=i&&i.args||{};return s(a,t,l).map(((e,r)=>{const i=n[r];return{portLayout:e,portId:i.id,portSize:i.size,portAttrs:i.attrs,labelSize:i.label.size,labelLayout:this.getPortLabelLayout(i,Tm.create(e.position),t)}}))}init(e){const{groups:t,items:n}=e;null!=t&&Object.keys(t).forEach((e=>{this.groups[e]=this.parseGroup(t[e])})),Array.isArray(n)&&n.forEach((e=>{this.ports.push(this.parsePort(e))}))}parseGroup(e){return Object.assign(Object.assign({},e),{label:this.getLabel(e,!0),position:this.getPortPosition(e.position,!0)})}parsePort(e){const t=Object.assign({},e),n=this.getGroup(e.group)||{};return t.markup=t.markup||n.markup,t.attrs=rd({},n.attrs,t.attrs),t.position=this.createPosition(n,t),t.label=rd({},n.label,this.getLabel(t)),t.zIndex=this.getZIndex(n,t),t.size=Object.assign(Object.assign({},n.size),t.size),t}getZIndex(e,t){return"number"==typeof t.zIndex?t.zIndex:"number"==typeof e.zIndex||"auto"===e.zIndex?e.zIndex:"auto"}createPosition(e,t){return rd({name:"left",args:{}},e.position,{args:t.args})}getPortPosition(e,t=!1){if(null==e){if(t)return{name:"left",args:{}}}else{if("string"==typeof e)return{name:e,args:{}};if(Array.isArray(e))return{name:"absolute",args:{x:e[0],y:e[1]}};if("object"==typeof e)return e}return{args:{}}}getPortLabelPosition(e,t=!1){if(null==e){if(t)return{name:"left",args:{}}}else{if("string"==typeof e)return{name:e,args:{}};if("object"==typeof e)return e}return{args:{}}}getLabel(e,t=!1){const n=e.label||{};return n.position=this.getPortLabelPosition(n.position,t),n}getPortLabelLayout(e,t,n){const r=e.label.position.name||"left",i=e.label.position.args||{},o=Kb.registry.get(r)||Kb.presets.left;return o?o(t,n,i):null}}var uC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class hC extends lC{constructor(e={}){super(e),this.initPorts()}get[Symbol.toStringTag](){return hC.toStringTag}preprocess(e,t){const{x:n,y:r,width:i,height:o}=e,s=uC(e,["x","y","width","height"]);if(null!=n||null!=r){const e=s.position;s.position=Object.assign(Object.assign({},e),{x:null!=n?n:e?e.x:0,y:null!=r?r:e?e.y:0})}if(null!=i||null!=o){const e=s.size;s.size=Object.assign(Object.assign({},e),{width:null!=i?i:e?e.width:0,height:null!=o?o:e?e.height:0})}return super.preprocess(s,t)}isNode(){return!0}size(e,t,n){return void 0===e?this.getSize():"number"==typeof e?this.setSize(e,t,n):this.setSize(e,t)}getSize(){const e=this.store.get("size");return e?Object.assign({},e):{width:1,height:1}}setSize(e,t,n){return"object"==typeof e?this.resize(e.width,e.height,t):this.resize(e,t,n),this}resize(e,t,n={}){this.startBatch("resize",n);const r=n.direction;if(r){const i=this.getSize();switch(r){case"left":case"right":t=i.height;break;case"top":case"bottom":e=i.width}let o={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[r];const s=Cm.normalize(this.getAngle()||0);n.absolute&&(o+=Math.floor((s+45)/90),o%=4);const a=this.getBBox();let l;l=0===o?a.getBottomLeft():1===o?a.getCorner():2===o?a.getTopRight():a.getOrigin();const c=l.clone().rotate(-s,a.getCenter()),u=Math.sqrt(e*e+t*t)/2;let h=o*Math.PI/2;h+=Math.atan(o%2==0?t/e:e/t),h-=Cm.toRad(s);const d=Tm.fromPolar(u,h,c).clone().translate(e/-2,t/-2);this.store.set("size",{width:e,height:t},n),this.setPosition(d.x,d.y,n)}else this.store.set("size",{width:e,height:t},n);return this.stopBatch("resize",n),this}scale(e,t,n,r={}){const i=this.getBBox().scale(e,t,null==n?void 0:n);return this.startBatch("scale",r),this.setPosition(i.x,i.y,r),this.resize(i.width,i.height,r),this.stopBatch("scale"),this}position(e,t,n){return"number"==typeof e?this.setPosition(e,t,n):this.getPosition(e)}getPosition(e={}){if(e.relative){const e=this.getParent();if(null!=e&&e.isNode()){const t=this.getPosition(),n=e.getPosition();return{x:t.x-n.x,y:t.y-n.y}}}const t=this.store.get("position");return t?Object.assign({},t):{x:0,y:0}}setPosition(e,t,n={}){let r,i,o;if("object"==typeof e?(r=e.x,i=e.y,o=t||{}):(r=e,i=t,o=n||{}),o.relative){const e=this.getParent();if(null!=e&&e.isNode()){const t=e.getPosition();r+=t.x,i+=t.y}}if(o.deep){const e=this.getPosition();this.translate(r-e.x,i-e.y,o)}else this.store.set("position",{x:r,y:i},o);return this}translate(e=0,t=0,n={}){if(0===e&&0===t)return this;n.translateBy=n.translateBy||this.id;const r=this.getPosition();if(null!=n.restrict&&n.translateBy===this.id){const i=this.getBBox({deep:!0}),o=n.restrict,s=r.x-i.x,a=r.y-i.y,l=Math.max(o.x+s,Math.min(o.x+o.width+s-i.width,r.x+e)),c=Math.max(o.y+a,Math.min(o.y+o.height+a-i.height,r.y+t));e=l-r.x,t=c-r.y}const i={x:r.x+e,y:r.y+t};return n.tx=e,n.ty=t,n.transition?("object"!=typeof n.transition&&(n.transition={}),this.transition("position",i,Object.assign(Object.assign({},n.transition),{interp:sx.object})),this.eachChild((r=>{var i;(null===(i=n.exclude)||void 0===i?void 0:i.includes(r))||r.translate(e,t,n)}))):(this.startBatch("translate",n),this.store.set("position",i,n),this.eachChild((r=>{var i;(null===(i=n.exclude)||void 0===i?void 0:i.includes(r))||r.translate(e,t,n)})),this.stopBatch("translate",n)),this}angle(e,t){return null==e?this.getAngle():this.rotate(e,t)}getAngle(){return this.store.get("angle",0)}rotate(e,t={}){const n=this.getAngle();if(t.center){const r=this.getSize(),i=this.getPosition(),o=this.getBBox().getCenter();o.rotate(n-e,t.center);const s=o.x-r.width/2-i.x,a=o.y-r.height/2-i.y;this.startBatch("rotate",{angle:e,options:t}),this.setPosition(i.x+s,i.y+a,t),this.rotate(e,Object.assign(Object.assign({},t),{center:null})),this.stopBatch("rotate")}else this.store.set("angle",t.absolute?e:(n+e)%360,t);return this}getBBox(e={}){if(e.deep){const e=this.getDescendants({deep:!0,breadthFirst:!0});return e.push(this),lC.getCellsBBox(e)}return Pm.fromPositionAndSize(this.getPosition(),this.getSize())}getConnectionPoint(e,t){const n=this.getBBox(),r=n.getCenter(),i=e.getTerminal(t);if(null==i)return r;const o=i.port;if(!o||!this.hasPort(o))return r;const s=this.getPort(o);if(!s||!s.group)return r;const a=this.getPortsPosition(s.group)[o].position,l=Tm.create(a).translate(n.getOrigin()),c=this.getAngle();return c&&l.rotate(-c,r),l}fit(e={}){const t=(this.getChildren()||[]).filter((e=>e.isNode()));if(0===t.length)return this;this.startBatch("fit-embeds",e),e.deep&&t.forEach((t=>t.fit(e)));let{x:n,y:r,width:i,height:o}=lC.getCellsBBox(t);const s=kg(e.padding);return n-=s.left,r-=s.top,i+=s.left+s.right,o+=s.bottom+s.top,this.store.set({position:{x:n,y:r},size:{width:i,height:o}},e),this.stopBatch("fit-embeds"),this}get portContainerMarkup(){return this.getPortContainerMarkup()}set portContainerMarkup(e){this.setPortContainerMarkup(e)}getDefaultPortContainerMarkup(){return this.store.get("defaultPortContainerMarkup")||yx.getPortContainerMarkup()}getPortContainerMarkup(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup()}setPortContainerMarkup(e,t={}){return this.store.set("portContainerMarkup",yx.clone(e),t),this}get portMarkup(){return this.getPortMarkup()}set portMarkup(e){this.setPortMarkup(e)}getDefaultPortMarkup(){return this.store.get("defaultPortMarkup")||yx.getPortMarkup()}getPortMarkup(){return this.store.get("portMarkup")||this.getDefaultPortMarkup()}setPortMarkup(e,t={}){return this.store.set("portMarkup",yx.clone(e),t),this}get portLabelMarkup(){return this.getPortLabelMarkup()}set portLabelMarkup(e){this.setPortLabelMarkup(e)}getDefaultPortLabelMarkup(){return this.store.get("defaultPortLabelMarkup")||yx.getPortLabelMarkup()}getPortLabelMarkup(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup()}setPortLabelMarkup(e,t={}){return this.store.set("portLabelMarkup",yx.clone(e),t),this}get ports(){const e=this.store.get("ports",{items:[]});return null==e.items&&(e.items=[]),e}getPorts(){return tc(this.ports.items)}getPortsByGroup(e){return this.getPorts().filter((t=>t.group===e))}getPort(e){return tc(this.ports.items.find((t=>t.id&&t.id===e)))}getPortAt(e){return this.ports.items[e]||null}hasPorts(){return this.ports.items.length>0}hasPort(e){return-1!==this.getPortIndex(e)}getPortIndex(e){const t="string"==typeof e?e:e.id;return null!=t?this.ports.items.findIndex((e=>e.id===t)):-1}getPortsPosition(e){const t=this.getSize();return this.port.getPortsLayoutByGroup(e,new Pm(0,0,t.width,t.height)).reduce(((e,t)=>{const n=t.portLayout;return e[t.portId]={position:Object.assign({},n.position),angle:n.angle||0},e}),{})}getPortProp(e,t){return this.getPropByPath(this.prefixPortPath(e,t))}setPortProp(e,t,n,r){if("string"==typeof t||Array.isArray(t)){const i=this.prefixPortPath(e,t),o=n;return this.setPropByPath(i,o,r)}const i=this.prefixPortPath(e),o=t;return this.setPropByPath(i,o,n)}removePortProp(e,t,n){return"string"==typeof t||Array.isArray(t)?this.removePropByPath(this.prefixPortPath(e,t),n):this.removePropByPath(this.prefixPortPath(e),t)}portProp(e,t,n,r){return null==t?this.getPortProp(e):"string"==typeof t||Array.isArray(t)?2===arguments.length?this.getPortProp(e,t):null==n?this.removePortProp(e,t,r):this.setPortProp(e,t,n,r):this.setPortProp(e,t,n)}prefixPortPath(e,t){const n=this.getPortIndex(e);if(-1===n)throw new Error(`Unable to find port with id: "${e}"`);return null==t||""===t?["ports","items",`${n}`]:Array.isArray(t)?["ports","items",`${n}`,...t]:`ports/items/${n}/${t}`}addPort(e,t){const n=[...this.ports.items];return n.push(e),this.setPropByPath("ports/items",n,t),this}addPorts(e,t){return this.setPropByPath("ports/items",[...this.ports.items,...e],t),this}removePort(e,t={}){return this.removePortAt(this.getPortIndex(e),t)}removePortAt(e,t={}){if(e>=0){const n=[...this.ports.items];n.splice(e,1),t.rewrite=!0,this.setPropByPath("ports/items",n,t)}return this}removePorts(e,t){let n;if(Array.isArray(e)){if(n=t||{},e.length){n.rewrite=!0;const t=[...this.ports.items].filter((t=>!e.some((e=>{const n="string"==typeof e?e:e.id;return t.id===n}))));this.setPropByPath("ports/items",t,n)}}else n=e||{},n.rewrite=!0,this.setPropByPath("ports/items",[],n);return this}getParsedPorts(){return this.port.getPorts()}getParsedGroups(){return this.port.groups}getPortsLayoutByGroup(e,t){return this.port.getPortsLayoutByGroup(e,t)}initPorts(){this.updatePortData(),this.on("change:ports",(()=>{this.processRemovedPort(),this.updatePortData()}))}processRemovedPort(){const e=this.ports,t={};e.items.forEach((e=>{e.id&&(t[e.id]=!0)}));const n={};(this.store.getPrevious("ports")||{items:[]}).items.forEach((e=>{e.id&&!t[e.id]&&(n[e.id]=!0)}));const r=this.model;if(r&&!Ih(n)){r.getConnectedEdges(this,{incoming:!0}).forEach((e=>{const t=e.getTargetPortId();t&&n[t]&&e.remove()}));r.getConnectedEdges(this,{outgoing:!0}).forEach((e=>{const t=e.getSourcePortId();t&&n[t]&&e.remove()}))}}validatePorts(){const e={},t=[];return this.ports.items.forEach((n=>{"object"!=typeof n&&t.push(`Invalid port ${n}.`),null==n.id&&(n.id=this.generatePortId()),e[n.id]&&t.push("Duplicitied port id."),e[n.id]=!0})),t}generatePortId(){return Cg()}updatePortData(){const e=this.validatePorts();if(e.length>0)throw this.store.set("ports",this.store.getPrevious("ports")),new Error(e.join(" "));const t=this.port?this.port.getPorts():null;this.port=new cC(this.ports);const n=this.port.getPorts(),r=t?n.filter((e=>t.find((t=>t.id===e.id))?null:e)):[...n],i=t?t.filter((e=>n.find((t=>t.id===e.id))?null:e)):[];r.length>0&&this.notify("ports:added",{added:r,cell:this,node:this}),i.length>0&&this.notify("ports:removed",{removed:i,cell:this,node:this})}}hC.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}},function(e){e.toStringTag=`X6.${e.name}`,e.isNode=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.isNode&&"function"==typeof r.isEdge&&"function"==typeof r.prop&&"function"==typeof r.attr&&"function"==typeof r.size&&"function"==typeof r.position}}(hC||(hC={})),function(e){e.config({propHooks(e){var{ports:t}=e,n=uC(e,["ports"]);return t&&(n.ports=Array.isArray(t)?{items:t}:t),n}})}(hC||(hC={})),function(e){e.registry=Bv.create({type:"node",process(t,n){if(oC.exist(t,!0))throw new Error(`Node with name '${t}' was registered by anthor Edge`);if("function"==typeof n)return n.config({shape:t}),n;let r=e;const{inherit:i}=n,o=uC(n,["inherit"]);if(i)if("string"==typeof i){const e=this.get(i);null==e?this.onNotFound(i,"inherited"):r=e}else r=i;null==o.constructorName&&(o.constructorName=t);const s=r.define.call(r,o);return s.config({shape:t}),s}}),oC.setNodeRegistry(e.registry)}(hC||(hC={})),function(e){let t=0;e.define=function(n){const{constructorName:r,overwrite:i}=n,o=uC(n,["constructorName","overwrite"]),s=pg((a=r||o.shape)?xg(a):(t+=1,`CustomNode${t}`),this);var a;return s.config(o),o.shape&&e.registry.register(o.shape,s,i),s},e.create=function(t){const n=t.shape||"rect",r=e.registry.get(n);return r?new r(t):e.registry.onNotFound(n)}}(hC||(hC={}));var dC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class fC extends hC{get label(){return this.getLabel()}set label(e){this.setLabel(e)}getLabel(){return this.getAttrByPath("text/text")}setLabel(e,t){return null==e?this.removeLabel():this.setAttrByPath("text/text",e,t),this}removeLabel(){return this.removeAttrByPath("text/text"),this}}!function(e){e.bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},e.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},e.config({attrs:{text:Object.assign({},e.labelAttr)},propHooks(e){const{label:t}=e,n=dC(e,["label"]);return t&&mg(n,"attrs/text/text",t),n}})}(fC||(fC={}));var pC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function gC(e){return`basic.${e}`}function mC(e="xlink:href"){return t=>{const{imageUrl:n,imageWidth:r,imageHeight:i}=t,o=pC(t,["imageUrl","imageWidth","imageHeight"]);if(null!=n||null!=r||null!=i){const t=()=>{if(o.attrs){const t=o.attrs.image;null!=n&&(t[e]=n),null!=r&&(t.width=r),null!=i&&(t.height=i),o.attrs.image=t}};o.attrs?(null==o.attrs.image&&(o.attrs.image={}),t()):(o.attrs={image:{}},t())}return o}}function vC(e,t,n={}){const r=gC(e),i={constructorName:r,attrs:{".":{fill:"#ffffff",stroke:"none"},[e]:{fill:"#ffffff",stroke:"#000000"}}};n.ignoreMarkup||(i.markup=function(e,t=!1){return`<g class="rotatable"><g class="scalable"><${e}/></g>${t?"":"<text/>"}</g>`}(e,!0===n.noText));return(n.parent||fC).define(rd(i,t,{shape:r}))}vC("rect",{attrs:{rect:{width:100,height:60}}}),vC("circle",{width:60,height:60,attrs:{circle:{r:30,cx:30,cy:30}}}),vC("ellipse",{width:60,height:40,attrs:{ellipse:{rx:30,ry:20,cx:30,cy:20}}}),vC("polygon",{width:60,height:40,attrs:{text:{refY:null,refDy:16}}}),vC("polyline",{width:60,height:40,attrs:{text:{refY:null,refDy:16}}}),vC("image",{attrs:{text:{refY:null,refDy:16}},propHooks:mC()});var yC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const bC=vC("path",{width:60,height:60,attrs:{text:{ref:"path",refY:null,refDy:16}},propHooks(e){const{d:t}=e,n=yC(e,["d"]);return null!=t&&mg(n,"attrs/path/d",t),n}});vC("rhombus",{d:"M 30 0 L 60 30 30 60 0 30 z",attrs:{text:{refY:.5,refDy:null}}},{parent:bC,ignoreMarkup:!0}),vC("cylinder",{width:40,height:40,attrs:{path:{fill:"#FFFFFF",stroke:"#cbd2d7",strokeWidth:3,d:["M 0 10 C 10 5, 30 5, 40 10 C 30 15, 10 15, 0 10","L 0 20","C 10 25, 30 25, 40 20","L 40 10"].join(" ")},text:{refY:.7,refDy:null,fill:"#435460"}}},{parent:bC,ignoreMarkup:!0});var xC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class wC extends lC{constructor(e={}){super(e)}get[Symbol.toStringTag](){return wC.toStringTag}preprocess(e,t){const{source:n,sourceCell:r,sourcePort:i,sourcePoint:o,target:s,targetCell:a,targetPort:l,targetPoint:c}=e,u=xC(e,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]),h=e=>"string"==typeof e||"number"==typeof e;if(null!=n)if(lC.isCell(n))u.source={cell:n.id};else if(h(n))u.source={cell:n};else if(Tm.isPoint(n))u.source=n.toJSON();else if(Array.isArray(n))u.source={x:n[0],y:n[1]};else{const e=n.cell;lC.isCell(e)?u.source=Object.assign(Object.assign({},n),{cell:e.id}):u.source=n}if(null!=r||null!=i){let e=u.source;if(null!=r){const t=h(r)?r:r.id;e?e.cell=t:e=u.source={cell:t}}null!=i&&e&&(e.port=i)}else null!=o&&(u.source=Tm.create(o).toJSON());if(null!=s)if(lC.isCell(s))u.target={cell:s.id};else if(h(s))u.target={cell:s};else if(Tm.isPoint(s))u.target=s.toJSON();else if(Array.isArray(s))u.target={x:s[0],y:s[1]};else{const e=s.cell;lC.isCell(e)?u.target=Object.assign(Object.assign({},s),{cell:e.id}):u.target=s}if(null!=a||null!=l){let e=u.target;if(null!=a){const t=h(a)?a:a.id;e?e.cell=t:e=u.target={cell:t}}null!=l&&e&&(e.port=l)}else null!=c&&(u.target=Tm.create(c).toJSON());return super.preprocess(u,t)}setup(){super.setup(),this.on("change:labels",(e=>this.onLabelsChanged(e))),this.on("change:vertices",(e=>this.onVertexsChanged(e)))}isEdge(){return!0}disconnect(e={}){return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},e),this}get source(){return this.getSource()}set source(e){this.setSource(e)}getSource(){return this.getTerminal("source")}getSourceCellId(){return this.source.cell}getSourcePortId(){return this.source.port}setSource(e,t,n={}){return this.setTerminal("source",e,t,n)}get target(){return this.getTarget()}set target(e){this.setTarget(e)}getTarget(){return this.getTerminal("target")}getTargetCellId(){return this.target.cell}getTargetPortId(){return this.target.port}setTarget(e,t,n={}){return this.setTerminal("target",e,t,n)}getTerminal(e){return Object.assign({},this.store.get(e))}setTerminal(e,t,n,r={}){if(lC.isCell(t))return this.store.set(e,rd({},n,{cell:t.id}),r),this;const i=t;return Tm.isPoint(t)||null!=i.x&&null!=i.y?(this.store.set(e,rd({},n,{x:i.x,y:i.y}),r),this):(this.store.set(e,tc(t),r),this)}getSourcePoint(){return this.getTerminalPoint("source")}getTargetPoint(){return this.getTerminalPoint("target")}getTerminalPoint(e){const t=this[e];if(Tm.isPointLike(t))return Tm.create(t);const n=this.getTerminalCell(e);return n?n.getConnectionPoint(this,e):new Tm}getSourceCell(){return this.getTerminalCell("source")}getTargetCell(){return this.getTerminalCell("target")}getTerminalCell(e){if(this.model){const t="source"===e?this.getSourceCellId():this.getTargetCellId();if(t)return this.model.getCell(t)}return null}getSourceNode(){return this.getTerminalNode("source")}getTargetNode(){return this.getTerminalNode("target")}getTerminalNode(e){let t=this;const n={};for(;t&&t.isEdge();){if(n[t.id])return null;n[t.id]=!0,t=t.getTerminalCell(e)}return t&&t.isNode()?t:null}get router(){return this.getRouter()}set router(e){null==e?this.removeRouter():this.setRouter(e)}getRouter(){return this.store.get("router")}setRouter(e,t,n){return"object"==typeof e?this.store.set("router",e,t):this.store.set("router",{name:e,args:t},n),this}removeRouter(e={}){return this.store.remove("router",e),this}get connector(){return this.getConnector()}set connector(e){null==e?this.removeConnector():this.setConnector(e)}getConnector(){return this.store.get("connector")}setConnector(e,t,n){return"object"==typeof e?this.store.set("connector",e,t):this.store.set("connector",{name:e,args:t},n),this}removeConnector(e={}){return this.store.remove("connector",e)}get strategy(){return this.getStrategy()}set strategy(e){null==e?this.removeStrategy():this.setStrategy(e)}getStrategy(){return this.store.get("strategy")}setStrategy(e,t,n){return"object"==typeof e?this.store.set("strategy",e,t):this.store.set("strategy",{name:e,args:t},n),this}removeStrategy(e={}){return this.store.remove("strategy",e)}getDefaultLabel(){const e=this.constructor;return tc(this.store.get("defaultLabel")||e.defaultLabel||{})}get labels(){return this.getLabels()}set labels(e){this.setLabels(e)}getLabels(){return[...this.store.get("labels",[])].map((e=>this.parseLabel(e)))}setLabels(e,t={}){return this.store.set("labels",Array.isArray(e)?e:[e],t),this}insertLabel(e,t,n={}){const r=this.getLabels(),i=r.length;let o=null!=t&&Number.isFinite(t)?t:i;return o<0&&(o=i+o+1),r.splice(o,0,this.parseLabel(e)),this.setLabels(r,n)}appendLabel(e,t={}){return this.insertLabel(e,-1,t)}getLabelAt(e){const t=this.getLabels();return null!=e&&Number.isFinite(e)?this.parseLabel(t[e]):null}setLabelAt(e,t,n={}){if(null!=e&&Number.isFinite(e)){const r=this.getLabels();r[e]=this.parseLabel(t),this.setLabels(r,n)}return this}removeLabelAt(e,t={}){const n=this.getLabels(),r=null!=e&&Number.isFinite(e)?e:-1,i=n.splice(r,1);return this.setLabels(n,t),i.length?i[0]:null}parseLabel(e){if("string"==typeof e){return this.constructor.parseStringLabel(e)}return e}onLabelsChanged({previous:e,current:t}){const n=e&&t?t.filter((t=>e.find((e=>t===e||jh(t,e)))?null:t)):t?[...t]:[],r=e&&t?e.filter((e=>t.find((t=>e===t||jh(e,t)))?null:e)):e?[...e]:[];n.length>0&&this.notify("labels:added",{added:n,cell:this,edge:this}),r.length>0&&this.notify("labels:removed",{removed:r,cell:this,edge:this})}get vertexMarkup(){return this.getVertexMarkup()}set vertexMarkup(e){this.setVertexMarkup(e)}getDefaultVertexMarkup(){return this.store.get("defaultVertexMarkup")||yx.getEdgeVertexMarkup()}getVertexMarkup(){return this.store.get("vertexMarkup")||this.getDefaultVertexMarkup()}setVertexMarkup(e,t={}){return this.store.set("vertexMarkup",yx.clone(e),t),this}get vertices(){return this.getVertices()}set vertices(e){this.setVertices(e)}getVertices(){return[...this.store.get("vertices",[])]}setVertices(e,t={}){const n=Array.isArray(e)?e:[e];return this.store.set("vertices",n.map((e=>Tm.toJSON(e))),t),this}insertVertex(e,t,n={}){const r=this.getVertices(),i=r.length;let o=null!=t&&Number.isFinite(t)?t:i;return o<0&&(o=i+o+1),r.splice(o,0,Tm.toJSON(e)),this.setVertices(r,n)}appendVertex(e,t={}){return this.insertVertex(e,-1,t)}getVertexAt(e){if(null!=e&&Number.isFinite(e)){return this.getVertices()[e]}return null}setVertexAt(e,t,n={}){if(null!=e&&Number.isFinite(e)){const r=this.getVertices();r[e]=t,this.setVertices(r,n)}return this}removeVertexAt(e,t={}){const n=this.getVertices(),r=null!=e&&Number.isFinite(e)?e:-1;return n.splice(r,1),this.setVertices(n,t)}onVertexsChanged({previous:e,current:t}){const n=e&&t?t.filter((t=>e.find((e=>Tm.equals(t,e)))?null:t)):t?[...t]:[],r=e&&t?e.filter((e=>t.find((t=>Tm.equals(e,t)))?null:e)):e?[...e]:[];n.length>0&&this.notify("vertexs:added",{added:n,cell:this,edge:this}),r.length>0&&this.notify("vertexs:removed",{removed:r,cell:this,edge:this})}getDefaultMarkup(){return this.store.get("defaultMarkup")||yx.getEdgeMarkup()}getMarkup(){return super.getMarkup()||this.getDefaultMarkup()}get toolMarkup(){return this.getToolMarkup()}set toolMarkup(e){this.setToolMarkup(e)}getDefaultToolMarkup(){return this.store.get("defaultToolMarkup")||yx.getEdgeToolMarkup()}getToolMarkup(){return this.store.get("toolMarkup")||this.getDefaultToolMarkup()}setToolMarkup(e,t={}){return this.store.set("toolMarkup",e,t),this}get doubleToolMarkup(){return this.getDoubleToolMarkup()}set doubleToolMarkup(e){this.setDoubleToolMarkup(e)}getDefaultDoubleToolMarkup(){return this.store.get("defaultDoubleToolMarkup")}getDoubleToolMarkup(){return this.store.get("doubleToolMarkup")||this.getDefaultDoubleToolMarkup()}setDoubleToolMarkup(e,t={}){return this.store.set("doubleToolMarkup",e,t),this}get arrowheadMarkup(){return this.getArrowheadMarkup()}set arrowheadMarkup(e){this.setArrowheadMarkup(e)}getDefaultArrowheadMarkup(){return this.store.get("defaultArrowheadMarkup")||yx.getEdgeArrowheadMarkup()}getArrowheadMarkup(){return this.store.get("arrowheadMarkup")||this.getDefaultArrowheadMarkup()}setArrowheadMarkup(e,t={}){return this.store.set("arrowheadMarkup",e,t),this}translate(e,t,n={}){return n.translateBy=n.translateBy||this.id,n.tx=e,n.ty=t,this.applyToPoints((n=>({x:(n.x||0)+e,y:(n.y||0)+t})),n)}scale(e,t,n,r={}){return this.applyToPoints((r=>Tm.create(r).scale(e,t,n).toJSON()),r)}applyToPoints(e,t={}){const n={},r=this.getSource(),i=this.getTarget();Tm.isPointLike(r)&&(n.source=e(r)),Tm.isPointLike(i)&&(n.target=e(i));const o=this.getVertices();return o.length>0&&(n.vertices=o.map(e)),this.store.set(n,t),this}getBBox(){return this.getPolyline().bbox()}getConnectionPoint(){return this.getPolyline().pointAt(.5)}getPolyline(){const e=[this.getSourcePoint(),this.getTargetPoint()];return this.getVertices().forEach((t=>e.push(Tm.create(t)))),new Rm(e)}updateParent(e){let t=null;const n=this.getSourceCell(),r=this.getTargetCell(),i=this.getParent();return n&&r&&(t=n===r||n.isDescendantOf(r)?r:r.isDescendantOf(n)?n:lC.getCommonAncestor(n,r)),!i||t&&t.id===i.id||i.unembed(this,e),t&&t.embed(this,e),t}hasLoop(e={}){const t=this.getSource(),n=this.getTarget(),r=t.cell,i=n.cell;if(!r||!i)return!1;let o=r===i;if(!o&&e.deep&&this._model){const t=this.getSourceCell(),n=this.getTargetCell();t&&n&&(o=t.isAncestorOf(n,e)||n.isAncestorOf(t,e))}return o}getFragmentAncestor(){const e=[this,this.getSourceNode(),this.getTargetNode()].filter((e=>null!=e));return this.getCommonAncestor(...e)}isFragmentDescendantOf(e){const t=this.getFragmentAncestor();return!!t&&(t.id===e.id||t.isDescendantOf(e))}}wC.defaults={},function(e){e.equalTerminals=function(e,t){const n=e,r=t;return n.cell===r.cell&&(n.port===r.port||null==n.port&&null==r.port)}}(wC||(wC={})),function(e){e.defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}},e.parseStringLabel=function(e){return{attrs:{label:{text:e}}}}}(wC||(wC={})),function(e){e.toStringTag=`X6.${e.name}`,e.isEdge=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.isNode&&"function"==typeof r.isEdge&&"function"==typeof r.prop&&"function"==typeof r.attr&&"function"==typeof r.disconnect&&"function"==typeof r.getSource&&"function"==typeof r.getTarget}}(wC||(wC={})),function(e){e.registry=Bv.create({type:"edge",process(t,n){if(oC.exist(t,!1))throw new Error(`Edge with name '${t}' was registered by anthor Node`);if("function"==typeof n)return n.config({shape:t}),n;let r=e;const{inherit:i="edge"}=n,o=xC(n,["inherit"]);if("string"==typeof i){const e=this.get(i||"edge");null==e&&i?this.onNotFound(i,"inherited"):r=e}else r=i;null==o.constructorName&&(o.constructorName=t);const s=r.define.call(r,o);return s.config({shape:t}),s}}),oC.setEdgeRegistry(e.registry)}(wC||(wC={})),function(e){let t=0;e.define=function(n){const{constructorName:r,overwrite:i}=n,o=xC(n,["constructorName","overwrite"]),s=pg((a=r||o.shape)?xg(a):(t+=1,`CustomEdge${t}`),this);var a;return s.config(o),o.shape&&e.registry.register(o.shape,s,i),s},e.create=function(t){const n=t.shape||"edge",r=e.registry.get(n);return r?new r(t):e.registry.onNotFound(n)}}(wC||(wC={})),function(e){const t="basic.edge";e.config({shape:t,propHooks(t){const{label:n,vertices:r}=t,i=xC(t,["label","vertices"]);if(n){null==i.labels&&(i.labels=[]);const t="string"==typeof n?e.parseStringLabel(n):n;i.labels.push(t)}return r&&Array.isArray(r)&&(i.vertices=r.map((e=>Tm.create(e).toJSON()))),i}}),e.registry.register(t,e)}(wC||(wC={}));var CC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class EC extends _x{constructor(){super(...arguments),this.POINT_ROUNDING=2,this.markerCache={}}get[Symbol.toStringTag](){return EC.toStringTag}getContainerClassName(){return[super.getContainerClassName(),this.prefixClassName("edge")].join(" ")}get sourceBBox(){const e=this.sourceView;if(!e){const e=this.cell.getSource();return new Pm(e.x,e.y)}const t=this.sourceMagnet;return e.isEdgeElement(t)?new Pm(this.sourceAnchor.x,this.sourceAnchor.y):e.getBBoxOfElement(t||e.container)}get targetBBox(){const e=this.targetView;if(!e){const e=this.cell.getTarget();return new Pm(e.x,e.y)}const t=this.targetMagnet;return e.isEdgeElement(t)?new Pm(this.targetAnchor.x,this.targetAnchor.y):e.getBBoxOfElement(t||e.container)}isEdgeView(){return!0}confirmUpdate(e,t={}){let n=e;if(this.hasAction(n,"source")){if(!this.updateTerminalProperties("source"))return n;n=this.removeAction(n,"source")}if(this.hasAction(n,"target")){if(!this.updateTerminalProperties("target"))return n;n=this.removeAction(n,"target")}const r=this.graph,i=this.sourceView,o=this.targetView;return r&&(i&&!r.renderer.isViewMounted(i)||o&&!r.renderer.isViewMounted(o))?n:this.hasAction(n,"render")?(this.render(),n=this.removeAction(n,["render","update","vertices","labels","tools","widget"]),n):(n=this.handleAction(n,"vertices",(()=>this.renderVertexMarkers())),n=this.handleAction(n,"update",(()=>this.update(null,t))),n=this.handleAction(n,"labels",(()=>this.onLabelsChange(t))),n=this.handleAction(n,"tools",(()=>{this.renderTools(),this.updateToolsPosition()})),n=this.handleAction(n,"widget",(()=>this.renderExternalTools())),n)}onLabelsChange(e={}){this.shouldRerenderLabels(e)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()}shouldRerenderLabels(e={}){const t=this.cell.previous("labels");if(null==t)return!0;if("propertyPathArray"in e&&"propertyValue"in e){const n=e.propertyPathArray||[],r=n.length;if(r>1){if(t[n[1]]){if(2===r)return"object"==typeof e.propertyValue&&oh(e.propertyValue,"markup");if("markup"!==n[2])return!1}}}return!0}render(){return this.empty(),this.containers={},this.renderMarkup(),this.renderLabels(),this.update(),this}renderMarkup(){const e=this.cell.markup;if(e)return"string"==typeof e?this.renderStringMarkup(e):this.renderJSONMarkup(e);throw new TypeError("Invalid edge markup.")}renderJSONMarkup(e){const t=this.parseJSONMarkup(e,this.container);this.selectors=t.selectors,this.container.append(t.fragment)}renderStringMarkup(e){const t=this.containers,n=ev.createVectors(e);n.forEach((e=>{const n=e.attr("class");n&&(t[qa(n)]=e.node)})),this.renderTools(),this.renderVertexMarkers(),this.renderArrowheadMarkers(),nm(this.container,n.map((e=>e.node)))}renderLabels(){const e=this.cell,t=e.getLabels(),n=t.length;let r=this.containers.labels;if(this.labelCache={},this.labelSelectors={},n<=0)return r&&r.parentNode&&r.parentNode.removeChild(r),this;r?this.empty(r):(r=Xg("g"),this.addClass(this.prefixClassName("edge-labels"),r),this.containers.labels=r);for(let n=0,i=t.length;n<i;n+=1){const i=t[n],o=this.normalizeLabelMarkup(this.parseLabelMarkup(i.markup));let s,a;if(o)s=o.node,a=o.selectors;else{const t=e.getDefaultLabel(),n=this.normalizeLabelMarkup(this.parseLabelMarkup(t.markup));s=n.node,a=n.selectors}s.setAttribute("data-index",`${n}`),r.appendChild(s);const l=this.rootSelector;if(a[l])throw new Error("Ambiguous label root selector.");a[l]=s,this.labelCache[n]=s,this.labelSelectors[n]=a}return null==r.parentNode&&this.container.appendChild(r),this.updateLabels(),this.customizeLabels(),this}parseLabelMarkup(e){return e?"string"==typeof e?this.parseLabelStringMarkup(e):this.parseJSONMarkup(e):null}parseLabelStringMarkup(e){const t=ev.createVectors(e),n=document.createDocumentFragment();for(let e=0,r=t.length;e<r;e+=1){const r=t[e].node;n.appendChild(r)}return{fragment:n,selectors:{}}}normalizeLabelMarkup(e){if(null==e)return;const t=e.fragment;if(!(t instanceof DocumentFragment&&t.hasChildNodes()))throw new Error("Invalid label markup.");let n;const r=t.childNodes;return n=r.length>1||"G"!==r[0].nodeName.toUpperCase()?ev.create("g").append(t):ev.create(r[0]),n.addClass(this.prefixClassName("edge-label")),{node:n.node,selectors:e.selectors}}updateLabels(){if(this.containers.labels){const e=this.cell,t=e.labels,n=this.can("edgeLabelMovable"),r=e.getDefaultLabel();for(let e=0,i=t.length;e<i;e+=1){const i=this.labelCache[e],o=this.labelSelectors[e];i.setAttribute("cursor",n?"move":"default");const s=t[e],a=rd({},r.attrs,s.attrs);this.updateAttrs(i,a,{selectors:o,rootBBox:s.size?Pm.fromSize(s.size):void 0})}}}mergeLabelAttrs(e,t,n){if(null===t)return null;if(void 0===t){if(null===n)return null;if(void 0===n)return;return e?n:rd({},n)}return e?rd({},n,t):void 0}customizeLabels(){if(this.containers.labels){const e=this.cell,t=e.labels;for(let n=0,r=t.length;n<r;n+=1){const r=t[n],i=this.labelCache[n],o=this.labelSelectors[n];this.graph.hook.onEdgeLabelRendered({edge:e,label:r,container:i,selectors:o})}}}renderTools(){const e=this.containers.tools;if(null==e)return this;const t=this.cell.toolMarkup,n=this.$(e).empty();if(yx.isStringMarkup(t)){let e=op(t);const r=ev.create(e());if(n.append(r.node),this.toolCache=r.node,this.options.doubleTools){let t;const i=this.cell.doubleToolMarkup;yx.isStringMarkup(i)?(e=op(i),t=ev.create(e())):t=r.clone(),n.append(t.node),this.tool2Cache=t.node}}return this}renderExternalTools(){const e=this.cell.getTools();return this.addTools(e),this}renderVertexMarkers(){const e=this.containers.vertices;if(null==e)return this;const t=this.cell.vertexMarkup,n=this.$(e).empty();if(yx.isStringMarkup(t)){const e=op(t);this.cell.getVertices().forEach(((t,r)=>{n.append(ev.create(e(Object.assign({index:r},t))).node)}))}return this}renderArrowheadMarkers(){const e=this.containers.arrowheads;if(null==e)return this;const t=this.cell.arrowheadMarkup,n=this.$(e).empty();if(yx.isStringMarkup(t)){const e=op(t),r=ev.create(e({end:"source"})).node,i=ev.create(e({end:"target"})).node;this.containers.sourceArrowhead=r,this.containers.targetArrowhead=i,n.append(r,i)}return this}update(e,t={}){this.cleanCache(),this.updateConnection(t);const n=this.cell.getAttrs();return null!=n&&this.updateAttrs(this.container,n,{attrs:e===n?null:e,selectors:this.selectors}),this.updateConnectionPath(),this.updateLabelPositions(),this.updateToolsPosition(),this.updateArrowheadMarkers(),null==t.toolId?this.renderExternalTools():this.updateTools(t),this}removeRedundantLinearVertices(e={}){const t=this.cell,n=t.getVertices(),r=[this.sourceAnchor,...n,this.targetAnchor],i=r.length,o=new Rm(r);o.simplify({threshold:.01});const s=o.points.map((e=>e.toJSON())),a=s.length;return i===a?0:(t.setVertices(s.slice(1,a-1),e),i-a)}updateConnectionPath(){const e=this.containers;if(e.connection){const t=this.getConnectionPathData();e.connection.setAttribute("d",t)}if(e.connectionWrap){const t=this.getConnectionPathData();e.connectionWrap.setAttribute("d",t)}e.sourceMarker&&e.targetMarker&&this.translateAndAutoOrientArrows(e.sourceMarker,e.targetMarker)}getTerminalView(e){switch(e){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error(`Unknown terminal type '${e}'`)}}getTerminalAnchor(e){switch(e){case"source":return Tm.create(this.sourceAnchor);case"target":return Tm.create(this.targetAnchor);default:throw new Error(`Unknown terminal type '${e}'`)}}getTerminalConnectionPoint(e){switch(e){case"source":return Tm.create(this.sourcePoint);case"target":return Tm.create(this.targetPoint);default:throw new Error(`Unknown terminal type '${e}'`)}}getTerminalMagnet(e,t={}){switch(e){case"source":{if(t.raw)return this.sourceMagnet;const e=this.sourceView;return e?this.sourceMagnet||e.container:null}case"target":{if(t.raw)return this.targetMagnet;const e=this.targetView;return e?this.targetMagnet||e.container:null}default:throw new Error(`Unknown terminal type '${e}'`)}}updateConnection(e={}){const t=this.cell;if(e.translateBy&&t.isFragmentDescendantOf(e.translateBy)){const t=e.tx||0,n=e.ty||0;this.routePoints=new Rm(this.routePoints).translate(t,n).points,this.translateConnectionPoints(t,n),this.path.translate(t,n)}else{const e=t.getVertices(),n=this.findAnchors(e);this.sourceAnchor=n.source,this.targetAnchor=n.target,this.routePoints=this.findRoutePoints(e);const r=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor);this.sourcePoint=r.source,this.targetPoint=r.target;const i=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint);this.path=this.findPath(this.routePoints,i.source||this.sourcePoint,i.target||this.targetPoint)}this.cleanCache()}findAnchors(e){const t=this.cell,n=t.source,r=t.target,i=e[0],o=e[e.length-1];return r.priority&&!n.priority?this.findAnchorsOrdered("target",o,"source",i):this.findAnchorsOrdered("source",i,"target",o)}findAnchorsOrdered(e,t,n,r){let i,o;const s=this.cell,a=s[e],l=s[n],c=this.getTerminalView(e),u=this.getTerminalView(n),h=this.getTerminalMagnet(e),d=this.getTerminalMagnet(n);if(c){let n;n=t?Tm.create(t):u?d:Tm.create(l),i=this.getAnchor(a.anchor,c,h,n,e)}else i=Tm.create(a);if(u){const e=Tm.create(r||i);o=this.getAnchor(l.anchor,u,d,e,n)}else o=Tm.isPointLike(l)?Tm.create(l):new Tm;return{[e]:i,[n]:o}}getAnchor(e,t,n,r,i){const o=t.isEdgeElement(n),s=this.graph.options.connecting;let a,l="string"==typeof e?{name:e}:e;if(!l){const e=o?("source"===i?s.sourceEdgeAnchor:s.targetEdgeAnchor)||s.edgeAnchor:("source"===i?s.sourceAnchor:s.targetAnchor)||s.anchor;l="string"==typeof e?{name:e}:e}if(!l)throw new Error("Anchor should be specified.");const c=l.name;if(o){const e=cw.registry.get(c);if("function"!=typeof e)return cw.registry.onNotFound(c);a=Tg(e,this,t,n,r,l.args||{},i)}else{const e=iw.registry.get(c);if("function"!=typeof e)return iw.registry.onNotFound(c);a=Tg(e,this,t,n,r,l.args||{},i)}return a?a.round(this.POINT_ROUNDING):new Tm}findRoutePoints(e=[]){const t=this.graph.options.connecting.router||Hw.presets.normal,n=this.cell.getRouter()||t;let r;if("function"==typeof n)r=Tg(n,this,e,{},this);else{const t="string"==typeof n?n:n.name,i="string"==typeof n?{}:n.args||{},o=t?Hw.registry.get(t):Hw.presets.normal;if("function"!=typeof o)return Hw.registry.onNotFound(t);r=Tg(o,this,e,i,this)}return null==r?e.map((e=>Tm.create(e))):r.map((e=>Tm.create(e)))}findConnectionPoints(e,t,n){const r=this.cell,i=this.graph.options.connecting,o=r.getSource(),s=r.getTarget(),a=this.sourceView,l=this.targetView,c=e[0],u=e[e.length-1];let h,d;if(a&&!a.isEdgeElement(this.sourceMagnet)){const e=this.sourceMagnet||a.container,r=new Dm(c||n,t),s=o.connectionPoint||i.sourceConnectionPoint||i.connectionPoint;h=this.getConnectionPoint(s,a,e,r,"source")}else h=t;if(l&&!l.isEdgeElement(this.targetMagnet)){const e=this.targetMagnet||l.container,r=s.connectionPoint||i.targetConnectionPoint||i.connectionPoint,o=new Dm(u||t,n);d=this.getConnectionPoint(r,l,e,o,"target")}else d=n;return{source:h,target:d}}getConnectionPoint(e,t,n,r,i){const o=r.end;if(null==e)return o;const s="string"==typeof e?e:e.name,a="string"==typeof e?{}:e.args,l=pw.registry.get(s);if("function"!=typeof l)return pw.registry.onNotFound(s);const c=Tg(l,this,r,t,n,a||{},i);return c?c.round(this.POINT_ROUNDING):o}updateMarkerAttr(e){const t=this.cell.getAttrs(),n=`.${e}-marker`,r=t&&t[n];r&&this.updateAttrs(this.container,{},{attrs:{[n]:r},selectors:this.selectors})}findMarkerPoints(e,t,n){const r=e=>{const t=this.cell.getAttrs(),n=Object.keys(t);for(let r=0,i=n.length;r<i;r+=1){const i=t[n[r]];if(i[`${e}Marker`]||i[`${e}-marker`]){const e=i.strokeWidth||i["stroke-width"];if(e)return parseFloat(e);break}}return null},i=e[0],o=e[e.length-1],s=this.containers.sourceMarker,a=this.containers.targetMarker,l=this.markerCache;let c,u;if(s){if(this.updateMarkerAttr("source"),l.sourceBBox=l.sourceBBox||Sv(s),l.sourceBBox.width>0){const e=Nv(s);c=t.clone().move(i||n,l.sourceBBox.width*e.sx*-1)}}else{const e=r("source");e&&(c=t.clone().move(i||n,-e))}if(a){if(this.updateMarkerAttr("target"),l.targetBBox=l.targetBBox||Sv(a),l.targetBBox.width>0){const e=Nv(a);u=n.clone().move(o||t,l.targetBBox.width*e.sx*-1)}}else{const e=r("target");e&&(u=n.clone().move(o||t,-e))}return l.sourcePoint=c||t.clone(),l.targetPoint=u||n.clone(),{source:c,target:u}}findPath(e,t,n){const r=this.cell.getConnector()||this.graph.options.connecting.connector;let i,o,s;if("string"==typeof r?i=r:(i=r.name,o=r.args),i){const e=Qw.registry.get(i);if("function"!=typeof e)return Qw.registry.onNotFound(i);s=e}else s=Qw.presets.normal;const a=Tg(s,this,t,n,e,Object.assign(Object.assign({},o),{raw:!0}),this);return"string"==typeof a?Qm.parse(a):a}translateConnectionPoints(e,t){const n=this.markerCache;n.sourcePoint&&n.sourcePoint.translate(e,t),n.targetPoint&&n.targetPoint.translate(e,t),this.sourcePoint.translate(e,t),this.targetPoint.translate(e,t),this.sourceAnchor.translate(e,t),this.targetAnchor.translate(e,t)}updateLabelPositions(){if(null==this.containers.labels)return this;if(!this.path)return this;const e=this.cell,t=e.getLabels();if(0===t.length)return this;const n=e.getDefaultLabel(),r=this.normalizeLabelPosition(n.position);for(let e=0,n=t.length;e<n;e+=1){const n=t[e],i=this.normalizeLabelPosition(n.position),o=rd({},r,i),s=this.getLabelTransformationMatrix(o);this.labelCache[e].setAttribute("transform",bv(s))}return this}updateToolsPosition(){if(null==this.containers.tools)return this;let e="",t=this.options.toolsOffset;const n=this.getConnectionLength();if(null!=n){n<this.options.shortLength&&(e="scale(.5)",t/=2);let r=this.getPointAtLength(t);if(null!=r&&lm(this.toolCache,"transform",`translate(${r.x},${r.y}) ${e}`),this.options.doubleTools&&n>=this.options.longLength){const i=this.options.doubleToolsOffset||t;r=this.getPointAtLength(n-i),null!=r&&lm(this.tool2Cache,"transform",`translate(${r.x},${r.y}) ${e}`),lm(this.tool2Cache,"visibility","visible")}else this.options.doubleTools&&lm(this.tool2Cache,"visibility","hidden")}return this}updateArrowheadMarkers(){const e=this.containers.arrowheads;if(null==e)return this;if("none"===e.style.display)return this;const t=this.containers.sourceArrowhead,n=this.containers.targetArrowhead;if(t&&n){const e=(this.getConnectionLength()||0)<this.options.shortLength?.5:1;Nv(t,e),Nv(n,e),this.translateAndAutoOrientArrows(t,n)}return this}updateTerminalProperties(e){const t=this.cell,n=this.graph,r=t[e],i=r&&r.cell,o=`${e}View`;if(!i)return this[o]=null,this.updateTerminalMagnet(e),!0;const s=n.getCellById(i);if(!s)throw new Error(`Edge's ${e} node with id "${i}" not exists`);const a=s.findView(n);return!!a&&(this[o]=a,this.updateTerminalMagnet(e),!0)}updateTerminalMagnet(e){const t=`${e}Magnet`,n=this.getTerminalView(e);if(n){let r=n.getMagnetFromEdgeTerminal(this.cell[e]);r===n.container&&(r=null),this[t]=r}else this[t]=null}translateAndAutoOrientArrows(e,t){const n=this.routePoints;e&&Rv(e,this.sourcePoint,n[0]||this.targetPoint,this.graph.view.stage),t&&Rv(t,this.targetPoint,n[n.length-1]||this.sourcePoint,this.graph.view.stage)}getLabelPositionAngle(e){const t=this.cell.getLabelAt(e);return t&&t.position&&"object"==typeof t.position&&t.position.angle||0}getLabelPositionArgs(e){const t=this.cell.getLabelAt(e);if(t&&t.position&&"object"==typeof t.position)return t.position.options}getDefaultLabelPositionArgs(){const e=this.cell.getDefaultLabel();if(e&&e.position&&"object"==typeof e.position)return e.position.options}mergeLabelPositionArgs(e,t){return null===e?null:void 0===e?null===t?null:t:rd({},t,e)}addLabel(e,t,n,r){let i,o,s,a=0;"number"!=typeof e?(i=e.x,o=e.y,"number"==typeof t?(a=t,s=n):s=t):(i=e,o=t,"number"==typeof n?(a=n,s=r):s=n);const l=this.getDefaultLabelPositionArgs(),c=s,u=this.mergeLabelPositionArgs(c,l),h={position:this.getLabelPosition(i,o,a,u)};return this.cell.insertLabel(h,-1,s),-1}addVertex(e,t,n){const r="number"!=typeof e,i=r?e.x:e,o=r?e.y:t,s=r?t:n,a={x:i,y:o},l=this.getVertexIndex(i,o);return this.cell.insertVertex(a,l,s),l}sendToken(e,t,n){let r,i,o,s,a="linear";"object"==typeof t?(r=t.duration,i=!0===t.reversed,o=t.selector,!1===t.rotate?s="":!0===t.rotate?s="auto":null!=t.rotate&&(s=`${t.rotate}`),t.timing&&(a=t.timing)):(r=t,i=!1,o=null),r=r||1e3;const l={dur:`${r}ms`,repeatCount:"1",calcMode:a,fill:"freeze"};if(s&&(l.rotate=s),i&&(l.keyPoints="1;0",l.keyTimes="0;1"),"object"==typeof t){const e=CC(t,["duration","reversed","selector","rotate","timing"]);Object.keys(e).forEach((t=>{l[t]=e[t]}))}let c;if(c="string"==typeof o?this.findOne(o,this.container,this.selectors):this.containers.connection?this.containers.connection:this.container.querySelector("path"),!(c instanceof SVGPathElement))throw new Error("Token animation requires a valid connection path.");const u="string"==typeof e?this.findOne(e):e;if(null==u)throw new Error("Token animation requires a valid token element.");const h=u.parentNode,d=()=>{h||em(u)},f=ev.create(u);h||f.appendTo(this.graph.view.stage);const p=l.complete;l.complete=e=>{d(),n&&n(),p&&p(e)};const g=f.animateAlongPath(l,c);return()=>{d(),g()}}getConnection(){return null!=this.path?this.path.clone():null}getConnectionPathData(){if(null==this.path)return"";const e=this.cache.pathCache;return oh(e,"data")||(e.data=this.path.serialize()),e.data||""}getConnectionSubdivisions(){if(null==this.path)return null;const e=this.cache.pathCache;return oh(e,"segmentSubdivisions")||(e.segmentSubdivisions=this.path.getSegmentSubdivisions()),e.segmentSubdivisions}getConnectionLength(){if(null==this.path)return 0;const e=this.cache.pathCache;return oh(e,"length")||(e.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),e.length}getPointAtLength(e){return null==this.path?null:this.path.pointAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getPointAtRatio(e){return null==this.path?null:(Sg(e)&&(e=parseFloat(e)/100),this.path.pointAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()}))}getTangentAtLength(e){return null==this.path?null:this.path.tangentAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getTangentAtRatio(e){return null==this.path?null:this.path.tangentAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPoint(e){return null==this.path?null:this.path.closestPoint(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointLength(e){return null==this.path?null:this.path.closestPointLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointRatio(e){return null==this.path?null:this.path.closestPointNormalizedLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getLabelPosition(e,t,n,r){const i={distance:0};let o,s=0;"number"==typeof n?(s=n,o=r):o=n,null!=o&&(i.options=o);const a=o&&o.absoluteOffset,l=!(o&&o.absoluteDistance),c=o&&o.absoluteDistance&&o.reverseDistance,u=this.path,h={segmentSubdivisions:this.getConnectionSubdivisions()},d=new Tm(e,t),f=u.closestPointT(d,h),p=this.getConnectionLength()||0;let g,m,v=u.lengthAtT(f,h);if(l&&(v=p>0?v/p:0),c&&(v=-1*(p-v)||1),i.distance=v,a||(g=u.tangentAtT(f)),g)m=g.pointOffset(d);else{const e=u.pointAtT(f),t=d.diff(e);m={x:t.x,y:t.y}}return i.offset=m,i.angle=s,i}normalizeLabelPosition(e){return"number"==typeof e?{distance:e}:e}getLabelTransformationMatrix(e){const t=this.normalizeLabelPosition(e),n=t.options||{},r=t.angle||0,i=t.distance,o=i>0&&i<=1;let s=0;const a={x:0,y:0},l=t.offset;l&&("number"==typeof l?s=l:(null!=l.x&&(a.x=l.x),null!=l.y&&(a.y=l.y)));const c=0!==a.x||0!==a.y||0===s,u=n.keepGradient,h=n.ensureLegibility,d=this.path,f={segmentSubdivisions:this.getConnectionSubdivisions()},p=o?i*this.getConnectionLength():i,g=d.tangentAtLength(p,f);let m,v=r;if(g){if(c)m=g.start,m.translate(a);else{const e=g.clone();e.rotate(-90,g.start),e.setLength(s),m=e.end}u&&(v=g.angle()+r,h&&(v=Cm.normalize((v+90)%180-90)))}else m=d.start,c&&m.translate(a);return mv().translate(m.x,m.y).rotate(v)}getLabelCoordinates(e){const t=this.getLabelTransformationMatrix(e);return new Tm(t.e,t.f)}getVertexIndex(e,t){const n=this.cell.getVertices(),r=this.getClosestPointLength(new Tm(e,t));let i=0;if(null!=r)for(const e=n.length;i<e;i+=1){const e=n[i],t=this.getClosestPointLength(e);if(null!=t&&r<t)break}return i}getEventArgs(e,t,n){const r=this,i=r.cell;return null==t||null==n?{e:e,view:r,edge:i,cell:i}:{e:e,x:t,y:n,view:r,edge:i,cell:i}}notifyUnhandledMouseDown(e,t,n){this.notify("edge:unhandled:mousedown",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})}notifyMouseDown(e,t,n){super.onMouseDown(e,t,n),this.notify("edge:mousedown",this.getEventArgs(e,t,n))}notifyMouseMove(e,t,n){super.onMouseMove(e,t,n),this.notify("edge:mousemove",this.getEventArgs(e,t,n))}notifyMouseUp(e,t,n){super.onMouseUp(e,t,n),this.notify("edge:mouseup",this.getEventArgs(e,t,n))}onClick(e,t,n){super.onClick(e,t,n),this.notify("edge:click",this.getEventArgs(e,t,n))}onDblClick(e,t,n){super.onDblClick(e,t,n),this.notify("edge:dblclick",this.getEventArgs(e,t,n))}onContextMenu(e,t,n){super.onContextMenu(e,t,n),this.notify("edge:contextmenu",this.getEventArgs(e,t,n))}onMouseDown(e,t,n){this.notifyMouseDown(e,t,n);switch(e.target.getAttribute("class")){case"vertex":return void this.startVertexDragging(e,t,n);case"vertex-remove":case"vertex-remove-area":return void this.handleVertexRemoving(e,t,n);case"connection":case"connection-wrap":return void this.handleVertexAdding(e,t,n);case"arrowhead":return void this.startArrowheadDragging(e,t,n);case"source-marker":case"target-marker":return void this.notifyUnhandledMouseDown(e,t,n)}this.startEdgeDragging(e,t,n)}onMouseMove(e,t,n){const r=this.getEventData(e);switch(r.action){case"drag-vertex":this.dragVertex(e,t,n);break;case"drag-label":this.dragLabel(e,t,n);break;case"drag-arrowhead":this.dragArrowhead(e,t,n);break;case"drag-edge":this.dragEdge(e,t,n)}return this.notifyMouseMove(e,t,n),r}onMouseUp(e,t,n){const r=this.getEventData(e);switch(r.action){case"drag-vertex":this.stopVertexDragging(e,t,n);break;case"drag-label":this.stopLabelDragging(e,t,n);break;case"drag-arrowhead":this.stopArrowheadDragging(e,t,n);break;case"drag-edge":this.stopEdgeDragging(e,t,n)}return this.notifyMouseUp(e,t,n),this.checkMouseleave(e),r}onMouseOver(e){super.onMouseOver(e),this.notify("edge:mouseover",this.getEventArgs(e))}onMouseOut(e){super.onMouseOut(e),this.notify("edge:mouseout",this.getEventArgs(e))}onMouseEnter(e){super.onMouseEnter(e),this.notify("edge:mouseenter",this.getEventArgs(e))}onMouseLeave(e){super.onMouseLeave(e),this.notify("edge:mouseleave",this.getEventArgs(e))}onMouseWheel(e,t,n,r){super.onMouseWheel(e,t,n,r),this.notify("edge:mousewheel",Object.assign({delta:r},this.getEventArgs(e,t,n)))}onCustomEvent(e,t,n,r){if(Jg(e.target,"edge-tool",this.container)){if(e.stopPropagation(),this.can("useEdgeTools")){if("edge:remove"===t)return void this.cell.remove({ui:!0});this.notify("edge:customevent",Object.assign({name:t},this.getEventArgs(e,n,r)))}this.notifyMouseDown(e,n,r)}else this.notify("edge:customevent",Object.assign({name:t},this.getEventArgs(e,n,r))),super.onCustomEvent(e,t,n,r)}onLabelMouseDown(e,t,n){this.notifyMouseDown(e,t,n),this.startLabelDragging(e,t,n);this.getEventData(e).stopPropagation&&e.stopPropagation()}startEdgeDragging(e,t,n){this.can("edgeMovable")?this.setEventData(e,{x:t,y:n,moving:!1,action:"drag-edge"}):this.notifyUnhandledMouseDown(e,t,n)}dragEdge(e,t,n){const r=this.getEventData(e);r.moving||(r.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(t-r.x,n-r.y,{ui:!0}),this.setEventData(e,{x:t,y:n}),this.notify("edge:moving",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})}stopEdgeDragging(e,t,n){const r=this.getEventData(e);r.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})),r.moving=!1}prepareArrowheadDragging(e,t){const n=this.getTerminalMagnet(e),r={action:"drag-arrowhead",x:t.x,y:t.y,isNewEdge:!0===t.isNewEdge,terminalType:e,initialMagnet:n,initialTerminal:ec(this.cell[e]),fallbackAction:t.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(e),options:t.options};return this.beforeArrowheadDragging(r),r}createValidateConnectionArgs(e){const t=[];let n;t[4]=e,t[5]=this;let r=0,i=0;"source"===e?(r=2,n="target"):(i=2,n="source");const o=this.cell[n],s=o.cell;if(s){let e;const n=t[r]=this.graph.renderer.findViewByCell(s);n&&(e=n.getMagnetFromEdgeTerminal(o),e===n.container&&(e=void 0)),t[r+1]=e}return(e,n)=>(t[i]=e,t[i+1]=e.container===n?void 0:n,t)}beforeArrowheadDragging(e){e.zIndex=this.cell.zIndex,this.cell.toFront();const t=this.container.style;e.pointerEvents=t.pointerEvents,t.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(e)}afterArrowheadDragging(e){null!=e.zIndex&&(this.cell.setZIndex(e.zIndex,{ui:!0}),e.zIndex=null);this.container.style.pointerEvents=e.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(e)}arrowheadDragging(e,t,n,r){r.x=t,r.y=n,r.currentTarget!==e&&(r.currentMagnet&&r.currentView&&r.currentView.unhighlight(r.currentMagnet,{type:"magnetAdsorbed"}),r.currentView=this.graph.renderer.findViewByElem(e),r.currentView?(r.currentMagnet=r.currentView.findMagnet(e),r.currentMagnet&&this.graph.hook.validateConnection(...r.getValidateConnectionArgs(r.currentView,r.currentMagnet),r.currentView.getEdgeTerminal(r.currentMagnet,t,n,this.cell,r.terminalType))?r.currentView.highlight(r.currentMagnet,{type:"magnetAdsorbed"}):r.currentMagnet=null):r.currentMagnet=null),r.currentTarget=e,this.cell.prop(r.terminalType,{x:t,y:n},Object.assign(Object.assign({},r.options),{ui:!0}))}arrowheadDragged(e,t,n){const r=e.currentView,i=e.currentMagnet;if(!i||!r)return;r.unhighlight(i,{type:"magnetAdsorbed"});const o=e.terminalType,s=r.getEdgeTerminal(i,t,n,this.cell,o);this.cell.setTerminal(o,s,{ui:!0})}snapArrowhead(e,t,n){const r=this.graph,i=r.options.connecting.snap,o="object"==typeof i&&i.radius||50,s=r.renderer.findViewsInArea({x:e-o,y:t-o,width:2*o,height:2*o}),a=n.closestView||null,l=n.closestMagnet||null;let c;n.closestView=null,n.closestMagnet=null;let u=Number.MAX_SAFE_INTEGER;const h=new Tm(e,t);let d;s.forEach((i=>{"false"!==i.container.getAttribute("magnet")&&(c=i.cell.getBBox().getCenter().distance(h),c<o&&c<u&&(l===i.container||r.hook.validateConnection(...n.getValidateConnectionArgs(i,null),i.getEdgeTerminal(i.container,e,t,this.cell,n.terminalType)))&&(u=c,n.closestView=i,n.closestMagnet=i.container)),i.container.querySelectorAll("[magnet]").forEach((s=>{if("false"!==s.getAttribute("magnet")){const a=i.getBBoxOfElement(s);c=h.distance(a.getCenter()),c<o&&c<u&&(l===s||r.hook.validateConnection(...n.getValidateConnectionArgs(i,s),i.getEdgeTerminal(s,e,t,this.cell,n.terminalType)))&&(u=c,n.closestView=i,n.closestMagnet=s)}}))}));const f=n.terminalType,p=n.closestView,g=n.closestMagnet,m=l!==g;if(a&&m&&a.unhighlight(l,{type:"magnetAdsorbed"}),p){if(!m)return;p.highlight(g,{type:"magnetAdsorbed"}),d=p.getEdgeTerminal(g,e,t,this.cell,f)}else d={x:e,y:t};this.cell.setTerminal(f,d,{},Object.assign(Object.assign({},n.options),{ui:!0}))}snapArrowheadEnd(e){const t=e.closestView,n=e.closestMagnet;t&&n&&(t.unhighlight(n,{type:"magnetAdsorbed"}),e.currentMagnet=t.findMagnet(n)),e.closestView=null,e.closestMagnet=null}finishEmbedding(e){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(e.zIndex=null)}fallbackConnection(e){if("remove"===e.fallbackAction)this.cell.remove({ui:!0});else this.cell.prop(e.terminalType,e.initialTerminal,{ui:!0})}notifyConnectionEvent(e,t){const n=e.terminalType,r=e.initialTerminal,i=this.cell[n];if(i&&!wC.equalTerminals(r,i)){const o=this.graph,s=r,a=s.cell?o.getCellById(s.cell):null,l=s.port,c=a?o.findViewByCell(a):null,u=a||e.isNewEdge?null:Tm.create(r).toJSON(),h=i,d=h.cell?o.getCellById(h.cell):null,f=h.port,p=d?o.findViewByCell(d):null,g=d?null:Tm.create(i).toJSON();this.notify("edge:connected",{e:t,previousCell:a,previousPort:l,previousView:c,previousPoint:u,currentCell:d,currentView:p,currentPort:f,currentPoint:g,previousMagnet:e.initialMagnet,currentMagnet:e.currentMagnet,edge:this.cell,view:this,type:n,isNew:e.isNewEdge})}}highlightAvailableMagnets(e){const t=this.graph,n=t.model.getCells();e.marked={};for(let r=0,i=n.length;r<i;r+=1){const i=t.renderer.findViewByCell(n[r]);if(!i)continue;const o=Array.prototype.slice.call(i.container.querySelectorAll("[magnet]"));"false"!==i.container.getAttribute("magnet")&&o.push(i.container);const s=o.filter((n=>t.hook.validateConnection(...e.getValidateConnectionArgs(i,n),i.getEdgeTerminal(n,e.x,e.y,this.cell,e.terminalType))));if(s.length>0){for(let e=0,t=s.length;e<t;e+=1)i.highlight(s[e],{type:"magnetAvailable"});i.highlight(null,{type:"nodeAvailable"}),e.marked[i.cell.id]=s}}}unhighlightAvailableMagnets(e){const t=e.marked||{};Object.keys(t).forEach((e=>{const n=this.graph.renderer.findViewByCell(e);if(n){t[e].forEach((e=>{n.unhighlight(e,{type:"magnetAvailable"})})),n.unhighlight(null,{type:"nodeAvailable"})}})),e.marked=null}startArrowheadDragging(e,t,n){if(!this.can("arrowheadMovable"))return void this.notifyUnhandledMouseDown(e,t,n);const r=e.target.getAttribute("data-terminal"),i=this.prepareArrowheadDragging(r,{x:t,y:n});this.setEventData(e,i)}dragArrowhead(e,t,n){const r=this.getEventData(e);this.graph.options.connecting.snap?this.snapArrowhead(t,n,r):this.arrowheadDragging(this.getEventTarget(e),t,n,r)}stopArrowheadDragging(e,t,n){const r=this.graph,i=this.getEventData(e);r.options.connecting.snap?this.snapArrowheadEnd(i):this.arrowheadDragged(i,t,n);r.hook.validateEdge(this.cell,i.terminalType,i.initialTerminal)?(this.finishEmbedding(i),this.notifyConnectionEvent(i,e)):this.fallbackConnection(i),this.afterArrowheadDragging(i)}startLabelDragging(e,t,n){if(this.can("edgeLabelMovable")){const t=e.currentTarget,n=parseInt(t.getAttribute("data-index"),10),r=this.getLabelPositionAngle(n),i=this.getLabelPositionArgs(n),o=this.getDefaultLabelPositionArgs(),s=this.mergeLabelPositionArgs(i,o);this.setEventData(e,{index:n,positionAngle:r,positionArgs:s,stopPropagation:!0,action:"drag-label"})}else this.setEventData(e,{stopPropagation:!0});this.graph.view.delegateDragEvents(e,this)}dragLabel(e,t,n){const r=this.getEventData(e),i=this.cell.getLabelAt(r.index),o=rd({},i,{position:this.getLabelPosition(t,n,r.positionAngle,r.positionArgs)});this.cell.setLabelAt(r.index,o)}stopLabelDragging(e,t,n){}handleVertexAdding(e,t,n){if(!this.can("vertexAddable"))return void this.notifyUnhandledMouseDown(e,t,n);const r=this.addVertex({x:t,y:n},{ui:!0});this.setEventData(e,{index:r,action:"drag-vertex"})}handleVertexRemoving(e,t,n){if(!this.can("vertexDeletable"))return void this.notifyUnhandledMouseDown(e,t,n);const r=e.target,i=parseInt(r.getAttribute("idx"),10);this.cell.removeVertexAt(i)}startVertexDragging(e,t,n){if(!this.can("vertexMovable"))return void this.notifyUnhandledMouseDown(e,t,n);const r=e.target,i=parseInt(r.getAttribute("idx"),10);this.setEventData(e,{index:i,action:"drag-vertex"})}dragVertex(e,t,n){const r=this.getEventData(e);this.cell.setVertexAt(r.index,{x:t,y:n},{ui:!0})}stopVertexDragging(e,t,n){}}!function(e){e.toStringTag=`X6.${e.name}`,e.isEdgeView=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.isNodeView&&"function"==typeof r.isEdgeView&&"function"==typeof r.confirmUpdate&&"function"==typeof r.update&&"function"==typeof r.getConnection}}(EC||(EC={})),EC.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],vertices:["vertices","update"],vertexMarkup:["vertices"],toolMarkup:["tools"],tools:["widget"]},shortLength:105,longLength:155,toolsOffset:40,doubleTools:!1,doubleToolsOffset:65,sampleInterval:50}),EC.registry.register("edge",EC,!0);class _C extends _x{constructor(){super(...arguments),this.scalableNode=null,this.rotatableNode=null,this.scalableSelector="scalable",this.rotatableSelector="rotatable",this.defaultPortMarkup=yx.getPortMarkup(),this.defaultPortLabelMarkup=yx.getPortLabelMarkup(),this.defaultPortContainerMarkup=yx.getPortContainerMarkup(),this.portsCache={}}get[Symbol.toStringTag](){return _C.toStringTag}getContainerClassName(){const e=[super.getContainerClassName(),this.prefixClassName("node")];return this.can("nodeMovable")||e.push(this.prefixClassName("node-immovable")),e.join(" ")}updateClassName(e){const t=e.target;if(t.hasAttribute("magnet")){const e=this.prefixClassName("port-unconnectable");this.can("magnetConnectable")?Gg(t,e):Fg(t,e)}else{const e=this.prefixClassName("node-immovable");this.can("nodeMovable")?this.removeClass(e):this.addClass(e)}}isNodeView(){return!0}confirmUpdate(e,t={}){let n=e;return this.hasAction(n,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(n,"render")?(this.render(),n=this.removeAction(n,["render","update","resize","translate","rotate","ports","tools"])):(n=this.handleAction(n,"resize",(()=>this.resize(t)),"update"),n=this.handleAction(n,"update",(()=>this.update()),"ports"),n=this.handleAction(n,"translate",(()=>this.translate())),n=this.handleAction(n,"rotate",(()=>this.rotate())),n=this.handleAction(n,"ports",(()=>this.renderPorts())),n=this.handleAction(n,"tools",(()=>this.renderTools()))),n}update(e){this.cleanCache(),this.removePorts();const t=this.cell,n=t.getSize(),r=t.getAttrs();this.updateAttrs(this.container,r,{attrs:e===r?null:e,rootBBox:new Pm(0,0,n.width,n.height),selectors:this.selectors,scalableNode:this.scalableNode,rotatableNode:this.rotatableNode}),this.renderPorts()}renderMarkup(){const e=this.cell.markup;if(e)return"string"==typeof e?this.renderStringMarkup(e):this.renderJSONMarkup(e);throw new TypeError("Invalid node markup.")}renderJSONMarkup(e){const t=this.parseJSONMarkup(e,this.container),n=e=>Array.isArray(e)?e[0]:e;this.selectors=t.selectors,this.rotatableNode=n(this.selectors[this.rotatableSelector]),this.scalableNode=n(this.selectors[this.scalableSelector]),this.container.appendChild(t.fragment)}renderStringMarkup(e){nm(this.container,ev.toNodes(ev.createVectors(e))),this.rotatableNode=Zg(this.container,`.${this.rotatableSelector}`),this.scalableNode=Zg(this.container,`.${this.scalableSelector}`),this.selectors={},this.rootSelector&&(this.selectors[this.rootSelector]=this.container)}render(){return this.empty(),this.renderMarkup(),this.scalableNode&&this.update(),this.resize(),this.rotatableNode?(this.rotate(),this.translate()):this.updateTransform(),this.renderTools(),this}resize(e={}){if(this.scalableNode)return this.updateSize(e);this.cell.getAngle()&&this.rotate(),this.update()}translate(){if(this.rotatableNode)return this.updateTranslation();this.updateTransform()}rotate(){if(this.rotatableNode)return this.updateRotation(),void this.update();this.updateTransform()}getTranslationString(){const e=this.cell.getPosition();return`translate(${e.x},${e.y})`}getRotationString(){const e=this.cell.getAngle();if(e){const t=this.cell.getSize();return`rotate(${e},${t.width/2},${t.height/2})`}}updateTransform(){let e=this.getTranslationString();const t=this.getRotationString();t&&(e+=` ${t}`),this.container.setAttribute("transform",e)}updateRotation(){if(null!=this.rotatableNode){const e=this.getRotationString();null!=e?this.rotatableNode.setAttribute("transform",e):this.rotatableNode.removeAttribute("transform")}}updateTranslation(){this.container.setAttribute("transform",this.getTranslationString())}updateSize(e={}){const t=this.cell,n=t.getSize(),r=t.getAngle(),i=this.scalableNode;let o=!1;i.getElementsByTagName("path").length>0&&(o=!0);const s=Sv(i,{recursive:o}),a=n.width/(s.width||1),l=n.height/(s.height||1);i.setAttribute("transform",`scale(${a},${l})`);const c=this.rotatableNode;if(null!=c){const o=c.getAttribute("transform");if(o){c.setAttribute("transform",`${o} rotate(${-r},${n.width/2},${n.height/2})`);const s=Sv(i,{target:this.graph.view.stage});t.prop("position",{x:s.x,y:s.y},Object.assign({updated:!0},e)),this.translate(),this.rotate()}}this.update()}findPortElem(e,t){const n=e?this.portsCache[e]:null;if(!n)return null;const r=n.portContentElement,i=n.portContentSelectors||{};return this.findOne(t,r,i)}initializePorts(){this.cleanPortsCache()}refreshPorts(){this.removePorts(),this.cleanPortsCache(),this.renderPorts()}cleanPortsCache(){this.portsCache={}}removePorts(){Object.keys(this.portsCache).forEach((e=>{em(this.portsCache[e].portElement)}))}renderPorts(){const e=this.getPortsContainer(),t=[];e.childNodes.forEach((e=>{t.push(e)}));const n=Ju(this.cell.getParsedPorts(),"zIndex"),r="auto";n.auto&&n.auto.forEach((n=>{const r=this.getPortElement(n);e.append(r),t.push(r)})),Object.keys(n).forEach((e=>{if(e!==r){const r=parseInt(e,10);this.appendPorts(n[e],r,t)}})),this.updatePorts()}getPortsContainer(){return this.rotatableNode||this.container}appendPorts(e,t,n){const r=e.map((e=>this.getPortElement(e)));n[t]||t<0?rm(n[Math.max(t,0)],r):nm(this.getPortsContainer(),r)}getPortElement(e){const t=this.portsCache[e.id];return t?t.portElement:this.createPortElement(e)}createPortElement(e){let t=yx.renderMarkup(this.getPortContainerMarkup());const n=t.elem;if(null==n)throw new Error("Invalid port container markup.");t=yx.renderMarkup(this.getPortMarkup(e));const r=t.elem,i=t.selectors;if(null==r)throw new Error("Invalid port markup.");this.setAttrs({port:e.id,"port-group":e.group},r),t=yx.renderMarkup(this.getPortLabelMarkup(e.label));const o=t.elem,s=t.selectors;if(null==o)throw new Error("Invalid port label markup.");let a;if(i&&s){for(const e in s)if(i[e]&&e!==this.rootSelector)throw new Error("Selectors within port must be unique.");a=Object.assign(Object.assign({},i),s)}else a=i||s;return Fg(n,"x6-port"),Fg(r,"x6-port-body"),Fg(o,"x6-port-label"),n.appendChild(r),n.appendChild(o),this.portsCache[e.id]={portElement:n,portSelectors:a,portLabelElement:o,portLabelSelectors:s,portContentElement:r,portContentSelectors:i},this.graph.hook.onPortRendered({port:e,node:this.cell,container:n,selectors:a,labelContainer:o,labelSelectors:s,contentContainer:r,contentSelectors:i}),n}updatePorts(){this.updatePortGroup();const e=this.cell.getParsedGroups();Object.keys(e).forEach((e=>this.updatePortGroup(e)))}updatePortGroup(e){const t=Pm.fromSize(this.cell.getSize()),n=this.cell.getPortsLayoutByGroup(e,t);for(let e=0,t=n.length;e<t;e+=1){const t=n[e],r=t.portId,i=this.portsCache[r]||{},o=t.portLayout;if(this.applyPortTransform(i.portElement,o),null!=t.portAttrs){const e={selectors:i.portSelectors||{}};t.portSize&&(e.rootBBox=Pm.fromSize(t.portSize)),this.updateAttrs(i.portElement,t.portAttrs,e)}const s=t.labelLayout;if(s&&(this.applyPortTransform(i.portLabelElement,s,-(o.angle||0)),s.attrs)){const e={selectors:i.portLabelSelectors||{}};t.labelSize&&(e.rootBBox=Pm.fromSize(t.labelSize)),this.updateAttrs(i.portLabelElement,s.attrs,e)}}}applyPortTransform(e,t,n=0){const r=t.angle,i=t.position;Tv(e,mv().rotate(n).translate(i.x||0,i.y||0).rotate(r||0),{absolute:!0})}getPortContainerMarkup(){return this.cell.getPortContainerMarkup()||this.defaultPortContainerMarkup}getPortMarkup(e){return e.markup||this.cell.portMarkup||this.defaultPortMarkup}getPortLabelMarkup(e){return e.markup||this.cell.portLabelMarkup||this.defaultPortLabelMarkup}getEventArgs(e,t,n){const r=this,i=r.cell;return null==t||null==n?{e:e,view:r,node:i,cell:i}:{e:e,x:t,y:n,view:r,node:i,cell:i}}notifyMouseDown(e,t,n){super.onMouseDown(e,t,n),this.notify("node:mousedown",this.getEventArgs(e,t,n))}notifyMouseMove(e,t,n){super.onMouseMove(e,t,n),this.notify("node:mousemove",this.getEventArgs(e,t,n))}notifyMouseUp(e,t,n){super.onMouseUp(e,t,n),this.notify("node:mouseup",this.getEventArgs(e,t,n))}onClick(e,t,n){super.onClick(e,t,n),this.notify("node:click",this.getEventArgs(e,t,n))}onDblClick(e,t,n){super.onDblClick(e,t,n),this.notify("node:dblclick",this.getEventArgs(e,t,n))}onContextMenu(e,t,n){super.onContextMenu(e,t,n),this.notify("node:contextmenu",this.getEventArgs(e,t,n))}onMouseDown(e,t,n){this.isPropagationStopped(e)||(this.notifyMouseDown(e,t,n),this.startNodeDragging(e,t,n))}onMouseMove(e,t,n){const r=this.getEventData(e),i=r.action;if("magnet"===i)this.dragMagnet(e,t,n);else{if("move"===i){const i=r.targetView||this;i.dragNode(e,t,n),i.notify("node:moving",{e:e,x:t,y:n,view:i,cell:i.cell,node:i.cell})}this.notifyMouseMove(e,t,n)}this.setEventData(e,r)}onMouseUp(e,t,n){const r=this.getEventData(e),i=r.action;if("magnet"===i)this.stopMagnetDragging(e,t,n);else if(this.notifyMouseUp(e,t,n),"move"===i){(r.targetView||this).stopNodeDragging(e,t,n)}const o=r.targetMagnet;o&&this.onMagnetClick(e,o,t,n),this.checkMouseleave(e)}onMouseOver(e){super.onMouseOver(e),this.notify("node:mouseover",this.getEventArgs(e))}onMouseOut(e){super.onMouseOut(e),this.notify("node:mouseout",this.getEventArgs(e))}onMouseEnter(e){this.updateClassName(e),super.onMouseEnter(e),this.notify("node:mouseenter",this.getEventArgs(e))}onMouseLeave(e){super.onMouseLeave(e),this.notify("node:mouseleave",this.getEventArgs(e))}onMouseWheel(e,t,n,r){super.onMouseWheel(e,t,n,r),this.notify("node:mousewheel",Object.assign({delta:r},this.getEventArgs(e,t,n)))}onMagnetClick(e,t,n,r){this.graph.view.getMouseMovedCount(e)>this.graph.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet:t},this.getEventArgs(e,n,r)))}onMagnetDblClick(e,t,n,r){this.notify("node:magnet:dblclick",Object.assign({magnet:t},this.getEventArgs(e,n,r)))}onMagnetContextMenu(e,t,n,r){this.notify("node:magnet:contextmenu",Object.assign({magnet:t},this.getEventArgs(e,n,r)))}onMagnetMouseDown(e,t,n,r){this.startMagnetDragging(e,n,r)}onCustomEvent(e,t,n,r){this.notify("node:customevent",Object.assign({name:t},this.getEventArgs(e,n,r))),super.onCustomEvent(e,t,n,r)}prepareEmbedding(e){const t=this.getEventData(e).cell||this.cell,n=this.graph.findViewByCell(t),r=this.graph.snapToGrid(e.clientX,e.clientY);this.notify("node:embed",{e:e,node:t,view:n,cell:t,x:r.x,y:r.y,currentParent:t.getParent()})}processEmbedding(e,t){const n=t.cell||this.cell,r=t.graph||this.graph,i=r.options.embedding,o=i.findParent;let s="function"==typeof o?Tg(o,r,{view:this,node:this.cell}).filter((e=>lC.isCell(e)&&this.cell.id!==e.id&&!e.isDescendantOf(this.cell))):r.model.getNodesUnderNode(n,{by:o});i.frontOnly&&(s=s.slice(-1));let a=null;const l=t.candidateEmbedView,c=i.validate;for(let e=s.length-1;e>=0;e-=1){const t=s[e];if(l&&l.cell.id===t.id){a=l;break}{const e=t.findView(r);if(Tg(c,r,{child:this.cell,parent:e.cell,childView:this,parentView:e})){a=e;break}}}this.clearEmbedding(t),a&&a.highlight(null,{type:"embedding"}),t.candidateEmbedView=a;const u=r.snapToGrid(e.clientX,e.clientY);this.notify("node:embedding",{e:e,cell:n,node:n,view:r.findViewByCell(n),x:u.x,y:u.y,currentParent:n.getParent(),candidateParent:a?a.cell:null})}clearEmbedding(e){const t=e.candidateEmbedView;t&&(t.unhighlight(null,{type:"embedding"}),e.candidateEmbedView=null)}finalizeEmbedding(e,t){const n=t.cell||this.cell,r=t.graph||this.graph,i=r.findViewByCell(n),o=n.getParent(),s=t.candidateEmbedView;s?(s.unhighlight(null,{type:"embedding"}),t.candidateEmbedView=null,null!=o&&o.id===s.cell.id||s.cell.insertChild(n,void 0,{ui:!0})):o&&o.unembed(n,{ui:!0}),r.model.getConnectedEdges(n,{deep:!0}).forEach((e=>{e.updateParent({ui:!0})}));const a=r.snapToGrid(e.clientX,e.clientY);i&&i.notify("node:embedded",{e:e,cell:n,x:a.x,y:a.y,node:n,view:r.findViewByCell(n),previousParent:o,currentParent:n.getParent()})}getDelegatedView(){let e=this.cell,t=this;for(;t&&!e.isEdge();){if(!e.hasParent()||t.can("stopDelegateOnDragging"))return t;e=e.getParent(),t=this.graph.renderer.findViewByCell(e)}return null}startMagnetDragging(e,t,n){if(!this.can("magnetConnectable"))return;e.stopPropagation();const r=e.currentTarget,i=this.graph;this.setEventData(e,{targetMagnet:r}),i.hook.validateMagnet(this,r,e)?(i.options.magnetThreshold<=0&&this.startConnectting(e,r,t,n),this.setEventData(e,{action:"magnet"}),this.stopPropagation(e)):this.onMouseDown(e,t,n),i.view.delegateDragEvents(e,this)}startConnectting(e,t,n,r){this.graph.model.startBatch("add-edge");const i=this.createEdgeFromMagnet(t,n,r);i.notifyMouseDown(e,n,r),i.setEventData(e,i.prepareArrowheadDragging("target",{x:n,y:r,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(e,{edgeView:i})}createEdgeFromMagnet(e,t,n){const r=this.graph,i=r.model,o=r.hook.getDefaultEdge(this,e);return o.setSource(Object.assign(Object.assign({},o.getSource()),this.getEdgeTerminal(e,t,n,o,"source"))),o.setTarget(Object.assign(Object.assign({},o.getTarget()),{x:t,y:n})),o.addTo(i,{async:!1,ui:!0}),o.findView(r)}dragMagnet(e,t,n){const r=this.getEventData(e),i=r.edgeView;if(i)i.onMouseMove(e,t,n),this.autoScrollGraph(e.clientX,e.clientY);else{const i=this.graph,o=i.options.magnetThreshold,s=this.getEventTarget(e),a=r.targetMagnet;if("onleave"===o){if(a===s||a.contains(s))return}else if(i.view.getMouseMovedCount(e)<=o)return;this.startConnectting(e,a,t,n)}}stopMagnetDragging(e,t,n){const r=this.eventData(e).edgeView;r&&(r.onMouseUp(e,t,n),this.graph.model.stopBatch("add-edge"))}notifyUnhandledMouseDown(e,t,n){this.notify("node:unhandled:mousedown",{e:e,x:t,y:n,view:this,cell:this.cell,node:this.cell})}notifyNodeMove(e,t,n,r,i){let o=[i];const s=this.graph.selection.widget;if(s&&s.options.movable){const e=this.graph.getSelectedCells();e.includes(i)&&(o=e.filter((e=>e.isNode())))}o.forEach((i=>{this.notify(e,{e:t,x:n,y:r,cell:i,node:i,view:i.findView(this.graph)})}))}startNodeDragging(e,t,n){const r=this.getDelegatedView();if(null==r||!r.can("nodeMovable"))return this.notifyUnhandledMouseDown(e,t,n);this.setEventData(e,{targetView:r,action:"move"});const i=Tm.create(r.cell.getPosition());r.setEventData(e,{moving:!1,offset:i.diff(t,n),restrict:this.graph.hook.getRestrictArea(r)})}dragNode(e,t,n){const r=this.cell,i=this.graph,o=i.getGridSize(),s=this.getEventData(e),a=s.offset,l=s.restrict;s.moving||(s.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",e,t,n,this.cell)),this.autoScrollGraph(e.clientX,e.clientY);const c=Ab.snapToGrid(t+a.x,o),u=Ab.snapToGrid(n+a.y,o);r.setPosition(c,u,{restrict:l,deep:!0,ui:!0}),i.options.embedding.enabled&&(s.embedding||(this.prepareEmbedding(e),s.embedding=!0),this.processEmbedding(e,s))}stopNodeDragging(e,t,n){const r=this.getEventData(e);r.embedding&&this.finalizeEmbedding(e,r),r.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",e,t,n,this.cell)),r.moving=!1,r.embedding=!1}autoScrollGraph(e,t){const n=this.graph.scroller.widget;n&&n.autoScroll(e,t)}}!function(e){e.toStringTag=`X6.${e.name}`,e.isNodeView=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.isNodeView&&"function"==typeof r.isEdgeView&&"function"==typeof r.confirmUpdate&&"function"==typeof r.update&&"function"==typeof r.findPortElem&&"function"==typeof r.resize&&"function"==typeof r.rotate&&"function"==typeof r.translate}}(_C||(_C={})),_C.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}}),_C.registry.register("node",_C,!0);const SC=gC("text");class OC extends(vC("text",{view:SC,attrs:{text:{fontSize:18,fill:"#000000",stroke:null,refX:.5,refY:.5}}},{noText:!0})){}!function(e){class t extends _C{confirmUpdate(e,t={}){let n=super.confirmUpdate(e,t);return this.hasAction(n,"scale")&&(this.resize(),n=this.removeAction(n,"scale")),n}}e.View=t,t.config({actions:{attrs:["scale"]}}),_C.registry.register(SC,t)}(OC||(OC={}));class AC extends nx{constructor(e,t={}){super(),this.length=0,this.comparator=t.comparator||"zIndex",this.clean(),e&&this.reset(e,{silent:!0})}toJSON(){return this.cells.map((e=>e.toJSON()))}add(e,t,n){let r,i;"number"==typeof t?(r=t,i=Object.assign({merge:!1},n)):(r=this.length,i=Object.assign({merge:!1},t)),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);const o=Array.isArray(e)?e:[e],s=this.comparator&&"number"!=typeof t&&!1!==i.sort,a=this.comparator||null;let l=!1;const c=[],u=[];return o.forEach((e=>{const t=this.get(e);t?i.merge&&!e.isSameStore(t)&&(t.setProp(e.getProp(),n),u.push(t),s&&!l&&(l=null==a||"function"==typeof a?t.hasChanged():"string"==typeof a?t.hasChanged(a):a.some((e=>t.hasChanged(e))))):(c.push(e),this.reference(e))})),c.length&&(s&&(l=!0),this.cells.splice(r,0,...c),this.length=this.cells.length),l&&this.sort({silent:!0}),i.silent||(c.forEach(((e,t)=>{const n={cell:e,index:r+t,options:i};this.trigger("added",n),i.dryrun||e.notify("added",Object.assign({},n))})),l&&this.trigger("sorted"),(c.length||u.length)&&this.trigger("updated",{added:c,merged:u,removed:[],options:i})),this}remove(e,t={}){const n=Array.isArray(e)?e:[e],r=this.removeCells(n,t);return!t.silent&&r.length>0&&this.trigger("updated",{options:t,removed:r,added:[],merged:[]}),Array.isArray(e)?r:r[0]}removeCells(e,t){const n=[];for(let r=0;r<e.length;r+=1){const i=this.get(e[r]);if(null==i)continue;const o=this.cells.indexOf(i);this.cells.splice(o,1),this.length-=1,delete this.map[i.id],n.push(i),this.unreference(i),t.dryrun||i.remove(),t.silent||(this.trigger("removed",{cell:i,index:o,options:t}),t.dryrun||i.notify("removed",{cell:i,index:o,options:t}))}return n}reset(e,t={}){const n=this.cells.slice();if(n.forEach((e=>this.unreference(e))),this.clean(),this.add(e,Object.assign({silent:!0},t)),!t.silent){const e=this.cells.slice();this.trigger("reseted",{options:t,previous:n,current:e});const r=[],i=[];e.forEach((e=>{const t=n.some((t=>t.id===e.id));t||r.push(e)})),n.forEach((t=>{const n=e.some((e=>e.id===t.id));n||i.push(t)})),this.trigger("updated",{options:t,added:r,removed:i,merged:[]})}return this}push(e,t){return this.add(e,this.length,t)}pop(e){const t=this.at(this.length-1);return this.remove(t,e)}unshift(e,t){return this.add(e,0,t)}shift(e){const t=this.at(0);return this.remove(t,e)}get(e){if(null==e)return null;const t="string"==typeof e||"number"==typeof e?e:e.id;return this.map[t]||null}has(e){return null!=this.get(e)}at(e){return e<0&&(e+=this.length),this.cells[e]||null}first(){return this.at(0)}last(){return this.at(-1)}indexOf(e){return this.cells.indexOf(e)}toArray(){return this.cells.slice()}sort(e={}){return null!=this.comparator&&(this.cells=Nf(this.cells,this.comparator),e.silent||this.trigger("sorted")),this}clone(){return new(0,this.constructor)(this.cells.slice(),{comparator:this.comparator})}reference(e){this.map[e.id]=e,e.on("*",this.notifyCellEvent,this)}unreference(e){e.off("*",this.notifyCellEvent,this),delete this.map[e.id]}notifyCellEvent(e,t){const n=t.cell;this.trigger(`cell:${e}`,t),n&&(n.isNode()?this.trigger(`node:${e}`,Object.assign(Object.assign({},t),{node:n})):n.isEdge()&&this.trigger(`edge:${e}`,Object.assign(Object.assign({},t),{edge:n})))}clean(){this.length=0,this.cells=[],this.map={}}}class kC extends nx{constructor(e=[]){super(),this.batches={},this.addings=new WeakMap,this.nodes={},this.edges={},this.outgoings={},this.incomings={},this.collection=new AC(e),this.setup()}get[Symbol.toStringTag](){return kC.toStringTag}notify(e,t){this.trigger(e,t);const n=this.graph;return n&&("sorted"===e||"reseted"===e||"updated"===e?n.trigger(`model:${e}`,t):n.trigger(e,t)),this}setup(){const e=this.collection;e.on("sorted",(()=>this.notify("sorted",null))),e.on("updated",(e=>this.notify("updated",e))),e.on("cell:change:zIndex",(()=>this.sortOnChangeZ())),e.on("added",(({cell:e})=>{this.onCellAdded(e)})),e.on("removed",(e=>{const t=e.cell;this.onCellRemoved(t,e.options),this.notify("cell:removed",e),t.isNode()?this.notify("node:removed",Object.assign(Object.assign({},e),{node:t})):t.isEdge()&&this.notify("edge:removed",Object.assign(Object.assign({},e),{edge:t}))})),e.on("reseted",(e=>{this.onReset(e.current),this.notify("reseted",e)})),e.on("edge:change:source",(({edge:e})=>this.onEdgeTerminalChanged(e,"source"))),e.on("edge:change:target",(({edge:e})=>{this.onEdgeTerminalChanged(e,"target")}))}sortOnChangeZ(){this.collection.sort()}onCellAdded(e){const t=e.id;e.isEdge()?(e.updateParent(),this.edges[t]=!0,this.onEdgeTerminalChanged(e,"source"),this.onEdgeTerminalChanged(e,"target")):this.nodes[t]=!0}onCellRemoved(e,t){const n=e.id;if(e.isEdge()){delete this.edges[n];const t=e.getSource(),r=e.getTarget();if(t&&t.cell){const e=this.outgoings[t.cell],r=e?e.indexOf(n):-1;r>=0&&(e.splice(r,1),0===e.length&&delete this.outgoings[t.cell])}if(r&&r.cell){const e=this.incomings[r.cell],t=e?e.indexOf(n):-1;t>=0&&(e.splice(t,1),0===e.length&&delete this.incomings[r.cell])}}else delete this.nodes[n];t.clear||(t.disconnectEdges?this.disconnectConnectedEdges(e,t):this.removeConnectedEdges(e,t)),e.model===this&&(e.model=null)}onReset(e){this.nodes={},this.edges={},this.outgoings={},this.incomings={},e.forEach((e=>this.onCellAdded(e)))}onEdgeTerminalChanged(e,t){const n="source"===t?this.outgoings:this.incomings,r=e.previous(t);if(r&&r.cell){const t=n[r.cell],i=t?t.indexOf(e.id):-1;i>=0&&(t.splice(i,1),0===t.length&&delete n[r.cell])}const i=e.getTerminal(t);if(i&&i.cell){const t=n[i.cell]||[];-1===t.indexOf(e.id)&&t.push(e.id),n[i.cell]=t}}prepareCell(e,t){return e.model||t&&t.dryrun||(e.model=this),null==e.zIndex&&e.setZIndex(this.getMaxZIndex()+1,{silent:!0}),e}resetCells(e,t={}){return e.map((e=>this.prepareCell(e,Object.assign(Object.assign({},t),{dryrun:!0})))),this.collection.reset(e,t),e.map((e=>this.prepareCell(e,{options:t}))),this}clear(e={}){const t=this.getCells();if(0===t.length)return this;const n=Object.assign(Object.assign({},e),{clear:!0});return this.batchUpdate("clear",(()=>{const e=t.sort(((e,t)=>(e.isEdge()?1:2)-(t.isEdge()?1:2)));for(;e.length>0;){const t=e.shift();t&&t.remove(n)}}),n),this}addNode(e,t={}){const n=hC.isNode(e)?e:this.createNode(e);return this.addCell(n,t),n}createNode(e){return hC.create(e)}addEdge(e,t={}){const n=wC.isEdge(e)?e:this.createEdge(e);return this.addCell(n,t),n}createEdge(e){return wC.create(e)}addCell(e,t={}){return Array.isArray(e)?this.addCells(e,t):(this.collection.has(e)||this.addings.has(e)||(this.addings.set(e,!0),this.collection.add(this.prepareCell(e,t),t),e.eachChild((e=>this.addCell(e,t))),this.addings.delete(e)),this)}addCells(e,t={}){const n=e.length;if(0===n)return this;const r=Object.assign(Object.assign({},t),{position:n-1,maxPosition:n-1});return this.startBatch("add",Object.assign(Object.assign({},r),{cells:e})),e.forEach((e=>{this.addCell(e,r),r.position-=1})),this.stopBatch("add",Object.assign(Object.assign({},r),{cells:e})),this}removeCell(e,t={}){const n="string"==typeof e?this.getCell(e):e;return n&&this.has(n)?this.collection.remove(n,t):null}removeCells(e,t={}){return e.length?this.batchUpdate("remove",(()=>e.map((e=>this.removeCell(e,t))))):[]}removeConnectedEdges(e,t={}){const n=this.getConnectedEdges(e);return n.forEach((e=>{e.remove(t)})),n}disconnectConnectedEdges(e,t={}){const n="string"==typeof e?e:e.id;this.getConnectedEdges(e).forEach((e=>{const r=e.getSourceCell(),i=e.getTargetCell();r&&r.id===n&&e.setSource({x:0,y:0},t),i&&i.id===n&&e.setTarget({x:0,y:0},t)}))}has(e){return this.collection.has(e)}total(){return this.collection.length}indexOf(e){return this.collection.indexOf(e)}getCell(e){return this.collection.get(e)}getCells(){return this.collection.toArray()}getFirstCell(){return this.collection.first()}getLastCell(){return this.collection.last()}getMinZIndex(){const e=this.collection.first();return e&&e.getZIndex()||0}getMaxZIndex(){const e=this.collection.last();return e&&e.getZIndex()||0}getCellsFromCache(e){return e?Object.keys(e).map((e=>this.getCell(e))).filter((e=>null!=e)):[]}getNodes(){return this.getCellsFromCache(this.nodes)}getEdges(){return this.getCellsFromCache(this.edges)}getOutgoingEdges(e){const t="string"==typeof e?e:e.id,n=this.outgoings[t];return n?n.map((e=>this.getCell(e))).filter((e=>e&&e.isEdge())):null}getIncomingEdges(e){const t="string"==typeof e?e:e.id,n=this.incomings[t];return n?n.map((e=>this.getCell(e))).filter((e=>e&&e.isEdge())):null}getConnectedEdges(e,t={}){const n=[],r="string"==typeof e?this.getCell(e):e;if(null==r)return n;const i={},o=t.indirect;let s=t.incoming,a=t.outgoing;null==s&&null==a&&(s=a=!0);const l=(e,t)=>{const r=t?this.getOutgoingEdges(e):this.getIncomingEdges(e);if(null!=r&&r.forEach((e=>{i[e.id]||(n.push(e),i[e.id]=!0,o&&(s&&l(e,!1),a&&l(e,!0)))})),o&&e.isEdge()){const r=t?e.getTargetCell():e.getSourceCell();r&&r.isEdge()&&(i[r.id]||(n.push(r),l(r,t)))}};if(a&&l(r,!0),s&&l(r,!1),t.deep){const e=r.getDescendants({deep:!0}),o={};e.forEach((e=>{e.isNode()&&(o[e.id]=!0)}));const l=(e,r)=>{const s=r?this.getOutgoingEdges(e.id):this.getIncomingEdges(e.id);null!=s&&s.forEach((e=>{if(!i[e.id]){const r=e.getSourceCell(),s=e.getTargetCell();if(!t.enclosed&&r&&o[r.id]&&s&&o[s.id])return;n.push(e),i[e.id]=!0}}))};e.forEach((e=>{e.isEdge()||(a&&l(e,!0),s&&l(e,!1))}))}return n}isBoundary(e,t){const n="string"==typeof e?this.getCell(e):e,r=t?this.getIncomingEdges(n):this.getOutgoingEdges(n);return null==r||0===r.length}getBoundaryNodes(e){const t=[];return Object.keys(this.nodes).forEach((n=>{if(this.isBoundary(n,e)){const e=this.getCell(n);e&&t.push(e)}})),t}getRoots(){return this.getBoundaryNodes(!0)}getLeafs(){return this.getBoundaryNodes(!1)}isRoot(e){return this.isBoundary(e,!0)}isLeaf(e){return this.isBoundary(e,!1)}getNeighbors(e,t={}){let n=t.incoming,r=t.outgoing;null==n&&null==r&&(n=r=!0);const i=this.getConnectedEdges(e,t).reduce(((i,o)=>{const s=o.hasLoop(t),a=o.getSourceCell(),l=o.getTargetCell();return n&&a&&a.isNode()&&!i[a.id]&&(!s&&(a===e||t.deep&&a.isDescendantOf(e))||(i[a.id]=a)),r&&l&&l.isNode()&&!i[l.id]&&(!s&&(l===e||t.deep&&l.isDescendantOf(e))||(i[l.id]=l)),i}),{});if(e.isEdge()){if(n){const t=e.getSourceCell();t&&t.isNode()&&!i[t.id]&&(i[t.id]=t)}if(r){const t=e.getTargetCell();t&&t.isNode()&&!i[t.id]&&(i[t.id]=t)}}return Object.keys(i).map((e=>i[e]))}isNeighbor(e,t,n={}){let r=n.incoming,i=n.outgoing;return null==r&&null==i&&(r=i=!0),this.getConnectedEdges(e,n).some((e=>{const n=e.getSourceCell(),o=e.getTargetCell();return!(!r||!n||n.id!==t.id)||!(!i||!o||o.id!==t.id)}))}getSuccessors(e,t={}){const n=[];return this.search(e,((r,i)=>{r!==e&&this.matchDistance(i,t.distance)&&n.push(r)}),Object.assign(Object.assign({},t),{outgoing:!0})),n}isSuccessor(e,t,n={}){let r=!1;return this.search(e,((i,o)=>{if(i===t&&i!==e&&this.matchDistance(o,n.distance))return r=!0,!1}),Object.assign(Object.assign({},n),{outgoing:!0})),r}getPredecessors(e,t={}){const n=[];return this.search(e,((r,i)=>{r!==e&&this.matchDistance(i,t.distance)&&n.push(r)}),Object.assign(Object.assign({},t),{incoming:!0})),n}isPredecessor(e,t,n={}){let r=!1;return this.search(e,((i,o)=>{if(i===t&&i!==e&&this.matchDistance(o,n.distance))return r=!0,!1}),Object.assign(Object.assign({},n),{incoming:!0})),r}matchDistance(e,t){return null==t||("function"==typeof t?t(e):!(!Array.isArray(t)||!t.includes(e))||e===t)}getCommonAncestor(...e){const t=[];return e.forEach((e=>{e&&(Array.isArray(e)?t.push(...e):t.push(e))})),lC.getCommonAncestor(...t)}getSubGraph(e,t={}){const n=[],r={},i=[],o=[],s=e=>{r[e.id]||(n.push(e),r[e.id]=e,e.isEdge()&&o.push(e),e.isNode()&&i.push(e))};return e.forEach((e=>{if(s(e),t.deep){e.getDescendants({deep:!0}).forEach((e=>s(e)))}})),o.forEach((e=>{const t=e.getSourceCell(),o=e.getTargetCell();t&&!r[t.id]&&(n.push(t),r[t.id]=t,t.isNode()&&i.push(t)),o&&!r[o.id]&&(n.push(o),r[o.id]=o,o.isNode()&&i.push(o))})),i.forEach((e=>{this.getConnectedEdges(e,t).forEach((e=>{const t=e.getSourceCell(),i=e.getTargetCell();!r[e.id]&&t&&r[t.id]&&i&&r[i.id]&&(n.push(e),r[e.id]=e)}))})),n}cloneSubGraph(e,t={}){const n=this.getSubGraph(e,t);return this.cloneCells(n)}cloneCells(e){return lC.cloneCells(e)}getNodesFromPoint(e,t){const n="number"==typeof e?{x:e,y:t||0}:e;return this.getNodes().filter((e=>e.getBBox().containsPoint(n)))}getNodesInArea(e,t,n,r,i){const o="number"==typeof e?new Pm(e,t,n,r):Pm.create(e),s="number"==typeof e?i:t,a=s&&s.strict;return this.getNodes().filter((e=>{const t=e.getBBox();return a?o.containsRect(t):o.isIntersectWithRect(t)}))}getEdgesInArea(e,t,n,r,i){const o="number"==typeof e?new Pm(e,t,n,r):Pm.create(e),s="number"==typeof e?i:t,a=s&&s.strict;return this.getEdges().filter((e=>{const t=e.getBBox();return 0===t.width?t.inflate(1,0):0===t.height&&t.inflate(0,1),a?o.containsRect(t):o.isIntersectWithRect(t)}))}getNodesUnderNode(e,t={}){const n=e.getBBox();return(null==t.by||"bbox"===t.by?this.getNodesInArea(n):this.getNodesFromPoint(n[t.by])).filter((t=>e.id!==t.id&&!t.isDescendantOf(e)))}getAllCellsBBox(){return this.getCellsBBox(this.getCells())}getCellsBBox(e,t={}){return lC.getCellsBBox(e,t)}search(e,t,n={}){n.breadthFirst?this.breadthFirstSearch(e,t,n):this.depthFirstSearch(e,t,n)}breadthFirstSearch(e,t,n={}){const r=[],i={},o={};for(r.push(e),o[e.id]=0;r.length>0;){const e=r.shift();if(null==e||i[e.id])continue;if(i[e.id]=!0,!1===Tg(t,this,e,o[e.id]))continue;this.getNeighbors(e,n).forEach((t=>{o[t.id]=o[e.id]+1,r.push(t)}))}}depthFirstSearch(e,t,n={}){const r=[],i={},o={};for(r.push(e),o[e.id]=0;r.length>0;){const e=r.pop();if(null==e||i[e.id])continue;if(i[e.id]=!0,!1===Tg(t,this,e,o[e.id]))continue;const s=this.getNeighbors(e,n),a=r.length;s.forEach((t=>{o[t.id]=o[e.id]+1,r.splice(a,0,t)}))}}getShortestPath(e,t,n={}){const r={};this.getEdges().forEach((e=>{const t=e.getSourceCellId(),i=e.getTargetCellId();t&&i&&(r[t]||(r[t]=[]),r[i]||(r[i]=[]),r[t].push(i),n.directed||r[i].push(t))}));const i="string"==typeof e?e:e.id,o=ix.run(r,i,n.weight),s=[];let a="string"==typeof t?t:t.id;for(o[a]&&s.push(a);a=o[a];)s.unshift(a);return s}translate(e,t,n){return this.getCells().filter((e=>!e.hasParent())).forEach((r=>r.translate(e,t,n))),this}resize(e,t,n){return this.resizeCells(e,t,this.getCells(),n)}resizeCells(e,t,n,r={}){const i=this.getCellsBBox(n);if(i){const o=Math.max(e/i.width,0),s=Math.max(t/i.height,0),a=i.getOrigin();n.forEach((e=>e.scale(o,s,a,r)))}return this}toJSON(e={}){return kC.toJSON(this.getCells(),e)}parseJSON(e){return kC.fromJSON(e)}fromJSON(e,t={}){const n=this.parseJSON(e);return this.resetCells(n,t),this}startBatch(e,t={}){return this.batches[e]=(this.batches[e]||0)+1,this.notify("batch:start",{name:e,data:t}),this}stopBatch(e,t={}){return this.batches[e]=(this.batches[e]||0)-1,this.notify("batch:stop",{name:e,data:t}),this}batchUpdate(e,t,n={}){this.startBatch(e,n);const r=t();return this.stopBatch(e,n),r}hasActiveBatch(e=Object.keys(this.batches)){return(Array.isArray(e)?e:[e]).some((e=>this.batches[e]>0))}}!function(e){e.toStringTag=`X6.${e.name}`,e.isModel=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.addNode&&"function"==typeof r.addEdge&&null!=r.collection}}(kC||(kC={})),function(e){e.toJSON=function(e,t={}){return{cells:e.map((e=>e.toJSON(t)))}},e.fromJSON=function(e){const t=[];return Array.isArray(e)?t.push(...e):(e.cells&&t.push(...e.cells),e.nodes&&e.nodes.forEach((e=>{null==e.shape&&(e.shape="rect"),t.push(e)})),e.edges&&e.edges.forEach((e=>{null==e.shape&&(e.shape="edge"),t.push(e)}))),t.map((e=>{const t=e.shape;if(t){if(hC.registry.exist(t))return hC.create(e);if(wC.registry.exist(t))return wC.create(e)}throw new Error("The `shape` should be specipied when creating a node/edge instance")}))}}(kC||(kC={}));const MC=".text-block-content",TC=gC("text-block");class PC extends hC{get content(){return this.getContent()}set content(e){this.setContent(e)}getContent(){return this.store.get("content","")}setContent(e,t={}){this.store.set("content",e,t)}setup(){super.setup(),this.store.on("change:*",(e=>{const t=e.key;"content"===t?this.updateContent(this.getContent()):"size"===t&&this.updateSize(this.getSize())})),this.updateSize(this.getSize()),this.updateContent(this.getContent())}updateSize(e){gr.SUPPORT_FOREIGNOBJECT&&this.setAttrs({foreignObject:Object.assign({},e),[MC]:{style:Object.assign({},e)}})}updateContent(e){gr.SUPPORT_FOREIGNOBJECT?this.setAttrs({[MC]:{html:e?Eg(e):""}}):this.setAttrs({[MC]:{text:e}})}}function DC(e,t="body"){return[{tagName:e,selector:t},{tagName:"text",selector:"label"}]}function NC(e,t,n={}){const r={constructorName:e,markup:DC(e,n.selector),attrs:{[e]:Object.assign({},fC.bodyAttr)}};return(n.parent||fC).define(rd(r,t,{shape:e}))}!function(e){e.config({type:TC,view:TC,markup:['<g class="rotatable">','<g class="scalable"><rect/></g>',gr.SUPPORT_FOREIGNOBJECT?["<foreignObject>",'<body xmlns="http://www.w3.org/1999/xhtml">',`<div class="${MC.substr(1)}" />`,"</body>","</foreignObject>"].join(""):`<text class="${MC.substr(1)}"/>`,"</g>"].join(""),attrs:{".":{fill:"#ffffff",stroke:"none"},rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000",fontSize:14,fontFamily:"Arial, helvetica, sans-serif"},body:{style:{background:"transparent",position:"static",margin:0,padding:0}},foreignObject:{style:{overflow:"hidden"}},[MC]:{refX:.5,refY:.5,yAlign:"middle",xAlign:"middle",style:{textAlign:"center",verticalAlign:"middle",display:"table-cell",padding:"0 5px",margin:0}}}}),hC.registry.register(TC,e)}(PC||(PC={})),function(e){const t="content";class n extends _C{confirmUpdate(e,n={}){let r=super.confirmUpdate(e,n);return this.hasAction(r,t)&&(this.updateContent(),r=this.removeAction(r,t)),r}update(e){if(gr.SUPPORT_FOREIGNOBJECT)super.update(e);else{const t=this.cell,n=Object.assign({},e||t.getAttrs());delete n[MC],super.update(n),e&&!oh(e,MC)||this.updateContent(e)}}updateContent(e){if(gr.SUPPORT_FOREIGNOBJECT)super.update(e);else{const t=this.cell,n=(e||t.getAttrs())[MC],r=ov(t.getContent(),t.getSize(),n,{svgDocument:this.graph.view.svg}),i={[MC]:rd({},n,{text:r})};super.update(i)}}}e.View=n,function(e){e.config({bootstrap:["render",t],actions:gr.SUPPORT_FOREIGNOBJECT?{}:{size:t,content:t}}),_C.registry.register(TC,e)}(n=e.View||(e.View={}))}(PC||(PC={})),fC.define({shape:"empty"}),NC("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}}),hC.define({shape:"rect-headered",markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerText"},{tagName:"text",selector:"bodyText"}],attrs:{body:Object.assign(Object.assign({},fC.bodyAttr),{refWidth:"100%",refHeight:"100%"}),header:Object.assign(Object.assign({},fC.bodyAttr),{refWidth:"100%",height:30,stroke:"#000000"}),headerText:Object.assign(Object.assign({},fC.labelAttr),{refX:"50%",refY:15,fontSize:16}),bodyText:Object.assign(Object.assign({},fC.labelAttr),{refY2:15})}}),NC("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}});fC.define({shape:"cylinder",overwrite:!0,markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],attrs:{body:Object.assign(Object.assign({},fC.bodyAttr),{lateral:10}),top:Object.assign(Object.assign({},fC.bodyAttr),{refCx:"50%",refRx:"50%",cy:10,ry:10})},attrHooks:{lateral:{set(e,{refBBox:t}){const n=Sg(e);n&&(e=parseFloat(e)/100);const r=t.x,i=t.y,o=t.width,s=t.height,a=n?s*e:e,l=.551784,c=l*(o/2),u=l*a,h=r+o/2,d=r+o,f=i+a,p=f-a,g=i+s-a,m=i+s;return{d:["M",r,f,"L",r,g,"C",r,g+u,h-c,m,h,m,"C",h+c,m,d,g+u,d,g,"L",d,f,"C",d,f-u,h+c,p,h,p,"C",h-c,p,r,f-u,r,f,"Z"].join(" ")}}}},knob:{enabled:!0,position:({node:e})=>({x:0,y:e.attr("body/lateral")}),onMouseMove({node:e,data:t,deltaY:n}){if(0!==n){const r=e.getBBox(),i=e.attr("body/lateral");null==t.round&&(t.round=i);const o=0,s=r.height/2,a=il(t.round+n,o,s);a!==i&&e.attr({body:{lateral:a},top:{cy:a,ry:a}})}}}}),NC("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});var RC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class IC extends fC{get points(){return this.getPoints()}set points(e){this.setPoints(e)}getPoints(){return this.getAttrByPath("body/refPoints")}setPoints(e,t){return null==e?this.removePoints():this.setAttrByPath("body/refPoints",IC.pointsToString(e),t),this}removePoints(){return this.removeAttrByPath("body/refPoints"),this}}!function(e){function t(e){return"string"==typeof e?e:e.map((e=>Array.isArray(e)?e.join(","):Tm.isPointLike(e)?`${e.x}, ${e.y}`:"")).join(" ")}e.pointsToString=t,e.config({propHooks(e){const{points:n}=e,r=RC(e,["points"]);if(n){const e=t(n);e&&mg(r,"attrs/body/refPoints",e)}return r}})}(IC||(IC={})),NC("polygon",{},{parent:IC}),NC("polyline",{},{parent:IC});var jC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};fC.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks(e){const{path:t}=e,n=jC(e,["path"]);return t&&mg(n,"attrs/body/refD",t),n}});var LC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};fC.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},gr.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:Hg.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},fC.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks(e){const{text:t}=e,n=LC(e,["text"]);return t&&mg(n,"attrs/label/text",t),n},attrHooks:{text:{set(e,{cell:t,view:n,refBBox:r,elem:i,attrs:o}){if(!(i instanceof HTMLElement)){const s=o.style||{},a={text:e,width:-5,height:"100%"},l=Object.assign({textVerticalAnchor:"middle"},s);return Tg(cb.presets.textWrap.set,this,a,{cell:t,view:n,elem:i,refBBox:r,attrs:l}),{fill:s.color||null}}i.textContent=e},position(e,{refBBox:t,elem:n}){if(n instanceof SVGElement)return t.getCenter()}}}}),NC("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:mC()},{selector:"image"}),NC("image-bordered",{markup:[{tagName:"rect",selector:"background",attrs:{stroke:"none"}},{tagName:"image",selector:"image"},{tagName:"rect",selector:"border",attrs:{fill:"none"}},{tagName:"text",selector:"label"}],attrs:{background:{refWidth:-1,refHeight:-1,x:.5,y:.5,fill:"#ffffff"},border:{refWidth:"100%",refHeight:"100%",stroke:"#333333",strokeWidth:2},image:{refWidth:-1,refHeight:-1,x:.5,y:.5}},propHooks:mC()}),NC("image-embedded",{markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}],attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#FFFFFF",strokeWidth:2},image:{refWidth:"30%",refHeight:-20,x:10,y:10,preserveAspectRatio:"xMidYMin"}},propHooks:mC()}),NC("image-inscribed",{propHooks:mC(),markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"image"},{tagName:"ellipse",selector:"border",attrs:{fill:"none"}},{tagName:"text",selector:"label"}],attrs:{border:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",stroke:"#333333",strokeWidth:2},background:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",fill:"#ffffff"},image:{refWidth:"68%",refHeight:"68%",refX:"16%",refY:"16%",preserveAspectRatio:"xMidYMid"}}});const FC=wC.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}});wC.define({shape:"shadow-edge",markup:[{tagName:"path",selector:"shadow",attrs:{fill:"none"}},{tagName:"path",selector:"line",attrs:{fill:"none",cursor:"pointer"}}],attrs:{line:{connection:!0,stroke:"#FF0000",strokeWidth:20,strokeLinejoin:"round",targetMarker:{name:"path",stroke:"none",d:"M 0 -10 -10 0 0 10 z",offsetX:-5},sourceMarker:{name:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z",offsetX:-5}},shadow:{connection:!0,refX:3,refY:6,stroke:"#000000",strokeOpacity:.2,strokeWidth:20,strokeLinejoin:"round",targetMarker:{name:"path",d:"M 0 -10 -10 0 0 10 z",stroke:"none",offsetX:-5},sourceMarker:{name:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z",offsetX:-5}}}}),wC.define({shape:"double-edge",markup:[{tagName:"path",selector:"outline",attrs:{fill:"none"}},{tagName:"path",selector:"line",attrs:{fill:"none",cursor:"pointer"}}],attrs:{line:{connection:!0,stroke:"#dddddd",strokeWidth:4,strokeLinejoin:"round",targetMarker:{tagName:"path",stroke:"#000000",d:"M 10 -3 10 -10 -2 0 10 10 10 3"}},outline:{connection:!0,stroke:"#000000",strokeWidth:6,strokeLinejoin:"round"}}});class GC extends fC{get html(){return this.getHTML()}set html(e){this.setHTML(e)}getHTML(){return this.store.get("html")}setHTML(e,t={}){return null==e?this.removeHTML(t):this.store.set("html",e,t),this}removeHTML(e={}){return this.store.remove("html",e)}}!function(e){class t extends _C{init(){super.init(),this.cell.on("change:*",(()=>{this.graph.hook.shouldUpdateHTMLComponent(this.cell)&&this.renderHTMLComponent()}))}confirmUpdate(e){const n=super.confirmUpdate(e);return this.handleAction(n,t.action,(()=>this.renderHTMLComponent()))}renderHTMLComponent(){const e=this.selectors.foContent;if(e){const t=this.$(e).empty(),n=this.graph.hook.getHTMLComponent(this.cell);n&&("string"==typeof n?t.html(n):t.append(n))}}}e.View=t,function(e){e.action="html",e.config({bootstrap:[e.action],actions:{html:e.action}}),_C.registry.register("html-view",e)}(t=e.View||(e.View={}))}(GC||(GC={})),function(e){e.config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},yx.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),hC.registry.register("html",e)}(GC||(GC={})),function(e){e.componentRegistry=Bv.create({type:"html componnet"})}(GC||(GC={}));var BC=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class zC extends rx{constructor(e){super(),this.delay=10,this.throttle=2,this.threshold=5,this.changeCount=0,this.timestamp=0,this.options=Object.assign(Object.assign({},zC.defaultOptions),e),this.graph.model.on("cell:change:*",this.onModelChanged,this)}get graph(){return this.options.graph}onModelChanged(){if(this.disabled)return;const e=((new Date).getTime()-this.timestamp)/1e3;e>this.delay||this.changeCount>=this.threshold&&e>this.throttle?(this.save(),this.reset()):this.changeCount+=1}save(){this.trigger("save")}reset(){this.changeCount=0,this.timestamp=(new Date).getTime()}dispose(){this.graph.model.off("cell:change:*",this.onModelChanged,this)}}BC([rx.dispose()],zC.prototype,"dispose",null),function(e){e.defaultOptions={delay:10,throttle:2,threshold:5}}(zC||(zC={}));class UC extends ex{constructor(e){super(),this.graph=e,this.init()}get options(){return this.graph.options}get model(){return this.graph.model}get view(){return this.graph.view}init(){}}var VC,HC=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class WC extends dx{constructor(e){super(),this.graph=e;const{selectors:t,fragment:n}=yx.parseJSONMarkup(WC.markup);this.background=t.background,this.grid=t.grid,this.svg=t.svg,this.defs=t.defs,this.viewport=t.viewport,this.primer=t.primer,this.stage=t.stage,this.decorator=t.decorator,this.overlay=t.overlay,this.container=this.options.container,this.restore=WC.snapshoot(this.container),this.$(this.container).addClass(this.prefixClassName("graph")).append(n),this.delegateEvents()}get model(){return this.graph.model}get options(){return this.graph.options}delegateEvents(){const e=this.constructor;return super.delegateEvents(e.events),this}guard(e,t){return"mousedown"===e.type&&2===e.button||(!(!this.options.guard||!this.options.guard(e,t))||(e.data&&void 0!==e.data.guarded?e.data.guarded:!(t&&t.cell&&lC.isCell(t.cell))&&(this.svg!==e.target&&this.container!==e.target&&!fr.contains(this.svg,e.target))))}findView(e){return this.graph.renderer.findViewByElem(e)}onDblClick(e){this.options.preventDefaultDblClick&&e.preventDefault();const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;const r=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onDblClick(t,r.x,r.y):this.graph.trigger("blank:dblclick",{e:t,x:r.x,y:r.y})}onClick(e){if(this.getMouseMovedCount(e)<=this.options.clickThreshold){const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;const r=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onClick(t,r.x,r.y):this.graph.trigger("blank:click",{e:t,x:r.x,y:r.y})}}onContextMenu(e){this.options.preventDefaultContextMenu&&e.preventDefault();const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;const r=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onContextMenu(t,r.x,r.y):this.graph.trigger("blank:contextmenu",{e:t,x:r.x,y:r.y})}delegateDragEvents(e,t){null==e.data&&(e.data={}),this.setEventData(e,{currentView:t||null,mouseMovedCount:0,startPosition:{x:e.clientX,y:e.clientY}});const n=this.constructor;this.delegateDocumentEvents(n.documentEvents,e.data),this.undelegateEvents()}getMouseMovedCount(e){return this.getEventData(e).mouseMovedCount||0}onMouseDown(e){const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;this.options.preventDefaultMouseDown&&t.preventDefault();const r=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onMouseDown(t,r.x,r.y):(this.options.preventDefaultBlankAction&&t.preventDefault(),this.graph.trigger("blank:mousedown",{e:t,x:r.x,y:r.y})),this.delegateDragEvents(t,n)}onMouseMove(e){const t=this.getEventData(e),n=t.startPosition;if(n&&n.x===e.clientX&&n.y===e.clientY)return;null==t.mouseMovedCount&&(t.mouseMovedCount=0),t.mouseMovedCount+=1;if(t.mouseMovedCount<=this.options.moveThreshold)return;const r=this.normalizeEvent(e),i=this.graph.snapToGrid(r.clientX,r.clientY),o=t.currentView;o?o.onMouseMove(r,i.x,i.y):this.graph.trigger("blank:mousemove",{e:r,x:i.x,y:i.y}),this.setEventData(r,t)}onMouseUp(e){this.undelegateDocumentEvents();const t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY),r=this.getEventData(e).currentView;r?r.onMouseUp(t,n.x,n.y):this.graph.trigger("blank:mouseup",{e:t,x:n.x,y:n.y}),e.isPropagationStopped()||this.onClick(fr.Event(e,{type:"click",data:e.data})),e.stopImmediatePropagation(),this.delegateEvents()}onMouseOver(e){const t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n))if(n)n.onMouseOver(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseover",{e:t})}}onMouseOut(e){const t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n))if(n)n.onMouseOut(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseout",{e:t})}}onMouseEnter(e){const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;const r=this.graph.renderer.findViewByElem(t.relatedTarget);if(n){if(r===n)return;n.onMouseEnter(t)}else{if(r)return;this.graph.trigger("graph:mouseenter",{e:t})}}onMouseLeave(e){const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;const r=this.graph.renderer.findViewByElem(t.relatedTarget);if(n){if(r===n)return;n.onMouseLeave(t)}else{if(r)return;this.graph.trigger("graph:mouseleave",{e:t})}}onMouseWheel(e){const t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;const r=t.originalEvent,i=this.graph.snapToGrid(r.clientX,r.clientY),o=Math.max(-1,Math.min(1,r.wheelDelta||-r.detail));n?n.onMouseWheel(t,i.x,i.y,o):this.graph.trigger("blank:mousewheel",{e:t,delta:o,x:i.x,y:i.y})}onCustomEvent(e){const t=e.currentTarget,n=t.getAttribute("event")||t.getAttribute("data-event");if(n){const r=this.findView(t);if(r){const t=this.normalizeEvent(e);if(this.guard(t,r))return;const i=this.graph.snapToGrid(t.clientX,t.clientY);r.onCustomEvent(t,n,i.x,i.y)}}}handleMagnetEvent(e,t){const n=e.currentTarget,r=n.getAttribute("magnet");if(r&&"false"!==r.toLowerCase()){const r=this.findView(n);if(r){const i=this.normalizeEvent(e);if(this.guard(i,r))return;const o=this.graph.snapToGrid(i.clientX,i.clientY);Tg(t,this.graph,r,i,n,o.x,o.y)}}}onMagnetMouseDown(e){this.handleMagnetEvent(e,((e,t,n,r,i)=>{e.onMagnetMouseDown(t,n,r,i)}))}onMagnetDblClick(e){this.handleMagnetEvent(e,((e,t,n,r,i)=>{e.onMagnetDblClick(t,n,r,i)}))}onMagnetContextMenu(e){this.options.preventDefaultContextMenu&&e.preventDefault(),this.handleMagnetEvent(e,((e,t,n,r,i)=>{e.onMagnetContextMenu(t,n,r,i)}))}onLabelMouseDown(e){const t=e.currentTarget,n=this.findView(t);if(n){const t=this.normalizeEvent(e);if(this.guard(t,n))return;const r=this.graph.snapToGrid(t.clientX,t.clientY);n.onLabelMouseDown(t,r.x,r.y)}}onImageDragStart(){return!1}dispose(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=()=>{}}}HC([dx.dispose()],WC.prototype,"dispose",null),function(e){const t=`${Ob.prefixCls}-graph`;e.markup=[{ns:Hg.xhtml,tagName:"div",selector:"background",className:`${t}-background`},{ns:Hg.xhtml,tagName:"div",selector:"grid",className:`${t}-grid`},{ns:Hg.svg,tagName:"svg",selector:"svg",className:`${t}-svg`,attrs:{width:"100%",height:"100%","xmlns:xlink":Hg.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:`${t}-svg-viewport`,children:[{tagName:"g",selector:"primer",className:`${t}-svg-primer`},{tagName:"g",selector:"stage",className:`${t}-svg-stage`},{tagName:"g",selector:"decorator",className:`${t}-svg-decorator`},{tagName:"g",selector:"overlay",className:`${t}-svg-overlay`}]}]}],e.snapshoot=function(e){const t=e.cloneNode();return e.childNodes.forEach((e=>t.appendChild(e))),()=>{for(tm(e);e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);for(let n=0,r=t.attributes.length;n<r;n+=1){const r=t.attributes[n];e.setAttribute(r.name,r.value)}t.childNodes.forEach((t=>e.appendChild(t)))}}}(WC||(WC={})),function(e){const t=Ob.prefixCls;e.events={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel",[`mouseenter  .${t}-cell`]:"onMouseEnter",[`mouseleave  .${t}-cell`]:"onMouseLeave",[`mouseenter  .${t}-cell-tools`]:"onMouseEnter",[`mouseleave  .${t}-cell-tools`]:"onMouseLeave",[`mousedown   .${t}-cell [event]`]:"onCustomEvent",[`touchstart  .${t}-cell [event]`]:"onCustomEvent",[`mousedown   .${t}-cell [data-event]`]:"onCustomEvent",[`touchstart  .${t}-cell [data-event]`]:"onCustomEvent",[`dblclick    .${t}-cell [magnet]`]:"onMagnetDblClick",[`contextmenu .${t}-cell [magnet]`]:"onMagnetContextMenu",[`mousedown   .${t}-cell [magnet]`]:"onMagnetMouseDown",[`touchstart  .${t}-cell [magnet]`]:"onMagnetMouseDown",[`dblclick    .${t}-cell [data-magnet]`]:"onMagnetDblClick",[`contextmenu .${t}-cell [data-magnet]`]:"onMagnetContextMenu",[`mousedown   .${t}-cell [data-magnet]`]:"onMagnetMouseDown",[`touchstart  .${t}-cell [data-magnet]`]:"onMagnetMouseDown",[`dragstart   .${t}-cell image`]:"onImageDragStart",[`mousedown   .${t}-edge .${t}-edge-label`]:"onLabelMouseDown",[`touchstart  .${t}-edge .${t}-edge-label`]:"onLabelMouseDown"},e.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}}(WC||(WC={})),function(e){e.checkScroller=function(e,t){return(n,r,i)=>{const o=i.value;i.value=function(...n){if(null==this.scroller.widget){const n=`Shoule enable scroller to use method '${r}'`;if(!1!==e)throw console.error(n),new Error(n);return!1!==t&&console.warn(n),this}return o.call(this,...n)}}}}(VC||(VC={}));var $C=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class XC extends UC{init(){XC.ensure()}dispose(){XC.clean()}}$C([XC.dispose()],XC.prototype,"dispose",null),function(e){let t,n=0;e.ensure=function(){if(n+=1,!(n>1||gr.isApplyingHMR())){t=document.createElement("style"),t.setAttribute("type","text/css"),t.textContent=".x6-graph {\n  position: relative;\n  outline: none;\n}\n.x6-graph-background,\n.x6-graph-grid,\n.x6-graph-svg {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.x6-graph-background-stage,\n.x6-graph-grid-stage,\n.x6-graph-svg-stage {\n  user-select: none;\n}\n.x6-graph.x6-graph-pannable {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n.x6-graph.x6-graph-panning {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  user-select: none;\n}\n.x6-node {\n  cursor: move;\n  /* stylelint-disable-next-line */\n}\n.x6-node.x6-node-immovable {\n  cursor: default;\n}\n.x6-node * {\n  -webkit-user-drag: none;\n}\n.x6-node .scalable * {\n  vector-effect: non-scaling-stroke;\n}\n.x6-node [magnet='true'] {\n  cursor: crosshair;\n  transition: opacity 0.3s;\n}\n.x6-node [magnet='true']:hover {\n  opacity: 0.7;\n}\n.x6-node foreignObject {\n  display: block;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-node foreignObject > body {\n  position: static;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-edge .source-marker,\n.x6-edge .target-marker {\n  vector-effect: non-scaling-stroke;\n}\n.x6-edge .connection {\n  stroke-linejoin: round;\n  fill: none;\n}\n.x6-edge .connection-wrap {\n  cursor: move;\n  opacity: 0;\n  fill: none;\n  stroke: #000;\n  stroke-width: 15;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n}\n.x6-edge .connection-wrap:hover {\n  opacity: 0.4;\n  stroke-opacity: 0.4;\n}\n.x6-edge .vertices {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .vertices .vertex {\n  fill: #1abc9c;\n}\n.x6-edge .vertices .vertex :hover {\n  fill: #34495e;\n  stroke: none;\n}\n.x6-edge .vertices .vertex-remove {\n  cursor: pointer;\n  fill: #fff;\n}\n.x6-edge .vertices .vertex-remove-area {\n  cursor: pointer;\n  opacity: 0.1;\n}\n.x6-edge .vertices .vertex-group:hover .vertex-remove-area {\n  opacity: 1;\n}\n.x6-edge .arrowheads {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .arrowheads .arrowhead {\n  fill: #1abc9c;\n}\n.x6-edge .arrowheads .arrowhead :hover {\n  fill: #f39c12;\n  stroke: none;\n}\n.x6-edge .tools {\n  cursor: pointer;\n  opacity: 0;\n}\n.x6-edge .tools .tool-options {\n  display: none;\n}\n.x6-edge .tools .tool-remove circle {\n  fill: #f00;\n}\n.x6-edge .tools .tool-remove path {\n  fill: #fff;\n}\n.x6-edge:hover .vertices,\n.x6-edge:hover .arrowheads,\n.x6-edge:hover .tools {\n  opacity: 1;\n}\n.x6-highlight-opacity {\n  opacity: 0.3;\n}\n@keyframes halo-pie-visibility {\n  0% {\n    visibility: hidden;\n  }\n  100% {\n    visibility: visible;\n  }\n}\n@keyframes halo-pie-opening {\n  0% {\n    transform: scale(0.4) rotate(-20deg);\n  }\n  100% {\n    transform: scale(1) rotate(0);\n  }\n}\n.x6-widget-handle {\n  position: absolute;\n  width: 20px;\n  height: 20px;\n  background-color: transparent;\n  background-repeat: no-repeat;\n  background-position: 0 0;\n  background-size: 20px 20px;\n  cursor: pointer;\n  user-select: none;\n  pointer-events: auto;\n  -webkit-user-drag: none;\n  user-drag: none;\n  /* stylelint-disable-line */\n}\n.x6-widget-handle.hidden {\n  display: none;\n}\n.x6-widget-handle-selected {\n  background-color: rgba(0, 0, 0, 0.1);\n  border-radius: 3px;\n}\n.x6-widget-handle-remove {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M15.386%2C3.365c-3.315-3.314-8.707-3.313-12.021%2C0c-3.314%2C3.315-3.314%2C8.706%2C0%2C12.02%20c3.314%2C3.314%2C8.707%2C3.314%2C12.021%2C0S18.699%2C6.68%2C15.386%2C3.365L15.386%2C3.365z%20M4.152%2C14.598C1.273%2C11.719%2C1.273%2C7.035%2C4.153%2C4.154%20c2.88-2.88%2C7.563-2.88%2C10.443%2C0c2.881%2C2.88%2C2.881%2C7.562%2C0%2C10.443C11.716%2C17.477%2C7.032%2C17.477%2C4.152%2C14.598L4.152%2C14.598z%22%2F%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M12.157%2C11.371L7.38%2C6.593C7.162%2C6.375%2C6.809%2C6.375%2C6.592%2C6.592c-0.218%2C0.219-0.218%2C0.572%2C0%2C0.79%20l4.776%2C4.776c0.218%2C0.219%2C0.571%2C0.219%2C0.79%2C0C12.375%2C11.941%2C12.375%2C11.588%2C12.157%2C11.371L12.157%2C11.371z%22%2F%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M11.369%2C6.593l-4.777%2C4.778c-0.217%2C0.217-0.217%2C0.568%2C0%2C0.787c0.219%2C0.219%2C0.571%2C0.217%2C0.788%2C0l4.777-4.777%20c0.218-0.218%2C0.218-0.571%2C0.001-0.789C11.939%2C6.375%2C11.587%2C6.375%2C11.369%2C6.593L11.369%2C6.593z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n  cursor: pointer;\n}\n.x6-widget-handle-remove:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M15.386%2C3.365c-3.315-3.314-8.707-3.313-12.021%2C0c-3.314%2C3.315-3.314%2C8.706%2C0%2C12.02%20c3.314%2C3.314%2C8.707%2C3.314%2C12.021%2C0S18.699%2C6.68%2C15.386%2C3.365L15.386%2C3.365z%22%2F%3E%3Cpath%20fill%3D%22%23FFFFFF%22%20d%3D%22M12.157%2C11.371L7.38%2C6.593C7.162%2C6.375%2C6.809%2C6.375%2C6.592%2C6.592c-0.218%2C0.219-0.218%2C0.572%2C0%2C0.79%20l4.776%2C4.776c0.218%2C0.219%2C0.571%2C0.219%2C0.79%2C0C12.375%2C11.941%2C12.375%2C11.588%2C12.157%2C11.371L12.157%2C11.371z%22%2F%3E%3Cpath%20fill%3D%22%23FFFFFF%22%20d%3D%22M11.369%2C6.593l-4.777%2C4.778c-0.217%2C0.217-0.217%2C0.568%2C0%2C0.787c0.219%2C0.219%2C0.571%2C0.217%2C0.788%2C0l4.777-4.777%20c0.218-0.218%2C0.218-0.571%2C0.001-0.789C11.939%2C6.375%2C11.587%2C6.375%2C11.369%2C6.593L11.369%2C6.593z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-rotate {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M9.374%2C17.592c-4.176%2C0-7.57-3.401-7.57-7.575c0-4.175%2C3.395-7.574%2C7.57-7.574c0.28%2C0%2C0.56%2C0.018%2C0.837%2C0.05%20V1.268c0-0.158%2C0.099-0.3%2C0.239-0.36c0.151-0.058%2C0.315-0.026%2C0.428%2C0.086l2.683%2C2.688c0.152%2C0.154%2C0.152%2C0.399%2C0%2C0.553l-2.68%2C2.693%20c-0.115%2C0.112-0.279%2C0.147-0.431%2C0.087c-0.141-0.063-0.239-0.205-0.239-0.361V5.296C9.934%2C5.243%2C9.654%2C5.22%2C9.374%2C5.22%20c-2.646%2C0-4.796%2C2.152-4.796%2C4.797s2.154%2C4.798%2C4.796%2C4.798c2.645%2C0%2C4.798-2.153%2C4.798-4.798c0-0.214%2C0.174-0.391%2C0.391-0.391h1.991%20c0.217%2C0%2C0.394%2C0.177%2C0.394%2C0.391C16.947%2C14.19%2C13.549%2C17.592%2C9.374%2C17.592L9.374%2C17.592z%20M9.374%2C17.592%22%2F%3E%3C%2Fsvg%3E%20');\n  cursor: move;\n}\n.x6-widget-handle-rotate:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M9.374%2C17.592c-4.176%2C0-7.57-3.401-7.57-7.575c0-4.175%2C3.395-7.574%2C7.57-7.574c0.28%2C0%2C0.56%2C0.018%2C0.837%2C0.05%20V1.268c0-0.158%2C0.099-0.3%2C0.239-0.36c0.151-0.058%2C0.315-0.026%2C0.428%2C0.086l2.683%2C2.688c0.152%2C0.154%2C0.152%2C0.399%2C0%2C0.553l-2.68%2C2.693%20c-0.115%2C0.112-0.279%2C0.147-0.431%2C0.087c-0.141-0.063-0.239-0.205-0.239-0.361V5.296C9.934%2C5.243%2C9.654%2C5.22%2C9.374%2C5.22%20c-2.646%2C0-4.796%2C2.152-4.796%2C4.797s2.154%2C4.798%2C4.796%2C4.798c2.645%2C0%2C4.798-2.153%2C4.798-4.798c0-0.214%2C0.174-0.391%2C0.391-0.391h1.991%20c0.217%2C0%2C0.394%2C0.177%2C0.394%2C0.391C16.947%2C14.19%2C13.549%2C17.592%2C9.374%2C17.592L9.374%2C17.592z%20M9.374%2C17.592%22%2F%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-resize {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3Csvg%20height%3D%2224px%22%20version%3D%221.1%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224px%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Asketch%3D%22http%3A%2F%2Fwww.bohemiancoding.com%2Fsketch%2Fns%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Ctitle%2F%3E%3Cdesc%2F%3E%3Cdefs%2F%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%20id%3D%22miu%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%3E%3Cg%20id%3D%22Artboard-1%22%20transform%3D%22translate(-251.000000%2C%20-443.000000)%22%3E%3Cg%20id%3D%22slice%22%20transform%3D%22translate(215.000000%2C%20119.000000)%22%2F%3E%3Cpath%20d%3D%22M252%2C448%20L256%2C448%20L256%2C444%20L252%2C444%20L252%2C448%20Z%20M257%2C448%20L269%2C448%20L269%2C446%20L257%2C446%20L257%2C448%20Z%20M257%2C464%20L269%2C464%20L269%2C462%20L257%2C462%20L257%2C464%20Z%20M270%2C444%20L270%2C448%20L274%2C448%20L274%2C444%20L270%2C444%20Z%20M252%2C462%20L252%2C466%20L256%2C466%20L256%2C462%20L252%2C462%20Z%20M270%2C462%20L270%2C466%20L274%2C466%20L274%2C462%20L270%2C462%20Z%20M254%2C461%20L256%2C461%20L256%2C449%20L254%2C449%20L254%2C461%20Z%20M270%2C461%20L272%2C461%20L272%2C449%20L270%2C449%20L270%2C461%20Z%22%20fill%3D%22%236A6C8A%22%20id%3D%22editor-crop-glyph%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E');\n  cursor: se-resize;\n}\n.x6-widget-handle-resize:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3Csvg%20height%3D%2224px%22%20version%3D%221.1%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224px%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Asketch%3D%22http%3A%2F%2Fwww.bohemiancoding.com%2Fsketch%2Fns%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Ctitle%2F%3E%3Cdesc%2F%3E%3Cdefs%2F%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%20id%3D%22miu%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%3E%3Cg%20id%3D%22Artboard-1%22%20transform%3D%22translate(-251.000000%2C%20-443.000000)%22%3E%3Cg%20id%3D%22slice%22%20transform%3D%22translate(215.000000%2C%20119.000000)%22%2F%3E%3Cpath%20d%3D%22M252%2C448%20L256%2C448%20L256%2C444%20L252%2C444%20L252%2C448%20Z%20M257%2C448%20L269%2C448%20L269%2C446%20L257%2C446%20L257%2C448%20Z%20M257%2C464%20L269%2C464%20L269%2C462%20L257%2C462%20L257%2C464%20Z%20M270%2C444%20L270%2C448%20L274%2C448%20L274%2C444%20L270%2C444%20Z%20M252%2C462%20L252%2C466%20L256%2C466%20L256%2C462%20L252%2C462%20Z%20M270%2C462%20L270%2C466%20L274%2C466%20L274%2C462%20L270%2C462%20Z%20M254%2C461%20L256%2C461%20L256%2C449%20L254%2C449%20L254%2C461%20Z%20M270%2C461%20L272%2C461%20L272%2C449%20L270%2C449%20L270%2C461%20Z%22%20fill%3D%22%23FD6EB6%22%20id%3D%22editor-crop-glyph%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E');\n}\n.x6-widget-handle-clone {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M12.852%2C0.875h-9.27c-0.853%2C0-1.547%2C0.694-1.547%2C1.547v10.816h1.547V2.422h9.27V0.875z%20M15.172%2C3.965h-8.5%20c-0.849%2C0-1.547%2C0.698-1.547%2C1.547v10.816c0%2C0.849%2C0.698%2C1.547%2C1.547%2C1.547h8.5c0.85%2C0%2C1.543-0.698%2C1.543-1.547V5.512%20C16.715%2C4.663%2C16.021%2C3.965%2C15.172%2C3.965L15.172%2C3.965z%20M15.172%2C16.328h-8.5V5.512h8.5V16.328z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n  cursor: move;\n}\n.x6-widget-handle-clone:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M12.852%2C0.875h-9.27c-0.853%2C0-1.547%2C0.694-1.547%2C1.547v10.816h1.547V2.422h9.27V0.875z%20M15.172%2C3.965h-8.5%20c-0.849%2C0-1.547%2C0.698-1.547%2C1.547v10.816c0%2C0.849%2C0.698%2C1.547%2C1.547%2C1.547h8.5c0.849%2C0%2C1.543-0.698%2C1.543-1.547V5.512%20C16.715%2C4.663%2C16.021%2C3.965%2C15.172%2C3.965L15.172%2C3.965z%20M15.172%2C16.328h-8.5V5.512h8.5V16.328z%20M15.172%2C16.328%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-link {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M9.884%2C9.838c0.54-0.551%2C1.005-0.955%2C1.384-1.201c0.463-0.308%2C0.749-0.352%2C0.887-0.352h1.34v1.367%20c0%2C0.104%2C0.061%2C0.2%2C0.154%2C0.242s0.204%2C0.027%2C0.284-0.038l3.168-2.669c0.06-0.051%2C0.096-0.125%2C0.096-0.203S17.16%2C6.83%2C17.101%2C6.781%20l-3.168-2.677c-0.08-0.067-0.19-0.081-0.284-0.038c-0.094%2C0.045-0.154%2C0.139-0.154%2C0.242v1.414h-1.343%20c-1.24%2C0.014-2.215%2C0.67-2.927%2C1.242c-0.797%2C0.65-1.533%2C1.447-2.245%2C2.217c-0.361%2C0.391-0.7%2C0.759-1.044%2C1.1%20c-0.541%2C0.549-1.011%2C0.951-1.395%2C1.199c-0.354%2C0.231-0.678%2C0.357-0.921%2C0.357h-1.8c-0.146%2C0-0.266%2C0.12-0.266%2C0.265v2.029%20c0%2C0.148%2C0.12%2C0.268%2C0.266%2C0.268h1.8l0%2C0c1.255-0.014%2C2.239-0.667%2C2.958-1.24c0.82-0.661%2C1.572-1.475%2C2.297-2.256%20C9.225%2C10.524%2C9.555%2C10.169%2C9.884%2C9.838z%22%2F%3E%3C%2Fsvg%3E%20');\n  cursor: move;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n}\n.x6-widget-handle-link:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M9.884%2C9.838c0.54-0.551%2C1.005-0.955%2C1.384-1.201c0.463-0.308%2C0.749-0.352%2C0.887-0.352h1.34v1.367%20c0%2C0.104%2C0.061%2C0.2%2C0.154%2C0.242s0.204%2C0.027%2C0.284-0.038l3.168-2.669c0.06-0.051%2C0.096-0.125%2C0.096-0.203S17.16%2C6.83%2C17.101%2C6.781%20l-3.168-2.677c-0.08-0.067-0.19-0.081-0.284-0.038c-0.094%2C0.045-0.154%2C0.139-0.154%2C0.242v1.414h-1.343%20c-1.24%2C0.014-2.215%2C0.67-2.927%2C1.242c-0.797%2C0.65-1.533%2C1.447-2.245%2C2.217c-0.361%2C0.391-0.7%2C0.759-1.044%2C1.1%20c-0.541%2C0.549-1.011%2C0.951-1.395%2C1.199c-0.354%2C0.231-0.678%2C0.357-0.921%2C0.357h-1.8c-0.146%2C0-0.266%2C0.12-0.266%2C0.265v2.029%20c0%2C0.148%2C0.12%2C0.268%2C0.266%2C0.268h1.8l0%2C0c1.255-0.014%2C2.239-0.667%2C2.958-1.24c0.82-0.661%2C1.572-1.475%2C2.297-2.256%20C9.225%2C10.524%2C9.555%2C10.169%2C9.884%2C9.838z%22%2F%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-fork {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20fill%3D%22%236A6C8A%22%20d%3D%22M13.307%2C11.593c-0.69%2C0-1.299%2C0.33-1.693%2C0.835l-4.136-2.387%20C7.552%2C9.82%2C7.602%2C9.589%2C7.602%2C9.344c0-0.25-0.051-0.487-0.129-0.71l4.097-2.364c0.393%2C0.536%2C1.022%2C0.888%2C1.737%2C0.888%20c1.193%2C0%2C2.16-0.967%2C2.16-2.159s-0.967-2.159-2.16-2.159c-1.191%2C0-2.158%2C0.967-2.158%2C2.159c0%2C0.076%2C0.014%2C0.149%2C0.021%2C0.223%20L6.848%2C7.716C6.469%2C7.39%2C5.982%2C7.185%2C5.442%2C7.185c-1.191%2C0-2.158%2C0.967-2.158%2C2.159s0.967%2C2.159%2C2.158%2C2.159%20c0.545%2C0%2C1.037-0.208%2C1.417-0.541l4.319%2C2.493c-0.014%2C0.098-0.029%2C0.194-0.029%2C0.296c0%2C1.193%2C0.967%2C2.159%2C2.158%2C2.159%20c1.193%2C0%2C2.16-0.966%2C2.16-2.159C15.467%2C12.559%2C14.5%2C11.593%2C13.307%2C11.593z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n  cursor: move;\n}\n.x6-widget-handle-fork:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20fill%3D%22%23FD6EB6%22%20d%3D%22M13.307%2C11.593c-0.69%2C0-1.299%2C0.33-1.693%2C0.835l-4.136-2.387%20c0.075-0.22%2C0.125-0.452%2C0.125-0.697c0-0.25-0.051-0.487-0.129-0.71l4.097-2.365c0.394%2C0.536%2C1.022%2C0.888%2C1.737%2C0.888%20c1.193%2C0%2C2.16-0.967%2C2.16-2.159s-0.967-2.159-2.16-2.159c-1.191%2C0-2.158%2C0.967-2.158%2C2.159c0%2C0.076%2C0.015%2C0.148%2C0.022%2C0.223%20L6.848%2C7.716C6.469%2C7.39%2C5.981%2C7.185%2C5.442%2C7.185c-1.191%2C0-2.158%2C0.967-2.158%2C2.159s0.967%2C2.159%2C2.158%2C2.159%20c0.545%2C0%2C1.037-0.208%2C1.417-0.541l4.319%2C2.493c-0.013%2C0.098-0.029%2C0.194-0.029%2C0.296c0%2C1.193%2C0.967%2C2.159%2C2.158%2C2.159%20c1.193%2C0%2C2.16-0.966%2C2.16-2.159C15.467%2C12.559%2C14.5%2C11.593%2C13.307%2C11.593z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-unlink {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M12.285%2C9.711l-2.104-0.302L9.243%2C8.568L6.669%2C7.095C6.948%2C6.6%2C6.995%2C6.026%2C6.845%2C5.474%20c-0.191-0.698-0.695-1.36-1.438-1.786C4.068%2C2.922%2C2.464%2C3.214%2C1.82%2C4.338C1.536%2C4.836%2C1.489%2C5.414%2C1.64%2C5.97%20c0.189%2C0.698%2C0.694%2C1.36%2C1.438%2C1.787c0.328%2C0.187%2C0.67%2C0.31%2C1.01%2C0.372c0.002%2C0%2C0.006%2C0.002%2C0.008%2C0.004%20c0.027%2C0.004%2C0.057%2C0.009%2C0.088%2C0.011c2.12%2C0.316%2C3.203%2C0.915%2C3.73%2C1.337c-0.527%2C0.424-1.61%2C1.021-3.731%2C1.339%20c-0.029%2C0.003-0.058%2C0.007-0.087%2C0.012c-0.002%2C0.002-0.004%2C0.002-0.007%2C0.003c-0.341%2C0.062-0.684%2C0.187-1.013%2C0.374%20c-0.74%2C0.425-1.246%2C1.089-1.437%2C1.787c-0.149%2C0.555-0.105%2C1.133%2C0.181%2C1.632c0.011%2C0.018%2C0.021%2C0.033%2C0.033%2C0.049l0.883%2C0.783%20c0.765%2C0.366%2C1.775%2C0.328%2C2.67-0.184c0.744-0.425%2C1.248-1.088%2C1.439-1.786c0.148-0.552%2C0.104-1.126-0.176-1.62l2.573-1.473%20c0.573%2C0.287%2C2.299%2C1.292%2C2.299%2C1.292s3.602%2C1.445%2C4.241%2C1.812c0.773%2C0.191%2C0.566-0.151%2C0.566-0.151L12.285%2C9.711z%20M5.571%2C6.482%20C5.279%2C6.993%2C4.425%2C7.076%2C3.705%2C6.664C3.282%2C6.424%2C2.966%2C6.039%2C2.856%2C5.64C2.81%2C5.464%2C2.778%2C5.203%2C2.917%2C4.963%20c0.291-0.51%2C1.146-0.593%2C1.866-0.182C5.21%2C5.027%2C5.521%2C5.4%2C5.632%2C5.807C5.679%2C5.98%2C5.708%2C6.242%2C5.571%2C6.482z%20M5.632%2C13.159%20c-0.111%2C0.406-0.422%2C0.778-0.848%2C1.025c-0.719%2C0.409-1.576%2C0.327-1.867-0.184c-0.137-0.239-0.106-0.499-0.06-0.676%20c0.108-0.398%2C0.426-0.781%2C0.847-1.022c0.72-0.412%2C1.574-0.329%2C1.866%2C0.181C5.708%2C12.723%2C5.679%2C12.983%2C5.632%2C13.159z%20M16.181%2C5.139%20c-0.448%2C0.258-4.435%2C1.9-4.435%2C1.9s-1.556%2C0.855-2.104%2C1.13l0.937%2C0.843l2.057-0.229l4.11-3.638%20C16.745%2C5.146%2C17.013%2C4.664%2C16.181%2C5.139z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-unlink:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M12.285%2C9.711l-2.104-0.302L9.243%2C8.568L6.669%2C7.095C6.948%2C6.6%2C6.995%2C6.026%2C6.845%2C5.474%20c-0.191-0.698-0.695-1.36-1.438-1.786C4.068%2C2.922%2C2.464%2C3.214%2C1.82%2C4.338C1.536%2C4.836%2C1.489%2C5.414%2C1.64%2C5.97%20c0.189%2C0.698%2C0.694%2C1.36%2C1.438%2C1.787c0.328%2C0.187%2C0.67%2C0.31%2C1.01%2C0.372c0.002%2C0%2C0.006%2C0.002%2C0.008%2C0.004%20c0.027%2C0.004%2C0.057%2C0.009%2C0.088%2C0.011c2.12%2C0.316%2C3.203%2C0.915%2C3.73%2C1.337c-0.527%2C0.424-1.61%2C1.021-3.731%2C1.339%20c-0.029%2C0.003-0.058%2C0.007-0.087%2C0.012c-0.002%2C0.002-0.004%2C0.002-0.007%2C0.003c-0.341%2C0.062-0.684%2C0.187-1.013%2C0.374%20c-0.74%2C0.425-1.246%2C1.089-1.437%2C1.787c-0.149%2C0.555-0.105%2C1.133%2C0.181%2C1.632c0.011%2C0.018%2C0.021%2C0.033%2C0.033%2C0.049l0.883%2C0.783%20c0.765%2C0.366%2C1.775%2C0.328%2C2.67-0.184c0.744-0.425%2C1.248-1.088%2C1.439-1.786c0.148-0.552%2C0.104-1.126-0.176-1.62l2.573-1.473%20c0.573%2C0.287%2C2.299%2C1.292%2C2.299%2C1.292s3.602%2C1.445%2C4.241%2C1.812c0.773%2C0.191%2C0.566-0.151%2C0.566-0.151L12.285%2C9.711z%20M5.571%2C6.482%20C5.279%2C6.993%2C4.425%2C7.076%2C3.705%2C6.664C3.282%2C6.424%2C2.966%2C6.039%2C2.856%2C5.64C2.81%2C5.464%2C2.778%2C5.203%2C2.917%2C4.963%20c0.291-0.51%2C1.146-0.593%2C1.866-0.182C5.21%2C5.027%2C5.521%2C5.4%2C5.632%2C5.807C5.679%2C5.98%2C5.708%2C6.242%2C5.571%2C6.482z%20M5.632%2C13.159%20c-0.111%2C0.406-0.422%2C0.778-0.848%2C1.025c-0.719%2C0.409-1.576%2C0.327-1.867-0.184c-0.137-0.239-0.106-0.499-0.06-0.676%20c0.108-0.398%2C0.426-0.781%2C0.847-1.022c0.72-0.412%2C1.574-0.329%2C1.866%2C0.181C5.708%2C12.723%2C5.679%2C12.983%2C5.632%2C13.159z%20M16.181%2C5.139%20c-0.448%2C0.258-4.435%2C1.9-4.435%2C1.9s-1.556%2C0.855-2.104%2C1.13l0.937%2C0.843l2.057-0.229l4.11-3.638%20C16.745%2C5.146%2C17.013%2C4.664%2C16.181%2C5.139z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-direction {\n  background-image: url(\"data:image/svg+xml;charset=UTF-8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20%20PUBLIC%20'-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN'%20%20'http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd'%3E%3Csvg%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%20512%20512%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%20512%20512%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%0A%09.st0%7Bfill%3A%236A6C8A%3Bstroke%3A%236A6C8A%3Bstroke-width%3A30%7D%0A%09.dot%7Bfill%3A%236A6C8A%3B%7D%0A%3C%2Fstyle%3E%3Cg%3E%3Cg%20id%3D%22XMLID_475_%22%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M133.1%2C277.1c1.8%2C0%2C3.7-0.6%2C5.4-1.7c4.1-3%2C5-8.7%2C2-12.8c-3-4.1-8.7-5-12.8-2c0%2C0%2C0%2C0%2C0%2C0%20%20%20%20%20c-4.1%2C3-5%2C8.7-2%2C12.8C127.5%2C275.8%2C130.3%2C277.1%2C133.1%2C277.1z%22%20id%3D%22XMLID_489_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M138.5%2C359.6c-4.1-3-9.8-2.1-12.8%2C2c-3%2C4.1-2.1%2C9.8%2C2%2C12.8c1.6%2C1.2%2C3.5%2C1.7%2C5.4%2C1.7%20%20%20%20%20c2.8%2C0%2C5.6-1.3%2C7.4-3.7C143.5%2C368.3%2C142.6%2C362.6%2C138.5%2C359.6z%22%20id%3D%22XMLID_726_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C327.7c-4.8%2C1.6-7.4%2C6.7-5.9%2C11.5c1.3%2C3.9%2C4.8%2C6.3%2C8.7%2C6.3c0.9%2C0%2C1.9-0.1%2C2.8-0.4%20%20%20%20%20c4.8-1.6%2C7.4-6.7%2C5.9-11.5C118%2C328.8%2C112.9%2C326.2%2C108.1%2C327.7z%22%20id%3D%22XMLID_776_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C307.3c0.9%2C0.3%2C1.9%2C0.4%2C2.8%2C0.4c3.8%2C0%2C7.4-2.4%2C8.7-6.3c1.6-4.8-1.1-9.9-5.9-11.5%20%20%20%20%20c-4.8-1.6-9.9%2C1.1-11.5%2C5.9C100.7%2C300.6%2C103.3%2C305.7%2C108.1%2C307.3z%22%20id%3D%22XMLID_777_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M169.2%2C265.4c2.4%2C0%2C4.7-1%2C6.5-2.6c1.7-1.7%2C2.7-4.1%2C2.7-6.5c0-2.4-1-4.8-2.7-6.5%20%20%20%20%20c-1.7-1.7-4.1-2.7-6.5-2.7s-4.7%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.5C164.4%2C264.4%2C166.8%2C265.4%2C169.2%2C265.4z%22%20id%3D%22XMLID_797_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M247.7%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C243.7%2C265.4%2C247.7%2C261.3%2C247.7%2C256.3z%22%20id%3D%22XMLID_798_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M213%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C208.9%2C265.4%2C213%2C261.3%2C213%2C256.3z%22%20id%3D%22XMLID_799_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M317.2%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C313.1%2C265.4%2C317.2%2C261.3%2C317.2%2C256.3z%22%20id%3D%22XMLID_800_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M282.5%2C256.3c0-5-4.1-9.1-9.1-9.1s-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20S282.5%2C261.3%2C282.5%2C256.3z%22%20id%3D%22XMLID_801_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M401.1%2C185.2c0.9%2C0%2C1.9-0.1%2C2.8-0.5c4.8-1.6%2C7.4-6.7%2C5.9-11.5c-1.6-4.8-6.7-7.4-11.5-5.8%20%20%20%20%20c-4.8%2C1.6-7.4%2C6.7-5.8%2C11.5C393.6%2C182.8%2C397.2%2C185.2%2C401.1%2C185.2z%22%20id%3D%22XMLID_802_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M403.9%2C205.2c-4.8-1.6-9.9%2C1-11.5%2C5.9l0%2C0c-1.6%2C4.8%2C1.1%2C9.9%2C5.9%2C11.5%20%20%20%20%20c0.9%2C0.3%2C1.9%2C0.5%2C2.8%2C0.5c3.9%2C0%2C7.4-2.5%2C8.7-6.3c0%2C0%2C0%2C0%2C0%2C0C411.3%2C211.9%2C408.7%2C206.8%2C403.9%2C205.2z%22%20id%3D%22XMLID_803_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C237.2L373.5%2C237.2c-4.1%2C3-5%2C8.7-2%2C12.8c1.8%2C2.4%2C4.6%2C3.7%2C7.4%2C3.7%20%20%20%20%20c1.8%2C0%2C3.7-0.6%2C5.4-1.8c4.1-3%2C4.9-8.7%2C2-12.8C383.3%2C235.1%2C377.6%2C234.2%2C373.5%2C237.2z%22%20id%3D%22XMLID_804_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C152.9c1.6%2C1.2%2C3.5%2C1.8%2C5.4%2C1.8c2.8%2C0%2C5.6-1.3%2C7.4-3.8c3-4.1%2C2.1-9.8-2-12.7%20%20%20%20%20c-4.1-3-9.8-2.1-12.7%2C2C368.5%2C144.2%2C369.4%2C149.9%2C373.5%2C152.9z%22%20id%3D%22XMLID_805_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M342.8%2C247.1c-2.4%2C0-4.8%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.4%20%20%20%20%20c1.7%2C1.7%2C4%2C2.7%2C6.5%2C2.7c2.4%2C0%2C4.7-1%2C6.5-2.7c1.7-1.7%2C2.7-4%2C2.7-6.4c0-2.4-1-4.8-2.7-6.5C347.6%2C248.1%2C345.2%2C247.1%2C342.8%2C247.1z%22%20id%3D%22XMLID_806_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M342.8%2C124.7H206.6l36.4-36.4c3.6-3.6%2C3.6-9.3%2C0-12.9c-3.6-3.6-9.3-3.6-12.9%2C0l-51.5%2C51.5%20%20%20%20%20c-1.9%2C1.9-2.8%2C4.4-2.7%2C6.9c-0.1%2C2.5%2C0.7%2C5%2C2.7%2C6.9l51.5%2C51.5c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7%20%20%20%20%20c3.6-3.6%2C3.6-9.3%2C0-12.9l-36.4-36.4h136.1c0%2C0%2C0.1%2C0%2C0.1%2C0c0.6%2C0%2C1.2-0.1%2C1.8-0.2c0.2%2C0%2C0.4-0.1%2C0.6-0.1c0.1%2C0%2C0.2%2C0%2C0.3-0.1%20%20%20%20%20c3.2-1%2C5.6-3.6%2C6.3-6.9c0.1-0.6%2C0.2-1.2%2C0.2-1.8c0-0.6-0.1-1.2-0.2-1.8C351%2C127.8%2C347.3%2C124.7%2C342.8%2C124.7z%22%20id%3D%22XMLID_807_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M322.1%2C371.3l-51.5-51.5c-3.6-3.6-9.3-3.6-12.9%2C0c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9l36.9%2C36.9H169.2%20%20%20%20%20c-2.8%2C0-5.4%2C1.3-7%2C3.3c-0.1%2C0.1-0.2%2C0.2-0.3%2C0.4c-0.1%2C0.1-0.2%2C0.2-0.2%2C0.3c-0.1%2C0.1-0.1%2C0.2-0.2%2C0.4c-0.1%2C0.1-0.2%2C0.3-0.2%2C0.4%20%20%20%20%20c0%2C0.1-0.1%2C0.2-0.1%2C0.2c-0.1%2C0.2-0.2%2C0.4-0.3%2C0.6c0%2C0%2C0%2C0%2C0%2C0.1c-0.4%2C1.1-0.7%2C2.2-0.7%2C3.4c0%2C1.5%2C0.4%2C2.9%2C1%2C4.2c0%2C0%2C0%2C0.1%2C0.1%2C0.1%20%20%20%20%20c0.1%2C0.1%2C0.1%2C0.2%2C0.2%2C0.3c0.4%2C0.7%2C0.9%2C1.3%2C1.4%2C1.8c0.4%2C0.4%2C0.7%2C0.7%2C1.2%2C1c0.1%2C0.1%2C0.1%2C0.1%2C0.2%2C0.2c0%2C0%2C0.1%2C0%2C0.1%2C0.1%20%20%20%20%20c1.4%2C0.9%2C3.1%2C1.5%2C5%2C1.5h124.4l-36%2C36c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7l51.5-51.5%20%20%20%20%20c1.9-1.9%2C2.8-4.4%2C2.7-6.9C324.8%2C375.7%2C324%2C373.2%2C322.1%2C371.3z%22%20id%3D%22XMLID_808_%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E\");\n}\n.x6-widget-handle-direction:hover {\n  background-image: url(\"data:image/svg+xml;charset=UTF-8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20%20PUBLIC%20'-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN'%20%20'http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd'%3E%3Csvg%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%20512%20512%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%20512%20512%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%0A%09.st0%7Bfill%3A%23FD6EB6%3Bstroke%3A%23FD6EB6%3Bstroke-width%3A30%7D%0A%09.dot%7Bfill%3A%23FD6EB6%3B%7D%0A%3C%2Fstyle%3E%3Cg%3E%3Cg%20id%3D%22XMLID_475_%22%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M133.1%2C277.1c1.8%2C0%2C3.7-0.6%2C5.4-1.7c4.1-3%2C5-8.7%2C2-12.8c-3-4.1-8.7-5-12.8-2c0%2C0%2C0%2C0%2C0%2C0%20%20%20%20%20c-4.1%2C3-5%2C8.7-2%2C12.8C127.5%2C275.8%2C130.3%2C277.1%2C133.1%2C277.1z%22%20id%3D%22XMLID_489_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M138.5%2C359.6c-4.1-3-9.8-2.1-12.8%2C2c-3%2C4.1-2.1%2C9.8%2C2%2C12.8c1.6%2C1.2%2C3.5%2C1.7%2C5.4%2C1.7%20%20%20%20%20c2.8%2C0%2C5.6-1.3%2C7.4-3.7C143.5%2C368.3%2C142.6%2C362.6%2C138.5%2C359.6z%22%20id%3D%22XMLID_726_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C327.7c-4.8%2C1.6-7.4%2C6.7-5.9%2C11.5c1.3%2C3.9%2C4.8%2C6.3%2C8.7%2C6.3c0.9%2C0%2C1.9-0.1%2C2.8-0.4%20%20%20%20%20c4.8-1.6%2C7.4-6.7%2C5.9-11.5C118%2C328.8%2C112.9%2C326.2%2C108.1%2C327.7z%22%20id%3D%22XMLID_776_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C307.3c0.9%2C0.3%2C1.9%2C0.4%2C2.8%2C0.4c3.8%2C0%2C7.4-2.4%2C8.7-6.3c1.6-4.8-1.1-9.9-5.9-11.5%20%20%20%20%20c-4.8-1.6-9.9%2C1.1-11.5%2C5.9C100.7%2C300.6%2C103.3%2C305.7%2C108.1%2C307.3z%22%20id%3D%22XMLID_777_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M169.2%2C265.4c2.4%2C0%2C4.7-1%2C6.5-2.6c1.7-1.7%2C2.7-4.1%2C2.7-6.5c0-2.4-1-4.8-2.7-6.5%20%20%20%20%20c-1.7-1.7-4.1-2.7-6.5-2.7s-4.7%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.5C164.4%2C264.4%2C166.8%2C265.4%2C169.2%2C265.4z%22%20id%3D%22XMLID_797_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M247.7%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C243.7%2C265.4%2C247.7%2C261.3%2C247.7%2C256.3z%22%20id%3D%22XMLID_798_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M213%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C208.9%2C265.4%2C213%2C261.3%2C213%2C256.3z%22%20id%3D%22XMLID_799_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M317.2%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C313.1%2C265.4%2C317.2%2C261.3%2C317.2%2C256.3z%22%20id%3D%22XMLID_800_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M282.5%2C256.3c0-5-4.1-9.1-9.1-9.1s-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20S282.5%2C261.3%2C282.5%2C256.3z%22%20id%3D%22XMLID_801_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M401.1%2C185.2c0.9%2C0%2C1.9-0.1%2C2.8-0.5c4.8-1.6%2C7.4-6.7%2C5.9-11.5c-1.6-4.8-6.7-7.4-11.5-5.8%20%20%20%20%20c-4.8%2C1.6-7.4%2C6.7-5.8%2C11.5C393.6%2C182.8%2C397.2%2C185.2%2C401.1%2C185.2z%22%20id%3D%22XMLID_802_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M403.9%2C205.2c-4.8-1.6-9.9%2C1-11.5%2C5.9l0%2C0c-1.6%2C4.8%2C1.1%2C9.9%2C5.9%2C11.5%20%20%20%20%20c0.9%2C0.3%2C1.9%2C0.5%2C2.8%2C0.5c3.9%2C0%2C7.4-2.5%2C8.7-6.3c0%2C0%2C0%2C0%2C0%2C0C411.3%2C211.9%2C408.7%2C206.8%2C403.9%2C205.2z%22%20id%3D%22XMLID_803_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C237.2L373.5%2C237.2c-4.1%2C3-5%2C8.7-2%2C12.8c1.8%2C2.4%2C4.6%2C3.7%2C7.4%2C3.7%20%20%20%20%20c1.8%2C0%2C3.7-0.6%2C5.4-1.8c4.1-3%2C4.9-8.7%2C2-12.8C383.3%2C235.1%2C377.6%2C234.2%2C373.5%2C237.2z%22%20id%3D%22XMLID_804_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C152.9c1.6%2C1.2%2C3.5%2C1.8%2C5.4%2C1.8c2.8%2C0%2C5.6-1.3%2C7.4-3.8c3-4.1%2C2.1-9.8-2-12.7%20%20%20%20%20c-4.1-3-9.8-2.1-12.7%2C2C368.5%2C144.2%2C369.4%2C149.9%2C373.5%2C152.9z%22%20id%3D%22XMLID_805_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M342.8%2C247.1c-2.4%2C0-4.8%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.4%20%20%20%20%20c1.7%2C1.7%2C4%2C2.7%2C6.5%2C2.7c2.4%2C0%2C4.7-1%2C6.5-2.7c1.7-1.7%2C2.7-4%2C2.7-6.4c0-2.4-1-4.8-2.7-6.5C347.6%2C248.1%2C345.2%2C247.1%2C342.8%2C247.1z%22%20id%3D%22XMLID_806_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M342.8%2C124.7H206.6l36.4-36.4c3.6-3.6%2C3.6-9.3%2C0-12.9c-3.6-3.6-9.3-3.6-12.9%2C0l-51.5%2C51.5%20%20%20%20%20c-1.9%2C1.9-2.8%2C4.4-2.7%2C6.9c-0.1%2C2.5%2C0.7%2C5%2C2.7%2C6.9l51.5%2C51.5c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7%20%20%20%20%20c3.6-3.6%2C3.6-9.3%2C0-12.9l-36.4-36.4h136.1c0%2C0%2C0.1%2C0%2C0.1%2C0c0.6%2C0%2C1.2-0.1%2C1.8-0.2c0.2%2C0%2C0.4-0.1%2C0.6-0.1c0.1%2C0%2C0.2%2C0%2C0.3-0.1%20%20%20%20%20c3.2-1%2C5.6-3.6%2C6.3-6.9c0.1-0.6%2C0.2-1.2%2C0.2-1.8c0-0.6-0.1-1.2-0.2-1.8C351%2C127.8%2C347.3%2C124.7%2C342.8%2C124.7z%22%20id%3D%22XMLID_807_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M322.1%2C371.3l-51.5-51.5c-3.6-3.6-9.3-3.6-12.9%2C0c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9l36.9%2C36.9H169.2%20%20%20%20%20c-2.8%2C0-5.4%2C1.3-7%2C3.3c-0.1%2C0.1-0.2%2C0.2-0.3%2C0.4c-0.1%2C0.1-0.2%2C0.2-0.2%2C0.3c-0.1%2C0.1-0.1%2C0.2-0.2%2C0.4c-0.1%2C0.1-0.2%2C0.3-0.2%2C0.4%20%20%20%20%20c0%2C0.1-0.1%2C0.2-0.1%2C0.2c-0.1%2C0.2-0.2%2C0.4-0.3%2C0.6c0%2C0%2C0%2C0%2C0%2C0.1c-0.4%2C1.1-0.7%2C2.2-0.7%2C3.4c0%2C1.5%2C0.4%2C2.9%2C1%2C4.2c0%2C0%2C0%2C0.1%2C0.1%2C0.1%20%20%20%20%20c0.1%2C0.1%2C0.1%2C0.2%2C0.2%2C0.3c0.4%2C0.7%2C0.9%2C1.3%2C1.4%2C1.8c0.4%2C0.4%2C0.7%2C0.7%2C1.2%2C1c0.1%2C0.1%2C0.1%2C0.1%2C0.2%2C0.2c0%2C0%2C0.1%2C0%2C0.1%2C0.1%20%20%20%20%20c1.4%2C0.9%2C3.1%2C1.5%2C5%2C1.5h124.4l-36%2C36c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7l51.5-51.5%20%20%20%20%20c1.9-1.9%2C2.8-4.4%2C2.7-6.9C324.8%2C375.7%2C324%2C373.2%2C322.1%2C371.3z%22%20id%3D%22XMLID_808_%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E\");\n}\n.x6-widget-handle-surround .x6-widget-handle-animate .x6-widget-handle {\n  transition: background-size 80ms, width 80ms, height 80ms, top 150ms, left 150ms, bottom 150ms, right 150ms;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-se {\n  right: -25px;\n  bottom: -25px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-nw {\n  top: -21px;\n  left: -25px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-n {\n  top: -22px;\n  left: 50%;\n  margin-left: -10px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-e {\n  top: -webkit-calc(40%);\n  top: calc(50% - 10px);\n  right: -25px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-ne {\n  top: -21px;\n  right: -25px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-w {\n  top: 50%;\n  left: -25px;\n  margin-top: -10px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-sw {\n  bottom: -25px;\n  left: -25px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-s {\n  bottom: -24px;\n  left: 50%;\n  margin-left: -10px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle {\n  width: 15px;\n  height: 15px;\n  font-size: 15px;\n  background-size: 15px 15px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-se {\n  right: -19px;\n  bottom: -19px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-nw {\n  top: -19px;\n  left: -19px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-n {\n  top: -19px;\n  margin-left: -7.5px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-e {\n  top: -webkit-calc(42%);\n  top: calc(50% - 8px);\n  right: -19px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-ne {\n  top: -19px;\n  right: -19px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-w {\n  left: -19px;\n  margin-top: -8px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-sw {\n  bottom: -19px;\n  left: -19px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-s {\n  bottom: -19px;\n  margin-left: -7.5px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle {\n  width: 10px;\n  height: 10px;\n  font-size: 10px;\n  background-size: 10px 10px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-se {\n  right: -15px;\n  bottom: -13px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-nw {\n  top: -13px;\n  left: -15px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-n {\n  top: -13px;\n  margin-left: -5px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-e {\n  top: -webkit-calc(45%);\n  top: calc(50% - 5px);\n  right: -15px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-ne {\n  top: -13px;\n  right: -15px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-w {\n  left: -15px;\n  margin-top: -5px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-sw {\n  bottom: -13px;\n  left: -15px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-s {\n  bottom: -13px;\n  margin-left: -5px;\n}\n.x6-widget-handle-toolbar {\n  position: absolute;\n  top: -50px;\n  display: table-row;\n  padding: 7px 5px;\n}\n.x6-widget-handle-toolbar::after {\n  position: absolute;\n  top: 100%;\n  left: 10px;\n  width: 0;\n  height: 0;\n  margin-top: 4px;\n  border-right: 10px solid transparent;\n  border-left: 10px solid transparent;\n  content: '';\n}\n.x6-widget-handle-toolbar .x6-widget-handle {\n  position: relative;\n  display: table-cell;\n  min-width: 20px;\n  margin: 0 2px;\n  background-position: 3px 3px;\n  background-size: 16px 16px;\n}\n.x6-widget-handle-toolbar .x6-widget-handle::after {\n  position: absolute;\n  bottom: -11px;\n  width: 100%;\n  content: '';\n}\n.x6-widget-handle-pie {\n  position: absolute;\n  top: -webkit-calc(0%);\n  top: calc(50% - 50px);\n  right: -50px;\n  z-index: 1;\n  display: none;\n  width: 100px;\n  height: 100px;\n  margin: -2px -2px 0 0;\n  border-radius: 50%;\n  cursor: default;\n  pointer-events: visiblePainted;\n}\n.x6-widget-handle-pie .x6-widget-handle {\n  width: 1px;\n  height: auto;\n  pointer-events: visiblePainted;\n}\n.x6-widget-handle-pie-slice-svg {\n  width: 100%;\n  height: 100%;\n  overflow: visible !important;\n}\n.x6-widget-handle-pie-slice-img,\n.x6-widget-handle-pie-slice-txt {\n  display: none;\n  pointer-events: none;\n}\n.x6-widget-handle-pie[data-pie-toggle-position='e'] {\n  top: calc(50% - 50px);\n  right: -50px;\n  left: auto;\n}\n.x6-widget-handle-pie[data-pie-toggle-position='w'] {\n  top: calc(50% - 50px);\n  right: auto;\n  left: -52px;\n}\n.x6-widget-handle-pie[data-pie-toggle-position='n'] {\n  top: -50px;\n  right: auto;\n  bottom: auto;\n  left: calc(50% - 52px);\n}\n.x6-widget-handle-pie[data-pie-toggle-position='s'] {\n  top: auto;\n  right: auto;\n  bottom: -52px;\n  left: calc(50% - 52px);\n}\n.x6-widget-handle-pie-opened {\n  display: block;\n  animation: halo-pie-visibility 0.1s, halo-pie-opening 0.1s;\n  animation-timing-function: step-end, ease;\n  animation-delay: 0s, 0.1s;\n}\n.x6-widget-handle-pie-toggle {\n  position: absolute;\n  top: -webkit-calc(35%);\n  top: calc(50% - 15px);\n  right: -15px;\n  z-index: 2;\n  display: block;\n  box-sizing: border-box;\n  width: 30px;\n  height: 30px;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-size: 20px 20px;\n  border-radius: 50%;\n  cursor: pointer;\n  user-select: none;\n  pointer-events: visiblePainted;\n  -webkit-user-drag: none;\n  user-drag: none;\n  /* stylelint-disable-line */\n}\n.x6-widget-handle-pie-toggle-pos-e {\n  top: -webkit-calc(35%);\n  top: calc(50% - 15px);\n  right: -15px;\n  bottom: auto;\n  left: auto;\n}\n.x6-widget-handle-pie-toggle-pos-w {\n  top: -webkit-calc(35%);\n  top: calc(50% - 15px);\n  right: auto;\n  bottom: auto;\n  left: -15px;\n}\n.x6-widget-handle-pie-toggle-pos-n {\n  top: -15px;\n  right: auto;\n  bottom: auto;\n  left: -webkit-calc(35%);\n  left: calc(50% - 15px);\n}\n.x6-widget-handle-pie-toggle-pos-s {\n  top: auto;\n  right: auto;\n  bottom: -15px;\n  left: -webkit-calc(35%);\n  left: calc(50% - 15px);\n}\n.x6-widget-handle-pie-toggle-opened {\n  transition: 0.1s background-image;\n}\n.x6-widget-handle-toolbar {\n  position: static;\n  display: inline-block;\n  margin-top: -50px;\n  margin-left: 45px;\n  white-space: nowrap;\n  vertical-align: top;\n  background-color: #f5f5f5;\n  border-bottom: 3px solid #333;\n  border-radius: 5px;\n  box-shadow: 0 1px 2px #222;\n}\n.x6-widget-handle-toolbar::after {\n  top: -12px;\n  left: 55px;\n  margin-top: 0;\n  border-top: 6px solid #333;\n  border-right: 10px solid transparent;\n  border-left: 10px solid transparent;\n}\n.x6-widget-handle-toolbar .x6-widget-handle {\n  display: inline-block;\n  vertical-align: top;\n}\n.x6-widget-handle-toolbar .x6-widget-handle:hover::after {\n  border-bottom: 4px solid #fc6cb8;\n}\n.x6-widget-handle-toolbar .x6-widget-handle-rotate {\n  position: absolute;\n  top: 100%;\n  right: 100%;\n  margin-top: 3px;\n  margin-right: 6px;\n}\n.x6-widget-handle-toolbar .x6-widget-handle-remove:hover::after,\n.x6-widget-handle-toolbar .x6-widget-handle-rotate:hover::after {\n  border-bottom: none;\n}\n.x6-widget-handle-toolbar .x6-widget-handle + .x6-widget-handle {\n  margin-left: 4px;\n}\n.x6-widget-handle-pie {\n  box-sizing: content-box;\n  background-color: #f5f5f5;\n  border: 2px solid #404040;\n}\n.x6-widget-handle-pie-slice {\n  fill: transparent;\n  stroke: #e9e9e9;\n  stroke-width: 1;\n}\n.x6-widget-handle-pie-slice:hover {\n  fill: #fff;\n}\n.x6-widget-handle-pie-slice-img {\n  display: block;\n}\n.x6-widget-handle-selected .x6-widget-handle-pie-slice {\n  fill: #fff;\n}\n.x6-widget-handle-pie-toggle {\n  background-color: #f6f6f6;\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20height%3D%2216px%22%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%2016%2016%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%2016%2016%22%20width%3D%2216px%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M15%2C6h-5V1c0-0.55-0.45-1-1-1H7C6.45%2C0%2C6%2C0.45%2C6%2C1v5H1C0.45%2C6%2C0%2C6.45%2C0%2C7v2c0%2C0.55%2C0.45%2C1%2C1%2C1h5v5c0%2C0.55%2C0.45%2C1%2C1%2C1h2%20c0.55%2C0%2C1-0.45%2C1-1v-5h5c0.55%2C0%2C1-0.45%2C1-1V7C16%2C6.45%2C15.55%2C6%2C15%2C6z%22%2F%3E%3C%2Fsvg%3E');\n  background-size: 16px 16px;\n  border: 2px solid #3b425f;\n}\n.x6-widget-handle-pie-toggle:hover {\n  background-color: #fff;\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20height%3D%2216px%22%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%2016%2016%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%2016%2016%22%20width%3D%2216px%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M15%2C6h-5V1c0-0.55-0.45-1-1-1H7C6.45%2C0%2C6%2C0.45%2C6%2C1v5H1C0.45%2C6%2C0%2C6.45%2C0%2C7v2c0%2C0.55%2C0.45%2C1%2C1%2C1h5v5c0%2C0.55%2C0.45%2C1%2C1%2C1h2%20c0.55%2C0%2C1-0.45%2C1-1v-5h5c0.55%2C0%2C1-0.45%2C1-1V7C16%2C6.45%2C15.55%2C6%2C15%2C6z%22%2F%3E%3C%2Fsvg%3E');\n  border-color: #fd6eb6;\n}\n.x6-widget-handle-pie-toggle-opened {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%3Csvg%20xmlns%3Adc%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Felements%2F1.1%2F%22%20xmlns%3Acc%3D%22http%3A%2F%2Fcreativecommons.org%2Fns%23%22%20xmlns%3Ardf%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23%22%20xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20version%3D%221.1%22%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20id%3D%22Layer_1%22%20xml%3Aspace%3D%22preserve%22%3E%3Cmetadata%20id%3D%22metadata9%22%3E%3Crdf%3ARDF%3E%3Ccc%3AWork%20rdf%3Aabout%3D%22%22%3E%3Cdc%3Aformat%3Eimage%2Fsvg%2Bxml%3C%2Fdc%3Aformat%3E%3Cdc%3Atype%20rdf%3Aresource%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Fdcmitype%2FStillImage%22%20%2F%3E%3Cdc%3Atitle%3E%3C%2Fdc%3Atitle%3E%3C%2Fcc%3AWork%3E%3C%2Frdf%3ARDF%3E%3C%2Fmetadata%3E%3Cdefs%20id%3D%22defs7%22%20%2F%3E%3Cpath%20d%3D%22M%2015%2C6%2010%2C6%20C%201.0301983%2C6.00505%2015.002631%2C6.011353%206%2C6%20L%201%2C6%20C%200.45%2C6%200%2C6.45%200%2C7%20l%200%2C2%20c%200%2C0.55%200.45%2C1%201%2C1%20l%205%2C0%20c%208.988585%2C-0.019732%20-5.02893401%2C-0.018728%204%2C0%20l%205%2C0%20c%200.55%2C0%201%2C-0.45%201%2C-1%20L%2016%2C7%20C%2016%2C6.45%2015.55%2C6%2015%2C6%20z%22%20id%3D%22path3%22%20style%3D%22fill%3A%236a6c8a%22%20%2F%3E%3C%2Fsvg%3E');\n}\n.x6-widget-handle-pie-toggle-opened:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%3Csvg%20xmlns%3Adc%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Felements%2F1.1%2F%22%20xmlns%3Acc%3D%22http%3A%2F%2Fcreativecommons.org%2Fns%23%22%20xmlns%3Ardf%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23%22%20xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20version%3D%221.1%22%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20id%3D%22Layer_1%22%20xml%3Aspace%3D%22preserve%22%3E%3Cmetadata%20id%3D%22metadata9%22%3E%3Crdf%3ARDF%3E%3Ccc%3AWork%20rdf%3Aabout%3D%22%22%3E%3Cdc%3Aformat%3Eimage%2Fsvg%2Bxml%3C%2Fdc%3Aformat%3E%3Cdc%3Atype%20rdf%3Aresource%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Fdcmitype%2FStillImage%22%20%2F%3E%3Cdc%3Atitle%3E%3C%2Fdc%3Atitle%3E%3C%2Fcc%3AWork%3E%3C%2Frdf%3ARDF%3E%3C%2Fmetadata%3E%3Cdefs%20id%3D%22defs7%22%20%2F%3E%3Cpath%20d%3D%22M%2015%2C6%2010%2C6%20C%201.0301983%2C6.00505%2015.002631%2C6.011353%206%2C6%20L%201%2C6%20C%200.45%2C6%200%2C6.45%200%2C7%20l%200%2C2%20c%200%2C0.55%200.45%2C1%201%2C1%20l%205%2C0%20c%208.988585%2C-0.019732%20-5.02893401%2C-0.018728%204%2C0%20l%205%2C0%20c%200.55%2C0%201%2C-0.45%201%2C-1%20L%2016%2C7%20C%2016%2C6.45%2015.55%2C6%2015%2C6%20z%22%20id%3D%22path3%22%20style%3D%22fill%3A%23FD6EB6%22%20%2F%3E%3C%2Fsvg%3E');\n}\n.x6-widget-dnd {\n  position: absolute;\n  top: -10000px;\n  left: -10000px;\n  z-index: 100;\n  display: none;\n  cursor: move;\n  opacity: 0.7;\n  pointer-events: 'cursor';\n}\n.x6-widget-dnd.dragging {\n  display: inline-block;\n}\n.x6-widget-dnd.dragging * {\n  pointer-events: none !important;\n}\n.x6-widget-dnd .x6-graph {\n  background: transparent;\n  box-shadow: none;\n}\n.x6-widget-halo {\n  position: absolute;\n  pointer-events: none;\n}\n.x6-widget-halo-content {\n  position: absolute;\n  top: 100%;\n  padding: 6px;\n  font-size: 10px;\n  line-height: 14px;\n  text-align: center;\n  border-radius: 6px;\n}\n.x6-widget-halo-handles + .x6-widget-halo-content {\n  right: -20px;\n  left: -20px;\n  margin-top: 30px;\n}\n.x6-widget-halo-handles.x6-widget-handle-small + .x6-widget-halo-content {\n  margin-top: 25px;\n}\n.x6-widget-halo-handles.x6-widget-handle-small + .x6-widget-halo-content {\n  margin-top: 20px;\n}\n.x6-widget-halo-handles.x6-widget-handle-pie + .x6-widget-halo-content {\n  right: 0;\n  left: 0;\n  margin-top: 10px;\n}\n.x6-widget-halo-content {\n  color: #fff;\n  background-color: #6a6b8a;\n}\n.x6-widget-halo.type-node .x6-widget-handle-toolbar .x6-widget-handle-remove {\n  position: absolute;\n  right: 100%;\n  bottom: 100%;\n  margin-right: 6px;\n  margin-bottom: 3px;\n}\n.x6-widget-halo.type-edge .x6-widget-handle-surround .x6-widget-handle-remove {\n  background-color: #fff;\n  border-radius: 50%;\n}\n.x6-widget-halo.type-edge .x6-widget-handle-toolbar {\n  margin-top: -60px;\n  margin-left: -18px;\n}\n.x6-widget-halo.type-edge .x6-widget-handle-toolbar::after {\n  top: -22px;\n  left: -9px;\n}\n.x6-widget-minimap {\n  position: relative;\n  display: table-cell;\n  box-sizing: border-box;\n  overflow: hidden;\n  text-align: center;\n  vertical-align: middle;\n  background-color: #fff;\n  user-select: none;\n}\n.x6-widget-minimap .x6-graph {\n  display: inline-block;\n  box-shadow: 0 0 4px 0 #eee;\n  cursor: pointer;\n}\n.x6-widget-minimap .x6-graph > svg {\n  pointer-events: none;\n  shape-rendering: optimizeSpeed;\n}\n.x6-widget-minimap .x6-graph .x6-node * {\n  /* stylelint-disable-next-line */\n  vector-effect: initial;\n}\n.x6-widget-minimap-viewport {\n  position: absolute;\n  box-sizing: content-box !important;\n  margin: -2px 0 0 -2px;\n  border: 2px solid #31d0c6;\n  cursor: move;\n}\n.x6-widget-minimap-viewport-zoom {\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  box-sizing: border-box;\n  width: 12px;\n  height: 12px;\n  margin: 0 -6px -6px 0;\n  background-color: #fff;\n  border: 2px solid #31d0c6;\n  border-radius: 50%;\n  cursor: nwse-resize;\n}\n.x6-graph-scroller {\n  position: relative;\n  box-sizing: border-box;\n  overflow: scroll;\n  outline: none;\n}\n.x6-graph-scroller-content {\n  position: relative;\n}\n.x6-graph-scroller-background {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.x6-graph-scroller .x6-graph {\n  position: absolute;\n  display: inline-block;\n  margin: 0;\n  box-shadow: none;\n}\n.x6-graph-scroller .x6-graph > svg {\n  display: block;\n}\n.x6-graph-scroller.x6-graph-scroller-paged .x6-graph {\n  box-shadow: 0 0 4px 0 #eee;\n}\n.x6-graph-scroller.x6-graph-scroller-pannable[data-panning='false'] {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n.x6-graph-scroller.x6-graph-scroller-pannable[data-panning='true'] {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  user-select: none;\n}\n.x6-graph-pagebreak {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.x6-graph-pagebreak-vertical {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  box-sizing: border-box;\n  width: 1px;\n  border-left: 1px dashed #bdbdbd;\n}\n.x6-graph-pagebreak-horizontal {\n  position: absolute;\n  right: 0;\n  left: 0;\n  box-sizing: border-box;\n  height: 1px;\n  border-top: 1px dashed #bdbdbd;\n}\n.x6-widget-selection {\n  position: absolute;\n  display: none;\n  width: 0;\n  height: 0;\n  touch-action: none;\n}\n.x6-widget-selection-rubberband {\n  display: block;\n  overflow: visible;\n  opacity: 0.3;\n}\n.x6-widget-selection-selected {\n  display: block;\n}\n.x6-widget-selection-box {\n  cursor: move;\n}\n.x6-widget-selection-inner[data-selection-length='0'],\n.x6-widget-selection-inner[data-selection-length='1'] {\n  display: none;\n}\n.x6-widget-selection-content {\n  position: absolute;\n  top: 100%;\n  right: -20px;\n  left: -20px;\n  margin-top: 30px;\n  padding: 6px;\n  line-height: 14px;\n  text-align: center;\n  border-radius: 6px;\n}\n.x6-widget-selection-content:empty {\n  display: none;\n}\n.x6-widget-selection-rubberband {\n  background-color: #3498db;\n  border: 2px solid #2980b9;\n}\n.x6-widget-selection-box {\n  box-sizing: content-box !important;\n  margin-top: -4px;\n  margin-left: -4px;\n  padding-right: 4px;\n  padding-bottom: 4px;\n  border: 2px dashed #feb663;\n  box-shadow: 2px 2px 5px #d3d3d3;\n}\n.x6-widget-selection-inner {\n  box-sizing: content-box !important;\n  margin-top: -8px;\n  margin-left: -8px;\n  padding-right: 12px;\n  padding-bottom: 12px;\n  border: 2px solid #feb663;\n  box-shadow: 2px 2px 5px #d3d3d3;\n}\n.x6-widget-selection-content {\n  color: #fff;\n  font-size: 10px;\n  background-color: #6a6b8a;\n}\n.x6-widget-snapline {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  pointer-events: none;\n}\n.x6-widget-snapline-vertical,\n.x6-widget-snapline-horizontal {\n  position: absolute;\n  opacity: 1;\n  pointer-events: none;\n}\n.x6-widget-snapline-horizontal {\n  border-bottom: 1px solid #2ecc71;\n}\n.x6-widget-snapline-vertical {\n  border-right: 1px solid #2ecc71;\n}\n.x6-widget-stencil {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.x6-widget-stencil::after {\n  position: absolute;\n  top: 0;\n  display: block;\n  width: 100%;\n  height: 20px;\n  padding: 8px 0;\n  line-height: 20px;\n  text-align: center;\n  opacity: 0;\n  transition: top 0.1s linear, opacity 0.1s linear;\n  content: ' ';\n  pointer-events: none;\n}\n.x6-widget-stencil-content {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  height: auto;\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.x6-widget-stencil .x6-node [magnet]:not([magnet='passive']) {\n  pointer-events: none;\n}\n.x6-widget-stencil-group {\n  padding: 0;\n  padding-bottom: 8px;\n  overflow: hidden;\n  user-select: none;\n}\n.x6-widget-stencil-group.collapsed {\n  height: auto;\n  padding-bottom: 0;\n}\n.x6-widget-stencil-group-title {\n  position: relative;\n  margin-top: 0;\n  margin-bottom: 0;\n  padding: 4px;\n  cursor: pointer;\n}\n.x6-widget-stencil-title,\n.x6-widget-stencil-group > .x6-widget-stencil-group-title {\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  user-select: none;\n}\n.x6-widget-stencil .unmatched {\n  opacity: 0.3;\n}\n.x6-widget-stencil .x6-node.unmatched {\n  display: none;\n}\n.x6-widget-stencil-group.unmatched {\n  display: none;\n}\n.x6-widget-stencil-search-text {\n  position: relative;\n  z-index: 1;\n  box-sizing: border-box;\n  width: 100%;\n  height: 30px;\n  max-height: 30px;\n  line-height: 30px;\n  outline: 0;\n}\n.x6-widget-stencil.not-found::after {\n  opacity: 1;\n  content: attr(data-not-found-text);\n}\n.x6-widget-stencil.not-found.searchable::after {\n  top: 30px;\n}\n.x6-widget-stencil.not-found.searchable.collapsable::after {\n  top: 50px;\n}\n.x6-widget-stencil {\n  color: #333;\n  background: #f5f5f5;\n}\n.x6-widget-stencil-content {\n  position: absolute;\n}\n.x6-widget-stencil.collapsable > .x6-widget-stencil-content {\n  top: 32px;\n}\n.x6-widget-stencil.searchable > .x6-widget-stencil-content {\n  top: 80px;\n}\n.x6-widget-stencil.not-found::after {\n  position: absolute;\n}\n.x6-widget-stencil.not-found.searchable.collapsable::after {\n  top: 80px;\n}\n.x6-widget-stencil.not-found.searchable::after {\n  top: 60px;\n}\n.x6-widget-stencil-group {\n  height: auto;\n  margin-bottom: 1px;\n  padding: 0;\n  transition: none;\n}\n.x6-widget-stencil-group .x6-graph {\n  background: transparent;\n  box-shadow: none;\n}\n.x6-widget-stencil-group.collapsed {\n  height: auto;\n  max-height: 31px;\n}\n.x6-widget-stencil-title,\n.x6-widget-stencil-group > .x6-widget-stencil-group-title {\n  position: relative;\n  left: 0;\n  box-sizing: border-box;\n  width: 100%;\n  height: 32px;\n  padding: 0 5px 0 8px;\n  color: #666;\n  font-weight: 700;\n  font-size: 12px;\n  line-height: 32px;\n  cursor: default;\n  transition: all 0.3;\n}\n.x6-widget-stencil-title:hover,\n.x6-widget-stencil-group > .x6-widget-stencil-group-title:hover {\n  color: #444;\n}\n.x6-widget-stencil-title {\n  background: #e9e9e9;\n}\n.x6-widget-stencil-group > .x6-widget-stencil-group-title {\n  background: #ededed;\n}\n.x6-widget-stencil.collapsable > .x6-widget-stencil-title,\n.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title {\n  padding-left: 32px;\n  cursor: pointer;\n}\n.x6-widget-stencil.collapsable > .x6-widget-stencil-title::before,\n.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title::before {\n  position: absolute;\n  top: 6px;\n  left: 8px;\n  display: block;\n  width: 18px;\n  height: 18px;\n  margin: 0;\n  padding: 0;\n  background-color: transparent;\n  background-repeat: no-repeat;\n  background-position: 0 0;\n  border: none;\n  content: ' ';\n}\n.x6-widget-stencil.collapsable > .x6-widget-stencil-title::before,\n.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title::before {\n  background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIj48cGF0aCBkPSJNOS4zNzUuNUM0LjY4Ny41Ljg3NSA0LjMxMy44NzUgOWMwIDQuNjg4IDMuODEyIDguNSA4LjUgOC41IDQuNjg3IDAgOC41LTMuODEyIDguNS04LjUgMC00LjY4Ny0zLjgxMy04LjUtOC41LTguNXptMCAxNS44ODZDNS4zMDMgMTYuMzg2IDEuOTkgMTMuMDcyIDEuOTkgOXMzLjMxMi03LjM4NSA3LjM4NS03LjM4NVMxNi43NiA0LjkyOCAxNi43NiA5YzAgNC4wNzItMy4zMTMgNy4zODYtNy4zODUgNy4zODZ6Ii8+PHBhdGggZD0iTTEyLjc1MyA4LjQ0M0g1Ljk5N2EuNTU4LjU1OCAwIDAwMCAxLjExNmg2Ljc1NmEuNTU4LjU1OCAwIDAwMC0xLjExNnoiLz48L2c+PC9zdmc+');\n  opacity: 0.4;\n  transition: all 0.3s;\n}\n.x6-widget-stencil.collapsable > .x6-widget-stencil-title:hover::before,\n.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title:hover::before {\n  opacity: 0.6;\n}\n.x6-widget-stencil.collapsable.collapsed > .x6-widget-stencil-title::before,\n.x6-widget-stencil-group.collapsable.collapsed > .x6-widget-stencil-group-title::before {\n  background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIj48cGF0aCBkPSJNOS4zNzUuNUM0LjY4Ny41Ljg3NSA0LjMxMy44NzUgOWMwIDQuNjg4IDMuODEyIDguNSA4LjUgOC41IDQuNjg3IDAgOC41LTMuODEyIDguNS04LjUgMC00LjY4Ny0zLjgxMy04LjUtOC41LTguNXptMCAxNS44ODZDNS4zMDMgMTYuMzg2IDEuOTkgMTMuMDcyIDEuOTkgOXMzLjMxMi03LjM4NSA3LjM4NS03LjM4NVMxNi43NiA0LjkyOCAxNi43NiA5YzAgNC4wNzItMy4zMTMgNy4zODYtNy4zODUgNy4zODZ6Ii8+PHBhdGggZD0iTTEyLjc1MyA4LjQ0M0g1Ljk5N2EuNTU4LjU1OCAwIDAwMCAxLjExNmg2Ljc1NmEuNTU4LjU1OCAwIDAwMC0xLjExNnoiLz48cGF0aCBkPSJNOC44MTcgNS42MjN2Ni43NTZhLjU1OC41NTggMCAwMDEuMTE2IDBWNS42MjNhLjU1OC41NTggMCAxMC0xLjExNiAweiIvPjwvZz48L3N2Zz4=');\n  opacity: 0.4;\n}\n.x6-widget-stencil.collapsable.collapsed > .x6-widget-stencil-title:hover::before,\n.x6-widget-stencil-group.collapsable.collapsed > .x6-widget-stencil-group-title:hover::before {\n  opacity: 0.6;\n}\n.x6-widget-stencil input[type='search'] {\n  -webkit-appearance: textfield;\n}\n.x6-widget-stencil input[type='search']::-webkit-search-cancel-button,\n.x6-widget-stencil input[type='search']::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n.x6-widget-stencil-search-text {\n  display: block;\n  width: 90%;\n  margin: 8px 5%;\n  padding-left: 8px;\n  color: #333;\n  background: #fff;\n  border: 1px solid #e9e9e9;\n  border-radius: 12px;\n  outline: 0;\n}\n.x6-widget-stencil-search-text:focus {\n  outline: 0;\n}\n.x6-widget-stencil::after {\n  color: #808080;\n  font-weight: 600;\n  font-size: 12px;\n  background: 0 0;\n}\n.x6-widget-transform {\n  position: absolute;\n  box-sizing: content-box !important;\n  margin: -5px 0 0 -5px;\n  padding: 4px;\n  border: 1px dashed #000;\n  border-radius: 5px;\n  user-select: none;\n  pointer-events: none;\n}\n.x6-widget-transform > div {\n  position: absolute;\n  box-sizing: border-box;\n  background-color: #fff;\n  border: 1px solid #000;\n  transition: background-color 0.2s;\n  pointer-events: auto;\n  -webkit-user-drag: none;\n  user-drag: none;\n  /* stylelint-disable-line */\n}\n.x6-widget-transform > div:hover {\n  background-color: #d3d3d3;\n}\n.x6-widget-transform-cursor-n {\n  cursor: n-resize;\n}\n.x6-widget-transform-cursor-s {\n  cursor: s-resize;\n}\n.x6-widget-transform-cursor-e {\n  cursor: e-resize;\n}\n.x6-widget-transform-cursor-w {\n  cursor: w-resize;\n}\n.x6-widget-transform-cursor-ne {\n  cursor: ne-resize;\n}\n.x6-widget-transform-cursor-nw {\n  cursor: nw-resize;\n}\n.x6-widget-transform-cursor-se {\n  cursor: se-resize;\n}\n.x6-widget-transform-cursor-sw {\n  cursor: sw-resize;\n}\n.x6-widget-transform-resize {\n  width: 10px;\n  height: 10px;\n  border-radius: 6px;\n}\n.x6-widget-transform-resize[data-position='top-left'] {\n  top: -5px;\n  left: -5px;\n}\n.x6-widget-transform-resize[data-position='top-right'] {\n  top: -5px;\n  right: -5px;\n}\n.x6-widget-transform-resize[data-position='bottom-left'] {\n  bottom: -5px;\n  left: -5px;\n}\n.x6-widget-transform-resize[data-position='bottom-right'] {\n  right: -5px;\n  bottom: -5px;\n}\n.x6-widget-transform-resize[data-position='top'] {\n  top: -5px;\n  left: 50%;\n  margin-left: -5px;\n}\n.x6-widget-transform-resize[data-position='bottom'] {\n  bottom: -5px;\n  left: 50%;\n  margin-left: -5px;\n}\n.x6-widget-transform-resize[data-position='left'] {\n  top: 50%;\n  left: -5px;\n  margin-top: -5px;\n}\n.x6-widget-transform-resize[data-position='right'] {\n  top: 50%;\n  right: -5px;\n  margin-top: -5px;\n}\n.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='top'],\n.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='bottom'],\n.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='left'],\n.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='right'] {\n  display: none;\n}\n.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='bottom'],\n.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='left'],\n.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='right'],\n.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='top'] {\n  display: none;\n}\n.x6-widget-transform.no-resize .x6-widget-transform-resize {\n  display: none;\n}\n.x6-widget-transform-rotate {\n  top: -20px;\n  left: -20px;\n  width: 12px;\n  height: 12px;\n  border-radius: 6px;\n  cursor: crosshair;\n}\n.x6-widget-transform.no-rotate .x6-widget-transform-rotate {\n  display: none;\n}\n.x6-widget-transform-active {\n  border-color: transparent;\n  pointer-events: all;\n}\n.x6-widget-transform-active > div {\n  display: none;\n}\n.x6-widget-transform-active > .x6-widget-transform-active-handle {\n  display: block;\n  background-color: #808080;\n}\n.x6-widget-knob {\n  position: absolute;\n  box-sizing: border-box;\n  width: 16px;\n  height: 16px;\n  margin-top: -8px;\n  margin-left: -8px;\n  cursor: pointer;\n  user-select: none;\n}\n.x6-widget-knob::before,\n.x6-widget-knob::after {\n  position: absolute;\n  transform: rotate(45deg);\n  content: '';\n}\n.x6-widget-knob::before {\n  top: 4px;\n  left: 4px;\n  box-sizing: border-box;\n  width: 8px;\n  height: 8px;\n  background-color: #fff;\n}\n.x6-widget-knob::after {\n  top: 5px;\n  left: 5px;\n  box-sizing: border-box;\n  width: 6px;\n  height: 6px;\n  background-color: #fca000;\n}\n.x6-graph-print {\n  position: relative;\n}\n.x6-graph-print .x6-graph-print-ready {\n  display: none;\n}\n.x6-graph-print .x6-graph-print-preview {\n  overflow: hidden !important;\n  background: #fff !important;\n}\n@media print {\n  html,\n  html > body.x6-graph-printing {\n    position: relative !important;\n    width: 100% !important;\n    height: 100% !important;\n    margin: 0 !important;\n    padding: 0 !important;\n  }\n  html > body.x6-graph-printing > * {\n    display: none !important;\n  }\n  html > body.x6-graph-printing > .x6-graph-print {\n    display: block !important;\n  }\n  .x6-graph-print {\n    top: 0 !important;\n    left: 0 !important;\n    margin: 0 !important;\n    padding: 0 !important;\n    overflow: hidden !important;\n    page-break-after: always;\n    background: #fff !important;\n  }\n  .x6-graph-print .x6-graph-print-ready {\n    display: none;\n  }\n}\n.x6-cell-tool-editor {\n  position: relative;\n  display: inline-block;\n  min-height: 1em;\n  margin: 0;\n  padding: 0;\n  line-height: 1;\n  white-space: normal;\n  text-align: center;\n  vertical-align: top;\n  overflow-wrap: normal;\n  outline: none;\n  transform-origin: 0 0;\n  -webkit-user-drag: none;\n}\n.x6-edge-tool-editor {\n  border: 1px solid #275fc5;\n  border-radius: 2px;\n}\n";const e=document.querySelector("head");e&&e.insertBefore(t,e.firstChild)}},e.clean=function(){n-=1,n>0||(t&&t.parentNode&&t.parentNode.removeChild(t),t=null)}}(XC||(XC={}));var YC,qC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class KC{get handleClassName(){return YC.handle}get pie(){return Object.assign(Object.assign({},KC.defaultPieOptions),this.handleOptions.pie)}initHandles(){if(this.handles=[],this.handleOptions.handles&&this.handleOptions.handles.forEach((e=>this.addHandle(e))),"pie"===this.handleOptions.type){if(this.pie.toggles){const e=YC.pieToggle;this.$pieToggles={},this.pie.toggles.forEach((t=>{const n=this.$("<div/>");this.applyAttrs(n,t.attrs),n.addClass(e).addClass(`${e}-pos-${t.position||"e"}`).attr("data-name",t.name).appendTo(this.container),this.$pieToggles[t.name]=n}))}this.setPieIcons()}if(this.$handleContainer){const e=this.handleOptions.type||"surround";this.$handleContainer.addClass(YC.wrap).addClass(YC.animate).addClass(`${YC.handle}-${e}`)}this.delegateEvents({[`mousedown .${YC.handle}`]:"onHandleMouseDown",[`touchstart .${YC.handle}`]:"onHandleMouseDown",[`mousedown .${YC.pieToggle}`]:"onPieToggleMouseDown",[`touchstart .${YC.pieToggle}`]:"onPieToggleMouseDown"})}onHandleMouseDown(e){const t=this.$(e.currentTarget).closest(`.${YC.handle}`).attr("data-action");t&&(e.preventDefault(),e.stopPropagation(),this.setEventData(e,{action:t,clientX:e.clientX,clientY:e.clientY,startX:e.clientX,startY:e.clientY}),"mousedown"===e.type&&2===e.button?this.triggerHandleAction(t,"contextmenu",e):(this.triggerHandleAction(t,"mousedown",e),this.delegateDocumentEvents({mousemove:"onHandleMouseMove",touchmove:"onHandleMouseMove",mouseup:"onHandleMouseUp",touchend:"onHandleMouseUp",touchcancel:"onHandleMouseUp"},e.data)))}onHandleMouseMove(e){const t=this.getEventData(e).action;t&&this.triggerHandleAction(t,"mousemove",e)}onHandleMouseUp(e){const t=this.getEventData(e).action;t&&(this.triggerHandleAction(t,"mouseup",e),this.undelegateDocumentEvents())}triggerHandleAction(e,t,n,r){n.preventDefault(),n.stopPropagation();const i=this.normalizeEvent(n),o=this.getEventData(i),s=this.graph.snapToGrid(i.clientX,i.clientY),a=this.graph.snapToGrid(o.clientX,o.clientY),l=s.x-a.x,c=s.y-a.y;this.trigger(`action:${e}:${t}`,Object.assign({e:i,dx:l,dy:c,x:s.x,y:s.y,offsetX:n.clientX-o.startX,offsetY:n.clientY-o.startY},r)),o.clientX=n.clientX,o.clientY=n.clientY}onPieToggleMouseDown(e){e.stopPropagation();const t=this.$(e.target).closest(`.${YC.pieToggle}`).attr("data-name");this.isOpen(t)||this.isOpen()&&this.toggleState(),this.toggleState(t)}setPieIcons(){"pie"===this.handleOptions.type&&this.$handleContainer.find(`.${YC.handle}`).each(((e,t)=>{const n=this.$(t),r=n.attr("data-action"),i=YC.pieSlice,o=this.getHandle(r);if(!o||!o.icon){const e=window.getComputedStyle(t,":before").getPropertyValue("content");if(e&&"none"!==e){const t=n.find(`.${i}-txt`);t.length&&ev.create(t[0]).text(e.replace(/['"]/g,""))}const r=n.css("background-image");if(r){const e=r.match(/url\(['"]?([^'"]+)['"]?\)/);if(e){const t=e[1],r=n.find(`.${i}-img`);r.length>0&&ev.create(r[0]).attr("xlink:href",t)}}}}))}getHandleIdx(e){return this.handles.findIndex((t=>t.name===e))}hasHandle(e){return this.getHandleIdx(e)>=0}getHandle(e){return this.handles.find((t=>t.name===e))}renderHandle(e){const t=this.$("<div/>").addClass(`${YC.handle} ${YC.handle}-${e.name}`).attr("data-action",e.name).prop("draggable",!1);if("pie"===this.handleOptions.type){const n=this.getHandleIdx(e.name),r=this.pie,i=r.outerRadius,o=r.innerRadius,s=(i+o)/2,a=new Tm(i,i),l=Cm.toRad(r.sliceAngle),c=n*l+Cm.toRad(r.startAngle),u=function(e,t,n,r){const i=2*Math.PI-1e-6,o=e,s=t;let a=n,l=r;if(l<a){const e=a;a=l,l=e}const c=l-a,u=c<Math.PI?"0":"1",h=Math.cos(a),d=Math.sin(a),f=Math.cos(l),p=Math.sin(l);return c>=i?o?`M0,${s}A${s},${s} 0 1,1 0,${-s}A${s},${s} 0 1,1 0,${s}M0,${o}A${o},${o} 0 1,0 0,${-o}A${o},${o} 0 1,0 0,${o}Z`:`M0,${s}A${s},${s} 0 1,1 0,${-s}A${s},${s} 0 1,1 0,${s}Z`:o?`M${s*h},${s*d}A${s},${s} 0 ${u},1 ${s*f},${s*p}L${o*f},${o*p}A${o},${o} 0 ${u},0 ${o*h},${o*d}Z`:`M${s*h},${s*d}A${s},${s} 0 ${u},1 ${s*f},${s*p}L0,0Z`}(o,i,c,c+l),h=ev.create("svg").addClass(`${YC.pieSlice}-svg`),d=ev.create("path").addClass(YC.pieSlice).attr("d",u).translate(i,i),f=Tm.fromPolar(s,-c-l/2,a).toJSON(),p=r.iconSize,g=ev.create("image").attr(f).addClass(`${YC.pieSlice}-img`);f.y=f.y+p-2;const m=ev.create("text",{"font-size":p}).attr(f).addClass(`${YC.pieSlice}-txt`);g.attr({width:p,height:p}),g.translate(-p/2,-p/2),m.translate(-p/2,-p/2),h.append([d,g,m]),t.append(h.node)}else t.addClass(`${YC.handle}-pos-${e.position}`),e.content&&("string"==typeof e.content?t.html(e.content):t.append(e.content));return this.updateHandleIcon(t,e.icon),this.applyAttrs(t,e.attrs),t}addHandle(e){if(!this.hasHandle(e.name)){this.handles.push(e);const t=e.events;t&&Object.keys(t).forEach((n=>{const r=t[n],i=`action:${e.name}:${n}`;"string"==typeof r?this.on(i,this[r],this):this.on(i,r)})),this.$handleContainer&&this.$handleContainer.append(this.renderHandle(e))}return this}addHandles(e){return e.forEach((e=>this.addHandle(e))),this}removeHandles(){for(;this.handles.length;)this.removeHandle(this.handles[0].name);return this}removeHandle(e){const t=this.getHandleIdx(e),n=this.handles[t];return n&&(n.events&&Object.keys(n.events).forEach((t=>{this.off(`action:${e}:${t}`)})),this.getHandleElem(e).remove(),this.handles.splice(t,1)),this}changeHandle(e,t){const n=this.getHandle(e);return n&&(this.removeHandle(e),this.addHandle(Object.assign(Object.assign({},n),t))),this}toggleHandle(e,t){const n=this.getHandle(e);if(n){const r=this.getHandleElem(e),i=`${YC.handle}-selected`;void 0===t&&(t=!r.hasClass(i)),r.toggleClass(i,t);const o=t?n.iconSelected:n.icon;o&&this.updateHandleIcon(r,o)}return this}selectHandle(e){return this.toggleHandle(e,!0)}deselectHandle(e){return this.toggleHandle(e,!1)}deselectAllHandles(){return this.handles.forEach((e=>this.deselectHandle(e.name))),this}getHandleElem(e){return this.$handleContainer.find(`.${YC.handle}-${e}`)}updateHandleIcon(e,t){if("pie"===this.handleOptions.type){const n=e.find(`.${YC.pieSliceImg}`);this.$(n[0]).attr("xlink:href",t||"")}else e.css("background-image",t?`url(${t})`:"")}isRendered(){return null!=this.$handleContainer}isOpen(e){return!!this.isRendered()&&(e?this.$pieToggles[e].hasClass(YC.pieToggleOpened):this.$handleContainer.hasClass(`${YC.pieOpended}`))}toggleState(e){if(this.isRendered()){const t=this.$handleContainer;if(Object.keys(this.$pieToggles).forEach((e=>{this.$pieToggles[e].removeClass(YC.pieToggleOpened)})),this.isOpen())this.trigger("pie:close",{name:e}),t.removeClass(YC.pieOpended);else{if(this.trigger("pie:open",{name:e}),e){const n=this.pie.toggles,r=n&&n.find((t=>t.name===e));r&&t.attr({"data-pie-toggle-name":r.name,"data-pie-toggle-position":r.position}),this.$pieToggles[e].addClass(YC.pieToggleOpened)}t.addClass(YC.pieOpended)}}}applyAttrs(e,t){if(t){const n=dx.$(e);Object.keys(t).forEach((e=>{const r=n.find(e).addBack().filter(e),i=t[e],{class:o}=i,s=qC(i,["class"]);o&&r.addClass(o),r.attr(s)}))}}}!function(e){e.defaultPieOptions={innerRadius:20,outerRadius:50,sliceAngle:45,startAngle:0,iconSize:14,toggles:[{name:"default",position:"e"}]}}(KC||(KC={})),function(e){e.handle=dx.prototype.prefixClassName("widget-handle"),e.wrap=`${e.handle}-wrap`,e.animate=`${e.handle}-animate`,e.pieOpended=`${e.handle}-pie-opened`,e.pieToggle=`${e.handle}-pie-toggle`,e.pieToggleOpened=`${e.handle}-pie-toggle-opened`,e.pieSlice=`${e.handle}-pie-slice`,e.pieSliceImg=`${e.handle}-pie-slice-img`}(YC||(YC={}));var ZC,JC=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},QC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class eE extends dx{constructor(e){super();const t=e,{view:n,cell:r,node:i,edge:o,graph:s}=t,a=QC(t,["view","cell","node","edge","graph"]);n?(this.view=n,this.cell=n.cell,this.graph=n.graph,this.model=this.graph.model):(r||o||i)&&s&&(this.cell=i||o||r,this.view=s.renderer.findViewByCell(this.cell),this.graph=s,this.model=this.graph.model);const l=this.constructor;!1!==e.clearAll&&l.removeInstances(this.graph),l.register(this),this.init(a)}static ensureCache(){return this.instanceCache.has(this)||this.instanceCache.set(this,{}),this.instanceCache.get(this)}static register(e,t){null==t&&(t=e.graph);const n=this.ensureCache();let r=n[t.view.cid];null==r&&(r=n[t.view.cid]={}),r[e.cid]=e}static unregister(e,t){null==t&&(t=e.graph);const n=this.ensureCache();n[t.view.cid]&&delete n[t.view.cid][e.cid]}static removeInstances(e){const t=this.ensureCache()[e.view.cid];t&&Object.keys(t).forEach((e=>{const n=t[e];n&&n.remove()}))}static getInstances(e){return this.ensureCache()[e.view.cid]||{}}init(e){}render(){return this}startListening(){!1!==this.options.clearOnBlankMouseDown&&this.graph.on("blank:mousedown",this.remove,this)}stopListening(){!1!==this.options.clearOnBlankMouseDown&&this.graph.off("blank:mousedown",this.remove,this)}remove(){this.stopListening();return this.constructor.unregister(this),super.remove()}dispose(){this.remove()}}eE.instanceCache=new WeakMap,JC([dx.dispose()],eE.prototype,"dispose",null);class tE extends eE{get node(){return this.cell}get metadata(){const e=this.cell.prop("knob");return Array.isArray(e)?null!=this.options.index?e[this.options.index]:null:e}init(e){this.options=Object.assign({},e),this.render(),this.startListening()}startListening(){this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"}),this.model.on("*",this.update,this),this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this),this.model.on("reseted",this.remove,this),this.node.on("removed",this.remove,this),this.view.on("node:resize:mousedown",this.onTransform,this),this.view.on("node:rotate:mousedown",this.onTransform,this),this.view.on("node:resize:mouseup",this.onTransformed,this),this.view.on("node:rotate:mouseup",this.onTransformed,this),this.view.on("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.on("cell:knob:mouseup",this.onKnobMouseUp,this),super.startListening()}stopListening(){this.undelegateEvents(),this.model.off("*",this.update,this),this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this),this.model.off("reseted",this.remove,this),this.node.off("removed",this.remove,this),this.view.off("node:resize:mousedown",this.onTransform,this),this.view.off("node:rotate:mousedown",this.onTransform,this),this.view.off("node:resize:mouseup",this.onTransformed,this),this.view.off("node:rotate:mouseup",this.onTransformed,this),this.view.off("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.off("cell:knob:mouseup",this.onKnobMouseUp,this),super.stopListening()}render(){return this.container=document.createElement("div"),Fg(this.container,this.prefixClassName("widget-knob")),this.options.className&&Fg(this.container,this.options.className),this.view.addClass(ZC.KNOB),this.graph.container.appendChild(this.container),this.update(),this}remove(){return this.view.removeClass(ZC.KNOB),super.remove()}update(){if(this.metadata){const{update:e,position:t}=this.metadata,n={knob:this,cell:this.cell,node:this.node};if(t){const e=t.call(this.graph,Object.assign({},n));if(e){const t=this.graph.matrix(),n=this.node.getBBox(),r=Cm.normalize(this.node.getAngle()),i=Tm.create(e);0!==r&&i.rotate(-r,{x:n.width/2,y:n.height/2}),i.translate(n).scale(t.a,t.d).translate(t.e,t.f),this.container.style.left=`${i.x}px`,this.container.style.top=`${i.y}px`}}e&&e.call(this.graph,Object.assign({},n))}}hide(){this.container.style.display="none"}show(){this.container.style.display=""}onTransform(){this.hide()}onTransformed(){this.show()}onKnobMouseDown({knob:e}){this.cid!==e.cid&&this.hide()}onKnobMouseUp(){this.show()}notify(e,t){if(this.view){const n=this.view.normalizeEvent(t),r=this.graph.snapToGrid(n.clientX,n.clientY);this.view.notify(`cell:${e}`,{e:n,view:this.view,node:this.node,cell:this.cell,x:r.x,y:r.y,knob:this}),this.cell.isNode()?this.view.notify(`node:${e}`,{e:n,view:this.view,node:this.node,cell:this.cell,x:r.x,y:r.y,knob:this}):this.cell.isEdge()&&this.view.notify(`edge:${e}`,{e:n,view:this.view,edge:this.cell,cell:this.cell,x:r.x,y:r.y,knob:this})}}onMouseDown(e){e.stopPropagation(),this.setEventData(e,{knobbing:!1,originX:e.clientX,originY:e.clientY,clientX:e.clientX,clientY:e.clientY}),this.graph.view.undelegateEvents(),this.delegateDocumentEvents(ZC.documentEvents,e.data),this.metadata&&this.metadata.onMouseDown&&this.metadata.onMouseDown.call(this.graph,{e:e,data:this.getEventData(e),knob:this,cell:this.cell,node:this.node}),this.notify("knob:mousedown",e)}onMouseMove(e){const t=this.getEventData(e),n=this.graph.findViewByCell(this.node);if(t.knobbing||(t.knobbing=!0,n&&(n.addClass(ZC.KNOBBING),this.notify("knob",e)),this.model.startBatch("knob",{cid:this.cid})),t.clientX=e.clientX,t.clientY=e.clientY,this.metadata&&this.metadata.onMouseMove){const n=this.graph.matrix(),r=(e.clientX-t.originX)/n.a,i=(e.clientY-t.originY)/n.d,o=this.node.getAngle(),s=new Tm(r,i).rotate(o);this.metadata.onMouseMove.call(this.graph,{e:e,data:t,deltaX:s.x,deltaY:s.y,knob:this,cell:this.cell,node:this.node})}this.notify("knobbing",e),this.notify("knob:mousemove",e)}onMouseUp(e){this.undelegateDocumentEvents(),this.graph.view.delegateEvents();const t=this.getEventData(e),n=this.graph.findViewByCell(this.node);t.knobbing&&(n&&n.removeClass(ZC.KNOBBING),this.metadata&&this.metadata.onMouseUp&&this.metadata.onMouseUp.call(this.graph,{e:e,data:t,knob:this,cell:this.cell,node:this.node}),this.model.stopBatch("knob",{cid:this.cid}),this.notify("knobbed",e)),this.notify("knob:mouseup",e)}}!function(e){e.KNOB="has-widget-knob",e.KNOBBING="node-knobbing",e.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp"}}(ZC||(ZC={}));var nE,rE,iE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};!function(e){e.root="widget-minimap",e.viewport=`${e.root}-viewport`,e.zoom=`${e.viewport}-zoom`}(nE||(nE={}));class oE extends dx{constructor(e){super(),this.options=Object.assign(Object.assign({},rE.defaultOptions),e),this.updateViewport=Wc(this.updateViewport.bind(this),0),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName(nE.root));const t=document.createElement("div");this.container.appendChild(t),this.$viewport=this.$("<div>").addClass(this.prefixClassName(nE.viewport)),this.options.scalable&&(this.zoomHandle=this.$("<div>").addClass(this.prefixClassName(nE.zoom)).appendTo(this.$viewport).get(0)),this.$container.append(this.$viewport).css({width:this.options.width,height:this.options.height,padding:this.options.padding}),this.options.container&&this.options.container.appendChild(this.container),this.sourceGraph=this.graph;const n=Object.assign(Object.assign({},this.options.graphOptions),{container:t,model:this.sourceGraph.model,frozen:!0,async:this.sourceGraph.isAsync(),interacting:!1,grid:!1,background:!1,rotating:!1,resizing:!1,embedding:!1,selecting:!1,snapline:!1,clipboard:!1,history:!1,scroller:!1});this.targetGraph=this.options.createGraph?this.options.createGraph(n):new y_(n),this.targetGraph.renderer.unfreeze(),this.updatePaper(this.sourceGraph.options.width,this.sourceGraph.options.height),this.startListening()}get graph(){return this.options.graph}get scroller(){return this.graph.scroller.widget}get graphContainer(){return this.scroller?this.scroller.container:this.graph.container}get $graphContainer(){return this.scroller?this.scroller.$container:this.$(this.graph.container)}startListening(){this.scroller?this.$graphContainer.on(`scroll${this.getEventNamespace()}`,this.updateViewport):this.sourceGraph.on("translate",this.updateViewport,this),this.sourceGraph.on("resize",this.updatePaper,this),this.delegateEvents({mousedown:"startAction",touchstart:"startAction",[`mousedown .${this.prefixClassName("graph")}`]:"scrollTo",[`touchstart .${this.prefixClassName("graph")}`]:"scrollTo"})}stopListening(){this.scroller?this.$graphContainer.off(this.getEventNamespace()):this.sourceGraph.off("translate",this.updateViewport,this),this.sourceGraph.off("resize",this.updatePaper,this),this.undelegateEvents()}onRemove(){this.targetGraph.view.remove(),this.stopListening(),this.targetGraph.dispose()}updatePaper(e,t){let n,r;"object"==typeof e?(n=e.width,r=e.height):(n=e,r=t);const i=this.sourceGraph.options,o=this.sourceGraph.transform.getScale(),s=this.options.width-2*this.options.padding,a=this.options.height-2*this.options.padding;n/=o.sx,r/=o.sy,this.ratio=Math.min(s/n,a/r);const l=this.ratio,c=i.x*l/o.sx,u=i.y*l/o.sy;return n*=l,r*=l,this.targetGraph.resizeGraph(n,r),this.targetGraph.translate(c,u),this.targetGraph.scale(l,l),this.updateViewport(),this}updateViewport(){const e=this.ratio,t=this.sourceGraph.transform.getScale();let n=null;if(this.scroller)n=this.scroller.clientToLocalPoint(0,0);else{const e=this.sourceGraph.matrix();n=new Tm(-e.e/e.a,-e.f/e.d)}const r=this.$(this.targetGraph.container).position(),i=this.targetGraph.translate();i.ty=i.ty||0,this.geometry={top:r.top+n.y*e+i.ty,left:r.left+n.x*e+i.tx,width:this.$graphContainer.innerWidth()*e/t.sx,height:this.$graphContainer.innerHeight()*e/t.sy},this.$viewport.css(this.geometry)}startAction(e){const t=this.normalizeEvent(e),n=t.target===this.zoomHandle?"zooming":"panning",{tx:r,ty:i}=this.sourceGraph.translate(),o={action:n,clientX:t.clientX,clientY:t.clientY,scrollLeft:this.graphContainer.scrollLeft,scrollTop:this.graphContainer.scrollTop,zoom:this.sourceGraph.zoom(),scale:this.sourceGraph.transform.getScale(),geometry:this.geometry,translateX:r,translateY:i};this.delegateDocumentEvents(rE.documentEvents,o)}doAction(e){const t=this.normalizeEvent(e),n=t.clientX,r=t.clientY,i=t.data;switch(i.action){case"panning":{const e=this.sourceGraph.transform.getScale(),t=(n-i.clientX)*e.sx,o=(r-i.clientY)*e.sy;this.scroller?(this.graphContainer.scrollLeft=i.scrollLeft+t/this.ratio,this.graphContainer.scrollTop=i.scrollTop+o/this.ratio):this.sourceGraph.translate(i.translateX-t/this.ratio,i.translateY-o/this.ratio);break}case"zooming":{const e=i.scale,t=i.geometry,r=1+(i.clientX-n)/t.width/e.sx;i.frameId&&cancelAnimationFrame(i.frameId),i.frameId=requestAnimationFrame((()=>{this.sourceGraph.zoom(r*i.zoom,{absolute:!0,minScale:this.options.minScale,maxScale:this.options.maxScale})}));break}}}stopAction(){this.undelegateDocumentEvents()}scrollTo(e){const t=this.normalizeEvent(e);let n,r;const i=this.targetGraph.translate();if(i.ty=i.ty||0,null==t.offsetX){const e=this.$(this.targetGraph.container).offset();n=t.pageX-e.left,r=t.pageY-e.top}else n=t.offsetX,r=t.offsetY;const o=(n-i.tx)/this.ratio,s=(r-i.ty)/this.ratio;this.sourceGraph.centerPoint(o,s)}dispose(){this.remove()}}iE([dx.dispose()],oE.prototype,"dispose",null),function(e){e.defaultOptions={width:300,height:200,padding:10,scalable:!0,minScale:.01,maxScale:16,graphOptions:{},createGraph:e=>new y_(e)},e.documentEvents={mousemove:"doAction",touchmove:"doAction",mouseup:"stopAction",touchend:"stopAction"}}(rE||(rE={}));var sE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},aE=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class lE extends dx{constructor(e){super();const{graph:t}=e,n=aE(e,["graph"]);this.graph=t,this.options=Object.assign({tolerance:10},n),this.render(),this.parseFilter(),this.disabled||this.startListening()}get model(){return this.graph.model}get containerClassName(){return this.prefixClassName("widget-snapline")}get verticalClassName(){return`${this.containerClassName}-vertical`}get horizontalClassName(){return`${this.containerClassName}-horizontal`}get disabled(){return!0!==this.options.enabled||!0!==this.graph.options.snapline.enabled}enable(){this.disabled&&(this.options.enabled=!0,this.graph.options.snapline.enabled=!0,this.startListening())}disable(){this.disabled||(this.options.enabled=!1,this.graph.options.snapline.enabled=!1,this.stopListening())}setFilter(e){this.options.filter=e,this.parseFilter()}render(){this.container=document.createElement("div"),this.$container=this.$(this.container),this.$horizontal=this.$(document.createElement("div")).addClass(this.horizontalClassName),this.$vertical=this.$(document.createElement("div")).addClass(this.verticalClassName),this.$container.hide().addClass(this.containerClassName).append([this.$horizontal,this.$vertical]),this.options.className&&this.$container.addClass(this.options.className)}startListening(){this.stopListening(),this.graph.on("node:mousedown",this.captureCursorOffset,this),this.graph.on("node:mousemove",this.snapOnMoving,this),this.model.on("batch:stop",this.onBatchStop,this),this.delegateDocumentEvents({mouseup:"hide",touchend:"hide"})}stopListening(){this.graph.off("node:mousedown",this.captureCursorOffset,this),this.graph.off("node:mousemove",this.snapOnMoving,this),this.model.off("batch:stop",this.onBatchStop,this),this.undelegateDocumentEvents()}parseFilter(){this.filterShapes={},this.filterCells={},this.filterFunction=null;const e=this.options.filter;Array.isArray(e)?e.forEach((e=>{"string"==typeof e?this.filterShapes[e]=!0:this.filterCells[e.id]=!0})):"function"==typeof e&&(this.filterFunction=e)}onBatchStop({name:e,data:t}){"resize"===e&&this.snapOnResizing(t.cell,t)}captureCursorOffset({view:e,x:t,y:n}){const r=e.getDelegatedView();if(r&&this.isNodeMovable(r)){const r=e.cell.getPosition();this.offset={x:t-r.x,y:n-r.y}}}isNodeMovable(e){return e&&e.cell.isNode()&&e.can("nodeMovable")}snapOnResizing(e,t){if(this.options.resizing&&!t.snapped&&t.ui&&t.direction&&t.trueDirection){const n=this.graph.renderer.findViewByCell(e);if(n&&n.cell.isNode()){const r=e.getBBox(),i=r.bbox(e.getAngle()),o=i.getTopLeft(),s=i.getBottomRight(),a=Cm.normalize(e.getAngle()),l=this.options.tolerance||0;let c,u,h,d,f,p;const g={vertical:0,horizontal:0},m=t.direction,v=t.trueDirection,y=t.relativeDirection;-1!==v.indexOf("right")?g.vertical=s.x:g.vertical=o.x,-1!==v.indexOf("bottom")?g.horizontal=s.y:g.horizontal=o.y,this.model.getNodes().some((t=>{if(this.isIgnored(e,t))return!1;const n=t.getBBox().bbox(t.getAngle()),r=n.getTopLeft(),o=n.getBottomRight(),a={vertical:[r.x,o.x],horizontal:[r.y,o.y]},m={};return Object.keys(a).forEach((e=>{const t=e,n=a[t].map((e=>({position:e,distance:Math.abs(e-g[t])}))).filter((e=>e.distance<=l));m[t]=Nf(n,(e=>e.distance))})),null==c&&m.vertical.length>0&&(c=m.vertical[0].position,u=Math.min(i.y,n.y),h=Math.max(s.y,o.y)-u),null==d&&m.horizontal.length>0&&(d=m.horizontal[0].position,f=Math.min(i.x,n.x),p=Math.max(s.x,o.x)-f),null!=c&&null!=d})),this.hide();let b=0,x=0;null==d&&null==c||(null!=c&&(b=-1!==v.indexOf("right")?c-s.x:o.x-c),null!=d&&(x=-1!==v.indexOf("bottom")?d-s.y:o.y-d));let w=0,C=0;if(a%90==0)90===a||270===a?(w=x,C=b):(w=b,C=x);else{const e=a>=0&&a<90?1:a>=90&&a<180?4:a>=180&&a<270?3:2;null!=d&&null!=c&&(b<x?(x=0,d=void 0):(b=0,c=void 0));const t=Cm.toRad(a%90);b&&(w=3===e?b/Math.cos(t):b/Math.sin(t)),x&&(C=3===e?x/Math.cos(t):x/Math.sin(t));const n=1===e||3===e;switch(y){case"top":case"bottom":C=x?x/(n?Math.cos(t):Math.sin(t)):b/(n?Math.sin(t):Math.cos(t));break;case"left":case"right":w=b?b/(n?Math.cos(t):Math.sin(t)):x/(n?Math.sin(t):Math.cos(t))}}switch(y){case"top":case"bottom":w=0;break;case"left":case"right":C=0}const E=this.graph.getGridSize();let _=Math.max(r.width+w,E),S=Math.max(r.height+C,E);t.minWidth&&t.minWidth>E&&(_=Math.max(_,t.minWidth)),t.minHeight&&t.minHeight>E&&(S=Math.max(S,t.minHeight)),t.maxWidth&&(_=Math.min(_,t.maxWidth)),t.maxHeight&&(S=Math.min(S,t.maxHeight)),t.preserveAspectRatio&&(C<w?S=_*(r.height/r.width):_=S*(r.width/r.height)),_===r.width&&S===r.height||(e.resize(_,S,{direction:m,relativeDirection:y,trueDirection:v,snapped:!0,snaplines:this.cid,restrict:this.graph.hook.getRestrictArea(n)}),h&&(h+=S-r.height),p&&(p+=_-r.width));const O=e.getBBox().bbox(a);c&&Math.abs(O.x-c)>1&&Math.abs(O.width+O.x-c)>1&&(c=void 0),d&&Math.abs(O.y-d)>1&&Math.abs(O.height+O.y-d)>1&&(d=void 0),this.update({verticalLeft:c,verticalTop:u,verticalHeight:h,horizontalTop:d,horizontalLeft:f,horizontalWidth:p})}}}snapOnMoving({view:e,e:t,x:n,y:r}){const i=e.getEventData(t).delegatedView||e;if(!this.isNodeMovable(i))return;const o=i.cell,s=o.getSize(),a=o.getPosition(),l=new Pm(n-this.offset.x,r-this.offset.y,s.width,s.height),c=o.getAngle(),u=l.getCenter(),h=l.bbox(c),d=h.getTopLeft(),f=h.getBottomRight(),p=this.options.tolerance||0;let g,m,v,y,b,x,w=0,C=0;if(this.model.getNodes().some((e=>{if(this.isIgnored(o,e))return!1;const t=e.getBBox().bbox(e.getAngle()),n=t.getCenter(),r=t.getTopLeft(),i=t.getBottomRight();return null==g&&(Math.abs(n.x-u.x)<p?(g=n.x,w=.5):Math.abs(r.x-d.x)<p?(g=r.x,w=0):Math.abs(r.x-f.x)<p?(g=r.x,w=1):Math.abs(i.x-f.x)<p?(g=i.x,w=1):Math.abs(i.x-d.x)<p&&(g=i.x),null!=g&&(m=Math.min(h.y,t.y),v=Math.max(f.y,i.y)-m)),null==y&&(Math.abs(n.y-u.y)<p?(y=n.y,C=.5):Math.abs(r.y-d.y)<p?y=r.y:Math.abs(r.y-f.y)<p?(y=r.y,C=1):Math.abs(i.y-f.y)<p?(y=i.y,C=1):Math.abs(i.y-d.y)<p&&(y=i.y),null!=y&&(b=Math.min(h.x,t.x),x=Math.max(f.x,i.x)-b)),null!=g&&null!=y})),this.hide(),null!=y||null!=g){null!=y&&(h.y=y-C*h.height),null!=g&&(h.x=g-w*h.width);const e=h.getCenter(),t=e.x-l.width/2,n=e.y-l.height/2,r=t-a.x,s=n-a.y;0===r&&0===s||(o.translate(r,s,{snapped:!0,restrict:this.graph.hook.getRestrictArea(i)}),x&&(x+=r),v&&(v+=s)),this.update({verticalLeft:g,verticalTop:m,verticalHeight:v,horizontalTop:y,horizontalLeft:b,horizontalWidth:x})}}isIgnored(e,t){return t.id===e.id||t.isDescendantOf(e)||this.filterShapes[t.shape]||this.filterCells[t.id]||this.filterFunction&&Tg(this.filterFunction,this.graph,t)}update(e){const t=this.graph.matrix(),n=t.a,r=t.d,i=t.e,o=t.f,s=this.options.sharp,a=null!=this.graph.scroller.widget;e.horizontalTop?this.$horizontal.css({top:e.horizontalTop*r+o,left:s?e.horizontalLeft*n+i:a?"-300%":0,width:s?e.horizontalWidth*n:a?"700%":"100%"}).show():this.$horizontal.hide(),e.verticalLeft?this.$vertical.css({left:e.verticalLeft*n+i,top:s?e.verticalTop*r+o:a?"-300%":0,height:s?e.verticalHeight*r:a?"700%":"100%"}).show():this.$vertical.hide(),this.show()}resetTimer(){this.timer&&(clearTimeout(this.timer),this.timer=null)}show(){return this.$container.show(),this.resetTimer(),null==this.container.parentNode&&this.graph.container.appendChild(this.container),this}hide(){this.$container.hide(),this.resetTimer();const e=this.options.clean,t="number"==typeof e?e:!1!==e?3e3:0;return t>0&&(this.timer=window.setTimeout((()=>{this.unmount()}),t)),this}onRemove(){this.stopListening(),this.hide()}dispose(){this.remove()}}sE([dx.dispose()],lE.prototype,"dispose",null);var cE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class uE extends UC{init(){this.resetUpdates(),this.startListening(),this.resetViews(this.model.getCells()),!this.isFrozen()&&this.isAsync()&&this.updateViewsAsync()}startListening(){this.model.on("sorted",this.onSortModel,this),this.model.on("reseted",this.onModelReseted,this),this.model.on("batch:stop",this.onBatchStop,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this)}stopListening(){this.model.off("sorted",this.onSortModel,this),this.model.off("reseted",this.onModelReseted,this),this.model.off("batch:stop",this.onBatchStop,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this)}resetUpdates(){this.updates={priorities:[{},{},{}],mounted:{},mountedCids:[],unmounted:{},unmountedCids:[],count:0,sort:!1,frozen:!1,freezeKey:null,animationId:null}}onSortModel(){this.model.hasActiveBatch(uE.SORT_DELAYING_BATCHES)||this.sortViews()}onModelReseted({options:e}){this.removeZPivots(),this.resetViews(this.model.getCells(),e)}onBatchStop({name:e,data:t}){if(this.isFrozen())return;const n=this.model;if(!this.isAsync()){const r=uE.UPDATE_DELAYING_BATCHES;r.includes(e)&&!n.hasActiveBatch(r)&&this.updateViews(t)}const r=uE.SORT_DELAYING_BATCHES;r.includes(e)&&!n.hasActiveBatch(r)&&this.sortViews()}onCellAdded({cell:e,options:t}){const n=t.position;this.isAsync()||"number"!=typeof n?this.renderView(e,t):(t.maxPosition===n&&this.freeze({key:"addCells"}),this.renderView(e,t),0===n&&this.unfreeze({key:"addCells"}))}onCellRemoved({cell:e,options:t}){const n=this.findViewByCell(e);n&&this.requestViewUpdate(n,uE.FLAG_REMOVE,n.priority,t)}onCellZIndexChanged({cell:e,options:t}){if("approx"===this.options.sorting){const n=this.findViewByCell(e);n&&this.requestViewUpdate(n,uE.FLAG_INSERT,n.priority,t)}}onCellVisibleChanged({cell:e,current:t,options:n}){t||this.processEdgeOnTerminalVisibleChanged(e,!1);const r=this.findViewByCell(e);!t&&r?this.removeView(e):t&&null==r&&this.renderView(e,n),t&&this.processEdgeOnTerminalVisibleChanged(e,!0)}processEdgeOnTerminalVisibleChanged(e,t){this.model.getConnectedEdges(e).forEach((n=>{const r=((e,t)=>e.getSourceCellId()!==t.id?e.getSourceCell():e.getTargetCellId()!==t.id?e.getTargetCell():null)(n,e);(null==r||r.isVisible())&&(t?n.show():n.hide())}))}isEdgeTerminalVisible(e,t){const n="source"===t?e.getSourceCellId():e.getTargetCellId(),r=n?this.model.getCell(n):null;return!(r&&!r.isVisible())}requestConnectedEdgesUpdate(e,t={}){if(_x.isCellView(e)){const n=e.cell,r=this.model.getConnectedEdges(n);for(let e=0,i=r.length;e<i;e+=1){const i=r[e],o=this.findViewByCell(i);if(!o)continue;const s=["update"];i.getTargetCell()===n&&s.push("target"),i.getSourceCell()===n&&s.push("source"),this.scheduleViewUpdate(o,o.getFlag(s),o.priority,t)}}}forcePostponedViewUpdate(e,t){if(!e||!_x.isCellView(e))return!1;const n=e.cell;if(n.isNode())return!1;const r=e;if(n.isEdge()&&0==(t&e.getFlag(["source","target"]))){let e=0;const t=this.findViewByCell(n.getSourceCell());t&&!this.isViewMounted(t)&&(e=this.dumpView(t),r.updateTerminalMagnet("source"));let i=0;const o=this.findViewByCell(n.getTargetCell());if(o&&!this.isViewMounted(o)&&(i=this.dumpView(o),r.updateTerminalMagnet("target")),0===e&&0===i)return!this.dumpView(r)}return!1}scheduleViewUpdate(e,t,n,r={}){const i=e.cid,o=this.updates;let s=o.priorities[n];s||(s=o.priorities[n]={});const a=s[i]||0;(a&t)!==t&&(a||(o.count+=1),t&uE.FLAG_REMOVE&&a&uE.FLAG_INSERT?s[i]^=uE.FLAG_INSERT:t&uE.FLAG_INSERT&&a&uE.FLAG_REMOVE&&(s[i]^=uE.FLAG_REMOVE),s[i]|=t,this.graph.hook.onViewUpdated(e,t,r))}requestViewUpdate(e,t,n,r={}){this.scheduleViewUpdate(e,t,n,r);const i=this.isAsync();if(this.isFrozen()||i&&!1!==r.async||this.model.hasActiveBatch(uE.UPDATE_DELAYING_BATCHES))return;const o=this.updateViews(r);i&&this.graph.trigger("render:done",{stats:o,options:r})}dumpView(e,t={}){if(null==e)return 0;const n=e.cid,r=this.updates.priorities[e.priority],i=this.registerMountedView(e)|r[n];return delete r[n],i?this.updateView(e,i,t):0}dumpViews(e={}){this.checkView(e),this.updateViews(e)}requireView(e,t={}){const n=this.findViewByCell(e);return null==n?null:(this.dumpView(n,t),n)}updateView(e,t,n={}){if(null==e)return 0;if(_x.isCellView(e)){if(t&uE.FLAG_REMOVE)return this.removeView(e.cell),0;t&uE.FLAG_INSERT&&(this.insertView(e),t^=uE.FLAG_INSERT)}return t?e.confirmUpdate(t,n):0}updateViews(e={}){let t,n=0,r=0,i=uE.MIN_PRIORITY;do{t=this.updateViewsBatch(e),n+=1,r+=t.updatedCount,i=Math.min(t.priority,i)}while(!t.empty);return{priority:i,batchCount:n,updatedCount:r}}updateViewsBatch(e={}){const t=this.updates,n=t.priorities,r=e.batchSize||uE.UPDATE_BATCH_SIZE;let i=!0,o=uE.MIN_PRIORITY,s=0,a=0,l=0,c=0,u=e.checkView||this.options.checkView;"function"!=typeof u&&(u=null);e:for(let h=0,d=n.length;h<d;h+=1){const d=n[h];for(const n in d){if(l>=r){i=!1;break e}const f=dx.views[n];if(!f){delete d[n];continue}let p=d[n];if(0==(p&uE.FLAG_REMOVE)){const e=n in t.unmounted;if(u&&!Tg(u,this.graph,{view:f,unmounted:e})){e||(this.registerUnmountedView(f),f.unmount()),t.unmounted[n]|=p,delete d[n],a+=1;continue}e&&(p|=uE.FLAG_INSERT,s+=1),p|=this.registerMountedView(f)}const g=f;let m=this.updateView(f,p,e);if(m>0){const e=g.cell;e&&e.isEdge()&&(g.hasAction(m,"source")&&!this.isEdgeTerminalVisible(e,"source")&&(m=g.removeAction(m,"source"),m|=uE.FLAG_REMOVE),g.hasAction(m,"target")&&!this.isEdgeTerminalVisible(e,"target")&&(m=g.removeAction(m,"target"),m|=uE.FLAG_REMOVE))}m>0&&(d[n]=m,!this.graph.hook.onViewPostponed(g,m,e)||d[n])?(c+=1,i=!1):(o>h&&(o=h),l+=1,delete d[n])}}return{empty:i,priority:o,mountedCount:s,unmountedCount:a,updatedCount:l,postponedCount:c}}updateViewsAsync(e={},t={processed:0,priority:uE.MIN_PRIORITY}){const n=this.updates,r=n.animationId;if(r){if(xm(r),0===t.processed){const t=e.before;"function"==typeof t&&Tg(t,this.graph,this.graph)}const i=this.updateViewsBatch(e),o=this.checkViewImpl({checkView:e.checkView,mountedBatchSize:uE.MOUNT_BATCH_SIZE-i.mountedCount,unmountedBatchSize:uE.MOUNT_BATCH_SIZE-i.unmountedCount});let s=t.processed;const a=n.count,l=o.mountedCount,c=o.unmountedCount;i.updatedCount>0&&(s+=i.updatedCount+i.unmountedCount,t.priority=Math.min(i.priority,t.priority),i.empty&&0===l?(i.priority=t.priority,i.mountedCount+=l,i.unmountedCount+=c,this.graph.trigger("render:done",{stats:i,options:e}),t.processed=0,n.count=0):t.processed=s);const u=e.progress;if(a&&"function"==typeof u&&Tg(u,this.graph,{total:a,done:i.empty,current:s}),n.animationId!==r)return}n.animationId=bm((()=>{this.updateViewsAsync(e,t)}))}registerMountedView(e){const t=e.cid,n=this.updates;if(t in n.mounted)return 0;n.mounted[t]=!0,n.mountedCids.push(t);const r=n.unmounted[t]||0;return delete n.unmounted[t],r}registerUnmountedView(e){const t=e.cid,n=this.updates;if(t in n.unmounted)return 0;n.unmounted[t]|=uE.FLAG_INSERT;const r=n.unmounted[t];return n.unmountedCids.push(t),delete n.mounted[t],r}isViewMounted(e){if(null==e)return!1;return e.cid in this.updates.mounted}getMountedViews(){return Object.keys(this.updates.mounted).map((e=>_x.views[e]))}getUnmountedViews(){return Object.keys(this.updates.unmounted).map((e=>_x.views[e]))}checkMountedViews(e,t){let n=0;if("function"!=typeof e)return n;const r=this.updates,i=r.mounted,o=r.mountedCids,s=null==t?o.length:Math.min(o.length,t);for(let t=0;t<s;t+=1){const r=o[t];if(!(r in i))continue;const s=_x.views[r];if(null==s)continue;if(Tg(e,this.graph,{view:s,unmounted:!0})){o.push(r);continue}n+=1;this.registerUnmountedView(s)&&s.unmount()}return o.splice(0,s),n}checkUnmountedViews(e,t){let n=0;"function"!=typeof e&&(e=null);const r=this.updates,i=r.unmounted,o=r.unmountedCids,s=null==t?o.length:Math.min(o.length,t);for(let t=0;t<s;t+=1){const r=o[t];if(!(r in i))continue;const s=_x.views[r];if(null==s)continue;if(e&&!Tg(e,this.graph,{view:s,unmounted:!1})){o.push(r);continue}n+=1;const a=this.registerMountedView(s);a&&this.scheduleViewUpdate(s,a,s.priority,{mounting:!0})}return o.splice(0,s),n}checkViewImpl(e={mountedBatchSize:Number.MAX_SAFE_INTEGER,unmountedBatchSize:Number.MAX_SAFE_INTEGER}){const t=e.checkView||this.options.checkView,n=this.checkMountedViews(t,e.unmountedBatchSize);return{mountedCount:this.checkUnmountedViews(t,n>0?Math.min(this.updates.unmountedCids.length-n,e.mountedBatchSize):e.mountedBatchSize),unmountedCount:n}}checkView(e={}){return this.checkViewImpl(e)}isFrozen(){return!!this.options.frozen}freeze(e={}){const t=e.key,n=this.updates,r=this.options.frozen,i=n.freezeKey;if(t&&t!==i){if(r&&i)return;n.frozen=r,n.freezeKey=t}this.options.frozen=!0;const o=n.animationId;n.animationId=null,this.isAsync()&&null!=o&&xm(o),this.graph.trigger("freeze",{key:t})}unfreeze(e={}){const t=e.key,n=this.updates,r=n.freezeKey;if(t&&r&&t!==r)return;if(n.freezeKey=null,t&&t===r&&n.frozen)return;const i=()=>{this.options.frozen=n.frozen=!1,n.sort&&(this.sortViews(),n.sort=!1);const r=e.after;r&&Tg(r,this.graph,this.graph),this.graph.trigger("unfreeze",{key:t})};if(this.isAsync()){this.freeze();const t=e.progress;this.updateViewsAsync(Object.assign(Object.assign({},e),{progress:({done:e,current:n,total:r})=>{t&&Tg(t,this.graph,{done:e,current:n,total:r}),e&&i()}}))}else this.updateViews(e),i()}isAsync(){return!!this.options.async}setAsync(e){this.options.async=e}onRemove(){this.freeze(),this.removeViews()}resetViews(e=[],t={}){this.resetUpdates(),this.removeViews(),this.freeze({key:"reset"});for(let n=0,r=e.length;n<r;n+=1)this.renderView(e[n],t);this.unfreeze({key:"reset"}),this.sortViews()}removeView(e){const t=this.views[e.id];if(t){const n=t.cid,r=this.updates,i=r.mounted,o=r.unmounted;t.remove(),delete this.views[e.id],delete i[n],delete o[n]}return t}removeViews(){this.views&&Object.keys(this.views).forEach((e=>{const t=this.views[e];t&&this.removeView(t.cell)})),this.views={}}renderView(e,t={}){const n=e.id,r=this.views;let i=0,o=r[n];if(e.isVisible()&&(!e.isEdge()||this.isEdgeTerminalVisible(e,"source")&&this.isEdgeTerminalVisible(e,"target"))){if(o)i=uE.FLAG_INSERT;else{const t=this.graph.hook.createCellView(e);t&&(o=r[e.id]=t,o.graph=this.graph,i=this.registerUnmountedView(o)|o.getBootstrapFlag())}o&&this.requestViewUpdate(o,i,o.priority,t)}}isExactSorting(){return"exact"===this.options.sorting}sortViews(){this.isExactSorting()&&(this.isFrozen()?this.updates.sort=!0:this.sortViewsExact())}sortElements(e,t){const n=e.map((e=>{const t=e.parentNode,n=t.insertBefore(document.createTextNode(""),e.nextSibling);return e=>{if(t===e)throw new Error("You can't sort elements if any one is a descendant of another.");t.insertBefore(e,n),t.removeChild(n)}}));e.sort(t).forEach(((e,t)=>n[t](e)))}sortViewsExact(){const e=this.view.$(this.view.stage).children("[data-cell-id]").toArray(),t=this.model;this.sortElements(e,((e,n)=>{const r=t.getCell(e.getAttribute("data-cell-id")||""),i=t.getCell(n.getAttribute("data-cell-id")||""),o=r.getZIndex()||0,s=i.getZIndex()||0;return o===s?0:o<s?-1:1}))}addZPivot(e=0){null==this.zPivots&&(this.zPivots={});const t=this.zPivots;let n=t[e];if(n)return n;n=t[e]=document.createComment(`z-index:${e+1}`);let r=-1/0;for(const n in t){const t=+n;t<e&&t>r&&(r=t)}const i=this.view.stage;if(r!==-1/0){const e=t[r];i.insertBefore(n,e.nextSibling)}else i.insertBefore(n,i.firstChild);return n}removeZPivots(){this.zPivots&&Object.keys(this.zPivots).forEach((e=>{const t=this.zPivots[e];t&&t.parentNode&&t.parentNode.removeChild(t)})),this.zPivots={}}insertView(e){const t=this.view.stage;switch(this.options.sorting){case"approx":{const n=e.cell.getZIndex(),r=this.addZPivot(n);t.insertBefore(e.container,r);break}default:t.appendChild(e.container)}}findViewByCell(e){if(null==e)return null;const t=lC.isCell(e)?e.id:e;return this.views[t]}findViewByElem(e){if(null==e)return null;const t="string"==typeof e?this.view.stage.querySelector(e):e instanceof Element?e:e[0];if(t){const e=this.view.findAttr("data-cell-id",t);if(e)return this.views[e]}return null}findViewsFromPoint(e){const t={x:e.x,y:e.y};return this.model.getCells().map((e=>this.findViewByCell(e))).filter((e=>null!=e&&Sv(e.container,{target:this.view.stage}).containsPoint(t)))}findEdgeViewsInArea(e,t={}){const n=Pm.create(e);return this.model.getEdges().map((e=>this.findViewByCell(e))).filter((e=>{if(e){const r=Sv(e.container,{target:this.view.stage});return 0===r.width?r.inflate(1,0):0===r.height&&r.inflate(0,1),t.strict?n.containsRect(r):n.isIntersectWithRect(r)}return!1}))}findViewsInArea(e,t={}){const n=Pm.create(e);return this.model.getNodes().map((e=>this.findViewByCell(e))).filter((e=>{if(e){const r=Sv(e.container,{target:this.view.stage});return t.strict?n.containsRect(r):n.isIntersectWithRect(r)}return!1}))}dispose(){this.resetUpdates(),this.stopListening()}}cE([UC.dispose()],uE.prototype,"dispose",null),function(e){e.FLAG_INSERT=1<<30,e.FLAG_REMOVE=1<<29,e.MOUNT_BATCH_SIZE=1e3,e.UPDATE_BATCH_SIZE=1e3,e.MIN_PRIORITY=2,e.SORT_DELAYING_BATCHES=["add","to-front","to-back"],e.UPDATE_DELAYING_BATCHES=["translate"]}(uE||(uE={}));var hE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class dE extends UC{get elem(){return this.view.background}init(){this.startListening(),this.options.background&&this.draw(this.options.background)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}updateBackgroundImage(e={}){let t=e.size||"auto auto",n=e.position||"center";const r=this.graph.transform.getScale(),i=this.graph.translate();if("object"==typeof n){n=`${i.tx+r.sx*(n.x||0)}px ${i.ty+r.sy*(n.y||0)}px`}"object"==typeof t&&(t=Pm.fromSize(t).scale(r.sx,r.sy),t=`${t.width}px ${t.height}px`),this.elem.style.backgroundSize=t,this.elem.style.backgroundPosition=n}drawBackgroundImage(e,t={}){if(!(e instanceof HTMLImageElement))return void(this.elem.style.backgroundImage="");const n=this.optionsCache;if(n&&n.image!==t.image)return;let r;const i=t.opacity,o=t.size;let s=t.repeat||"no-repeat";const a=_b.registry.get(s);if("function"==typeof a){const n=t.quality||1;e.width*=n,e.height*=n;const i=a(e,t);if(!(i instanceof HTMLCanvasElement))throw new Error("Background pattern must return an HTML Canvas instance");r=i.toDataURL("image/png"),s=t.repeat&&s!==t.repeat?t.repeat:"repeat","object"==typeof o?(o.width*=i.width/e.width,o.height*=i.height/e.height):void 0===o&&(t.size={width:i.width/n,height:i.height/n})}else r=e.src,void 0===o&&(t.size={width:e.width,height:e.height});null!=n&&"object"==typeof t.size&&t.image===n.image&&t.repeat===n.repeat&&t.quality===n.quality&&(n.size=ec(t.size));const l=this.elem.style;l.backgroundImage=`url(${r})`,l.backgroundRepeat=s,l.opacity=null==i||i>=1?"":`${i}`,this.updateBackgroundImage(t)}updateBackgroundColor(e){this.elem.style.backgroundColor=e||""}updateBackgroundOptions(e){this.graph.options.background=e}update(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache)}draw(e){const t=e||{};if(this.updateBackgroundOptions(e),this.updateBackgroundColor(t.color),t.image){this.optionsCache=ec(t);const n=document.createElement("img");n.onload=()=>this.drawBackgroundImage(n,e),n.setAttribute("crossorigin","anonymous"),n.src=t.image}else this.drawBackgroundImage(null),this.optionsCache=null}clear(){this.draw()}dispose(){this.clear(),this.stopListening()}}hE([UC.dispose()],dE.prototype,"dispose",null);var fE,pE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},gE=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class mE extends dx{constructor(e){super(),this.padding={left:0,top:0,right:0,bottom:0},this.options=fE.getOptions(e);const t=this.graph.transform.getScale();this.sx=t.sx,this.sy=t.sy;const n=this.options.width||this.graph.options.width,r=this.options.height||this.graph.options.height;this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName(fE.containerClass)).css({width:n,height:r}),this.options.pageVisible&&this.$container.addClass(this.prefixClassName(fE.pagedClass)),this.options.className&&this.$container.addClass(this.options.className);const i=this.graph.container;i.parentNode&&this.$container.insertBefore(i);const o=i.getAttribute("style");if(o){const e={};o.split(";").forEach((t=>{const n=t.trim();if(n){const t=n.split(":");t.length&&(e[t[0].trim()]=t[1]?t[1].trim():"")}})),Object.keys(e).forEach((t=>{"width"!==t&&"height"!==t&&(i.style[t]="",this.container.style[t]=e[t])}))}this.content=document.createElement("div"),this.$content=this.$(this.content).addClass(this.prefixClassName(fE.contentClass)).css({width:this.graph.options.width,height:this.graph.options.height}),this.background=document.createElement("div"),this.$background=this.$(this.background).addClass(this.prefixClassName(fE.backgroundClass)),this.$content.append(this.background),this.options.pageVisible||this.$content.append(this.graph.view.grid),this.$content.append(i),this.$content.appendTo(this.container),this.startListening(),this.options.pageVisible||this.graph.grid.update(),this.backgroundManager=new mE.Background(this),this.options.autoResize||this.update()}get graph(){return this.options.graph}get model(){return this.graph.model}startListening(){const e=this.graph,t=this.model;e.on("scale",this.onScale,this),e.on("resize",this.onResize,this),e.on("before:print",this.storeScrollPosition,this),e.on("before:export",this.storeScrollPosition,this),e.on("after:print",this.restoreScrollPosition,this),e.on("after:export",this.restoreScrollPosition,this),e.on("render:done",this.onRenderDone,this),e.on("unfreeze",this.onUpdate,this),t.on("reseted",this.onUpdate,this),t.on("cell:added",this.onUpdate,this),t.on("cell:removed",this.onUpdate,this),t.on("cell:changed",this.onUpdate,this),t.on("batch:stop",this.onBatchStop,this),this.delegateBackgroundEvents()}stopListening(){const e=this.graph,t=this.model;e.off("scale",this.onScale,this),e.off("resize",this.onResize,this),e.off("beforeprint",this.storeScrollPosition,this),e.off("beforeexport",this.storeScrollPosition,this),e.off("afterprint",this.restoreScrollPosition,this),e.off("afterexport",this.restoreScrollPosition,this),e.off("render:done",this.onRenderDone,this),e.off("unfreeze",this.onUpdate,this),t.off("reseted",this.onUpdate,this),t.off("cell:added",this.onUpdate,this),t.off("cell:removed",this.onUpdate,this),t.off("cell:changed",this.onUpdate,this),t.off("batch:stop",this.onBatchStop,this),this.undelegateBackgroundEvents()}enableAutoResize(){this.options.autoResize=!0}disableAutoResize(){this.options.autoResize=!1}onUpdate(){!this.graph.isAsync()&&this.options.autoResize&&this.update()}onBatchStop(e){!this.graph.isAsync()&&this.options.autoResize&&uE.UPDATE_DELAYING_BATCHES.includes(e.name)&&this.update()}delegateBackgroundEvents(e){const t=e||WC.events;this.delegatedHandlers=Object.keys(t).reduce(((e,n)=>{const r=t[n];if(-1===n.indexOf(" "))if("function"==typeof r)e[n]=r;else{let t=this.graph.view[r];"function"==typeof t&&(t=t.bind(this.graph.view),e[n]=t)}return e}),{}),this.onBackgroundEvent=this.onBackgroundEvent.bind(this),Object.keys(this.delegatedHandlers).forEach((e=>{this.delegateEvent(e,{guarded:!1},this.onBackgroundEvent)}))}undelegateBackgroundEvents(){Object.keys(this.delegatedHandlers).forEach((e=>{this.undelegateEvent(e,this.onBackgroundEvent)}))}onBackgroundEvent(e){let t=!1;const n=e.target;if(this.options.pageVisible)t=this.options.background?this.background===n:this.content===n;else{const e=this.graph.view;t=e.background===n||e.grid===n}if(t){const t=this.delegatedHandlers[e.type];"function"==typeof t&&t.apply(this.graph,arguments)}}onRenderDone({stats:e}){this.options.autoResize&&e.priority<2&&this.update()}onResize(){this.cachedCenterPoint&&(this.centerPoint(this.cachedCenterPoint.x,this.cachedCenterPoint.y),this.updatePageBreak())}onScale({sx:e,sy:t,ox:n,oy:r}){this.updateScale(e,t),(n||r)&&(this.centerPoint(n,r),this.updatePageBreak());"function"==typeof(this.options.autoResizeOptions||this.options.fitTocontentOptions)&&this.update()}storeScrollPosition(){this.cachedScrollLeft=this.container.scrollLeft,this.cachedScrollTop=this.container.scrollTop}restoreScrollPosition(){this.container.scrollLeft=this.cachedScrollLeft,this.container.scrollTop=this.cachedScrollTop,this.cachedScrollLeft=null,this.cachedScrollTop=null}storeClientSize(){this.cachedClientSize={width:this.container.clientWidth,height:this.container.clientHeight}}restoreClientSize(){this.cachedClientSize=null}beforeManipulation(){(gr.IS_IE||gr.IS_EDGE)&&this.$container.css("visibility","hidden")}afterManipulation(){(gr.IS_IE||gr.IS_EDGE)&&this.$container.css("visibility","visible")}updatePageSize(e,t){null!=e&&(this.options.pageWidth=e),null!=t&&(this.options.pageHeight=t),this.updatePageBreak()}updatePageBreak(){if(this.pageBreak&&this.pageBreak.parentNode&&this.pageBreak.parentNode.removeChild(this.pageBreak),this.pageBreak=null,this.options.pageVisible&&this.options.pageBreak){const e=this.graph.options.width,t=this.graph.options.height,n=this.options.pageWidth*this.sx,r=this.options.pageHeight*this.sy;if(e>n||t>r){let i=!1;const o=document.createElement("div");for(let t=1,r=Math.floor(e/n);t<r;t+=1)this.$("<div/>").addClass(this.prefixClassName("graph-pagebreak-vertical")).css({left:t*n}).appendTo(o),i=!0;for(let e=1,n=Math.floor(t/r);e<n;e+=1)this.$("<div/>").addClass(this.prefixClassName("graph-pagebreak-horizontal")).css({top:e*r}).appendTo(o),i=!0;i&&(Fg(o,this.prefixClassName("graph-pagebreak")),this.$(this.graph.view.grid).after(o),this.pageBreak=o)}}}update(){const e=this.getClientSize();this.cachedCenterPoint=this.clientToLocalPoint(e.width/2,e.height/2);let t=this.options.autoResizeOptions||this.options.fitTocontentOptions;"function"==typeof t&&(t=Tg(t,this,this));const n=Object.assign({gridWidth:this.options.pageWidth,gridHeight:this.options.pageHeight,allowNewOrigin:"negative"},t);this.graph.fitToContent(this.getFitToContentOptions(n))}getFitToContentOptions(e){const t=this.sx,n=this.sy;return e.gridWidth&&(e.gridWidth*=t),e.gridHeight&&(e.gridHeight*=n),e.minWidth&&(e.minWidth*=t),e.minHeight&&(e.minHeight*=n),"object"==typeof e.padding?e.padding={left:(e.padding.left||0)*t,right:(e.padding.right||0)*t,top:(e.padding.top||0)*n,bottom:(e.padding.bottom||0)*n}:"number"==typeof e.padding&&(e.padding*=t),this.options.autoResize||(e.contentArea=Pm.create()),e}updateScale(e,t){const n=this.graph.options,r=e/this.sx,i=t/this.sy;this.sx=e,this.sy=t,this.graph.translate(n.x*r,n.y*i),this.graph.resizeGraph(n.width*r,n.height*i)}scrollbarPosition(e,t,n){if(null==e&&null==t)return{left:this.container.scrollLeft,top:this.container.scrollTop};const r={};return"number"==typeof e&&(r.scrollLeft=e),"number"==typeof t&&(r.scrollTop=t),n&&n.animation?this.$container.animate(r,n.animation):this.$container.prop(r),this}scrollToPoint(e,t,n){const r=this.getClientSize(),i=this.graph.matrix(),o={};return"number"==typeof e&&(o.scrollLeft=e-r.width/2+i.e+(this.padding.left||0)),"number"==typeof t&&(o.scrollTop=t-r.height/2+i.f+(this.padding.top||0)),n&&n.animation?this.$container.animate(o,n.animation):this.$container.prop(o),this}scrollToContent(e){const t=this.sx,n=this.sy,r=this.graph.getContentArea().getCenter();return this.scrollToPoint(r.x*t,r.y*n,e)}scrollToCell(e,t){const n=this.sx,r=this.sy,i=e.getBBox().getCenter();return this.scrollToPoint(i.x*n,i.y*r,t)}center(e){return this.centerPoint(e)}centerPoint(e,t,n){const r=this.graph.matrix(),i=r.a,o=r.d,s=-r.e,a=-r.f,l=s+this.graph.options.width,c=a+this.graph.options.height;let u;if(this.storeClientSize(),"number"==typeof e||"number"==typeof t){u=n;const r=this.getVisibleArea().getCenter();"number"==typeof e?e*=i:e=r.x,"number"==typeof t?t*=o:t=r.y}else u=e,e=(s+l)/2,t=(a+c)/2;if(u&&u.padding)return this.positionPoint({x:e,y:t},"50%","50%",u);const h=this.getPadding(),d=this.getClientSize(),f=d.width/2,p=d.height/2,g=f-h.left-e+s,m=f-h.right+e-l,v=p-h.top-t+a,y=p-h.bottom+t-c;this.addPadding(Math.max(g,0),Math.max(m,0),Math.max(v,0),Math.max(y,0));const b=this.scrollToPoint(e,t,u||void 0);return this.restoreClientSize(),b}centerContent(e){return this.positionContent("center",e)}centerCell(e,t){return this.positionCell(e,"center",t)}positionContent(e,t){const n=this.graph.getContentArea(t);return this.positionRect(n,e,t)}positionCell(e,t,n){const r=e.getBBox();return this.positionRect(r,t,n)}positionRect(e,t,n){const r=Pm.create(e);switch(t){case"center":return this.positionPoint(r.getCenter(),"50%","50%",n);case"top":return this.positionPoint(r.getTopCenter(),"50%",0,n);case"top-right":return this.positionPoint(r.getTopRight(),"100%",0,n);case"right":return this.positionPoint(r.getRightMiddle(),"100%","50%",n);case"bottom-right":return this.positionPoint(r.getBottomRight(),"100%","100%",n);case"bottom":return this.positionPoint(r.getBottomCenter(),"50%","100%",n);case"bottom-left":return this.positionPoint(r.getBottomLeft(),0,"100%",n);case"left":return this.positionPoint(r.getLeftMiddle(),0,"50%",n);case"top-left":return this.positionPoint(r.getTopLeft(),0,0,n);default:return this}}positionPoint(e,t,n,r={}){const{padding:i}=r,o=gE(r,["padding"]),s=kg(i),a=Pm.fromSize(this.getClientSize()),l=a.clone().moveAndExpand({x:s.left,y:s.top,width:-s.right-s.left,height:-s.top-s.bottom});(t=Og(t,Math.max(0,l.width)))<0&&(t=l.width+t),(n=Og(n,Math.max(0,l.height)))<0&&(n=l.height+n);const c=l.getTopLeft().translate(t,n),u=a.getCenter().diff(c),h=this.zoom(),d=u.scale(1/h,1/h),f=Tm.create(e).translate(d);return this.centerPoint(f.x,f.y,o)}zoom(e,t){if(null==e)return this.sx;let n,r;t=t||{};const i=this.getClientSize(),o=this.clientToLocalPoint(i.width/2,i.height/2);let s=e,a=e;if(t.absolute||(s+=this.sx,a+=this.sy),t.scaleGrid&&(s=Math.round(s/t.scaleGrid)*t.scaleGrid,a=Math.round(a/t.scaleGrid)*t.scaleGrid),t.maxScale&&(s=Math.min(t.maxScale,s),a=Math.min(t.maxScale,a)),t.minScale&&(s=Math.max(t.minScale,s),a=Math.max(t.minScale,a)),s=this.graph.transform.clampScale(s),a=this.graph.transform.clampScale(a),t.center){const e=s/this.sx,i=a/this.sy;n=t.center.x-(t.center.x-o.x)/e,r=t.center.y-(t.center.y-o.y)/i}else n=o.x,r=o.y;return this.beforeManipulation(),this.graph.transform.scale(s,a),this.centerPoint(n,r),this.afterManipulation(),this}zoomToRect(e,t={}){const n=Pm.create(e),r=this.graph;t.contentArea=n,null==t.viewportArea&&(t.viewportArea={x:r.options.x,y:r.options.y,width:this.$container.width(),height:this.$container.height()}),this.beforeManipulation(),r.transform.scaleContentToFitImpl(t,!1);const i=n.getCenter();return this.centerPoint(i.x,i.y),this.afterManipulation(),this}zoomToFit(e={}){return this.zoomToRect(this.graph.getContentArea(e),e)}transitionToPoint(e,t,n){let r,i;"object"==typeof e?(n=t,t=e.y,e=e.x):t=t,null==n&&(n={});const o=this.sx,s=Math.max(n.scale||o,1e-6),a=this.getClientSize(),l=new Tm(e,t),c=this.clientToLocalPoint(a.width/2,a.height/2);if(o===s){const e=c.diff(l).scale(o,o).round();r=`translate(${e.x}px,${e.y}px)`}else{const e=s/(o-s)*l.distance(c),t=c.clone().move(l,e),n=this.localToBackgroundPoint(t).round();r=`scale(${s/o})`,i=`${n.x}px ${n.y}px`}const u=n.onTransitionEnd;return this.$container.addClass(fE.transitionClassName),this.$content.off(fE.transitionEventName).on(fE.transitionEventName,(n=>{this.syncTransition(s,{x:e,y:t}),"function"==typeof u&&Tg(u,this,n.originalEvent)})).css({transform:r,transformOrigin:i,transition:"transform",transitionDuration:n.duration||"1s",transitionDelay:n.delay,transitionTimingFunction:n.timing}),this}syncTransition(e,t){return this.beforeManipulation(),this.graph.scale(e),this.removeTransition(),this.centerPoint(t.x,t.y),this.afterManipulation(),this}removeTransition(){return this.$container.removeClass(fE.transitionClassName),this.$content.off(fE.transitionEventName).css({transform:"",transformOrigin:"",transition:"",transitionDuration:"",transitionDelay:"",transitionTimingFunction:""}),this}transitionToRect(e,t={}){const n=Pm.create(e),r=t.maxScale||1/0,i=t.minScale||Number.MIN_VALUE,o=t.scaleGrid||null,s=t.visibility||1,a=t.center?Tm.create(t.center):n.getCenter(),l=this.getClientSize(),c=l.width*s,u=l.height*s;let h=new Pm(a.x-c/2,a.y-u/2,c,u).getMaxUniformScaleToFit(n,a);return h=Math.min(h,r),o&&(h=Math.floor(h/o)*o),h=Math.max(i,h),this.transitionToPoint(a,Object.assign({scale:h},t))}startPanning(e){const t=this.normalizeEvent(e);this.clientX=t.clientX,this.clientY=t.clientY,this.trigger("pan:start",{e:t}),this.$(document.body).on({"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this)}),this.$(window).on("mouseup.panning",this.stopPanning.bind(this))}pan(e){const t=this.normalizeEvent(e),n=t.clientX-this.clientX,r=t.clientY-this.clientY;this.container.scrollTop-=r,this.container.scrollLeft-=n,this.clientX=t.clientX,this.clientY=t.clientY,this.trigger("panning",{e:t})}stopPanning(e){this.$(document.body).off(".panning"),this.$(window).off(".panning"),this.trigger("pan:stop",{e:e})}clientToLocalPoint(e,t){let n="object"==typeof e?e.x:e,r="object"==typeof e?e.y:t;const i=this.graph.matrix();return n+=this.container.scrollLeft-this.padding.left-i.e,r+=this.container.scrollTop-this.padding.top-i.f,new Tm(n/i.a,r/i.d)}localToBackgroundPoint(e,t){const n="object"==typeof e?Tm.create(e):new Tm(e,t),r=this.graph.matrix(),i=this.padding;return Cv(n,r).translate(i.left,i.top)}resize(e,t){let n=null!=e?e:this.container.clientWidth,r=null!=t?t:this.container.clientHeight;"number"==typeof n&&(n=Math.round(n)),"number"==typeof r&&(r=Math.round(r)),this.options.width=n,this.options.height=r,this.$container.css({width:n,height:r}),this.update()}getClientSize(){return this.cachedClientSize?this.cachedClientSize:{width:this.container.clientWidth,height:this.container.clientHeight}}autoScroll(e,t){const n=10,r=this.container,i=r.getBoundingClientRect();let o=0,s=0;return e<=i.left+n&&(o=-10),t<=i.top+n&&(s=-10),e>=i.right-n&&(o=n),t>=i.bottom-n&&(s=n),0!==o&&(r.scrollLeft+=o),0!==s&&(r.scrollTop+=s),{scrollerX:o,scrollerY:s}}addPadding(e,t,n,r){let i=this.getPadding();this.padding={left:Math.round(i.left+(e||0)),top:Math.round(i.top+(n||0)),bottom:Math.round(i.bottom+(r||0)),right:Math.round(i.right+(t||0))},i=this.padding,this.$content.css({width:i.left+this.graph.options.width+i.right,height:i.top+this.graph.options.height+i.bottom});const o=this.graph.container;return o.style.left=`${this.padding.left}px`,o.style.top=`${this.padding.top}px`,this}getPadding(){const e=this.options.padding;return kg("function"==typeof e?Tg(e,this,this):e)}getVisibleArea(){const e=this.graph.matrix(),t=this.getClientSize(),n=Ev({x:this.container.scrollLeft||0,y:this.container.scrollTop||0,width:t.width,height:t.height},e.inverse());return n.x-=(this.padding.left||0)/this.sx,n.y-=(this.padding.top||0)/this.sy,n}isCellVisible(e,t={}){const n=e.getBBox(),r=this.getVisibleArea();return t.strict?r.containsRect(n):r.isIntersectWithRect(n)}isPointVisible(e){return this.getVisibleArea().containsPoint(e)}lock(){return this.$container.css("overflow","hidden"),this}unlock(){return this.$container.css("overflow","scroll"),this}onRemove(){this.stopListening()}dispose(){this.$(this.graph.container).insertBefore(this.$container),this.remove()}}function vE(e,t,n,r={}){if(n){const i=n.graph,o=i.view.normalizeEvent(t),s=i.snapToGrid(o.clientX,o.clientY);n.notify(e,Object.assign({e:o,view:n,node:n.cell,cell:n.cell,x:s.x,y:s.y},r))}}pE([dx.dispose()],mE.prototype,"dispose",null),function(e){e.Background=class extends dE{constructor(e){super(e.graph),this.scroller=e,e.options.background&&this.draw(e.options.background)}get elem(){return this.scroller.background}init(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}updateBackgroundOptions(e){this.scroller.options.background=e}}}(mE||(mE={})),function(e){e.containerClass="graph-scroller",e.panningClass=`${e.containerClass}-panning`,e.pannableClass=`${e.containerClass}-pannable`,e.pagedClass=`${e.containerClass}-paged`,e.contentClass=`${e.containerClass}-content`,e.backgroundClass=`${e.containerClass}-background`,e.transitionClassName="transition-in-progress",e.transitionEventName="transitionend.graph-scroller-transition",e.defaultOptions={padding(){const e=this.getClientSize(),t=Math.max(this.options.minVisibleWidth||0,1)||1,n=Math.max(this.options.minVisibleHeight||0,1)||1,r=Math.max(e.width-t,0),i=Math.max(e.height-n,0);return{left:r,top:i,right:r,bottom:i}},minVisibleWidth:50,minVisibleHeight:50,pageVisible:!1,pageBreak:!1,autoResize:!0},e.getOptions=function(t){const n=rd({},e.defaultOptions,t);return null==n.pageWidth&&(n.pageWidth=t.graph.options.width),null==n.pageHeight&&(n.pageHeight=t.graph.options.height),n}}(fE||(fE={}));var yE,bE,xE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class wE extends dx{constructor(e){super(),this.options=rd({},yE.defaultOptions,e),this.options.model&&(this.options.collection=this.options.model.collection),this.options.collection?this.collection=this.options.collection:(this.collection=new AC([],{comparator:yE.depthComparator}),this.options.collection=this.collection),this.boxCount=0,this.createContainer(),this.initHandles(),this.startListening()}get graph(){return this.options.graph}get boxClassName(){return this.prefixClassName(yE.classNames.box)}get $boxes(){return this.$container.children(`.${this.boxClassName}`)}get handleOptions(){return this.options}startListening(){const e=this.graph,t=this.collection;this.delegateEvents({[`mousedown .${this.boxClassName}`]:"onSelectionBoxMouseDown",[`touchstart .${this.boxClassName}`]:"onSelectionBoxMouseDown"},!0),e.on("scale",this.onGraphTransformed,this),e.on("translate",this.onGraphTransformed,this),e.model.on("updated",this.onModelUpdated,this),t.on("added",this.onCellAdded,this),t.on("removed",this.onCellRemoved,this),t.on("reseted",this.onReseted,this),t.on("updated",this.onCollectionUpdated,this),t.on("node:change:position",this.onNodePositionChanged,this),t.on("cell:changed",this.onCellChanged,this)}stopListening(){const e=this.graph,t=this.collection;this.undelegateEvents(),e.off("scale",this.onGraphTransformed,this),e.off("translate",this.onGraphTransformed,this),e.model.off("updated",this.onModelUpdated,this),t.off("added",this.onCellAdded,this),t.off("removed",this.onCellRemoved,this),t.off("reseted",this.onReseted,this),t.off("updated",this.onCollectionUpdated,this),t.off("node:change:position",this.onNodePositionChanged,this),t.off("cell:changed",this.onCellChanged,this)}onRemove(){this.stopListening()}onGraphTransformed(){this.updateSelectionBoxes({async:!1})}onCellChanged(){this.updateSelectionBoxes()}onNodePositionChanged({node:e,options:t}){const{showNodeSelectionBox:n,pointerEvents:r}=this.options,{ui:i,selection:o}=t;let s=!this.translating;if(s=s&&(!0!==n||"none"===r),s=s&&i&&!o,s){this.translating=!0;const n=e.position(),r=e.previous("position"),i=n.x-r.x,o=n.y-r.y;0===i&&0===o||this.translateSelectedNodes(i,o,e,t),this.translating=!1}}onModelUpdated({removed:e}){e&&e.length&&this.unselect(e)}isEmpty(){return this.length<=0}isSelected(e){return this.collection.has(e)}get length(){return this.collection.length}get cells(){return this.collection.toArray()}select(e,t={}){t.dryrun=!0;const n=this.filter(Array.isArray(e)?e:[e]);return this.collection.add(n,t),this}unselect(e,t={}){return t.dryrun=!0,this.collection.remove(Array.isArray(e)?e:[e],t),this}reset(e,t={}){if(e){if(t.batch){const n=this.filter(Array.isArray(e)?e:[e]);return this.collection.reset(n,Object.assign(Object.assign({},t),{ui:!0})),this}const n=this.cells,r=this.filter(Array.isArray(e)?e:[e]),i={},o={};n.forEach((e=>i[e.id]=e)),r.forEach((e=>o[e.id]=e));const s=[],a=[];return r.forEach((e=>{i[e.id]||s.push(e)})),n.forEach((e=>{o[e.id]||a.push(e)})),a.length&&this.unselect(a,Object.assign(Object.assign({},t),{ui:!0})),s.length&&this.select(s,Object.assign(Object.assign({},t),{ui:!0})),0===a.length&&0===s.length&&this.updateContainer(),this}return this.clean(t)}clean(e={}){return this.length&&(!1===e.batch?this.unselect(this.cells,e):this.collection.reset([],Object.assign(Object.assign({},e),{ui:!0}))),this}setFilter(e){this.options.filter=e}setContent(e){this.options.content=e}startSelecting(e){let t,n;e=this.normalizeEvent(e),this.clean();const r=this.graph.container;if(null!=e.offsetX&&null!=e.offsetY&&r.contains(e.target))t=e.offsetX,n=e.offsetY;else{const i=this.$(r).offset(),o=r.scrollLeft,s=r.scrollTop;t=e.clientX-i.left+window.pageXOffset+o,n=e.clientY-i.top+window.pageYOffset+s}this.$container.css({top:n,left:t,width:1,height:1}),this.setEventData(e,{action:"selecting",clientX:e.clientX,clientY:e.clientY,offsetX:t,offsetY:n,scrollerX:0,scrollerY:0}),this.delegateDocumentEvents(yE.documentEvents,e.data)}filter(e){const t=this.options.filter;return Array.isArray(t)?e.filter((e=>!t.includes(e)&&!t.includes(e.shape))):"function"==typeof t?e.filter((e=>Tg(t,this.graph,e))):e}stopSelecting(e){const t=this.graph,n=this.getEventData(e);switch(n.action){case"selecting":{let e=this.$container.width(),n=this.$container.height();const r=this.$container.offset(),i=t.pageToLocal(r.left,r.top),o=t.transform.getScale();e/=o.sx,n/=o.sy;const s=new Pm(i.x,i.y,e,n),a=this.getCellViewsInArea(s).map((e=>e.cell));this.reset(a,{batch:!0}),this.hideRubberband();break}case"translating":{const r=t.snapToGrid(e.clientX,e.clientY);if(!this.options.following){const e=n;this.updateSelectedNodesPosition({dx:e.clientX-e.originX,dy:e.clientY-e.originY})}this.graph.model.stopBatch("move-selection"),this.notifyBoxEvent("box:mouseup",e,r.x,r.y);break}default:this.clean()}}onMouseUp(e){this.getEventData(e).action&&(this.stopSelecting(e),this.undelegateDocumentEvents())}onSelectionBoxMouseDown(e){this.options.following||e.stopPropagation();const t=this.normalizeEvent(e);this.options.movable&&this.startTranslating(t);const n=this.getCellViewFromElem(t.target);this.setEventData(t,{activeView:n});const r=this.graph.snapToGrid(t.clientX,t.clientY);this.notifyBoxEvent("box:mousedown",t,r.x,r.y),this.delegateDocumentEvents(yE.documentEvents,t.data)}startTranslating(e){this.graph.model.startBatch("move-selection");const t=this.graph.snapToGrid(e.clientX,e.clientY);this.setEventData(e,{action:"translating",clientX:t.x,clientY:t.y,originX:t.x,originY:t.y})}getSelectionOffset(e,t){let n=e.x-t.clientX,r=e.y-t.clientY;const i=this.graph.hook.getRestrictArea();if(i){const o=this.collection.toArray(),s=lC.getCellsBBox(o,{deep:!0})||Pm.create(),a=i.x-s.x,l=i.y-s.y,c=i.x+i.width-(s.x+s.width),u=i.y+i.height-(s.y+s.height);if(n<a&&(n=a),r<l&&(r=l),c<n&&(n=c),u<r&&(r=u),!this.options.following){const i=e.x-t.originX,o=e.y-t.originY;n=i<=a||i>=c?0:n,r=o<=l||o>=u?0:r}}return{dx:n,dy:r}}updateSelectedNodesPosition(e){const{dx:t,dy:n}=e;if(t||n)if(this.translateSelectedNodes(t,n),this.boxesUpdated)this.collection.length>1&&this.updateSelectionBoxes();else{const e=this.graph.transform.getScale();this.$boxes.add(this.$selectionContainer).css({left:"+="+t*e.sx,top:"+="+n*e.sy})}}autoScrollGraph(e,t){const n=this.graph.scroller.widget;return n?n.autoScroll(e,t):{scrollerX:0,scrollerY:0}}adjustSelection(e){const t=this.normalizeEvent(e),n=this.getEventData(t);switch(n.action){case"selecting":{const e=n;!0!==e.moving&&(this.$container.appendTo(this.graph.container),this.showRubberband(),e.moving=!0);const{scrollerX:r,scrollerY:i}=this.autoScrollGraph(t.clientX,t.clientY);e.scrollerX+=r,e.scrollerY+=i;const o=t.clientX-e.clientX+e.scrollerX,s=t.clientY-e.clientY+e.scrollerY,a=parseInt(this.$container.css("left"),10),l=parseInt(this.$container.css("top"),10);this.$container.css({left:o<0?e.offsetX+o:a,top:s<0?e.offsetY+s:l,width:Math.abs(o),height:Math.abs(s)});break}case"translating":{const r=this.graph.snapToGrid(t.clientX,t.clientY),i=n,o=this.getSelectionOffset(r,i);this.options.following?this.updateSelectedNodesPosition(o):this.updateContainerPosition(o),o.dx&&(i.clientX=r.x),o.dy&&(i.clientY=r.y),this.notifyBoxEvent("box:mousemove",e,r.x,r.y);break}}this.boxesUpdated=!1}translateSelectedNodes(e,t,n,r){const i={},o=[];if(n&&(i[n.id]=!0),this.collection.toArray().forEach((e=>{e.getDescendants({deep:!0}).forEach((e=>{i[e.id]=!0}))})),r&&r.translateBy){const e=this.graph.getCellById(r.translateBy);e&&(i[e.id]=!0,e.getDescendants({deep:!0}).forEach((e=>{i[e.id]=!0})),o.push(e))}this.collection.toArray().forEach((n=>{if(!i[n.id]){const s=Object.assign(Object.assign({},r),{selection:this.cid,exclude:o});n.translate(e,t,s),this.graph.model.getConnectedEdges(n).forEach((n=>{i[n.id]||(n.translate(e,t,s),i[n.id]=!0)}))}}))}getCellViewsInArea(e){const t=this.graph,n={strict:this.options.strict};let r=[];return this.options.rubberNode&&(r=this.options.useCellGeometry?r.concat(t.model.getNodesInArea(e,n).map((e=>t.renderer.findViewByCell(e))).filter((e=>null!=e))):r.concat(t.renderer.findViewsInArea(e,n))),this.options.rubberEdge&&(r=this.options.useCellGeometry?r.concat(t.model.getEdgesInArea(e,n).map((e=>t.renderer.findViewByCell(e))).filter((e=>null!=e))):r.concat(t.renderer.findEdgeViewsInArea(e,n))),r}notifyBoxEvent(e,t,n,r){const i=this.getEventData(t).activeView;this.trigger(e,{e:t,view:i,x:n,y:r,cell:i.cell})}getSelectedClassName(e){return this.prefixClassName((e.isNode()?"node":"edge")+"-selected")}addCellSelectedClassName(e){const t=this.graph.renderer.findViewByCell(e);t&&t.addClass(this.getSelectedClassName(e))}removeCellUnSelectedClassName(e){const t=this.graph.renderer.findViewByCell(e);t&&t.removeClass(this.getSelectedClassName(e))}destroySelectionBox(e){this.removeCellUnSelectedClassName(e),this.canShowSelectionBox(e)&&(this.$container.find(`[data-cell-id="${e.id}"]`).remove(),0===this.$boxes.length&&this.hide(),this.boxCount=Math.max(0,this.boxCount-1))}destroyAllSelectionBoxes(e){e.forEach((e=>this.removeCellUnSelectedClassName(e))),this.hide(),this.$boxes.remove(),this.boxCount=0}hide(){this.$container.removeClass(this.prefixClassName(yE.classNames.rubberband)).removeClass(this.prefixClassName(yE.classNames.selected))}showRubberband(){this.$container.addClass(this.prefixClassName(yE.classNames.rubberband))}hideRubberband(){this.$container.removeClass(this.prefixClassName(yE.classNames.rubberband))}showSelected(){this.$container.removeAttr("style").addClass(this.prefixClassName(yE.classNames.selected))}createContainer(){this.container=document.createElement("div"),this.$container=this.$(this.container),this.$container.addClass(this.prefixClassName(yE.classNames.root)),this.options.className&&this.$container.addClass(this.options.className),this.$selectionContainer=this.$("<div/>").addClass(this.prefixClassName(yE.classNames.inner)),this.$selectionContent=this.$("<div/>").addClass(this.prefixClassName(yE.classNames.content)),this.$selectionContainer.append(this.$selectionContent),this.$selectionContainer.attr("data-selection-length",this.collection.length),this.$container.prepend(this.$selectionContainer),this.$handleContainer=this.$selectionContainer}updateContainerPosition(e){(e.dx||e.dy)&&this.$selectionContainer.css({left:`+=${e.dx}`,top:`+=${e.dy}`})}updateContainer(){const e={x:1/0,y:1/0},t={x:0,y:0};this.collection.toArray().filter((e=>this.canShowSelectionBox(e))).forEach((n=>{const r=this.graph.renderer.findViewByCell(n);if(r){const n=r.getBBox({useCellGeometry:this.options.useCellGeometry});e.x=Math.min(e.x,n.x),e.y=Math.min(e.y,n.y),t.x=Math.max(t.x,n.x+n.width),t.y=Math.max(t.y,n.y+n.height)}})),this.$selectionContainer.css({position:"absolute",pointerEvents:"none",left:e.x,top:e.y,width:t.x-e.x,height:t.y-e.y}).attr("data-selection-length",this.collection.length);const n=this.options.content;if(n)if("function"==typeof n){const e=Tg(n,this.graph,this,this.$selectionContent[0]);e&&this.$selectionContent.html(e)}else this.$selectionContent.html(n);this.collection.length>0&&!this.container.parentNode?this.$container.appendTo(this.graph.container):this.collection.length<=0&&this.container.parentNode&&this.container.parentNode.removeChild(this.container)}canShowSelectionBox(e){return e.isNode()&&!0===this.options.showNodeSelectionBox||e.isEdge()&&!0===this.options.showEdgeSelectionBox}createSelectionBox(e){if(this.addCellSelectedClassName(e),this.canShowSelectionBox(e)){const t=this.graph.renderer.findViewByCell(e);if(t){const n=t.getBBox({useCellGeometry:this.options.useCellGeometry}),r=this.boxClassName;this.$("<div/>").addClass(r).addClass(`${r}-${e.isNode()?"node":"edge"}`).attr("data-cell-id",e.id).css({position:"absolute",left:n.x,top:n.y,width:n.width,height:n.height,pointerEvents:this.options.pointerEvents||"auto"}).appendTo(this.container),this.showSelected(),this.boxCount+=1}}}updateSelectionBoxes(e={}){this.collection.length>0&&(this.boxesUpdated=!0,this.graph.renderer.requestViewUpdate(this,1,2,e))}confirmUpdate(){return this.boxCount&&(this.hide(),this.$boxes.each(((e,t)=>{const n=this.$(t).remove().attr("data-cell-id"),r=this.collection.get(n);r&&this.createSelectionBox(r)})),this.updateContainer()),0}getCellViewFromElem(e){const t=e.getAttribute("data-cell-id");if(t){const e=this.collection.get(t);if(e)return this.graph.renderer.findViewByCell(e)}return null}onCellRemoved({cell:e}){this.destroySelectionBox(e),this.updateContainer()}onReseted({previous:e,current:t}){this.destroyAllSelectionBoxes(e),t.forEach((e=>{this.listenCellRemoveEvent(e),this.createSelectionBox(e)})),this.updateContainer()}onCellAdded({cell:e}){this.listenCellRemoveEvent(e),this.createSelectionBox(e),this.updateContainer()}listenCellRemoveEvent(e){e.off("removed",this.onCellRemoved,this),e.on("removed",this.onCellRemoved,this)}onCollectionUpdated({added:e,removed:t,options:n}){e.forEach((e=>{this.trigger("cell:selected",{cell:e,options:n}),this.graph.trigger("cell:selected",{cell:e,options:n}),e.isNode()?(this.trigger("node:selected",{cell:e,options:n,node:e}),this.graph.trigger("node:selected",{cell:e,options:n,node:e})):e.isEdge()&&(this.trigger("edge:selected",{cell:e,options:n,edge:e}),this.graph.trigger("edge:selected",{cell:e,options:n,edge:e}))})),t.forEach((e=>{this.trigger("cell:unselected",{cell:e,options:n}),this.graph.trigger("cell:unselected",{cell:e,options:n}),e.isNode()?(this.trigger("node:unselected",{cell:e,options:n,node:e}),this.graph.trigger("node:unselected",{cell:e,options:n,node:e})):e.isEdge()&&(this.trigger("edge:unselected",{cell:e,options:n,edge:e}),this.graph.trigger("edge:unselected",{cell:e,options:n,edge:e}))}));const r={added:e,removed:t,options:n,selected:this.cells};this.trigger("selection:changed",r),this.graph.trigger("selection:changed",r)}deleteSelectedCells(){const e=this.collection.toArray();this.clean(),this.graph.model.removeCells(e,{selection:this.cid})}startRotate({e:e}){const t=this.collection.toArray(),n=lC.getCellsBBox(t).getCenter(),r=this.graph.snapToGrid(e.clientX,e.clientY),i=t.reduce(((e,t)=>(e[t.id]=Cm.normalize(t.getAngle()),e)),{});this.setEventData(e,{center:n,angles:i,start:r.theta(n)})}doRotate({e:e}){const t=this.getEventData(e),n=this.graph.options.rotating.grid,r="function"==typeof n?Tg(n,this.graph,null):n,i=this.graph.snapToGrid(e.clientX,e.clientY),o=t.start-i.theta(t.center);t.rotated||(t.rotated=!0),Math.abs(o)>.001&&(this.collection.toArray().forEach((e=>{const n=Ab.snapToGrid(t.angles[e.id]+o,r||15);e.rotate(n,{absolute:!0,center:t.center,selection:this.cid})})),this.updateSelectionBoxes())}stopRotate({e:e}){const t=this.getEventData(e);t.rotated&&(t.rotated=!1,this.collection.toArray().forEach((t=>{vE("node:rotated",e,this.graph.findViewByCell(t))})))}startResize({e:e}){const t=this.graph.getGridSize(),n=this.collection.toArray(),r=lC.getCellsBBox(n),i=n.map((e=>e.getBBox())),o=i.reduce(((e,t)=>t.width<e?t.width:e),1/0),s=i.reduce(((e,t)=>t.height<e?t.height:e),1/0);this.setEventData(e,{bbox:r,cells:this.graph.model.getSubGraph(n),minWidth:t*r.width/o,minHeight:t*r.height/s})}doResize({e:e,dx:t,dy:n}){const r=this.eventData(e),i=r.bbox,o=i.width,s=i.height,a=Math.max(o+t,r.minWidth),l=Math.max(s+n,r.minHeight);r.resized||(r.resized=!0),(Math.abs(o-a)>.001||Math.abs(s-l)>.001)&&(this.graph.model.resizeCells(a,l,r.cells,{selection:this.cid}),i.width=a,i.height=l,this.updateSelectionBoxes())}stopResize({e:e}){const t=this.eventData(e);t.resized&&(t.resized=!1,this.collection.toArray().forEach((t=>{vE("node:resized",e,this.graph.findViewByCell(t))})))}dispose(){this.clean(),this.remove()}}xE([dx.dispose()],wE.prototype,"dispose",null),hg(wE,KC),function(e){const t="widget-selection";e.classNames={root:t,inner:`${t}-inner`,box:`${t}-box`,content:`${t}-content`,rubberband:`${t}-rubberband`,selected:`${t}-selected`},e.documentEvents={mousemove:"adjustSelection",touchmove:"adjustSelection",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},e.defaultOptions={movable:!0,following:!0,strict:!1,useCellGeometry:!1,content:e=>op('<%= length %> node<%= length > 1 ? "s":"" %> selected.')({length:e.length}),handles:[{name:"remove",position:"nw",events:{mousedown:"deleteSelectedCells"}},{name:"rotate",position:"sw",events:{mousedown:"startRotate",mousemove:"doRotate",mouseup:"stopRotate"}},{name:"resize",position:"se",events:{mousedown:"startResize",mousemove:"doResize",mouseup:"stopResize"}}]},e.depthComparator=function(e){return e.getAncestors().length}}(yE||(yE={}));class CE extends eE{get node(){return this.cell}get containerClassName(){return this.prefixClassName("widget-transform")}get resizeClassName(){return`${this.containerClassName}-resize`}get rotateClassName(){return`${this.containerClassName}-rotate`}init(e){this.options=Object.assign(Object.assign({},bE.defaultOptions),e),this.render(),this.startListening()}startListening(){this.delegateEvents({[`mousedown .${this.resizeClassName}`]:"startResizing",[`touchstart .${this.resizeClassName}`]:"startResizing",[`mousedown .${this.rotateClassName}`]:"startRotating",[`touchstart .${this.rotateClassName}`]:"startRotating"}),this.model.on("*",this.update,this),this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this),this.node.on("removed",this.remove,this),this.model.on("reseted",this.remove,this),this.view.on("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.on("cell:knob:mouseup",this.onKnobMouseUp,this),super.startListening()}stopListening(){this.undelegateEvents(),this.model.off("*",this.update,this),this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this),this.node.off("removed",this.remove,this),this.model.off("reseted",this.remove,this),this.view.off("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.off("cell:knob:mouseup",this.onKnobMouseUp,this),super.stopListening()}renderHandles(){this.container=document.createElement("div"),this.$container=this.$(this.container);const e=this.$("<div/>").prop("draggable",!1),t=e.clone().addClass(this.rotateClassName),n=bE.POSITIONS.map((t=>e.clone().addClass(this.resizeClassName).attr("data-position",t)));this.empty(),this.$container.append(n,t)}render(){return this.renderHandles(),this.view.addClass(bE.NODE_CLS),this.$container.addClass(this.containerClassName).toggleClass("no-orth-resize",this.options.preserveAspectRatio||!this.options.orthogonalResizing).toggleClass("no-resize",!this.options.resizable).toggleClass("no-rotate",!this.options.rotatable),this.options.className&&this.$container.addClass(this.options.className),this.graph.container.appendChild(this.container),this.update()}update(){const e=this.graph.matrix(),t=this.node.getBBox();t.x*=e.a,t.x+=e.e,t.y*=e.d,t.y+=e.f,t.width*=e.a,t.height*=e.d;const n=Cm.normalize(this.node.getAngle()),r=0!==n?`rotate(${n}deg)`:"";return this.$container.css({transform:r,width:t.width,height:t.height,left:t.x,top:t.y}),this.updateResizerDirections(),this}remove(){return this.view.removeClass(bE.NODE_CLS),super.remove()}onKnobMouseDown(){this.startHandle()}onKnobMouseUp(){this.stopHandle()}updateResizerDirections(){const e=Cm.normalize(this.node.getAngle()),t=Math.floor(e*(bE.DIRECTIONS.length/360));if(t!==this.prevShift){const e=bE.DIRECTIONS.slice(t).concat(bE.DIRECTIONS.slice(0,t)),n=e=>`${this.containerClassName}-cursor-${e}`;this.$container.find(`.${this.resizeClassName}`).removeClass(bE.DIRECTIONS.map((e=>n(e))).join(" ")).each(((t,r)=>{this.$(r).addClass(n(e[t]))})),this.prevShift=t}}getTrueDirection(e){const t=Cm.normalize(this.node.getAngle());let n=bE.POSITIONS.indexOf(e);return n+=Math.floor(t*(bE.POSITIONS.length/360)),n%=bE.POSITIONS.length,bE.POSITIONS[n]}toValidResizeDirection(e){return{top:"top-left",bottom:"bottom-right",left:"bottom-left",right:"top-right"}[e]||e}startResizing(e){e.stopPropagation(),this.model.startBatch("resize",{cid:this.cid});const t=this.$(e.target).attr("data-position"),n=this.graph.findViewByCell(this.node);this.prepareResizing(e,t),this.startAction(e),vE("node:resize:mousedown",e,n)}prepareResizing(e,t){const n=this.getTrueDirection(t);let r=0,i=0;t.split("-").forEach((e=>{r={left:-1,right:1}[e]||r,i={top:-1,bottom:1}[e]||i}));const o=this.toValidResizeDirection(t),s={"top-right":"bottomLeft","top-left":"bottomRight","bottom-left":"topRight","bottom-right":"topLeft"}[o],a=Cm.normalize(this.node.getAngle());this.setEventData(e,{selector:s,direction:o,trueDirection:n,relativeDirection:t,angle:a,resizeX:r,resizeY:i,action:"resizing"})}startRotating(e){e.stopPropagation(),this.model.startBatch("rotate",{cid:this.cid});const t=this.graph.findViewByCell(this.node),n=this.node.getBBox().getCenter(),r=this.normalizeEvent(e),i=this.graph.snapToGrid(r.clientX,r.clientY);this.setEventData(e,{center:n,action:"rotating",angle:Cm.normalize(this.node.getAngle()),start:Tm.create(i).theta(n)}),this.startAction(e),vE("node:rotate:mousedown",e,t)}onMouseMove(e){const t=this.graph.findViewByCell(this.node);let n=this.getEventData(e);if(n.action){const r=this.normalizeEvent(e);let i=r.clientX,o=r.clientY;const s=this.graph.scroller.widget,a=this.options.restrictedResizing;if(!0===a||"number"==typeof a){const e=!0===a?0:a,t=s?Math.max(e,8):e,n=this.graph.container.getBoundingClientRect();i=il(i,n.left+t,n.right-t),o=il(o,n.top+t,n.bottom-t)}else this.options.autoScrollOnResizing&&s&&s.autoScroll(i,o);const l=this.graph.snapToGrid(i,o),c=this.graph.getGridSize(),u=this.node,h=this.options;if("resizing"===n.action){n=n,n.resized||(t&&(t.addClass("node-resizing"),vE("node:resize",e,t)),n.resized=!0);const r=u.getBBox(),i=Tm.create(l).rotate(n.angle,r.getCenter()).diff(r[n.selector]);let o=n.resizeX?i.x*n.resizeX:r.width,s=n.resizeY?i.y*n.resizeY:r.height;const a=o,d=s;if(o=Ab.snapToGrid(o,c),s=Ab.snapToGrid(s,c),o=Math.max(o,h.minWidth||c),s=Math.max(s,h.minHeight||c),o=Math.min(o,h.maxWidth||1/0),s=Math.min(s,h.maxHeight||1/0),h.preserveAspectRatio){const e=r.width*s/r.height,t=r.height*o/r.width;o<e?s=t:o=e}const f=n.relativeDirection;if(h.allowReverse&&(a<=-o||d<=-s)){let t;"left"===f?a<=-o&&(t="right"):"right"===f?a<=-o&&(t="left"):"top"===f?d<=-s&&(t="bottom"):"bottom"===f?d<=-s&&(t="top"):"top-left"===f?a<=-o&&d<=-s?t="bottom-right":a<=-o?t="top-right":d<=-s&&(t="bottom-left"):"top-right"===f?a<=-o&&d<=-s?t="bottom-left":a<=-o?t="top-left":d<=-s&&(t="bottom-right"):"bottom-left"===f?a<=-o&&d<=-s?t="top-right":a<=-o?t="bottom-right":d<=-s&&(t="top-left"):"bottom-right"===f&&(a<=-o&&d<=-s?t="top-left":a<=-o?t="bottom-left":d<=-s&&(t="top-right"));const n=t;this.stopHandle();const r=this.$container.find(`.${this.resizeClassName}[data-position="${n}"]`);this.startHandle(r[0]),this.prepareResizing(e,n),this.onMouseMove(e)}if(r.width!==o||r.height!==s){const r={ui:!0,direction:n.direction,relativeDirection:n.relativeDirection,trueDirection:n.trueDirection,minWidth:h.minWidth,minHeight:h.minHeight,maxWidth:h.maxWidth,maxHeight:h.maxHeight,preserveAspectRatio:!0===h.preserveAspectRatio};u.resize(o,s,r),vE("node:resizing",e,t)}vE("node:resize:mousemove",e,t)}else if("rotating"===n.action){n=n,n.rotated||(t&&(t.addClass("node-rotating"),vE("node:rotate",e,t)),n.rotated=!0);const r=u.getAngle(),i=n.start-Tm.create(l).theta(n.center);let o=n.angle+i;h.rotateGrid&&(o=Ab.snapToGrid(o,h.rotateGrid)),r!==o&&(u.rotate(o,{absolute:!0}),vE("node:rotating",e,t)),vE("node:rotate:mousemove",e,t)}}}onMouseUp(e){const t=this.graph.findViewByCell(this.node),n=this.getEventData(e);n.action&&(this.stopAction(e),this.model.stopBatch("resizing"===n.action?"resize":"rotate",{cid:this.cid}),"resizing"===n.action?vE("node:resize:mouseup",e,t):"rotating"===n.action&&vE("node:rotate:mouseup",e,t))}startHandle(e){if(this.handle=e||null,this.$container.addClass(`${this.containerClassName}-active`),e){this.$(e).addClass(`${this.containerClassName}-active-handle`);const t=e.getAttribute("data-position");if(t){const e=bE.DIRECTIONS[bE.POSITIONS.indexOf(t)];this.$container.addClass(`${this.containerClassName}-cursor-${e}`)}}}stopHandle(){if(this.$container.removeClass(`${this.containerClassName}-active`),this.handle){this.$(this.handle).removeClass(`${this.containerClassName}-active-handle`);const e=this.handle.getAttribute("data-position");if(e){const t=bE.DIRECTIONS[bE.POSITIONS.indexOf(e)];this.$container.removeClass(`${this.containerClassName}-cursor-${t}`)}this.handle=null}}startAction(e){this.startHandle(e.target),this.graph.view.undelegateEvents(),this.delegateDocumentEvents(bE.documentEvents,e.data)}stopAction(e){this.stopHandle(),this.undelegateDocumentEvents(),this.graph.view.delegateEvents();const t=this.graph.findViewByCell(this.node),n=this.getEventData(e);t&&(t.removeClass(`node-${n.action}`),"resizing"===n.action&&n.resized?vE("node:resized",e,t):"rotating"===n.action&&n.rotated&&vE("node:rotated",e,t))}}!function(e){e.NODE_CLS="has-widget-transform",e.DIRECTIONS=["nw","n","ne","e","se","s","sw","w"],e.POSITIONS=["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"],e.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp"},e.defaultOptions={minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,rotateGrid:15,rotatable:!0,preserveAspectRatio:!1,orthogonalResizing:!0,restrictedResizing:!1,autoScrollOnResizing:!0,allowReverse:!0}}(bE||(bE={}));var EE,_E=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};!function(e){e.parseOptionGroup=function(e,t,n){const r={};return Object.keys(n||{}).forEach((i=>{const o=n[i];r[i]="function"==typeof o?o.call(e,t):o})),r}}(EE||(EE={})),function(e){e.get=function(t){const{grid:n,panning:r,selecting:i,embedding:o,snapline:s,resizing:a,rotating:l,knob:c,clipboard:u,history:h,scroller:d,minimap:f,keyboard:p,mousewheel:g}=t,m=_E(t,["grid","panning","selecting","embedding","snapline","resizing","rotating","knob","clipboard","history","scroller","minimap","keyboard","mousewheel"]),v=t.container;if(null==v)throw new Error("Ensure the container of the graph is specified and valid");null==m.width&&(m.width=v.clientWidth),null==m.height&&(m.height=v.clientHeight);const y=rd({},e.defaults,m),b={size:10,visible:!1};return y.grid="number"==typeof n?{size:n,visible:!1}:"boolean"==typeof n?Object.assign(Object.assign({},b),{visible:n}):Object.assign(Object.assign({},b),n),["panning","selecting","embedding","snapline","resizing","rotating","knob","clipboard","history","scroller","minimap","keyboard","mousewheel"].forEach((e=>{const n=t[e];"boolean"==typeof n?y[e].enabled=n:y[e]=Object.assign(Object.assign({},y[e]),n)})),y.background&&y.scroller.enabled&&null==y.scroller.background&&(y.scroller.background=y.background,delete y.background),y}}(EE||(EE={})),function(e){e.defaults={x:0,y:0,grid:{size:10,visible:!1},scaling:{min:.01,max:16},background:!1,highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:Ab.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:Ab.prefix("available-magnet")}}},connecting:{snap:!1,multi:!0,dangling:!0,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",strategy:null,router:"normal",connector:"normal",validateConnection:({type:e,sourceView:t,targetView:n})=>null!=("target"===e?n:t),createEdge:()=>new FC},transforming:{clearAll:!0,clearOnBlankMouseDown:!0},resizing:{enabled:!1,minWidth:0,minHeight:0,maxWidth:Number.MAX_SAFE_INTEGER,maxHeight:Number.MAX_SAFE_INTEGER,orthogonal:!0,restricted:!1,autoScroll:!0,preserveAspectRatio:!1,allowReverse:!0},rotating:{enabled:!1,grid:15},translating:{restrict:!1},knob:{enabled:!1,clearAll:!0,clearOnBlankMouseDown:!0},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:()=>!0},selecting:{enabled:!1,rubberband:!1,rubberNode:!0,rubberEdge:!1,pointerEvents:"auto",multiple:!0,movable:!0,strict:!1,useCellGeometry:!1,selectCellOnMoved:!1,selectNodeOnMoved:!1,selectEdgeOnMoved:!1,content:null,handles:null},panning:{enabled:!1,eventTypes:["leftMouseDown"]},snapline:{enabled:!1},clipboard:{enabled:!1},history:{enabled:!1},scroller:{enabled:!1},keyboard:{enabled:!1},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},async:!1,frozen:!1,sorting:"exact",moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},guard:()=>!1}}(EE||(EE={}));var SE=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class OE extends UC{get cid(){return this.graph.view.cid}get svg(){return this.view.svg}get defs(){return this.view.defs}isDefined(e){return null!=this.svg.getElementById(e)}filter(e){let t=e.id;const n=e.name;if(t||(t=`filter-${n}-${this.cid}-${wg(JSON.stringify(e))}`),!this.isDefined(t)){const r=bb.registry.get(n);if(null==r)return bb.registry.onNotFound(n);const i=r(e.args||{}),o=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},e.attrs),{id:t});ev.create(yx.sanitize(i),o).appendTo(this.defs)}return t}gradient(e){let t=e.id;const n=e.type;if(t||(t=`gradient-${n}-${this.cid}-${wg(JSON.stringify(e))}`),!this.isDefined(t)){const r=e.stops.map((e=>{const t=null!=e.opacity&&Number.isFinite(e.opacity)?e.opacity:1;return`<stop offset="${e.offset}" stop-color="${e.color}" stop-opacity="${t}"/>`})),i=`<${n}>${r.join("")}</${n}>`,o=Object.assign({id:t},e.attrs);ev.create(i,o).appendTo(this.defs)}return t}marker(e){const{id:t,refX:n,refY:r,markerUnits:i,markerOrient:o,tagName:s,children:a}=e,l=SE(e,["id","refX","refY","markerUnits","markerOrient","tagName","children"]);let c=t;if(c||(c=`marker-${this.cid}-${wg(JSON.stringify(e))}`),!this.isDefined(c)){"path"!==s&&delete l.d;const e=ev.create("marker",{refX:n,refY:r,id:c,overflow:"visible",orient:null!=o?o:"auto",markerUnits:i||"userSpaceOnUse"},a?a.map((e=>{var{tagName:t}=e,n=SE(e,["tagName"]);return ev.create(`${t}`||"path",um(Object.assign(Object.assign({},l),n)))})):[ev.create(s||"path",um(l))]);this.defs.appendChild(e.node)}return c}remove(e){const t=this.svg.getElementById(e);t&&t.parentNode&&t.parentNode.removeChild(t)}}var AE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},kE=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class ME extends UC{get elem(){return this.view.grid}get grid(){return this.options.grid}init(){this.startListening(),this.draw(this.grid)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}setVisible(e){this.grid.visible!==e&&(this.grid.visible=e,this.update())}getGridSize(){return this.grid.size}setGridSize(e){this.grid.size=Math.max(e,1),this.update()}show(){this.setVisible(!0),this.update()}hide(){this.setVisible(!1),this.update()}clear(){this.elem.style.backgroundImage=""}draw(e){this.clear(),this.instance=null,Object.assign(this.grid,e),this.patterns=this.resolveGrid(e),this.update()}update(e={}){const t=this.grid.size;if(t<=1||!this.grid.visible)return this.clear();const n=this.graph.matrix(),r=this.getInstance(),i=Array.isArray(e)?e:[e];this.patterns.forEach(((e,o)=>{const s=`pattern_${o}`,a=n.a||1,l=n.d||1,{update:c,markup:u}=e,h=kE(e,["update","markup"]),d=Object.assign(Object.assign(Object.assign({},h),i[o]),{sx:a,sy:l,ox:n.e||0,oy:n.f||0,width:t*a,height:t*l});r.has(s)||r.add(s,ev.create("pattern",{id:s,patternUnits:"userSpaceOnUse"},ev.createVectors(u)).node);const f=r.get(s);"function"==typeof c&&c(f.childNodes[0],d);let p=d.ox%d.width;p<0&&(p+=d.width);let g=d.oy%d.height;g<0&&(g+=d.height),lm(f,{x:p,y:g,width:d.width,height:d.height})}));const o=(new XMLSerializer).serializeToString(r.root),s=`url(data:image/svg+xml;base64,${btoa(o)})`;this.elem.style.backgroundImage=s}getInstance(){return this.instance||(this.instance=new mb),this.instance}resolveGrid(e){if(!e)return[];const t=e.type;if(null==t)return[Object.assign(Object.assign({},mb.presets.dot),e.args)];const n=mb.registry.get(t);if(n){let t=e.args||[];return Array.isArray(t)||(t=[t]),Array.isArray(n)?n.map(((e,n)=>Object.assign(Object.assign({},e),t[n]))):[Object.assign(Object.assign({},n),t[0])]}return mb.registry.onNotFound(t)}dispose(){this.stopListening(),this.clear()}}AE([UC.dispose()],ME.prototype,"dispose",null);class TE extends UC{getClientMatrix(){return mv(this.view.stage.getScreenCTM())}getClientOffset(){const e=this.view.svg.getBoundingClientRect();return new Tm(e.left,e.top)}getPageOffset(){return this.getClientOffset().translate(window.scrollX,window.scrollY)}snapToGrid(e,t){return("number"==typeof e?this.clientToLocalPoint(e,t):this.clientToLocalPoint(e.x,e.y)).snapToGrid(this.graph.getGridSize())}localToGraphPoint(e,t){return Cv(Tm.create(e,t),this.graph.matrix())}localToClientPoint(e,t){return Cv(Tm.create(e,t),this.getClientMatrix())}localToPagePoint(e,t){return("number"==typeof e?this.localToGraphPoint(e,t):this.localToGraphPoint(e)).translate(this.getPageOffset())}localToGraphRect(e,t,n,r){return Ev(Pm.create(e,t,n,r),this.graph.matrix())}localToClientRect(e,t,n,r){return Ev(Pm.create(e,t,n,r),this.getClientMatrix())}localToPageRect(e,t,n,r){return("number"==typeof e?this.localToGraphRect(e,t,n,r):this.localToGraphRect(e)).translate(this.getPageOffset())}graphToLocalPoint(e,t){return Cv(Tm.create(e,t),this.graph.matrix().inverse())}clientToLocalPoint(e,t){return Cv(Tm.create(e,t),this.getClientMatrix().inverse())}clientToGraphPoint(e,t){return Cv(Tm.create(e,t),this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalPoint(e,t){const n=Tm.create(e,t).diff(this.getPageOffset());return this.graphToLocalPoint(n)}graphToLocalRect(e,t,n,r){return Ev(Pm.create(e,t,n,r),this.graph.matrix().inverse())}clientToLocalRect(e,t,n,r){return Ev(Pm.create(e,t,n,r),this.getClientMatrix().inverse())}clientToGraphRect(e,t,n,r){return Ev(Pm.create(e,t,n,r),this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalRect(e,t,n,r){const i=Pm.create(e,t,n,r),o=this.getPageOffset();return i.x-=o.x,i.y-=o.y,this.graphToLocalRect(i)}}var PE,DE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class NE extends UC{constructor(){super(...arguments),this.widget=this.graph.hook.createSnapline()}dispose(){this.widget.dispose()}}DE([UC.dispose()],NE.prototype,"dispose",null),function(e){function t(e){const t=[],n=[];return Array.isArray(e)?t.push(...e):e.split("|").forEach((e=>{-1===e.indexOf("&")?t.push(e):n.push(...e.split("&"))})),{or:t,and:n}}e.parse=t,e.equals=function(e,n){if(null!=e&&null!=n){const r=t(e),i=t(n),o=r.or.sort(),s=i.or.sort(),a=r.and.sort(),l=i.and.sort(),c=(e,t)=>e.length===t.length&&(0===e.length||e.every(((e,n)=>e===t[n])));return c(o,s)&&c(a,l)}return null==e&&null==n},e.isMatch=function(e,n,r){if(null==n||Array.isArray(n)&&0===n.length)return!r||!0!==e.altKey&&!0!==e.ctrlKey&&!0!==e.metaKey&&!0!==e.shiftKey;const{or:i,and:o}=t(n),s=t=>{const n=`${t.toLowerCase()}Key`;return!0===e[n]};return i.some((e=>s(e)))&&o.every((e=>s(e)))}}(PE||(PE={}));var RE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class IE extends UC{get widgetOptions(){return this.options.scroller}get pannable(){return!!this.widgetOptions&&("object"==typeof this.widgetOptions.pannable?this.widgetOptions.pannable.enabled:!!this.widgetOptions.pannable)}init(){this.widget=this.graph.hook.createScroller(),this.startListening(),this.updateClassName(),this.widget&&this.widget.center()}startListening(){let e=[];const t=this.widgetOptions.pannable;e="object"==typeof t?t.eventTypes||[]:["leftMouseDown"],e.includes("leftMouseDown")&&(this.graph.on("blank:mousedown",this.preparePanning,this),this.graph.on("node:unhandled:mousedown",this.preparePanning,this),this.graph.on("edge:unhandled:mousedown",this.preparePanning,this)),e.includes("rightMouseDown")&&(this.onRightMouseDown=this.onRightMouseDown.bind(this),this.view.$(this.graph.container).on("mousedown",this.onRightMouseDown))}stopListening(){let e=[];const t=this.widgetOptions.pannable;e="object"==typeof t?t.eventTypes||[]:["leftMouseDown"],e.includes("leftMouseDown")&&(this.graph.off("blank:mousedown",this.preparePanning,this),this.graph.off("node:unhandled:mousedown",this.preparePanning,this),this.graph.off("edge:unhandled:mousedown",this.preparePanning,this)),e.includes("rightMouseDown")&&this.view.$(this.graph.container).off("mousedown",this.onRightMouseDown)}onRightMouseDown(e){2===e.button&&this.allowPanning(e,!0)&&this.widget&&(this.updateClassName(!0),this.widget.startPanning(e),this.widget.once("pan:stop",(()=>this.updateClassName(!1))))}preparePanning({e:e}){this.widget&&(this.allowPanning(e,!0)||this.allowPanning(e)&&!this.graph.selection.allowRubberband(e,!0))&&(this.updateClassName(!0),this.widget.startPanning(e),this.widget.once("pan:stop",(()=>this.updateClassName(!1))))}allowPanning(e,t){return this.widget&&this.pannable&&PE.isMatch(e,this.widgetOptions.modifiers,t)&&this.graph.hook.allowPanning(e)}updateClassName(e){if(null==this.widget)return;const t=this.widget.container,n=this.view.prefixClassName("graph-scroller-pannable");this.pannable?(Fg(t,n),t.dataset.panning=(!!e).toString()):Gg(t,n)}enablePanning(){this.pannable||(this.widgetOptions.pannable=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.pannable=!1,this.updateClassName())}lock(){this.widget&&this.widget.lock()}unlock(){this.widget&&this.widget.unlock()}update(){this.widget&&this.widget.update()}enableAutoResize(){this.widget&&this.widget.enableAutoResize()}disableAutoResize(){this.widget&&this.widget.disableAutoResize()}resize(e,t){this.widget&&this.widget.resize(e,t)}dispose(){this.widget&&this.widget.dispose(),this.stopListening()}}RE([UC.dispose()],IE.prototype,"dispose",null);var jE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},LE=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class FE extends UC{get commonOptions(){const e=this.instanceOptions;return LE(e,["enabled"])}get instanceOptions(){return this.options.clipboard}get cells(){return this.widget.cells}get disabled(){return!0!==this.instanceOptions.enabled}init(){this.widget=this.graph.hook.createClipboard(),this.widget.deserialize(this.instanceOptions)}enable(){this.disabled&&(this.instanceOptions.enabled=!0)}disable(){this.disabled||(this.instanceOptions.enabled=!1)}copy(e,t={}){this.disabled||this.widget.copy(e,this.graph,Object.assign(Object.assign({},this.commonOptions),t))}cut(e,t={}){this.disabled||this.widget.cut(e,this.graph,Object.assign(Object.assign({},this.commonOptions),t))}paste(e={},t=this.graph){return this.disabled?[]:this.widget.paste(t,Object.assign(Object.assign({},this.commonOptions),e))}clean(e){this.disabled&&!e||this.widget.clean()}isEmpty(){return this.widget.isEmpty()}dispose(){this.clean(!0)}}jE([UC.dispose()],FE.prototype,"dispose",null);var GE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class BE extends UC{constructor(){super(...arguments),this.highlights={}}init(){this.startListening()}startListening(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this)}stopListening(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this)}onCellHighlight({view:e,magnet:t,options:n={}}){const r=this.resolveHighlighter(n);if(!r)return;const i=this.getHighlighterId(t,r);if(!this.highlights[i]){const n=r.highlighter;n.highlight(e,t,Object.assign({},r.args)),this.highlights[i]={cellView:e,magnet:t,highlighter:n,args:r.args}}}onCellUnhighlight({magnet:e,options:t={}}){const n=this.resolveHighlighter(t);if(!n)return;const r=this.getHighlighterId(e,n);this.unhighlight(r)}resolveHighlighter(e){const t=this.options;let n=e.highlighter;if(null==n){const r=e.type;n=r&&t.highlighting[r]||t.highlighting.default}if(null==n)return null;const r="string"==typeof n?{name:n}:n,i=r.name,o=Ib.registry.get(i);return null==o?Ib.registry.onNotFound(i):(Ib.check(i,o),{name:i,highlighter:o,args:r.args||{}})}getHighlighterId(e,t){return Ug(e),t.name+e.id+JSON.stringify(t.args)}unhighlight(e){const t=this.highlights[e];t&&(t.highlighter.unhighlight(t.cellView,t.magnet,t.args),delete this.highlights[e])}dispose(){Object.keys(this.highlights).forEach((e=>this.unhighlight(e))),this.stopListening()}}GE([BE.dispose()],BE.prototype,"dispose",null);var zE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class UE extends UC{constructor(){super(...arguments),this.widgets=new Map}get container(){return this.graph.view.container}get viewport(){return this.graph.view.viewport}get isSelectionEnabled(){return!0===this.options.selecting.enabled}init(){this.startListening(),this.resize()}startListening(){this.graph.on("node:mouseup",this.onNodeMouseUp,this),this.graph.on("node:selected",this.onNodeSelected,this),this.graph.on("node:unselected",this.onNodeUnSelected,this)}stopListening(){this.graph.off("node:mouseup",this.onNodeMouseUp,this),this.graph.off("node:selected",this.onNodeSelected,this),this.graph.off("node:unselected",this.onNodeUnSelected,this)}onNodeMouseUp({node:e}){if(!this.isSelectionEnabled){const t=this.graph.hook.createTransform(e,{clearAll:!0});t&&this.widgets.set(e,t)}}onNodeSelected({node:e}){if(this.isSelectionEnabled){const t=this.graph.hook.createTransform(e,{clearAll:!1});t&&this.widgets.set(e,t)}}onNodeUnSelected({node:e}){if(this.isSelectionEnabled){const t=this.widgets.get(e);t&&t.dispose(),this.widgets.delete(e)}}getMatrix(){const e=this.viewport.getAttribute("transform");return e!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=e),mv(this.viewportMatrix)}setMatrix(e){const t=mv(e),n=bv(t);this.viewport.setAttribute("transform",n),this.viewportMatrix=t,this.viewportTransformString=n}resize(e,t){let n=void 0===e?this.options.width:e,r=void 0===t?this.options.height:t;this.options.width=n,this.options.height=r,"number"==typeof n&&(n=Math.round(n)),"number"==typeof r&&(r=Math.round(r)),this.container.style.width=null==n?"":`${n}px`,this.container.style.height=null==r?"":`${r}px`;const i=this.getComputedSize();return this.graph.trigger("resize",Object.assign({},i)),this}getComputedSize(){let e=this.options.width,t=this.options.height;return Gh(e)||(e=this.container.clientWidth),Gh(t)||(t=this.container.clientHeight),{width:e,height:t}}getScale(){return function(e){let t,n,r,i;return e?(t=null==e.a?1:e.a,i=null==e.d?1:e.d,n=e.b,r=e.c):t=i=1,{sx:n?Math.sqrt(t*t+n*n):t,sy:r?Math.sqrt(r*r+i*i):i}}(this.getMatrix())}scale(e,t=e,n=0,r=0){if(e=this.clampScale(e),t=this.clampScale(t),n||r){const i=this.getTranslation(),o=i.tx-n*(e-1),s=i.ty-r*(t-1);o===i.tx&&s===i.ty||this.translate(o,s)}const i=this.getMatrix();return i.a=e,i.d=t,this.setMatrix(i),this.graph.trigger("scale",{sx:e,sy:t,ox:n,oy:r}),this}clampScale(e){const t=this.graph.options.scaling;return il(e,t.min||.01,t.max||16)}getZoom(){return this.getScale().sx}zoom(e,t){t=t||{};let n=e,r=e;const i=this.getScale(),o=this.getComputedSize();let s=o.width/2,a=o.height/2;if(t.absolute||(n+=i.sx,r+=i.sy),t.scaleGrid&&(n=Math.round(n/t.scaleGrid)*t.scaleGrid,r=Math.round(r/t.scaleGrid)*t.scaleGrid),t.maxScale&&(n=Math.min(t.maxScale,n),r=Math.min(t.maxScale,r)),t.minScale&&(n=Math.max(t.minScale,n),r=Math.max(t.minScale,r)),t.center&&(s=t.center.x,a=t.center.y),n=this.clampScale(n),r=this.clampScale(r),s||a){const e=this.getTranslation(),t=s-(s-e.tx)*(n/i.sx),o=a-(a-e.ty)*(r/i.sy);t===e.tx&&o===e.ty||this.translate(t,o)}return this.scale(n,r),this}getRotation(){return function(e){let t={x:0,y:1};return e&&(t=wv(e,t)),{angle:Cm.normalize(Cm.toDeg(Math.atan2(t.y,t.x))-90)}}(this.getMatrix())}rotate(e,t,n){if(null==t||null==n){const e=Sv(this.graph.view.stage);t=e.width/2,n=e.height/2}const r=this.getMatrix().translate(t,n).rotate(e).translate(-t,-n);return this.setMatrix(r),this}getTranslation(){return{tx:(e=this.getMatrix())&&e.e||0,ty:e&&e.f||0};var e}translate(e,t){const n=this.getMatrix();n.e=e||0,n.f=t||0,this.setMatrix(n);const r=this.getTranslation();return this.options.x=r.tx,this.options.y=r.ty,this.graph.trigger("translate",Object.assign({},r)),this}setOrigin(e,t){return this.translate(e||0,t||0)}fitToContent(e,t,n,r){if("object"==typeof e){const i=e;e=i.gridWidth||1,t=i.gridHeight||1,n=i.padding||0,r=i}else e=e||1,t=t||1,n=n||0,null==r&&(r={});const i=kg(n),o=r.border||0,s=r.contentArea?Pm.create(r.contentArea):this.getContentArea(r);o>0&&s.inflate(o);const a=this.getScale(),l=this.getTranslation(),c=a.sx,u=a.sy;s.x*=c,s.y*=u,s.width*=c,s.height*=u;let h=Math.max(Math.ceil((s.width+s.x)/e),1)*e,d=Math.max(Math.ceil((s.height+s.y)/t),1)*t,f=0,p=0;("negative"===r.allowNewOrigin&&s.x<0||"positive"===r.allowNewOrigin&&s.x>=0||"any"===r.allowNewOrigin)&&(f=Math.ceil(-s.x/e)*e,f+=i.left,h+=f),("negative"===r.allowNewOrigin&&s.y<0||"positive"===r.allowNewOrigin&&s.y>=0||"any"===r.allowNewOrigin)&&(p=Math.ceil(-s.y/t)*t,p+=i.top,d+=p),h+=i.right,d+=i.bottom,h=Math.max(h,r.minWidth||0),d=Math.max(d,r.minHeight||0),h=Math.min(h,r.maxWidth||Number.MAX_SAFE_INTEGER),d=Math.min(d,r.maxHeight||Number.MAX_SAFE_INTEGER);const g=this.getComputedSize(),m=h!==g.width||d!==g.height;return(f!==l.tx||p!==l.ty)&&this.translate(f,p),m&&this.resize(h,d),new Pm(-f/c,-p/u,h/c,d/u)}scaleContentToFit(e={}){this.scaleContentToFitImpl(e)}scaleContentToFitImpl(e={},t=!0){let n,r;if(e.contentArea){const t=e.contentArea;n=this.graph.localToGraph(t),r=Tm.create(t)}else n=this.getContentBBox(e),r=this.graph.graphToLocal(n);if(!n.width||!n.height)return;const i=kg(e.padding),o=e.minScale||0,s=e.maxScale||Number.MAX_SAFE_INTEGER,a=e.minScaleX||o,l=e.maxScaleX||s,c=e.minScaleY||o,u=e.maxScaleY||s;let h;if(e.viewportArea)h=e.viewportArea;else{const e=this.getComputedSize(),t=this.getTranslation();h={x:t.tx,y:t.ty,width:e.width,height:e.height}}h=Pm.create(h).moveAndExpand({x:i.left,y:i.top,width:-i.left-i.right,height:-i.top-i.bottom});const d=this.getScale();let f=h.width/n.width*d.sx,p=h.height/n.height*d.sy;!1!==e.preserveAspectRatio&&(f=p=Math.min(f,p));const g=e.scaleGrid;if(g&&(f=g*Math.floor(f/g),p=g*Math.floor(p/g)),f=il(f,a,l),p=il(p,c,u),this.scale(f,p),t){const e=this.options,t=h.x-r.x*f-e.x,n=h.y-r.y*p-e.y;this.translate(t,n)}}getContentArea(e={}){return e.useCellGeometry?this.model.getAllCellsBBox()||new Pm:Sv(this.graph.view.stage)}getContentBBox(e={}){return this.graph.localToGraph(this.getContentArea(e))}getGraphArea(){const e=Pm.fromSize(this.getComputedSize());return this.graph.graphToLocal(e)}zoomToRect(e,t={}){const n=Pm.create(e),r=this.graph;t.contentArea=n,null==t.viewportArea&&(t.viewportArea={x:r.options.x,y:r.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(t,!1);const i=n.getCenter();return this.centerPoint(i.x,i.y),this}zoomToFit(e={}){return this.zoomToRect(this.getContentArea(e),e)}centerPoint(e,t){const n=this.getComputedSize(),r=this.getScale(),i=this.getTranslation(),o=n.width/2,s=n.height/2;t="number"==typeof t?t:s,e=o-(e="number"==typeof e?e:o)*r.sx,t=s-t*r.sy,i.tx===e&&i.ty===t||this.translate(e,t)}centerContent(e){const t=this.graph.getContentArea(e).getCenter();this.centerPoint(t.x,t.y)}centerCell(e){return this.positionCell(e,"center")}positionPoint(e,t,n){const r=this.getComputedSize();(t=Og(t,Math.max(0,r.width)))<0&&(t=r.width+t),(n=Og(n,Math.max(0,r.height)))<0&&(n=r.height+n);const i=this.getTranslation(),o=this.getScale(),s=t-e.x*o.sx,a=n-e.y*o.sy;i.tx===s&&i.ty===a||this.translate(s,a)}positionRect(e,t){const n=Pm.create(e);switch(t){case"center":return this.positionPoint(n.getCenter(),"50%","50%");case"top":return this.positionPoint(n.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(n.getTopRight(),"100%",0);case"right":return this.positionPoint(n.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(n.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(n.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(n.getBottomLeft(),0,"100%");case"left":return this.positionPoint(n.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(n.getTopLeft(),0,0);default:return this}}positionCell(e,t){const n=e.getBBox();return this.positionRect(n,t)}positionContent(e,t){const n=this.graph.getContentArea(t);return this.positionRect(n,e)}dispose(){this.widgets.forEach((e=>e.dispose())),this.widgets.clear(),this.stopListening()}}zE([UE.dispose()],UE.prototype,"dispose",null);var VE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class HE extends UC{constructor(){super(...arguments),this.movedMap=new WeakMap,this.unselectMap=new WeakMap}get widgetOptions(){return this.options.selecting}get rubberbandDisabled(){return!0!==this.widgetOptions.enabled||!0!==this.widgetOptions.rubberband}get disabled(){return!0!==this.widgetOptions.enabled}get length(){return this.widget.length}get cells(){return this.widget.cells}init(){this.widget=this.graph.hook.createSelection(),this.startListening()}startListening(){this.graph.on("blank:mousedown",this.onBlankMouseDown,this),this.graph.on("blank:click",this.onBlankClick,this),this.graph.on("cell:mousemove",this.onCellMouseMove,this),this.graph.on("cell:mouseup",this.onCellMouseUp,this),this.widget.on("box:mousedown",this.onBoxMouseDown,this)}stopListening(){this.graph.off("blank:mousedown",this.onBlankMouseDown,this),this.graph.off("blank:click",this.onBlankClick,this),this.graph.off("cell:mousemove",this.onCellMouseMove,this),this.graph.off("cell:mouseup",this.onCellMouseUp,this),this.widget.off("box:mousedown",this.onBoxMouseDown,this)}onBlankMouseDown({e:e}){(this.allowRubberband(e,!0)||this.allowRubberband(e)&&!this.graph.scroller.allowPanning(e,!0)&&!this.graph.panning.allowPanning(e,!0))&&this.startRubberband(e)}onBlankClick(){this.clean()}allowRubberband(e,t){return!this.rubberbandDisabled&&PE.isMatch(e,this.widgetOptions.modifiers,t)&&this.graph.hook.allowRubberband(e)}onCellMouseMove({cell:e}){this.movedMap.set(e,!0)}onCellMouseUp({e:e,cell:t}){const n=this.widgetOptions;let r=this.disabled;!r&&this.movedMap.has(t)&&(r=!1===n.selectCellOnMoved,r||(r=!1===n.selectNodeOnMoved&&t.isNode()),r||(r=!1===n.selectEdgeOnMoved&&t.isEdge())),r||(!1===n.multiple||!e.ctrlKey&&!e.metaKey?this.reset(t):this.unselectMap.has(t)?this.unselectMap.delete(t):this.isSelected(t)?this.unselect(t):this.select(t)),this.movedMap.delete(t)}onBoxMouseDown({e:e,cell:t}){this.disabled||!1!==this.widgetOptions.multiple&&(e.ctrlKey||e.metaKey)&&(this.unselect(t),this.unselectMap.set(t,!0))}isEmpty(){return this.length<=0}isSelected(e){return this.widget.isSelected(e)}getCells(e){return(Array.isArray(e)?e:[e]).map((e=>"string"==typeof e?this.graph.getCellById(e):e)).filter((e=>null!=e))}select(e,t={}){const n=this.getCells(e);return n.length&&(this.isMultiple()?this.widget.select(n,t):this.reset(n.slice(0,1),t)),this}unselect(e,t={}){return this.widget.unselect(this.getCells(e),t),this}reset(e,t={}){return this.widget.reset(e?this.getCells(e):[],t),this}clean(e={}){return this.widget.clean(e),this}enable(){return this.disabled&&(this.widgetOptions.enabled=!0),this}disable(){return this.disabled||(this.widgetOptions.enabled=!1),this}startRubberband(e){return this.rubberbandDisabled||this.widget.startSelecting(e),this}enableRubberband(){return this.rubberbandDisabled&&(this.widgetOptions.rubberband=!0),this}disableRubberband(){return this.rubberbandDisabled||(this.widgetOptions.rubberband=!1),this}isMultiple(){return!1!==this.widgetOptions.multiple}enableMultiple(){return this.widgetOptions.multiple=!0,this}disableMultiple(){return this.widgetOptions.multiple=!1,this}setModifiers(e){return this.widgetOptions.modifiers=e,this}setContent(e){return this.widget.setContent(e),this}setFilter(e){return this.widget.setFilter(e),this}dispose(){this.stopListening(),this.widget.dispose()}}VE([UC.dispose()],HE.prototype,"dispose",null);var WE,$E=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},XE=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class YE extends nx{constructor(e){super(),this.batchCommands=null,this.batchLevel=0,this.lastBatchIndex=-1,this.freezed=!1,this.handlers=[],this.graph=e.graph,this.model=e.graph.model,this.options=WE.getOptions(e),this.validator=new YE.Validator({history:this,cancelInvalid:this.options.cancelInvalid}),this.clean(),this.startListening()}get disabled(){return!0!==this.options.enabled}enable(){this.disabled&&(this.options.enabled=!0)}disable(){this.disabled||(this.options.enabled=!1)}undo(e={}){if(!this.disabled){const t=this.undoStack.pop();t&&(this.revertCommand(t,e),this.redoStack.push(t),this.notify("undo",t,e))}return this}redo(e={}){if(!this.disabled){const t=this.redoStack.pop();t&&(this.applyCommand(t,e),this.undoStack.push(t),this.notify("redo",t,e))}return this}cancel(e={}){if(!this.disabled){const t=this.undoStack.pop();t&&(this.revertCommand(t,e),this.redoStack=[],this.notify("cancel",t,e))}return this}clean(e={}){return this.undoStack=[],this.redoStack=[],this.notify("clean",null,e),this}canUndo(){return!this.disabled&&this.undoStack.length>0}canRedo(){return!this.disabled&&this.redoStack.length>0}validate(e,...t){return this.validator.validate(e,...t),this}dispose(){this.validator.dispose(),this.clean(),this.stopListening()}startListening(){this.model.on("batch:start",this.initBatchCommand,this),this.model.on("batch:stop",this.storeBatchCommand,this),this.options.eventNames&&this.options.eventNames.forEach(((e,t)=>{this.handlers[t]=this.addCommand.bind(this,e),this.model.on(e,this.handlers[t])})),this.validator.on("invalid",(e=>this.trigger("invalid",e)))}stopListening(){this.model.off("batch:start",this.initBatchCommand,this),this.model.off("batch:stop",this.storeBatchCommand,this),this.options.eventNames&&(this.options.eventNames.forEach(((e,t)=>{this.model.off(e,this.handlers[t])})),this.handlers.length=0),this.validator.off("invalid")}createCommand(e){return{batch:!!e&&e.batch,data:{}}}revertCommand(e,t){this.freezed=!0;const n=Array.isArray(e)?WE.sortBatchCommands(e):[e];for(let e=n.length-1;e>=0;e-=1){const r=n[e],i=Object.assign(Object.assign({},t),Zd(r.options,this.options.revertOptionsList||[]));this.executeCommand(r,!0,i)}this.freezed=!1}applyCommand(e,t){this.freezed=!0;const n=Array.isArray(e)?WE.sortBatchCommands(e):[e];for(let e=0;e<n.length;e+=1){const r=n[e],i=Object.assign(Object.assign({},t),Zd(r.options,this.options.applyOptionsList||[]));this.executeCommand(r,!1,i)}this.freezed=!1}executeCommand(e,t,n){const r=this.model,i=r.getCell(e.data.id),o=e.event;if(WE.isAddEvent(o)&&t||WE.isRemoveEvent(o)&&!t)i.remove(n);else if(WE.isAddEvent(o)&&!t||WE.isRemoveEvent(o)&&t){const t=e.data;t.node?r.addNode(t.props,n):t.edge&&r.addEdge(t.props,n)}else if(WE.isChangeEvent(o)){const r=e.data,o=r.key;if(o){const e=t?r.prev[o]:r.next[o];i.prop(o,e,n)}}else{const r=this.options.executeCommand;r&&Tg(r,this,e,t,n)}}addCommand(e,t){if(this.freezed||this.disabled)return;const n=t,r=n.options||{};if(r.dryrun)return;if(WE.isAddEvent(e)&&this.options.ignoreAdd||WE.isRemoveEvent(e)&&this.options.ignoreRemove||WE.isChangeEvent(e)&&this.options.ignoreChange)return;const i=this.options.beforeAddCommand;if(null!=i&&!1===Tg(i,this,e,t))return;"cell:change:*"===e&&(e=`cell:change:${n.key}`);const o=n.cell,s=kC.isModel(o);let a;if(this.batchCommands){a=this.batchCommands[Math.max(this.lastBatchIndex,0)];const t=s&&!a.modelChange||a.data.id!==o.id,n=a.event!==e;if(this.lastBatchIndex>=0&&(t||n)){const t=this.batchCommands.findIndex((t=>(s&&t.modelChange||t.data.id===o.id)&&t.event===e));t<0||WE.isAddEvent(e)||WE.isRemoveEvent(e)?a=this.createCommand({batch:!0}):(a=this.batchCommands[t],this.batchCommands.splice(t,1)),this.batchCommands.push(a),this.lastBatchIndex=this.batchCommands.length-1}}else a=this.createCommand({batch:!1});if(WE.isAddEvent(e)||WE.isRemoveEvent(e)){const t=a.data;return a.event=e,a.options=r,t.id=o.id,t.props=tc(o.toJSON()),o.isEdge()?t.edge=!0:o.isNode()&&(t.node=!0),this.push(a,r)}if(WE.isChangeEvent(e)){const n=t.key,i=a.data;return a.batch&&a.event||(a.event=e,a.options=r,i.key=n,null==i.prev&&(i.prev={}),i.prev[n]=ec(o.previous(n)),s?a.modelChange=!0:i.id=o.id),null==i.next&&(i.next={}),i.next[n]=ec(o.prop(n)),this.push(a,r)}const l=this.options.afterAddCommand;l&&Tg(l,this,e,t,a),this.push(a,r)}initBatchCommand(e){this.freezed||(this.batchCommands?this.batchLevel+=1:(this.batchCommands=[this.createCommand({batch:!0})],this.batchLevel=0,this.lastBatchIndex=-1))}storeBatchCommand(e){if(!this.freezed)if(this.batchCommands&&this.batchLevel<=0){const t=this.filterBatchCommand(this.batchCommands);t.length>0&&(this.redoStack=[],this.undoStack.push(t),this.notify("add",t,e)),this.batchCommands=null,this.lastBatchIndex=-1,this.batchLevel=0}else this.batchCommands&&this.batchLevel>0&&(this.batchLevel-=1)}filterBatchCommand(e){let t=e.slice();const n=[];for(;t.length>0;){const e=t.shift(),r=e.event,i=e.data.id;if(null!=r&&(null!=i||e.modelChange)){if(WE.isAddEvent(r)){const e=t.findIndex((e=>WE.isRemoveEvent(e.event)&&e.data.id===i));if(e>=0){t=t.filter(((t,n)=>e<n||t.data.id!==i));continue}}else if(WE.isRemoveEvent(r)){const e=t.findIndex((e=>WE.isAddEvent(e.event)&&e.data.id===i));if(e>=0){t.splice(e,1);continue}}else if(WE.isChangeEvent(r)){const t=e.data;if(jh(t.prev,t.next))continue}n.push(e)}}return n}notify(e,t,n){const r=null==t?null:Array.isArray(t)?t:[t];this.emit(e,{cmds:r,options:n}),this.emit("change",{cmds:r,options:n})}push(e,t){this.redoStack=[],e.batch?(this.lastBatchIndex=Math.max(this.lastBatchIndex,0),this.emit("batch",{cmd:e,options:t})):(this.undoStack.push(e),this.notify("add",e,t))}}$E([nx.dispose()],YE.prototype,"dispose",null),function(e){class t extends nx{constructor(e){super(),this.map={},this.command=e.history,this.cancelInvalid=!1!==e.cancelInvalid,this.command.on("add",this.onCommandAdded,this)}onCommandAdded({cmds:e}){return Array.isArray(e)?e.every((e=>this.isValidCommand(e))):this.isValidCommand(e)}isValidCommand(e){if(e.options&&!1===e.options.validation)return!0;const t=e.event&&this.map[e.event]||[];let n=null;return t.forEach((t=>{let r=0;const i=o=>{const s=t[r];r+=1;try{if(!s)return void(n=o);s(o,e,i)}catch(o){i(o)}};i(n)})),!n||(this.cancelInvalid&&this.command.cancel(),this.emit("invalid",{err:n}),!1)}validate(e,...t){const n=Array.isArray(e)?e:e.split(/\s+/);return t.forEach((e=>{if("function"!=typeof e)throw new Error(`${n.join(" ")} requires callback functions.`)})),n.forEach((e=>{null==this.map[e]&&(this.map[e]=[]),this.map[e].push(t)})),this}dispose(){this.command.off("add",this.onCommandAdded,this)}}$E([nx.dispose()],t.prototype,"dispose",null),e.Validator=t}(YE||(YE={})),function(e){e.isAddEvent=function(e){return"cell:added"===e},e.isRemoveEvent=function(e){return"cell:removed"===e},e.isChangeEvent=function(e){return null!=e&&e.startsWith("cell:change:")},e.getOptions=function(t){const n=XE(t,["graph"]),r=["cell:added","cell:removed","cell:change:*"],i=["batch:start","batch:stop"],o=t.eventNames?t.eventNames.filter((t=>!(e.isChangeEvent(t)||r.includes(t)||i.includes(t)))):r;return Object.assign(Object.assign({},n),{eventNames:o,applyOptionsList:t.applyOptionsList||["propertyPath"],revertOptionsList:t.revertOptionsList||["propertyPath"]})},e.sortBatchCommands=function(t){const n=[];for(let r=0,i=t.length;r<i;r+=1){const i=t[r];let o=null;if(e.isAddEvent(i.event)){const e=i.data.id;for(let n=0;n<r;n+=1)if(t[n].data.id===e){o=n;break}}null!==o?n.splice(o,0,i):n.push(i)}return n}}(WE||(WE={}));var qE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class KE extends UC{get widgetOptions(){return this.options.minimap}init(){this.widget=this.graph.hook.createMiniMap()}dispose(){this.widget&&this.widget.dispose()}}qE([UC.dispose()],KE.prototype,"dispose",null);var ZE={exports:{}};!function(e){!function(t,n,r){if(t){for(var i,o={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},s={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},a={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},l={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},c=1;c<20;++c)o[111+c]="f"+c;for(c=0;c<=9;++c)o[c+96]=c.toString();m.prototype.bind=function(e,t,n){var r=this;return e=e instanceof Array?e:[e],r._bindMultiple.call(r,e,t,n),r},m.prototype.unbind=function(e,t){return this.bind.call(this,e,(function(){}),t)},m.prototype.trigger=function(e,t){var n=this;return n._directMap[e+":"+t]&&n._directMap[e+":"+t]({},e),n},m.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},m.prototype.stopCallback=function(e,t){if((" "+t.className+" ").indexOf(" mousetrap ")>-1)return!1;if(g(t,this.target))return!1;if("composedPath"in e&&"function"==typeof e.composedPath){var n=e.composedPath()[0];n!==e.target&&(t=n)}return"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},m.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},m.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(o[t]=e[t]);i=null},m.init=function(){var e=m(n);for(var t in e)"_"!==t.charAt(0)&&(m[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},m.init(),t.Mousetrap=m,e.exports&&(e.exports=m)}function u(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function h(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return o[e.which]?o[e.which]:s[e.which]?s[e.which]:String.fromCharCode(e.which).toLowerCase()}function d(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function f(e,t,n){return n||(n=function(){if(!i)for(var e in i={},o)e>95&&e<112||o.hasOwnProperty(e)&&(i[o[e]]=e);return i}()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function p(e,t){var n,r,i,o=[];for(n=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),i=0;i<n.length;++i)r=n[i],l[r]&&(r=l[r]),t&&"keypress"!=t&&a[r]&&(r=a[r],o.push("shift")),d(r)&&o.push(r);return{key:r,modifiers:o,action:t=f(r,o,t)}}function g(e,t){return null!==e&&e!==n&&(e===t||g(e.parentNode,t))}function m(e){var t=this;if(e=e||n,!(t instanceof m))return new m(e);t.target=e,t._callbacks={},t._directMap={};var r,i={},o=!1,s=!1,a=!1;function l(e){e=e||{};var t,n=!1;for(t in i)e[t]?n=!0:i[t]=0;n||(a=!1)}function c(e,n,r,o,s,a){var l,c,u,h,f=[],p=r.type;if(!t._callbacks[e])return[];for("keyup"==p&&d(e)&&(n=[e]),l=0;l<t._callbacks[e].length;++l)if(c=t._callbacks[e][l],(o||!c.seq||i[c.seq]==c.level)&&p==c.action&&("keypress"==p&&!r.metaKey&&!r.ctrlKey||(u=n,h=c.modifiers,u.sort().join(",")===h.sort().join(",")))){var g=!o&&c.combo==s,m=o&&c.seq==o&&c.level==a;(g||m)&&t._callbacks[e].splice(l,1),f.push(c)}return f}function f(e,n,r,i){t.stopCallback(n,n.target||n.srcElement,r,i)||!1===e(n,r)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(n),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(n))}function g(e){"number"!=typeof e.which&&(e.which=e.keyCode);var n=h(e);n&&("keyup"!=e.type||o!==n?t.handleKey(n,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e):o=!1)}function v(e,t,n,s){function c(t){return function(){a=t,++i[e],clearTimeout(r),r=setTimeout(l,1e3)}}function u(t){f(n,t,e),"keyup"!==s&&(o=h(t)),setTimeout(l,10)}i[e]=0;for(var d=0;d<t.length;++d){var g=d+1===t.length?u:c(s||p(t[d+1]).action);y(t[d],g,s,e,d)}}function y(e,n,r,i,o){t._directMap[e+":"+r]=n;var s,a=(e=e.replace(/\s+/g," ")).split(" ");a.length>1?v(e,a,n,r):(s=p(e,r),t._callbacks[s.key]=t._callbacks[s.key]||[],c(s.key,s.modifiers,{type:s.action},i,e,o),t._callbacks[s.key][i?"unshift":"push"]({callback:n,modifiers:s.modifiers,action:s.action,seq:i,level:o,combo:e}))}t._handleKey=function(e,t,n){var r,i=c(e,t,n),o={},u=0,h=!1;for(r=0;r<i.length;++r)i[r].seq&&(u=Math.max(u,i[r].level));for(r=0;r<i.length;++r)if(i[r].seq){if(i[r].level!=u)continue;h=!0,o[i[r].seq]=1,f(i[r].callback,n,i[r].combo,i[r].seq)}else h||f(i[r].callback,n,i[r].combo);var p="keypress"==n.type&&s;n.type!=a||d(e)||p||l(o),s=h&&"keydown"==n.type},t._bindMultiple=function(e,t,n){for(var r=0;r<e.length;++r)y(e[r],t,n)},u(e,"keypress",g),u(e,"keydown",g),u(e,"keyup",g)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)}(ZE);var JE=ZE.exports,QE=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class e_ extends ex{constructor(e){super(),this.options=e;const t=this.graph.scroller.widget;this.container=t?t.container:this.graph.container,e.global?this.target=document:(this.target=this.container,this.disabled||this.target.setAttribute("tabindex","-1"),this.graph.on("cell:mouseup",this.focus,this),this.graph.on("blank:mouseup",this.focus,this)),this.mousetrap=e_.createMousetrap(this)}get graph(){return this.options.graph}get disabled(){return!0!==this.options.enabled}enable(){this.disabled&&(this.options.enabled=!0,this.graph.options.keyboard.enabled=!0,this.target instanceof HTMLElement&&this.target.setAttribute("tabindex","-1"))}disable(){this.disabled||(this.options.enabled=!1,this.graph.options.keyboard.enabled=!1,this.target instanceof HTMLElement&&this.target.removeAttribute("tabindex"))}on(e,t,n){this.mousetrap.bind(this.getKeys(e),t,n)}off(e,t){this.mousetrap.unbind(this.getKeys(e),t)}focus(){this.target.focus({preventScroll:!0})}getKeys(e){return(Array.isArray(e)?e:[e]).map((e=>this.formatkey(e)))}formatkey(e){const t=e.toLowerCase().replace(/\s/g,"").replace("delete","del").replace("cmd","command"),n=this.options.format;return n?Tg(n,this.graph,t):t}isGraphEvent(e){const t=e.srcElement||e.target;return!!t&&(t===this.target||t===document.body||Qg(this.container,t))}isEnabledForEvent(e){const t=!this.disabled&&this.isGraphEvent(e);if(t){const t=e.target,n=t&&t.tagName.toLowerCase(),r=e.keyCode||e.which;if("input"===n&&(8===r||46===r))return!1;if(this.options.guard)return Tg(this.options.guard,this.graph,e)}return t}dispose(){this.mousetrap.reset()}}QE([ex.dispose()],e_.prototype,"dispose",null),function(e){e.createMousetrap=function(e){const t=new JE(e.target),n=t.stopCallback;return t.stopCallback=(r,i,o)=>!e.isEnabledForEvent(r)||!!n&&n.call(t,r,i,o),t}}(e_||(e_={}));var t_=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class n_ extends ex{constructor(e){super(),this.options=e,this.cumulatedFactor=1;const t=this.graph.scroller.widget;this.container=t?t.container:this.graph.container,this.target=this.options.global?document:this.container,this.mousewheelHandle=new Iv(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.options.enabled&&this.enable(!0)}get graph(){return this.options.graph}get disabled(){return!0!==this.options.enabled}enable(e){(this.disabled||e)&&(this.options.enabled=!0,this.graph.options.mousewheel.enabled=!0,this.mousewheelHandle.enable())}disable(){this.disabled||(this.options.enabled=!1,this.graph.options.mousewheel.enabled=!1,this.mousewheelHandle.disable())}allowMouseWheel(e){const t=e.originalEvent||e,n=this.options.guard;return(null==n||n.call(this.graph,t))&&PE.isMatch(t,this.options.modifiers)}onMouseWheel(e){const t=e.originalEvent||e,n=this.options.guard;if((null==n||n.call(this.graph,t))&&PE.isMatch(t,this.options.modifiers)){const t=this.options.factor||1.2;null==this.currentScale&&(this.startPos={x:e.clientX,y:e.clientY},this.currentScale=this.graph.scroller.widget?this.graph.scroller.widget.zoom():this.graph.transform.getScale().sx);e.deltaY<0?this.currentScale<.15?this.cumulatedFactor=(this.currentScale+.01)/this.currentScale:this.cumulatedFactor=Math.round(this.currentScale*t*20)/20/this.currentScale:this.currentScale<=.15?this.cumulatedFactor=(this.currentScale-.01)/this.currentScale:this.cumulatedFactor=Math.round(this.currentScale*(1/t)*20)/20/this.currentScale,this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale);const n=this.graph.scroller.widget,r=this.currentScale;let i=this.graph.transform.clampScale(r*this.cumulatedFactor);if(i=il(i,this.options.minScale||Number.MIN_SAFE_INTEGER,this.options.maxScale||Number.MAX_SAFE_INTEGER),i!==r)if(n)if(this.options.zoomAtMousePosition){const e=this.graph.coord.clientToLocalPoint(this.startPos);n.zoom(i,{absolute:!0,center:e.clone()})}else n.zoom(i,{absolute:!0});else if(this.options.zoomAtMousePosition){const e=this.graph.coord.clientToGraphPoint(this.startPos);this.graph.zoom(i,{absolute:!0,center:e.clone()})}else this.graph.zoom(i,{absolute:!0});this.currentScale=null,this.cumulatedFactor=1}}dispose(){this.disable()}}t_([ex.dispose()],n_.prototype,"dispose",null);var r_=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class i_ extends UC{show(e={}){const t=Object.assign(Object.assign({},i_.defaultOptions),e),n=this.createPrintPages(t);t.ready(n,(e=>this.showPrintWindow(e,t)),{sheetSize:this.getSheetSize(t)})}get className(){return this.view.prefixClassName("graph-print")}showPrintWindow(e,t){if(e){const n=fr(document.body),r=fr(this.view.container),i=this.view.prefixClassName("graph-printing");n.addClass(i);const o=r.children().detach();e.forEach((e=>{e.removeClass(`${this.className}-preview`).addClass(`${this.className}-ready`).appendTo(n)}));let s=!1;const a=()=>{s||(s=!0,n.removeClass(i),e.forEach((e=>e.remove())),r.append(o),fr(`#${this.styleSheetId}`).remove(),this.graph.trigger("after:print",t),fr(window).off("afterprint",a))};fr(window).one("afterprint",a),setTimeout(a,200),window.print()}}createPrintPage(e,t){this.graph.trigger("before:print",t);const n=fr("<div/>").addClass(this.className),r=fr("<div/>").addClass(this.view.prefixClassName("graph-print-inner")).css("position","relative");t.size&&n.addClass(`${this.className}-size-${t.size}`);const i=ev.create(this.view.svg).clone(),o=i.findOne(`.${this.view.prefixClassName("graph-svg-stage")}`);r.append(i.node);const s=this.getSheetSize(t),a=this.graph.transform.getGraphArea(),l=this.graph.transform.getScale(),c=this.graph.translate(),u=mv().translate(c.tx/l.sx,c.ty/l.sy),h=this.getPageInfo(a,e,s),d=h.scale,f=h.bbox;return r.css({left:0,top:0}),i.attr({width:f.width*d,height:f.height*d,style:"position:relative",viewBox:[f.x,f.y,f.width,f.height].join(" ")}),o.attr("transform",bv(u)),n.append(r),n.addClass(`${this.className}-preview`),{$page:n,sheetSize:s}}createPrintPages(e){let t;const n=this.getPrintArea(e),r=[];if(e.page){const i=this.getPageSize(n,e.page);this.getPageAreas(n,i).forEach((n=>{t=this.createPrintPage(n,e),r.push(t.$page)}))}else t=this.createPrintPage(n,e),r.push(t.$page);if(t){const n={width:t.sheetSize.cssWidth,height:t.sheetSize.cssHeight};this.updatePrintStyle(n,e)}return r}get styleSheetId(){return this.view.prefixClassName("graph-print-style")}updatePrintStyle(e,t){const n=Object.keys(e).reduce(((t,n)=>`${t} ${n}:${e[n]};`),""),r=kg(t.margin),i=t.marginUnit||"",o=t.sheetUnit||"",s=`\n      @media print {\n        .${this.className}.${this.className}-ready {\n          ${n}\n        }\n\n        @page {\n          margin:\n          ${[r.top+i,r.right+i,r.bottom+i,r.left+i].join(" ")};\n          size: ${t.sheet.width+o} ${t.sheet.height+o};\n\n        .${this.className}.${this.className}-preview {\n          ${n}\n        }\n      }`,a=this.styleSheetId,l=fr(`#${a}`);l.length?l.html(s):fr("head").append(`'<style type="text/css" id="${a}">${s}</style>'`)}getPrintArea(e){let t=e.area;if(!t){const n=kg(e.padding);t=this.graph.getContentArea().moveAndExpand({x:-n.left,y:-n.top,width:n.left+n.right,height:n.top+n.bottom})}return t}getPageSize(e,t){if("object"==typeof t){const n=t,r={width:n.width,height:n.height};return null==r.width&&(r.width=Math.ceil(e.width/(n.columns||1))),null==r.height&&(r.height=Math.ceil(e.height/(n.rows||1))),r}return{width:e.width,height:e.height}}getPageAreas(e,t){const n=[],r=t.width,i=t.height;for(let t=0,o=0;t<e.height&&o<200;t+=i,o+=1)for(let o=0,s=0;o<e.width&&s<200;o+=r,s+=1)n.push(new Pm(e.x+o,e.y+t,r,i));return n}getSheetSize(e){const t=e.sheet,n=kg(e.margin),r=e.marginUnit||"",i=e.sheetUnit||"",o=`calc(${t.width}${i} - ${n.left+n.right}${r})`,s=`calc(${t.height}${i} - ${n.top+n.bottom}${r})`,a=ym.measure(o,s);return{cssWidth:o,cssHeight:s,width:a.width,height:a.height}}getPageInfo(e,t,n){const r=new Pm(t.x-e.x,t.y-e.y,t.width,t.height),i=r.width/r.height,o=n.width/n.height;return{bbox:r,scale:o<i?n.width/r.width:n.height/r.height,fitHorizontal:o<i}}dispose(){}}r_([UC.dispose()],i_.prototype,"dispose",null),function(e){e.defaultOptions={page:!1,sheet:{width:210,height:297},sheetUnit:"mm",margin:.4,marginUnit:"in",padding:5,ready:(e,t)=>t(e)}}(i_||(i_={}));class o_ extends UC{toSVG(e,t={}){this.graph.trigger("before:export",t);const n=this.view.svg,r=ev.create(n).clone();let i=r.node;const o=r.findOne(`.${this.view.prefixClassName("graph-svg-stage")}`),s=t.viewBox||this.graph.graphToLocal(this.graph.getContentBBox()),a=t.preserveDimensions;if(a){const e="boolean"==typeof a?s:a;r.attr({width:e.width,height:e.height})}if(r.removeAttribute("style").attr("viewBox",[s.x,s.y,s.width,s.height].join(" ")),o.removeAttribute("transform"),!1!==t.copyStyles){const e=n.ownerDocument,t=Array.from(n.querySelectorAll("*")),r=Array.from(i.querySelectorAll("*")),o=e.styleSheets.length,s=[];for(let t=o-1;t>=0;t-=1)s[t]=e.styleSheets[t],e.styleSheets[t].disabled=!0;const a={};t.forEach(((e,t)=>{const n=window.getComputedStyle(e,null),r={};Object.keys(n).forEach((e=>{r[e]=n.getPropertyValue(e)})),a[t]=r})),o!==e.styleSheets.length&&s.forEach(((t,n)=>{e.styleSheets[n]=t}));for(let t=0;t<o;t+=1)e.styleSheets[t].disabled=!1;const l={};t.forEach(((e,t)=>{const n=window.getComputedStyle(e,null),r=a[t],i={};Object.keys(n).forEach((e=>{n.getPropertyValue(e)!==r[e]&&(i[e]=n.getPropertyValue(e))})),l[t]=i})),r.forEach(((e,t)=>{fr(e).css(l[t])}))}const l=t.stylesheet;if("string"==typeof l){const e=n.ownerDocument.implementation.createDocument(null,"xml",null).createCDATASection(l);r.prepend(ev.create("style",{type:"text/css"},[e]))}const c=()=>{const n=t.beforeSerialize;if("function"==typeof n){const e=Tg(n,this.graph,i);e instanceof SVGSVGElement&&(i=e)}const r=(new XMLSerializer).serializeToString(i).replace(/&nbsp;/g," ");this.graph.trigger("after:export",t),e(r)};if(t.serializeImages){const e=r.find("image").map((e=>new Promise((t=>{const n=e.attr("xlink:href")||e.attr("href");gm.imageToDataUri(n,((n,r)=>{!n&&r&&e.attr("xlink:href",r),t()}))}))));Promise.all(e).then(c)}else c()}toDataURL(e,t){let n=t.viewBox||this.graph.getContentBBox();const r=kg(t.padding);t.width&&t.height&&(r.left+r.right>=t.width&&(r.left=r.right=0),r.top+r.bottom>=t.height&&(r.top=r.bottom=0));const i=new Pm(-r.left,-r.top,r.left+r.right,r.top+r.bottom);if(t.width&&t.height){const e=n.width+r.left+r.right,o=n.height+r.top+r.bottom;i.scale(e/t.width,o/t.height)}n=Pm.create(n).moveAndExpand(i);const o="number"==typeof t.width&&"number"==typeof t.height?{width:t.width,height:t.height}:n;let s=t.ratio?parseFloat(t.ratio):1;Number.isFinite(s)&&0!==s||(s=1);const a={width:Math.max(Math.round(o.width*s),1),height:Math.max(Math.round(o.height*s),1)};{const e=document.createElement("canvas"),t=e.getContext("2d");e.width=a.width,e.height=a.height;const n=a.width-1,r=a.height-1;t.fillStyle="rgb(1,1,1)",t.fillRect(n,r,1,1);const i=t.getImageData(n,r,1,1).data;if(1!==i[0]||1!==i[1]||1!==i[2])throw new Error("size exceeded")}const l=new Image;l.onload=()=>{const n=document.createElement("canvas");n.width=a.width,n.height=a.height;const r=n.getContext("2d");r.fillStyle=t.backgroundColor||"white",r.fillRect(0,0,a.width,a.height);try{r.drawImage(l,0,0,a.width,a.height);const i=n.toDataURL(t.type,t.quality);e(i)}catch(e){}},this.toSVG((e=>{l.src=`data:image/svg+xml,${encodeURIComponent(e)}`}),Object.assign(Object.assign({},t),{viewBox:n,serializeImages:!0,preserveDimensions:Object.assign({},a)}))}toPNG(e,t={}){this.toDataURL(e,Object.assign(Object.assign({},t),{type:"image/png"}))}toJPEG(e,t={}){this.toDataURL(e,Object.assign(Object.assign({},t),{type:"image/jpeg"}))}}class s_ extends UC{constructor(){super(...arguments),this.widgets=new Map}get isSelectionEnabled(){return!0===this.options.selecting.enabled}init(){this.startListening()}startListening(){this.graph.on("node:mouseup",this.onNodeMouseUp,this),this.graph.on("node:selected",this.onNodeSelected,this),this.graph.on("node:unselected",this.onNodeUnSelected,this)}stopListening(){this.graph.off("node:mouseup",this.onNodeMouseUp,this),this.graph.off("node:selected",this.onNodeSelected,this),this.graph.off("node:unselected",this.onNodeUnSelected,this)}onNodeMouseUp({node:e}){if(!this.isSelectionEnabled){const t=this.graph.hook.createKnob(e,{clearAll:!0});t&&this.widgets.set(e,t)}}onNodeSelected({node:e}){if(this.isSelectionEnabled){const t=this.graph.hook.createKnob(e,{clearAll:!1});t&&this.widgets.set(e,t)}}onNodeUnSelected({node:e}){if(this.isSelectionEnabled){const t=this.widgets.get(e);t&&t.forEach((e=>e.dispose())),this.widgets.delete(e)}}}var a_=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class l_ extends UC{get widgetOptions(){return this.options.panning}get pannable(){return this.widgetOptions&&!0===this.widgetOptions.enabled}init(){this.startListening(),this.updateClassName()}startListening(){const e=this.widgetOptions.eventTypes;e&&(e.includes("leftMouseDown")&&(this.graph.on("blank:mousedown",this.preparePanning,this),this.graph.on("node:unhandled:mousedown",this.preparePanning,this),this.graph.on("edge:unhandled:mousedown",this.preparePanning,this)),e.includes("rightMouseDown")&&(this.onRightMouseDown=this.onRightMouseDown.bind(this),this.view.$(this.graph.container).on("mousedown",this.onRightMouseDown)),e.includes("mouseWheel")&&(this.mousewheelHandle=new Iv(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable()))}stopListening(){const e=this.widgetOptions.eventTypes;e&&(e.includes("leftMouseDown")&&(this.graph.off("blank:mousedown",this.preparePanning,this),this.graph.off("node:unhandled:mousedown",this.preparePanning,this),this.graph.off("edge:unhandled:mousedown",this.preparePanning,this)),e.includes("rightMouseDown")&&this.view.$(this.graph.container).off("mousedown",this.onRightMouseDown),e.includes("mouseWheel")&&this.mousewheelHandle&&this.mousewheelHandle.disable())}preparePanning({e:e}){(this.allowPanning(e,!0)||this.allowPanning(e)&&!this.graph.selection.allowRubberband(e,!0))&&this.startPanning(e)}allowPanning(e,t){return this.pannable&&PE.isMatch(e,this.widgetOptions.modifiers,t)&&this.graph.hook.allowPanning(e)}startPanning(e){const t=this.view.normalizeEvent(e);this.clientX=t.clientX,this.clientY=t.clientY,this.panning=!0,this.updateClassName(),this.view.$(document.body).on({"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this)}),this.view.$(window).on("mouseup.panning",this.stopPanning.bind(this))}pan(e){const t=this.view.normalizeEvent(e),n=t.clientX-this.clientX,r=t.clientY-this.clientY;this.clientX=t.clientX,this.clientY=t.clientY,this.graph.translateBy(n,r)}stopPanning(e){this.panning=!1,this.updateClassName(),this.view.$(document.body).off(".panning"),this.view.$(window).off(".panning")}updateClassName(){const e=this.view.container,t=this.view.prefixClassName("graph-panning"),n=this.view.prefixClassName("graph-pannable");this.pannable?this.panning?(Fg(e,t),Gg(e,n)):(Gg(e,t),Fg(e,n)):(Gg(e,t),Gg(e,n))}onRightMouseDown(e){2===e.button&&this.allowPanning(e,!0)&&this.startPanning(e)}allowMouseWheel(e){return this.pannable&&!e.ctrlKey}onMouseWheel(e,t,n){e.ctrlKey||this.graph.translateBy(-t,-n)}autoPanning(e,t){const n=10,r=this.graph.getGraphArea();let i=0,o=0;e<=r.left+n&&(i=-10),t<=r.top+n&&(o=-10),e>=r.right-n&&(i=n),t>=r.bottom-n&&(o=n),0===i&&0===o||this.graph.translateBy(-i,-o)}enablePanning(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName())}dispose(){this.stopListening()}}a_([UC.dispose()],l_.prototype,"dispose",null);var c_=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class u_ extends UC{hasScroller(){return null!=this.graph.scroller.widget}getContainer(){return this.hasScroller()?this.graph.scroller.widget.container:this.graph.container}init(){const e=this.options.autoResize;if(e){const t="boolean"==typeof e?this.getContainer():e;Fv.bind(t,(()=>{const e=this.getContainer(),t=e.offsetWidth,n=e.offsetHeight;this.resize(t,n)}))}}resize(e,t){this.hasScroller()?this.resizeScroller(e,t):this.resizeGraph(e,t)}resizeGraph(e,t){this.graph.transform.resize(e,t)}resizeScroller(e,t){this.graph.scroller.resize(e,t)}resizePage(e,t){const n=this.graph.scroller.widget;n&&n.updatePageSize(e,t)}dispose(){Fv.clear(this.getContainer())}}c_([UC.dispose()],u_.prototype,"dispose",null);var h_,d_=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},f_=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};!function(e){e.hook=function(e,t){return(n,r,i)=>{const o=i.value,s=t||r;i.value=function(...t){const n=this.options[s];if(null!=n){this.getNativeValue=o.bind(this,...t);const r=Tg(n,this.graph,...t);if(this.getNativeValue=null,null!=r||!0===e&&null===r)return r}return o.call(this,...t)}}},e.after=function(e){return(t,n,r)=>{const i=r.value,o=e||n;r.value=function(...e){let t=i.call(this,...e);const n=this.options[o];return null!=n&&(t=Tg(n,this.graph,...e)&&t),t}}}}(h_||(h_={}));class p_ extends UC{createModel(){if(this.options.model)return this.options.model;const e=new kC;return e.graph=this.graph,e}createView(){return new WC(this.graph)}createRenderer(){return new uE(this.graph)}createDefsManager(){return new OE(this.graph)}createGridManager(){return new ME(this.graph)}createCoordManager(){return new TE(this.graph)}createKnobManager(){return new s_(this.graph)}createTransform(e,t){const n=this.getTransformOptions(e);return n.resizable||n.rotatable?new CE(Object.assign(Object.assign({node:e,graph:this.graph},n),t)):(n.clearAll&&CE.removeInstances(this.graph),null)}createKnob(e,t){const n=EE.parseOptionGroup(this.graph,e,this.options.knob),r=Object.assign(Object.assign({},n),t);r.clearAll&&tE.removeInstances(this.graph),r.clearAll=!1;const i=e.prop("knob"),o=[];return(Array.isArray(i)?i:[i]).forEach(((t,i)=>{t&&!1!==t.enabled&&("function"==typeof t.enabled&&!1===t.enabled.call(this.graph,e)||n.enabled&&o.push(new tE(Object.assign({node:e,index:i,graph:this.graph},r))))})),o}getTransformOptions(e){const t=EE.parseOptionGroup(this.graph,e,this.options.resizing),n=EE.parseOptionGroup(this.graph,e,this.options.rotating),r=EE.parseOptionGroup(this.graph,e,this.options.transforming);return Object.assign(Object.assign({},r),{resizable:t.enabled,minWidth:t.minWidth,maxWidth:t.maxWidth,minHeight:t.minHeight,maxHeight:t.maxHeight,orthogonalResizing:t.orthogonal,restrictedResizing:null!=t.restrict?t.restrict:t.restricted,autoScrollOnResizing:t.autoScroll,preserveAspectRatio:t.preserveAspectRatio,allowReverse:t.allowReverse,rotatable:n.enabled,rotateGrid:n.grid})}createTransformManager(){return new UE(this.graph)}createHighlightManager(){return new BE(this.graph)}createBackgroundManager(){return new dE(this.graph)}createClipboard(){return new b_}createClipboardManager(){return new FE(this.graph)}createSnapline(){return new lE(Object.assign({graph:this.graph},this.options.snapline))}createSnaplineManager(){return new NE(this.graph)}createSelection(){return new wE(Object.assign({graph:this.graph},this.options.selecting))}createSelectionManager(){return new HE(this.graph)}allowRubberband(e){return!0}createHistoryManager(){return new YE(Object.assign({graph:this.graph},this.options.history))}createScroller(){return this.options.scroller.enabled?new mE(Object.assign({graph:this.graph},this.options.scroller)):null}createScrollerManager(){return new IE(this.graph)}allowPanning(e){return!0}createMiniMap(){const e=this.options.minimap,{enabled:t}=e,n=f_(e,["enabled"]);return t?new oE(Object.assign({graph:this.graph},n)):null}createMiniMapManager(){return new KE(this.graph)}createKeyboard(){return new e_(Object.assign({graph:this.graph},this.options.keyboard))}createMouseWheel(){return new n_(Object.assign({graph:this.graph},this.options.mousewheel))}createPrintManager(){return new i_(this.graph)}createFormatManager(){return new o_(this.graph)}createPanningManager(){return new l_(this.graph)}createSizeManager(){return new u_(this.graph)}allowConnectToBlank(e){const t=this.options.connecting,n=null!=t.allowBlank?t.allowBlank:t.dangling;if("function"!=typeof n)return!!n;const r=this.graph.findViewByCell(e),i=e.getSourceCell(),o=e.getTargetCell(),s=this.graph.findViewByCell(i),a=this.graph.findViewByCell(o);return Tg(n,this.graph,{edge:e,edgeView:r,sourceCell:i,targetCell:o,sourceView:s,targetView:a,sourcePort:e.getSourcePortId(),targetPort:e.getTargetPortId(),sourceMagnet:r.sourceMagnet,targetMagnet:r.targetMagnet})}validateEdge(e,t,n){if(!this.allowConnectToBlank(e)){const t=e.getSourceCellId(),n=e.getTargetCellId();if(!t||!n)return!1}const r=this.options.connecting.validateEdge;return!r||Tg(r,this.graph,{edge:e,type:t,previous:n})}validateMagnet(e,t,n){if("passive"!==t.getAttribute("magnet")){const r=this.options.connecting.validateMagnet;return!r||Tg(r,this.graph,{e:n,magnet:t,view:e,cell:e.cell})}return!1}getDefaultEdge(e,t){let n;const r=this.options.connecting.createEdge;return r&&(n=Tg(r,this.graph,{sourceMagnet:t,sourceView:e,sourceCell:e.cell})),null==n&&(n=new FC),n}validateConnection(e,t,n,r,i,o,s){const a=this.options.connecting,l=a.allowLoop,c=a.allowNode,u=a.allowEdge,h=a.allowPort,d=null!=a.allowMulti?a.allowMulti:a.multi,f=a.validateConnection,p=o?o.cell:null,g="target"===i?n:e,m="target"===i?r:t;let v=!0;const y=a=>{const l="source"===i?s?s.port:null:p?p.getSourcePortId():null,c="target"===i?s?s.port:null:p?p.getTargetPortId():null;return Tg(a,this.graph,{edge:p,edgeView:o,sourceView:e,targetView:n,sourcePort:l,targetPort:c,sourceMagnet:t,targetMagnet:r,sourceCell:e?e.cell:null,targetCell:n?n.cell:null,type:i})};if(null!=l&&("boolean"==typeof l?l||e!==n||(v=!1):v=y(l)),v&&null!=h&&("boolean"==typeof h?!h&&m&&(v=!1):v=y(h)),v&&null!=u&&("boolean"==typeof u?!u&&EC.isEdgeView(g)&&(v=!1):v=y(u)),v&&null!=c&&("boolean"==typeof c?c||null==g||_C.isNodeView(g)&&null==m&&(v=!1):v=y(c)),v&&null!=d&&o){const e=o.cell,t="source"===i?s:e.getSource(),n="target"===i?s:e.getTarget(),r=s?this.graph.getCellById(s.cell):null;if(t&&n&&t.cell&&n.cell&&r)if("function"==typeof d)v=y(d);else{const e=this.model.getConnectedEdges(r,{outgoing:"source"===i,incoming:"target"===i});if(e.length)if("withPort"===d){const r=e.some((e=>{const r=e.getSource(),i=e.getTarget();return r&&i&&r.cell===t.cell&&i.cell===n.cell&&null!=r.port&&r.port===t.port&&null!=i.port&&i.port===n.port}));r&&(v=!1)}else if(!d){const r=e.some((e=>{const r=e.getSource(),i=e.getTarget();return r&&i&&r.cell===t.cell&&i.cell===n.cell}));r&&(v=!1)}}}return v&&null!=f&&(v=y(f)),v}getRestrictArea(e){const t=this.options.translating.restrict,n="function"==typeof t?Tg(t,this.graph,e):t;return"number"==typeof n?this.graph.transform.getGraphArea().inflate(n):!0===n?this.graph.transform.getGraphArea():n||null}onViewUpdated(e,t,n){t&uE.FLAG_INSERT||n.mounting||this.graph.renderer.requestConnectedEdgesUpdate(e,n)}onViewPostponed(e,t,n){return this.graph.renderer.forcePostponedViewUpdate(e,t)}getCellView(e){return null}createCellView(e){const t={graph:this.graph},n=this.getCellView(e);if(n)return new n(e,t);const r=e.view;if(null!=r&&"string"==typeof r){const n=_x.registry.get(r);return n?new n(e,t):_x.registry.onNotFound(r)}return e.isNode()?new _C(e,t):e.isEdge()?new EC(e,t):null}getHTMLComponent(e){let t=e.getHTML();return"string"==typeof t&&(t=GC.componentRegistry.get(t)||t),Ws(t)&&(t=t.render),"function"==typeof t?Tg(t,this.graph,e):t}shouldUpdateHTMLComponent(e){let t=e.getHTML();if("string"==typeof t&&(t=GC.componentRegistry.get(t)||t),Ws(t)){const n=t.shouldComponentUpdate;return"function"==typeof n?Tg(n,this.graph,e):!!n}return!1}onEdgeLabelRendered(e){}onPortRendered(e){}onToolItemCreated(e){}}d_([h_.hook()],p_.prototype,"createModel",null),d_([h_.hook()],p_.prototype,"createView",null),d_([h_.hook()],p_.prototype,"createRenderer",null),d_([h_.hook()],p_.prototype,"createDefsManager",null),d_([h_.hook()],p_.prototype,"createGridManager",null),d_([h_.hook()],p_.prototype,"createCoordManager",null),d_([h_.hook()],p_.prototype,"createKnobManager",null),d_([h_.hook()],p_.prototype,"createTransform",null),d_([h_.hook()],p_.prototype,"createKnob",null),d_([h_.hook()],p_.prototype,"createTransformManager",null),d_([h_.hook()],p_.prototype,"createHighlightManager",null),d_([h_.hook()],p_.prototype,"createBackgroundManager",null),d_([h_.hook()],p_.prototype,"createClipboard",null),d_([h_.hook()],p_.prototype,"createClipboardManager",null),d_([h_.hook()],p_.prototype,"createSnapline",null),d_([h_.hook()],p_.prototype,"createSnaplineManager",null),d_([h_.hook()],p_.prototype,"createSelection",null),d_([h_.hook()],p_.prototype,"createSelectionManager",null),d_([h_.hook()],p_.prototype,"allowRubberband",null),d_([h_.hook()],p_.prototype,"createHistoryManager",null),d_([h_.hook()],p_.prototype,"createScroller",null),d_([h_.hook()],p_.prototype,"createScrollerManager",null),d_([h_.hook()],p_.prototype,"allowPanning",null),d_([h_.hook()],p_.prototype,"createMiniMap",null),d_([h_.hook()],p_.prototype,"createMiniMapManager",null),d_([h_.hook()],p_.prototype,"createKeyboard",null),d_([h_.hook()],p_.prototype,"createMouseWheel",null),d_([h_.hook()],p_.prototype,"createPrintManager",null),d_([h_.hook()],p_.prototype,"createFormatManager",null),d_([h_.hook()],p_.prototype,"createPanningManager",null),d_([h_.hook()],p_.prototype,"createSizeManager",null),d_([h_.after()],p_.prototype,"onViewUpdated",null),d_([h_.after()],p_.prototype,"onViewPostponed",null),d_([h_.hook()],p_.prototype,"getCellView",null),d_([h_.hook(!0)],p_.prototype,"createCellView",null),d_([h_.hook()],p_.prototype,"getHTMLComponent",null),d_([h_.hook()],p_.prototype,"shouldUpdateHTMLComponent",null),d_([h_.hook()],p_.prototype,"onEdgeLabelRendered",null),d_([h_.hook()],p_.prototype,"onPortRendered",null),d_([h_.hook()],p_.prototype,"onToolItemCreated",null);var g_,m_,v_=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class y_ extends nx{constructor(e){super(),this.options=EE.get(e),this.css=new XC(this),this.hook=new p_(this),this.view=this.hook.createView(),this.defs=this.hook.createDefsManager(),this.coord=this.hook.createCoordManager(),this.transform=this.hook.createTransformManager(),this.knob=this.hook.createKnobManager(),this.highlight=this.hook.createHighlightManager(),this.grid=this.hook.createGridManager(),this.background=this.hook.createBackgroundManager(),this.model=this.hook.createModel(),this.renderer=this.hook.createRenderer(),this.clipboard=this.hook.createClipboardManager(),this.snapline=this.hook.createSnaplineManager(),this.selection=this.hook.createSelectionManager(),this.history=this.hook.createHistoryManager(),this.scroller=this.hook.createScrollerManager(),this.minimap=this.hook.createMiniMapManager(),this.keyboard=this.hook.createKeyboard(),this.mousewheel=this.hook.createMouseWheel(),this.print=this.hook.createPrintManager(),this.format=this.hook.createFormatManager(),this.panning=this.hook.createPanningManager(),this.size=this.hook.createSizeManager()}get container(){return this.view.container}get[Symbol.toStringTag](){return y_.toStringTag}isNode(e){return e.isNode()}isEdge(e){return e.isEdge()}resetCells(e,t={}){return this.model.resetCells(e,t),this}clearCells(e={}){return this.model.clear(e),this}toJSON(e={}){return this.model.toJSON(e)}parseJSON(e){return this.model.parseJSON(e)}fromJSON(e,t={}){return this.model.fromJSON(e,t),this}getCellById(e){return this.model.getCell(e)}addNode(e,t={}){return this.model.addNode(e,t)}addNodes(e,t={}){return this.addCell(e.map((e=>hC.isNode(e)?e:this.createNode(e))),t)}createNode(e){return this.model.createNode(e)}removeNode(e,t={}){return this.model.removeCell(e,t)}addEdge(e,t={}){return this.model.addEdge(e,t)}addEdges(e,t={}){return this.addCell(e.map((e=>wC.isEdge(e)?e:this.createEdge(e))),t)}removeEdge(e,t={}){return this.model.removeCell(e,t)}createEdge(e){return this.model.createEdge(e)}addCell(e,t={}){return this.model.addCell(e,t),this}removeCell(e,t={}){return this.model.removeCell(e,t)}removeCells(e,t={}){return this.model.removeCells(e,t)}removeConnectedEdges(e,t={}){return this.model.removeConnectedEdges(e,t)}disconnectConnectedEdges(e,t={}){return this.model.disconnectConnectedEdges(e,t),this}hasCell(e){return this.model.has(e)}getCell(e){return this.model.getCell(e)}getCells(){return this.model.getCells()}getCellCount(){return this.model.total()}getNodes(){return this.model.getNodes()}getEdges(){return this.model.getEdges()}getOutgoingEdges(e){return this.model.getOutgoingEdges(e)}getIncomingEdges(e){return this.model.getIncomingEdges(e)}getConnectedEdges(e,t={}){return this.model.getConnectedEdges(e,t)}getRootNodes(){return this.model.getRoots()}getLeafNodes(){return this.model.getLeafs()}isRootNode(e){return this.model.isRoot(e)}isLeafNode(e){return this.model.isLeaf(e)}getNeighbors(e,t={}){return this.model.getNeighbors(e,t)}isNeighbor(e,t,n={}){return this.model.isNeighbor(e,t,n)}getSuccessors(e,t={}){return this.model.getSuccessors(e,t)}isSuccessor(e,t,n={}){return this.model.isSuccessor(e,t,n)}getPredecessors(e,t={}){return this.model.getPredecessors(e,t)}isPredecessor(e,t,n={}){return this.model.isPredecessor(e,t,n)}getCommonAncestor(...e){return this.model.getCommonAncestor(...e)}getSubGraph(e,t={}){return this.model.getSubGraph(e,t)}cloneSubGraph(e,t={}){return this.model.cloneSubGraph(e,t)}cloneCells(e){return this.model.cloneCells(e)}getNodesFromPoint(e,t){return this.model.getNodesFromPoint(e,t)}getNodesInArea(e,t,n,r,i){return this.model.getNodesInArea(e,t,n,r,i)}getNodesUnderNode(e,t={}){return this.model.getNodesUnderNode(e,t)}searchCell(e,t,n={}){return this.model.search(e,t,n),this}getShortestPath(e,t,n={}){return this.model.getShortestPath(e,t,n)}getAllCellsBBox(){return this.model.getAllCellsBBox()}getCellsBBox(e,t={}){return this.model.getCellsBBox(e,t)}startBatch(e,t={}){this.model.startBatch(e,t)}stopBatch(e,t={}){this.model.stopBatch(e,t)}batchUpdate(e,t,n){const r="string"==typeof e?e:"update",i="string"==typeof e?t:e,o="function"==typeof t?n:t;this.startBatch(r,o);const s=i();return this.stopBatch(r,o),s}isFrozen(){return this.renderer.isFrozen()}freeze(e={}){return this.renderer.freeze(e),this}unfreeze(e={}){return this.renderer.unfreeze(e),this}isAsync(){return this.renderer.isAsync()}setAsync(e){return this.renderer.setAsync(e),this}findView(e){return lC.isCell(e)?this.findViewByCell(e):this.findViewByElem(e)}findViews(e){return Pm.isRectangleLike(e)?this.findViewsInArea(e):Tm.isPointLike(e)?this.findViewsFromPoint(e):[]}findViewByCell(e){return this.renderer.findViewByCell(e)}findViewByElem(e){return this.renderer.findViewByElem(e)}findViewsFromPoint(e,t){const n="number"==typeof e?{x:e,y:t}:e;return this.renderer.findViewsFromPoint(n)}findViewsInArea(e,t,n,r,i){const o="number"==typeof e?{x:e,y:t,width:n,height:r}:e,s="number"==typeof e?i:t;return this.renderer.findViewsInArea(o,s)}isViewMounted(e){return this.renderer.isViewMounted(e)}getMountedViews(){return this.renderer.getMountedViews()}getUnmountedViews(){return this.renderer.getUnmountedViews()}matrix(e){return void 0===e?this.transform.getMatrix():(this.transform.setMatrix(e),this)}resize(e,t){return this.size.resize(e,t),this}resizeGraph(e,t){return this.size.resizeGraph(e,t),this}resizeScroller(e,t){return this.size.resizeScroller(e,t),this}resizePage(e,t){return this.size.resizePage(e,t),this}scale(e,t=e,n=0,r=0){return void 0===e?this.transform.getScale():(this.transform.scale(e,t,n,r),this)}zoom(e,t){const n=this.scroller.widget;if(n){if(void 0===e)return n.zoom();n.zoom(e,t)}else{if(void 0===e)return this.transform.getZoom();this.transform.zoom(e,t)}return this}zoomTo(e,t={}){const n=this.scroller.widget;n?n.zoom(e,Object.assign(Object.assign({},t),{absolute:!0})):this.transform.zoom(e,Object.assign(Object.assign({},t),{absolute:!0}))}zoomToRect(e,t={}){const n=this.scroller.widget;return n?n.zoomToRect(e,t):this.transform.zoomToRect(e,t),this}zoomToFit(e={}){const t=this.scroller.widget;return t?t.zoomToFit(e):this.transform.zoomToFit(e),this}rotate(e,t,n){return void 0===e?this.transform.getRotation():(this.transform.rotate(e,t,n),this)}translate(e,t){return void 0===e?this.transform.getTranslation():(this.transform.translate(e,t),this)}translateBy(e,t){const n=this.translate(),r=n.tx+e,i=n.ty+t;return this.translate(r,i)}getArea(){return this.transform.getGraphArea()}getGraphArea(){return this.transform.getGraphArea()}getContentArea(e={}){return this.transform.getContentArea(e)}getContentBBox(e={}){return this.transform.getContentBBox(e)}fitToContent(e,t,n,r){return this.transform.fitToContent(e,t,n,r)}scaleContentToFit(e={}){return this.transform.scaleContentToFit(e),this}center(e){return this.centerPoint(e)}centerPoint(e,t,n){const r=this.scroller.widget;return r?r.centerPoint(e,t,n):this.transform.centerPoint(e,t),this}centerContent(e){const t=this.scroller.widget;return t?t.centerContent(e):this.transform.centerContent(e),this}centerCell(e,t){const n=this.scroller.widget;return n?n.centerCell(e,t):this.transform.centerCell(e),this}positionPoint(e,t,n,r={}){const i=this.scroller.widget;return i?i.positionPoint(e,t,n,r):this.transform.positionPoint(e,t,n),this}positionRect(e,t,n){const r=this.scroller.widget;return r?r.positionRect(e,t,n):this.transform.positionRect(e,t),this}positionCell(e,t,n){const r=this.scroller.widget;return r?r.positionCell(e,t,n):this.transform.positionCell(e,t),this}positionContent(e,t){const n=this.scroller.widget;return n?n.positionContent(e,t):this.transform.positionContent(e,t),this}getClientMatrix(){return this.coord.getClientMatrix()}getClientOffset(){return this.coord.getClientOffset()}getPageOffset(){return this.coord.getPageOffset()}snapToGrid(e,t){return this.coord.snapToGrid(e,t)}pageToLocal(e,t,n,r){return Pm.isRectangleLike(e)?this.coord.pageToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.pageToLocalRect(e,t,n,r):this.coord.pageToLocalPoint(e,t)}localToPage(e,t,n,r){return Pm.isRectangleLike(e)?this.coord.localToPageRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.localToPageRect(e,t,n,r):this.coord.localToPagePoint(e,t)}clientToLocal(e,t,n,r){return Pm.isRectangleLike(e)?this.coord.clientToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.clientToLocalRect(e,t,n,r):this.coord.clientToLocalPoint(e,t)}localToClient(e,t,n,r){return Pm.isRectangleLike(e)?this.coord.localToClientRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.localToClientRect(e,t,n,r):this.coord.localToClientPoint(e,t)}localToGraph(e,t,n,r){return Pm.isRectangleLike(e)?this.coord.localToGraphRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.localToGraphRect(e,t,n,r):this.coord.localToGraphPoint(e,t)}graphToLocal(e,t,n,r){return Pm.isRectangleLike(e)?this.coord.graphToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.graphToLocalRect(e,t,n,r):this.coord.graphToLocalPoint(e,t)}clientToGraph(e,t,n,r){return Pm.isRectangleLike(e)?this.coord.clientToGraphRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.clientToGraphRect(e,t,n,r):this.coord.clientToGraphPoint(e,t)}defineFilter(e){return this.defs.filter(e)}defineGradient(e){return this.defs.gradient(e)}defineMarker(e){return this.defs.marker(e)}getGridSize(){return this.grid.getGridSize()}setGridSize(e){return this.grid.setGridSize(e),this}showGrid(){return this.grid.show(),this}hideGrid(){return this.grid.hide(),this}clearGrid(){return this.grid.clear(),this}drawGrid(e){return this.grid.draw(e),this}updateBackground(){return this.background.update(),this}drawBackground(e,t){const n=this.scroller.widget;return null==n||null!=this.options.background&&t?this.background.draw(e):n.backgroundManager.draw(e),this}clearBackground(e){const t=this.scroller.widget;return null==t||null!=this.options.background&&e?this.background.clear():t.backgroundManager.clear(),this}isClipboardEnabled(){return!this.clipboard.disabled}enableClipboard(){return this.clipboard.enable(),this}disableClipboard(){return this.clipboard.disable(),this}toggleClipboard(e){return null!=e?e!==this.isClipboardEnabled()&&(e?this.enableClipboard():this.disableClipboard()):this.isClipboardEnabled()?this.disableClipboard():this.enableClipboard(),this}isClipboardEmpty(){return this.clipboard.isEmpty()}getCellsInClipboard(){return this.clipboard.cells}cleanClipboard(){return this.clipboard.clean(),this}copy(e,t={}){return this.clipboard.copy(e,t),this}cut(e,t={}){return this.clipboard.cut(e,t),this}paste(e={},t=this){return this.clipboard.paste(e,t)}isHistoryEnabled(){return!this.history.disabled}enableHistory(){return this.history.enable(),this}disableHistory(){return this.history.disable(),this}toggleHistory(e){return null!=e?e!==this.isHistoryEnabled()&&(e?this.enableHistory():this.disableHistory()):this.isHistoryEnabled()?this.disableHistory():this.enableHistory(),this}undo(e={}){return this.history.undo(e),this}undoAndCancel(e={}){return this.history.cancel(e),this}redo(e={}){return this.history.redo(e),this}canUndo(){return this.history.canUndo()}canRedo(){return this.history.canRedo()}cleanHistory(e={}){this.history.clean(e)}isKeyboardEnabled(){return!this.keyboard.disabled}enableKeyboard(){return this.keyboard.enable(),this}disableKeyboard(){return this.keyboard.disable(),this}toggleKeyboard(e){return null!=e?e!==this.isKeyboardEnabled()&&(e?this.enableKeyboard():this.disableKeyboard()):this.isKeyboardEnabled()?this.disableKeyboard():this.enableKeyboard(),this}bindKey(e,t,n){return this.keyboard.on(e,t,n),this}unbindKey(e,t){return this.keyboard.off(e,t),this}isMouseWheelEnabled(){return!this.mousewheel.disabled}enableMouseWheel(){return this.mousewheel.enable(),this}disableMouseWheel(){return this.mousewheel.disable(),this}toggleMouseWheel(e){return null==e?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():e?this.enableMouseWheel():this.disableMouseWheel(),this}isPannable(){return this.scroller.widget?this.scroller.pannable:this.panning.pannable}enablePanning(){return this.scroller.widget?this.scroller.enablePanning():this.panning.enablePanning(),this}disablePanning(){return this.scroller.widget?this.scroller.disablePanning():this.panning.disablePanning(),this}togglePanning(e){return null==e?this.isPannable()?this.disablePanning():this.enablePanning():e!==this.isPannable()&&(e?this.enablePanning():this.disablePanning()),this}lockScroller(){var e;null===(e=this.scroller.widget)||void 0===e||e.lock()}unlockScroller(){var e;null===(e=this.scroller.widget)||void 0===e||e.unlock()}updateScroller(){var e;null===(e=this.scroller.widget)||void 0===e||e.update()}getScrollbarPosition(){return this.scroller.widget.scrollbarPosition()}setScrollbarPosition(e,t,n){return this.scroller.widget.scrollbarPosition(e,t,n),this}scrollToPoint(e,t,n){return this.scroller.widget.scrollToPoint(e,t,n),this}scrollToContent(e){return this.scroller.widget.scrollToContent(e),this}scrollToCell(e,t){return this.scroller.widget.scrollToCell(e,t),this}transitionToPoint(e,t,n){return this.scroller.widget.transitionToPoint(e,t,n),this}transitionToRect(e,t={}){return this.scroller.widget.transitionToRect(e,t),this}isSelectionEnabled(){return!this.selection.disabled}enableSelection(){return this.selection.enable(),this}disableSelection(){return this.selection.disable(),this}toggleSelection(e){return null!=e?e!==this.isSelectionEnabled()&&(e?this.enableSelection():this.disableSelection()):this.isSelectionEnabled()?this.disableSelection():this.enableSelection(),this}isMultipleSelection(){return this.selection.isMultiple()}enableMultipleSelection(){return this.selection.enableMultiple(),this}disableMultipleSelection(){return this.selection.disableMultiple(),this}toggleMultipleSelection(e){return null!=e?e!==this.isMultipleSelection()&&(e?this.enableMultipleSelection():this.disableMultipleSelection()):this.isMultipleSelection()?this.disableMultipleSelection():this.enableMultipleSelection(),this}isSelectionMovable(){return!1!==this.selection.widget.options.movable}enableSelectionMovable(){return this.selection.widget.options.movable=!0,this}disableSelectionMovable(){return this.selection.widget.options.movable=!1,this}toggleSelectionMovable(e){return null!=e?e!==this.isSelectionMovable()&&(e?this.enableSelectionMovable():this.disableSelectionMovable()):this.isSelectionMovable()?this.disableSelectionMovable():this.enableSelectionMovable(),this}isRubberbandEnabled(){return!this.selection.rubberbandDisabled}enableRubberband(){return this.selection.enableRubberband(),this}disableRubberband(){return this.selection.disableRubberband(),this}toggleRubberband(e){return null!=e?e!==this.isRubberbandEnabled()&&(e?this.enableRubberband():this.disableRubberband()):this.isRubberbandEnabled()?this.disableRubberband():this.enableRubberband(),this}isStrictRubberband(){return!0===this.selection.widget.options.strict}enableStrictRubberband(){return this.selection.widget.options.strict=!0,this}disableStrictRubberband(){return this.selection.widget.options.strict=!1,this}toggleStrictRubberband(e){return null!=e?e!==this.isStrictRubberband()&&(e?this.enableStrictRubberband():this.disableStrictRubberband()):this.isStrictRubberband()?this.disableStrictRubberband():this.enableStrictRubberband(),this}setRubberbandModifiers(e){this.selection.setModifiers(e)}setSelectionFilter(e){return this.selection.setFilter(e),this}setSelectionDisplayContent(e){return this.selection.setContent(e),this}isSelectionEmpty(){return this.selection.isEmpty()}cleanSelection(e){return this.selection.clean(e),this}resetSelection(e,t){return this.selection.reset(e,t),this}getSelectedCells(){return this.selection.cells}getSelectedCellCount(){return this.selection.length}isSelected(e){return this.selection.isSelected(e)}select(e,t){return this.selection.select(e,t),this}unselect(e,t){return this.selection.unselect(e,t),this}isSnaplineEnabled(){return!this.snapline.widget.disabled}enableSnapline(){return this.snapline.widget.enable(),this}disableSnapline(){return this.snapline.widget.disable(),this}toggleSnapline(e){if(null==e)return this.isSnaplineEnabled()?this.disableSnapline():this.enableSnapline(),this;e!==this.isSnaplineEnabled()&&(e?this.enableSnapline():this.disableSnapline())}hideSnapline(){return this.snapline.widget.hide(),this}setSnaplineFilter(e){return this.snapline.widget.setFilter(e),this}isSnaplineOnResizingEnabled(){return!0===this.snapline.widget.options.resizing}enableSnaplineOnResizing(){return this.snapline.widget.options.resizing=!0,this}disableSnaplineOnResizing(){return this.snapline.widget.options.resizing=!1,this}toggleSnaplineOnResizing(e){return null!=e?e!==this.isSnaplineOnResizingEnabled()&&(e?this.enableSnaplineOnResizing():this.disableSnaplineOnResizing()):this.isSnaplineOnResizingEnabled()?this.disableSnaplineOnResizing():this.enableSnaplineOnResizing(),this}isSharpSnapline(){return!0===this.snapline.widget.options.sharp}enableSharpSnapline(){return this.snapline.widget.options.sharp=!0,this}disableSharpSnapline(){return this.snapline.widget.options.sharp=!1,this}toggleSharpSnapline(e){return null!=e?e!==this.isSharpSnapline()&&(e?this.enableSharpSnapline():this.disableSharpSnapline()):this.isSharpSnapline()?this.disableSharpSnapline():this.enableSharpSnapline(),this}getSnaplineTolerance(){return this.snapline.widget.options.tolerance}setSnaplineTolerance(e){return this.snapline.widget.options.tolerance=e,this}removeTools(){return this.emit("tools:remove"),this}hideTools(){return this.emit("tools:hide"),this}showTools(){return this.emit("tools:show"),this}toSVG(e,t={}){this.format.toSVG(e,t)}toDataURL(e,t){this.format.toDataURL(e,t)}toPNG(e,t={}){this.format.toPNG(e,t)}toJPEG(e,t={}){this.format.toJPEG(e,t)}printPreview(e){this.print.show(e)}dispose(){this.clearCells(),this.off(),this.css.dispose(),this.hook.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.knob.dispose(),this.highlight.dispose(),this.background.dispose(),this.clipboard.dispose(),this.snapline.dispose(),this.selection.dispose(),this.history.dispose(),this.keyboard.dispose(),this.mousewheel.dispose(),this.print.dispose(),this.format.dispose(),this.minimap.dispose(),this.panning.dispose(),this.scroller.dispose(),this.view.dispose(),this.renderer.dispose(),this.size.dispose()}}v_([VC.checkScroller()],y_.prototype,"lockScroller",null),v_([VC.checkScroller()],y_.prototype,"unlockScroller",null),v_([VC.checkScroller()],y_.prototype,"updateScroller",null),v_([VC.checkScroller()],y_.prototype,"getScrollbarPosition",null),v_([VC.checkScroller()],y_.prototype,"setScrollbarPosition",null),v_([VC.checkScroller()],y_.prototype,"scrollToPoint",null),v_([VC.checkScroller()],y_.prototype,"scrollToContent",null),v_([VC.checkScroller()],y_.prototype,"scrollToCell",null),v_([VC.checkScroller()],y_.prototype,"transitionToPoint",null),v_([VC.checkScroller()],y_.prototype,"transitionToRect",null),v_([nx.dispose()],y_.prototype,"dispose",null),function(e){e.View=WC,e.Hook=p_,e.Renderer=uE,e.Keyboard=e_,e.MouseWheel=n_,e.BaseManager=UC,e.DefsManager=OE,e.GridManager=ME,e.CoordManager=TE,e.PrintManager=i_,e.FormatManager=o_,e.MiniMapManager=KE,e.HistoryManager=YE,e.SnaplineManager=NE,e.ScrollerManager=IE,e.ClipboardManager=FE,e.TransformManager=UE,e.HighlightManager=BE,e.BackgroundManager=dE,e.SelectionManager=HE}(y_||(y_={})),function(e){e.toStringTag=`X6.${e.name}`,e.isGraph=function(t){if(null==t)return!1;if(t instanceof e)return!0;const n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&null!=r.hook&&null!=r.view&&null!=r.model}}(y_||(y_={})),function(e){e.render=function(t,n){const r=t instanceof HTMLElement?new e({container:t}):new e(t);return null!=n&&r.fromJSON(n),r}}(y_||(y_={})),function(e){e.registerNode=hC.registry.register,e.registerEdge=wC.registry.register,e.registerView=_x.registry.register,e.registerAttr=cb.registry.register,e.registerGrid=mb.registry.register,e.registerFilter=bb.registry.register,e.registerNodeTool=zx.registry.register,e.registerEdgeTool=Ux.registry.register,e.registerBackground=_b.registry.register,e.registerHighlighter=Ib.registry.register,e.registerPortLayout=Ub.registry.register,e.registerPortLabelLayout=Kb.registry.register,e.registerMarker=$y.registry.register,e.registerRouter=Hw.registry.register,e.registerConnector=Qw.registry.register,e.registerAnchor=iw.registry.register,e.registerEdgeAnchor=cw.registry.register,e.registerConnectionPoint=pw.registry.register,e.registerConnectionStrategy=vx.registry.register,e.registerHTMLComponent=GC.componentRegistry.register}(y_||(y_={})),function(e){e.unregisterNode=hC.registry.unregister,e.unregisterEdge=wC.registry.unregister,e.unregisterView=_x.registry.unregister,e.unregisterAttr=cb.registry.unregister,e.unregisterGrid=mb.registry.unregister,e.unregisterFilter=bb.registry.unregister,e.unregisterNodeTool=zx.registry.unregister,e.unregisterEdgeTool=Ux.registry.unregister,e.unregisterBackground=_b.registry.unregister,e.unregisterHighlighter=Ib.registry.unregister,e.unregisterPortLayout=Ub.registry.unregister,e.unregisterPortLabelLayout=Kb.registry.unregister,e.unregisterMarker=$y.registry.unregister,e.unregisterRouter=Hw.registry.unregister,e.unregisterConnector=Qw.registry.unregister,e.unregisterAnchor=iw.registry.unregister,e.unregisterEdgeAnchor=cw.registry.unregister,e.unregisterConnectionPoint=pw.registry.unregister,e.unregisterConnectionStrategy=vx.registry.unregister,e.unregisterHTMLComponent=GC.componentRegistry.unregister}(y_||(y_={}));class b_{constructor(){this.cells=[]}copy(e,t,n={}){this.options=Object.assign({},n);const r=(kC.isModel(t)?t:t.model).cloneSubGraph(e,n);this.cells=Nf(Object.keys(r).map((e=>r[e])),(e=>e.isEdge()?2:1)),this.serialize(n)}cut(e,t,n={}){this.copy(e,t,n);(y_.isGraph(t)?t.model:t).batchUpdate("cut",(()=>{e.forEach((e=>e.remove()))}))}paste(e,t={}){const n=Object.assign(Object.assign({},this.options),t),{offset:r,edgeProps:i,nodeProps:o}=n;let s=20,a=20;r&&(s="number"==typeof r?r:r.dx,a="number"==typeof r?r:r.dy),this.deserialize(n);const l=this.cells;l.forEach((e=>{e.model=null,e.removeProp("zIndex"),(s||a)&&e.translate(s,a),o&&e.isNode()&&e.prop(o),i&&e.isEdge()&&e.prop(i)}));const c=y_.isGraph(e)?e.model:e;return c.batchUpdate("paste",(()=>{c.addCells(this.cells)})),this.copy(l,e,t),l}serialize(e){!1!==e.useLocalStorage&&g_.save(this.cells)}deserialize(e){if(e.useLocalStorage){const e=g_.fetch();e&&(this.cells=e)}}isEmpty(){return this.cells.length<=0}clean(){this.options={},this.cells=[],g_.clean()}}!function(e){const t=`${Ob.prefixCls}.clipboard.cells`;e.save=function(e){if(window.localStorage){const n=e.map((e=>e.toJSON()));localStorage.setItem(t,JSON.stringify(n))}},e.fetch=function(){if(window.localStorage){const e=localStorage.getItem(t),n=e?JSON.parse(e):[];if(n)return kC.fromJSON(n)}},e.clean=function(){window.localStorage&&localStorage.removeItem(t)}}(g_||(g_={}));class x_{constructor(e){this.halo=e}get options(){return this.halo.options}get graph(){return this.halo.graph}get model(){return this.halo.model}get view(){return this.halo.view}get cell(){return this.halo.cell}get node(){return this.cell}getPresets(){return{className:"type-node",handles:[{name:"remove",position:"nw",events:{mousedown:this.removeCell.bind(this)},icon:null},{name:"resize",position:"se",events:{mousedown:this.startResize.bind(this),mousemove:this.doResize.bind(this),mouseup:this.stopResize.bind(this)},icon:null},{name:"clone",position:"n",events:{mousedown:this.startClone.bind(this),mousemove:this.doClone.bind(this),mouseup:this.stopClone.bind(this)},icon:null},{name:"link",position:"e",events:{mousedown:this.startLink.bind(this),mousemove:this.doLink.bind(this),mouseup:this.stopLink.bind(this)},icon:null},{name:"fork",position:"ne",events:{mousedown:this.startFork.bind(this),mousemove:this.doFork.bind(this),mouseup:this.stopFork.bind(this)},icon:null},{name:"unlink",position:"w",events:{mousedown:this.unlink.bind(this)},icon:null},{name:"rotate",position:"sw",events:{mousedown:this.startRotate.bind(this),mousemove:this.doRotate.bind(this),mouseup:this.stopRotate.bind(this)},icon:null}],bbox(e){if(this.options.useCellGeometry){return e.cell.getBBox()}return e.getBBox()},content(e){const t=op("x: <%= x %>, y: <%= y %>, width: <%= width %>, height: <%= height %>, angle: <%= angle %>"),n=e.cell,r=n.getBBox();return t({x:Math.floor(r.x),y:Math.floor(r.y),width:Math.floor(r.width),height:Math.floor(r.height),angle:Math.floor(n.getAngle())})},magnet:e=>e.container,tinyThreshold:40,smallThreshold:80,loopEdgePreferredSide:"top",loopEdgeWidth:40,rotateGrid:15,rotateEmbeds:!1}}removeCell(){this.model.removeConnectedEdges(this.cell),this.cell.remove()}startLink({x:e,y:t}){this.halo.startBatch();const n=this.graph,r=this.createEdgeConnectedToSource();r.setTarget({x:e,y:t}),this.model.addEdge(r,{validation:!1,halo:this.halo.cid,async:!1}),n.view.undelegateEvents(),this.edgeView=n.renderer.findViewByCell(r),this.edgeView.prepareArrowheadDragging("target",{x:e,y:t,fallbackAction:"remove"})}createEdgeConnectedToSource(){const e=this.getMagnet(this.view,"source"),t=this.getEdgeTerminal(this.view,e),n=this.graph.hook.getDefaultEdge(this.view,e);return n.setSource(t),n}getMagnet(e,t){const n=this.options.magnet;if("function"==typeof n){const r=Tg(n,this.halo,e,t);if(r instanceof SVGElement)return r}throw new Error("`magnet()` has to return an SVGElement")}getEdgeTerminal(e,t){const n={cell:e.cell.id};if(t!==e.container){const r=t.getAttribute("port");r?n.port=r:n.selector=e.getSelector(t)}return n}doLink({e:e,x:t,y:n}){this.edgeView&&this.edgeView.onMouseMove(e,t,n)}stopLink({e:e,x:t,y:n}){const r=this.edgeView;if(r){r.onMouseUp(e,t,n);const i=r.cell;i.hasLoop()&&this.makeLoopEdge(i),this.halo.stopBatch(),this.halo.trigger("action:edge:addde",{edge:i}),this.edgeView=null}this.graph.view.delegateEvents()}makeLoopEdge(e){let t=null,n=null;const r=this.options.loopEdgeWidth,i=this.graph.options,o=new Pm(0,0,i.width,i.height),s=this.graph.graphToLocal(this.view.getBBox()),a=[this.options.loopEdgePreferredSide,"top","bottom","left","right"].some((e=>{let i=null,a=0,l=0;switch(e){case"top":i=new Tm(s.x+s.width/2,s.y-r),a=r/2;break;case"bottom":i=new Tm(s.x+s.width/2,s.y+s.height+r),a=r/2;break;case"left":i=new Tm(s.x-r,s.y+s.height/2),l=r/2;break;case"right":i=new Tm(s.x+s.width+r,s.y+s.height/2),l=r/2}return!!i&&(t=i.translate(-a,-l),n=i.translate(a,l),o.containsPoint(t)&&o.containsPoint(n))}));a&&t&&n&&e.setVertices([t,n])}startResize({e:e}){this.halo.startBatch(),this.flip=[1,0,0,1,1,0,0,1][Math.floor(Cm.normalize(this.node.getAngle())/45)],this.view.addClass("node-resizing"),vE("node:resize",e,this.view)}doResize({e:e,dx:t,dy:n}){const r=this.node.getSize(),i=Math.max(r.width+(this.flip?t:n),1),o=Math.max(r.height+(this.flip?n:t),1);this.node.resize(i,o,{absolute:!0}),vE("node:resizing",e,this.view)}stopResize({e:e}){this.view.removeClass("node-resizing"),vE("node:resized",e,this.view),this.halo.stopBatch()}startClone({e:e,x:t,y:n}){this.halo.startBatch();const r=this.options.clone(this.cell,{clone:!0});if(!lC.isCell(r))throw new Error("option 'clone()' has to return a cell");this.centerNodeAtCursor(r,t,n),this.model.addCell(r,{halo:this.halo.cid,async:!1});const i=this.graph.renderer.findViewByCell(r);i.onMouseDown(e,t,n),this.halo.setEventData(e,{cloneView:i})}centerNodeAtCursor(e,t,n){const r=e.getBBox().getCenter(),i=t-r.x,o=n-r.y;e.translate(i,o)}doClone({e:e,x:t,y:n}){const r=this.halo.getEventData(e).cloneView;r&&r.onMouseMove(e,t,n)}stopClone({e:e,x:t,y:n}){const r=this.halo.getEventData(e).cloneView;r&&r.onMouseUp(e,t,n),this.halo.stopBatch()}startFork({e:e,x:t,y:n}){this.halo.startBatch();const r=this.options.clone(this.cell,{fork:!0});if(!lC.isCell(r))throw new Error("option 'clone()' has to return a cell");this.centerNodeAtCursor(r,t,n),this.model.addCell(r,{halo:this.halo.cid,async:!1});const i=this.createEdgeConnectedToSource(),o=this.graph.renderer.findViewByCell(r),s=this.getMagnet(o,"target"),a=this.getEdgeTerminal(o,s);i.setTarget(a),this.model.addEdge(i,{halo:this.halo.cid,async:!1}),o.onMouseDown(e,t,n),this.halo.setEventData(e,{cloneView:o})}doFork({e:e,x:t,y:n}){const r=this.halo.getEventData(e).cloneView;r&&r.onMouseMove(e,t,n)}stopFork({e:e,x:t,y:n}){const r=this.halo.getEventData(e).cloneView;r&&r.onMouseUp(e,t,n),this.halo.stopBatch()}startRotate({e:e,x:t,y:n}){this.halo.startBatch();const r=this.node.getBBox().getCenter(),i=[this.node];this.options.rotateEmbeds&&this.node.getDescendants({deep:!0}).reduce(((e,t)=>(t.isNode()&&e.push(t),e)),i),this.halo.setEventData(e,{center:r,nodes:i,rotateStartAngles:i.map((e=>e.getAngle())),clientStartAngle:new Tm(t,n).theta(r)}),i.forEach((t=>{const n=this.graph.findViewByCell(t);n&&(n.addClass("node-rotating"),vE("node:rotate",e,n))}))}doRotate({e:e,x:t,y:n}){const r=this.halo.getEventData(e),i=r.clientStartAngle-new Tm(t,n).theta(r.center);r.nodes.forEach(((t,n)=>{const o=r.rotateStartAngles[n],s=Ab.snapToGrid(o+i,this.options.rotateGrid);t.rotate(s,{absolute:!0,center:r.center,halo:this.halo.cid}),vE("node:rotating",e,this.graph.findViewByCell(t))}))}stopRotate({e:e}){this.halo.getEventData(e).nodes.forEach((t=>{const n=this.graph.findViewByCell(t);n.removeClass("node-rotating"),vE("node:rotated",e,n)})),this.halo.stopBatch()}unlink(){this.halo.startBatch(),this.model.removeConnectedEdges(this.cell),this.halo.stopBatch()}}class w_{constructor(e){this.halo=e}get options(){return this.halo.options}get graph(){return this.halo.graph}get model(){return this.halo.model}get view(){return this.halo.view}get cell(){return this.halo.cell}get edge(){return this.cell}getPresets(){return{className:"type-edge",handles:[{name:"remove",position:"nw",icon:null,events:{mousedown:this.removeEdge.bind(this)}},{name:"direction",position:"se",icon:null,events:{mousedown:this.directionSwap.bind(this)}}],content:!1,bbox:e=>e.graph.localToGraph(e.getPointAtRatio(.5)),tinyThreshold:-1,smallThreshold:-1}}removeEdge(){this.cell.remove()}directionSwap(){const e=this.edge.getSource(),t=this.edge.getTarget();this.edge.prop({source:t,target:e})}}class C_ extends eE{get type(){return this.options.type||"surround"}get handleOptions(){return this.options}init(e){this.options=rd(C_.defaultOptions,this.cell.isNode()?new x_(this).getPresets():this.cell.isEdge()?new w_(this).getPresets():null,e),this.render(),this.initHandles(),this.update(),this.startListening()}startListening(){const e=this.model,t=this.graph;this.view.cell.on("removed",this.remove,this),e.on("reseted",this.remove,this),t.on("halo:destroy",this.remove,this),e.on("*",this.update,this),t.on("scale",this.update,this),t.on("translate",this.update,this),super.startListening()}stopListening(){const e=this.model,t=this.graph,n=this.view.cell;this.undelegateEvents(),n.off("removed",this.remove,this),e.off("reseted",this.remove,this),t.off("halo:destroy",this.remove,this),e.off("*",this.update,this),t.off("scale",this.update,this),t.off("translate",this.update,this),super.stopListening()}render(){const e=this.options,t=this.prefixClassName("widget-halo");return this.view.addClass(m_.NODE_CLS),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(t).attr("data-shape",this.view.cell.shape),e.className&&this.$container.addClass(e.className),this.$handleContainer=this.$("<div/>").addClass(`${t}-handles`).appendTo(this.container),this.$content=this.$("<div/>").addClass(`${t}-content`).appendTo(this.container),this.$container.appendTo(this.graph.container),this}remove(){return this.stopBatch(),this.view.removeClass(m_.NODE_CLS),super.remove()}update(){if(this.isRendered()){this.updateContent();const e=this.getBBox(),t=this.options.tinyThreshold||0,n=this.options.smallThreshold||0;this.$handleContainer.toggleClass(`${this.handleClassName}-tiny`,e.width<t&&e.height<t);const r=`${this.handleClassName}-small`;this.$handleContainer.toggleClass(r,!this.$handleContainer.hasClass(r)&&e.width<n&&e.height<n),this.$container.css({width:e.width,height:e.height,left:e.x,top:e.y}),this.hasHandle("unlink")&&this.toggleUnlink(),"surround"!==this.type&&"toolbar"!==this.type||this.hasHandle("fork")&&this.toggleFork()}}updateContent(){const e=this.options.content;if("function"==typeof e){const t=Tg(e,this,this.view,this.$content[0]);t&&this.$content.html(t)}else e?this.$content.html(e):this.$content.remove()}getBBox(){const e=this.view,t=this.options.bbox,n="function"==typeof t?Tg(t,this,e):t;return Pm.create(Object.assign({x:0,y:0,width:1,height:1},n))}removeCell(){this.cell.remove()}toggleFork(){const e=this.view.cell.clone(),t=this.graph.hook.createCellView(e),n=this.graph.hook.validateConnection(this.view,null,t,null,"target");this.$handleContainer.children(".fork").toggleClass("hidden",!n),t.remove()}toggleUnlink(){const e=this.model.getConnectedEdges(this.view.cell).length>0;this.$handleContainer.children(".unlink").toggleClass("hidden",!e)}startBatch(){this.model.startBatch("halo",{halo:this.cid})}stopBatch(){this.model.hasActiveBatch("halo")&&this.model.stopBatch("halo",{halo:this.cid})}}!function(e){e.defaultOptions={type:"surround",clearAll:!0,clearOnBlankMouseDown:!0,useCellGeometry:!1,clone:e=>e.clone().removeZIndex()}}(C_||(C_={})),Object.getOwnPropertyNames(KC.prototype).forEach((e=>{"constructor"!==e&&Object.defineProperty(C_.prototype,e,Object.getOwnPropertyDescriptor(KC.prototype,e))})),function(e){e.NODE_CLS="has-widget-halo"}(m_||(m_={}));var E_,__,S_,O_,A_,k_=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class M_ extends dx{constructor(e){super(),this.options=Object.assign(Object.assign({},M_.defaults),e),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName("widget-dnd")),this.draggingGraph=new y_(Object.assign(Object.assign({},this.options.delegateGraphOptions),{container:document.createElement("div"),width:1,height:1})),this.$container.append(this.draggingGraph.container)}get targetScroller(){const e=this.options.target;return y_.isGraph(e)?e.scroller.widget:e}get targetGraph(){const e=this.options.target;return y_.isGraph(e)?e:e.graph}get targetModel(){return this.targetGraph.model}get snapline(){return this.targetGraph.snapline.widget}start(e,t){const n=t;n.preventDefault(),this.targetModel.startBatch("dnd"),this.$container.addClass("dragging").appendTo(this.options.containerParent||document.body),this.sourceNode=e,this.prepareDragging(e,n.clientX,n.clientY);const r=this.updateNodePosition(n.clientX,n.clientY);this.isSnaplineEnabled()&&(this.snapline.captureCursorOffset({e:n,node:e,cell:e,view:this.draggingView,x:r.x,y:r.y}),this.draggingNode.on("change:position",this.snap,this)),this.delegateDocumentEvents(M_.documentEvents,n.data)}isSnaplineEnabled(){return this.snapline&&!this.snapline.disabled}prepareDragging(e,t,n){const r=this.draggingGraph,i=r.model,o=this.options.getDragNode(e,{sourceNode:e,draggingGraph:r,targetGraph:this.targetGraph});o.position(0,0);let s=5;if(this.isSnaplineEnabled()&&(s+=this.snapline.options.tolerance||0),this.isSnaplineEnabled()||this.options.scaled){const e=this.targetGraph.transform.getScale();r.scale(e.sx,e.sy),s*=Math.max(e.sx,e.sy)}else r.scale(1,1);this.clearDragging(),this.options.animation&&this.$container.stop(!0,!0),i.resetCells([o]);const a=r.findViewByCell(o);a.undelegateEvents(),a.cell.off("changed"),r.fitToContent({padding:s,allowNewOrigin:"any"});const l=a.getBBox();this.geometryBBox=a.getBBox({useCellGeometry:!0}),this.delta=this.geometryBBox.getTopLeft().diff(l.getTopLeft()),this.draggingNode=o,this.draggingView=a,this.draggingBBox=o.getBBox(),this.padding=s,this.originOffset=this.updateGraphPosition(t,n)}updateGraphPosition(e,t){const n=document.body.scrollTop||document.documentElement.scrollTop,r=this.delta,i=this.geometryBBox,o=this.padding||5,s={left:e-r.x-i.width/2-o,top:t-r.y-i.height/2-o+n};return this.draggingGraph&&this.$container.offset(s),s}updateNodePosition(e,t){const n=this.targetGraph.clientToLocal(e,t),r=this.draggingBBox;return n.x-=r.width/2,n.y-=r.height/2,this.draggingNode.position(n.x,n.y),n}snap({cell:e,current:t,options:n}){const r=e;if(n.snapped){const e=this.draggingBBox;r.position(e.x+n.tx,e.y+n.ty,{silent:!0}),this.draggingView.translate(),r.position(t.x,t.y,{silent:!0}),this.snapOffset={x:n.tx,y:n.ty}}else this.snapOffset=null}onDragging(e){const t=this.draggingView;if(t){e.preventDefault();const n=this.normalizeEvent(e),r=n.clientX,i=n.clientY;this.updateGraphPosition(r,i);const o=this.updateNodePosition(r,i),s=this.targetGraph.options.embedding.enabled,a=(s||this.isSnaplineEnabled())&&this.isInsideValidArea({x:r,y:i});if(s){t.setEventData(n,{graph:this.targetGraph,candidateEmbedView:this.candidateEmbedView});const e=t.getEventData(n);a?t.processEmbedding(n,e):t.clearEmbedding(e),this.candidateEmbedView=e.candidateEmbedView}this.isSnaplineEnabled()&&(a?this.snapline.snapOnMoving({e:n,view:t,x:o.x,y:o.y}):this.snapline.hide())}}onDragEnd(e){const t=this.draggingNode;if(t){const n=this.normalizeEvent(e),r=this.draggingView,i=this.draggingBBox,o=this.snapOffset;let s=i.x,a=i.y;o&&(s+=o.x,a+=o.y),t.position(s,a,{silent:!0});const l=this.drop(t,{x:n.clientX,y:n.clientY}),c=e=>{e?(this.onDropped(t),this.targetGraph.options.embedding.enabled&&r&&(r.setEventData(n,{cell:e,graph:this.targetGraph,candidateEmbedView:this.candidateEmbedView}),r.finalizeEmbedding(n,r.getEventData(n)))):this.onDropInvalid(),this.candidateEmbedView=null,this.targetModel.stopBatch("dnd")};Pg(l)?(this.undelegateDocumentEvents(),l.then(c)):c(l)}}clearDragging(){this.draggingNode&&(this.sourceNode=null,this.draggingNode.remove(),this.draggingNode=null,this.draggingView=null,this.delta=null,this.padding=null,this.snapOffset=null,this.originOffset=null,this.undelegateDocumentEvents())}onDropped(e){this.draggingNode===e&&(this.clearDragging(),this.$container.removeClass("dragging").remove())}onDropInvalid(){const e=this.draggingNode;if(e){const t=this.options.animation;if(t){const n="object"==typeof t&&t.duration||150,r="object"==typeof t&&t.easing||"swing";this.draggingView=null,this.$container.animate(this.originOffset,n,r,(()=>this.onDropped(e)))}else this.onDropped(e)}}isInsideValidArea(e){let t;const n=this.targetGraph,r=this.targetScroller;if(r)if(r.options.autoResize)t=this.getDropArea(r.container);else{const e=this.getDropArea(r.container);t=this.getDropArea(n.container).intersectsWithRect(e)}else t=this.getDropArea(n.container);return t&&t.containsPoint(e)}getDropArea(e){const t=this.$(e),n=t.offset(),r=document.body.scrollTop||document.documentElement.scrollTop,i=document.body.scrollLeft||document.documentElement.scrollLeft;return Pm.create({x:n.left+parseInt(t.css("border-left-width"),10)-i,y:n.top+parseInt(t.css("border-top-width"),10)-r,width:t.innerWidth(),height:t.innerHeight()})}drop(e,t){if(this.isInsideValidArea(t)){const n=this.targetGraph,r=n.model,i=n.clientToLocal(t),o=this.sourceNode,s=this.options.getDropNode(e,{sourceNode:o,draggingNode:e,targetGraph:this.targetGraph,draggingGraph:this.draggingGraph}),a=s.getBBox();i.x+=a.x-a.width/2,i.y+=a.y-a.height/2;const l=this.snapOffset?1:n.getGridSize();s.position(Ab.snapToGrid(i.x,l),Ab.snapToGrid(i.y,l)),s.removeZIndex();const c=this.options.validateNode,u=!c||c(s,{sourceNode:o,draggingNode:e,droppingNode:s,targetGraph:n,draggingGraph:this.draggingGraph});return"boolean"==typeof u?u?(r.addCell(s,{stencil:this.cid}),s):null:function(...e){const t=Dg(e);return"boolean"==typeof t?Promise.resolve(t):t}(u).then((e=>e?(r.addCell(s,{stencil:this.cid}),s):null))}return null}onRemove(){this.draggingGraph&&(this.draggingGraph.view.remove(),this.draggingGraph.dispose())}dispose(){this.remove()}}k_([dx.dispose()],M_.prototype,"dispose",null),function(e){e.defaults={animation:!1,getDragNode:e=>e.clone(),getDropNode:e=>e.clone()},e.documentEvents={mousemove:"onDragging",touchmove:"onDragging",mouseup:"onDragEnd",touchend:"onDragEnd",touchcancel:"onDragEnd"}}(M_||(M_={})),function(e){e.getMaxDim=function(e,t){return e.reduce(((e,n)=>Math.max(n.getSize()[t],e)),0)},e.getNodesInRow=function(e,t,n){const r=[];for(let i=n*t,o=i+n;i<o;i+=1)r.push(e[i]);return r},e.getNodesInColumn=function(e,t,n){const r=[];for(let i=t,o=e.length;i<o;i+=n)r.push(e[i]);return r},e.accumulate=function(e,t){return e.reduce(((e,t,n)=>(e.push(e[n]+t),e)),[t||0])}}(E_||(E_={}));class T_ extends dx{constructor(e){if(super(),this.graphs={},this.$groups={},this.options=Object.assign(Object.assign({},T_.defaultOptions),e),this.dnd=new M_(this.options),this.onSearch=Wc(this.onSearch,200),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName(__.base)).attr("data-not-found-text",this.options.notFoundText||"No matches found"),this.options.collapsable=e.collapsable&&e.groups&&e.groups.some((e=>!1!==e.collapsable)),this.options.collapsable){this.$container.addClass("collapsable");e.groups&&e.groups.every((e=>e.collapsed||!1===e.collapsable))&&this.$container.addClass("collapsed")}this.$("<div/>").addClass(this.prefixClassName(__.title)).html(this.options.title).appendTo(this.$container),e.search&&this.$container.addClass("searchable").append(this.renderSearch()),this.$content=this.$("<div/>").addClass(this.prefixClassName(__.content)).appendTo(this.$container);const t=e.stencilGraphOptions||{};if(e.groups&&e.groups.length)e.groups.forEach((n=>{const r=this.$("<div/>").addClass(this.prefixClassName(__.group)).attr("data-name",n.name);(null==n.collapsable&&e.collapsable||!1!==n.collapsable)&&r.addClass("collapsable"),r.toggleClass("collapsed",!0===n.collapsed);const i=this.$("<h3/>").addClass(this.prefixClassName(__.groupTitle)).html(n.title||n.name),o=this.$("<div/>").addClass(this.prefixClassName(__.groupContent)),s=n.graphOptions,a=new y_(Object.assign(Object.assign(Object.assign({},t),s),{container:document.createElement("div"),model:t.model||new kC,width:n.graphWidth||e.stencilGraphWidth,height:n.graphHeight||e.stencilGraphHeight,interacting:!1,preventDefaultBlankAction:!1}));o.append(a.container),r.append(i,o).appendTo(this.$content),this.$groups[n.name]=r,this.graphs[n.name]=a}));else{const n=new y_(Object.assign(Object.assign({},t),{container:document.createElement("div"),model:t.model||new kC,width:e.stencilGraphWidth,height:e.stencilGraphHeight,interacting:!1,preventDefaultBlankAction:!1}));this.$content.append(n.container),this.graphs[S_.defaultGroupName]=n}return this.startListening(),this}get targetScroller(){const e=this.options.target;return y_.isGraph(e)?e.scroller.widget:e}get targetGraph(){const e=this.options.target;return y_.isGraph(e)?e:e.graph}get targetModel(){return this.targetGraph.model}renderSearch(){return this.$("<div/>").addClass(this.prefixClassName(__.search)).append(this.$("<input/>").attr({type:"search",placeholder:this.options.placeholder||"Search"}).addClass(this.prefixClassName(__.searchText)))}startListening(){const e=this.prefixClassName(__.title),t=this.prefixClassName(__.searchText),n=this.prefixClassName(__.groupTitle);this.delegateEvents({[`click .${e}`]:"onTitleClick",[`touchstart .${e}`]:"onTitleClick",[`click .${n}`]:"onGroupTitleClick",[`touchstart .${n}`]:"onGroupTitleClick",[`input .${t}`]:"onSearch",[`focusin .${t}`]:"onSearchFocusIn",[`focusout .${t}`]:"onSearchFocusOut"}),Object.keys(this.graphs).forEach((e=>{this.graphs[e].on("cell:mousedown",this.onDragStart,this)}))}stopListening(){this.undelegateEvents(),Object.keys(this.graphs).forEach((e=>{this.graphs[e].off("cell:mousedown",this.onDragStart,this)}))}load(e,t){return Array.isArray(e)?this.loadGroup(e,t):this.options.groups&&Object.keys(this.options.groups).forEach((t=>{e[t]&&this.loadGroup(e[t],t)})),this}loadGroup(e,t){const n=this.getModel(t);if(n){const t=e.map((e=>hC.isNode(e)?e:hC.create(e)));n.resetCells(t)}const r=this.getGroup(t);let i=this.options.stencilGraphHeight;r&&null!=r.graphHeight&&(i=r.graphHeight);const o=r&&r.layout||this.options.layout;if(o&&n&&Tg(o,this,n,r),!i){const e=this.getGraph(t);e.fitToContent({minWidth:e.options.width,gridHeight:1,padding:r&&r.graphPadding||this.options.stencilGraphPadding||10})}return this}onDragStart(e){const{e:t,node:n}=e;this.dnd.start(n,t)}filter(e,t){const n=Object.keys(this.graphs).reduce(((n,r)=>{const i=this.graphs[r],o=r===S_.defaultGroupName?null:r,s=i.model.getNodes().filter((n=>{let r=!1;r="function"==typeof t?Tg(t,this,n,e,o,this):"boolean"==typeof t?t:this.isCellMatched(n,e,t,e.toLowerCase()!==e);const s=i.renderer.findViewByCell(n);return s&&s.$(s.container).toggleClass("unmatched",!r),r})),a=s.length>0,l=this.options,c=new kC;return c.resetCells(s),l.layout&&Tg(l.layout,this,c,this.getGroup(r)),this.$groups[r]&&this.$groups[r].toggleClass("unmatched",!a),i.fitToContent({gridWidth:1,gridHeight:1,padding:l.stencilGraphPadding||10}),n||a}),!1);this.$container.toggleClass("not-found",!n)}isCellMatched(e,t,n,r){return!t||!n||Object.keys(n).some((i=>{if("*"===i||e.shape===i){const o=n[i];if("boolean"==typeof o)return o;return(Array.isArray(o)?o:[o]).some((n=>{let i=e.getPropByPath(n);return null!=i&&(i=`${i}`,r||(i=i.toLowerCase()),i.indexOf(t)>=0)}))}return!1}))}onSearch(e){this.filter(e.target.value,this.options.search)}onSearchFocusIn(){this.$container.addClass("is-focused")}onSearchFocusOut(){this.$container.removeClass("is-focused")}onTitleClick(){this.options.collapsable&&(this.$container.toggleClass("collapsed"),this.$container.hasClass("collapsed")?this.collapseGroups():this.expandGroups())}onGroupTitleClick(e){const t=this.$(e.target).closest(`.${this.prefixClassName(__.group)}`);this.toggleGroup(t.attr("data-name")||"");const n=Object.keys(this.$groups).every((e=>{const t=this.getGroup(e),n=this.$groups[e];return t&&!1===t.collapsable||n.hasClass("collapsed")}));this.$container.toggleClass("collapsed",n)}getModel(e){const t=this.getGraph(e);return t?t.model:null}getGraph(e){return this.graphs[e||S_.defaultGroupName]}getGroup(e){const t=this.options.groups;return null!=e&&t&&t.length?t.find((t=>t.name===e)):null}toggleGroup(e){return this.isGroupCollapsed(e)?this.expandGroup(e):this.collapseGroup(e),this}collapseGroup(e){if(this.isGroupCollapsable(e)){const t=this.$groups[e];t&&!this.isGroupCollapsed(e)&&(this.trigger("group:collapse",{name:e}),t.addClass("collapsed"))}return this}expandGroup(e){if(this.isGroupCollapsable(e)){const t=this.$groups[e];t&&this.isGroupCollapsed(e)&&(this.trigger("group:expand",{name:e}),t.removeClass("collapsed"))}return this}isGroupCollapsable(e){return this.$groups[e].hasClass("collapsable")}isGroupCollapsed(e){const t=this.$groups[e];return t&&t.hasClass("collapsed")}collapseGroups(){return Object.keys(this.$groups).forEach((e=>this.collapseGroup(e))),this}expandGroups(){return Object.keys(this.$groups).forEach((e=>this.expandGroup(e))),this}resizeGroup(e,t){const n=this.graphs[e];return n&&n.resize(t.width,t.height),this}onRemove(){Object.keys(this.graphs).forEach((e=>{this.graphs[e].view.remove(),delete this.graphs[e]})),this.dnd.remove(),this.stopListening(),this.undelegateDocumentEvents()}}function P_(e){return P_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P_(e)}function D_(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function N_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I_(e,t,n){return t&&R_(e.prototype,t),n&&R_(e,n),e}function j_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L_(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return j_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j_(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}!function(e){e.defaultOptions=Object.assign({stencilGraphWidth:200,stencilGraphHeight:800,title:"Stencil",collapsable:!1,placeholder:"Search",notFoundText:"No matches found",layout(e,t){const n={columnWidth:this.options.stencilGraphWidth/2-10,columns:2,rowHeight:80,resizeToFit:!1,dx:10,dy:10};!function(e,t={}){const n=kC.isModel(e)?e:(new kC).resetCells(e,{sort:!1,dryrun:!0}),r=n.getNodes(),i=t.columns||1,o=Math.ceil(r.length/i),s=t.dx||0,a=t.dy||0,l=!1!==t.center,c=!0===t.resizeToFit,u=t.marginX||0,h=t.marginY||0,d=[];let f=t.columnWidth;if("compact"===f)for(let e=0;e<i;e+=1){const t=E_.getNodesInColumn(r,e,i);d.push(E_.getMaxDim(t,"width")+s)}else{null!=f&&"auto"!==f||(f=E_.getMaxDim(r,"width")+s);for(let e=0;e<i;e+=1)d.push(f)}const p=E_.accumulate(d,u),g=[];let m=t.rowHeight;if("compact"===m)for(let e=0;e<o;e+=1){const t=E_.getNodesInRow(r,e,i);g.push(E_.getMaxDim(t,"height")+a)}else{null!=m&&"auto"!==m||(m=E_.getMaxDim(r,"height")+a);for(let e=0;e<o;e+=1)g.push(m)}const v=E_.accumulate(g,h);n.startBatch("layout"),r.forEach(((e,n)=>{const r=n%i,o=Math.floor(n/i),u=d[r],h=g[o];let f=0,m=0,y=e.getSize();if(c){let n=u-2*s,r=h-2*a;const i=y.height*(y.width?n/y.width:1),o=y.width*(y.height?r/y.height:1);h<i?n=o:r=i,y={width:n,height:r},e.setSize(y,t)}l&&(f=(u-y.width)/2,m=(h-y.height)/2),e.position(p[r]+s+f,v[o]+a+m,t)})),n.stopBatch("layout")}(e,Object.assign(Object.assign(Object.assign({},n),this.options.layoutOptions),t?t.layoutOptions:{}))}},M_.defaults)}(T_||(T_={})),function(e){e.base="widget-stencil",e.title=`${e.base}-title`,e.search=`${e.base}-search`,e.searchText=`${e.search}-text`,e.content=`${e.base}-content`,e.group=`${e.base}-group`,e.groupTitle=`${e.group}-title`,e.groupContent=`${e.group}-content`}(__||(__={})),function(e){e.defaultGroupName="__default__"}(S_||(S_={})),Ob.trackable&&setTimeout((function(){if(Ob.trackable){const e="https://kcart.alipay.com/web/bi.do",t=new Image,n=Object.assign(Object.assign({},Ob.trackInfo),{version:"1.28.1",pg:document.URL,r:(new Date).getTime(),x6:!0,page_type:"syslog"}),r=encodeURIComponent(JSON.stringify([n]));t.src=`${e}?BIProfile=merge&d=${r}`}}),3e3),function(e){function t(e){return{dispose:e}}e.is=function(e){return!!e&&"object"===P_(e)&&"dispose"in e&&"function"==typeof e.dispose},e.create=t,e.NONE=t((function(){}))}(O_||(O_={})),function(e){e.None=function(){return O_.NONE},e.map=function(e,t){return function(n,r){return e((function(e){return n.call(r,t(e))}),void 0)}}}(A_||(A_={}));var F_=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];N_(this,t),this.mono=void 0,this._callbacks=void 0,this.mono=e}return I_(t,[{key:"callbacks",get:function(){return this._callbacks||(this._callbacks=[]),this._callbacks}},{key:"length",get:function(){return this.callbacks.length}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.callbacks.push([e,t])}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!this.isEmpty()){for(var n=!1,r=0;r<this.length;r+=1)if(this.callbacks[r][0]===e){if(this.callbacks[r][1]===t)return void this.callbacks.splice(r,1);n=!0}if(n)throw new Error("You should remove it with the same context you add it")}}},{key:e,value:function(){return this.isEmpty()?[][Symbol.iterator]():this.callbacks.slice(0).map((function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e[0].apply(e[1],n)}}))[Symbol.iterator]()}},{key:"invoke",value:function(){var e,t=[],n=L_(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;try{t.push(r.apply(void 0,arguments))}catch(e){console.error(e)}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"isEmpty",value:function(){return 0===this.callbacks.length}},{key:"dispose",value:function(){this._callbacks=void 0}}]),t}(Symbol.iterator),G_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};N_(this,e),this.options=void 0,this._event=void 0,this._callbacks=void 0,this.disposed=!1,this.options=t}var t;return I_(e,[{key:"callbacks",get:function(){return this._callbacks||(this._callbacks=new F_),this._callbacks}},{key:"event",get:function(){var t=this;return this._event||(this._event=function(n,r){t.options.onFirstListenerAdd&&t.callbacks.isEmpty()&&t.options.onFirstListenerAdd(t),t.callbacks.add(n,r);var i={dispose:function(){i.dispose=e.noop,t.disposed||(t.callbacks.remove(n,r),i.dispose=e.noop,t.options.onLastListenerRemove&&t.callbacks.isEmpty()&&t.options.onLastListenerRemove(t))}};return i}),this._event}},{key:"fire",value:function(e){this._callbacks&&this.callbacks.invoke(e)}},{key:"sequence",value:(t=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){D_(o,r,i,s,a,"next",e)}function a(e){D_(o,r,i,s,a,"throw",e)}s(void 0)}))}}(regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=L_(this.callbacks),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=12;break}return i=r.value,e.next=7,t(i);case 7:if(e.sent){e.next=10;break}return e.abrupt("break",12);case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),n.e(e.t0);case 17:return e.prev=17,n.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[1,14,17,20]])}))),function(e){return t.apply(this,arguments)})},{key:"dispose",value:function(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0),this.disposed=!0}}]),e}();G_.noop=function(){};var B_,z_=Object.freeze(Object.assign((function(e,t){var n=setTimeout(e.bind(t),0);return{dispose:function(){clearTimeout(n)}}}),{maxListeners:0}));!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:A_.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:z_})}(B_||(B_={}));var U_=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};e.Disposable=void 0,function(e){function t(e){return{dispose:e}}e.is=function(e){return!!e&&"object"==typeof e&&"dispose"in e&&"function"==typeof e.dispose},e.create=t,e.NULL=t((()=>{}))}(e.Disposable||(e.Disposable={}));class V_{constructor(...e){this.disposables=[],this.onDisposeEmitter=new G_,this.disposingElements=!1,e.forEach((e=>this.push(e)))}get onDispose(){return this.onDisposeEmitter.event}checkDisposed(){this.disposed&&!this.disposingElements&&(this.onDisposeEmitter.fire(void 0),this.onDisposeEmitter.dispose())}get disposed(){return 0===this.disposables.length}dispose(){return U_(this,void 0,void 0,(function*(){if(!this.disposed&&!this.disposingElements){for(this.disposingElements=!0;!this.disposed;)try{const e=this.disposables.pop();yield e.dispose()}catch(e){console.error(e)}this.disposingElements=!1,this.checkDisposed()}}))}push(t){const{disposables:n}=this;n.push(t);const r=t.dispose.bind(t),i=e.Disposable.create((()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1),this.checkDisposed()}));return t.dispose=()=>{i.dispose(),r()},i}pushAll(e){return e.map((e=>this.push(e)))}}class H_{constructor(){this.isResolved=!1,this.isRejected=!1,this.promise=new Promise(((e,t)=>{this.resolve=(...t)=>{this.isResolved=!0,e(...t)},this.reject=(...e)=>{this.isRejected=!0,t(...e)}}))}}const W_="X6_NODE_PORTAL_NODE_VIEW",$_="xflow",X_=.01,Y_="XFLOW_DEFAULT_NODE",q_="XFLOW_DEFAULT_GROUP_NODE",K_="XFLOW_DEFAULT_EDGE",Z_="XFLOW_COPY_ITEMS",J_={width:180,height:36};var Q_=Object.freeze({__proto__:null,X6_NODE_PORTAL_NODE_VIEW:W_,XFLOW_PREFIX_CLS:$_,MIN_ZOOM:X_,MAX_ZOOM:1.5,XFLOW_DEFAULT_NODE:Y_,XFLOW_DEFAULT_GROUP_NODE:q_,XFLOW_DEFAULT_EDGE:K_,LOCAL_STORAGE_KEY:Z_,DEFAULT_NODE_HEIGHT:36,DEFAULT_NODE_WIDTH:180,XFLOW_GROUP_DEFAULT_COLLAPSED_SIZE:J_});function eS(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}var tS=t.createContext({});function nS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function iS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rS(Object(n),!0).forEach((function(t){nS(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rS(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return oS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oS(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function aS(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function lS(e){return lS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lS(e)}function cS(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function uS(e){return e<=1?100*Number(e)+"%":e}function hS(e){return 1===e.length?"0"+e:String(e)}function dS(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*n*(t-e):n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function fS(e){return pS(e)/255}function pS(e){return parseInt(e,16)}var gS={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function mS(e){var t={r:0,g:0,b:0},n=1,r=null,i=null,o=null,s=!1,a=!1;return"string"==typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(gS[e])e=gS[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var n=xS.rgb.exec(e);if(n)return{r:n[1],g:n[2],b:n[3]};if(n=xS.rgba.exec(e))return{r:n[1],g:n[2],b:n[3],a:n[4]};if(n=xS.hsl.exec(e))return{h:n[1],s:n[2],l:n[3]};if(n=xS.hsla.exec(e))return{h:n[1],s:n[2],l:n[3],a:n[4]};if(n=xS.hsv.exec(e))return{h:n[1],s:n[2],v:n[3]};if(n=xS.hsva.exec(e))return{h:n[1],s:n[2],v:n[3],a:n[4]};if(n=xS.hex8.exec(e))return{r:pS(n[1]),g:pS(n[2]),b:pS(n[3]),a:fS(n[4]),format:t?"name":"hex8"};if(n=xS.hex6.exec(e))return{r:pS(n[1]),g:pS(n[2]),b:pS(n[3]),format:t?"name":"hex"};if(n=xS.hex4.exec(e))return{r:pS(n[1]+n[1]),g:pS(n[2]+n[2]),b:pS(n[3]+n[3]),a:fS(n[4]+n[4]),format:t?"name":"hex8"};if(n=xS.hex3.exec(e))return{r:pS(n[1]+n[1]),g:pS(n[2]+n[2]),b:pS(n[3]+n[3]),format:t?"name":"hex"};return!1}(e)),"object"==typeof e&&(wS(e.r)&&wS(e.g)&&wS(e.b)?(t=function(e,t,n){return{r:255*cS(e,255),g:255*cS(t,255),b:255*cS(n,255)}}(e.r,e.g,e.b),s=!0,a="%"===String(e.r).substr(-1)?"prgb":"rgb"):wS(e.h)&&wS(e.s)&&wS(e.v)?(r=uS(e.s),i=uS(e.v),t=function(e,t,n){e=6*cS(e,360),t=cS(t,100),n=cS(n,100);var r=Math.floor(e),i=e-r,o=n*(1-t),s=n*(1-i*t),a=n*(1-(1-i)*t),l=r%6;return{r:255*[n,s,o,o,a,n][l],g:255*[a,n,n,s,o,o][l],b:255*[o,o,a,n,n,s][l]}}(e.h,r,i),s=!0,a="hsv"):wS(e.h)&&wS(e.s)&&wS(e.l)&&(r=uS(e.s),o=uS(e.l),t=function(e,t,n){var r,i,o;if(e=cS(e,360),t=cS(t,100),n=cS(n,100),0===t)i=n,o=n,r=n;else{var s=n<.5?n*(1+t):n+t-n*t,a=2*n-s;r=dS(a,s,e+1/3),i=dS(a,s,e),o=dS(a,s,e-1/3)}return{r:255*r,g:255*i,b:255*o}}(e.h,r,o),s=!0,a="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(n=e.a)),n=function(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}(n),{ok:s,format:e.format||a,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}var vS="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",yS="[\\s|\\(]+("+vS+")[,|\\s]+("+vS+")[,|\\s]+("+vS+")\\s*\\)?",bS="[\\s|\\(]+("+vS+")[,|\\s]+("+vS+")[,|\\s]+("+vS+")[,|\\s]+("+vS+")\\s*\\)?",xS={CSS_UNIT:new RegExp(vS),rgb:new RegExp("rgb"+yS),rgba:new RegExp("rgba"+bS),hsl:new RegExp("hsl"+yS),hsla:new RegExp("hsla"+bS),hsv:new RegExp("hsv"+yS),hsva:new RegExp("hsva"+bS),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function wS(e){return Boolean(xS.CSS_UNIT.exec(String(e)))}var CS=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function ES(e){var t=function(e,t,n){e=cS(e,255),t=cS(t,255),n=cS(n,255);var r=Math.max(e,t,n),i=Math.min(e,t,n),o=0,s=r,a=r-i,l=0===r?0:a/r;if(r===i)o=0;else{switch(r){case e:o=(t-n)/a+(t<n?6:0);break;case t:o=(n-e)/a+2;break;case n:o=(e-t)/a+4}o/=6}return{h:o,s:l,v:s}}(e.r,e.g,e.b);return{h:360*t.h,s:t.s,v:t.v}}function _S(e){var t=e.r,n=e.g,r=e.b;return"#".concat(function(e,t,n,r){var i=[hS(Math.round(e).toString(16)),hS(Math.round(t).toString(16)),hS(Math.round(n).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}(t,n,r,!1))}function SS(e,t,n){var r=n/100;return{r:(t.r-e.r)*r+e.r,g:(t.g-e.g)*r+e.g,b:(t.b-e.b)*r+e.b}}function OS(e,t,n){var r;return(r=Math.round(e.h)>=60&&Math.round(e.h)<=240?n?Math.round(e.h)-2*t:Math.round(e.h)+2*t:n?Math.round(e.h)+2*t:Math.round(e.h)-2*t)<0?r+=360:r>=360&&(r-=360),r}function AS(e,t,n){return 0===e.h&&0===e.s?e.s:((r=n?e.s-.16*t:4===t?e.s+.16:e.s+.05*t)>1&&(r=1),n&&5===t&&r>.1&&(r=.1),r<.06&&(r=.06),Number(r.toFixed(2)));var r}function kS(e,t,n){var r;return(r=n?e.v+.05*t:e.v-.15*t)>1&&(r=1),Number(r.toFixed(2))}function MS(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],r=mS(e),i=5;i>0;i-=1){var o=ES(r),s=_S(mS({h:OS(o,i,!0),s:AS(o,i,!0),v:kS(o,i,!0)}));n.push(s)}n.push(_S(r));for(var a=1;a<=4;a+=1){var l=ES(r),c=_S(mS({h:OS(l,a),s:AS(l,a),v:kS(l,a)}));n.push(c)}return"dark"===t.theme?CS.map((function(e){var r=e.index,i=e.opacity;return _S(SS(mS(t.backgroundColor||"#141414"),mS(n[r]),100*i))})):n}var TS={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},PS={},DS={};Object.keys(TS).forEach((function(e){PS[e]=MS(TS[e]),PS[e].primary=PS[e][5],DS[e]=MS(TS[e],{theme:"dark",backgroundColor:"#141414"}),DS[e].primary=DS[e][5]})),PS.red,PS.volcano,PS.gold,PS.orange,PS.yellow,PS.lime,PS.green,PS.cyan,PS.blue,PS.geekblue,PS.purple,PS.magenta,PS.grey;var NS={};function RS(e,t){}function IS(e,t){!function(e,t,n){t||NS[n]||(e(!1,n),NS[n]=!0)}(RS,e,t)}function jS(){return!("undefined"==typeof window||!window.document||!window.document.createElement)}var LS="rc-util-key";function FS(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function GS(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!jS())return null;var r,i=document.createElement("style");(null===(t=n.csp)||void 0===t?void 0:t.nonce)&&(i.nonce=null===(r=n.csp)||void 0===r?void 0:r.nonce);i.innerHTML=e;var o=FS(n),s=o.firstChild;return n.prepend&&o.prepend?o.prepend(i):n.prepend&&s?o.insertBefore(i,s):o.appendChild(i),i}var BS=new Map;function zS(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=FS(n);if(!BS.has(r)){var i=GS("",n),o=i.parentNode;BS.set(r,o),o.removeChild(i)}var s=Array.from(BS.get(r).children).find((function(e){return"STYLE"===e.tagName&&e[LS]===t}));if(s){var a,l,c;if((null===(a=n.csp)||void 0===a?void 0:a.nonce)&&s.nonce!==(null===(l=n.csp)||void 0===l?void 0:l.nonce))s.nonce=null===(c=n.csp)||void 0===c?void 0:c.nonce;return s.innerHTML!==e&&(s.innerHTML=e),s}var u=GS(e,n);return u[LS]=t,u}function US(e){return"object"===lS(e)&&"string"==typeof e.name&&"string"==typeof e.theme&&("object"===lS(e.icon)||"function"==typeof e.icon)}function VS(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,n){var r=e[n];if("class"===n)t.className=r,delete t.class;else t[n]=r;return t}),{})}function HS(e,t,n){return n?a.default.createElement(e.tag,iS(iS({key:t},VS(e.attrs)),n),(e.children||[]).map((function(n,r){return HS(n,"".concat(t,"-").concat(e.tag,"-").concat(r))}))):a.default.createElement(e.tag,iS({key:t},VS(e.attrs)),(e.children||[]).map((function(n,r){return HS(n,"".concat(t,"-").concat(e.tag,"-").concat(r))})))}function WS(e){return MS(e)[0]}function $S(e){return e?Array.isArray(e)?e:[e]:[]}var XS="\n.anticon {\n  display: inline-block;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n",YS=["icon","className","onClick","style","primaryColor","secondaryColor"],qS={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};var KS=function(e){var n,r,i=e.icon,o=e.className,s=e.onClick,a=e.style,l=e.primaryColor,c=e.secondaryColor,u=aS(e,YS),h=qS;if(l&&(h={primaryColor:l,secondaryColor:c||WS(l)}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:XS,n=t.useContext(tS).csp;t.useEffect((function(){zS(e,"@ant-design-icons",{prepend:!0,csp:n})}),[])}(),n=US(i),r="icon should be icon definiton, but got ".concat(i),IS(n,"[@ant-design/icons] ".concat(r)),!US(i))return null;var d=i;return d&&"function"==typeof d.icon&&(d=iS(iS({},d),{},{icon:d.icon(h.primaryColor,h.secondaryColor)})),HS(d.icon,"svg-".concat(d.name),iS({className:o,onClick:s,style:a,"data-icon":d.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},u))};KS.displayName="IconReact",KS.getTwoToneColors=function(){return iS({},qS)},KS.setTwoToneColors=function(e){var t=e.primaryColor,n=e.secondaryColor;qS.primaryColor=t,qS.secondaryColor=n||WS(t),qS.calculated=!!n};var ZS=KS;function JS(e){var t=sS($S(e),2),n=t[0],r=t[1];return ZS.setTwoToneColors({primaryColor:n,secondaryColor:r})}var QS=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];JS("#1890ff");var eO=l.forwardRef((function(e,t){var n,r=e.className,i=e.icon,o=e.spin,s=e.rotate,a=e.tabIndex,c=e.onClick,u=e.twoToneColor,h=aS(e,QS),d=l.useContext(tS).prefixCls,f=void 0===d?"anticon":d,p=hr(f,(nS(n={},"".concat(f,"-").concat(i.name),!!i.name),nS(n,"".concat(f,"-spin"),!!o||"loading"===i.name),n),r),g=a;void 0===g&&c&&(g=-1);var m=s?{msTransform:"rotate(".concat(s,"deg)"),transform:"rotate(".concat(s,"deg)")}:void 0,v=sS($S(u),2),y=v[0],b=v[1];return l.createElement("span",iS(iS({role:"img","aria-label":i.name},h),{},{ref:t,tabIndex:g,onClick:c,className:p}),l.createElement(ZS,{icon:i,primaryColor:y,secondaryColor:b,style:m}))}));eO.displayName="AntdIcon",eO.getTwoToneColor=function(){var e=ZS.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor},eO.setTwoToneColor=JS;var tO=eO,nO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},rO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:nO}))};rO.displayName="CheckCircleOutlined";var iO=l.forwardRef(rO),oO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4-66.1-.3c-4.4 0-8 3.5-8 8 0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 00-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4 66 .3c4.4 0 8-3.5 8-8 0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z"}},{tag:"path",attrs:{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448 448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"close-circle",theme:"outlined"},sO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:oO}))};sO.displayName="CloseCircleOutlined";var aO=l.forwardRef(sO),lO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M326 664H104c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h174v176c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V696c0-17.7-14.3-32-32-32zm16-576h-48c-8.8 0-16 7.2-16 16v176H104c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h222c17.7 0 32-14.3 32-32V104c0-8.8-7.2-16-16-16zm578 576H698c-17.7 0-32 14.3-32 32v224c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V744h174c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zm0-384H746V104c0-8.8-7.2-16-16-16h-48c-8.8 0-16 7.2-16 16v224c0 17.7 14.3 32 32 32h222c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16z"}}]},name:"compress",theme:"outlined"},cO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:lO}))};cO.displayName="CompressOutlined";var uO=l.forwardRef(cO),hO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"},dO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:hO}))};dO.displayName="DatabaseOutlined";var fO=l.forwardRef(dO),pO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M272.9 512l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512zm304 0l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z"}}]},name:"double-left",theme:"outlined"},gO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:pO}))};gO.displayName="DoubleLeftOutlined";var mO=l.forwardRef(gO),vO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M533.2 492.3L277.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H188c-6.7 0-10.4 7.7-6.3 12.9L447.1 512 181.7 851.1A7.98 7.98 0 00188 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5zm304 0L581.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H492c-6.7 0-10.4 7.7-6.3 12.9L751.1 512 485.7 851.1A7.98 7.98 0 00492 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z"}}]},name:"double-right",theme:"outlined"},yO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:vO}))};yO.displayName="DoubleRightOutlined";var bO=l.forwardRef(yO),xO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},wO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:xO}))};wO.displayName="ExclamationCircleOutlined";var CO=l.forwardRef(wO),EO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 298.4H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32z"}}]},name:"folder",theme:"filled"},_O=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:EO}))};_O.displayName="FolderFilled";var SO=l.forwardRef(_O),OO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zm-180 0H238c-13 0-24.8 7.9-29.7 20L136 643.2V256h188.5l119.6 114.4H748V444z"}}]},name:"folder-open",theme:"filled"},AO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:OO}))};AO.displayName="FolderOpenFilled";var kO=l.forwardRef(AO),MO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"},TO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:MO}))};TO.displayName="InfoCircleOutlined";var PO=l.forwardRef(TO),DO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"minus-square",theme:"outlined"},NO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:DO}))};NO.displayName="MinusSquareOutlined";var RO=l.forwardRef(NO),IO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M316 672h60c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8zm196-50c22.1 0 40-17.9 40-39 0-23.1-17.9-41-40-41s-40 17.9-40 41c0 21.1 17.9 39 40 39zm0-140c22.1 0 40-17.9 40-39 0-23.1-17.9-41-40-41s-40 17.9-40 41c0 21.1 17.9 39 40 39z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}},{tag:"path",attrs:{d:"M648 672h60c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8z"}}]},name:"one-to-one",theme:"outlined"},jO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:IO}))};jO.displayName="OneToOneOutlined";var LO=l.forwardRef(jO),FO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"plus-square",theme:"outlined"},GO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:FO}))};GO.displayName="PlusSquareOutlined";var BO=l.forwardRef(GO),zO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"},UO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:zO}))};UO.displayName="QuestionCircleOutlined";var VO=l.forwardRef(UO),HO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"},WO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:HO}))};WO.displayName="RedoOutlined";var $O=l.forwardRef(WO),XO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-in",theme:"outlined"},YO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:XO}))};YO.displayName="ZoomInOutlined";var qO=l.forwardRef(YO),KO={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-out",theme:"outlined"},ZO=function(e,t){return l.createElement(tO,iS(iS({},e),{},{ref:t,icon:KO}))};ZO.displayName="ZoomOutOutlined";var JO=l.forwardRef(ZO);const QO=a.default.createContext(null);QO.displayName="XFlowAppContext";const eA=()=>{const e=a.default.useContext(QO);return e&&e.getApp?e.getApp():null};class tA{constructor(e=!1){this.cache=null,this.setApp=e=>{this.cache=e,this.onAppChangeCallback&&this.onAppChangeCallback(e)},this.isUserDefined=()=>this.isUserDefinedFlag,this.getApp=()=>this.cache,this.onAppChange=e=>{this.onAppChangeCallback=e},this.dispose=()=>{this.cache=null},this.isUserDefinedFlag=e}}const nA=e=>{const t=a.default.useContext(QO),[,n]=a.default.useState(null),r=a.default.useMemo((()=>t&&t.isUserDefined()?t:new tA(!1)),[]);return r.isUserDefined()||r.onAppChange((()=>n(0))),a.default.useEffect((()=>{e.app&&r.setApp(e.app)}),[e.app]),r.isUserDefined()?a.default.createElement(a.default.Fragment,null,e.children):a.default.createElement(QO.Provider,{value:Object.assign({},r)},e.children)};nA.displayName="XFlowAppInternalProvider";const rA=({children:e})=>{const[,t]=a.default.useState(null),n=a.default.useMemo((()=>new tA(!0)),[]);return n.onAppChange((()=>t(0))),a.default.createElement(QO.Provider,{value:Object.assign({},n)},e)};rA.displayName="XFlowAppProvider",e.XFlowNodeCommands=void 0,function(e){const t="节点操作";e.ADD_NODE={id:"xflow:add-node",label:"添加节点",category:t},e.MOVE_NODE={id:"xflow:move-node",label:"Move Node",category:t},e.DEL_NODE={id:"xflow:del-node",label:"删除节点",category:t},e.UPDATE_NODE={id:"xflow:update-node",label:"更新节点",category:t},e.HIGHLIGHT_NODE={id:"xflow:highlight-node",label:"高亮节点",category:t},e.SELECT_NODE={id:"xflow:select-node",label:"选中节点",category:t},e.CENTER_NODE={id:"xflow:center-node",label:"居中节点",category:t},e.FRONT_NODE={id:"xflow:front-node",label:"前置节点",category:t},e.BACK_NODE={id:"xflow:back-node",label:"后置节点",category:t}}(e.XFlowNodeCommands||(e.XFlowNodeCommands={})),e.XFlowEdgeCommands=void 0,function(e){const t="边操作";e.ADD_EDGE={id:"xflow:add-edge",label:"添加边",category:t},e.DEL_EDGE={id:"xflow:del-edge",label:"删除边",category:t},e.UPDATE_EDGE={id:"xflow:update-edge",label:"更新边",category:t},e.HIGHLIGHT_EDGE={id:"xflow:highlight-edge",label:"高亮边",category:t},e.FRONT_EDGE={id:"xflow:front-edge",label:"前置变",category:t},e.BACK_EDGE={id:"xflow:back-edge",label:"后置边",category:t}}(e.XFlowEdgeCommands||(e.XFlowEdgeCommands={})),e.XFlowGraphCommands=void 0,function(e){const t="画布操作";e.LOAD_META={id:"xflow:load-meta",label:"获取元数据",category:t},e.LOAD_DATA={id:"xflow:load-data",label:"获取图数据",category:t},e.SAVE_GRAPH_DATA={id:"xflow:save-graph-data",label:"保存",category:t},e.GRAPH_LAYOUT={id:"xflow:layout",label:"计算布局",category:t},e.GRAPH_RENDER={id:"xflow:graph-render",label:"渲染画布",category:t},e.UNDO_CMD={id:"xflow:undo-cmd",label:"撤销",category:t},e.REDO_CMD={id:"xflow:redo-cmd",label:"重做",category:t},e.GRAPH_INSTANCE_COMMAND={id:"xflow:graph-instacne-cmd",label:"Graph通用Command",category:t},e.GRAPH_ZOOM={id:"xflow:graph-zoom",label:"缩放画布",category:t},e.GRAPH_RESIZE={id:"xflow:graph-resize",label:"调整窗口大小",category:t},e.GRAPH_COPY={id:"xflow:graph-copy-selection",label:"复制",category:t},e.GRAPH_PASTE={id:"xflow:graph-paste-selection",label:"粘贴",category:t},e.GRAPH_TOGGLE_MULTI_SELECT={id:"xflow:graph-toggle-multi-select",label:"启用框选",category:t},e.GRAPH_ADD_TOOL={id:"xflow:add-tool",label:"添加工具",category:t},e.GRAPH_DEL_TOOL={id:"xflow:del-tool",label:"删除工具",category:t},e.GRAPH_HISTORY_UNDO={id:"xflow:history-undo",label:"history undo",category:t},e.GRAPH_HISTORY_REDO={id:"xflow:history-redo",label:"history redo",category:t},e.GRAPH_HISTORY_RESET={id:"xflow:history-reset",label:"history reset",category:t},e.GRAPH_HISTORY_TOGGLE={id:"xflow:history-toggle",label:"history toggle",category:t}}(e.XFlowGraphCommands||(e.XFlowGraphCommands={})),e.XFlowModelCommands=void 0,(e.XFlowModelCommands||(e.XFlowModelCommands={})).UPDATE_MODEL={id:"xflow:update-model",label:"设置状态值",category:"状态操作"},e.XFlowGroupCommands=void 0,function(e){const t="群组操作";e.INIT_GROUP={id:"xflow:init-group",label:"初始化群组",category:t},e.ADD_GROUP={id:"xflow:add-group",label:"新建群组",category:t},e.DEL_GROUP={id:"xflow:del-group",label:"解散群组",category:t},e.COLLAPSE_GROUP={id:"xflow:collapse-group",label:"折叠群组",category:t}}(e.XFlowGroupCommands||(e.XFlowGroupCommands={}));const iA=t=>{const{cell:n}=t,r=eA(),i=t.data.isCollapsed||!1;return a.default.createElement("div",{className:"xflow-default-group-node"},a.default.createElement("div",{className:"xflow-group-header"},a.default.createElement("div",{className:"header-left"},t.data.label),a.default.createElement("div",{className:"header-right"},i&&a.default.createElement(BO,{onClick:t=>{t.preventDefault(),r.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:n.id,isCollapsed:!1})}}),!i&&a.default.createElement(RO,{onClick:t=>{t.preventDefault(),r.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:n.id,isCollapsed:!0,gap:3})}}))))};iA.displayName="XFlowDefaultGroupNode";const oA={fontSize:"16px",color:"#3057e3"};var sA;!function(e){e.SUCCESS="success",e.PROCESSING="processing",e.ERROR="error",e.DEFAULT="default",e.WARNING="warning"}(sA||(sA={}));const aA=e=>{if(e.hide)return null;switch(e.status){case sA.PROCESSING:return a.default.createElement($O,{spin:!0,style:{color:"#c1cdf7",fontSize:"16px"}});case sA.ERROR:return a.default.createElement(aO,{style:{color:"#ff4d4f",fontSize:"16px"}});case sA.SUCCESS:return a.default.createElement(iO,{style:{color:"#39ca74cc",fontSize:"16px"}});case sA.WARNING:return a.default.createElement(CO,{style:{color:"#faad14",fontSize:"16px"}});case sA.DEFAULT:return a.default.createElement(PO,{style:{color:"#d9d9d9",fontSize:"16px"}});default:return null}},lA=e=>{const t=a.default.isValidElement(e.data.icon)?e.data.icon:a.default.createElement(fO,{style:oA});return a.default.createElement("div",{className:"xflow-default-node "+(e.isNodeTreePanel?"panel-node":"")},a.default.createElement("span",{className:"icon"},t),a.default.createElement("span",{className:"label"},e.data.label),a.default.createElement("span",{className:"status"},a.default.createElement(aA,{status:e.data&&e.data.status,hide:e.isNodeTreePanel})))};lA.displayName="XFlowDefaultNode";var cA,uA=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.CONFIG_TYPE="GraphConfig",e.defaultNodeTypeParser=e=>e.renderKey,e.defaultEdgeTypeParser=e=>e.renderKey,e.defaultNodeMapValue=[[Y_,lA],[q_,iA]]}(cA||(cA={}));class hA{constructor(){this.CONFIG_TYPE=cA.CONFIG_TYPE,this.x6Options=new H_,this.rootContainer=new H_,this.graphContainer=new H_,this.nodeRender=new Map(cA.defaultNodeMapValue),this.edgeRender=new Map,this.nodeTypeParser=cA.defaultNodeTypeParser,this.edgeTypeParser=cA.defaultEdgeTypeParser,this.events=[],this.mergeX6Config=e=>uA(this,void 0,void 0,(function*(){const t=yield this.getX6Config();return Object.assign(t,e)})),this.getX6Config=()=>uA(this,void 0,void 0,(function*(){return yield this.x6Options.promise})),this.setX6Config=e=>{var t;const n=this.getDefaultGraphOptions();null===(t=this.x6Options)||void 0===t||t.resolve(Object.assign(Object.assign({},n),e))},this.setRootContainer=e=>{e&&(null==this||this.rootContainer.resolve(e))},this.setGraphContainer=e=>{var t;e&&(null===(t=this.graphContainer)||void 0===t||t.resolve(e))},this.setEvents=e=>{this.events=e},this.setDefaultNodeRender=e=>{this.nodeRender.set(Y_,e)},this.setDefaultEdgeRender=e=>{this.edgeRender.set(K_,e)},this.setNodeRender=(e,t)=>{this.nodeRender.set(e,t)},this.setEdgeRender=(e,t)=>{this.edgeRender.set(e,t)},this.setNodeTypeParser=e=>{this.nodeTypeParser=e},this.setEdgeTypeParser=e=>{this.edgeTypeParser=e},this.getConfig=()=>uA(this,void 0,void 0,(function*(){const[e,t,n]=yield Promise.all([this.rootContainer.promise,this.graphContainer.promise,this.x6Options.promise]);return{xflowInstanceId:this.xflowInstanceId,graphId:this.graphId,nodeViewId:this.graphId,rootContainer:e,graphContainer:t,x6Options:n,events:this.events,nodeRender:this.nodeRender,edgeRender:this.edgeRender,nodeTypeParser:this.nodeTypeParser,edgeTypeParser:this.edgeTypeParser}})),this.getDefaultGraphOptions=()=>({rotating:!1,resizing:!1,connecting:{snap:!0,dangling:!1,highlight:!1,connectionPoint:"rect",router:{name:"er"},connector:{name:"rounded",args:{radius:15}}},background:{},grid:{visible:!0},selecting:{strict:!0,enabled:!0,multiple:!0,selectCellOnMoved:!0,showNodeSelectionBox:!1,rubberEdge:!0,rubberNode:!0,movable:!0},snapline:{enabled:!1},history:{enabled:!1},clipboard:{enabled:!0,useLocalStorage:!0},scroller:{enabled:!1},mousewheel:{enabled:!0,minScale:X_,maxScale:1.5,factor:1.1,modifiers:["ctrl","meta"]},panning:{enabled:!0},scaling:{min:X_,max:1.5},keyboard:{enabled:!0},interacting:{nodeMovable:!0,edgeLabelMovable:!1},async:!1}),this.dispose=()=>{this.rootContainer=new H_,this.graphContainer=new H_,this.x6Options=new H_},this.graphId=eS()}}const dA=Symbol("IGraphOptionProvider"),fA=e=>t=>{const n=a.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const r=a.default.useMemo((()=>{const t=new hA;return e(t,n),t}),[n]);return r}
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */;var pA=function(e,t){return pA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},pA(e,t)};function gA(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}pA(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function mA(e){return"function"==typeof e}var vA=!1,yA={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack;vA=e},get useDeprecatedSynchronousErrorHandling(){return vA}};function bA(e){setTimeout((function(){throw e}),0)}var xA={closed:!0,next:function(e){},error:function(e){if(yA.useDeprecatedSynchronousErrorHandling)throw e;bA(e)},complete:function(){}},wA=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function CA(e){return null!==e&&"object"==typeof e}var EA=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),_A=EA,SA=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,r=n._parentOrParents,i=n._ctorUnsubscribe,o=n._unsubscribe,s=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var a=0;a<r.length;++a){r[a].remove(this)}if(mA(o)){i&&(this._unsubscribe=void 0);try{o.call(this)}catch(e){t=e instanceof _A?OA(e.errors):[e]}}if(wA(s)){a=-1;for(var l=s.length;++a<l;){var c=s[a];if(CA(c))try{c.unsubscribe()}catch(e){t=t||[],e instanceof _A?t=t.concat(OA(e.errors)):t.push(e)}}}if(t)throw new _A(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function OA(e){return e.reduce((function(e,t){return e.concat(t instanceof _A?t.errors:t)}),[])}var AA=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),kA=function(e){function t(n,r,i){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=xA;break;case 1:if(!n){o.destination=xA;break}if("object"==typeof n){n instanceof t?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new MA(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new MA(o,n,r,i)}return o}return gA(t,e),t.prototype[AA]=function(){return this},t.create=function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(SA),MA=function(e){function t(t,n,r,i){var o,s=e.call(this)||this;s._parentSubscriber=t;var a=s;return mA(n)?o=n:n&&(o=n.next,r=n.error,i=n.complete,n!==xA&&(mA((a=Object.create(n)).unsubscribe)&&s.add(a.unsubscribe.bind(a)),a.unsubscribe=s.unsubscribe.bind(s))),s._context=a,s._next=o,s._error=r,s._complete=i,s}return gA(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;yA.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=yA.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):bA(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;bA(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};yA.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),yA.useDeprecatedSynchronousErrorHandling)throw e;bA(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!yA.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return yA.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(bA(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(kA);var TA=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function PA(e){return e}function DA(e){return 0===e.length?PA:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var NA=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,i=function(e,t,n){if(e){if(e instanceof kA)return e;if(e[AA])return e[AA]()}return e||t||n?new kA(e,t,n):new kA(xA)}(e,t,n);if(r?i.add(r.call(i,this.source)):i.add(this.source||yA.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),yA.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){yA.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),!function(e){for(;e;){var t=e,n=t.closed,r=t.destination,i=t.isStopped;if(n||i)return!1;e=r&&r instanceof kA?r:null}return!0}(e)?console.warn(t):e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=RA(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(e){r(e),i&&i.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[TA]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:DA(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=RA(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function RA(e){if(e||(e=Promise),!e)throw new Error("no Promise impl found");return e}var IA=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),jA=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return gA(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(SA),LA=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return gA(t,e),t}(kA),FA=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return gA(t,e),t.prototype[AA]=function(){return new LA(this)},t.prototype.lift=function(e){var t=new GA(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new IA;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)},t.prototype.error=function(e){if(this.closed)throw new IA;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new IA;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new IA;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new IA;return this.hasError?(e.error(this.thrownError),SA.EMPTY):this.isStopped?(e.complete(),SA.EMPTY):(this.observers.push(e),new jA(this,e))},t.prototype.asObservable=function(){var e=new NA;return e.source=this,e},t.create=function(e,t){return new GA(e,t)},t}(NA),GA=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return gA(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):SA.EMPTY},t}(FA),BA=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return gA(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new IA;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(FA),zA=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return gA(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return gA(t,e),t.prototype.schedule=function(e,t){return this},t}(SA)),UA=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),VA=function(e){function t(n,r){void 0===r&&(r=UA.now);var i=e.call(this,n,(function(){return t.delegate&&t.delegate!==i?t.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return gA(t,e),t.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,i):e.prototype.schedule.call(this,n,r,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(UA),HA=new VA(zA),WA=HA;var $A=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new XA(e,this.predicate,this.thisArg))},e}(),XA=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return gA(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(kA);var YA=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new qA(e,this.compare,this.keySelector))},e}(),qA=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.keySelector=r,i.hasKey=!1,"function"==typeof n&&(i.compare=n),i}return gA(t,e),t.prototype.compare=function(e,t){return e===t},t.prototype._next=function(e){var t;try{var n=this.keySelector;t=n?n(e):e}catch(e){return this.destination.error(e)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,t)}catch(e){return this.destination.error(e)}else this.hasKey=!0;r||(this.key=t,this.destination.next(e))},t}(kA),KA={leading:!0,trailing:!1};var ZA=function(){function e(e,t,n,r){this.duration=e,this.scheduler=t,this.leading=n,this.trailing=r}return e.prototype.call=function(e,t){return t.subscribe(new JA(e,this.duration,this.scheduler,this.leading,this.trailing))},e}(),JA=function(e){function t(t,n,r,i,o){var s=e.call(this,t)||this;return s.duration=n,s.scheduler=r,s.leading=i,s.trailing=o,s._hasTrailingValue=!1,s._trailingValue=null,s}return gA(t,e),t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(QA,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0))},t.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)},t}(kA);function QA(e){e.subscriber.clearThrottle()}function ek(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function tk(e){return!!e&&!!e[Bk]}function nk(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===Uk}(e)||Array.isArray(e)||!!e[Gk]||!!e.constructor[Gk]||ak(e)||lk(e))}function rk(e,t,n){void 0===n&&(n=!1),0===ik(e)?(n?Object.keys:Vk)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function ik(e){var t=e[Bk];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:ak(e)?2:lk(e)?3:0}function ok(e,t){return 2===ik(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function sk(e,t,n){var r=ik(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function ak(e){return Ik&&e instanceof Map}function lk(e){return jk&&e instanceof Set}function ck(e){return e.o||e.t}function uk(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Hk(e);delete t[Bk];for(var n=Vk(t),r=0;r<n.length;r++){var i=n[r],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function hk(e,t){return void 0===t&&(t=!1),fk(e)||tk(e)||!nk(e)||(ik(e)>1&&(e.set=e.add=e.clear=e.delete=dk),Object.freeze(e),t&&rk(e,(function(e,t){return hk(t,!0)}),!0)),e}function dk(){ek(2)}function fk(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function pk(e){var t=Wk[e];return t||ek(18,e),t}function gk(){return Nk}function mk(e,t){t&&(pk("Patches"),e.u=[],e.s=[],e.v=t)}function vk(e){yk(e),e.p.forEach(xk),e.p=null}function yk(e){e===Nk&&(Nk=e.l)}function bk(e){return Nk={p:[],l:Nk,h:e,m:!0,_:0}}function xk(e){var t=e[Bk];0===t.i||1===t.i?t.j():t.O=!0}function wk(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.g||pk("ES5").S(t,e,r),r?(n[Bk].P&&(vk(t),ek(4)),nk(e)&&(e=Ck(t,e),t.l||_k(t,e)),t.u&&pk("Patches").M(n[Bk],e,t.u,t.s)):e=Ck(t,n,[]),vk(t),t.u&&t.v(t.u,t.s),e!==Fk?e:void 0}function Ck(e,t,n){if(fk(t))return t;var r=t[Bk];if(!r)return rk(t,(function(i,o){return Ek(e,r,t,i,o,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return _k(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=4===r.i||5===r.i?r.o=uk(r.k):r.o;rk(3===r.i?new Set(i):i,(function(t,o){return Ek(e,r,i,t,o,n)})),_k(e,i,!1),n&&e.u&&pk("Patches").R(r,n,e.u,e.s)}return r.o}function Ek(e,t,n,r,i,o){if(tk(i)){var s=Ck(e,i,o&&t&&3!==t.i&&!ok(t.D,r)?o.concat(r):void 0);if(sk(n,r,s),!tk(s))return;e.m=!1}if(nk(i)&&!fk(i)){if(!e.h.F&&e._<1)return;Ck(e,i),t&&t.A.l||_k(e,i)}}function _k(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&hk(t,n)}function Sk(e,t){var n=e[Bk];return(n?ck(n):e)[t]}function Ok(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function Ak(e){e.P||(e.P=!0,e.l&&Ak(e.l))}function kk(e){e.o||(e.o=uk(e.t))}function Mk(e,t,n){var r=ak(t)?pk("MapSet").N(t,n):lk(t)?pk("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:gk(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=r,o=$k;n&&(i=[r],o=Xk);var s=Proxy.revocable(i,o),a=s.revoke,l=s.proxy;return r.k=l,r.j=a,l}(t,n):pk("ES5").J(t,n);return(n?n.A:gk()).p.push(r),r}function Tk(e){return tk(e)||ek(22,e),function e(t){if(!nk(t))return t;var n,r=t[Bk],i=ik(t);if(r){if(!r.P&&(r.i<4||!pk("ES5").K(r)))return r.t;r.I=!0,n=Pk(t,i),r.I=!1}else n=Pk(t,i);return rk(n,(function(t,i){r&&function(e,t){return 2===ik(e)?e.get(t):e[t]}(r.t,t)===i||sk(n,t,e(i))})),3===i?new Set(n):n}(e)}function Pk(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return uk(e)}var Dk,Nk,Rk="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Ik="undefined"!=typeof Map,jk="undefined"!=typeof Set,Lk="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Fk=Rk?Symbol.for("immer-nothing"):((Dk={})["immer-nothing"]=!0,Dk),Gk=Rk?Symbol.for("immer-draftable"):"__$immer_draftable",Bk=Rk?Symbol.for("immer-state"):"__$immer_state",zk="undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator",Uk=""+Object.prototype.constructor,Vk="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Hk=Object.getOwnPropertyDescriptors||function(e){var t={};return Vk(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},Wk={},$k={get:function(e,t){if(t===Bk)return e;var n=ck(e);if(!ok(n,t))return function(e,t,n){var r,i=Ok(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!nk(r)?r:r===Sk(e.t,t)?(kk(e),e.o[t]=Mk(e.A.h,r,e)):r},has:function(e,t){return t in ck(e)},ownKeys:function(e){return Reflect.ownKeys(ck(e))},set:function(e,t,n){var r=Ok(ck(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var i=Sk(ck(e),t),o=null==i?void 0:i[Bk];if(o&&o.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,i)&&(void 0!==n||ok(e.t,t)))return!0;kk(e),Ak(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==Sk(e.t,t)||t in e.t?(e.D[t]=!1,kk(e),Ak(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=ck(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){ek(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){ek(12)}},Xk={};rk($k,(function(e,t){Xk[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Xk.deleteProperty=function(e,t){return $k.deleteProperty.call(this,e[0],t)},Xk.set=function(e,t,n){return $k.set.call(this,e[0],t,n,e[0])};var Yk=function(){function e(e){var t=this;this.g=Lk,this.F=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var i=n;n=e;var o=t;return function(e){var t=this;void 0===e&&(e=i);for(var r=arguments.length,s=Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return o.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(s))}))}}var s;if("function"!=typeof n&&ek(6),void 0!==r&&"function"!=typeof r&&ek(7),nk(e)){var a=bk(t),l=Mk(t,e,void 0),c=!0;try{s=n(l),c=!1}finally{c?vk(a):yk(a)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return mk(a,r),wk(e,a)}),(function(e){throw vk(a),e})):(mk(a,r),wk(s,a))}if(!e||"object"!=typeof e){if((s=n(e))===Fk)return;return void 0===s&&(s=e),t.F&&hk(s,!0),s}ek(21,e)},this.produceWithPatches=function(e,n){return"function"==typeof e?function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(i))}))}:[t.produce(e,n,(function(e,t){r=e,i=t})),r,i];var r,i},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){nk(e)||ek(8),tk(e)&&(e=Tk(e));var t=bk(this),n=Mk(this,e,void 0);return n[Bk].C=!0,yk(t),n},t.finishDraft=function(e,t){var n=(e&&e[Bk]).A;return mk(n,t),wk(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!Lk&&ek(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var i=pk("Patches").$;return tk(e)?i(e,t):this.produce(e,(function(e){return i(e,t)}))},e}(),qk=new Yk,Kk=qk.produce;qk.produceWithPatches.bind(qk);var Zk=qk.setAutoFreeze.bind(qk);qk.setUseProxies.bind(qk),qk.applyPatches.bind(qk);var Jk=qk.createDraft.bind(qk),Qk=qk.finishDraft.bind(qk),eM=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(){function e(e,t){function n(){this.constructor=e}i(e,t),e.prototype=(n.prototype=t.prototype,new n)}function t(e){e.o||(e.D=new Map,e.o=new Map(e.t))}function n(e){e.o||(e.o=new Set,e.t.forEach((function(t){if(nk(t)){var n=Mk(e.A.h,t,e);e.p.set(t,n),e.o.add(n)}else e.o.add(t)})))}function r(e){e.O&&ek(3,JSON.stringify(ck(e)))}var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},o=function(){function n(e,t){return this[Bk]={i:2,l:t,A:t?t.A:gk(),P:!1,I:!1,o:void 0,D:void 0,t:e,k:this,C:!1,O:!1},this}e(n,Map);var i=n.prototype;return Object.defineProperty(i,"size",{get:function(){return ck(this[Bk]).size}}),i.has=function(e){return ck(this[Bk]).has(e)},i.set=function(e,n){var i=this[Bk];return r(i),ck(i).has(e)&&ck(i).get(e)===n||(t(i),Ak(i),i.D.set(e,!0),i.o.set(e,n),i.D.set(e,!0)),this},i.delete=function(e){if(!this.has(e))return!1;var n=this[Bk];return r(n),t(n),Ak(n),n.D.set(e,!1),n.o.delete(e),!0},i.clear=function(){var e=this[Bk];r(e),ck(e).size&&(t(e),Ak(e),e.D=new Map,rk(e.t,(function(t){e.D.set(t,!1)})),e.o.clear())},i.forEach=function(e,t){var n=this;ck(this[Bk]).forEach((function(r,i){e.call(t,n.get(i),i,n)}))},i.get=function(e){var n=this[Bk];r(n);var i=ck(n).get(e);if(n.I||!nk(i))return i;if(i!==n.t.get(e))return i;var o=Mk(n.A.h,i,n);return t(n),n.o.set(e,o),o},i.keys=function(){return ck(this[Bk]).keys()},i.values=function(){var e,t=this,n=this.keys();return(e={})[zk]=function(){return t.values()},e.next=function(){var e=n.next();return e.done?e:{done:!1,value:t.get(e.value)}},e},i.entries=function(){var e,t=this,n=this.keys();return(e={})[zk]=function(){return t.entries()},e.next=function(){var e=n.next();if(e.done)return e;var r=t.get(e.value);return{done:!1,value:[e.value,r]}},e},i[zk]=function(){return this.entries()},n}(),s=function(){function t(e,t){return this[Bk]={i:3,l:t,A:t?t.A:gk(),P:!1,I:!1,o:void 0,t:e,k:this,p:new Map,O:!1,C:!1},this}e(t,Set);var i=t.prototype;return Object.defineProperty(i,"size",{get:function(){return ck(this[Bk]).size}}),i.has=function(e){var t=this[Bk];return r(t),t.o?!!t.o.has(e)||!(!t.p.has(e)||!t.o.has(t.p.get(e))):t.t.has(e)},i.add=function(e){var t=this[Bk];return r(t),this.has(e)||(n(t),Ak(t),t.o.add(e)),this},i.delete=function(e){if(!this.has(e))return!1;var t=this[Bk];return r(t),n(t),Ak(t),t.o.delete(e)||!!t.p.has(e)&&t.o.delete(t.p.get(e))},i.clear=function(){var e=this[Bk];r(e),ck(e).size&&(n(e),Ak(e),e.o.clear())},i.values=function(){var e=this[Bk];return r(e),n(e),e.o.values()},i.entries=function(){var e=this[Bk];return r(e),n(e),e.o.entries()},i.keys=function(){return this.values()},i[zk]=function(){return this.values()},i.forEach=function(e,t){for(var n=this.values(),r=n.next();!r.done;)e.call(t,r.value,r.value,this),r=n.next()},t}();!function(e,t){Wk[e]||(Wk[e]=t)}("MapSet",{N:function(e,t){return new o(e,t)},T:function(e,t){return new s(e,t)}})}(),Zk(!1),e.NsModel=void 0,function(e){function t(t){return t!==e.EMPTY_VALUE}e.EMPTY_VALUE=Symbol("EMPTY_MODEL_VALUE"),e.isValidValue=t,e.defaultPipeFunction=function(e){return e.pipe((function(e){return e.lift(new YA(i,o))}),(n=e=>t(e),function(e){return e.lift(new $A(n,r))}),function(e,t,n){return void 0===t&&(t=WA),void 0===n&&(n=KA),function(r){return r.lift(new ZA(e,t,n.leading,n.trailing))}}(17,HA,{leading:!1,trailing:!0}));var n,r,i,o}}(e.NsModel||(e.NsModel={}));class tM{constructor(t=e.NsModel.EMPTY_VALUE,n=30){this.toDispose=new V_,this.watch=(t,n=e.NsModel.defaultPipeFunction)=>{this.subject$.observers.length+1>this.maxSubscription&&console.warn(`${this.subject$} reach maxSubscription limitation, please check`);const r=(n?n(this.subject$):this.subject$).subscribe(t);return e.Disposable.create((()=>{r.unsubscribe()}))},this.getValue=()=>this.subject$.getValue(),this.setValue=t=>{if(this.subject$)if("function"!=typeof t)this.subject$.next(t);else{const n=this.subject$.getValue(),r=Kk(n,(e=>{t(e)}));e.NsModel.isValidValue(r)&&this.setValue(r)}},this.hasValidValue=()=>{const t=this.getValue();return e.NsModel.isValidValue(t)},this.getValidValue=()=>eM(this,void 0,void 0,(function*(){const t=new H_;if(this.hasValidValue())return this.getValue();const n=this.watch((r=>{e.NsModel.isValidValue(r)&&(t.resolve(r),n.dispose())}));return t.promise})),this.dispose=()=>{this.toDispose.dispose()},this.subject$=new BA(t||e.NsModel.EMPTY_VALUE),this.maxSubscription=n,this.toDispose.push(e.Disposable.create((()=>{this.subject$.complete(),this.subject$.unsubscribe(),this.subject$=null})))}}const nM=Sn.defineToken("IFrontendApplicationContribution"),rM=Symbol("IGraphCommandService"),iM=Sn.defineToken("ICommandHandler"),oM=Symbol("ICommandContextProvider"),sM=Symbol("IGraphCommandFactory"),aM=Sn.defineToken("IGraphCommandContribution");var lM,cM=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},uM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hM=function(e,t){return function(n,r){t(n,r,e)}},dM=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.is=function(e){return!!e&&e===Object(e)&&"id"in e},e.compareCommands=function(e,t){if(e.label&&t.label){const n=(e.category?`${e.category}: ${e.label}`:e.label).toLowerCase(),r=(t.category?`${t.category}: ${t.label}`:t.label).toLowerCase();return n.localeCompare(r)}return 0},e.equals=function(e,t){return e.id===t.id&&e.label===t.label&&e.iconName===t.iconName&&e.category===t.category}}(lM||(lM={})),e.GraphCommandRegistry=class{constructor(e){this.contributionProvider=e,this.redoStack=[],this.undoStack=[],this.commands=new Map,this.factories=new Map,this.disposables=new Map,this.cmdChangeEvent=new tM(null),this.Globals=new tM(new Map),this.setGlobal=(e,t)=>{this.Globals.setValue((n=>{n.set(e,t)}))},this.getGlobal=e=>this.Globals.getValue().get(e),this.undoCommand=()=>dM(this,void 0,void 0,(function*(){const e=this.undoStack.pop();e?(yield e.undo(),this.redoStack.push(e),this.cmdChangeEvent.setValue(null)):console.error("empty undo stack")})),this.redoCommand=()=>dM(this,void 0,void 0,(function*(){const e=this.redoStack.pop();e?(yield e.redo(),this.undoStack.push(e),this.cmdChangeEvent.setValue(null)):console.error("empty undo stack")})),this.registerDisposableCommand=e=>{const t=new V_;return e({registerCommand:(e,n)=>{const r=this.registerCommand(e,n);return t.push(r),r}}),t}}get watchChange(){return this.cmdChangeEvent.watch}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerGraphCommands(this)}executeCommandPipeline(e){return dM(this,void 0,void 0,(function*(){let t=null;for(const n of e){const e=null==t?void 0:t.contextProvider(),{args:r,hooks:i}=yield null==n?void 0:n.getCommandOption(e);t=yield this.executeCommand(null==n?void 0:n.commandId,r,i)}return this.cmdChangeEvent.setValue(null),t}))}executeCommand(e,t,n=[]){return dM(this,void 0,void 0,(function*(){const r=this.getFactory(e);if(r){const i=yield r.createCommand(e,t,n);return yield i.execute(),i.isUndoable()&&this.undoStack.push(i),this.cmdChangeEvent.setValue(null),i}throw Object.assign(new Error(`The command '${e}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})}))}executeUndoCommand(e,t,n=[]){return dM(this,void 0,void 0,(function*(){const r=this.getFactory(e);if(r){const i=yield r.createCommand(e,t,n);return yield i.execute(),i}throw Object.assign(new Error(`The command '${e}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})}))}createCommand(e,t,n=[]){return dM(this,void 0,void 0,(function*(){const r=this.getFactory(e);if(r){return yield r.createCommand(e,t,n)}throw Object.assign(new Error(`The command '${e}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})}))}get isUndoable(){return this.undoStack.length>0}get isRedoable(){return this.redoStack.length>0}hasCommand(e){return this.commands.has(e)}getCommand(e){return this.commands.get(e)}registerCommand(t,n){if(this.factories.has(t.id))return console.warn(`A command ${t.id} is already registered.`),e.Disposable.NULL;const r=new V_(this.doRegisterCommand(t),this.registerFactory(t.id,n),e.Disposable.create((()=>this.disposables.delete(t.id))));return this.disposables.set(t.id,r),r}doRegisterCommand(t){return this.commands.set(t.id,t),e.Disposable.create((()=>this.disposables.delete(t.id)))}unregisterCommand(e){const t=lM.is(e)?e.id:e,n=this.disposables.get(t);n&&n.dispose()}hasFactory(e){return!!this.factories.get(e)}getFactory(e){return this.factories.get(e)}registerFactory(t,n,r=!1){return this.hasFactory(t)&&!1===r&&console.error("cannot register command:",t),this.factories.set(t,n),e.Disposable.create((()=>{this.factories.delete(t)}))}getAllFactories(){return Array.from(this.factories.entries())}},e.GraphCommandRegistry=cM([Hn({contrib:[nM,rM]}),hM(0,or(aM)),uM("design:paramtypes",[Object])],e.GraphCommandRegistry);const fM=rr((t=>{ir.register(t,aM),t(e.GraphCommandRegistry)})),pM=Sn.defineToken("IModelService"),gM=Sn.defineToken("IModelContribution"),mM=Symbol("IModelOptionProvider");var vM;e.ScheduleTypeEnum=void 0,(vM=e.ScheduleTypeEnum||(e.ScheduleTypeEnum={})).ASYNC_SRRIES="ASYNC_SRRIES",vM.ASYNC_PARALLEL="ASYNC_PARALLEL";var yM={exports:{}};function bM(e,t){var n=e.length,r=new Array(n),i={},o=n,s=function(e){for(var t=new Map,n=0,r=e.length;n<r;n++){var i=e[n];t.has(i[0])||t.set(i[0],new Set),t.has(i[1])||t.set(i[1],new Set),t.get(i[0]).add(i[1])}return t}(t),a=function(e){for(var t=new Map,n=0,r=e.length;n<r;n++)t.set(e[n],n);return t}(e);for(t.forEach((function(e){if(!a.has(e[0])||!a.has(e[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")}));o--;)i[o]||l(e[o],o,new Set);return r;function l(e,t,o){if(o.has(e)){var c;try{c=", node was:"+JSON.stringify(e)}catch(e){c=""}throw new Error("Cyclic dependency"+c)}if(!a.has(e))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(e));if(!i[t]){i[t]=!0;var u=s.get(e)||new Set;if(t=(u=Array.from(u)).length){o.add(e);do{var h=u[--t];l(h,a.get(h),o)}while(t);o.delete(e)}r[--n]=e}}}yM.exports=function(e){return bM(function(e){for(var t=new Set,n=0,r=e.length;n<r;n++){var i=e[n];t.add(i[0]),t.add(i[1])}return Array.from(t)}(e),e)},yM.exports.array=bM;var xM,wM,CM=yM.exports;!function(e){let t;!function(e){e.INVALID_HOOK_BEFORE="INVALID_HOOK_BEFORE",e.INVALID_HOOK_AFTER="INVALID_HOOK_AFTER",e.INVALID_HOOK_ARGS_LENGTH="INVALID_HOOK_ARGS_LENGTH"}(t=e.ErrorEnum||(e.ErrorEnum={}));class n extends Error{constructor(e,t,...r){Array.isArray(t)&&(t=t.filter((function(e){return!!e})).join(" ")),super(`${e}: ${t}`),Error.captureStackTrace&&Error.captureStackTrace(this,n),this.code=e,this.contexts={},r.forEach((e=>{"object"==typeof e&&Object.entries(e).forEach((e=>{const[t,n]=e;"key"!==t&&n&&(this.contexts[t]=JSON.parse(JSON.stringify(n)))}))}))}toString(){return`${this.code}: ${this.message}`}}e.HookError=n;const r=(e,t,...r)=>new n(e,t,...r);e.HookBeforeError=()=>r(t.INVALID_HOOK_BEFORE,["hook require a before dependency but not exist in hookmap"]),e.HookAfterError=()=>r(t.INVALID_HOOK_AFTER,["hook require a after dependency but not exist in hookmap"]),e.InvalidHookArguments=e=>r(t.INVALID_HOOK_ARGS_LENGTH,["hook handlers must have 0 to 2 arguments",`but got ${e.handler.length}`])}(xM||(xM={})),function(e){e.normalize=(e=[],t)=>{const n=Array.isArray(e)?e:[e],r=[];return t.forEach((e=>{r.push(e)})),[...r,...n].filter((e=>e&&!!e.handler))},e.sort=(e=[],t)=>{const n=[];e.forEach((e=>{if(e.before){if(!t.has(e.before))throw xM.HookBeforeError();const r=[e,t.get(e.before)];n.push(r)}if(e.after){if(!t.has(e.after))throw xM.HookBeforeError();const r=[t.get(e.after),e];n.push(r)}}));return CM.array(e,n)}}(wM||(wM={}));class EM{constructor(){this.isResolved=!1,this.isRejected=!1,this.promise=new Promise(((e,t)=>{this.resolve=t=>{this.isResolved=!0,e(t)},this.reject=e=>{this.isRejected=!0,t(e)}}))}}var _M=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class SM{constructor(t){this.scheduleType=e.ScheduleTypeEnum.ASYNC_SRRIES,this.hasHook=e=>this.hookMap.has(e),this.getHooks=(e=[],t=!0)=>{const n=wM.normalize(e,this.hookMap);return t?wM.sort(n,this.hookMap):n},this.registerHook=e=>(this.hookMap.has(e.name)&&console.error(`${e.name} is duplicated in hookmap`),this.hookMap.set(e.name,e),{dispose:()=>{this.hookMap.delete(e.name)}}),this.call=(e,t=(e=>_M(this,void 0,void 0,(function*(){return e}))),n=[])=>_M(this,void 0,void 0,(function*(){const r=this.getHooks(n,!0);return(0,this.schedulers[this.scheduleType])(e,t,r)})),this.schedulers={[e.ScheduleTypeEnum.ASYNC_SRRIES]:(e,t,n=[])=>_M(this,void 0,void 0,(function*(){let r=t;for(const t of n){if([0,1].includes(t.handler.length)){yield t.handler.call(this,e);continue}if([2].includes(t.handler.length)&&null!==r){const n=yield t.handler.call(this,e,r);if(null===n){r=null;break}if("function"==typeof n){r=n;continue}}throw xM.InvalidHookArguments(t)}if(r)return yield r.call(this,e)})),[e.ScheduleTypeEnum.ASYNC_PARALLEL]:(e,t,n=[])=>_M(this,void 0,void 0,(function*(){const r=n.map((n=>{if([0,1].includes(n.handler.length))return n.handler.call(this,e);if([2].includes(n.handler.length))return n.handler.call(this,e,t);throw xM.InvalidHookArguments(n)})),i=new EM;if(Promise.all(r).then((e=>i.resolve(e))),t)return yield t.call(this,i)}))},this.hookMap=new Map,t&&t.type&&(this.scheduleType=t.type)}}const OM=Sn.defineToken("IHookService"),AM=Sn.defineToken("IHookContribution");var kM=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const MM=()=>({dispose:()=>{}});var TM;!function(e){e.CONFIG_TYPE="XFlowHook"}(TM||(TM={}));class PM{constructor(){this.CONFIG_TYPE=TM.CONFIG_TYPE,this.time=Date.now(),this.setRegisterHook=e=>{this.hookRegisterFunc=e},this.setRegisterHookhub=e=>{this.hookhubRegisterFn=e},this.getConfig=()=>kM(this,void 0,void 0,(function*(){return{CONFIG_TYPE:this.CONFIG_TYPE,hookRegisterFn:this.hookRegisterFunc||MM,hookhubRegisterFn:this.hookhubRegisterFn||MM}})),this.dispose=()=>{}}}var DM=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},NM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},RM=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let IM=class{constructor(){this.toDispose=new V_,this.hookProvider=()=>this.hooks,this.registerHook=e=>e(this.hooks),this.registerHookHub=(e,t)=>(this.hooks[e]=t,{dispose:()=>{delete this.hooks[e]}}),this.onStart=()=>RM(this,void 0,void 0,(function*(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerHookHub(this);for(const t of e)t.registerHook(this.hooks)})),this.hooks={graphOptions:new SM,reactNodeRender:new SM,reactEdgeLabelRender:new SM,afterGraphInit:new SM,beforeGraphDestory:new SM,x6Events:new SM}}onStop(){this.toDispose.dispose()}};DM([or(AM),NM("design:type",Object)],IM.prototype,"contributionProvider",void 0),IM=DM([Hn({contrib:[nM,OM]}),NM("design:paramtypes",[])],IM);var jM,LM=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},FM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},GM=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.pluginId="GraphEventPlugin"}(jM||(jM={}));let BM=class{constructor(){this.toDispose=new V_,this.registerHook=t=>GM(this,void 0,void 0,(function*(){const{hookRegisterFn:n}=yield this.hookConfig.getConfig(),r=n(t);return e.Disposable.create((()=>{r.dispose()}))})),this.registerHookHub=t=>GM(this,void 0,void 0,(function*(){const{hookhubRegisterFn:n}=yield this.hookConfig.getConfig(),r=n(t);return e.Disposable.create((()=>{r.dispose()}))}))}};LM([Wn(PM),FM("design:type",PM)],BM.prototype,"hookConfig",void 0),BM=LM([Hn({contrib:AM})],BM);const zM={dispose:()=>null};const UM=e=>{const t=document.createElement("style");return t.setAttribute("type","text/css"),document.head.appendChild(t),t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),t};var VM,HM=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},WM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},$M=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.pluginId="base-graph-events"}(VM||(VM={}));let XM=class{constructor(){this.toDispose=new V_,this.registerHookHub=()=>$M(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{}))})),this.registerHook=t=>$M(this,void 0,void 0,(function*(){const n=new V_,r=[t.x6Events.registerHook({name:VM.pluginId,handler:e=>$M(this,void 0,void 0,(function*(){const{events:t}=yield this.graphOptions.getOptions();t.forEach((t=>{e.push(t)}))}))}),t.afterGraphInit.registerHook({name:VM.pluginId,handler:e=>$M(this,void 0,void 0,(function*(){const{commandService:r,modelService:i,graph:o}=e,s=yield t.x6Events.call([],(e=>$M(this,void 0,void 0,(function*(){return e.map((e=>{const t=t=>{e.callback(t,r,i)};return o.on(e.eventName,t),{dispose:()=>{o.off(e.eventName,t)}}}))}))));n.pushAll(s)}))}),t.afterGraphInit.registerHook({name:"add auto resize event",handler:t=>$M(this,void 0,void 0,(function*(){const{commandService:r}=t,i=function(e){let t;return()=>{t||(t=requestAnimationFrame((()=>{t=null,e()})))}}((()=>{r.executeCommand(e.XFlowGraphCommands.GRAPH_RESIZE.id,{})}));window.addEventListener("resize",i),n.push(e.Disposable.create((()=>{window.removeEventListener("resize",i)})))}))}),t.beforeGraphDestory.registerHook({name:VM.pluginId,handler:()=>$M(this,void 0,void 0,(function*(){n.dispose()}))})];return n.pushAll(r),n}))}};HM([Wn(dA),WM("design:type",Object)],XM.prototype,"graphOptions",void 0),XM=HM([Hn({contrib:AM})],XM);const YM=e=>rr((t=>{ir.register(t,AM),t(BM),t(XM),t(IM),t(PM,{useValue:e})}));class qM{constructor(){this.extensions=[],this.containerClassNames=new Set,this.addCoreModule=t=>(this.extensions.unshift(t),e.Disposable.create((()=>{this.removeExtension(t)}))),this.addExtension=t=>(this.extensions.push(t),e.Disposable.create((()=>{this.removeExtension(t)}))),this.removeExtension=e=>{const t=this.extensions.indexOf(e);t>-1&&this.extensions.splice(t,1)},this.getInstaceId=()=>this.instanceId,this.addContainerClassNames=e=>this.containerClassNames.add(e),this.getContainerClassNames=()=>Array.from(this.containerClassNames),this.getAllExtensions=()=>this.extensions,this.getAllExtensionConfigs=()=>this.extensions.map((e=>e.config)),this.instanceId=eS()}has(e){return this.extensions.some((t=>t.config.CONFIG_TYPE===e))}}const KM=a.default.createContext({}),ZM=()=>a.default.useContext(KM),JM=e=>{const t=ZM(),n=a.default.useMemo((()=>e.config?e.config:new PM),[]);return a.default.useEffect((()=>{const e=t.addCoreModule({config:n,createModule:YM});return()=>{e.dispose(),n.dispose()}}),[t,n]),null},QM=a.default.createContext({cell:null,x6Graph:null,commands:null,modelService:null});function eT(e,t,n){return function(r){const i=this,o=null==r?void 0:r.getData(),s=null==r?void 0:r.getSize(),l=null==r?void 0:r.getPosition();return a.default.createElement((()=>a.default.createElement(QM.Provider,{value:{cell:r,x6Graph:i,commands:t,modelService:n}},a.default.createElement(e,{cell:r,data:o,size:s,position:l}))),null)}}var tT=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},nT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},rT=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const iT=Symbol("IGraphProvider"),oT=Symbol("ICommandServiceProvider"),sT=Symbol("IModelServiceProvider");let aT=class{constructor(){this.toDisposce=new V_,this.graphMap=new Map,this.getGraph=t=>rT(this,void 0,void 0,(function*(){let n=this.graphMap.get(t);if(!n){n=new H_,this.graphMap.set(t,n);const r=yield this.optionProvider.getOptions(),i=this.hookService.hookProvider(),o=yield i.graphOptions.call(r.x6Options),{graphContainer:s,edgeRender:a,nodeRender:l,edgeTypeParser:c}=r,u=yield i.reactEdgeLabelRender.call(a);yield i.reactNodeRender.call(l);const{clientHeight:h,clientWidth:d}=s,f=yield this.commandServiceProvider.getCommandService(),p=yield this.modelServiceProvider.getModelService(),g=new y_(Object.assign(Object.assign({container:s,width:d,height:h},o),{onEdgeLabelRendered:e=>{const{edge:t,container:n}=e;this.renderEdgeReactLabel({edge:t,container:n,edgeRenderMap:u,edgeTypeParser:c,modelService:p,commandService:f})}}));yield i.afterGraphInit.call({graph:g,commandService:f,modelService:p}),n.resolve(g),g.on("node:moved",(({node:e})=>{const t=e.getData(),n=e.position();e.setData(Object.assign(Object.assign({},t),{x:null==n?void 0:n.x,y:null==n?void 0:n.y}))})),g.on("node:resized",(({node:e})=>{const t=e.getData(),n=e.size();e.setData(Object.assign(Object.assign({},t),{width:null==n?void 0:n.width,height:null==n?void 0:n.height}))})),this.toDisposce.push(e.Disposable.create((()=>rT(this,void 0,void 0,(function*(){yield i.beforeGraphDestory.call({graph:g,commandService:f,modelService:p}),this.graphMap.delete(t),g.dispose()})))))}return n.promise})),this.renderEdgeReactLabel=e=>rT(this,void 0,void 0,(function*(){const{container:t,edgeTypeParser:n,edge:r,edgeRenderMap:i,commandService:o,modelService:s}=e,l=n(null==r?void 0:r.data)||K_,u=i.get(l);if(u&&r&&(null==r?void 0:r.data)&&u){const e=this.edgeAppendForeignObject(r,t),n=function(e,t,n){return function(r){const i=this,o=null==r?void 0:r.getData();return a.default.createElement((()=>a.default.createElement(QM.Provider,{value:{cell:r,x6Graph:i,commands:t,modelService:n}},a.default.createElement(e,{data:o,cell:r}))),null)}}(u,o,s)(r);c.default.render(n,e)}}))}edgeAppendForeignObject(e,t){const n=Xg("foreignObject"),r=$g("body",Hg.xhtml),i=$g("div",Hg.xhtml),o=null==e?void 0:e.data,s=(null==o?void 0:o.edgeContentWidth)||100,a=(null==o?void 0:o.edgeContentHeigt)||30;return n.setAttribute("width",`${s}`),n.setAttribute("height",`${a}`),n.setAttribute("x",""+-1*s/2),n.setAttribute("y",""+-1*a/2),r.setAttribute("xhtmls",Hg.xhtml),r.style.width="100%",r.style.height="100%",r.style.padding="0",r.style.margin="0",r.style.background="unset",r.style.overflow="visible",r.className="xflow-edge-label-body",i.style.width="100%",i.style.height="100%",r.appendChild(i),n.appendChild(r),t.appendChild(n),i}dispose(){this.toDisposce.dispose()}};tT([Wn(dA),nT("design:type",Object)],aT.prototype,"optionProvider",void 0),tT([Wn(OM),nT("design:type",Object)],aT.prototype,"hookService",void 0),tT([Wn(oT),nT("design:type",Object)],aT.prototype,"commandServiceProvider",void 0),tT([Wn(sT),nT("design:type",Object)],aT.prototype,"modelServiceProvider",void 0),aT=tT([Hn()],aT);var lT,cT=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.CONFIG_TYPE="MODEL_SERVICE_CONFIG"}(lT||(lT={}));const uT=()=>e.Disposable.create((()=>{}));class hT{constructor(){this.CONFIG_TYPE=lT.CONFIG_TYPE,this.registerModelFn=uT,this.isMounted=new H_,this.registerModel=e=>{this.registerModelFn=e},this.setMountState=()=>{this.isMounted.resolve(!0)},this.getConfig=()=>cT(this,void 0,void 0,(function*(){return yield this.isMounted.promise,{CONFIG_TYPE:this.CONFIG_TYPE,modelRegisterFunc:this.registerModelFn||uT}})),this.dispose=()=>{this.registerModelFn=uT,this.isMounted=new H_}}}var dT=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},fT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},pT=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let gT=class{constructor(){this.toDispose=new V_,this.deferredModelMap=new Map,this.registerModel=t=>{const{id:n,getInitialValue:r,modelFactory:i}=t,o=new V_,s=this.ensureModel(n);if(s.isResolved)return void console.error(t,"model has been registerd");const a=r?r():e.NsModel.EMPTY_VALUE,l=i?i():new tM(a);return e.NsModel.isValidValue(a)&&s.resolve(l),t.watchChange&&t.watchChange(l,this).then((e=>{s.isResolved||s.resolve(l),this.toDispose.pushAll([e,o]),o.push(e)})),o},this.findDeferredModel=e=>this.deferredModelMap.get(e),this.awaitModel=e=>this.ensureModel(e).promise,this.registerRuntimeModel=()=>pT(this,void 0,void 0,(function*(){const{modelRegisterFunc:e}=yield this.modelOptionProvider.getOption(),t=yield this.graphProvider.getGraphInstance();e&&e(this,t)})),this.ensureModel=t=>{const n=this.deferredModelMap.get(t);if(n)return n;const r=new H_;return this.deferredModelMap.set(t,r),this.toDispose.push(e.Disposable.create((()=>this.deferredModelMap.delete(t)))),r}}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerModel(this);this.registerRuntimeModel()}onStop(){this.toDispose.dispose()}};dT([or(gM),fT("design:type",Object)],gT.prototype,"contributionProvider",void 0),dT([Wn(mM),fT("design:type",Object)],gT.prototype,"modelOptionProvider",void 0),dT([Wn(iT),fT("design:type",Object)],gT.prototype,"graphProvider",void 0),gT=dT([Hn({contrib:[nM,pM]})],gT);var mT=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const vT=e=>t=>mT(void 0,void 0,void 0,(function*(){return yield t.awaitModel(e)})),yT=e=>t=>mT(void 0,void 0,void 0,(function*(){return(yield t.awaitModel(e)).getValidValue()}));var bT,xT,wT,CT,ET,_T,ST,OT,AT,kT,MT,TT,PT,DT,NT,RT,IT,jT,LT,FT;!function(e){e.id="GRAPH_ENABLE_MULTI_SELECT",e.getModel=vT(e.id),e.useValue=yT(e.id)}(bT||(bT={})),function(e){e.id="IS_NODE_SELECTED",e.getModel=vT(e.id),e.useValue=yT(e.id)}(xT||(xT={})),function(e){e.id="IS_GROUP_SELECTED",e.getModel=vT(e.id),e.useValue=yT(e.id)}(wT||(wT={})),function(e){e.id="IS_NORMAL_NODES_SELECTED",e.getModel=vT(e.id),e.useValue=yT(e.id)}(CT||(CT={})),function(e){e.id="LAST_SELECTED_CELL",e.getModel=vT(e.id),e.useValue=yT(e.id)}(ET||(ET={})),function(e){e.id="SELECTED_CELLS",e.getModel=vT(e.id),e.useValue=yT(e.id)}(_T||(_T={})),function(e){e.id="LAST_SELECTED_NODE",e.getModel=vT(e.id),e.useValue=yT(e.id)}(ST||(ST={})),function(e){e.id="SELECTED_NODES",e.getModel=vT(e.id),e.useValue=yT(e.id)}(OT||(OT={})),function(e){e.id="SELECTED_EDGES",e.getModel=vT(e.id),e.useValue=yT(e.id)}(AT||(AT={})),function(e){e.id="SELECTED_GROUPS",e.getModel=vT(e.id),e.useValue=yT(e.id)}(kT||(kT={})),function(e){e.id="CONTEXTMENU_NODE",e.getModel=vT(e.id),e.useValue=yT(e.id)}(MT||(MT={})),function(e){e.id="CONTEXTMENU_EDGE",e.getModel=vT(e.id),e.useValue=yT(e.id)}(TT||(TT={})),function(e){e.id="CONTEXTMENU_TARGET",e.getModel=vT(e.id),e.useValue=yT(e.id)}(PT||(PT={})),function(e){e.id="GRAPH_META",e.getModel=vT(e.id),e.useValue=yT(e.id)}(DT||(DT={})),function(e){e.id="GRAPH_SCALE",e.getModel=vT(e.id),e.useValue=yT(e.id)}(NT||(NT={})),function(e){e.id="COMMAND_REDOABLE",e.getModel=vT(e.id),e.useValue=yT(e.id)}(RT||(RT={})),function(e){e.id="COMMAND_UNDOABLE",e.getModel=vT(e.id),e.useValue=yT(e.id)}(IT||(IT={})),function(e){e.id="COMMAND_GLOBALS",e.getModel=vT(e.id),e.useValue=yT(e.id)}(jT||(jT={})),function(e){e.id="HISTORY_UNDOABLE",e.getModel=vT(e.id),e.useValue=yT(e.id)}(LT||(LT={})),function(e){e.id="HISTORY_REDOABLE",e.getModel=vT(e.id),e.useValue=yT(e.id)}(FT||(FT={}));var GT=Object.freeze({__proto__:null,isModelExistUtil:e=>t=>{const n=t.findDeferredModel(e);return!(!n||!n.promise)},getModelUtil:vT,useModelValueUtil:yT,get GRAPH_ENABLE_MULTI_SELECT(){return bT},get IS_NODE_SELECTED(){return xT},get IS_GROUP_SELECTED(){return wT},get IS_NORMAL_NODES_SELECTED(){return CT},get SELECTED_CELL(){return ET},get SELECTED_CELLS(){return _T},get SELECTED_NODE(){return ST},get SELECTED_NODES(){return OT},get SELECTED_EDGES(){return AT},get SELECTED_GROUPS(){return kT},get CONTEXTMENU_NODE(){return MT},get CONTEXTMENU_EDGE(){return TT},get CONTEXTMENU_TARGET(){return PT},get GRAPH_META(){return DT},get GRAPH_SCALE(){return NT},get COMMAND_REDOABLE(){return RT},get COMMAND_UNDOABLE(){return IT},get COMMAND_GLOBALS(){return jT},get HISTORY_UNDOABLE(){return LT},get HISTORY_REDOABLE(){return FT}}),BT=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},zT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},UT=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let VT=class{registerModel(e){e.registerModel({id:RT.id,getInitialValue:()=>this.commands.isRedoable,watchChange:e=>UT(this,void 0,void 0,(function*(){return this.commands.watchChange((()=>{e.setValue(this.commands.isRedoable)}))}))}),e.registerModel({id:IT.id,getInitialValue:()=>this.commands.isUndoable,watchChange:e=>UT(this,void 0,void 0,(function*(){return this.commands.watchChange((()=>{e.setValue(this.commands.isUndoable)}))}))}),e.registerModel({id:jT.id,modelFactory:()=>this.commands.Globals})}};BT([Wn(rM),zT("design:type",Object)],VT.prototype,"commands",void 0),VT=BT([Hn({contrib:gM})],VT);const HT=(t,n,r)=>(t.on(n,r),e.Disposable.create((()=>{t.off(n,r)})));var WT=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},$T=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},XT=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let YT=class{constructor(){this.getGraphInstance=()=>XT(this,void 0,void 0,(function*(){return{graph:yield this.graphProvider.getGraphInstance(),config:yield this.graphProvider.getGraphOptions()}}))}registerModel(t){t.registerModel({id:DT.id,getInitialValue:()=>({flowId:"-1"}),watchChange:t=>XT(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{t.setValue({flowId:"-1"})}))}))}),t.registerModel({id:bT.id,getInitialValue:()=>({isEnable:!1}),watchChange:t=>XT(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{t.setValue({isEnable:!1})}))}))}),t.registerModel({id:_T.id,getInitialValue:()=>[],watchChange:t=>XT(this,void 0,void 0,(function*(){const{graph:n}=yield this.getGraphInstance(),r=e=>{const{selected:n}=e;t.setValue(n)};return n.on("selection:changed",r),e.Disposable.create((()=>n.off("selection:changed",r)))}))}),t.registerModel({id:ET.id,watchChange:(e,t)=>XT(this,void 0,void 0,(function*(){return(yield _T.getModel(t)).watch(((t=[])=>{e.setValue([...t].pop()||null)}))}))}),t.registerModel({id:OT.id,getInitialValue:()=>[],watchChange:(e,t)=>XT(this,void 0,void 0,(function*(){return(yield _T.getModel(t)).watch(((t=[])=>{const n=t.filter((e=>e.isNode()));e.setValue(n)}))}))}),t.registerModel({id:ST.id,watchChange:(e,t)=>XT(this,void 0,void 0,(function*(){return(yield OT.getModel(t)).watch((t=>{e.setValue([...t].pop()||null)}))}))}),t.registerModel({id:xT.id,watchChange:(e,t)=>XT(this,void 0,void 0,(function*(){return(yield OT.getModel(t)).watch((t=>{e.setValue(t.length>0)}))}))}),t.registerModel({id:wT.id,getInitialValue:()=>!1,watchChange:(e,t)=>XT(this,void 0,void 0,(function*(){return(yield _T.getModel(t)).watch((t=>{const n=t.every((e=>e&&!0===e.getProp("isGroup")));e.setValue(n)}))}))}),t.registerModel({id:kT.id,getInitialValue:()=>[],watchChange:(e,t)=>XT(this,void 0,void 0,(function*(){return(yield OT.getModel(t)).watch((t=>{const n=t.filter((e=>e&&!0===e.getProp("isGroup")));e.setValue(n)}))}))}),t.registerModel({id:CT.id,getInitialValue:()=>!1,watchChange:(e,t)=>XT(this,void 0,void 0,(function*(){return(yield _T.getModel(t)).watch((t=>{const n=t.every((e=>{const t=!(e&&e.getProp("isGroup")),n=!(e&&e.getProp("group"));return t&&n})),r=t.length>0&&n;e.setValue(r)}))}))}),t.registerModel({id:NT.id,getInitialValue:()=>({zoomFactor:-1}),watchChange:t=>XT(this,void 0,void 0,(function*(){const{graph:n}=yield this.getGraphInstance(),r=e=>{const r=n.zoom();t.setValue(Object.assign(Object.assign({},e),{zoomFactor:r}))};return n.on("scale",r),e.Disposable.create((()=>n.off("scale",r)))}))}),t.registerModel({id:PT.id,watchChange:e=>XT(this,void 0,void 0,(function*(){const{graph:t,config:n}=yield this.getGraphInstance(),r=r=>i=>{const{x:o,y:s}=i,a=t.localToClient({x:o,y:s}),l=n.rootContainer.getBoundingClientRect(),c={x:a.x-((null==l?void 0:l.x)||0),y:a.y-((null==l?void 0:l.y)||0)};e.setValue({type:r,anchor:c,data:i,cell:i.cell})},i=new V_;return i.pushAll([HT(t,"node:contextmenu",r("node")),HT(t,"edge:contextmenu",r("edge")),HT(t,"blank:contextmenu",r("blank"))]),i}))}),t.registerModel({id:FT.id,getInitialValue:()=>!1,watchChange:t=>XT(this,void 0,void 0,(function*(){const{graph:n}=yield this.getGraphInstance(),r=()=>{const e=n.history.canRedo();t.setValue(e)};return n.history&&n.history.on("change",r),e.Disposable.create((()=>n.history.off("change",r)))}))}),t.registerModel({id:LT.id,getInitialValue:()=>!1,watchChange:t=>XT(this,void 0,void 0,(function*(){const{graph:n}=yield this.getGraphInstance(),r=()=>{const e=n.history.canUndo();t.setValue(e)};return n.history&&n.history.on("change",r),e.Disposable.create((()=>n.history.off("change",r)))}))})}};WT([Wn(iT),$T("design:type",Object)],YT.prototype,"graphProvider",void 0),YT=WT([Hn({contrib:gM})],YT);var qT=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const KT=rr((e=>{ir.register(e,gM),e(gT),e(YT),e(VT)})),ZT=e=>rr((t=>{((e,t)=>{e({token:mM,useDynamic:()=>({getOption:()=>qT(void 0,void 0,void 0,(function*(){return t.getConfig()}))}),lifecycle:Sn.Lifecycle.singleton})})(t,e)})),JT=e=>{const{config:t}=e,n=ZM(),r=a.default.useMemo((()=>t||new hT),[]);return a.default.useEffect((()=>{const e=n.addCoreModule({config:r,createModule:ZT});return r.setMountState(),()=>{e.dispose(),r.dispose()}}),[]),null};JT.defaultProps={XFlowModuleType:"ModelServiceConfig"};const QT=e=>{const t=[],n=[],r=e=>{e.isNode()&&t.push((e=>{const t=e.getChildren(),n=e.getSize(),r=e.getData()||{},i=e.getPosition(),o=e.getParentId(),{isCollapsed:s}=r,a=r.groupCollapsedSize||(s?n:null);return Object.assign(Object.assign({},r),{id:e.id,width:n.width,height:n.height,x:i.x,y:i.y,group:o,groupChildren:t?t.map((e=>e.id)):null,groupCollapsedSize:a})})(e)),e.isEdge()&&n.push((e=>{const t=e.getData()||{};return Object.assign({id:e.id},t)})(e))};return e.map((e=>r(e))),{nodes:t,edges:n}};var eP=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},tP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},nP=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};e.IApplication=class{constructor(){this.getGraphData=()=>nP(this,void 0,void 0,(function*(){const e=(yield this.graphProvider.getGraphInstance()).getCells();return QT(e)}))}start(){return nP(this,void 0,void 0,(function*(){yield this.startContributions(),this.registerEventListeners()}))}getGraphInstance(){return this.graphProvider.getGraphInstance()}getGraphConfig(){return this.graphProvider.getGraphOptions()}getAllNodes(){return nP(this,void 0,void 0,(function*(){return(yield this.graphProvider.getGraphInstance()).getNodes()}))}getNodeById(e){return nP(this,void 0,void 0,(function*(){return(yield this.graphProvider.getGraphInstance()).getCellById(e)}))}getAllEdges(){return nP(this,void 0,void 0,(function*(){return(yield this.graphProvider.getGraphInstance()).getEdges()}))}getEdgeById(e){return nP(this,void 0,void 0,(function*(){return(yield this.graphProvider.getGraphInstance()).getCellById(e)}))}updateNodeAttrs(e,t){return nP(this,void 0,void 0,(function*(){if(e instanceof hC)e.setAttrs(t);else{(yield this.getNodeById(e)).setAttrs(t)}}))}updateEdgeAttrs(e,t){return nP(this,void 0,void 0,(function*(){if(e instanceof wC)e.setAttrs(t);else{(yield this.getEdgeById(e)).setAttrs(t)}}))}translateGraph(e,t){return nP(this,void 0,void 0,(function*(){const n=yield this.graphProvider.getGraphInstance(),r=n.translate();n.translate(r.tx+e,r.ty+t)}))}executeCommand(e,t,n=[]){return this.commandService.executeCommand(e,t,n)}executeCommandPipeline(e){return this.commandService.executeCommandPipeline(e)}registerEventListeners(){window.addEventListener("unload",(()=>{this.stopContributions()}))}startContributions(){return nP(this,void 0,void 0,(function*(){console.log(this.contributions.getContributions());for(const e of this.contributions.getContributions())if(e.onStart)try{yield this.measure(`${e.constructor.name}.onStart`,(()=>e.onStart(this)))}catch(e){console.error("Could not start contribution",e)}}))}stopContributions(){console.info(">>> Stopping frontend contributions...");for(const e of this.contributions.getContributions())if(e.onStop)try{e.onStop(this)}catch(e){console.error("Could not stop contribution",e)}console.info("<<< All frontend contributions have been stopped.")}measure(e,t){return nP(this,void 0,void 0,(function*(){const n=`${e}-start`,r=`${e}-end`;performance.mark(n);const i=yield t();performance.mark(r),performance.measure(e,n,r);for(const t of performance.getEntriesByName(e)){const e=`Frontend ${t.name}`;t.duration>100?console.warn(`${e} is slow, took: ${t.duration.toFixed(1)} ms`):console.debug(`${e} took: ${t.duration.toFixed(1)} ms`)}return performance.clearMeasures(e),i}))}},eP([or(nM),tP("design:type",Object)],e.IApplication.prototype,"contributions",void 0),eP([Wn(iT),tP("design:type",Object)],e.IApplication.prototype,"graphProvider",void 0),eP([Wn(rM),tP("design:type",Object)],e.IApplication.prototype,"commandService",void 0),eP([Wn(pM),tP("design:type",Object)],e.IApplication.prototype,"modelService",void 0),e.IApplication=eP([Hn()],e.IApplication);const rP=rr((t=>{ir.register(t,nM),t(e.IApplication)})),iP=a.default.createContext({configProvider:null}),oP=e=>{const t=a.default.useContext(iP);return a.default.useMemo((()=>t.configProvider?t.configProvider.getXflowPrefixCls(e):`xflow-${e}`),[e])};var sP=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};function aP(e){const{createModule:t,children:n}=e,r=ZM(),i=a.default.useMemo((()=>e.config||{CONFIG_TYPE:"",getConfig:()=>sP(this,void 0,void 0,(function*(){return{}}))}),[]);return a.default.useEffect((()=>{const e=r.addExtension({config:i,createModule:t});return()=>{e.dispose()}}),[]),Array.isArray(n)||a.default.isValidElement(n)?a.default.createElement(a.default.Fragment,null," ",n," "):null}const lP=(e={})=>t.useMemo((()=>{const t=Object.entries(e),n=t.length>0?{position:"absolute"}:{};return t.forEach((([e,t=0])=>{n[e]=`${t}px`})),n}),[e]),cP=e=>rr((t=>{(e=>{e(aT),e(iT,{lifecycle:Sn.Lifecycle.singleton,useDynamic:e=>({getGraphInstance:()=>rT(void 0,void 0,void 0,(function*(){const t=e.container.get(aT),n=e.container.get(dA),r=yield null==n?void 0:n.getOptions();return yield null==t?void 0:t.getGraph(r.graphId)})),getGraphOptions:()=>rT(void 0,void 0,void 0,(function*(){const t=e.container.get(dA);return null==t?void 0:t.getOptions()}))})}),e(oT,{lifecycle:Sn.Lifecycle.singleton,useDynamic:e=>({getCommandService:()=>rT(void 0,void 0,void 0,(function*(){return e.container.get(rM)}))})}),e(sT,{lifecycle:Sn.Lifecycle.singleton,useDynamic:e=>({getModelService:()=>rT(void 0,void 0,void 0,(function*(){return e.container.get(pM)}))})})})(t),((e,t)=>{e(dA,{lifecycle:Sn.Lifecycle.singleton,useDynamic:()=>({getOptions:()=>uA(void 0,void 0,void 0,(function*(){return t.getConfig()}))})})})(t,e)})),uP=tC({type:"react componnet"});y_.registerReactComponent=uP.register,y_.unregisterReactComponent=uP.unregister,y_.Hook.prototype.getReactComponent=function(e){const t=this.options.getReactComponent;if("function"==typeof t){const n=Tg(t,this.graph,e);if(null!=n)return n}let n=e.getComponent();if("string"==typeof n){const e=uP.get(n);if(null==e)return uP.onNotFound(n);n=e}return n};class hP extends hC{get component(){return this.getComponent()}set component(e){this.setComponent(e)}getComponent(){return this.store.get("component")}setComponent(e,t={}){return null==e?this.removeComponent(t):this.store.set("component",e,t),this}removeComponent(e={}){return this.store.remove("component",e),this}}var dP;!function(e){function t(e,t,n="rect"){const r=[],i=t?yx.getForeignObjectMarkup():{tagName:"g",selector:"content"};return e?r.push(i):r.push({tagName:n,selector:"body"},i,{tagName:"text",selector:"label"}),r}e.config({view:"react-shape-view",markup:t(!1,!0),attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"},label:{fontSize:14,fill:"#333",refX:"50%",refY:"50%",textAnchor:"middle",textVerticalAnchor:"middle"}},propHooks(e){if(null==e.markup){const n=e.primer,r=!1!==e.useForeignObject;if(n&&"rect"!==n){e.markup=t(!1,r,n);let i={};"circle"===n?i={refCx:"50%",refCy:"50%",refR:"50%"}:"ellipse"===n&&(i={refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}),e.attrs=rd({},{body:Object.assign({refWidth:null,refHeight:null},i)},e.attrs||{})}else e.simple&&(e.markup=t(!0,r),e.attrs=rd({},{body:null,label:null},e.attrs||{}))}return e}}),hC.registry.register("react-shape",e,!0)}(hP||(hP={})),function(e){let n,r=!1;const i=(e,t)=>{const n=t.payload;switch(t.type){case"add":{const t=e.findIndex((e=>e.id===n.id));return t>=0?(e[t]=n,[...e]):[...e,n]}case"remove":{const t=e.findIndex((e=>e.id===n.id));if(t>=0){const n=[...e];return n.splice(t,1),n}break}}return e};e.connect=function(e,t){r&&n({type:"add",payload:{id:e,portal:t}})},e.disconnect=function(e){r&&n({type:"remove",payload:{id:e}})},e.isActive=function(){return r},e.getProvider=function(){return()=>{r=!0;const[e,o]=t.useReducer(i,[]);return n=o,a.default.createElement(a.default.Fragment,{children:e.map((e=>e.portal))})}}}(dP||(dP={}));class fP extends a.default.PureComponent{constructor(e){super(e),this.scheduledAnimationFrame=!1,this.throttleUpdateFunc=()=>{this.scheduledAnimationFrame||(this.scheduledAnimationFrame=!0,window.requestAnimationFrame((()=>{this.setState((e=>(this.scheduledAnimationFrame=!1,{tick:e.tick+1})))})))},this.onChange=e=>{fP.throttleChangeTypes.includes(e.key)?this.throttleUpdateFunc():this.setState({tick:this.state.tick+1})},this.state={tick:0}}componentDidMount(){this.props.node.on("change:*",this.onChange)}componentWillUnmount(){this.props.node.off("change:*",this.onChange)}clone(e){const{node:t}=this.props;return"string"==typeof e.type?a.default.cloneElement(e):a.default.cloneElement(e,{node:t})}render(){const{graph:e,node:t,component:n}=this.props;if(a.default.isValidElement(n))return this.clone(n);if("function"==typeof n){const r=Tg(n,e,t);if(a.default.isValidElement(r))return this.clone(r)}return n}}fP.throttleChangeTypes=["position","size"];var pP=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};class gP extends _C{init(){super.init(),this.cell.on("removed",(()=>{dP.disconnect(this.cell.id)}))}getComponentContainer(){return!1===this.cell.prop("useForeignObject")?this.selectors.content:this.selectors.foContent}confirmUpdate(e){const t=super.confirmUpdate(e);return this.handleAction(t,gP.action,(()=>{Gv?Gv.scheduleTask((()=>{this.renderReactComponent()})):this.renderReactComponent()}))}renderReactComponent(){this.unmountReactComponent();const e=this.getComponentContainer(),t=this.cell,n=this.graph;if(e){const r=this.graph.hook.getReactComponent(t),i=a.default.createElement(fP,{graph:n,node:t,component:r});dP.isActive()?dP.connect(this.cell.id,c.default.createPortal(i,e)):c.default.render(i,e)}}unmountReactComponent(){const e=this.getComponentContainer();return e&&c.default.unmountComponentAtNode(e),e}onMouseDown(e,t,n){const r=e.target;if("input"===r.tagName.toLowerCase()){const e=r.getAttribute("type");if(null==e||["text","password","number","email","search","tel","url"].includes(e))return}super.onMouseDown(e,t,n)}dispose(){dP.disconnect(this.cell.id),this.unmountReactComponent()}}pP([_C.dispose()],gP.prototype,"dispose",null),function(e){e.action="react",e.config({bootstrap:[e.action],actions:{component:e.action}}),_C.registry.register("react-shape-view",e,!0)}(gP||(gP={}));var mP=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};const vP="react";function yP(e){const n={current:()=>{}};let r,i;function o(e){i(e)}class s extends _C{init(){super.init(),this.cell.on("removed",(()=>{o(this.cell.id)}))}getComponentContainer(){return!1===this.cell.prop("useForeignObject")?this.selectors.content:this.selectors.foContent}confirmUpdate(e){const t=super.confirmUpdate(e);return this.handleAction(t,vP,(()=>this.renderReactComponent()))}renderReactComponent(){this.unmountReactComponent();const e=this.getComponentContainer(),t=this.cell,n=this.graph;if(e){const i=this.graph.hook.getReactComponent(t),o=a.default.createElement(fP,{graph:n,node:t,component:i});!function(e,t){r({id:e,portal:t})}(this.cell.id,c.default.createPortal(o,e))}}unmountReactComponent(){const e=this.getComponentContainer();return e&&c.default.unmountComponentAtNode(e),e}onMouseDown(e,t,n){const r=e.target;if("input"===r.tagName.toLowerCase()){const e=r.getAttribute("type");if(null==e||["text","password","number","email","search","tel","url"].includes(e))return}super.onMouseDown(e,t,n)}dispose(){o(this.cell.id),this.unmountReactComponent()}}return mP([_C.dispose()],s.prototype,"dispose",null),s.config({bootstrap:[vP],actions:{component:vP}}),_C.registry.register(e,s,!0),{Portal:()=>{const[e,o]=t.useState([]),[s,l]=t.useState(),c=t.useRef([]),u=t.useRef([]);n.current=l;const h=t.useCallback((e=>{const{id:t}=e;if(c.current.includes(t)){const n=u.current,r=n.findIndex((e=>e.id===t));r>-1?n[r]=e:n.push(e),u.current=n}else o((n=>{const r=[...n],i=r.findIndex((e=>e.id===t));return i>-1?r[i]=e:r.push(e),r}))}),[]);r=h;const d=t.useCallback((e=>{c.current.includes(e)&&(c.current=c.current.filter((t=>t!==e))),u.current.map((e=>e.id)).includes(e)&&(u.current=u.current.filter((t=>t.id!==e))),o((t=>t.filter((t=>t.id!==e))))}),[]);i=d;const f=t.useCallback((e=>{const{name:t,data:n}=e,{cells:r=[]}=n||{};if("add"===t){const e=r.filter((e=>e.isNode())).map((e=>e.id));c.current=Array.from(new Set([...c.current,...e]))}}),[]),p=t.useCallback((({name:e})=>{if("add"===e){const e=u.current;if(e.length){const t=e.map((e=>e.id));c.current=c.current.filter((e=>!t.includes(e))),u.current=[],o((t=>{const n=[...t];return e.forEach((e=>{const t=n.findIndex((t=>t.id===e.id));t>-1?n[t]=e:n.push(e)})),n}))}}}),[]);return t.useLayoutEffect((()=>(s&&(s.on("batch:start",f),s.on("batch:stop",p)),()=>{s&&(s.off("batch:start",f),s.off("batch:stop",p),o([]),c.current=[],u.current=[])})),[s,f,p]),a.default.createElement(a.default.Fragment,null,...e.map((e=>e.portal)))},setGraph:e=>{n.current(e)}}}var bP=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const xP=e=>{const n=eA(),r=a.default.useRef(null),i=a.default.useRef(null),o=ZM(),s=a.default.useMemo((()=>{const t=e.config?e.config:new hA;return t.setX6Config(),t}),[]),[l,c]=function(e){const n=t.useRef(!1),[r]=t.useState((()=>n.current?{}:(n.current=!0,yP(e))));return[r.Portal,r.setGraph]}(s.graphId);a.default.useEffect((()=>{n&&n.getGraphInstance().then((e=>{c(e)}))}),[n,c]),a.default.useEffect((()=>{s.setRootContainer(r.current),s.setGraphContainer(i.current),s.xflowInstanceId=o.getInstaceId(),o.addCoreModule({config:s,createModule:cP});return()=>{bP(void 0,void 0,void 0,(function*(){s.dispose()}))}}),[]);const u=lP(e.position),h=oP("canvas-root"),d=oP("x6-canvas");return a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{ref:r,className:h,style:u,id:s.graphId,tabIndex:0},a.default.createElement("div",{ref:i,className:d}),e.children),a.default.createElement(l,null))};xP.defaultProps={isXFlowCanvas:!0};var wP=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},CP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},EP=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let _P=class{constructor(){this.toDispose=new V_,this.runtimeHooks=[],this.getX6Graph=()=>EP(this,void 0,void 0,(function*(){if(this.graph)return this.graph;const e=yield this.graphProvider.getGraphInstance();return this.graph=e,e})),this.getGraphConfig=()=>EP(this,void 0,void 0,(function*(){return this.graphProvider.getGraphOptions()})),this.getGraphMeta=()=>EP(this,void 0,void 0,(function*(){const e=this.getModelService();return this.graphMeta||(yield DT.useValue(e))})),this.setArgs=(e,t=[])=>(this.args=e,this.runtimeHooks=t,{args:e,hooks:t}),this.getArgs=()=>({args:Object.assign(Object.assign({},this.args),{modelService:this.getModelService(),commandService:this.getCommands(),getGraphMeta:this.getGraphMeta,getX6Graph:this.getX6Graph,getGraphConfig:this.getGraphConfig}),hooks:this.runtimeHooks}),this.setResult=e=>(this.result=e,this.result),this.getResult=()=>this.result,this.getHooks=()=>this.hookService.hookProvider(),this.getCommands=()=>this.commandService,this.getModelService=()=>this.modelService,this.addUndo=e=>{if(!Array.isArray(e))return this.addUndo([e]);this.toDispose.pushAll(e)},this.undo=()=>EP(this,void 0,void 0,(function*(){yield this.toDispose.dispose()})),this.isUndoable=()=>!this.toDispose.disposed,this.getDisposables=()=>this.toDispose,this.setGlobal=(e,t)=>{this.commandService.setGlobal(e,t)},this.getGlobal=e=>this.commandService.getGlobal(e)}init(){this.getGraphMeta().then((e=>{this.graphMeta=e}))}};wP([Wn(iT),CP("design:type",Object)],_P.prototype,"graphProvider",void 0),wP([Wn(OM),CP("design:type",Object)],_P.prototype,"hookService",void 0),wP([Wn(rM),CP("design:type",Object)],_P.prototype,"commandService",void 0),wP([Wn(pM),CP("design:type",Object)],_P.prototype,"modelService",void 0),wP([f.postConstruct(),CP("design:type",Function),CP("design:paramtypes",[]),CP("design:returntype",void 0)],_P.prototype,"init",null),_P=wP([Vn()],_P);var SP=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const OP=()=>[];class AP{constructor(){this.setCommandContributions=e=>{this.getContributions=e},this.getCommandContributions=()=>this.getContributions(),this.registerHook=e=>SP(this,void 0,void 0,(function*(){return this.registerHookFn?this.registerHookFn(e):zM})),this.registerHookHub=e=>SP(this,void 0,void 0,(function*(){return this.registerHookHubFn?this.registerHookHubFn(e):zM})),this.CONFIG_TYPE="CommandConfig",this.setRegisterHookFn=e=>{this.registerHookFn=e},this.setRegisterHookHubFn=e=>{this.registerHookHubFn=e},this.getConfig=()=>SP(this,void 0,void 0,(function*(){return{registerHookFn:this.registerHookFn,getContributions:this.getContributions,CONFIG_TYPE:this.CONFIG_TYPE}})),this.getContributions=OP}}var kP,MP=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},TP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},PP=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowNodeCommands.ADD_NODE,t.hookKey="addNode"}(kP||(kP={}));let DP=class{constructor(){this.execute=()=>PP(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks(),o=yield i.addNode.call(n,(n=>PP(this,void 0,void 0,(function*(){const{createNodeService:r,cellFactory:i,commandService:o}=n,s=yield t.getX6Graph(),a=r?yield r(n):n.nodeConfig,l=yield this.processNodeConfig(a);let c;if(i){const e=yield i(l,this);c=s.addNode(e)}else c=s.addNode(l);return t.addUndo(e.Disposable.create((()=>PP(this,void 0,void 0,(function*(){const t=Object.assign({id:c.id},c.getData());o.executeCommand(e.XFlowNodeCommands.DEL_NODE.id,{nodeConfig:t})}))))),{nodeConfig:l,nodeCell:c}}))),r);return t.setResult(o),this})),this.processNodeConfig=e=>PP(this,void 0,void 0,(function*(){const t=this.contextProvider();if(e.data=Object.assign({},e),e.shape)return e;if(!e.view){const n=yield t.getGraphConfig();e.view=n.graphId}if(!e.component){const n=yield this.getNodeReactComponent(e),r=t.getCommands(),i=t.getModelService();e.shape="react-shape",e.component=eT(n,r,i)}return e})),this.getNodeReactComponent=e=>PP(this,void 0,void 0,(function*(){const t=this.contextProvider(),n=t.getHooks(),r=yield t.getGraphConfig(),i=yield n.reactNodeRender.call(r.nodeRender),o=r.nodeTypeParser(e)||Y_,s=i.get(o);return s||console.error("react node component is missing:",r.nodeRender,o,s),s})),this.undo=()=>PP(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>PP(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};MP([Wn(oM),TP("design:type",Object)],DP.prototype,"contextProvider",void 0),DP=MP([Vn({token:{token:iM,named:kP.command.id}})],DP);var NP,RP=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},IP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},jP=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowNodeCommands.DEL_NODE,t.hookKey="delNode",t.createHook=()=>new SM}(NP||(NP={}));let LP=class{constructor(){this.execute=()=>jP(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks(),o=yield i.delNode.call(n,(n=>jP(this,void 0,void 0,(function*(){const{commandService:r,deleteNodeService:i}=n,o=yield t.getX6Graph();if(i){if(!(yield i(n)))return{err:" service rejected"}}const s=(n.x6Node||n.nodeConfig).id,a=o.getCellById(s);if(a&&a.isNode()){const n=[...o.getIncomingEdges(a)||[],...o.getOutgoingEdges(a)||[]];yield Promise.all(n.map((t=>r.executeCommand(e.XFlowEdgeCommands.DEL_EDGE.id,{x6Edge:t}))));const i=a.getData();return a.remove(),t.addUndo(e.Disposable.create((()=>jP(this,void 0,void 0,(function*(){yield r.executeCommand(e.XFlowNodeCommands.ADD_NODE.id,{nodeConfig:i})}))))),{err:null,nodeConfig:i}}return{err:"node is not exist"}}))),r);return t.setResult(o),this})),this.undo=()=>jP(this,void 0,void 0,(function*(){if(this.isUndoable()){this.contextProvider().undo()}return this})),this.redo=()=>jP(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};RP([Wn(oM),IP("design:type",Object)],LP.prototype,"contextProvider",void 0),LP=RP([Vn({token:{token:iM,named:NP.command.id}})],LP);var FP,GP=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},BP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},zP=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowNodeCommands.SELECT_NODE,t.hookKey="selectNode"}(FP||(FP={}));let UP=class{constructor(){this.execute=()=>zP(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),r=this.ctx.getHooks(),i=yield r.selectNode.call(t,(t=>zP(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),r=n.getSelectedCells().map((e=>e.id)),{nodeIds:i,resetSelection:o,commandService:s}=t;return o?n.resetSelection(i):n.select(i),this.ctx.addUndo({dispose:()=>{s.executeUndoCommand(e.XFlowNodeCommands.SELECT_NODE.id,{nodeIds:r,resetSelection:!0})}}),{}}))),n);return this.ctx.setResult(i),this})),this.undo=()=>zP(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>zP(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};GP([Wn(oM),BP("design:type",Object)],UP.prototype,"contextProvider",void 0),GP([f.postConstruct(),BP("design:type",Function),BP("design:paramtypes",[]),BP("design:returntype",void 0)],UP.prototype,"init",null),UP=GP([Vn({token:{token:iM,named:FP.command.id}})],UP);var VP,HP=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},WP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},$P=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowNodeCommands.MOVE_NODE,t.hookKey="moveNode",t.createHook=()=>new SM}(VP||(VP={}));let XP=class{constructor(){this.execute=()=>$P(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks(),o=yield i.moveNode.call(n,(n=>$P(this,void 0,void 0,(function*(){const{nodePositionService:r}=n;if(r){if(!(yield r(n)))return{err:"service rejected"}}const{dx:i=0,dy:o=0,x:s,y:a,duration:l=150}=n.position,c=(yield t.getX6Graph()).getCellById(n.id);if(c){let n=s,r=a;const{x:u,y:h}=c.position();let d=()=>{c.position(u,h,{silent:!1})};return i||o?(n=i+u,r=o+h,c.translate(i,o,{transition:{duration:l}}),d=()=>c.translate(-i,-o,{transition:{duration:l}})):c.position(n,r,{silent:!1}),t.addUndo(e.Disposable.create((()=>{d()}))),{err:null,nextX:n,nextY:r}}}))),r);return t.setResult(o),this})),this.undo=()=>$P(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>$P(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};HP([Wn(oM),WP("design:type",Object)],XP.prototype,"contextProvider",void 0),XP=HP([Vn({token:{token:iM,named:VP.command.id}})],XP);var YP,qP=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},KP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ZP=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowNodeCommands.UPDATE_NODE,t.hookKey="updateNode",t.XFlowNodeSetOptions={overwrite:!0},t.NODE_WIDTH=200,t.NODE_HEIGHT=40}(YP||(YP={}));let JP=class{constructor(){this.execute=()=>ZP(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),r=yield n.updateNode.call(e,(e=>ZP(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{nodeConfig:n,options:r=YP.XFlowNodeSetOptions}=e,i=null==t?void 0:t.getCellById(null==n?void 0:n.id);return i.setData(n,r),i.setPosition((null==n?void 0:n.x)||0,(null==n?void 0:n.y)||0),i.setSize((null==n?void 0:n.width)||YP.NODE_WIDTH,(null==n?void 0:n.height)||YP.NODE_HEIGHT),i instanceof hP||!i.getAttrByPath("text/text")||i.setAttrByPath("text/text",n.label),n.attrs&&i.setAttrs(n.attrs),{nodeConfig:n,nodeCell:i}}))),t);return this.ctx.setResult(r),this})),this.undo=()=>ZP(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>ZP(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};qP([Wn(oM),KP("design:type",Object)],JP.prototype,"contextProvider",void 0),qP([f.postConstruct(),KP("design:type",Function),KP("design:paramtypes",[]),KP("design:returntype",void 0)],JP.prototype,"init",null),JP=qP([Vn({token:{token:iM,named:YP.command.id}})],JP);var QP,eD=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},tD=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},nD=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowNodeCommands.CENTER_NODE,t.hookKey="centerNode"}(QP||(QP={}));let rD=class{constructor(){this.execute=()=>nD(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),r=yield n.centerNode.call(e,(e=>nD(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{nodeConfig:n}=e,r=null==t?void 0:t.getCellById(null==n?void 0:n.id);return null==t||t.centerCell(r),{x6Node:r}}))),t);return this.ctx.setResult(r),this})),this.undo=()=>nD(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>nD(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};eD([Wn(oM),tD("design:type",Object)],rD.prototype,"contextProvider",void 0),eD([f.postConstruct(),tD("design:type",Function),tD("design:paramtypes",[]),tD("design:returntype",void 0)],rD.prototype,"init",null),rD=eD([Vn({token:{token:iM,named:QP.command.id}})],rD);var iD,oD=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},sD=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},aD=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowNodeCommands.FRONT_NODE,t.hookKey="frontNode"}(iD||(iD={}));let lD=class{constructor(){this.execute=()=>aD(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks(),o=yield i.frontNode.call(n,(n=>aD(this,void 0,void 0,(function*(){const r=yield this.ctx.getX6Graph(),{nodeId:i}=n,o=null==r?void 0:r.getCellById(i);return o?(o.toFront(),t.addUndo(e.Disposable.create((()=>aD(this,void 0,void 0,(function*(){n.commandService.executeCommand(e.XFlowNodeCommands.BACK_NODE.id,{nodeId:i})})))))):console.error(i,"this nodeId is not exist"),{}}))),r);return t.setResult(o),this})),this.undo=()=>aD(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>aD(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};oD([Wn(oM),sD("design:type",Object)],lD.prototype,"contextProvider",void 0),oD([f.postConstruct(),sD("design:type",Function),sD("design:paramtypes",[]),sD("design:returntype",void 0)],lD.prototype,"init",null),lD=oD([Vn({token:{token:iM,named:iD.command.id}})],lD);var cD,uD=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},hD=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},dD=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowNodeCommands.BACK_NODE,t.hookKey="backNode"}(cD||(cD={}));let fD=class{constructor(){this.execute=()=>dD(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),r=this.ctx.getHooks(),i=yield r.backNode.call(t,(t=>dD(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),{nodeId:r}=t,i=null==n?void 0:n.getCellById(r);return i?(i.toBack(),this.ctx.addUndo(e.Disposable.create((()=>dD(this,void 0,void 0,(function*(){t.commandService.executeCommand(e.XFlowNodeCommands.FRONT_NODE.id,{nodeId:r})})))))):console.error(r,"this nodeId is not exist"),{}}))),n);return this.ctx.setResult(i),this})),this.undo=()=>dD(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>dD(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};uD([Wn(oM),hD("design:type",Object)],fD.prototype,"contextProvider",void 0),uD([f.postConstruct(),hD("design:type",Function),hD("design:paramtypes",[]),hD("design:returntype",void 0)],fD.prototype,"init",null),fD=uD([Vn({token:{token:iM,named:cD.command.id}})],fD);var pD,gD=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},mD=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},vD=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowNodeCommands.HIGHLIGHT_NODE,t.hookKey="highlightNode"}(pD||(pD={}));let yD=class{constructor(){this.execute=()=>vD(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),r=this.ctx.getHooks(),i=yield r.highlightNode.call(t,(t=>vD(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),{nodeId:r,stroke:i,strokeWidth:o}=t,s=null==n?void 0:n.getCellById(r);if(!s)return console.error(r,"this nodeId is not exist"),{err:"this nodeId is not exist"};if(null==s||s.setAttrs({body:{stroke:i||"#7c68fc",strokeWidth:o||2}}),null==t?void 0:t.isHighlightRelatedLines){const{edgeStroke:r,edgeStrokeWidth:i}=t;(null==n?void 0:n.getEdges()).forEach((n=>{const o=null==n?void 0:n.getData();null==t||t.commandService.executeCommand(e.XFlowEdgeCommands.HIGHLIGHT_EDGE.id,{edgeId:null==o?void 0:o.id,strokeColor:r,strokeWidth:i})}))}return{err:null}}))),n);return this.ctx.setResult(i),this})),this.undo=()=>vD(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>vD(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};gD([Wn(oM),mD("design:type",Object)],yD.prototype,"contextProvider",void 0),gD([f.postConstruct(),mD("design:type",Function),mD("design:paramtypes",[]),mD("design:returntype",void 0)],yD.prototype,"init",null),yD=gD([Vn({token:{token:iM,named:pD.command.id}})],yD);const bD=[kP,NP,FP,VP,YP,QP,iD,cD,pD];var xD,wD=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},CD=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ED=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.LOAD_META,t.hookKey="graphMeta"}(xD||(xD={}));let _D=class{constructor(){this.execute=()=>ED(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),r=yield n.graphMeta.call(e,(e=>ED(this,void 0,void 0,(function*(){var t;const{graphMetaService:n}=e,r=n?yield n(e):{flowId:null===(t=null==e?void 0:e.meta)||void 0===t?void 0:t.flowId};return Object.assign({flowId:null==r?void 0:r.flowId},r)}))),t),i=this.ctx.getModelService();return(yield DT.getModel(i)).setValue(r),this.ctx.setResult(r),this})),this.undo=()=>ED(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>ED(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};wD([Wn(oM),CD("design:type",Object)],_D.prototype,"contextProvider",void 0),wD([f.postConstruct(),CD("design:type",Function),CD("design:paramtypes",[]),CD("design:returntype",void 0)],_D.prototype,"init",null),_D=wD([Vn({token:{token:iM,named:xD.command.id}})],_D);var SD,OD=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},AD=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},kD=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.SAVE_GRAPH_DATA,t.hookKey="saveGrpahData"}(SD||(SD={}));let MD=class{constructor(){this.execute=()=>kD(this,void 0,void 0,(function*(){const e=this.ctx,t=e.getArgs(),n=e.getHooks();return yield n.saveGrpahData.call(t.args,(t=>kD(this,void 0,void 0,(function*(){const{saveGraphDataService:n,includeAttrs:r}=t,i=yield e.getX6Graph(),o=i.getNodes(),s=i.getEdges(),a=o.map((e=>{const t=e.getData(),n=e.position(),i=e.size(),o=Object.assign(Object.assign(Object.assign({id:e.id},t),n),i);return r&&(o.attrs=e.getAttrs()),o})),l={nodes:a,edges:s.map((e=>{const t=e.getData(),n=Object.assign({id:e.id},t);return r&&(n.attrs=e.getAttrs()),n}))},c=yield this.ctx.getGraphMeta();if(n){const e=yield n(c,l);e&&this.ctx.setResult(e)}return{}}))),t.hooks),this})),this.undo=()=>kD(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>kD(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};OD([Wn(oM),AD("design:type",Object)],MD.prototype,"contextProvider",void 0),OD([f.postConstruct(),AD("design:type",Function),AD("design:paramtypes",[]),AD("design:returntype",void 0)],MD.prototype,"init",null),MD=OD([Vn({token:{token:iM,named:SD.command.id}})],MD);var TD,PD=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},DD=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ND=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.LOAD_DATA,t.hookKey="loadData",t.createHook=()=>new SM}(TD||(TD={}));let RD=class{constructor(){this.execute=()=>ND(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),r=yield n.loadData.call(e,(e=>ND(this,void 0,void 0,(function*(){const{loadDataService:t}=e,n=yield this.ctx.getGraphMeta();return{graphData:yield t(n)}}))),t);return this.ctx.setResult(r),this})),this.undo=()=>ND(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>ND(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};PD([Wn(oM),DD("design:type",Object)],RD.prototype,"contextProvider",void 0),PD([f.postConstruct(),DD("design:type",Function),DD("design:paramtypes",[]),DD("design:returntype",void 0)],RD.prototype,"init",null),RD=PD([Vn({token:{token:iM,named:TD.command.id}})],RD);class ID{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(e){return this.init(e),this.execute(!0)}init(e){this.nodes=e.nodes||[],this.edges=e.edges||[],this.combos=e.combos||[]}execute(e){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(e){e&&Object.assign(this,e)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}const jD=e=>"string"==typeof e,LD=Array.isArray,FD=e=>"number"==typeof e,GD=e=>Number.isNaN(Number(e)),BD=e=>null!==e&&"object"==typeof e,zD=e=>{if(null===e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array){const t=[];return e.forEach((e=>{t.push(e)})),t.map((e=>zD(e)))}if("object"==typeof e&&e!=={}){const t=Object.assign({},e);return Object.keys(t).forEach((e=>{t[e]=zD(t[e])})),t}return e},UD=(e,t)=>{const n=e[t];return BD(n)?n.cell:n},VD=(e,t,n)=>{const r=[];for(let t=0;t<e;t++)r[t]=0;return n?(n.forEach((e=>{const n=UD(e,"source"),i=UD(e,"target");n&&(r[t[n]]+=1),i&&(r[t[i]]+=1)})),r):r},HD=e=>{const t=[],n=e.length;for(let r=0;r<n;r+=1){t[r]=[];for(let i=0;i<n;i+=1)r===i?t[r][i]=0:0!==e[r][i]&&e[r][i]?t[r][i]=e[r][i]:t[r][i]=1/0}for(let e=0;e<n;e+=1)for(let r=0;r<n;r+=1)for(let i=0;i<n;i+=1)t[r][i]>t[r][e]+t[e][i]&&(t[r][i]=t[r][e]+t[e][i]);return t},WD=(e,t)=>{const{nodes:n,edges:r}=e,i=[],o={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach(((e,t)=>{o[e.id]=t;i.push([])})),r&&r.forEach((e=>{const n=UD(e,"source"),r=UD(e,"target"),s=o[n],a=o[r];i[s][a]=1,t||(i[a][s]=1)})),i},$D=(e,t)=>{if(e&&e.children)for(let n=e.children.length-1;n>=0;n--)if(!$D(e.children[n],t))return;return!!t(e)},XD=(e,t)=>{"function"==typeof t&&$D(e,t)},YD=e=>"function"==typeof e;const qD=(e,t)=>{let n;return n=e?FD(e)?t=>e:e:e=>t||1,n};var KD={exports:{}},ZD={exports:{}};!function(e,t){!function(e){function t(e){const t=+this._x.call(null,e),r=+this._y.call(null,e);return n(this.cover(t,r),t,r,e)}function n(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o,s,a,l,c,u,h,d,f=e._root,p={data:r},g=e._x0,m=e._y0,v=e._x1,y=e._y1;if(!f)return e._root=p,e;for(;f.length;)if((c=t>=(o=(g+v)/2))?g=o:v=o,(u=n>=(s=(m+y)/2))?m=s:y=s,i=f,!(f=f[h=u<<1|c]))return i[h]=p,e;if(a=+e._x.call(null,f.data),l=+e._y.call(null,f.data),t===a&&n===l)return p.next=f,i?i[h]=p:e._root=p,e;do{i=i?i[h]=new Array(4):e._root=new Array(4),(c=t>=(o=(g+v)/2))?g=o:v=o,(u=n>=(s=(m+y)/2))?m=s:y=s}while((h=u<<1|c)==(d=(l>=s)<<1|a>=o));return i[d]=f,i[h]=p,e}function r(e){var t,r,i,o,s=e.length,a=new Array(s),l=new Array(s),c=1/0,u=1/0,h=-1/0,d=-1/0;for(r=0;r<s;++r)isNaN(i=+this._x.call(null,t=e[r]))||isNaN(o=+this._y.call(null,t))||(a[r]=i,l[r]=o,i<c&&(c=i),i>h&&(h=i),o<u&&(u=o),o>d&&(d=o));if(c>h||u>d)return this;for(this.cover(c,u).cover(h,d),r=0;r<s;++r)n(this,a[r],l[r],e[r]);return this}function i(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var s,a,l=i-n||1,c=this._root;n>e||e>=i||r>t||t>=o;)switch(a=(t<r)<<1|e<n,(s=new Array(4))[a]=c,c=s,l*=2,a){case 0:i=n+l,o=r+l;break;case 1:n=i-l,o=r+l;break;case 2:i=n+l,r=o-l;break;case 3:n=i-l,r=o-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function o(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e}function s(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function a(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function l(e,t,n){var r,i,o,s,l,c,u,h=this._x0,d=this._y0,f=this._x1,p=this._y1,g=[],m=this._root;for(m&&g.push(new a(m,h,d,f,p)),null==n?n=1/0:(h=e-n,d=t-n,f=e+n,p=t+n,n*=n);c=g.pop();)if(!(!(m=c.node)||(i=c.x0)>f||(o=c.y0)>p||(s=c.x1)<h||(l=c.y1)<d))if(m.length){var v=(i+s)/2,y=(o+l)/2;g.push(new a(m[3],v,y,s,l),new a(m[2],i,y,v,l),new a(m[1],v,o,s,y),new a(m[0],i,o,v,y)),(u=(t>=y)<<1|e>=v)&&(c=g[g.length-1],g[g.length-1]=g[g.length-1-u],g[g.length-1-u]=c)}else{var b=e-+this._x.call(null,m.data),x=t-+this._y.call(null,m.data),w=b*b+x*x;if(w<n){var C=Math.sqrt(n=w);h=e-C,d=t-C,f=e+C,p=t+C,r=m.data}}return r}function c(e){if(isNaN(o=+this._x.call(null,e))||isNaN(s=+this._y.call(null,e)))return this;var t,n,r,i,o,s,a,l,c,u,h,d,f=this._root,p=this._x0,g=this._y0,m=this._x1,v=this._y1;if(!f)return this;if(f.length)for(;;){if((c=o>=(a=(p+m)/2))?p=a:m=a,(u=s>=(l=(g+v)/2))?g=l:v=l,t=f,!(f=f[h=u<<1|c]))return this;if(!f.length)break;(t[h+1&3]||t[h+2&3]||t[h+3&3])&&(n=t,d=h)}for(;f.data!==e;)if(r=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,r?(i?r.next=i:delete r.next,this):t?(i?t[h]=i:delete t[h],(f=t[0]||t[1]||t[2]||t[3])&&f===(t[3]||t[2]||t[1]||t[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=i,this)}function u(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function h(){return this._root}function d(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e}function f(e){var t,n,r,i,o,s,l=[],c=this._root;for(c&&l.push(new a(c,this._x0,this._y0,this._x1,this._y1));t=l.pop();)if(!e(c=t.node,r=t.x0,i=t.y0,o=t.x1,s=t.y1)&&c.length){var u=(r+o)/2,h=(i+s)/2;(n=c[3])&&l.push(new a(n,u,h,o,s)),(n=c[2])&&l.push(new a(n,r,h,u,s)),(n=c[1])&&l.push(new a(n,u,i,o,h)),(n=c[0])&&l.push(new a(n,r,i,u,h))}return this}function p(e){var t,n=[],r=[];for(this._root&&n.push(new a(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var i=t.node;if(i.length){var o,s=t.x0,l=t.y0,c=t.x1,u=t.y1,h=(s+c)/2,d=(l+u)/2;(o=i[0])&&n.push(new a(o,s,l,h,d)),(o=i[1])&&n.push(new a(o,h,l,c,d)),(o=i[2])&&n.push(new a(o,s,d,h,u)),(o=i[3])&&n.push(new a(o,h,d,c,u))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this}function g(e){return e[0]}function m(e){return arguments.length?(this._x=e,this):this._x}function v(e){return e[1]}function y(e){return arguments.length?(this._y=e,this):this._y}function b(e,t,n){var r=new x(null==t?g:t,null==n?v:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function x(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function w(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var C=b.prototype=x.prototype;C.copy=function(){var e,t,n=new x(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=w(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(4)}):r.target[i]=w(t));return n},C.add=t,C.addAll=r,C.cover=i,C.data=o,C.extent=s,C.find=l,C.remove=c,C.removeAll=u,C.root=h,C.size=d,C.visit=f,C.visitAfter=p,C.x=m,C.y=y,e.quadtree=b,Object.defineProperty(e,"__esModule",{value:!0})}(t)}(0,ZD.exports);var JD={exports:{}};!function(e,t){!function(e){var t={value:()=>{}};function n(){for(var e,t=0,n=arguments.length,i={};t<n;++t){if(!(e=arguments[t]+"")||e in i||/[\s.]/.test(e))throw new Error("illegal type: "+e);i[e]=[]}return new r(i)}function r(e){this._=e}function i(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function o(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function s(e,n,r){for(var i=0,o=e.length;i<o;++i)if(e[i].name===n){e[i]=t,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=r&&e.push({name:n,value:r}),e}r.prototype=n.prototype={constructor:r,on:function(e,t){var n,r=this._,a=i(e+"",r),l=-1,c=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++l<c;)if(n=(e=a[l]).type)r[n]=s(r[n],e.name,t);else if(null==t)for(n in r)r[n]=s(r[n],e.name,null);return this}for(;++l<c;)if((n=(e=a[l]).type)&&(n=o(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new r(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}},e.dispatch=n,Object.defineProperty(e,"__esModule",{value:!0})}(t)}(0,JD.exports);var QD={exports:{}};function eN(){function e(e){return()=>e}let t,n=e=>e.cluster,r=e(1),i=e(-1),o=e(100),s=e(.1),a=[0,0],l=[],c={},u=[],h=100,d=100,f={none:{x:0,y:0}},p=[],g="force",m=!0,v=.1;function y(e){if(!m)return y;t.tick(),x();for(let t,r=0,i=l.length,o=e*v;r<i;++r)t=l[r],t.vx+=(f[n(t)].x-t.x)*o,t.vy+=(f[n(t)].y-t.y)*o}function b(){l&&function(){if(!l||!l.length)return;if(void 0===n(l[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");const e=function(){const e=[],t=[],i={};let o=[],s={},a=[];return s=function(e){const t={};return e.forEach((e=>{const r=n(e);t[r]||(t[r]={count:0,sumforceNodeSize:0})})),e.forEach((e=>{const i=n(e),o=r(e),s=t[i];s.count=s.count+1,s.sumforceNodeSize=s.sumforceNodeSize+Math.PI*(o*o)*1.3,t[i]=s})),t}(l),a=function(e){const t={},r=[];e.forEach((e=>{const r=function(e){const t=UD(e,"source"),r=UD(e,"target"),i=n(c[t]),o=n(c[r]);return i<=o?`${i}~${o}`:`${o}~${i}`}(e);let i=0;void 0!==t[r]&&(i=t[r]),i+=1,t[r]=i}));return Object.entries(t).forEach((([e,t])=>{const n=e.split("~")[0],i=e.split("~")[1];void 0!==n&&void 0!==i&&r.push({source:n,target:i,count:t})})),r}(u),o=Object.keys(s),o.forEach(((t,n)=>{const r=s[t];e.push({id:t,size:r.count,r:Math.sqrt(r.sumforceNodeSize/Math.PI)}),i[t]=n})),a.forEach((e=>{const n=UD(e,"source"),r=UD(e,"target"),o=i[n],s=i[r];void 0!==o&&void 0!==s&&t.push({source:o,target:s,count:e.count})})),{nodes:e,links:t}}();t=KD.exports.forceSimulation(e.nodes).force("x",KD.exports.forceX(h).strength(.1)).force("y",KD.exports.forceY(d).strength(.1)).force("collide",KD.exports.forceCollide((e=>e.r)).iterations(4)).force("charge",KD.exports.forceManyBody().strength(i)).force("links",KD.exports.forceLink(e.nodes.length?e.links:[]).distance(o).strength(s)),p=t.nodes(),x()}()}function x(){return f={none:{x:0,y:0}},p.forEach((e=>{f[e.id]={x:e.x-a[0],y:e.y-a[1]}})),f}function w(e){c={},e.forEach((e=>{c[e.id]=e}))}return y.initialize=e=>{l=e,b()},y.template=function(e){return arguments.length?(g=e,b(),y):g},y.groupBy=function(e){return arguments.length?"string"==typeof e?(n=t=>t[e],y):(n=e,y):n},y.enableGrouping=function(e){return arguments.length?(m=e,y):m},y.strength=function(e){return arguments.length?(v=e,y):v},y.centerX=function(e){return arguments.length?(h=e,y):h},y.centerY=function(e){return arguments.length?(d=e,y):d},y.nodes=function(e){return arguments.length?(w(e||[]),l=e||[],y):l},y.links=function(e){return arguments.length?(u=e||[],b(),y):u},y.forceNodeSize=function(t){return arguments.length?(r="function"==typeof t?t:e(+t),b(),y):r},y.nodeSize=y.forceNodeSize,y.forceCharge=function(t){return arguments.length?(i="function"==typeof t?t:e(+t),b(),y):i},y.forceLinkDistance=function(t){return arguments.length?(o="function"==typeof t?t:e(+t),b(),y):o},y.forceLinkStrength=function(t){return arguments.length?(s="function"==typeof t?t:e(+t),b(),y):s},y.offset=function(e){return arguments.length?(a=e,y):a},y.getFocis=x,y}!function(e,t){!function(e){var t,n,r=0,i=0,o=0,s=1e3,a=0,l=0,c=0,u="object"==typeof performance&&performance.now?performance:Date,h="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function d(){return l||(h(f),l=u.now()+c)}function f(){l=0}function p(){this._call=this._time=this._next=null}function g(e,t,n){var r=new p;return r.restart(e,t,n),r}function m(){d(),++r;for(var e,n=t;n;)(e=l-n._time)>=0&&n._call.call(null,e),n=n._next;--r}function v(){l=(a=u.now())+c,r=i=0;try{m()}finally{r=0,b(),l=0}}function y(){var e=u.now(),t=e-a;t>s&&(c-=t,a=e)}function b(){for(var e,r,i=t,o=1/0;i;)i._call?(o>i._time&&(o=i._time),e=i,i=i._next):(r=i._next,i._next=null,i=e?e._next=r:t=r);n=e,x(o)}function x(e){r||(i&&(i=clearTimeout(i)),e-l>24?(e<1/0&&(i=setTimeout(v,e-u.now()-c)),o&&(o=clearInterval(o))):(o||(a=u.now(),o=setInterval(y,s)),r=1,h(v)))}function w(e,t,n){var r=new p;return t=null==t?0:+t,r.restart((n=>{r.stop(),e(n+t)}),t,n),r}function C(e,t,n){var r=new p,i=t;return null==t?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(e,t,n){t=+t,n=null==n?d():+n,r._restart((function o(s){s+=i,r._restart(o,i+=t,n),e(s)}),t,n)},r.restart(e,t,n),r)}p.prototype=g.prototype={constructor:p,restart:function(e,r,i){if("function"!=typeof e)throw new TypeError("callback is not a function");i=(null==i?d():+i)+(null==r?0:+r),this._next||n===this||(n?n._next=this:t=this,n=this),this._call=e,this._time=i,x()},stop:function(){this._call&&(this._call=null,this._time=1/0,x())}},e.interval=C,e.now=d,e.timeout=w,e.timer=g,e.timerFlush=m,Object.defineProperty(e,"__esModule",{value:!0})}(t)}(0,QD.exports),function(e,t){!function(e,t,n,r){function i(e,t){var n,r=1;function i(){var i,o,s=n.length,a=0,l=0;for(i=0;i<s;++i)a+=(o=n[i]).x,l+=o.y;for(a=(a/s-e)*r,l=(l/s-t)*r,i=0;i<s;++i)(o=n[i]).x-=a,o.y-=l}return null==e&&(e=0),null==t&&(t=0),i.initialize=function(e){n=e},i.x=function(t){return arguments.length?(e=+t,i):e},i.y=function(e){return arguments.length?(t=+e,i):t},i.strength=function(e){return arguments.length?(r=+e,i):r},i}function o(e){return function(){return e}}function s(e){return 1e-6*(e()-.5)}function a(e){return e.x+e.vx}function l(e){return e.y+e.vy}function c(e){var n,r,i,c=1,u=1;function h(){for(var e,o,h,f,p,g,m,v=n.length,y=0;y<u;++y)for(o=t.quadtree(n,a,l).visitAfter(d),e=0;e<v;++e)h=n[e],g=r[h.index],m=g*g,f=h.x+h.vx,p=h.y+h.vy,o.visit(b);function b(e,t,n,r,o){var a=e.data,l=e.r,u=g+l;if(!a)return t>f+u||r<f-u||n>p+u||o<p-u;if(a.index>h.index){var d=f-a.x-a.vx,v=p-a.y-a.vy,y=d*d+v*v;y<u*u&&(0===d&&(y+=(d=s(i))*d),0===v&&(y+=(v=s(i))*v),y=(u-(y=Math.sqrt(y)))/y*c,h.vx+=(d*=y)*(u=(l*=l)/(m+l)),h.vy+=(v*=y)*u,a.vx-=d*(u=1-u),a.vy-=v*u)}}}function d(e){if(e.data)return e.r=r[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function f(){if(n){var t,i,o=n.length;for(r=new Array(o),t=0;t<o;++t)i=n[t],r[i.index]=+e(i,t,n)}}return"function"!=typeof e&&(e=o(null==e?1:+e)),h.initialize=function(e,t){n=e,i=t,f()},h.iterations=function(e){return arguments.length?(u=+e,h):u},h.strength=function(e){return arguments.length?(c=+e,h):c},h.radius=function(t){return arguments.length?(e="function"==typeof t?t:o(+t),f(),h):e},h}function u(e){return e.index}function h(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function d(e){var t,n,r,i,a,l,c=u,d=g,f=o(30),p=1;function g(e){return 1/Math.min(i[e.source.index],i[e.target.index])}function m(r){for(var i=0,o=e.length;i<p;++i)for(var c,u,h,d,f,g,m,v=0;v<o;++v)u=(c=e[v]).source,d=(h=c.target).x+h.vx-u.x-u.vx||s(l),f=h.y+h.vy-u.y-u.vy||s(l),d*=g=((g=Math.sqrt(d*d+f*f))-n[v])/g*r*t[v],f*=g,h.vx-=d*(m=a[v]),h.vy-=f*m,u.vx+=d*(m=1-m),u.vy+=f*m}function v(){if(r){var o,s,l=r.length,u=e.length,d=new Map(r.map(((e,t)=>[c(e,t,r),e])));for(o=0,i=new Array(l);o<u;++o)(s=e[o]).index=o,"object"!=typeof s.source&&(s.source=h(d,s.source)),"object"!=typeof s.target&&(s.target=h(d,s.target)),i[s.source.index]=(i[s.source.index]||0)+1,i[s.target.index]=(i[s.target.index]||0)+1;for(o=0,a=new Array(u);o<u;++o)s=e[o],a[o]=i[s.source.index]/(i[s.source.index]+i[s.target.index]);t=new Array(u),y(),n=new Array(u),b()}}function y(){if(r)for(var n=0,i=e.length;n<i;++n)t[n]=+d(e[n],n,e)}function b(){if(r)for(var t=0,i=e.length;t<i;++t)n[t]=+f(e[t],t,e)}return null==e&&(e=[]),m.initialize=function(e,t){r=e,l=t,v()},m.links=function(t){return arguments.length?(e=t,v(),m):e},m.id=function(e){return arguments.length?(c=e,m):c},m.iterations=function(e){return arguments.length?(p=+e,m):p},m.strength=function(e){return arguments.length?(d="function"==typeof e?e:o(+e),y(),m):d},m.distance=function(e){return arguments.length?(f="function"==typeof e?e:o(+e),b(),m):f},m}const f=1664525,p=1013904223,g=4294967296;function m(){let e=1;return()=>(e=(f*e+p)%g)/g}function v(e){return e.x}function y(e){return e.y}var b=10,x=Math.PI*(3-Math.sqrt(5));function w(e){var t,i=1,o=.001,s=1-Math.pow(o,1/300),a=0,l=.6,c=new Map,u=r.timer(f),h=n.dispatch("tick","end"),d=m();function f(){p(),h.call("tick",t),i<o&&(u.stop(),h.call("end",t))}function p(n){var r,o,u=e.length;void 0===n&&(n=1);for(var h=0;h<n;++h)for(i+=(a-i)*s,c.forEach((function(e){e(i)})),r=0;r<u;++r)null==(o=e[r]).fx?o.x+=o.vx*=l:(o.x=o.fx,o.vx=0),null==o.fy?o.y+=o.vy*=l:(o.y=o.fy,o.vy=0);return t}function g(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var i=b*Math.sqrt(.5+n),o=n*x;t.x=i*Math.cos(o),t.y=i*Math.sin(o)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function v(t){return t.initialize&&t.initialize(e,d),t}return null==e&&(e=[]),g(),t={tick:p,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(n){return arguments.length?(e=n,g(),c.forEach(v),t):e},alpha:function(e){return arguments.length?(i=+e,t):i},alphaMin:function(e){return arguments.length?(o=+e,t):o},alphaDecay:function(e){return arguments.length?(s=+e,t):+s},alphaTarget:function(e){return arguments.length?(a=+e,t):a},velocityDecay:function(e){return arguments.length?(l=1-e,t):1-l},randomSource:function(e){return arguments.length?(d=e,c.forEach(v),t):d},force:function(e,n){return arguments.length>1?(null==n?c.delete(e):c.set(e,v(n)),t):c.get(e)},find:function(t,n,r){var i,o,s,a,l,c=0,u=e.length;for(null==r?r=1/0:r*=r,c=0;c<u;++c)(s=(i=t-(a=e[c]).x)*i+(o=n-a.y)*o)<r&&(l=a,r=s);return l},on:function(e,n){return arguments.length>1?(h.on(e,n),t):h.on(e)}}}function C(){var e,n,r,i,a,l=o(-30),c=1,u=1/0,h=.81;function d(r){var o,s=e.length,a=t.quadtree(e,v,y).visitAfter(p);for(i=r,o=0;o<s;++o)n=e[o],a.visit(g)}function f(){if(e){var t,n,r=e.length;for(a=new Array(r),t=0;t<r;++t)n=e[t],a[n.index]=+l(n,t,e)}}function p(e){var t,n,r,i,o,s=0,l=0;if(e.length){for(r=i=o=0;o<4;++o)(t=e[o])&&(n=Math.abs(t.value))&&(s+=t.value,l+=n,r+=n*t.x,i+=n*t.y);e.x=r/l,e.y=i/l}else{(t=e).x=t.data.x,t.y=t.data.y;do{s+=a[t.data.index]}while(t=t.next)}e.value=s}function g(e,t,o,l){if(!e.value)return!0;var d=e.x-n.x,f=e.y-n.y,p=l-t,g=d*d+f*f;if(p*p/h<g)return g<u&&(0===d&&(g+=(d=s(r))*d),0===f&&(g+=(f=s(r))*f),g<c&&(g=Math.sqrt(c*g)),n.vx+=d*e.value*i/g,n.vy+=f*e.value*i/g),!0;if(!(e.length||g>=u)){(e.data!==n||e.next)&&(0===d&&(g+=(d=s(r))*d),0===f&&(g+=(f=s(r))*f),g<c&&(g=Math.sqrt(c*g)));do{e.data!==n&&(p=a[e.data.index]*i/g,n.vx+=d*p,n.vy+=f*p)}while(e=e.next)}}return d.initialize=function(t,n){e=t,r=n,f()},d.strength=function(e){return arguments.length?(l="function"==typeof e?e:o(+e),f(),d):l},d.distanceMin=function(e){return arguments.length?(c=e*e,d):Math.sqrt(c)},d.distanceMax=function(e){return arguments.length?(u=e*e,d):Math.sqrt(u)},d.theta=function(e){return arguments.length?(h=e*e,d):Math.sqrt(h)},d}function E(e,t,n){var r,i,s,a=o(.1);function l(e){for(var o=0,a=r.length;o<a;++o){var l=r[o],c=l.x-t||1e-6,u=l.y-n||1e-6,h=Math.sqrt(c*c+u*u),d=(s[o]-h)*i[o]*e/h;l.vx+=c*d,l.vy+=u*d}}function c(){if(r){var t,n=r.length;for(i=new Array(n),s=new Array(n),t=0;t<n;++t)s[t]=+e(r[t],t,r),i[t]=isNaN(s[t])?0:+a(r[t],t,r)}}return"function"!=typeof e&&(e=o(+e)),null==t&&(t=0),null==n&&(n=0),l.initialize=function(e){r=e,c()},l.strength=function(e){return arguments.length?(a="function"==typeof e?e:o(+e),c(),l):a},l.radius=function(t){return arguments.length?(e="function"==typeof t?t:o(+t),c(),l):e},l.x=function(e){return arguments.length?(t=+e,l):t},l.y=function(e){return arguments.length?(n=+e,l):n},l}function _(e){var t,n,r,i=o(.1);function s(e){for(var i,o=0,s=t.length;o<s;++o)(i=t[o]).vx+=(r[o]-i.x)*n[o]*e}function a(){if(t){var o,s=t.length;for(n=new Array(s),r=new Array(s),o=0;o<s;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=o(null==e?0:+e)),s.initialize=function(e){t=e,a()},s.strength=function(e){return arguments.length?(i="function"==typeof e?e:o(+e),a(),s):i},s.x=function(t){return arguments.length?(e="function"==typeof t?t:o(+t),a(),s):e},s}function S(e){var t,n,r,i=o(.1);function s(e){for(var i,o=0,s=t.length;o<s;++o)(i=t[o]).vy+=(r[o]-i.y)*n[o]*e}function a(){if(t){var o,s=t.length;for(n=new Array(s),r=new Array(s),o=0;o<s;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=o(null==e?0:+e)),s.initialize=function(e){t=e,a()},s.strength=function(e){return arguments.length?(i="function"==typeof e?e:o(+e),a(),s):i},s.y=function(t){return arguments.length?(e="function"==typeof t?t:o(+t),a(),s):e},s}e.forceCenter=i,e.forceCollide=c,e.forceLink=d,e.forceManyBody=C,e.forceRadial=E,e.forceSimulation=w,e.forceX=_,e.forceY=S,Object.defineProperty(e,"__esModule",{value:!0})}(t,ZD.exports,JD.exports,QD.exports)}(0,KD.exports);const tN="LAYOUT_TICK",nN="GPU_LAYOUT_END";function rN(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope}function iN(e,t){const n=e.degree,r=t.degree;return n<r?-1:n>r?1:0}var oN=function(){this.__data__=[],this.size=0};var sN=function(e,t){return e===t||e!=e&&t!=t},aN=sN;var lN=function(e,t){for(var n=e.length;n--;)if(aN(e[n][0],t))return n;return-1},cN=lN,uN=Array.prototype.splice;var hN=function(e){var t=this.__data__,n=cN(t,e);return!(n<0)&&(n==t.length-1?t.pop():uN.call(t,n,1),--this.size,!0)},dN=lN;var fN=function(e){var t=this.__data__,n=dN(t,e);return n<0?void 0:t[n][1]},pN=lN;var gN=lN;var mN=function(e,t){var n=this.__data__,r=gN(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},vN=oN,yN=hN,bN=fN,xN=function(e){return pN(this.__data__,e)>-1},wN=mN;function CN(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}CN.prototype.clear=vN,CN.prototype.delete=yN,CN.prototype.get=bN,CN.prototype.has=xN,CN.prototype.set=wN;var EN=CN,_N=EN;var SN=function(){this.__data__=new _N,this.size=0};var ON=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var AN=function(e){return this.__data__.get(e)};var kN=function(e){return this.__data__.has(e)},MN="object"==typeof u&&u&&u.Object===Object&&u,TN=MN,PN="object"==typeof self&&self&&self.Object===Object&&self,DN=TN||PN||Function("return this")(),NN=DN.Symbol,RN=NN,IN=Object.prototype,jN=IN.hasOwnProperty,LN=IN.toString,FN=RN?RN.toStringTag:void 0;var GN=function(e){var t=jN.call(e,FN),n=e[FN];try{e[FN]=void 0;var r=!0}catch(e){}var i=LN.call(e);return r&&(t?e[FN]=n:delete e[FN]),i},BN=Object.prototype.toString;var zN=GN,UN=function(e){return BN.call(e)},VN=NN?NN.toStringTag:void 0;var HN=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":VN&&VN in Object(e)?zN(e):UN(e)};var WN=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},$N=HN,XN=WN;var YN=function(e){if(!XN(e))return!1;var t=$N(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},qN=DN["__core-js_shared__"],KN=function(){var e=/[^.]+$/.exec(qN&&qN.keys&&qN.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var ZN=function(e){return!!KN&&KN in e},JN=Function.prototype.toString;var QN=function(e){if(null!=e){try{return JN.call(e)}catch(e){}try{return e+""}catch(e){}}return""},eR=YN,tR=ZN,nR=WN,rR=QN,iR=/^\[object .+?Constructor\]$/,oR=Function.prototype,sR=Object.prototype,aR=oR.toString,lR=sR.hasOwnProperty,cR=RegExp("^"+aR.call(lR).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var uR=function(e,t){return null==e?void 0:e[t]},hR=function(e){return!(!nR(e)||tR(e))&&(eR(e)?cR:iR).test(rR(e))},dR=uR;var fR=function(e,t){var n=dR(e,t);return hR(n)?n:void 0},pR=fR(DN,"Map"),gR=fR(Object,"create"),mR=gR;var vR=function(){this.__data__=mR?mR(null):{},this.size=0};var yR=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},bR=gR,xR=Object.prototype.hasOwnProperty;var wR=function(e){var t=this.__data__;if(bR){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return xR.call(t,e)?t[e]:void 0},CR=gR,ER=Object.prototype.hasOwnProperty;var _R=gR;var SR=vR,OR=yR,AR=wR,kR=function(e){var t=this.__data__;return CR?void 0!==t[e]:ER.call(t,e)},MR=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=_R&&void 0===t?"__lodash_hash_undefined__":t,this};function TR(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}TR.prototype.clear=SR,TR.prototype.delete=OR,TR.prototype.get=AR,TR.prototype.has=kR,TR.prototype.set=MR;var PR=TR,DR=EN,NR=pR;var RR=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var IR=function(e,t){var n=e.__data__;return RR(t)?n["string"==typeof t?"string":"hash"]:n.map},jR=IR;var LR=function(e){var t=jR(this,e).delete(e);return this.size-=t?1:0,t},FR=IR;var GR=IR;var BR=IR;var zR=function(e,t){var n=BR(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},UR=function(){this.size=0,this.__data__={hash:new PR,map:new(NR||DR),string:new PR}},VR=LR,HR=function(e){return FR(this,e).get(e)},WR=function(e){return GR(this,e).has(e)},$R=zR;function XR(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}XR.prototype.clear=UR,XR.prototype.delete=VR,XR.prototype.get=HR,XR.prototype.has=WR,XR.prototype.set=$R;var YR=XR,qR=EN,KR=pR,ZR=YR;var JR=EN,QR=SN,eI=ON,tI=AN,nI=kN,rI=function(e,t){var n=this.__data__;if(n instanceof qR){var r=n.__data__;if(!KR||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new ZR(r)}return n.set(e,t),this.size=n.size,this};function iI(e){var t=this.__data__=new JR(e);this.size=t.size}iI.prototype.clear=QR,iI.prototype.delete=eI,iI.prototype.get=tI,iI.prototype.has=nI,iI.prototype.set=rI;var oI=iI;var sI=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e},aI=fR,lI=function(){try{var e=aI(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),cI=lI,uI=cI;var hI=function(e,t,n){"__proto__"==t&&uI?uI(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},dI=hI,fI=sN,pI=Object.prototype.hasOwnProperty;var gI=function(e,t,n){var r=e[t];pI.call(e,t)&&fI(r,n)&&(void 0!==n||t in e)||dI(e,t,n)},mI=gI,vI=hI;var yI=function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var a=t[o],l=r?r(n[a],e[a],a,n,e):void 0;void 0===l&&(l=e[a]),i?vI(n,a,l):mI(n,a,l)}return n};var bI=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r};var xI=function(e){return null!=e&&"object"==typeof e},wI=HN,CI=xI;var EI=function(e){return CI(e)&&"[object Arguments]"==wI(e)},_I=xI,SI=Object.prototype,OI=SI.hasOwnProperty,AI=SI.propertyIsEnumerable,kI=EI(function(){return arguments}())?EI:function(e){return _I(e)&&OI.call(e,"callee")&&!AI.call(e,"callee")},MI=kI,TI=Array.isArray,PI={exports:{}};var DI=function(){return!1};!function(e,t){var n=DN,r=DI,i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,s=o&&o.exports===i?n.Buffer:void 0,a=(s?s.isBuffer:void 0)||r;e.exports=a}(PI,PI.exports);var NI=/^(?:0|[1-9]\d*)$/;var RI=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&NI.test(e))&&e>-1&&e%1==0&&e<t};var II=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},jI=HN,LI=II,FI=xI,GI={};GI["[object Float32Array]"]=GI["[object Float64Array]"]=GI["[object Int8Array]"]=GI["[object Int16Array]"]=GI["[object Int32Array]"]=GI["[object Uint8Array]"]=GI["[object Uint8ClampedArray]"]=GI["[object Uint16Array]"]=GI["[object Uint32Array]"]=!0,GI["[object Arguments]"]=GI["[object Array]"]=GI["[object ArrayBuffer]"]=GI["[object Boolean]"]=GI["[object DataView]"]=GI["[object Date]"]=GI["[object Error]"]=GI["[object Function]"]=GI["[object Map]"]=GI["[object Number]"]=GI["[object Object]"]=GI["[object RegExp]"]=GI["[object Set]"]=GI["[object String]"]=GI["[object WeakMap]"]=!1;var BI=function(e){return FI(e)&&LI(e.length)&&!!GI[jI(e)]};var zI=function(e){return function(t){return e(t)}},UI={exports:{}};!function(e,t){var n=MN,r=t&&!t.nodeType&&t,i=r&&e&&!e.nodeType&&e,o=i&&i.exports===r&&n.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=s}(UI,UI.exports);var VI=BI,HI=zI,WI=UI.exports,$I=WI&&WI.isTypedArray,XI=$I?HI($I):VI,YI=bI,qI=MI,KI=TI,ZI=PI.exports,JI=RI,QI=XI,ej=Object.prototype.hasOwnProperty;var tj=function(e,t){var n=KI(e),r=!n&&qI(e),i=!n&&!r&&ZI(e),o=!n&&!r&&!i&&QI(e),s=n||r||i||o,a=s?YI(e.length,String):[],l=a.length;for(var c in e)!t&&!ej.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||JI(c,l))||a.push(c);return a},nj=Object.prototype;var rj=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||nj)};var ij=function(e,t){return function(n){return e(t(n))}},oj=ij(Object.keys,Object),sj=rj,aj=oj,lj=Object.prototype.hasOwnProperty;var cj=function(e){if(!sj(e))return aj(e);var t=[];for(var n in Object(e))lj.call(e,n)&&"constructor"!=n&&t.push(n);return t},uj=YN,hj=II;var dj=function(e){return null!=e&&hj(e.length)&&!uj(e)},fj=tj,pj=cj,gj=dj;var mj=function(e){return gj(e)?fj(e):pj(e)},vj=yI,yj=mj;var bj=function(e,t){return e&&vj(t,yj(t),e)};var xj=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},wj=WN,Cj=rj,Ej=xj,_j=Object.prototype.hasOwnProperty;var Sj=function(e){if(!wj(e))return Ej(e);var t=Cj(e),n=[];for(var r in e)("constructor"!=r||!t&&_j.call(e,r))&&n.push(r);return n},Oj=tj,Aj=Sj,kj=dj;var Mj=function(e){return kj(e)?Oj(e,!0):Aj(e)},Tj=yI,Pj=Mj;var Dj=function(e,t){return e&&Tj(t,Pj(t),e)},Nj={exports:{}};!function(e,t){var n=DN,r=t&&!t.nodeType&&t,i=r&&e&&!e.nodeType&&e,o=i&&i.exports===r?n.Buffer:void 0,s=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r}}(Nj,Nj.exports);var Rj=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t};var Ij=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o};var jj=function(){return[]},Lj=Ij,Fj=jj,Gj=Object.prototype.propertyIsEnumerable,Bj=Object.getOwnPropertySymbols,zj=Bj?function(e){return null==e?[]:(e=Object(e),Lj(Bj(e),(function(t){return Gj.call(e,t)})))}:Fj,Uj=zj,Vj=yI,Hj=Uj;var Wj=function(e,t){return Vj(e,Hj(e),t)};var $j=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},Xj=ij(Object.getPrototypeOf,Object),Yj=$j,qj=Xj,Kj=Uj,Zj=jj,Jj=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Yj(t,Kj(e)),e=qj(e);return t}:Zj,Qj=yI,eL=Jj;var tL=function(e,t){return Qj(e,eL(e),t)},nL=$j,rL=TI;var iL=function(e,t,n){var r=t(e);return rL(e)?r:nL(r,n(e))},oL=iL,sL=Uj,aL=mj;var lL=function(e){return oL(e,aL,sL)},cL=iL,uL=Jj,hL=Mj;var dL=function(e){return cL(e,hL,uL)},fL=fR(DN,"DataView"),pL=fR(DN,"Promise"),gL=fR(DN,"Set"),mL=fL,vL=pR,yL=pL,bL=gL,xL=fR(DN,"WeakMap"),wL=HN,CL=QN,EL="[object Map]",_L="[object Promise]",SL="[object Set]",OL="[object WeakMap]",AL="[object DataView]",kL=CL(mL),ML=CL(vL),TL=CL(yL),PL=CL(bL),DL=CL(xL),NL=wL;(mL&&NL(new mL(new ArrayBuffer(1)))!=AL||vL&&NL(new vL)!=EL||yL&&NL(yL.resolve())!=_L||bL&&NL(new bL)!=SL||xL&&NL(new xL)!=OL)&&(NL=function(e){var t=wL(e),n="[object Object]"==t?e.constructor:void 0,r=n?CL(n):"";if(r)switch(r){case kL:return AL;case ML:return EL;case TL:return _L;case PL:return SL;case DL:return OL}return t});var RL=NL,IL=Object.prototype.hasOwnProperty;var jL=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&IL.call(e,"index")&&(n.index=e.index,n.input=e.input),n},LL=DN.Uint8Array,FL=LL;var GL=function(e){var t=new e.constructor(e.byteLength);return new FL(t).set(new FL(e)),t},BL=GL;var zL=function(e,t){var n=t?BL(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},UL=/\w*$/;var VL=function(e){var t=new e.constructor(e.source,UL.exec(e));return t.lastIndex=e.lastIndex,t},HL=NN?NN.prototype:void 0,WL=HL?HL.valueOf:void 0;var $L=GL;var XL=function(e,t){var n=t?$L(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)},YL=GL,qL=zL,KL=VL,ZL=function(e){return WL?Object(WL.call(e)):{}},JL=XL;var QL=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return YL(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return qL(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return JL(e,n);case"[object Map]":case"[object Set]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return KL(e);case"[object Symbol]":return ZL(e)}},eF=WN,tF=Object.create,nF=function(){function e(){}return function(t){if(!eF(t))return{};if(tF)return tF(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),rF=nF,iF=rF,oF=Xj,sF=rj;var aF=function(e){return"function"!=typeof e.constructor||sF(e)?{}:iF(oF(e))},lF=RL,cF=xI;var uF=function(e){return cF(e)&&"[object Map]"==lF(e)},hF=zI,dF=UI.exports,fF=dF&&dF.isMap,pF=fF?hF(fF):uF,gF=RL,mF=xI;var vF=function(e){return mF(e)&&"[object Set]"==gF(e)},yF=zI,bF=UI.exports,xF=bF&&bF.isSet,wF=xF?yF(xF):vF,CF=oI,EF=sI,_F=gI,SF=bj,OF=Dj,AF=Nj.exports,kF=Rj,MF=Wj,TF=tL,PF=lL,DF=dL,NF=RL,RF=jL,IF=QL,jF=aF,LF=TI,FF=PI.exports,GF=pF,BF=WN,zF=wF,UF=mj,VF=Mj,HF="[object Arguments]",WF="[object Function]",$F="[object Object]",XF={};XF[HF]=XF["[object Array]"]=XF["[object ArrayBuffer]"]=XF["[object DataView]"]=XF["[object Boolean]"]=XF["[object Date]"]=XF["[object Float32Array]"]=XF["[object Float64Array]"]=XF["[object Int8Array]"]=XF["[object Int16Array]"]=XF["[object Int32Array]"]=XF["[object Map]"]=XF["[object Number]"]=XF[$F]=XF["[object RegExp]"]=XF["[object Set]"]=XF["[object String]"]=XF["[object Symbol]"]=XF["[object Uint8Array]"]=XF["[object Uint8ClampedArray]"]=XF["[object Uint16Array]"]=XF["[object Uint32Array]"]=!0,XF["[object Error]"]=XF[WF]=XF["[object WeakMap]"]=!1;var YF=function e(t,n,r,i,o,s){var a,l=1&n,c=2&n,u=4&n;if(r&&(a=o?r(t,i,o,s):r(t)),void 0!==a)return a;if(!BF(t))return t;var h=LF(t);if(h){if(a=RF(t),!l)return kF(t,a)}else{var d=NF(t),f=d==WF||"[object GeneratorFunction]"==d;if(FF(t))return AF(t,l);if(d==$F||d==HF||f&&!o){if(a=c||f?{}:jF(t),!l)return c?TF(t,OF(a,t)):MF(t,SF(a,t))}else{if(!XF[d])return o?t:{};a=IF(t,d,l)}}s||(s=new CF);var p=s.get(t);if(p)return p;s.set(t,a),zF(t)?t.forEach((function(i){a.add(e(i,n,r,i,t,s))})):GF(t)&&t.forEach((function(i,o){a.set(o,e(i,n,r,o,t,s))}));var g=h?void 0:(u?c?DF:PF:c?VF:UF)(t);return EF(g||t,(function(i,o){g&&(i=t[o=i]),_F(a,o,e(i,n,r,o,t,s))})),a},qF=YF;var KF=function(e){return qF(e,4)};var ZF=function(e){return function(){return e}};var JF=function(e){return function(t,n,r){for(var i=-1,o=Object(t),s=r(t),a=s.length;a--;){var l=s[e?a:++i];if(!1===n(o[l],l,o))break}return t}},QF=JF(),eG=QF,tG=mj;var nG=function(e,t){return e&&eG(e,t,tG)},rG=dj;var iG=function(e,t){return function(n,r){if(null==n)return n;if(!rG(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=Object(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}},oG=iG(nG);var sG=function(e){return e},aG=sG;var lG=function(e){return"function"==typeof e?e:aG},cG=sI,uG=oG,hG=lG,dG=TI;var fG=function(e,t){return(dG(e)?cG:uG)(e,hG(t))},pG=fG,gG=oG;var mG=function(e,t){var n=[];return gG(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n};var vG=YR,yG=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},bG=function(e){return this.__data__.has(e)};function xG(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new vG;++t<n;)this.add(e[t])}xG.prototype.add=xG.prototype.push=yG,xG.prototype.has=bG;var wG=xG;var CG=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1};var EG=function(e,t){return e.has(t)},_G=wG,SG=CG,OG=EG;var AG=function(e,t,n,r,i,o){var s=1&n,a=e.length,l=t.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var h=-1,d=!0,f=2&n?new _G:void 0;for(o.set(e,t),o.set(t,e);++h<a;){var p=e[h],g=t[h];if(r)var m=s?r(g,p,h,t,e,o):r(p,g,h,e,t,o);if(void 0!==m){if(m)continue;d=!1;break}if(f){if(!SG(t,(function(e,t){if(!OG(f,t)&&(p===e||i(p,e,n,r,o)))return f.push(t)}))){d=!1;break}}else if(p!==g&&!i(p,g,n,r,o)){d=!1;break}}return o.delete(e),o.delete(t),d};var kG=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n};var MG=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},TG=LL,PG=sN,DG=AG,NG=kG,RG=MG,IG=NN?NN.prototype:void 0,jG=IG?IG.valueOf:void 0;var LG=function(e,t,n,r,i,o,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new TG(e),new TG(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return PG(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=NG;case"[object Set]":var l=1&r;if(a||(a=RG),e.size!=t.size&&!l)return!1;var c=s.get(e);if(c)return c==t;r|=2,s.set(e,t);var u=DG(a(e),a(t),r,i,o,s);return s.delete(e),u;case"[object Symbol]":if(jG)return jG.call(e)==jG.call(t)}return!1},FG=lL,GG=Object.prototype.hasOwnProperty;var BG=function(e,t,n,r,i,o){var s=1&n,a=FG(e),l=a.length;if(l!=FG(t).length&&!s)return!1;for(var c=l;c--;){var u=a[c];if(!(s?u in t:GG.call(t,u)))return!1}var h=o.get(e),d=o.get(t);if(h&&d)return h==t&&d==e;var f=!0;o.set(e,t),o.set(t,e);for(var p=s;++c<l;){var g=e[u=a[c]],m=t[u];if(r)var v=s?r(m,g,u,t,e,o):r(g,m,u,e,t,o);if(!(void 0===v?g===m||i(g,m,n,r,o):v)){f=!1;break}p||(p="constructor"==u)}if(f&&!p){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(f=!1)}return o.delete(e),o.delete(t),f},zG=oI,UG=AG,VG=LG,HG=BG,WG=RL,$G=TI,XG=PI.exports,YG=XI,qG="[object Arguments]",KG="[object Array]",ZG="[object Object]",JG=Object.prototype.hasOwnProperty;var QG=function(e,t,n,r,i,o){var s=$G(e),a=$G(t),l=s?KG:WG(e),c=a?KG:WG(t),u=(l=l==qG?ZG:l)==ZG,h=(c=c==qG?ZG:c)==ZG,d=l==c;if(d&&XG(e)){if(!XG(t))return!1;s=!0,u=!1}if(d&&!u)return o||(o=new zG),s||YG(e)?UG(e,t,n,r,i,o):VG(e,t,l,n,r,i,o);if(!(1&n)){var f=u&&JG.call(e,"__wrapped__"),p=h&&JG.call(t,"__wrapped__");if(f||p){var g=f?e.value():e,m=p?t.value():t;return o||(o=new zG),i(g,m,n,r,o)}}return!!d&&(o||(o=new zG),HG(e,t,n,r,i,o))},eB=QG,tB=xI;var nB=function e(t,n,r,i,o){return t===n||(null==t||null==n||!tB(t)&&!tB(n)?t!=t&&n!=n:eB(t,n,r,i,e,o))},rB=oI,iB=nB;var oB=function(e,t,n,r){var i=n.length,o=i,s=!r;if(null==e)return!o;for(e=Object(e);i--;){var a=n[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var l=(a=n[i])[0],c=e[l],u=a[1];if(s&&a[2]){if(void 0===c&&!(l in e))return!1}else{var h=new rB;if(r)var d=r(c,u,l,e,t,h);if(!(void 0===d?iB(u,c,3,r,h):d))return!1}}return!0},sB=WN;var aB=function(e){return e==e&&!sB(e)},lB=aB,cB=mj;var uB=function(e){for(var t=cB(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,lB(i)]}return t};var hB=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}},dB=oB,fB=uB,pB=hB;var gB=function(e){var t=fB(e);return 1==t.length&&t[0][2]?pB(t[0][0],t[0][1]):function(n){return n===e||dB(n,e,t)}},mB=HN,vB=xI;var yB=function(e){return"symbol"==typeof e||vB(e)&&"[object Symbol]"==mB(e)},bB=TI,xB=yB,wB=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,CB=/^\w*$/;var EB=function(e,t){if(bB(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!xB(e))||(CB.test(e)||!wB.test(e)||null!=t&&e in Object(t))},_B=YR;function SB(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(SB.Cache||_B),n}SB.Cache=_B;var OB=SB;var AB=function(e){var t=OB(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t},kB=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,MB=/\\(\\)?/g,TB=AB((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(kB,(function(e,n,r,i){t.push(r?i.replace(MB,"$1"):n||e)})),t})),PB=TB;var DB=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i},NB=DB,RB=TI,IB=yB,jB=NN?NN.prototype:void 0,LB=jB?jB.toString:void 0;var FB=function e(t){if("string"==typeof t)return t;if(RB(t))return NB(t,e)+"";if(IB(t))return LB?LB.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n},GB=FB;var BB=function(e){return null==e?"":GB(e)},zB=TI,UB=EB,VB=PB,HB=BB;var WB=function(e,t){return zB(e)?e:UB(e,t)?[e]:VB(HB(e))},$B=yB;var XB=function(e){if("string"==typeof e||$B(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t},YB=WB,qB=XB;var KB=function(e,t){for(var n=0,r=(t=YB(t,e)).length;null!=e&&n<r;)e=e[qB(t[n++])];return n&&n==r?e:void 0},ZB=KB;var JB=function(e,t,n){var r=null==e?void 0:ZB(e,t);return void 0===r?n:r};var QB=function(e,t){return null!=e&&t in Object(e)},ez=WB,tz=MI,nz=TI,rz=RI,iz=II,oz=XB;var sz=function(e,t,n){for(var r=-1,i=(t=ez(t,e)).length,o=!1;++r<i;){var s=oz(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&iz(i)&&rz(s,i)&&(nz(e)||tz(e))},az=QB,lz=sz;var cz=function(e,t){return null!=e&&lz(e,t,az)},uz=nB,hz=JB,dz=cz,fz=EB,pz=aB,gz=hB,mz=XB;var vz=function(e,t){return fz(e)&&pz(t)?gz(mz(e),t):function(n){var r=hz(n,e);return void 0===r&&r===t?dz(n,e):uz(t,r,3)}};var yz=function(e){return function(t){return null==t?void 0:t[e]}},bz=KB;var xz=function(e){return function(t){return bz(t,e)}},wz=yz,Cz=xz,Ez=EB,_z=XB;var Sz=function(e){return Ez(e)?wz(_z(e)):Cz(e)},Oz=gB,Az=vz,kz=sG,Mz=TI,Tz=Sz;var Pz=function(e){return"function"==typeof e?e:null==e?kz:"object"==typeof e?Mz(e)?Az(e[0],e[1]):Oz(e):Tz(e)},Dz=Ij,Nz=mG,Rz=Pz,Iz=TI;var jz=function(e,t){return(Iz(e)?Dz:Nz)(e,Rz(t))},Lz=Object.prototype.hasOwnProperty;var Fz=function(e,t){return null!=e&&Lz.call(e,t)},Gz=Fz,Bz=sz;var zz=function(e,t){return null!=e&&Bz(e,t,Gz)},Uz=cj,Vz=RL,Hz=MI,Wz=TI,$z=dj,Xz=PI.exports,Yz=rj,qz=XI,Kz=Object.prototype.hasOwnProperty;var Zz=function(e){if(null==e)return!0;if($z(e)&&(Wz(e)||"string"==typeof e||"function"==typeof e.splice||Xz(e)||qz(e)||Hz(e)))return!e.length;var t=Vz(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(Yz(e))return!Uz(e).length;for(var n in e)if(Kz.call(e,n))return!1;return!0};var Jz=function(e){return void 0===e},Qz=oG,eU=dj;var tU=function(e,t){var n=-1,r=eU(e)?Array(e.length):[];return Qz(e,(function(e,i,o){r[++n]=t(e,i,o)})),r},nU=DB,rU=Pz,iU=tU,oU=TI;var sU=function(e,t){return(oU(e)?nU:iU)(e,rU(t))};var aU=function(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n};var lU=function(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n},cU=aU,uU=oG,hU=Pz,dU=lU,fU=TI;var pU=function(e,t,n){var r=fU(e)?cU:dU,i=arguments.length<3;return r(e,hU(t),n,i,uU)},gU=HN,mU=TI,vU=xI;var yU=function(e){return"string"==typeof e||!mU(e)&&vU(e)&&"[object String]"==gU(e)},bU=yz("length"),xU=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var wU=function(e){return xU.test(e)},CU="[\\ud800-\\udfff]",EU="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",_U="\\ud83c[\\udffb-\\udfff]",SU="[^\\ud800-\\udfff]",OU="(?:\\ud83c[\\udde6-\\uddff]){2}",AU="[\\ud800-\\udbff][\\udc00-\\udfff]",kU="(?:"+EU+"|"+_U+")"+"?",MU="[\\ufe0e\\ufe0f]?",TU=MU+kU+("(?:\\u200d(?:"+[SU,OU,AU].join("|")+")"+MU+kU+")*"),PU="(?:"+[SU+EU+"?",EU,OU,AU,CU].join("|")+")",DU=RegExp(_U+"(?="+_U+")|"+PU+TU,"g");var NU=function(e){for(var t=DU.lastIndex=0;DU.test(e);)++t;return t},RU=bU,IU=wU,jU=NU;var LU=function(e){return IU(e)?jU(e):RU(e)},FU=cj,GU=RL,BU=dj,zU=yU,UU=LU;var VU=function(e){if(null==e)return 0;if(BU(e))return zU(e)?UU(e):e.length;var t=GU(e);return"[object Map]"==t||"[object Set]"==t?e.size:FU(e).length},HU=sI,WU=rF,$U=nG,XU=Pz,YU=Xj,qU=TI,KU=PI.exports,ZU=YN,JU=WN,QU=XI;var eV=function(e,t,n){var r=qU(e),i=r||KU(e)||QU(e);if(t=XU(t),null==n){var o=e&&e.constructor;n=i?r?new o:[]:JU(e)&&ZU(o)?WU(YU(e)):{}}return(i?HU:$U)(e,(function(e,r,i){return t(n,e,r,i)})),n},tV=MI,nV=TI,rV=NN?NN.isConcatSpreadable:void 0;var iV=$j,oV=function(e){return nV(e)||tV(e)||!!(rV&&e&&e[rV])};var sV=function e(t,n,r,i,o){var s=-1,a=t.length;for(r||(r=oV),o||(o=[]);++s<a;){var l=t[s];n>0&&r(l)?n>1?e(l,n-1,r,i,o):iV(o,l):i||(o[o.length]=l)}return o};var aV=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},lV=aV,cV=Math.max;var uV=function(e,t,n){return t=cV(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=cV(r.length-t,0),s=Array(o);++i<o;)s[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(s),lV(e,this,a)}},hV=ZF,dV=cI,fV=dV?function(e,t){return dV(e,"toString",{configurable:!0,enumerable:!1,value:hV(t),writable:!0})}:sG,pV=fV,gV=Date.now;var mV=function(e){var t=0,n=0;return function(){var r=gV(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},vV=mV(pV),yV=sG,bV=uV,xV=vV;var wV=function(e,t){return xV(bV(e,t,yV),e+"")};var CV=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1};var EV=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1},_V=CV,SV=function(e){return e!=e},OV=EV;var AV=function(e,t,n){return t==t?OV(e,t,n):_V(e,SV,n)},kV=AV;var MV=function(e,t){return!!(null==e?0:e.length)&&kV(e,t,0)>-1};var TV=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1};var PV=gL,DV=function(){},NV=PV&&1/MG(new PV([,-0]))[1]==1/0?function(e){return new PV(e)}:DV,RV=wG,IV=MV,jV=TV,LV=EG,FV=NV,GV=MG;var BV=function(e,t,n){var r=-1,i=IV,o=e.length,s=!0,a=[],l=a;if(n)s=!1,i=jV;else if(o>=200){var c=t?null:FV(e);if(c)return GV(c);s=!1,i=LV,l=new RV}else l=t?[]:a;e:for(;++r<o;){var u=e[r],h=t?t(u):u;if(u=n||0!==u?u:0,s&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue e;t&&l.push(h),a.push(u)}else i(l,h,n)||(l!==a&&l.push(h),a.push(u))}return a},zV=dj,UV=xI;var VV=function(e){return UV(e)&&zV(e)},HV=sV,WV=BV,$V=VV,XV=wV((function(e){return WV(HV(e,1,$V,!0))})),YV=DB;var qV=function(e,t){return YV(t,(function(t){return e[t]}))},KV=qV,ZV=mj;var JV,QV=function(e){return null==e?[]:KV(e,ZV(e))};try{JV={clone:KF,constant:ZF,each:pG,filter:jz,has:zz,isArray:TI,isEmpty:Zz,isFunction:YN,isUndefined:Jz,keys:mj,map:sU,reduce:pU,size:VU,transform:eV,union:XV,values:QV}}catch(Qre){}JV||(JV=window._);var eH=JV,tH=eH,nH=iH,rH="\0";function iH(e){this._isDirected=!tH.has(e,"directed")||e.directed,this._isMultigraph=!!tH.has(e,"multigraph")&&e.multigraph,this._isCompound=!!tH.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=tH.constant(void 0),this._defaultEdgeLabelFn=tH.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function oH(e,t){e[t]?e[t]++:e[t]=1}function sH(e,t){--e[t]||delete e[t]}function aH(e,t,n,r){var i=""+t,o=""+n;if(!e&&i>o){var s=i;i=o,o=s}return i+""+o+""+(tH.isUndefined(r)?"\0":r)}function lH(e,t,n,r){var i=""+t,o=""+n;if(!e&&i>o){var s=i;i=o,o=s}var a={v:i,w:o};return r&&(a.name=r),a}function cH(e,t){return aH(e,t.v,t.w,t.name)}iH.prototype._nodeCount=0,iH.prototype._edgeCount=0,iH.prototype.isDirected=function(){return this._isDirected},iH.prototype.isMultigraph=function(){return this._isMultigraph},iH.prototype.isCompound=function(){return this._isCompound},iH.prototype.setGraph=function(e){return this._label=e,this},iH.prototype.graph=function(){return this._label},iH.prototype.setDefaultNodeLabel=function(e){return tH.isFunction(e)||(e=tH.constant(e)),this._defaultNodeLabelFn=e,this},iH.prototype.nodeCount=function(){return this._nodeCount},iH.prototype.nodes=function(){return tH.keys(this._nodes)},iH.prototype.sources=function(){var e=this;return tH.filter(this.nodes(),(function(t){return tH.isEmpty(e._in[t])}))},iH.prototype.sinks=function(){var e=this;return tH.filter(this.nodes(),(function(t){return tH.isEmpty(e._out[t])}))},iH.prototype.setNodes=function(e,t){var n=arguments,r=this;return tH.each(e,(function(e){n.length>1?r.setNode(e,t):r.setNode(e)})),this},iH.prototype.setNode=function(e,t){return tH.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=rH,this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},iH.prototype.node=function(e){return this._nodes[e]},iH.prototype.hasNode=function(e){return tH.has(this._nodes,e)},iH.prototype.removeNode=function(e){var t=this;if(tH.has(this._nodes,e)){var n=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],tH.each(this.children(e),(function(e){t.setParent(e)})),delete this._children[e]),tH.each(tH.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],tH.each(tH.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},iH.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(tH.isUndefined(t))t=rH;else{for(var n=t+="";!tH.isUndefined(n);n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},iH.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},iH.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!==rH)return t}},iH.prototype.children=function(e){if(tH.isUndefined(e)&&(e=rH),this._isCompound){var t=this._children[e];if(t)return tH.keys(t)}else{if(e===rH)return this.nodes();if(this.hasNode(e))return[]}},iH.prototype.predecessors=function(e){var t=this._preds[e];if(t)return tH.keys(t)},iH.prototype.successors=function(e){var t=this._sucs[e];if(t)return tH.keys(t)},iH.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return tH.union(t,this.successors(e))},iH.prototype.isLeaf=function(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length},iH.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;tH.each(this._nodes,(function(n,r){e(r)&&t.setNode(r,n)})),tH.each(this._edgeObjs,(function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e))}));var r={};function i(e){var o=n.parent(e);return void 0===o||t.hasNode(o)?(r[e]=o,o):o in r?r[o]:i(o)}return this._isCompound&&tH.each(t.nodes(),(function(e){t.setParent(e,i(e))})),t},iH.prototype.setDefaultEdgeLabel=function(e){return tH.isFunction(e)||(e=tH.constant(e)),this._defaultEdgeLabelFn=e,this},iH.prototype.edgeCount=function(){return this._edgeCount},iH.prototype.edges=function(){return tH.values(this._edgeObjs)},iH.prototype.setPath=function(e,t){var n=this,r=arguments;return tH.reduce(e,(function(e,i){return r.length>1?n.setEdge(e,i,t):n.setEdge(e,i),i})),this},iH.prototype.setEdge=function(){var e,t,n,r,i=!1,o=arguments[0];"object"==typeof o&&null!==o&&"v"in o?(e=o.v,t=o.w,n=o.name,2===arguments.length&&(r=arguments[1],i=!0)):(e=o,t=arguments[1],n=arguments[3],arguments.length>2&&(r=arguments[2],i=!0)),e=""+e,t=""+t,tH.isUndefined(n)||(n=""+n);var s=aH(this._isDirected,e,t,n);if(tH.has(this._edgeLabels,s))return i&&(this._edgeLabels[s]=r),this;if(!tH.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[s]=i?r:this._defaultEdgeLabelFn(e,t,n);var a=lH(this._isDirected,e,t,n);return e=a.v,t=a.w,Object.freeze(a),this._edgeObjs[s]=a,oH(this._preds[t],e),oH(this._sucs[e],t),this._in[t][s]=a,this._out[e][s]=a,this._edgeCount++,this},iH.prototype.edge=function(e,t,n){var r=1===arguments.length?cH(this._isDirected,arguments[0]):aH(this._isDirected,e,t,n);return this._edgeLabels[r]},iH.prototype.hasEdge=function(e,t,n){var r=1===arguments.length?cH(this._isDirected,arguments[0]):aH(this._isDirected,e,t,n);return tH.has(this._edgeLabels,r)},iH.prototype.removeEdge=function(e,t,n){var r=1===arguments.length?cH(this._isDirected,arguments[0]):aH(this._isDirected,e,t,n),i=this._edgeObjs[r];return i&&(e=i.v,t=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],sH(this._preds[t],e),sH(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this},iH.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var r=tH.values(n);return t?tH.filter(r,(function(e){return e.v===t})):r}},iH.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var r=tH.values(n);return t?tH.filter(r,(function(e){return e.w===t})):r}},iH.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))};var uH={Graph:nH,version:"2.1.8"},hH=eH,dH=nH,fH={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:pH(e),edges:gH(e)};hH.isUndefined(e.graph())||(t.value=hH.clone(e.graph()));return t},read:function(e){var t=new dH(e.options).setGraph(e.value);return hH.each(e.nodes,(function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)})),hH.each(e.edges,(function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)})),t}};function pH(e){return hH.map(e.nodes(),(function(t){var n=e.node(t),r=e.parent(t),i={v:t};return hH.isUndefined(n)||(i.value=n),hH.isUndefined(r)||(i.parent=r),i}))}function gH(e){return hH.map(e.edges(),(function(t){var n=e.edge(t),r={v:t.v,w:t.w};return hH.isUndefined(t.name)||(r.name=t.name),hH.isUndefined(n)||(r.value=n),r}))}var mH=eH,vH=function(e){var t,n={},r=[];function i(r){mH.has(n,r)||(n[r]=!0,t.push(r),mH.each(e.successors(r),i),mH.each(e.predecessors(r),i))}return mH.each(e.nodes(),(function(e){t=[],i(e),t.length&&r.push(t)})),r};var yH=eH,bH=xH;function xH(){this._arr=[],this._keyIndices={}}xH.prototype.size=function(){return this._arr.length},xH.prototype.keys=function(){return this._arr.map((function(e){return e.key}))},xH.prototype.has=function(e){return yH.has(this._keyIndices,e)},xH.prototype.priority=function(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority},xH.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},xH.prototype.add=function(e,t){var n=this._keyIndices;if(e=String(e),!yH.has(n,e)){var r=this._arr,i=r.length;return n[e]=i,r.push({key:e,priority:t}),this._decrease(i),!0}return!1},xH.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},xH.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},xH.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,i=e;n<t.length&&(i=t[n].priority<t[i].priority?n:i,r<t.length&&(i=t[r].priority<t[i].priority?r:i),i!==e&&(this._swap(e,i),this._heapify(i)))},xH.prototype._decrease=function(e){for(var t,n=this._arr,r=n[e].priority;0!==e&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t},xH.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,i=n[e],o=n[t];n[e]=o,n[t]=i,r[o.key]=e,r[i.key]=t};var wH=bH,CH=function(e,t,n,r){return function(e,t,n,r){var i,o,s={},a=new wH,l=function(e){var t=e.v!==i?e.v:e.w,r=s[t],l=n(e),c=o.distance+l;if(l<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+l);c<r.distance&&(r.distance=c,r.predecessor=i,a.decrease(t,c))};e.nodes().forEach((function(e){var n=e===t?0:Number.POSITIVE_INFINITY;s[e]={distance:n},a.add(e,n)}));for(;a.size()>0&&(i=a.removeMin(),(o=s[i]).distance!==Number.POSITIVE_INFINITY);)r(i).forEach(l);return s}(e,String(t),n||EH,r||function(t){return e.outEdges(t)})},EH=eH.constant(1);var _H=CH,SH=eH,OH=function(e,t,n){return SH.transform(e.nodes(),(function(r,i){r[i]=_H(e,i,t,n)}),{})};var AH=eH,kH=function(e){var t=0,n=[],r={},i=[];function o(s){var a=r[s]={onStack:!0,lowlink:t,index:t++};if(n.push(s),e.successors(s).forEach((function(e){AH.has(r,e)?r[e].onStack&&(a.lowlink=Math.min(a.lowlink,r[e].index)):(o(e),a.lowlink=Math.min(a.lowlink,r[e].lowlink))})),a.lowlink===a.index){var l,c=[];do{l=n.pop(),r[l].onStack=!1,c.push(l)}while(s!==l);i.push(c)}}return e.nodes().forEach((function(e){AH.has(r,e)||o(e)})),i};var MH=eH,TH=kH,PH=function(e){return MH.filter(TH(e),(function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])}))};var DH=function(e,t,n){return function(e,t,n){var r={},i=e.nodes();return i.forEach((function(e){r[e]={},r[e][e]={distance:0},i.forEach((function(t){e!==t&&(r[e][t]={distance:Number.POSITIVE_INFINITY})})),n(e).forEach((function(n){var i=n.v===e?n.w:n.v,o=t(n);r[e][i]={distance:o,predecessor:e}}))})),i.forEach((function(e){var t=r[e];i.forEach((function(n){var o=r[n];i.forEach((function(n){var r=o[e],i=t[n],s=o[n],a=r.distance+i.distance;a<s.distance&&(s.distance=a,s.predecessor=i.predecessor)}))}))})),r}(e,t||NH,n||function(t){return e.outEdges(t)})},NH=eH.constant(1);var RH=eH,IH=jH;function jH(e){var t={},n={},r=[];if(RH.each(e.sinks(),(function i(o){if(RH.has(n,o))throw new LH;RH.has(t,o)||(n[o]=!0,t[o]=!0,RH.each(e.predecessors(o),i),delete n[o],r.push(o))})),RH.size(t)!==e.nodeCount())throw new LH;return r}function LH(){}jH.CycleException=LH,LH.prototype=new Error;var FH=IH,GH=function(e){try{FH(e)}catch(e){if(e instanceof FH.CycleException)return!1;throw e}return!0};var BH=eH,zH=function(e,t,n){BH.isArray(t)||(t=[t]);var r=(e.isDirected()?e.successors:e.neighbors).bind(e),i=[],o={};return BH.each(t,(function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);UH(e,t,"post"===n,o,r,i)})),i};function UH(e,t,n,r,i,o){BH.has(r,t)||(r[t]=!0,n||o.push(t),BH.each(i(t),(function(t){UH(e,t,n,r,i,o)})),n&&o.push(t))}var VH=zH,HH=function(e,t){return VH(e,t,"post")};var WH=zH,$H=function(e,t){return WH(e,t,"pre")};var XH=eH,YH=nH,qH=bH,KH=function(e,t){var n,r=new YH,i={},o=new qH;function s(e){var r=e.v===n?e.w:e.v,s=o.priority(r);if(void 0!==s){var a=t(e);a<s&&(i[r]=n,o.decrease(r,a))}}if(0===e.nodeCount())return r;XH.each(e.nodes(),(function(e){o.add(e,Number.POSITIVE_INFINITY),r.setNode(e)})),o.decrease(e.nodes()[0],0);var a=!1;for(;o.size()>0;){if(n=o.removeMin(),XH.has(i,n))r.setEdge(n,i[n]);else{if(a)throw new Error("Input graph is not connected: "+e);a=!0}e.nodeEdges(n).forEach(s)}return r};var ZH,JH={Graph:uH.Graph,json:fH,alg:{components:vH,dijkstra:CH,dijkstraAll:OH,findCycles:PH,floydWarshall:DH,isAcyclic:GH,postorder:HH,preorder:$H,prim:KH,tarjan:kH,topsort:IH},version:uH.version};try{ZH=JH}catch(Qre){}ZH||(ZH=window.graphlib);var QH=ZH,eW=YF;var tW=function(e){return eW(e,5)},nW=sN,rW=dj,iW=RI,oW=WN;var sW=function(e,t,n){if(!oW(n))return!1;var r=typeof t;return!!("number"==r?rW(n)&&iW(t,n.length):"string"==r&&t in n)&&nW(n[t],e)},aW=wV,lW=sN,cW=sW,uW=Mj,hW=Object.prototype,dW=hW.hasOwnProperty,fW=aW((function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&cW(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],s=uW(o),a=-1,l=s.length;++a<l;){var c=s[a],u=e[c];(void 0===u||lW(u,hW[c])&&!dW.call(e,c))&&(e[c]=o[c])}return e})),pW=fW,gW=Pz,mW=dj,vW=mj;var yW=function(e){return function(t,n,r){var i=Object(t);if(!mW(t)){var o=gW(n);t=vW(t),n=function(e){return o(i[e],e,i)}}var s=e(t,n,r);return s>-1?i[o?t[s]:s]:void 0}},bW=/\s/;var xW=function(e){for(var t=e.length;t--&&bW.test(e.charAt(t)););return t},wW=xW,CW=/^\s+/;var EW=function(e){return e?e.slice(0,wW(e)+1).replace(CW,""):e},_W=EW,SW=WN,OW=yB,AW=/^[-+]0x[0-9a-f]+$/i,kW=/^0b[01]+$/i,MW=/^0o[0-7]+$/i,TW=parseInt;var PW=function(e){if("number"==typeof e)return e;if(OW(e))return NaN;if(SW(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=SW(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=_W(e);var n=kW.test(e);return n||MW.test(e)?TW(e.slice(2),n?2:8):AW.test(e)?NaN:+e},DW=PW,NW=1/0;var RW=function(e){return e?(e=DW(e))===NW||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0},IW=RW;var jW=function(e){var t=IW(e),n=t%1;return t==t?n?t-n:t:0},LW=CV,FW=Pz,GW=jW,BW=Math.max;var zW=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:GW(n);return i<0&&(i=BW(r+i,0)),LW(e,FW(t),i)},UW=yW(zW),VW=sV;var HW=function(e){return(null==e?0:e.length)?VW(e,1):[]},WW=QF,$W=lG,XW=Mj;var YW=function(e,t){return null==e?e:WW(e,$W(t),XW)};var qW=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},KW=hI,ZW=nG,JW=Pz;var QW=function(e,t){var n={};return t=JW(t),ZW(e,(function(e,r,i){KW(n,r,t(e,r,i))})),n},e$=yB;var t$=function(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],s=t(o);if(null!=s&&(void 0===a?s==s&&!e$(s):n(s,a)))var a=s,l=o}return l};var n$=t$,r$=function(e,t){return e>t},i$=sG;var o$=function(e){return e&&e.length?n$(e,i$,r$):void 0},s$=hI,a$=sN;var l$=function(e,t,n){(void 0!==n&&!a$(e[t],n)||void 0===n&&!(t in e))&&s$(e,t,n)},c$=HN,u$=Xj,h$=xI,d$=Function.prototype,f$=Object.prototype,p$=d$.toString,g$=f$.hasOwnProperty,m$=p$.call(Object);var v$=function(e){if(!h$(e)||"[object Object]"!=c$(e))return!1;var t=u$(e);if(null===t)return!0;var n=g$.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&p$.call(n)==m$};var y$=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},b$=yI,x$=Mj;var w$=l$,C$=Nj.exports,E$=XL,_$=Rj,S$=aF,O$=MI,A$=TI,k$=VV,M$=PI.exports,T$=YN,P$=WN,D$=v$,N$=XI,R$=y$,I$=function(e){return b$(e,x$(e))};var j$=function(e,t,n,r,i,o,s){var a=R$(e,n),l=R$(t,n),c=s.get(l);if(c)w$(e,n,c);else{var u=o?o(a,l,n+"",e,t,s):void 0,h=void 0===u;if(h){var d=A$(l),f=!d&&M$(l),p=!d&&!f&&N$(l);u=l,d||f||p?A$(a)?u=a:k$(a)?u=_$(a):f?(h=!1,u=C$(l,!0)):p?(h=!1,u=E$(l,!0)):u=[]:D$(l)||O$(l)?(u=a,O$(a)?u=I$(a):P$(a)&&!T$(a)||(u=S$(l))):h=!1}h&&(s.set(l,u),i(u,l,r,o,s),s.delete(l)),w$(e,n,u)}},L$=oI,F$=l$,G$=QF,B$=j$,z$=WN,U$=Mj,V$=y$;var H$=function e(t,n,r,i,o){t!==n&&G$(n,(function(s,a){if(o||(o=new L$),z$(s))B$(t,n,a,r,e,i,o);else{var l=i?i(V$(t,a),s,a+"",t,n,o):void 0;void 0===l&&(l=s),F$(t,a,l)}}),U$)},W$=wV,$$=sW;var X$=function(e){return W$((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&$$(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var a=n[r];a&&e(t,a,r,o)}return t}))},Y$=H$,q$=X$((function(e,t,n){Y$(e,t,n)})),K$=q$;var Z$=function(e,t){return e<t},J$=t$,Q$=Z$,eX=sG;var tX=function(e){return e&&e.length?J$(e,eX,Q$):void 0},nX=t$,rX=Pz,iX=Z$;var oX=function(e,t){return e&&e.length?nX(e,rX(t),iX):void 0},sX=DN,aX=function(){return sX.Date.now()},lX=gI,cX=WB,uX=RI,hX=WN,dX=XB;var fX=function(e,t,n,r){if(!hX(e))return e;for(var i=-1,o=(t=cX(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var l=dX(t[i]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=s){var u=a[l];void 0===(c=r?r(u,l,a):void 0)&&(c=hX(u)?u:uX(t[i+1])?[]:{})}lX(a,l,c),a=a[l]}return e},pX=KB,gX=fX,mX=WB;var vX=function(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=pX(e,s);n(a,s)&&gX(o,mX(s,e),a)}return o},yX=vX,bX=cz;var xX=function(e,t){return yX(e,t,(function(t,n){return bX(e,n)}))},wX=HW,CX=uV,EX=vV;var _X=function(e){return EX(CX(e,void 0,wX),e+"")},SX=xX,OX=_X((function(e,t){return null==e?{}:SX(e,t)})),AX=OX,kX=Math.ceil,MX=Math.max;var TX=function(e,t,n,r){for(var i=-1,o=MX(kX((t-e)/(n||1)),0),s=Array(o);o--;)s[r?o:++i]=e,e+=n;return s},PX=TX,DX=sW,NX=RW;var RX=function(e){return function(t,n,r){return r&&"number"!=typeof r&&DX(t,n,r)&&(n=r=void 0),t=NX(t),void 0===n?(n=t,t=0):n=NX(n),r=void 0===r?t<n?1:-1:NX(r),PX(t,n,r,e)}}();var IX=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e},jX=yB;var LX=function(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=jX(e),s=void 0!==t,a=null===t,l=t==t,c=jX(t);if(!a&&!c&&!o&&e>t||o&&s&&l&&!a&&!c||r&&s&&l||!n&&l||!i)return 1;if(!r&&!o&&!c&&e<t||c&&n&&i&&!r&&!o||a&&n&&i||!s&&i||!l)return-1}return 0};var FX=function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;++r<s;){var l=LX(i[r],o[r]);if(l)return r>=a?l:l*("desc"==n[r]?-1:1)}return e.index-t.index},GX=DB,BX=KB,zX=Pz,UX=tU,VX=IX,HX=zI,WX=FX,$X=sG,XX=TI;var YX=function(e,t,n){t=t.length?GX(t,(function(e){return XX(e)?function(t){return BX(t,1===e.length?e[0]:e)}:e})):[$X];var r=-1;t=GX(t,HX(zX));var i=UX(e,(function(e,n,i){var o=GX(t,(function(t){return t(e)}));return{criteria:o,index:++r,value:e}}));return VX(i,(function(e,t){return WX(e,t,n)}))},qX=sV,KX=YX,ZX=sW,JX=wV((function(e,t){if(null==e)return[];var n=t.length;return n>1&&ZX(e,t[0],t[1])?t=[]:n>2&&ZX(t[0],t[1],t[2])&&(t=[t[0]]),KX(e,qX(t,1),[])})),QX=JX,eY=BB,tY=0;var nY=function(e){var t=++tY;return eY(e)+t};var rY=function(e,t,n){for(var r=-1,i=e.length,o=t.length,s={};++r<i;){var a=r<o?t[r]:void 0;n(s,e[r],a)}return s},iY=gI,oY=rY;var sY,aY=function(e,t){return oY(e||[],t||[],iY)};try{sY={cloneDeep:tW,constant:ZF,defaults:pW,each:pG,filter:jz,find:UW,flatten:HW,forEach:fG,forIn:YW,has:zz,isUndefined:Jz,last:qW,map:sU,mapValues:QW,max:o$,merge:K$,min:tX,minBy:oX,now:aX,pick:AX,range:RX,reduce:pU,sortBy:QX,uniqueId:nY,values:QV,zipObject:aY}}catch(Qre){}sY||(sY=window._);var lY=sY,cY=uY;function uY(){var e={};e._next=e._prev=e,this._sentinel=e}function hY(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function dY(e,t){if("_next"!==e&&"_prev"!==e)return t}uY.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return hY(t),t},uY.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&hY(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},uY.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,dY)),n=n._prev;return"["+e.join(", ")+"]"};var fY=lY,pY=QH.Graph,gY=cY,mY=function(e,t){if(e.nodeCount()<=1)return[];var n=function(e,t){var n=new pY,r=0,i=0;fY.forEach(e.nodes(),(function(e){n.setNode(e,{v:e,in:0,out:0})})),fY.forEach(e.edges(),(function(e){var o=n.edge(e.v,e.w)||0,s=t(e),a=o+s;n.setEdge(e.v,e.w,a),i=Math.max(i,n.node(e.v).out+=s),r=Math.max(r,n.node(e.w).in+=s)}));var o=fY.range(i+r+3).map((function(){return new gY})),s=r+1;return fY.forEach(n.nodes(),(function(e){bY(o,s,n.node(e))})),{graph:n,buckets:o,zeroIdx:s}}(e,t||vY),r=function(e,t,n){var r,i=[],o=t[t.length-1],s=t[0];for(;e.nodeCount();){for(;r=s.dequeue();)yY(e,t,n,r);for(;r=o.dequeue();)yY(e,t,n,r);if(e.nodeCount())for(var a=t.length-2;a>0;--a)if(r=t[a].dequeue()){i=i.concat(yY(e,t,n,r,!0));break}}return i}(n.graph,n.buckets,n.zeroIdx);return fY.flatten(fY.map(r,(function(t){return e.outEdges(t.v,t.w)})),!0)},vY=fY.constant(1);function yY(e,t,n,r,i){var o=i?[]:void 0;return fY.forEach(e.inEdges(r.v),(function(r){var s=e.edge(r),a=e.node(r.v);i&&o.push({v:r.v,w:r.w}),a.out-=s,bY(t,n,a)})),fY.forEach(e.outEdges(r.v),(function(r){var i=e.edge(r),o=r.w,s=e.node(o);s.in-=i,bY(t,n,s)})),e.removeNode(r.v),o}function bY(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var xY=lY,wY=mY,CY={run:function(e){var t="greedy"===e.graph().acyclicer?wY(e,function(e){return function(t){return e.edge(t).weight}}(e)):function(e){var t=[],n={},r={};function i(o){xY.has(r,o)||(r[o]=!0,n[o]=!0,xY.forEach(e.outEdges(o),(function(e){xY.has(n,e.w)?t.push(e):i(e.w)})),delete n[o])}return xY.forEach(e.nodes(),i),t}(e);xY.forEach(t,(function(t){var n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,xY.uniqueId("rev"))}))},undo:function(e){xY.forEach(e.edges(),(function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}}))}};var EY=lY,_Y=QH.Graph,SY={addDummyNode:OY,simplify:function(e){var t=(new _Y).setGraph(e.graph());return EY.forEach(e.nodes(),(function(n){t.setNode(n,e.node(n))})),EY.forEach(e.edges(),(function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})})),t},asNonCompoundGraph:function(e){var t=new _Y({multigraph:e.isMultigraph()}).setGraph(e.graph());return EY.forEach(e.nodes(),(function(n){e.children(n).length||t.setNode(n,e.node(n))})),EY.forEach(e.edges(),(function(n){t.setEdge(n,e.edge(n))})),t},successorWeights:function(e){var t=EY.map(e.nodes(),(function(t){var n={};return EY.forEach(e.outEdges(t),(function(t){n[t.w]=(n[t.w]||0)+e.edge(t).weight})),n}));return EY.zipObject(e.nodes(),t)},predecessorWeights:function(e){var t=EY.map(e.nodes(),(function(t){var n={};return EY.forEach(e.inEdges(t),(function(t){n[t.v]=(n[t.v]||0)+e.edge(t).weight})),n}));return EY.zipObject(e.nodes(),t)},intersectRect:function(e,t){var n,r,i=e.x,o=e.y,s=t.x-i,a=t.y-o,l=e.width/2,c=e.height/2;if(!s&&!a)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(a)*l>Math.abs(s)*c?(a<0&&(c=-c),n=c*s/a,r=c):(s<0&&(l=-l),n=l,r=l*a/s);return{x:i+n,y:o+r}},buildLayerMatrix:function(e){var t=EY.map(EY.range(AY(e)+1),(function(){return[]}));return EY.forEach(e.nodes(),(function(n){var r=e.node(n),i=r.rank;EY.isUndefined(i)||(t[i][r.order]=n)})),t},normalizeRanks:function(e){var t=EY.min(EY.map(e.nodes(),(function(t){return e.node(t).rank})));EY.forEach(e.nodes(),(function(n){var r=e.node(n);EY.has(r,"rank")&&(r.rank-=t)}))},removeEmptyRanks:function(e){var t=EY.min(EY.map(e.nodes(),(function(t){return e.node(t).rank}))),n=[];EY.forEach(e.nodes(),(function(r){var i=e.node(r).rank-t;n[i]||(n[i]=[]),n[i].push(r)}));var r=0,i=e.graph().nodeRankFactor;EY.forEach(n,(function(t,n){EY.isUndefined(t)&&n%i!=0?--r:r&&EY.forEach(t,(function(t){e.node(t).rank+=r}))}))},addBorderNode:function(e,t,n,r){var i={width:0,height:0};arguments.length>=4&&(i.rank=n,i.order=r);return OY(e,"border",i,t)},maxRank:AY,partition:function(e,t){var n={lhs:[],rhs:[]};return EY.forEach(e,(function(e){t(e)?n.lhs.push(e):n.rhs.push(e)})),n},time:function(e,t){var n=EY.now();try{return t()}finally{console.log(e+" time: "+(EY.now()-n)+"ms")}},notime:function(e,t){return t()}};function OY(e,t,n,r){var i;do{i=EY.uniqueId(r)}while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function AY(e){return EY.max(EY.map(e.nodes(),(function(t){var n=e.node(t).rank;if(!EY.isUndefined(n))return n})))}var kY=lY,MY=SY,TY={run:function(e){e.graph().dummyChains=[],kY.forEach(e.edges(),(function(t){!function(e,t){var n,r,i,o=t.v,s=e.node(o).rank,a=t.w,l=e.node(a).rank,c=t.name,u=e.edge(t),h=u.labelRank;if(l===s+1)return;for(e.removeEdge(t),i=0,++s;s<l;++i,++s)u.points=[],r={width:0,height:0,edgeLabel:u,edgeObj:t,rank:s},n=MY.addDummyNode(e,"edge",r,"_d"),s===h&&(r.width=u.width,r.height=u.height,r.dummy="edge-label",r.labelpos=u.labelpos),e.setEdge(o,n,{weight:u.weight},c),0===i&&e.graph().dummyChains.push(n),o=n;e.setEdge(o,a,{weight:u.weight},c)}(e,t)}))},undo:function(e){kY.forEach(e.graph().dummyChains,(function(t){var n,r=e.node(t),i=r.edgeLabel;for(e.setEdge(r.edgeObj,i);r.dummy;)n=e.successors(t)[0],e.removeNode(t),i.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),t=n,r=e.node(t)}))}};var PY=lY,DY={longestPath:function(e){var t={};PY.forEach(e.sources(),(function n(r){var i=e.node(r);if(PY.has(t,r))return i.rank;t[r]=!0;var o=PY.min(PY.map(e.outEdges(r),(function(t){return n(t.w)-e.edge(t).minlen})));return o!==Number.POSITIVE_INFINITY&&null!=o||(o=0),i.rank=o}))},longestPathWithLayer:function(e){var t={},n=0;function r(t,n){var i=e.node(t),o=isNaN(i.layer)?n:i.layer;(void 0===i.rank||i.rank<o)&&(i.rank=o),PY.map(e.outEdges(t),(function(t){r(t.w,o+e.edge(t).minlen)}))}PY.forEach(e.sources(),(function r(i){var o=e.node(i);if(PY.has(t,i))return o.rank;t[i]=!0;var s=PY.min(PY.map(e.outEdges(i),(function(t){return r(t.w)-e.edge(t).minlen})));return s!==Number.POSITIVE_INFINITY&&null!=s||(s=0),o.rank=s,n=Math.min(o.rank,n),o.rank})),n+=1,e.nodes().forEach((function(t){var i=e.node(t);isNaN(i.layer)?i.rank-=n:r(t,i.layer)}))},slack:function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}};var NY=lY,RY=QH.Graph,IY=DY.slack,jY=function(e){var t,n,r=new RY({directed:!1}),i=e.nodes()[0],o=e.nodeCount();r.setNode(i,{});for(;FY(r,e)<o;)t=BY(r,e),n=r.hasNode(t.v)?IY(e,t):-IY(e,t),zY(r,e,n);return r},LY=function(e){var t,n,r=new RY({directed:!1}),i=e.nodes()[0],o=e.nodeCount();r.setNode(i,{});for(;GY(r,e)<o;)t=BY(r,e),n=r.hasNode(t.v)?IY(e,t):-IY(e,t),zY(r,e,n);return r};function FY(e,t){return NY.forEach(e.nodes(),(function n(r){NY.forEach(t.nodeEdges(r),(function(i){var o=i.v,s=r===o?i.w:o;e.hasNode(s)||IY(t,i)||(e.setNode(s,{}),e.setEdge(r,s,{}),n(s))}))})),e.nodeCount()}function GY(e,t){return NY.forEach(e.nodes(),(function n(r){NY.forEach(t.nodeEdges(r),(function(i){var o=i.v,s=r===o?i.w:o;e.hasNode(s)||void 0===t.node(s).layer&&IY(t,i)||(e.setNode(s,{}),e.setEdge(r,s,{}),n(s))}))})),e.nodeCount()}function BY(e,t){return NY.minBy(t.edges(),(function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return IY(t,n)}))}function zY(e,t,n){NY.forEach(e.nodes(),(function(e){t.node(e).rank+=n}))}var UY=lY,VY=jY,HY=DY.slack,WY=DY.longestPath,$Y=QH.alg.preorder,XY=QH.alg.postorder,YY=SY.simplify,qY=KY;function KY(e){e=YY(e),WY(e);var t,n=VY(e);for(QY(n),ZY(n,e);t=tq(n);)rq(n,e,t,nq(n,e,t))}function ZY(e,t){var n=XY(e,e.nodes());n=n.slice(0,n.length-1),UY.forEach(n,(function(n){!function(e,t,n){var r=e.node(n).parent;e.edge(n,r).cutvalue=JY(e,t,n)}(e,t,n)}))}function JY(e,t,n){var r=e.node(n).parent,i=!0,o=t.edge(n,r),s=0;return o||(i=!1,o=t.edge(r,n)),s=o.weight,UY.forEach(t.nodeEdges(n),(function(o){var a=o.v===n,l=a?o.w:o.v;if(l!==r){var c=a===i,u=t.edge(o).weight;if(s+=c?u:-u,function(e,t,n){return e.hasEdge(t,n)}(e,n,l)){var h=e.edge(n,l).cutvalue;s+=c?-h:h}}})),s}function QY(e,t){arguments.length<2&&(t=e.nodes()[0]),eq(e,{},1,t)}function eq(e,t,n,r,i){var o=n,s=e.node(r);return t[r]=!0,UY.forEach(e.neighbors(r),(function(i){UY.has(t,i)||(n=eq(e,t,n,i,r))})),s.low=o,s.lim=n++,i?s.parent=i:delete s.parent,n}function tq(e){return UY.find(e.edges(),(function(t){return e.edge(t).cutvalue<0}))}function nq(e,t,n){var r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);var o=e.node(r),s=e.node(i),a=o,l=!1;o.lim>s.lim&&(a=s,l=!0);var c=UY.filter(t.edges(),(function(t){return l===iq(e,e.node(t.v),a)&&l!==iq(e,e.node(t.w),a)}));return UY.minBy(c,(function(e){return HY(t,e)}))}function rq(e,t,n,r){var i=n.v,o=n.w;e.removeEdge(i,o),e.setEdge(r.v,r.w,{}),QY(e),ZY(e,t),function(e,t){var n=UY.find(e.nodes(),(function(e){return!t.node(e).parent})),r=$Y(e,n);r=r.slice(1),UY.forEach(r,(function(n){var r=e.node(n).parent,i=t.edge(n,r),o=!1;i||(i=t.edge(r,n),o=!0),t.node(n).rank=t.node(r).rank+(o?i.minlen:-i.minlen)}))}(e,t)}function iq(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}KY.initLowLimValues=QY,KY.initCutValues=ZY,KY.calcCutValue=JY,KY.leaveEdge=tq,KY.enterEdge=nq,KY.exchangeEdges=rq;var oq=DY.longestPathWithLayer,sq=LY,aq=qY,lq=function(e){switch(e.graph().ranker){case"network-simplex":!function(e){aq(e)}(e);break;default:uq(e);break;case"longest-path":cq(e)}};var cq=oq;function uq(e){oq(e),sq(e)}var hq=lY,dq=function(e){var t=function(e){var t={},n=0;function r(i){var o=n;hq.forEach(e.children(i),r),t[i]={low:o,lim:n++}}return hq.forEach(e.children(),r),t}(e);hq.forEach(e.graph().dummyChains,(function(n){for(var r=e.node(n),i=r.edgeObj,o=function(e,t,n,r){var i,o,s=[],a=[],l=Math.min(t[n].low,t[r].low),c=Math.max(t[n].lim,t[r].lim);i=n;do{i=e.parent(i),s.push(i)}while(i&&(t[i].low>l||c>t[i].lim));o=i,i=r;for(;(i=e.parent(i))!==o;)a.push(i);return{path:s.concat(a.reverse()),lca:o}}(e,t,i.v,i.w),s=o.path,a=o.lca,l=0,c=s[l],u=!0;n!==i.w;){if(r=e.node(n),u){for(;(c=s[l])!==a&&e.node(c).maxRank<r.rank;)l++;c===a&&(u=!1)}if(!u){for(;l<s.length-1&&e.node(c=s[l+1]).minRank<=r.rank;)l++;c=s[l]}e.setParent(n,c),n=e.successors(n)[0]}}))};var fq=lY,pq=SY,gq={run:function(e){var t=pq.addDummyNode(e,"root",{},"_root"),n=function(e){var t={};function n(r,i){var o=e.children(r);o&&o.length&&fq.forEach(o,(function(e){n(e,i+1)})),t[r]=i}return fq.forEach(e.children(),(function(e){n(e,1)})),t}(e),r=fq.max(fq.values(n))-1,i=2*r+1;e.graph().nestingRoot=t,fq.forEach(e.edges(),(function(t){e.edge(t).minlen*=i}));var o=function(e){return fq.reduce(e.edges(),(function(t,n){return t+e.edge(n).weight}),0)}(e)+1;fq.forEach(e.children(),(function(s){mq(e,t,i,o,r,n,s)})),e.graph().nodeRankFactor=i},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,fq.forEach(e.edges(),(function(t){e.edge(t).nestingEdge&&e.removeEdge(t)}))}};function mq(e,t,n,r,i,o,s){var a=e.children(s);if(a.length){var l=pq.addBorderNode(e,"_bt"),c=pq.addBorderNode(e,"_bb"),u=e.node(s);e.setParent(l,s),u.borderTop=l,e.setParent(c,s),u.borderBottom=c,fq.forEach(a,(function(a){mq(e,t,n,r,i,o,a);var u=e.node(a),h=u.borderTop?u.borderTop:a,d=u.borderBottom?u.borderBottom:a,f=u.borderTop?r:2*r,p=h!==d?1:i-o[s]+1;e.setEdge(l,h,{weight:f,minlen:p,nestingEdge:!0}),e.setEdge(d,c,{weight:f,minlen:p,nestingEdge:!0})})),e.parent(s)||e.setEdge(t,l,{weight:0,minlen:i+o[s]})}else s!==t&&e.setEdge(t,s,{weight:0,minlen:n})}var vq=lY,yq=SY,bq=function(e){vq.forEach(e.children(),(function t(n){var r=e.children(n),i=e.node(n);if(r.length&&vq.forEach(r,t),vq.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var o=i.minRank,s=i.maxRank+1;o<s;++o)xq(e,"borderLeft","_bl",n,i,o),xq(e,"borderRight","_br",n,i,o)}}))};function xq(e,t,n,r,i,o){var s={width:0,height:0,rank:o,borderType:t},a=i[t][o-1],l=yq.addDummyNode(e,"border",s,n);i[t][o]=l,e.setParent(l,r),a&&e.setEdge(a,l,{weight:1})}var wq=lY,Cq={adjust:function(e){var t=e.graph().rankdir.toLowerCase();"lr"!==t&&"rl"!==t||Eq(e)},undo:function(e){var t=e.graph().rankdir.toLowerCase();"bt"!==t&&"rl"!==t||function(e){wq.forEach(e.nodes(),(function(t){Sq(e.node(t))})),wq.forEach(e.edges(),(function(t){var n=e.edge(t);wq.forEach(n.points,Sq),wq.has(n,"y")&&Sq(n)}))}(e);"lr"!==t&&"rl"!==t||(!function(e){wq.forEach(e.nodes(),(function(t){Oq(e.node(t))})),wq.forEach(e.edges(),(function(t){var n=e.edge(t);wq.forEach(n.points,Oq),wq.has(n,"x")&&Oq(n)}))}(e),Eq(e))}};function Eq(e){wq.forEach(e.nodes(),(function(t){_q(e.node(t))})),wq.forEach(e.edges(),(function(t){_q(e.edge(t))}))}function _q(e){var t=e.width;e.width=e.height,e.height=t}function Sq(e){e.y=-e.y}function Oq(e){var t=e.x;e.x=e.y,e.y=t}var Aq=lY,kq=function(e){var t={},n=Aq.filter(e.nodes(),(function(t){return!e.children(t).length})),r=Aq.max(Aq.map(n,(function(t){return e.node(t).rank}))),i=Aq.map(Aq.range(r+1),(function(){return[]}));function o(n){if(!Aq.has(t,n)){t[n]=!0;var r=e.node(n);i[r.rank].push(n),Aq.forEach(e.successors(n),o)}}var s=Aq.sortBy(n,(function(t){return e.node(t).rank})),a=Aq.sortBy(Aq.filter(s,(function(t){return void 0!==e.node(t).fixorder})),(function(t){return e.node(t).fixorder}));return Aq.forEach(a,(function(n){i[e.node(n).rank].push(n),t[n]=!0})),Aq.forEach(s,o),i};var Mq=lY,Tq=function(e,t){for(var n=0,r=1;r<t.length;++r)n+=Pq(e,t[r-1],t[r]);return n};function Pq(e,t,n){for(var r=Mq.zipObject(n,Mq.map(n,(function(e,t){return t}))),i=Mq.flatten(Mq.map(t,(function(t){return Mq.sortBy(Mq.map(e.outEdges(t),(function(t){return{pos:r[t.w],weight:e.edge(t).weight}})),"pos")})),!0),o=1;o<n.length;)o<<=1;var s=2*o-1;o-=1;var a=Mq.map(new Array(s),(function(){return 0})),l=0;return Mq.forEach(i.forEach((function(e){var t=e.pos+o;a[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=a[t+1]),a[t=t-1>>1]+=e.weight;l+=e.weight*n}))),l}var Dq=lY,Nq=function(e,t){return Dq.map(t,(function(t){var n=e.inEdges(t);if(n.length){var r=Dq.reduce(n,(function(t,n){var r=e.edge(n),i=e.node(n.v);return{sum:t.sum+r.weight*i.order,weight:t.weight+r.weight}}),{sum:0,weight:0});return{v:t,barycenter:r.sum/r.weight,weight:r.weight}}return{v:t}}))};var Rq=lY,Iq=function(e,t){var n={};return Rq.forEach(e,(function(e,t){var r=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};Rq.isUndefined(e.barycenter)||(r.barycenter=e.barycenter,r.weight=e.weight)})),Rq.forEach(t.edges(),(function(e){var t=n[e.v],r=n[e.w];Rq.isUndefined(t)||Rq.isUndefined(r)||(r.indegree++,t.out.push(n[e.w]))})),function(e){var t=[];function n(e){return function(t){t.merged||(Rq.isUndefined(t.barycenter)||Rq.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&function(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight);t.weight&&(n+=t.barycenter*t.weight,r+=t.weight);e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}(e,t)}}function r(t){return function(n){n.in.push(t),0==--n.indegree&&e.push(n)}}for(;e.length;){var i=e.pop();t.push(i),Rq.forEach(i.in.reverse(),n(i)),Rq.forEach(i.out,r(i))}return Rq.map(Rq.filter(t,(function(e){return!e.merged})),(function(e){return Rq.pick(e,["vs","i","barycenter","weight"])}))}(Rq.filter(n,(function(e){return!e.indegree})))};var jq=lY,Lq=SY,Fq=function(e,t,n){var r=Lq.partition(e,(function(e){return jq.has(e,"fixorder")&&!isNaN(e.fixorder)||jq.has(e,"barycenter")})),i=r.lhs,o=jq.sortBy(r.rhs,(function(e){return-e.i})),s=[],a=0,l=0,c=0;i.sort(function(e,t){return function(n,r){if(void 0!==n.fixorder&&void 0!==r.fixorder)return n.fixorder-r.fixorder;if(n.barycenter<r.barycenter)return-1;if(n.barycenter>r.barycenter)return 1;if(t&&void 0!==n.order&&void 0!==r.order){if(n.order<r.order)return-1;if(n.order>r.order)return 1}return e?r.i-n.i:n.i-r.i}}(!!t,!!n)),c=Gq(s,o,c),jq.forEach(i,(function(e){c+=e.vs.length,s.push(e.vs),a+=e.barycenter*e.weight,l+=e.weight,c=Gq(s,o,c)}));var u={vs:jq.flatten(s,!0)};l&&(u.barycenter=a/l,u.weight=l);return u};function Gq(e,t,n){for(var r;t.length&&(r=jq.last(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}var Bq=lY,zq=Nq,Uq=Iq,Vq=Fq,Hq=function e(t,n,r,i,o){var s=t.children(n),a=t.node(n),l=a?a.borderLeft:void 0,c=a?a.borderRight:void 0,u={};l&&(s=Bq.filter(s,(function(e){return e!==l&&e!==c})));var h=zq(t,s);Bq.forEach(h,(function(n){if(t.children(n.v).length){var o=e(t,n.v,r,i);u[n.v]=o,Bq.has(o,"barycenter")&&function(e,t){Bq.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}(n,o)}}));var d=Uq(h,r);(function(e,t){Bq.forEach(e,(function(e){e.vs=Bq.flatten(e.vs.map((function(e){return t[e]?t[e].vs:e})),!0)}))})(d,u),Bq.forEach(d,(function(e){var n=t.node(e.vs[0]);e.fixorder=n.fixorder,e.order=n.order}));var f=Vq(d,i,o);if(l&&(f.vs=Bq.flatten([l,f.vs,c],!0),t.predecessors(l).length)){var p=t.node(t.predecessors(l)[0]),g=t.node(t.predecessors(c)[0]);Bq.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+p.order+g.order)/(f.weight+2),f.weight+=2}return f};var Wq=lY,$q=QH.Graph,Xq=function(e,t,n){var r=function(e){var t;for(;e.hasNode(t=Wq.uniqueId("_root")););return t}(e),i=new $q({compound:!0}).setGraph({root:r}).setDefaultNodeLabel((function(t){return e.node(t)}));return Wq.forEach(e.nodes(),(function(o){var s=e.node(o),a=e.parent(o);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(i.setNode(o),i.setParent(o,a||r),Wq.forEach(e[n](o),(function(t){var n=t.v===o?t.w:t.v,r=i.edge(n,o),s=Wq.isUndefined(r)?0:r.weight;i.setEdge(n,o,{weight:e.edge(t).weight+s})})),Wq.has(s,"minRank")&&i.setNode(o,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))})),i};var Yq=lY,qq=function(e,t,n){var r,i={};Yq.forEach(n,(function(n){for(var o,s,a=e.parent(n);a;){if((o=e.parent(a))?(s=i[o],i[o]=a):(s=r,r=a),s&&s!==a)return void t.setEdge(s,a);a=o}}))};var Kq=lY,Zq=kq,Jq=Tq,Qq=Hq,eK=Xq,tK=qq,nK=QH.Graph,rK=SY,iK=function(e){var t=rK.maxRank(e),n=oK(e,Kq.range(1,t+1),"inEdges"),r=oK(e,Kq.range(t-1,-1,-1),"outEdges"),i=Zq(e);aK(e,i);for(var o,s=Number.POSITIVE_INFINITY,a=0,l=0;l<4;++a,++l){sK(a%2?n:r,a%4>=2),i=rK.buildLayerMatrix(e);var c=Jq(e,i);c<s&&(l=0,o=Kq.cloneDeep(i),s=c)}for(i=Zq(e),aK(e,i),a=0,l=0;l<4;++a,++l)sK(a%2?n:r,a%4>=2,!0),i=rK.buildLayerMatrix(e),(c=Jq(e,i))<s&&(l=0,o=Kq.cloneDeep(i),s=c);aK(e,o)};function oK(e,t,n){return Kq.map(t,(function(t){return eK(e,t,n)}))}function sK(e,t,n){var r=new nK;Kq.forEach(e,(function(e){var i=e.graph().root,o=Qq(e,i,r,t,n);Kq.forEach(o.vs,(function(t,n){e.node(t).order=n})),tK(e,r,o.vs)}))}function aK(e,t){Kq.forEach(t,(function(t){Kq.forEach(t,(function(t,n){e.node(t).order=n}))}))}var lK=lY,cK=QH.Graph,uK=SY,hK=function(e){var t,n=uK.buildLayerMatrix(e),r=lK.merge(dK(e,n),fK(e,n)),i={};lK.forEach(["u","d"],(function(o){t="u"===o?n:lK.values(n).reverse(),lK.forEach(["l","r"],(function(n){"r"===n&&(t=lK.map(t,(function(e){return lK.values(e).reverse()})));var s=("u"===o?e.predecessors:e.successors).bind(e),a=mK(e,t,r,s),l=vK(e,t,a.root,a.align,"r"===n);"r"===n&&(l=lK.mapValues(l,(function(e){return-e}))),i[o+n]=l}))}));var o=yK(e,i);return bK(i,o),xK(i,e.graph().align)};function dK(e,t){var n={};return lK.reduce(t,(function(t,r){var i=0,o=0,s=t.length,a=lK.last(r);return lK.forEach(r,(function(t,l){var c=function(e,t){if(e.node(t).dummy)return lK.find(e.predecessors(t),(function(t){return e.node(t).dummy}))}(e,t),u=c?e.node(c).order:s;(c||t===a)&&(lK.forEach(r.slice(o,l+1),(function(t){lK.forEach(e.predecessors(t),(function(r){var o=e.node(r),s=o.order;!(s<i||u<s)||o.dummy&&e.node(t).dummy||pK(n,r,t)}))})),o=l+1,i=u)})),r})),n}function fK(e,t){var n={};function r(t,r,i,o,s){var a;lK.forEach(lK.range(r,i),(function(r){a=t[r],e.node(a).dummy&&lK.forEach(e.predecessors(a),(function(t){var r=e.node(t);r.dummy&&(r.order<o||r.order>s)&&pK(n,t,a)}))}))}return lK.reduce(t,(function(t,n){var i,o=-1,s=0;return lK.forEach(n,(function(a,l){if("border"===e.node(a).dummy){var c=e.predecessors(a);c.length&&(i=e.node(c[0]).order,r(n,s,l,o,i),s=l,o=i)}r(n,s,n.length,i,t.length)})),n})),n}function pK(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function gK(e,t,n){if(t>n){var r=t;t=n,n=r}return lK.has(e[t],n)}function mK(e,t,n,r){var i={},o={},s={};return lK.forEach(t,(function(e){lK.forEach(e,(function(e,t){i[e]=e,o[e]=e,s[e]=t}))})),lK.forEach(t,(function(e){var t=-1;lK.forEach(e,(function(e){var a=r(e);if(a.length){a=lK.sortBy(a,(function(e){return s[e]}));for(var l=(a.length-1)/2,c=Math.floor(l),u=Math.ceil(l);c<=u;++c){var h=a[c];o[e]===e&&t<s[h]&&!gK(n,e,h)&&(o[h]=e,o[e]=i[e]=i[h],t=s[h])}}}))})),{root:i,align:o}}function vK(e,t,n,r,i){var o={},s=function(e,t,n,r){var i=new cK,o=e.graph(),s=function(e,t,n){return function(r,i,o){var s,a=r.node(i),l=r.node(o),c=0;if(c+=a.width/2,lK.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":s=-a.width/2;break;case"r":s=a.width/2}if(s&&(c+=n?s:-s),s=0,c+=(a.dummy?t:e)/2,c+=(l.dummy?t:e)/2,c+=l.width/2,lK.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":s=l.width/2;break;case"r":s=-l.width/2}return s&&(c+=n?s:-s),s=0,c}}(o.nodesep,o.edgesep,r);return lK.forEach(t,(function(t){var r;lK.forEach(t,(function(t){var o=n[t];if(i.setNode(o),r){var a=n[r],l=i.edge(a,o);i.setEdge(a,o,Math.max(s(e,t,r),l||0))}r=t}))})),i}(e,t,n,i),a=i?"borderLeft":"borderRight";function l(e,t){for(var n=s.nodes(),r=n.pop(),i={};r;)i[r]?e(r):(i[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}return l((function(e){o[e]=s.inEdges(e).reduce((function(e,t){return Math.max(e,o[t.v]+s.edge(t))}),0)}),s.predecessors.bind(s)),l((function(t){var n=s.outEdges(t).reduce((function(e,t){return Math.min(e,o[t.w]-s.edge(t))}),Number.POSITIVE_INFINITY),r=e.node(t);n!==Number.POSITIVE_INFINITY&&r.borderType!==a&&(o[t]=Math.max(o[t],n))}),s.successors.bind(s)),lK.forEach(r,(function(e){o[e]=o[n[e]]})),o}function yK(e,t){return lK.minBy(lK.values(t),(function(t){var n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return lK.forIn(t,(function(t,i){var o=function(e,t){return e.node(t).width}(e,i)/2;n=Math.max(t+o,n),r=Math.min(t-o,r)})),n-r}))}function bK(e,t){var n=lK.values(t),r=lK.min(n),i=lK.max(n);lK.forEach(["u","d"],(function(n){lK.forEach(["l","r"],(function(o){var s,a=n+o,l=e[a];if(l!==t){var c=lK.values(l);(s="l"===o?r-lK.min(c):i-lK.max(c))&&(e[a]=lK.mapValues(l,(function(e){return e+s})))}}))}))}function xK(e,t){return lK.mapValues(e.ul,(function(n,r){if(t)return e[t.toLowerCase()][r];var i=lK.sortBy(lK.map(e,r));return(i[1]+i[2])/2}))}var wK=lY,CK=SY,EK=hK,_K=function(e){(function(e){var t=CK.buildLayerMatrix(e),n=e.graph().ranksep,r=0;wK.forEach(t,(function(t){var i=wK.max(wK.map(t,(function(t){return e.node(t).height})));wK.forEach(t,(function(t){e.node(t).y=r+i/2})),r+=i+n}))})(e=CK.asNonCompoundGraph(e)),wK.forEach(EK(e),(function(t,n){e.node(n).x=t}))};var SK=lY,OK=function(e,t){var n=SK.filter(e.nodes(),(function(t){return!e.children(t).length})),r=SK.max(SK.map(n,(function(t){return e.node(t).rank}))),i=SK.map(SK.range(r+1),(function(){return[]}));SK.forEach(t,(function(t){var n=e.node(t);n.dummy||(n.fixorder=i[n.rank].length,i[n.rank].push(t))}))};var AK=lY,kK=CY,MK=TY,TK=lq,PK=SY.normalizeRanks,DK=dq,NK=SY.removeEmptyRanks,RK=gq,IK=bq,jK=Cq,LK=iK,FK=_K,GK=SY,BK=QH.Graph,zK=OK,UK=function(e,t){var n=t&&t.debugTiming?GK.time:GK.notime;n("layout",(function(){t&&!t.keepNodeOrder&&t.prevGraph&&n("  inheritOrder",(function(){var n,r,i;n=e,r=t.prevGraph,i=r._nodes,AK.forEach(n.nodes(),(function(e){var t=n.node(e);void 0!==i[e]?(t.fixorder=i[e]._order,delete i[e]._order):delete t.fixorder}))}));var r=n("  buildLayoutGraph",(function(){return function(e){var t=new BK({multigraph:!0,compound:!0}),n=JK(e.graph());return t.setGraph(AK.merge({},HK,ZK(n,VK),AK.pick(n,WK))),AK.forEach(e.nodes(),(function(n){var r=JK(e.node(n));t.setNode(n,AK.defaults(ZK(r,$K),XK)),t.setParent(n,e.parent(n))})),AK.forEach(e.edges(),(function(n){var r=JK(e.edge(n));t.setEdge(n,AK.merge({},qK,ZK(r,YK),AK.pick(r,KK)))})),t}(e)}));t&&!1===t.edgeLabelSpace||n("  makeSpaceForEdgeLabels",(function(){!function(e){var t=e.graph();t.ranksep/=2,AK.forEach(e.nodes(),(function(t){var n=e.node(t);isNaN(n.layer)||(n.layer*=2)})),AK.forEach(e.edges(),(function(n){var r=e.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}))}(r)}));try{n("  runLayout",(function(){!function(e,t,n){t("    removeSelfEdges",(function(){!function(e){AK.forEach(e.edges(),(function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}}))}(e)})),t("    acyclic",(function(){kK.run(e)})),t("    nestingGraph.run",(function(){RK.run(e)})),t("    rank",(function(){TK(GK.asNonCompoundGraph(e))})),t("    injectEdgeLabelProxies",(function(){!function(e){AK.forEach(e.edges(),(function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),i={rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t};GK.addDummyNode(e,"edge-proxy",i,"_ep")}}))}(e)})),t("    removeEmptyRanks",(function(){NK(e)})),t("    nestingGraph.cleanup",(function(){RK.cleanup(e)})),t("    normalizeRanks",(function(){PK(e)})),t("    assignRankMinMax",(function(){!function(e){var t=0;AK.forEach(e.nodes(),(function(n){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=AK.max(t,r.maxRank))})),e.graph().maxRank=t}(e)})),t("    removeEdgeLabelProxies",(function(){!function(e){AK.forEach(e.nodes(),(function(t){var n=e.node(t);"edge-proxy"===n.dummy&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))}))}(e)})),t("    normalize.run",(function(){MK.run(e)})),t("    parentDummyChains",(function(){DK(e)})),t("    addBorderSegments",(function(){IK(e)})),n&&n.keepNodeOrder&&t("    initDataOrder",(function(){zK(e,n.nodeOrder)}));t("    order",(function(){LK(e)})),t("    insertSelfEdges",(function(){!function(e){var t=GK.buildLayerMatrix(e);AK.forEach(t,(function(t){var n=0;AK.forEach(t,(function(t,r){var i=e.node(t);i.order=r+n,AK.forEach(i.selfEdges,(function(t){GK.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:i.rank,order:r+ ++n,e:t.e,label:t.label},"_se")})),delete i.selfEdges}))}))}(e)})),t("    adjustCoordinateSystem",(function(){jK.adjust(e)})),t("    position",(function(){FK(e)})),t("    positionSelfEdges",(function(){!function(e){AK.forEach(e.nodes(),(function(t){var n=e.node(t);if("selfedge"===n.dummy){var r=e.node(n.e.v),i=r.x+r.width/2,o=r.y,s=n.x-i,a=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*s/3,y:o-a},{x:i+5*s/6,y:o-a},{x:i+s,y:o},{x:i+5*s/6,y:o+a},{x:i+2*s/3,y:o+a}],n.label.x=n.x,n.label.y=n.y}}))}(e)})),t("    removeBorderNodes",(function(){!function(e){AK.forEach(e.nodes(),(function(t){if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),i=e.node(n.borderBottom),o=e.node(AK.last(n.borderLeft)),s=e.node(AK.last(n.borderRight));n.width=Math.abs(s.x-o.x),n.height=Math.abs(i.y-r.y),n.x=o.x+n.width/2,n.y=r.y+n.height/2}})),AK.forEach(e.nodes(),(function(t){"border"===e.node(t).dummy&&e.removeNode(t)}))}(e)})),t("    normalize.undo",(function(){MK.undo(e)})),t("    fixupEdgeLabelCoords",(function(){!function(e){AK.forEach(e.edges(),(function(t){var n=e.edge(t);if(AK.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))}(e)})),t("    undoCoordinateSystem",(function(){jK.undo(e)})),t("    translateGraph",(function(){!function(e){var t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,i=0,o=e.graph(),s=o.marginx||0,a=o.marginy||0;function l(e){var o=e.x,s=e.y,a=e.width,l=e.height;t=Math.min(t,o-a/2),n=Math.max(n,o+a/2),r=Math.min(r,s-l/2),i=Math.max(i,s+l/2)}AK.forEach(e.nodes(),(function(t){l(e.node(t))})),AK.forEach(e.edges(),(function(t){var n=e.edge(t);AK.has(n,"x")&&l(n)})),t-=s,r-=a,AK.forEach(e.nodes(),(function(n){var i=e.node(n);i.x-=t,i.y-=r})),AK.forEach(e.edges(),(function(n){var i=e.edge(n);AK.forEach(i.points,(function(e){e.x-=t,e.y-=r})),AK.has(i,"x")&&(i.x-=t),AK.has(i,"y")&&(i.y-=r)})),o.width=n-t+s,o.height=i-r+a}(e)})),t("    assignNodeIntersects",(function(){!function(e){AK.forEach(e.edges(),(function(t){var n,r,i=e.edge(t),o=e.node(t.v),s=e.node(t.w);i.points?(n=i.points[0],r=i.points[i.points.length-1]):(i.points=[],n=s,r=o),i.points.unshift(GK.intersectRect(o,n)),i.points.push(GK.intersectRect(s,r))}))}(e)})),t("    reversePoints",(function(){!function(e){AK.forEach(e.edges(),(function(t){var n=e.edge(t);n.reversed&&n.points.reverse()}))}(e)})),t("    acyclic.undo",(function(){kK.undo(e)}))}(r,n,t)}))}catch(e){if("Not possible to find intersection inside of the rectangle"===e.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\n",e);throw e}n("  updateInputGraph",(function(){!function(e,t){AK.forEach(e.nodes(),(function(n){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,r._order=i.order,r._rank=i.rank,t.children(n).length&&(r.width=i.width,r.height=i.height))})),AK.forEach(e.edges(),(function(n){var r=e.edge(n),i=t.edge(n);r.points=i.points,AK.has(i,"x")&&(r.x=i.x,r.y=i.y)})),e.graph().width=t.graph().width,e.graph().height=t.graph().height}(e,r)}))}))};var VK=["nodesep","edgesep","ranksep","marginx","marginy"],HK={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},WK=["acyclicer","ranker","rankdir","align"],$K=["width","height","layer","fixorder"],XK={width:0,height:0},YK=["minlen","weight","width","height","labeloffset"],qK={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},KK=["labelpos"];function ZK(e,t){return AK.mapValues(AK.pick(e,t),Number)}function JK(e){var t={};return AK.forEach(e,(function(e,n){t[n.toLowerCase()]=e})),t}var QK=lY,eZ=SY,tZ=QH.Graph,nZ={debugOrdering:function(e){var t=eZ.buildLayerMatrix(e),n=new tZ({compound:!0,multigraph:!0}).setGraph({});return QK.forEach(e.nodes(),(function(t){n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank)})),QK.forEach(e.edges(),(function(e){n.setEdge(e.v,e.w,{},e.name)})),QK.forEach(t,(function(e,t){var r="layer"+t;n.setNode(r,{rank:"same"}),QK.reduce(e,(function(e,t){return n.setEdge(e,t,{style:"invis"}),t}))})),n}};var rZ={graphlib:QH,layout:UK,debug:nZ,util:{time:SY.time,notime:SY.notime},version:"0.1.1"};class iZ extends ID{constructor(e){super(),this.rankdir="TB",this.nodesep=50,this.ranksep=50,this.controlPoints=!1,this.sortByCombo=!1,this.edgeLabelSpace=!0,this.keepNodeOrder=!1,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.layoutNode=e=>{const{nodes:t}=this,n=t.find((t=>t.id===e));if(n){return!1!==n.layout}return!0},this.updateCfg(e)}getDefaultCfg(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1}}execute(){const e=this,{nodes:t,nodeSize:n,rankdir:r,combos:i}=e;if(!t)return;const o=e.edges||[],s=new rZ.graphlib.Graph({multigraph:!0,compound:!0});let a;a=n?LD(n)?()=>n:()=>[n,n]:e=>e.size?LD(e.size)?e.size:BD(e.size)?[e.size.width||40,e.size.height||40]:[e.size,e.size]:[40,40];let l=oZ(e.nodesepFunc,e.nodesep,50),c=oZ(e.ranksepFunc,e.ranksep,50);"LR"!==r&&"RL"!==r||(l=oZ(e.ranksepFunc,e.ranksep,50),c=oZ(e.nodesepFunc,e.nodesep,50)),s.setDefaultEdgeLabel((()=>({}))),s.setGraph(e);const u={};let h,d;return t.filter((e=>!1!==e.layout)).forEach((e=>{const t=a(e),n=c(e),r=l(e),i=t[0]+2*r,o=t[1]+2*n,h=e.layer;FD(h)?s.setNode(e.id,{width:i,height:o,layer:h}):s.setNode(e.id,{width:i,height:o}),this.sortByCombo&&e.comboId&&(u[e.comboId]||(u[e.comboId]=!0,s.setNode(e.comboId,{})),s.setParent(e.id,e.comboId))})),this.sortByCombo&&i&&i.forEach((e=>{e.parentId&&(u[e.parentId]||(u[e.parentId]=!0,s.setNode(e.parentId,{})),s.setParent(e.id,e.parentId))})),o.forEach((e=>{const t=UD(e,"source"),n=UD(e,"target");this.layoutNode(t)&&this.layoutNode(n)&&s.setEdge(t,n,{weight:e.weight||1})})),e.preset&&(h=new rZ.graphlib.Graph({multigraph:!0,compound:!0}),e.preset.nodes.forEach((e=>{null==h||h.setNode(e.id,e)}))),rZ.layout(s,{prevGraph:h,edgeLabelSpace:e.edgeLabelSpace,keepNodeOrder:e.keepNodeOrder,nodeOrder:e.nodeOrder}),s.nodes().forEach((e=>{d=s.node(e);const n=t.findIndex((t=>t.id===e));t[n]&&(t[n].x=d.x,t[n].y=d.y,t[n]._order=d._order)})),s.edges().forEach((t=>{d=s.edge(t);const n=o.findIndex((e=>{const n=UD(e,"source"),r=UD(e,"target");return n===t.v&&r===t.w}));e.edgeLabelSpace&&e.controlPoints&&"loop"!==o[n].type&&(o[n].controlPoints=d.points.slice(1,d.points.length-1))})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:o}}getType(){return"dagre"}}function oZ(e,t,n){let r;return r=e||(FD(t)?()=>t:()=>n),r}var sZ={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Object.prototype.toString;e.default=function(e){return t.call(e).endsWith("Array]")}}(sZ);var aZ=h(sZ);function lZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!aZ(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");var n=t.fromIndex,r=void 0===n?0:n,i=t.toIndex,o=void 0===i?e.length:i;if(r<0||r>=e.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>e.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=e[r],a=r+1;a<o;a++)e[a]>s&&(s=e[a]);return s}function cZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!aZ(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");var n=t.fromIndex,r=void 0===n?0:n,i=t.toIndex,o=void 0===i?e.length:i;if(r<0||r>=e.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>e.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=e[r],a=r+1;a<o;a++)e[a]<s&&(s=e[a]);return s}function uZ(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!aZ(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!aZ(n.output))throw new TypeError("output option must be an array if specified");t=n.output}else t=new Array(e.length);var r=cZ(e),i=lZ(e);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=n.min,s=void 0===o?n.autoMinMax?r:0:o,a=n.max,l=void 0===a?n.autoMinMax?i:1:a;if(s>=l)throw new RangeError("min option must be smaller than max option");for(var c=(l-s)/(i-r),u=0;u<e.length;u++)t[u]=(e[u]-r)*c+s;return t}const hZ=" ".repeat(2),dZ=" ".repeat(4);function fZ(e,t={}){const{maxRows:n=15,maxColumns:r=10,maxNumSize:i=8}=t;return`${e.constructor.name} {\n${hZ}[\n${dZ}${function(e,t,n,r){const{rows:i,columns:o}=e,s=Math.min(i,t),a=Math.min(o,n),l=[];for(let t=0;t<s;t++){let n=[];for(let i=0;i<a;i++)n.push(pZ(e.get(t,i),r));l.push(`${n.join(" ")}`)}a!==o&&(l[l.length-1]+=` ... ${o-n} more columns`);s!==i&&l.push(`... ${i-t} more rows`);return l.join(`\n${dZ}`)}(e,n,r,i)}\n${hZ}]\n${hZ}rows: ${e.rows}\n${hZ}columns: ${e.columns}\n}`}function pZ(e,t){const n=String(e);if(n.length<=t)return n.padEnd(t," ");const r=e.toPrecision(t-2);if(r.length<=t)return r;const i=e.toExponential(t-2),o=i.indexOf("e"),s=i.slice(o);return i.slice(0,t-s.length)+s}function gZ(e,t,n){let r=n?e.rows:e.rows-1;if(t<0||t>r)throw new RangeError("Row index out of range")}function mZ(e,t,n){let r=n?e.columns:e.columns-1;if(t<0||t>r)throw new RangeError("Column index out of range")}function vZ(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError("vector size must be the same as the number of columns");return t}function yZ(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError("vector size must be the same as the number of rows");return t}function bZ(e,t){if("object"!=typeof t)throw new TypeError("unexpected type for row indices");let n=t.some((t=>t<0||t>=e.rows));if(n)throw new RangeError("row indices are out of range");return Array.isArray(t)||(t=Array.from(t)),t}function xZ(e,t){if("object"!=typeof t)throw new TypeError("unexpected type for column indices");let n=t.some((t=>t<0||t>=e.columns));if(n)throw new RangeError("column indices are out of range");return Array.isArray(t)||(t=Array.from(t)),t}function wZ(e,t,n,r,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(EZ("startRow",t),EZ("endRow",n),EZ("startColumn",r),EZ("endColumn",i),t>n||r>i||t<0||t>=e.rows||n<0||n>=e.rows||r<0||r>=e.columns||i<0||i>=e.columns)throw new RangeError("Submatrix indices are out of range")}function CZ(e,t=0){let n=[];for(let r=0;r<e;r++)n.push(t);return n}function EZ(e,t){if("number"!=typeof t)throw new TypeError(`${e} must be a number`)}function _Z(e){if(e.isEmpty())throw new Error("Empty matrix has no elements to index")}class SZ{static from1DArray(e,t,n){if(e*t!==n.length)throw new RangeError("data length does not match given dimensions");let r=new AZ(e,t);for(let i=0;i<e;i++)for(let e=0;e<t;e++)r.set(i,e,n[i*t+e]);return r}static rowVector(e){let t=new AZ(1,e.length);for(let n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){let t=new AZ(e.length,1);for(let n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static zeros(e,t){return new AZ(e,t)}static ones(e,t){return new AZ(e,t).fill(1)}static rand(e,t,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{random:r=Math.random}=n;let i=new AZ(e,t);for(let n=0;n<e;n++)for(let e=0;e<t;e++)i.set(n,e,r());return i}static randInt(e,t,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{min:r=0,max:i=1e3,random:o=Math.random}=n;if(!Number.isInteger(r))throw new TypeError("min must be an integer");if(!Number.isInteger(i))throw new TypeError("max must be an integer");if(r>=i)throw new RangeError("min must be smaller than max");let s=i-r,a=new AZ(e,t);for(let n=0;n<e;n++)for(let e=0;e<t;e++){let t=r+Math.round(o()*s);a.set(n,e,t)}return a}static eye(e,t,n){void 0===t&&(t=e),void 0===n&&(n=1);let r=Math.min(e,t),i=this.zeros(e,t);for(let e=0;e<r;e++)i.set(e,e,n);return i}static diag(e,t,n){let r=e.length;void 0===t&&(t=r),void 0===n&&(n=t);let i=Math.min(r,t,n),o=this.zeros(t,n);for(let t=0;t<i;t++)o.set(t,t,e[t]);return o}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let n=e.rows,r=e.columns,i=new AZ(n,r);for(let o=0;o<n;o++)for(let n=0;n<r;n++)i.set(o,n,Math.min(e.get(o,n),t.get(o,n)));return i}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let n=e.rows,r=e.columns,i=new this(n,r);for(let o=0;o<n;o++)for(let n=0;n<r;n++)i.set(o,n,Math.max(e.get(o,n),t.get(o,n)));return i}static checkMatrix(e){return SZ.isMatrix(e)?e:new AZ(e)}static isMatrix(e){return null!=e&&"Matrix"===e.klass}get size(){return this.rows*this.columns}apply(e){if("function"!=typeof e)throw new TypeError("callback must be a function");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.call(this,t,n);return this}to1DArray(){let e=[];for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e}to2DArray(){let e=[];for(let t=0;t<this.rows;t++){e.push([]);for(let n=0;n<this.columns;n++)e[t].push(this.get(t,n))}return e}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let e=0;e<this.rows;e++)for(let t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}isEchelonForm(){let e=0,t=0,n=-1,r=!0,i=!1;for(;e<this.rows&&r;){for(t=0,i=!1;t<this.columns&&!1===i;)0===this.get(e,t)?t++:1===this.get(e,t)&&t>n?(i=!0,n=t):(r=!1,i=!0);e++}return r}isReducedEchelonForm(){let e=0,t=0,n=-1,r=!0,i=!1;for(;e<this.rows&&r;){for(t=0,i=!1;t<this.columns&&!1===i;)0===this.get(e,t)?t++:1===this.get(e,t)&&t>n?(i=!0,n=t):(r=!1,i=!0);for(let n=t+1;n<this.rows;n++)0!==this.get(e,n)&&(r=!1);e++}return r}echelonForm(){let e=this.clone(),t=0,n=0;for(;t<e.rows&&n<e.columns;){let r=t;for(let i=t;i<e.rows;i++)e.get(i,n)>e.get(r,n)&&(r=i);if(0===e.get(r,n))n++;else{e.swapRows(t,r);let i=e.get(t,n);for(let r=n;r<e.columns;r++)e.set(t,r,e.get(t,r)/i);for(let r=t+1;r<e.rows;r++){let i=e.get(r,n)/e.get(t,n);e.set(r,n,0);for(let o=n+1;o<e.columns;o++)e.set(r,o,e.get(r,o)-e.get(t,o)*i)}t++,n++}}return e}reducedEchelonForm(){let e=this.echelonForm(),t=e.columns,n=e.rows,r=n-1;for(;r>=0;)if(0===e.maxRow(r))r--;else{let i=0,o=!1;for(;i<n&&!1===o;)1===e.get(r,i)?o=!0:i++;for(let n=0;n<r;n++){let o=e.get(n,i);for(let s=i;s<t;s++){let t=e.get(n,s)-o*e.get(r,s);e.set(n,s,t)}}r--}return e}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(e={}){if("object"!=typeof e)throw new TypeError("options must be an object");const{rows:t=1,columns:n=1}=e;if(!Number.isInteger(t)||t<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new TypeError("columns must be a positive integer");let r=new AZ(this.rows*t,this.columns*n);for(let e=0;e<t;e++)for(let t=0;t<n;t++)r.setSubMatrix(this,this.rows*e,this.columns*t);return r}fill(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,e);return this}neg(){return this.mulS(-1)}getRow(e){gZ(this,e);let t=[];for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t}getRowVector(e){return AZ.rowVector(this.getRow(e))}setRow(e,t){gZ(this,e),t=vZ(this,t);for(let n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){gZ(this,e),gZ(this,t);for(let n=0;n<this.columns;n++){let r=this.get(e,n);this.set(e,n,this.get(t,n)),this.set(t,n,r)}return this}getColumn(e){mZ(this,e);let t=[];for(let n=0;n<this.rows;n++)t.push(this.get(n,e));return t}getColumnVector(e){return AZ.columnVector(this.getColumn(e))}setColumn(e,t){mZ(this,e),t=yZ(this,t);for(let n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){mZ(this,e),mZ(this,t);for(let n=0;n<this.rows;n++){let r=this.get(n,e);this.set(n,e,this.get(n,t)),this.set(n,t,r)}return this}addRowVector(e){e=vZ(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[n]);return this}subRowVector(e){e=vZ(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[n]);return this}mulRowVector(e){e=vZ(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[n]);return this}divRowVector(e){e=vZ(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[n]);return this}addColumnVector(e){e=yZ(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[t]);return this}subColumnVector(e){e=yZ(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[t]);return this}mulColumnVector(e){e=yZ(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[t]);return this}divColumnVector(e){e=yZ(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[t]);return this}mulRow(e,t){gZ(this,e);for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){mZ(this,e);for(let n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){if(this.isEmpty())return NaN;let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxIndex(){_Z(this);let e=this.get(0,0),t=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)>e&&(e=this.get(n,r),t[0]=n,t[1]=r);return t}min(){if(this.isEmpty())return NaN;let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minIndex(){_Z(this);let e=this.get(0,0),t=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)<e&&(e=this.get(n,r),t[0]=n,t[1]=r);return t}maxRow(e){if(gZ(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){gZ(this,e),_Z(this);let t=this.get(e,0),n=[e,0];for(let r=1;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r),n[1]=r);return n}minRow(e){if(gZ(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){gZ(this,e),_Z(this);let t=this.get(e,0),n=[e,0];for(let r=1;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r),n[1]=r);return n}maxColumn(e){if(mZ(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){mZ(this,e),_Z(this);let t=this.get(0,e),n=[0,e];for(let r=1;r<this.rows;r++)this.get(r,e)>t&&(t=this.get(r,e),n[0]=r);return n}minColumn(e){if(mZ(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){mZ(this,e),_Z(this);let t=this.get(0,e),n=[0,e];for(let r=1;r<this.rows;r++)this.get(r,e)<t&&(t=this.get(r,e),n[0]=r);return n}diag(){let e=Math.min(this.rows,this.columns),t=[];for(let n=0;n<e;n++)t.push(this.get(n,n));return t}norm(e="frobenius"){let t=0;if("max"===e)return this.max();if("frobenius"===e){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t+=this.get(e,n)*this.get(e,n);return Math.sqrt(t)}throw new RangeError(`unknown norm type: ${e}`)}cumulativeSum(){let e=0;for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e+=this.get(t,n),this.set(t,n,e);return this}dot(e){SZ.isMatrix(e)&&(e=e.to1DArray());let t=this.to1DArray();if(t.length!==e.length)throw new RangeError("vectors do not have the same size");let n=0;for(let r=0;r<t.length;r++)n+=t[r]*e[r];return n}mmul(e){e=AZ.checkMatrix(e);let t=this.rows,n=this.columns,r=e.columns,i=new AZ(t,r),o=new Float64Array(n);for(let s=0;s<r;s++){for(let t=0;t<n;t++)o[t]=e.get(t,s);for(let e=0;e<t;e++){let t=0;for(let r=0;r<n;r++)t+=this.get(e,r)*o[r];i.set(e,s,t)}}return i}strassen2x2(e){e=AZ.checkMatrix(e);let t=new AZ(2,2);const n=this.get(0,0),r=e.get(0,0),i=this.get(0,1),o=e.get(0,1),s=this.get(1,0),a=e.get(1,0),l=this.get(1,1),c=e.get(1,1),u=(n+l)*(r+c),h=(s+l)*r,d=n*(o-c),f=l*(a-r),p=(n+i)*c,g=u+f-p+(i-l)*(a+c),m=d+p,v=h+f,y=u-h+d+(s-n)*(r+o);return t.set(0,0,g),t.set(0,1,m),t.set(1,0,v),t.set(1,1,y),t}strassen3x3(e){e=AZ.checkMatrix(e);let t=new AZ(3,3);const n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),s=this.get(1,1),a=this.get(1,2),l=this.get(2,0),c=this.get(2,1),u=this.get(2,2),h=e.get(0,0),d=e.get(0,1),f=e.get(0,2),p=e.get(1,0),g=e.get(1,1),m=e.get(1,2),v=e.get(2,0),y=e.get(2,1),b=e.get(2,2),x=(n-o)*(-d+g),w=(-n+o+s)*(h-d+g),C=(o+s)*(-h+d),E=n*h,_=(-n+l+c)*(h-f+m),S=(-n+l)*(f-m),O=(l+c)*(-h+f),A=(-i+c+u)*(g+v-y),k=(i-u)*(g-y),M=i*v,T=(c+u)*(-v+y),P=(-i+s+a)*(m+v-b),D=(i-a)*(m-b),N=(s+a)*(-v+b),R=E+M+r*p,I=(n+r+i-o-s-c-u)*g+w+C+E+A+M+T,j=E+_+O+(n+r+i-s-a-l-c)*m+M+P+N,L=x+s*(-h+d+p-g-m-v+b)+w+E+M+P+D,F=x+w+C+E+a*y,G=M+P+D+N+o*f,B=E+_+S+c*(-h+f+p-g-m-v+y)+A+k+M,z=A+k+M+T+l*d,U=E+_+S+O+u*b;return t.set(0,0,R),t.set(0,1,I),t.set(0,2,j),t.set(1,0,L),t.set(1,1,F),t.set(1,2,G),t.set(2,0,B),t.set(2,1,z),t.set(2,2,U),t}mmulStrassen(e){e=AZ.checkMatrix(e);let t=this.clone(),n=t.rows,r=t.columns,i=e.rows,o=e.columns;function s(e,t,n){let r=e.rows,i=e.columns;if(r===t&&i===n)return e;{let r=SZ.zeros(t,n);return r=r.setSubMatrix(e,0,0),r}}r!==i&&console.warn(`Multiplying ${n} x ${r} and ${i} x ${o} matrix: dimensions do not match.`);let a=Math.max(n,i),l=Math.max(r,o);return t=s(t,a,l),function e(t,n,r,i){if(r<=512||i<=512)return t.mmul(n);r%2==1&&i%2==1?(t=s(t,r+1,i+1),n=s(n,r+1,i+1)):r%2==1?(t=s(t,r+1,i),n=s(n,r+1,i)):i%2==1&&(t=s(t,r,i+1),n=s(n,r,i+1));let o=parseInt(t.rows/2,10),a=parseInt(t.columns/2,10),l=t.subMatrix(0,o-1,0,a-1),c=n.subMatrix(0,o-1,0,a-1),u=t.subMatrix(0,o-1,a,t.columns-1),h=n.subMatrix(0,o-1,a,n.columns-1),d=t.subMatrix(o,t.rows-1,0,a-1),f=n.subMatrix(o,n.rows-1,0,a-1),p=t.subMatrix(o,t.rows-1,a,t.columns-1),g=n.subMatrix(o,n.rows-1,a,n.columns-1),m=e(SZ.add(l,p),SZ.add(c,g),o,a),v=e(SZ.add(d,p),c,o,a),y=e(l,SZ.sub(h,g),o,a),b=e(p,SZ.sub(f,c),o,a),x=e(SZ.add(l,u),g,o,a),w=e(SZ.sub(d,l),SZ.add(c,h),o,a),C=e(SZ.sub(u,p),SZ.add(f,g),o,a),E=SZ.add(m,b);E.sub(x),E.add(C);let _=SZ.add(y,x),S=SZ.add(v,b),O=SZ.sub(m,v);O.add(y),O.add(w);let A=SZ.zeros(2*E.rows,2*E.columns);return A=A.setSubMatrix(E,0,0),A=A.setSubMatrix(_,E.rows,0),A=A.setSubMatrix(S,0,E.columns),A=A.setSubMatrix(O,E.rows,E.columns),A.subMatrix(0,r-1,0,i-1)}(t,e=s(e,a,l),a,l)}scaleRows(e={}){if("object"!=typeof e)throw new TypeError("options must be an object");const{min:t=0,max:n=1}=e;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(t>=n)throw new RangeError("min must be smaller than max");let r=new AZ(this.rows,this.columns);for(let e=0;e<this.rows;e++){const i=this.getRow(e);i.length>0&&uZ(i,{min:t,max:n,output:i}),r.setRow(e,i)}return r}scaleColumns(e={}){if("object"!=typeof e)throw new TypeError("options must be an object");const{min:t=0,max:n=1}=e;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(t>=n)throw new RangeError("min must be smaller than max");let r=new AZ(this.rows,this.columns);for(let e=0;e<this.columns;e++){const i=this.getColumn(e);i.length&&uZ(i,{min:t,max:n,output:i}),r.setColumn(e,i)}return r}flipRows(){const e=Math.ceil(this.columns/2);for(let t=0;t<this.rows;t++)for(let n=0;n<e;n++){let e=this.get(t,n),r=this.get(t,this.columns-1-n);this.set(t,n,r),this.set(t,this.columns-1-n,e)}return this}flipColumns(){const e=Math.ceil(this.rows/2);for(let t=0;t<this.columns;t++)for(let n=0;n<e;n++){let e=this.get(n,t),r=this.get(this.rows-1-n,t);this.set(n,t,r),this.set(this.rows-1-n,t,e)}return this}kroneckerProduct(e){e=AZ.checkMatrix(e);let t=this.rows,n=this.columns,r=e.rows,i=e.columns,o=new AZ(t*r,n*i);for(let s=0;s<t;s++)for(let t=0;t<n;t++)for(let n=0;n<r;n++)for(let a=0;a<i;a++)o.set(r*s+n,i*t+a,this.get(s,t)*e.get(n,a));return o}kroneckerSum(e){if(e=AZ.checkMatrix(e),!this.isSquare()||!e.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let t=this.rows,n=e.rows,r=this.kroneckerProduct(AZ.eye(n,n)),i=AZ.eye(t,t).kroneckerProduct(e);return r.add(i)}transpose(){let e=new AZ(this.columns,this.rows);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.set(n,t,this.get(t,n));return e}sortRows(e=OZ){for(let t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e=OZ){for(let t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,r){wZ(this,e,t,n,r);let i=new AZ(t-e+1,r-n+1);for(let o=e;o<=t;o++)for(let t=n;t<=r;t++)i.set(o-e,t-n,this.get(o,t));return i}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||t<0||t>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");let r=new AZ(e.length,n-t+1);for(let i=0;i<e.length;i++)for(let o=t;o<=n;o++){if(e[i]<0||e[i]>=this.rows)throw new RangeError(`Row index out of range: ${e[i]}`);r.set(i,o-t,this.get(e[i],o))}return r}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||t<0||t>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");let r=new AZ(n-t+1,e.length);for(let i=0;i<e.length;i++)for(let o=t;o<=n;o++){if(e[i]<0||e[i]>=this.columns)throw new RangeError(`Column index out of range: ${e[i]}`);r.set(o-t,i,this.get(o,e[i]))}return r}setSubMatrix(e,t,n){if((e=AZ.checkMatrix(e)).isEmpty())return this;wZ(this,t,t+e.rows-1,n,n+e.columns-1);for(let r=0;r<e.rows;r++)for(let i=0;i<e.columns;i++)this.set(t+r,n+i,e.get(r,i));return this}selection(e,t){let n=function(e,t,n){return{row:bZ(e,t),column:xZ(e,n)}}(this,e,t),r=new AZ(e.length,t.length);for(let e=0;e<n.row.length;e++){let t=n.row[e];for(let i=0;i<n.column.length;i++){let o=n.column[i];r.set(e,i,this.get(t,o))}}return r}trace(){let e=Math.min(this.rows,this.columns),t=0;for(let n=0;n<e;n++)t+=this.get(n,n);return t}clone(){let e=new AZ(this.rows,this.columns);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.set(t,n,this.get(t,n));return e}sum(e){switch(e){case"row":return function(e){let t=CZ(e.rows);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[n]+=e.get(n,r);return t}(this);case"column":return function(e){let t=CZ(e.columns);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[r]+=e.get(n,r);return t}(this);case void 0:return function(e){let t=0;for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)t+=e.get(n,r);return t}(this);default:throw new Error(`invalid option: ${e}`)}}product(e){switch(e){case"row":return function(e){let t=CZ(e.rows,1);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[n]*=e.get(n,r);return t}(this);case"column":return function(e){let t=CZ(e.columns,1);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[r]*=e.get(n,r);return t}(this);case void 0:return function(e){let t=1;for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)t*=e.get(n,r);return t}(this);default:throw new Error(`invalid option: ${e}`)}}mean(e){const t=this.sum(e);switch(e){case"row":for(let e=0;e<this.rows;e++)t[e]/=this.columns;return t;case"column":for(let e=0;e<this.columns;e++)t[e]/=this.rows;return t;case void 0:return t/this.size;default:throw new Error(`invalid option: ${e}`)}}variance(e,t={}){if("object"==typeof e&&(t=e,e=void 0),"object"!=typeof t)throw new TypeError("options must be an object");const{unbiased:n=!0,mean:r=this.mean(e)}=t;if("boolean"!=typeof n)throw new TypeError("unbiased must be a boolean");switch(e){case"row":if(!Array.isArray(r))throw new TypeError("mean must be an array");return function(e,t,n){const r=e.rows,i=e.columns,o=[];for(let s=0;s<r;s++){let r=0,a=0,l=0;for(let t=0;t<i;t++)l=e.get(s,t)-n[s],r+=l,a+=l*l;t?o.push((a-r*r/i)/(i-1)):o.push((a-r*r/i)/i)}return o}(this,n,r);case"column":if(!Array.isArray(r))throw new TypeError("mean must be an array");return function(e,t,n){const r=e.rows,i=e.columns,o=[];for(let s=0;s<i;s++){let i=0,a=0,l=0;for(let t=0;t<r;t++)l=e.get(t,s)-n[s],i+=l,a+=l*l;t?o.push((a-i*i/r)/(r-1)):o.push((a-i*i/r)/r)}return o}(this,n,r);case void 0:if("number"!=typeof r)throw new TypeError("mean must be a number");return function(e,t,n){const r=e.rows,i=e.columns,o=r*i;let s=0,a=0,l=0;for(let t=0;t<r;t++)for(let r=0;r<i;r++)l=e.get(t,r)-n,s+=l,a+=l*l;return t?(a-s*s/o)/(o-1):(a-s*s/o)/o}(this,n,r);default:throw new Error(`invalid option: ${e}`)}}standardDeviation(e,t){"object"==typeof e&&(t=e,e=void 0);const n=this.variance(e,t);if(void 0===e)return Math.sqrt(n);for(let e=0;e<n.length;e++)n[e]=Math.sqrt(n[e]);return n}center(e,t={}){if("object"==typeof e&&(t=e,e=void 0),"object"!=typeof t)throw new TypeError("options must be an object");const{center:n=this.mean(e)}=t;switch(e){case"row":if(!Array.isArray(n))throw new TypeError("center must be an array");return function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[n])}(this,n),this;case"column":if(!Array.isArray(n))throw new TypeError("center must be an array");return function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[r])}(this,n),this;case void 0:if("number"!=typeof n)throw new TypeError("center must be a number");return function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t)}(this,n),this;default:throw new Error(`invalid option: ${e}`)}}scale(e,t={}){if("object"==typeof e&&(t=e,e=void 0),"object"!=typeof t)throw new TypeError("options must be an object");let n=t.scale;switch(e){case"row":if(void 0===n)n=function(e){const t=[];for(let n=0;n<e.rows;n++){let r=0;for(let t=0;t<e.columns;t++)r+=Math.pow(e.get(n,t),2)/(e.columns-1);t.push(Math.sqrt(r))}return t}(this);else if(!Array.isArray(n))throw new TypeError("scale must be an array");return function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[n])}(this,n),this;case"column":if(void 0===n)n=function(e){const t=[];for(let n=0;n<e.columns;n++){let r=0;for(let t=0;t<e.rows;t++)r+=Math.pow(e.get(t,n),2)/(e.rows-1);t.push(Math.sqrt(r))}return t}(this);else if(!Array.isArray(n))throw new TypeError("scale must be an array");return function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[r])}(this,n),this;case void 0:if(void 0===n)n=function(e){const t=e.size-1;let n=0;for(let r=0;r<e.columns;r++)for(let i=0;i<e.rows;i++)n+=Math.pow(e.get(i,r),2)/t;return Math.sqrt(n)}(this);else if("number"!=typeof n)throw new TypeError("scale must be a number");return function(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t)}(this,n),this;default:throw new Error(`invalid option: ${e}`)}}toString(e){return fZ(this,e)}}function OZ(e,t){return e-t}SZ.prototype.klass="Matrix","undefined"!=typeof Symbol&&(SZ.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return fZ(this)}),SZ.random=SZ.rand,SZ.randomInt=SZ.randInt,SZ.diagonal=SZ.diag,SZ.prototype.diagonal=SZ.prototype.diag,SZ.identity=SZ.eye,SZ.prototype.negate=SZ.prototype.neg,SZ.prototype.tensorProduct=SZ.prototype.kroneckerProduct;class AZ extends SZ{constructor(e,t){if(super(),AZ.isMatrix(e))return e.clone();if(Number.isInteger(e)&&e>=0){if(this.data=[],!(Number.isInteger(t)&&t>=0))throw new TypeError("nColumns must be a positive integer");for(let n=0;n<e;n++)this.data.push(new Float64Array(t))}else{if(!Array.isArray(e))throw new TypeError("First argument must be a positive number or an array");{const n=e;if("number"!=typeof(t=(e=n.length)?n[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let r=0;r<e;r++){if(n[r].length!==t)throw new RangeError("Inconsistent array dimensions");this.data.push(Float64Array.from(n[r]))}}}this.rows=e,this.columns=t}set(e,t,n){return this.data[e][t]=n,this}get(e,t){return this.data[e][t]}removeRow(e){return gZ(this,e),this.data.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),gZ(this,e,!0),t=Float64Array.from(vZ(this,t)),this.data.splice(e,0,t),this.rows+=1,this}removeColumn(e){mZ(this,e);for(let t=0;t<this.rows;t++){const n=new Float64Array(this.columns-1);for(let r=0;r<e;r++)n[r]=this.data[t][r];for(let r=e+1;r<this.columns;r++)n[r-1]=this.data[t][r];this.data[t]=n}return this.columns-=1,this}addColumn(e,t){void 0===t&&(t=e,e=this.columns),mZ(this,e,!0),t=yZ(this,t);for(let n=0;n<this.rows;n++){const r=new Float64Array(this.columns+1);let i=0;for(;i<e;i++)r[i]=this.data[n][i];for(r[i++]=t[n];i<this.columns+1;i++)r[i]=this.data[n][i-1];this.data[n]=r}return this.columns+=1,this}}!function(e,t){e.prototype.add=function(e){return"number"==typeof e?this.addS(e):this.addM(e)},e.prototype.addS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e);return this},e.prototype.addM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e.get(t,n));return this},e.add=function(e,n){return new t(e).add(n)},e.prototype.sub=function(e){return"number"==typeof e?this.subS(e):this.subM(e)},e.prototype.subS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e);return this},e.prototype.subM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e.get(t,n));return this},e.sub=function(e,n){return new t(e).sub(n)},e.prototype.subtract=e.prototype.sub,e.prototype.subtractS=e.prototype.subS,e.prototype.subtractM=e.prototype.subM,e.subtract=e.sub,e.prototype.mul=function(e){return"number"==typeof e?this.mulS(e):this.mulM(e)},e.prototype.mulS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this},e.prototype.mulM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e.get(t,n));return this},e.mul=function(e,n){return new t(e).mul(n)},e.prototype.multiply=e.prototype.mul,e.prototype.multiplyS=e.prototype.mulS,e.prototype.multiplyM=e.prototype.mulM,e.multiply=e.mul,e.prototype.div=function(e){return"number"==typeof e?this.divS(e):this.divM(e)},e.prototype.divS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e);return this},e.prototype.divM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e.get(t,n));return this},e.div=function(e,n){return new t(e).div(n)},e.prototype.divide=e.prototype.div,e.prototype.divideS=e.prototype.divS,e.prototype.divideM=e.prototype.divM,e.divide=e.div,e.prototype.mod=function(e){return"number"==typeof e?this.modS(e):this.modM(e)},e.prototype.modS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)%e);return this},e.prototype.modM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)%e.get(t,n));return this},e.mod=function(e,n){return new t(e).mod(n)},e.prototype.modulus=e.prototype.mod,e.prototype.modulusS=e.prototype.modS,e.prototype.modulusM=e.prototype.modM,e.modulus=e.mod,e.prototype.and=function(e){return"number"==typeof e?this.andS(e):this.andM(e)},e.prototype.andS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)&e);return this},e.prototype.andM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)&e.get(t,n));return this},e.and=function(e,n){return new t(e).and(n)},e.prototype.or=function(e){return"number"==typeof e?this.orS(e):this.orM(e)},e.prototype.orS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)|e);return this},e.prototype.orM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)|e.get(t,n));return this},e.or=function(e,n){return new t(e).or(n)},e.prototype.xor=function(e){return"number"==typeof e?this.xorS(e):this.xorM(e)},e.prototype.xorS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)^e);return this},e.prototype.xorM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)^e.get(t,n));return this},e.xor=function(e,n){return new t(e).xor(n)},e.prototype.leftShift=function(e){return"number"==typeof e?this.leftShiftS(e):this.leftShiftM(e)},e.prototype.leftShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)<<e);return this},e.prototype.leftShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)<<e.get(t,n));return this},e.leftShift=function(e,n){return new t(e).leftShift(n)},e.prototype.signPropagatingRightShift=function(e){return"number"==typeof e?this.signPropagatingRightShiftS(e):this.signPropagatingRightShiftM(e)},e.prototype.signPropagatingRightShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>e);return this},e.prototype.signPropagatingRightShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>e.get(t,n));return this},e.signPropagatingRightShift=function(e,n){return new t(e).signPropagatingRightShift(n)},e.prototype.rightShift=function(e){return"number"==typeof e?this.rightShiftS(e):this.rightShiftM(e)},e.prototype.rightShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>>e);return this},e.prototype.rightShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>>e.get(t,n));return this},e.rightShift=function(e,n){return new t(e).rightShift(n)},e.prototype.zeroFillRightShift=e.prototype.rightShift,e.prototype.zeroFillRightShiftS=e.prototype.rightShiftS,e.prototype.zeroFillRightShiftM=e.prototype.rightShiftM,e.zeroFillRightShift=e.rightShift,e.prototype.not=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,~this.get(e,t));return this},e.not=function(e){return new t(e).not()},e.prototype.abs=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.abs(this.get(e,t)));return this},e.abs=function(e){return new t(e).abs()},e.prototype.acos=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.acos(this.get(e,t)));return this},e.acos=function(e){return new t(e).acos()},e.prototype.acosh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.acosh(this.get(e,t)));return this},e.acosh=function(e){return new t(e).acosh()},e.prototype.asin=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.asin(this.get(e,t)));return this},e.asin=function(e){return new t(e).asin()},e.prototype.asinh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.asinh(this.get(e,t)));return this},e.asinh=function(e){return new t(e).asinh()},e.prototype.atan=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.atan(this.get(e,t)));return this},e.atan=function(e){return new t(e).atan()},e.prototype.atanh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.atanh(this.get(e,t)));return this},e.atanh=function(e){return new t(e).atanh()},e.prototype.cbrt=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cbrt(this.get(e,t)));return this},e.cbrt=function(e){return new t(e).cbrt()},e.prototype.ceil=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.ceil(this.get(e,t)));return this},e.ceil=function(e){return new t(e).ceil()},e.prototype.clz32=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.clz32(this.get(e,t)));return this},e.clz32=function(e){return new t(e).clz32()},e.prototype.cos=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cos(this.get(e,t)));return this},e.cos=function(e){return new t(e).cos()},e.prototype.cosh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cosh(this.get(e,t)));return this},e.cosh=function(e){return new t(e).cosh()},e.prototype.exp=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.exp(this.get(e,t)));return this},e.exp=function(e){return new t(e).exp()},e.prototype.expm1=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.expm1(this.get(e,t)));return this},e.expm1=function(e){return new t(e).expm1()},e.prototype.floor=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.floor(this.get(e,t)));return this},e.floor=function(e){return new t(e).floor()},e.prototype.fround=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.fround(this.get(e,t)));return this},e.fround=function(e){return new t(e).fround()},e.prototype.log=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log(this.get(e,t)));return this},e.log=function(e){return new t(e).log()},e.prototype.log1p=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log1p(this.get(e,t)));return this},e.log1p=function(e){return new t(e).log1p()},e.prototype.log10=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log10(this.get(e,t)));return this},e.log10=function(e){return new t(e).log10()},e.prototype.log2=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log2(this.get(e,t)));return this},e.log2=function(e){return new t(e).log2()},e.prototype.round=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.round(this.get(e,t)));return this},e.round=function(e){return new t(e).round()},e.prototype.sign=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sign(this.get(e,t)));return this},e.sign=function(e){return new t(e).sign()},e.prototype.sin=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sin(this.get(e,t)));return this},e.sin=function(e){return new t(e).sin()},e.prototype.sinh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sinh(this.get(e,t)));return this},e.sinh=function(e){return new t(e).sinh()},e.prototype.sqrt=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sqrt(this.get(e,t)));return this},e.sqrt=function(e){return new t(e).sqrt()},e.prototype.tan=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.tan(this.get(e,t)));return this},e.tan=function(e){return new t(e).tan()},e.prototype.tanh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.tanh(this.get(e,t)));return this},e.tanh=function(e){return new t(e).tanh()},e.prototype.trunc=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.trunc(this.get(e,t)));return this},e.trunc=function(e){return new t(e).trunc()},e.pow=function(e,n){return new t(e).pow(n)},e.prototype.pow=function(e){return"number"==typeof e?this.powS(e):this.powM(e)},e.prototype.powS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,Math.pow(this.get(t,n),e));return this},e.prototype.powM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,Math.pow(this.get(t,n),e.get(t,n)));return this}}(SZ,AZ);class kZ extends SZ{constructor(e){super(),this.data=e,this.rows=e.length,this.columns=e[0].length}set(e,t,n){return this.data[e][t]=n,this}get(e,t){return this.data[e][t]}}function MZ(e,t){let n=0;return Math.abs(e)>Math.abs(t)?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0!==t?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0}class TZ{constructor(e,t={}){if((e=kZ.checkMatrix(e)).isEmpty())throw new Error("Matrix must be non-empty");let n=e.rows,r=e.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:o=!0,autoTranspose:s=!1}=t;let a,l=Boolean(i),c=Boolean(o),u=!1;if(n<r)if(s){a=e.transpose(),n=a.rows,r=a.columns,u=!0;let t=l;l=c,c=t}else a=e.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=e.clone();let h=Math.min(n,r),d=Math.min(n+1,r),f=new Float64Array(d),p=new AZ(n,h),g=new AZ(r,r),m=new Float64Array(r),v=new Float64Array(n),y=new Float64Array(d);for(let e=0;e<d;e++)y[e]=e;let b=Math.min(n-1,r),x=Math.max(0,Math.min(r-2,n)),w=Math.max(b,x);for(let e=0;e<w;e++){if(e<b){f[e]=0;for(let t=e;t<n;t++)f[e]=MZ(f[e],a.get(t,e));if(0!==f[e]){a.get(e,e)<0&&(f[e]=-f[e]);for(let t=e;t<n;t++)a.set(t,e,a.get(t,e)/f[e]);a.set(e,e,a.get(e,e)+1)}f[e]=-f[e]}for(let t=e+1;t<r;t++){if(e<b&&0!==f[e]){let r=0;for(let i=e;i<n;i++)r+=a.get(i,e)*a.get(i,t);r=-r/a.get(e,e);for(let i=e;i<n;i++)a.set(i,t,a.get(i,t)+r*a.get(i,e))}m[t]=a.get(e,t)}if(l&&e<b)for(let t=e;t<n;t++)p.set(t,e,a.get(t,e));if(e<x){m[e]=0;for(let t=e+1;t<r;t++)m[e]=MZ(m[e],m[t]);if(0!==m[e]){m[e+1]<0&&(m[e]=0-m[e]);for(let t=e+1;t<r;t++)m[t]/=m[e];m[e+1]+=1}if(m[e]=-m[e],e+1<n&&0!==m[e]){for(let t=e+1;t<n;t++)v[t]=0;for(let t=e+1;t<n;t++)for(let n=e+1;n<r;n++)v[t]+=m[n]*a.get(t,n);for(let t=e+1;t<r;t++){let r=-m[t]/m[e+1];for(let i=e+1;i<n;i++)a.set(i,t,a.get(i,t)+r*v[i])}}if(c)for(let t=e+1;t<r;t++)g.set(t,e,m[t])}}let C=Math.min(r,n+1);if(b<r&&(f[b]=a.get(b,b)),n<C&&(f[C-1]=0),x+1<C&&(m[x]=a.get(x,C-1)),m[C-1]=0,l){for(let e=b;e<h;e++){for(let t=0;t<n;t++)p.set(t,e,0);p.set(e,e,1)}for(let e=b-1;e>=0;e--)if(0!==f[e]){for(let t=e+1;t<h;t++){let r=0;for(let i=e;i<n;i++)r+=p.get(i,e)*p.get(i,t);r=-r/p.get(e,e);for(let i=e;i<n;i++)p.set(i,t,p.get(i,t)+r*p.get(i,e))}for(let t=e;t<n;t++)p.set(t,e,-p.get(t,e));p.set(e,e,1+p.get(e,e));for(let t=0;t<e-1;t++)p.set(t,e,0)}else{for(let t=0;t<n;t++)p.set(t,e,0);p.set(e,e,1)}}if(c)for(let e=r-1;e>=0;e--){if(e<x&&0!==m[e])for(let t=e+1;t<r;t++){let n=0;for(let i=e+1;i<r;i++)n+=g.get(i,e)*g.get(i,t);n=-n/g.get(e+1,e);for(let i=e+1;i<r;i++)g.set(i,t,g.get(i,t)+n*g.get(i,e))}for(let t=0;t<r;t++)g.set(t,e,0);g.set(e,e,1)}let E=C-1,_=Number.EPSILON;for(;C>0;){let e,t;for(e=C-2;e>=-1&&-1!==e;e--){const t=Number.MIN_VALUE+_*Math.abs(f[e]+Math.abs(f[e+1]));if(Math.abs(m[e])<=t||Number.isNaN(m[e])){m[e]=0;break}}if(e===C-2)t=4;else{let n;for(n=C-1;n>=e&&n!==e;n--){let t=(n!==C?Math.abs(m[n]):0)+(n!==e+1?Math.abs(m[n-1]):0);if(Math.abs(f[n])<=_*t){f[n]=0;break}}n===e?t=3:n===C-1?t=1:(t=2,e=n)}switch(e++,t){case 1:{let t=m[C-2];m[C-2]=0;for(let n=C-2;n>=e;n--){let i=MZ(f[n],t),o=f[n]/i,s=t/i;if(f[n]=i,n!==e&&(t=-s*m[n-1],m[n-1]=o*m[n-1]),c)for(let e=0;e<r;e++)i=o*g.get(e,n)+s*g.get(e,C-1),g.set(e,C-1,-s*g.get(e,n)+o*g.get(e,C-1)),g.set(e,n,i)}break}case 2:{let t=m[e-1];m[e-1]=0;for(let r=e;r<C;r++){let i=MZ(f[r],t),o=f[r]/i,s=t/i;if(f[r]=i,t=-s*m[r],m[r]=o*m[r],l)for(let t=0;t<n;t++)i=o*p.get(t,r)+s*p.get(t,e-1),p.set(t,e-1,-s*p.get(t,r)+o*p.get(t,e-1)),p.set(t,r,i)}break}case 3:{const t=Math.max(Math.abs(f[C-1]),Math.abs(f[C-2]),Math.abs(m[C-2]),Math.abs(f[e]),Math.abs(m[e])),i=f[C-1]/t,o=f[C-2]/t,s=m[C-2]/t,a=f[e]/t,u=m[e]/t,h=((o+i)*(o-i)+s*s)/2,d=i*s*(i*s);let v=0;0===h&&0===d||(v=h<0?0-Math.sqrt(h*h+d):Math.sqrt(h*h+d),v=d/(h+v));let y=(a+i)*(a-i)+v,b=a*u;for(let t=e;t<C-1;t++){let i=MZ(y,b);0===i&&(i=Number.MIN_VALUE);let o=y/i,s=b/i;if(t!==e&&(m[t-1]=i),y=o*f[t]+s*m[t],m[t]=o*m[t]-s*f[t],b=s*f[t+1],f[t+1]=o*f[t+1],c)for(let e=0;e<r;e++)i=o*g.get(e,t)+s*g.get(e,t+1),g.set(e,t+1,-s*g.get(e,t)+o*g.get(e,t+1)),g.set(e,t,i);if(i=MZ(y,b),0===i&&(i=Number.MIN_VALUE),o=y/i,s=b/i,f[t]=i,y=o*m[t]+s*f[t+1],f[t+1]=-s*m[t]+o*f[t+1],b=s*m[t+1],m[t+1]=o*m[t+1],l&&t<n-1)for(let e=0;e<n;e++)i=o*p.get(e,t)+s*p.get(e,t+1),p.set(e,t+1,-s*p.get(e,t)+o*p.get(e,t+1)),p.set(e,t,i)}m[C-2]=y;break}case 4:if(f[e]<=0&&(f[e]=f[e]<0?-f[e]:0,c))for(let t=0;t<=E;t++)g.set(t,e,-g.get(t,e));for(;e<E&&!(f[e]>=f[e+1]);){let t=f[e];if(f[e]=f[e+1],f[e+1]=t,c&&e<r-1)for(let n=0;n<r;n++)t=g.get(n,e+1),g.set(n,e+1,g.get(n,e)),g.set(n,e,t);if(l&&e<n-1)for(let r=0;r<n;r++)t=p.get(r,e+1),p.set(r,e+1,p.get(r,e)),p.set(r,e,t);e++}C--}}if(u){let e=g;g=p,p=e}this.m=n,this.n=r,this.s=f,this.U=p,this.V=g}solve(e){let t=e,n=this.threshold,r=this.s.length,i=AZ.zeros(r,r);for(let e=0;e<r;e++)Math.abs(this.s[e])<=n?i.set(e,e,0):i.set(e,e,1/this.s[e]);let o=this.U,s=this.rightSingularVectors,a=s.mmul(i),l=s.rows,c=o.rows,u=AZ.zeros(l,c);for(let e=0;e<l;e++)for(let t=0;t<c;t++){let n=0;for(let i=0;i<r;i++)n+=a.get(e,i)*o.get(t,i);u.set(e,t,n)}return u.mmul(t)}solveForDiagonal(e){return this.solve(AZ.diag(e))}inverse(){let e=this.V,t=this.threshold,n=e.rows,r=e.columns,i=new AZ(n,this.s.length);for(let o=0;o<n;o++)for(let n=0;n<r;n++)Math.abs(this.s[n])>t&&i.set(o,n,e.get(o,n)/this.s[n]);let o=this.U,s=o.rows,a=o.columns,l=new AZ(n,s);for(let e=0;e<n;e++)for(let t=0;t<s;t++){let n=0;for(let r=0;r<a;r++)n+=i.get(e,r)*o.get(t,r);l.set(e,t,n)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let e=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,n=this.s;for(let r=0,i=n.length;r<i;r++)n[r]>e&&t++;return t}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return AZ.diag(this.s)}}class PZ{constructor(e){this.distances=e.distances,this.dimension=e.dimension||2,this.linkDistance=e.linkDistance}layout(){const{dimension:e,distances:t,linkDistance:n}=this;try{const n=AZ.mul(AZ.pow(t,2),-.5),r=n.mean("row"),i=n.mean("column"),o=n.mean();n.add(o).subRowVector(r).subColumnVector(i);const s=new TZ(n),a=AZ.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((t=>AZ.mul([t],[a]).toJSON()[0].splice(0,e)))}catch(e){const r=[];for(let e=0;e<t.length;e++){const e=Math.random()*n,t=Math.random()*n;r.push([e,t])}return r}}}class DZ{constructor(e){this.disp=[],this.positions=e.positions,this.adjMatrix=e.adjMatrix,this.focusID=e.focusID,this.radii=e.radii,this.iterations=e.iterations||10,this.height=e.height||10,this.width=e.width||10,this.speed=e.speed||100,this.gravity=e.gravity||10,this.nodeSizeFunc=e.nodeSizeFunc,this.k=e.k||5,this.strictRadial=e.strictRadial,this.nodes=e.nodes}layout(){const e=this,t=e.positions,n=[],r=e.iterations,i=e.width/10;e.maxDisplace=i,e.disp=n;for(let i=0;i<r;i++)t.forEach(((e,t)=>{n[t]={x:0,y:0}})),e.getRepulsion(),e.updatePositions();return t}getRepulsion(){const e=this,t=e.positions,n=e.nodes,r=e.disp,i=e.k,o=e.radii||[];t.forEach(((s,a)=>{r[a]={x:0,y:0},t.forEach(((t,l)=>{if(a===l)return;if(o[a]!==o[l])return;let c=s[0]-t[0],u=s[1]-t[1],h=Math.sqrt(c*c+u*u);if(0===h){h=1;const e=a>l?1:-1;c=.01*e,u=.01*e}if(h<e.nodeSizeFunc(n[a])/2+e.nodeSizeFunc(n[l])/2){const e=i*i/h;r[a].x+=c/h*e,r[a].y+=u/h*e}}))}))}updatePositions(){const e=this,t=e.positions,n=e.disp,r=e.speed,i=e.strictRadial,o=e.focusID,s=e.maxDisplace||e.width/10;i&&n.forEach(((e,n)=>{const r=t[n][0]-t[o][0],i=t[n][1]-t[o][1],s=Math.sqrt(r*r+i*i);let a=i/s,l=-r/s;const c=Math.sqrt(e.x*e.x+e.y*e.y);let u=Math.acos((a*e.x+l*e.y)/c);u>Math.PI/2&&(u-=Math.PI/2,a*=-1,l*=-1);const h=Math.cos(u)*c;e.x=a*h,e.y=l*h}));const a=e.radii;t.forEach(((e,l)=>{if(l===o)return;const c=Math.sqrt(n[l].x*n[l].x+n[l].y*n[l].y);if(c>0&&l!==o){const u=Math.min(s*(r/800),c);if(e[0]+=n[l].x/c*u,e[1]+=n[l].y/c*u,i){let n=e[0]-t[o][0],r=e[1]-t[o][1];const i=Math.sqrt(n*n+r*r);n=n/i*a[l],r=r/i*a[l],e[0]=t[o][0]+n,e[1]=t[o][1]+r}}}))}}function NZ(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var RZ={exports:{}};!function(e){e.exports=function(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})},e.exports.default=e.exports,e.exports.__esModule=!0}(RZ);var IZ=h(RZ.exports),jZ={exports:{}};!function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0}(jZ);var LZ=h(jZ.exports),FZ={exports:{}};!function(e){function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e},e.exports.default=e.exports,e.exports.__esModule=!0}(FZ);var GZ=h(FZ.exports),BZ={exports:{}};!function(e){e.exports=function(e,t,n,r,i){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o},e.exports.default=e.exports,e.exports.__esModule=!0}(BZ);var zZ=h(BZ.exports);!function(e){e.exports=function(e,t){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")},e.exports.default=e.exports,e.exports.__esModule=!0}({exports:{}});var UZ={exports:{}};!function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof m?t:m,o=Object.create(i.prototype),s=new k(r||[]);return o._invoke=function(e,t,n){var r=h;return function(i,o){if(r===f)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return T()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=S(s,n);if(a){if(a===g)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var l=u(e,t,n);if("normal"===l.type){if(r=n.done?p:d,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=p,n.method="throw",n.arg=l.arg)}}}(e,n,s),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var h="suspendedStart",d="suspendedYield",f="executing",p="completed",g={};function m(){}function v(){}function y(){}var b={};l(b,o,(function(){return this}));var x=Object.getPrototypeOf,w=x&&x(x(M([])));w&&w!==n&&r.call(w,o)&&(b=w);var C=y.prototype=m.prototype=Object.create(b);function E(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(i,o,s,a){var l=u(e[i],e,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(h).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,a)}))}a(l.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function S(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=u(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function M(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}return{next:T}}function T(){return{value:t,done:!0}}return v.prototype=y,l(C,"constructor",y),l(y,"constructor",v),v.displayName=l(y,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,a,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},E(_.prototype),l(_.prototype,s,(function(){return this})),e.AsyncIterator=_,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new _(c(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},E(C),l(C,a,"Generator"),l(C,o,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=M,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:M(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(UZ);var VZ=UZ.exports,HZ={exports:{}};!function(e){function t(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}e.exports=function(e){return function(){var n=this,r=arguments;return new Promise((function(i,o){var s=e.apply(n,r);function a(e){t(s,i,o,a,l,"next",e)}function l(e){t(s,i,o,a,l,"throw",e)}a(void 0)}))}},e.exports.default=e.exports,e.exports.__esModule=!0}(HZ);var WZ=h(HZ.exports),$Z=1;function XZ(){return $Z++}var YZ=function e(t){LZ(this,e)},qZ=function(){function e(t){LZ(this,e),this.clazz=void 0,this.components=[],this.entities=[],this.lookup={},this.clazz=t}var t;return GZ(e,[{key:"clear",value:function(){this.components=[],this.entities=[],this.lookup={}}},{key:"contains",value:function(e){return this.lookup[e]>-1}},{key:"create",value:function(e,t){this.lookup[e]=this.components.length;var n=new this.clazz(t||{});return this.components.push(n),this.entities.push(e),n}},{key:"remove",value:function(e){var t=this.lookup[e];t>-1&&t<this.components.length-1&&(this.components[t]=this.components[this.components.length-1],this.entities[t]=this.entities[this.entities.length-1],this.lookup[this.entities[t]]=t),this.components.pop(),this.entities.pop(),delete this.lookup[e]}},{key:"removeKeepSorted",value:function(e){var t=this.lookup[e];if(t>-1){var n=this.entities[t];if(t<this.components.length-1){for(var r=t+1;r<this.components.length;++r)this.components[r-1]=this.components[r];for(var i=t+1;i<this.entities.length;++i)this.entities[i-1]=this.entities[i],this.lookup[this.entities[i-1]]=i-1}this.components.pop(),this.entities.pop(),delete this.lookup[n]}}},{key:"moveItem",value:function(e,t){if(e!==t){for(var n=this.components[e],r=this.entities[e],i=e<t?1:-1,o=e;o!==t;o+=i){var s=o+i;this.components[o]=this.components[s],this.entities[o]=this.entities[s],this.lookup[this.entities[o]]=o}this.components[t]=n,this.entities[t]=r,this.lookup[r]=t}}},{key:"getEntity",value:function(e){return this.entities[e]}},{key:"getComponent",value:function(e){return this.components[e]}},{key:"getComponentByEntity",value:function(e){var t=this.lookup[e];return t>-1?this.components[t]:null}},{key:"getCount",value:function(){return this.components.length}},{key:"getEntityByComponentIndex",value:function(e){for(var t=0,n=Object.keys(this.lookup);t<n.length;t++){var r=n[t],i=Number(r);if(this.lookup[i]===e)return i}return-1}},{key:"find",value:function(e){for(var t=0;t<this.getCount();t++){var n=this.getComponent(t);if(e(n,t))return n}return null}},{key:"findIndex",value:function(e){for(var t=0;t<this.getCount();t++){if(e(this.getComponent(t),t))return t}return-1}},{key:"forEach",value:function(e){for(var t=0,n=Object.keys(this.lookup);t<n.length;t++){var r=n[t],i=Number(r),o=this.lookup[i];e(i,this.getComponent(o))}}},{key:"forEachAsync",value:(t=WZ(VZ.mark((function e(t){var n,r,i,o,s;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0,r=Object.keys(this.lookup);case 1:if(!(n<r.length)){e.next=10;break}return i=r[n],o=Number(i),s=this.lookup[o],e.next=7,t(o,this.getComponent(s));case 7:n++,e.next=1;break;case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"map",value:function(e){for(var t=[],n=0,r=Object.keys(this.lookup);n<r.length;n++){var i=r[n],o=Number(i),s=this.lookup[o];t.push(e(o,this.getComponent(s)))}return t}}]),e}(),KZ={exports:{}},ZZ={exports:{}};!function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.default=e.exports,e.exports.__esModule=!0}(ZZ);var JZ={exports:{}};!function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}},e.exports.default=e.exports,e.exports.__esModule=!0}(JZ);var QZ={exports:{}},eJ={exports:{}};!function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.default=e.exports,e.exports.__esModule=!0}(eJ),function(e){var t=eJ.exports;e.exports=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0}(QZ);var tJ={exports:{}};!function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}(tJ),function(e){var t=ZZ.exports,n=JZ.exports,r=QZ.exports,i=tJ.exports;e.exports=function(e,o){return t(e)||n(e,o)||r(e,o)||i()},e.exports.default=e.exports,e.exports.__esModule=!0}(KZ);var nJ=h(KZ.exports),rJ={HierarchyComponentManager:Symbol("HierarchyComponentManager"),TransformComponentManager:Symbol("TransformComponentManager"),NameComponentManager:Symbol("NameComponentManager"),SceneGraphSystem:Symbol("SceneGraphSystem"),FrameGraphSystem:Symbol("FrameGraphSystem"),ResourcePool:Symbol("ResourcePool"),ResourceHandleComponentManager:Symbol("ResourceHandleComponentManager"),PassNodeComponentManager:Symbol("PassNodeComponentManager"),RendererSystem:Symbol("RendererSystem"),RenderPass:Symbol("RenderPass"),RenderPassFactory:Symbol("Factory<IRenderPass>"),Renderable:Symbol("Factory<IRenderPass>"),MeshSystem:Symbol("MeshSystem"),MeshComponentManager:Symbol("MeshComponentManager"),CullableComponentManager:Symbol("CullableComponentManager"),Geometry:Symbol("Geometry"),GeometrySystem:Symbol("GeometrySystem"),GeometryComponentManager:Symbol("GeometryComponentManager"),Material:Symbol("Material"),MaterialSystem:Symbol("MaterialSystem"),MaterialComponentManager:Symbol("MaterialComponentManager"),ForwardRenderPath:Symbol("ForwardRenderPath"),ComputeSystem:Symbol("ComputeSystem"),ComputeComponentManager:Symbol("ComputeComponentManager"),ComputeStrategy:Symbol("ComputeStrategy"),Systems:Symbol("Systems"),World:Symbol("World"),RenderEngine:Symbol("RenderEngine"),WebGPUEngine:Symbol("WebGPUEngine"),WebGLEngine:Symbol("WebGLEngine"),ShaderModuleService:Symbol("ShaderModuleService"),ConfigService:Symbol("ConfigService"),InteractorService:Symbol("InteractorService"),IEventEmitter:Symbol("IEventEmitter"),Light:Symbol("Light")},iJ=function e(){LZ(this,e),this.index=void 0},oJ=function e(){LZ(this,e),this.name=void 0,this.data=void 0,this.execute=void 0,this.tearDown=void 0},sJ=function(){function e(){LZ(this,e),this.name=void 0,this.refCount=0,this.hasSideEffect=!1,this.devirtualize=[],this.destroy=[],this.reads=[],this.writes=[]}return GZ(e,[{key:"read",value:function(e){return this.reads.find((function(t){return t.index===e.index}))||this.reads.push(e),e}},{key:"sample",value:function(e){return this.read(e),e}},{key:"write",value:function(e,t){var n=this.writes.find((function(e){return e.index===t.index}));if(n)return t;var r=e.getResourceNode(t);r.resource.version++,r.resource.imported&&(this.hasSideEffect=!0);var i=e.createResourceNode(r.resource);return e.getResourceNode(i).writer=this,this.writes.push(i),i}}]),e}(),aJ={exports:{}},lJ={exports:{}};!function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,t(n,r)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}(lJ),function(e){var t=lJ.exports;e.exports=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&t(e,n)},e.exports.default=e.exports,e.exports.__esModule=!0}(aJ);var cJ=h(aJ.exports),uJ={exports:{}},hJ={exports:{}};!function(e){function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}(hJ);var dJ=h(hJ.exports),fJ={exports:{}};!function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0}(fJ);var pJ=h(fJ.exports);!function(e){var t=hJ.exports.default,n=fJ.exports;e.exports=function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return n(e)},e.exports.default=e.exports,e.exports.__esModule=!0}(uJ);var gJ=h(uJ.exports),mJ={exports:{}};!function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.default=e.exports,e.exports.__esModule=!0,t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}(mJ);var vJ=h(mJ.exports);function yJ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var bJ,xJ,wJ,CJ,EJ,_J,SJ=function(e){cJ(n,e);var t=yJ(n);function n(){var e;LZ(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).version=0,e.refs=0,e.name=void 0,e.imported=void 0,e.priority=void 0,e.discardStart=!0,e.discardEnd=!1,e.descriptor=void 0,e.resource=void 0,e}return GZ(n,[{key:"preExecuteDestroy",value:function(){this.discardEnd=!0}},{key:"postExecuteDestroy",value:function(){this.imported}},{key:"postExecuteDevirtualize",value:function(){this.discardStart=!1}},{key:"preExecuteDevirtualize",value:function(){this.imported}}]),n}((function e(){LZ(this,e),this.first=void 0,this.last=void 0})),OJ=function e(){LZ(this,e),this.resource=void 0,this.writer=void 0,this.readerCount=0,this.version=void 0};function AJ(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return kJ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kJ(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function kJ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var MJ=(bJ=f.injectable(),xJ=f.inject(rJ.RenderEngine),bJ((_J=function(){function e(){LZ(this,e),this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[],IZ(this,"engine",EJ,this)}var t,n;return GZ(e,[{key:"execute",value:(n=WZ(VZ.mark((function e(t){return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.compile(),e.next=3,this.executePassNodes(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"tearDown",value:function(){this.frameGraphPasses.forEach((function(e){e.tearDown&&e.tearDown()})),this.reset()}},{key:"addPass",value:function(e,t,n,r){var i=new oJ;i.execute=n,r&&(i.tearDown=r),i.name=e;var o=new sJ;return o.name=e,this.passNodes.push(o),this.frameGraphPasses.push(i),t(this,o,i),i}},{key:"getPass",value:function(e){return this.frameGraphPasses.find((function(t){return t.name===e}))}},{key:"compile",value:function(){var e,t=this,n=AJ(this.passNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.refCount=r.writes.length+(r.hasSideEffect?1:0),r.reads.forEach((function(e){t.resourceNodes[e.index].readerCount++}))}}catch(e){n.e(e)}finally{n.f()}var i,o=[],s=AJ(this.resourceNodes);try{for(s.s();!(i=s.n()).done;){var a=i.value;0===a.readerCount&&o.push(a)}}catch(e){s.e(e)}finally{s.f()}for(;o.length;){var l=o.pop(),c=l&&l.writer;if(c&&0==--c.refCount){var u,h=AJ(c.reads);try{for(h.s();!(u=h.n()).done;){var d=u.value,f=this.resourceNodes[d.index];0==--f.readerCount&&o.push(f)}}catch(e){h.e(e)}finally{h.f()}}}this.resourceNodes.forEach((function(e){e.resource.refs+=e.readerCount}));var p,g=AJ(this.passNodes);try{for(g.s();!(p=g.n()).done;){var m=p.value;if(m.refCount){var v,y=AJ(m.reads);try{for(y.s();!(v=y.n()).done;){var b=v.value,x=this.resourceNodes[b.index].resource;x.first=x.first?x.first:m,x.last=m}}catch(e){y.e(e)}finally{y.f()}var w,C=AJ(m.writes);try{for(C.s();!(w=C.n()).done;){var E=w.value,_=this.resourceNodes[E.index].resource;_.first=_.first?_.first:m,_.last=m}}catch(e){C.e(e)}finally{C.f()}}}}catch(e){g.e(e)}finally{g.f()}for(var S=0;S<2;S++){var O,A=AJ(this.resourceNodes);try{for(A.s();!(O=A.n()).done;){var k=O.value.resource;if(k.priority===S&&k.refs){var M=k.first,T=k.last;M&&T&&(M.devirtualize.push(k),T.destroy.push(k))}}}catch(e){A.e(e)}finally{A.f()}}}},{key:"executePassNodes",value:(t=WZ(VZ.mark((function e(t){var n,r,i,o,s,a,l,c,u,h,d,f,p;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=AJ(this.passNodes.entries()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=18;break}if(i=nJ(r.value,2),o=i[0],!(s=i[1]).refCount){e.next=16;break}a=AJ(s.devirtualize);try{for(a.s();!(l=a.n()).done;)l.value.preExecuteDevirtualize(this.engine)}catch(e){a.e(e)}finally{a.f()}c=AJ(s.destroy);try{for(c.s();!(u=c.n()).done;)u.value.preExecuteDestroy(this.engine)}catch(e){c.e(e)}finally{c.f()}return e.next=12,this.frameGraphPasses[o].execute(this,this.frameGraphPasses[o],t);case 12:h=AJ(s.devirtualize);try{for(h.s();!(d=h.n()).done;)d.value.postExecuteDevirtualize(this.engine)}catch(e){h.e(e)}finally{h.f()}f=AJ(s.destroy);try{for(f.s();!(p=f.n()).done;)p.value.postExecuteDestroy(this.engine)}catch(e){f.e(e)}finally{f.f()}case 16:e.next=3;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(1),n.e(e.t0);case 23:return e.prev=23,n.f(),e.finish(23);case 26:this.reset();case 27:case"end":return e.stop()}}),e,this,[[1,20,23,26]])}))),function(e){return t.apply(this,arguments)})},{key:"reset",value:function(){this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[]}},{key:"getResourceNode",value:function(e){return this.resourceNodes[e.index]}},{key:"createResourceNode",value:function(e){var t=new OJ;t.resource=e,t.version=e.version,this.resourceNodes.push(t);var n=new iJ;return n.index=this.resourceNodes.length-1,n}},{key:"createTexture",value:function(e,t,n){var r=new SJ;return r.name=t,r.descriptor=n,this.createResourceNode(r)}},{key:"createRenderTarget",value:function(e,t,n){var r=new SJ;return r.name=t,r.descriptor=n,this.createResourceNode(r)}},{key:"present",value:function(e){this.addPass("Present",(function(t,n){n.read(e),n.hasSideEffect=!0}),WZ(VZ.mark((function e(){return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))))}}]),e}(),EJ=zZ((CJ=_J).prototype,"engine",[xJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wJ=CJ))||wJ),TJ={exports:{}};!function(e){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0}(TJ);var PJ=h(TJ.exports),DJ=1e-6,NJ="undefined"!=typeof Float32Array?Float32Array:Array;function RJ(){var e=new NJ(9);return NJ!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function IJ(){var e=new NJ(16);return NJ!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function jJ(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function LJ(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function FJ(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],m=t[14],v=t[15],y=n*a-r*s,b=n*l-i*s,x=n*c-o*s,w=r*l-i*a,C=r*c-o*a,E=i*c-o*l,_=u*g-h*p,S=u*m-d*p,O=u*v-f*p,A=h*m-d*g,k=h*v-f*g,M=d*v-f*m,T=y*M-b*k+x*A+w*O-C*S+E*_;return T?(T=1/T,e[0]=(a*M-l*k+c*A)*T,e[1]=(i*k-r*M-o*A)*T,e[2]=(g*E-m*C+v*w)*T,e[3]=(d*C-h*E-f*w)*T,e[4]=(l*O-s*M-c*S)*T,e[5]=(n*M-i*O+o*S)*T,e[6]=(m*x-p*E-v*b)*T,e[7]=(u*E-d*x+f*b)*T,e[8]=(s*k-a*O+c*_)*T,e[9]=(r*O-n*k-o*_)*T,e[10]=(p*C-g*x+v*y)*T,e[11]=(h*x-u*C-f*y)*T,e[12]=(a*S-s*A-l*_)*T,e[13]=(n*A-r*S+i*_)*T,e[14]=(g*b-p*w-m*y)*T,e[15]=(u*w-h*b+d*y)*T,e):null}function GJ(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],g=t[12],m=t[13],v=t[14],y=t[15],b=n[0],x=n[1],w=n[2],C=n[3];return e[0]=b*r+x*a+w*h+C*g,e[1]=b*i+x*l+w*d+C*m,e[2]=b*o+x*c+w*f+C*v,e[3]=b*s+x*u+w*p+C*y,b=n[4],x=n[5],w=n[6],C=n[7],e[4]=b*r+x*a+w*h+C*g,e[5]=b*i+x*l+w*d+C*m,e[6]=b*o+x*c+w*f+C*v,e[7]=b*s+x*u+w*p+C*y,b=n[8],x=n[9],w=n[10],C=n[11],e[8]=b*r+x*a+w*h+C*g,e[9]=b*i+x*l+w*d+C*m,e[10]=b*o+x*c+w*f+C*v,e[11]=b*s+x*u+w*p+C*y,b=n[12],x=n[13],w=n[14],C=n[15],e[12]=b*r+x*a+w*h+C*g,e[13]=b*i+x*l+w*d+C*m,e[14]=b*o+x*c+w*f+C*v,e[15]=b*s+x*u+w*p+C*y,e}function BJ(e,t,n){var r,i,o,s,a,l,c,u,h,d,f,p,g=n[0],m=n[1],v=n[2];return t===e?(e[12]=t[0]*g+t[4]*m+t[8]*v+t[12],e[13]=t[1]*g+t[5]*m+t[9]*v+t[13],e[14]=t[2]*g+t[6]*m+t[10]*v+t[14],e[15]=t[3]*g+t[7]*m+t[11]*v+t[15]):(r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=s,e[4]=a,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=f,e[11]=p,e[12]=r*g+a*m+h*v+t[12],e[13]=i*g+l*m+d*v+t[13],e[14]=o*g+c*m+f*v+t[14],e[15]=s*g+u*m+p*v+t[15]),e}function zJ(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function UJ(e,t){var n=t[0],r=t[1],i=t[2],o=t[4],s=t[5],a=t[6],l=t[8],c=t[9],u=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(o,s,a),e[2]=Math.hypot(l,c,u),e}function VJ(e,t){var n=new NJ(3);UJ(n,t);var r=1/n[0],i=1/n[1],o=1/n[2],s=t[0]*r,a=t[1]*i,l=t[2]*o,c=t[4]*r,u=t[5]*i,h=t[6]*o,d=t[8]*r,f=t[9]*i,p=t[10]*o,g=s+u+p,m=0;return g>0?(m=2*Math.sqrt(g+1),e[3]=.25*m,e[0]=(h-f)/m,e[1]=(d-l)/m,e[2]=(a-c)/m):s>u&&s>p?(m=2*Math.sqrt(1+s-u-p),e[3]=(h-f)/m,e[0]=.25*m,e[1]=(a+c)/m,e[2]=(d+l)/m):u>p?(m=2*Math.sqrt(1+u-s-p),e[3]=(d-l)/m,e[0]=(a+c)/m,e[1]=.25*m,e[2]=(h+f)/m):(m=2*Math.sqrt(1+p-s-u),e[3]=(a-c)/m,e[0]=(d+l)/m,e[1]=(h+f)/m,e[2]=.25*m),e}function HJ(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n+n,a=r+r,l=i+i,c=n*s,u=r*s,h=r*a,d=i*s,f=i*a,p=i*l,g=o*s,m=o*a,v=o*l;return e[0]=1-h-p,e[1]=u+v,e[2]=d-m,e[3]=0,e[4]=u-v,e[5]=1-c-p,e[6]=f+g,e[7]=0,e[8]=d+m,e[9]=f-g,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var WJ=function(e,t,n,r,i){var o,s=1/Math.tan(t/2);return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(o=1/(r-i),e[10]=(i+r)*o,e[14]=2*i*r*o):(e[10]=-1,e[14]=-2*r),e};var $J=function(e,t,n,r,i,o,s){var a=1/(t-n),l=1/(r-i),c=1/(o-s);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*a,e[13]=(i+r)*l,e[14]=(s+o)*c,e[15]=1,e};function XJ(){var e=new NJ(3);return NJ!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function YJ(e){var t=new NJ(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function qJ(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function KJ(e,t,n){var r=new NJ(3);return r[0]=e,r[1]=t,r[2]=n,r}function ZJ(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function JJ(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function QJ(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function eQ(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function tQ(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function nQ(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function rQ(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function iQ(e,t,n,r){var i=t[0],o=t[1],s=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=s+r*(n[2]-s),e}function oQ(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,e}function sQ(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e}var aQ=eQ,lQ=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.hypot(n,r,i)},cQ=qJ;function uQ(){var e=new NJ(4);return NJ!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function hQ(e,t,n,r){var i=new NJ(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function dQ(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,e}function fQ(){var e=new NJ(4);return NJ!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function pQ(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function gQ(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3],a=n[0],l=n[1],c=n[2],u=n[3];return e[0]=r*u+s*a+i*c-o*l,e[1]=i*u+s*l+o*a-r*c,e[2]=o*u+s*c+r*l-i*a,e[3]=s*u-r*a-i*l-o*c,e}function mQ(e,t,n,r){var i,o,s,a,l,c=t[0],u=t[1],h=t[2],d=t[3],f=n[0],p=n[1],g=n[2],m=n[3];return(o=c*f+u*p+h*g+d*m)<0&&(o=-o,f=-f,p=-p,g=-g,m=-m),1-o>DJ?(i=Math.acos(o),s=Math.sin(i),a=Math.sin((1-r)*i)/s,l=Math.sin(r*i)/s):(a=1-r,l=r),e[0]=a*c+l*f,e[1]=a*u+l*p,e[2]=a*h+l*g,e[3]=a*d+l*m,e}function vQ(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;return e[0]=-n*a,e[1]=-r*a,e[2]=-i*a,e[3]=o*a,e}function yQ(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var o=Math.sin(t),s=Math.cos(t),a=Math.sin(n),l=Math.cos(n),c=Math.sin(r),u=Math.cos(r);return e[0]=o*l*u-s*a*c,e[1]=s*a*u+o*l*c,e[2]=s*l*c-o*a*u,e[3]=s*l*u+o*a*c,e}!function(){var e=XJ()}(),function(){var e=uQ()}();var bQ=hQ,xQ=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},wQ=gQ,CQ=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=n*s,e[1]=r*s,e[2]=i*s,e[3]=o*s,e};XJ(),KJ(1,0,0),KJ(0,1,0),fQ(),fQ(),RJ();var EQ=9007199254740991,_Q={};_Q["[object Float32Array]"]=_Q["[object Float64Array]"]=_Q["[object Int8Array]"]=_Q["[object Int16Array]"]=_Q["[object Int32Array]"]=_Q["[object Uint8Array]"]=_Q["[object Uint8ClampedArray]"]=_Q["[object Uint16Array]"]=_Q["[object Uint32Array]"]=!0,_Q["[object Arguments]"]=_Q["[object Array]"]=_Q["[object ArrayBuffer]"]=_Q["[object Boolean]"]=_Q["[object DataView]"]=_Q["[object Date]"]=_Q["[object Error]"]=_Q["[object Function]"]=_Q["[object Map]"]=_Q["[object Number]"]=_Q["[object Object]"]=_Q["[object RegExp]"]=_Q["[object Set]"]=_Q["[object String]"]=_Q["[object WeakMap]"]=!1;var SQ=Object.prototype.toString;var OQ=function(e){return function(e){return!!e&&"object"===dJ(e)}(e)&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=EQ}(e.length)&&!!_Q[SQ.call(e)]};function AQ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kQ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?AQ(Object(n),!0).forEach((function(t){PJ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AQ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function MQ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var TQ,PQ,DQ,NQ,RQ,IQ,jQ,LQ,FQ,GQ=function(e){cJ(n,e);var t=MQ(n);function n(e){var r;return LZ(this,n),(r=t.call(this,e)).dirty=!0,r.attributes=[],r.indices=void 0,r.indicesBuffer=void 0,r.vertexCount=0,r.maxInstancedCount=void 0,r.aabb=void 0,r.entity=void 0,Object.assign(pJ(r),e),r}return GZ(n,[{key:"setAttribute",value:function(e,t,n,r){var i=this.attributes.find((function(t){return t.name===e}));return i?(i.data=t,i.dirty=!0):this.attributes.push(kQ(kQ({dirty:!0,name:e,data:t},n),{},{bufferGetter:r})),this.dirty=!0,this}},{key:"setIndex",value:function(e){return this.indices=new Uint32Array(e.buffer?e.buffer:e),this.dirty=!0,this}},{key:"applyMatrix",value:function(e){var t=this.attributes.find((function(e){return"position"===e.name})),n=this.attributes.find((function(e){return"normal"===e.name}));if(t&&(t.dirty=!0,t.data&&t.data.length))for(var r=0;r<t.data.length;r+=3){var i=hQ(t.data[r],t.data[r+1],t.data[r+2],1);dQ(i,i,e),OQ(t.data)?t.data.set([i[0],i[1],i[2]],r):(t.data[r]=i[0],t.data[r+1]=i[1],t.data[r+2]=i[2])}if(n){var o=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],m=t[14],v=t[15],y=n*a-r*s,b=n*l-i*s,x=n*c-o*s,w=r*l-i*a,C=r*c-o*a,E=i*c-o*l,_=u*g-h*p,S=u*m-d*p,O=u*v-f*p,A=h*m-d*g,k=h*v-f*g,M=d*v-f*m,T=y*M-b*k+x*A+w*O-C*S+E*_;return T?(T=1/T,e[0]=(a*M-l*k+c*A)*T,e[1]=(l*O-s*M-c*S)*T,e[2]=(s*k-a*O+c*_)*T,e[3]=(i*k-r*M-o*A)*T,e[4]=(n*M-i*O+o*S)*T,e[5]=(r*O-n*k-o*_)*T,e[6]=(g*E-m*C+v*w)*T,e[7]=(m*x-p*E-v*b)*T,e[8]=(p*C-g*x+v*y)*T,e):null}(RJ(),e);if(n.data&&n.data.length)for(var s=0;s<n.data.length;s+=3){var a=KJ(n.data[s],n.data[s+1],n.data[s+2]);sQ(a,a,o),nQ(a,a),OQ(n.data)?n.data.set([a[0],a[1],a[2]],s):(n.data[s]=a[0],n.data[s+1]=a[1],n.data[s+2]=a[2])}}}}]),n}(YZ);!function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.SAMPLED=4]="SAMPLED",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"}(TQ||(TQ={}));var BQ=(PQ=f.injectable(),DQ=f.inject(rJ.GeometryComponentManager),NQ=f.inject(rJ.RenderEngine),PQ((FQ=function(){function e(){LZ(this,e),IZ(this,"geometry",jQ,this),IZ(this,"engine",LQ,this)}var t;return GZ(e,[{key:"execute",value:(t=WZ(VZ.mark((function e(){var t=this;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.geometry.forEach((function(e,n){n.dirty&&(n.attributes.forEach((function(e){var n;e.dirty&&e.data&&(e.buffer?null===(n=e.buffer)||void 0===n||n.subData({data:e.data,offset:0}):e.buffer=t.engine.createBuffer({data:e.data,type:TQ.FLOAT}),e.dirty=!1)})),n.indices&&(n.indicesBuffer?n.indicesBuffer.subData({data:n.indices,offset:0}):n.indicesBuffer=t.engine.createElements({data:n.indices,count:n.indices.length,type:TQ.UNSIGNED_INT,usage:TQ.STATIC_DRAW})),n.dirty=!1)}));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"tearDown",value:function(){this.geometry.forEach((function(e,t){t.indicesBuffer&&t.indicesBuffer.destroy(),t.attributes.forEach((function(e){e.buffer&&e.buffer.destroy()}))})),this.geometry.clear()}},{key:"createBufferGeometry",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{vertexCount:3},t=e.vertexCount,n=XZ();return this.geometry.create(n,{vertexCount:t})}},{key:"createInstancedBufferGeometry",value:function(e){var t=e.maxInstancedCount,n=e.vertexCount,r=XZ();return this.geometry.create(r,{maxInstancedCount:t,vertexCount:n})}}]),e}(),jQ=zZ((IQ=FQ).prototype,"geometry",[DQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LQ=zZ(IQ.prototype,"engine",[NQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RQ=IQ))||RQ);function zQ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function UQ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zQ(Object(n),!0).forEach((function(t){PJ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zQ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function VQ(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var HQ,WQ,$Q,XQ,YQ,qQ,KQ,ZQ,JQ,QQ,e0=function(e){cJ(n,e);var t=VQ(n);function n(e){var r;return LZ(this,n),(r=t.call(this,e)).vertexShaderGLSL=void 0,r.fragmentShaderGLSL=void 0,r.defines={},r.dirty=!0,r.uniforms=[],r.cull={enable:!0,face:TQ.BACK},r.depth={enable:!0},r.blend=void 0,r.entity=void 0,r.type=void 0,Object.assign(pJ(r),e),r}return GZ(n,[{key:"setDefines",value:function(e){return this.defines=UQ(UQ({},this.defines),e),this}},{key:"setCull",value:function(e){return this.cull=e,this}},{key:"setDepth",value:function(e){return this.depth=e,this}},{key:"setBlend",value:function(e){return this.blend=e,this}},{key:"setUniform",value:function(e,t){var n=this;if("string"!=typeof e)return Object.keys(e).forEach((function(t){return n.setUniform(t,e[t])})),this;var r=this.uniforms.find((function(t){return t.name===e}));return r?(r.dirty=!0,r.data=t):this.uniforms.push({name:e,dirty:!0,data:t}),this.dirty=!0,this}}]),n}(YZ);function t0(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n0(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?t0(Object(n),!0).forEach((function(t){PJ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t0(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var r0,i0=(HQ=f.injectable(),WQ=f.inject(rJ.MaterialComponentManager),$Q=f.inject(rJ.RenderEngine),XQ=f.inject(rJ.ShaderModuleService),HQ((QQ=function(){function e(){LZ(this,e),IZ(this,"material",KQ,this),IZ(this,"engine",ZQ,this),IZ(this,"shaderModule",JQ,this)}var t;return GZ(e,[{key:"execute",value:(t=WZ(VZ.mark((function e(){return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"tearDown",value:function(){this.material.clear()}},{key:"createShaderMaterial",value:function(e){var t=XZ(),n=e.vertexShader,r=e.fragmentShader,i=[];if(!this.engine.supportWebGPU){var o="material-".concat(t);this.shaderModule.registerModule(o,{vs:e.vertexShader,fs:e.fragmentShader});var s=this.shaderModule.getModule(o);n=s.vs,r=s.fs,s.uniforms&&(i=Object.keys(s.uniforms).map((function(e){return{dirty:!0,name:e,data:s.uniforms[e]}})))}return this.material.create(t,n0(n0({vertexShaderGLSL:n,fragmentShaderGLSL:r},e),{},{uniforms:i}))}}]),e}(),KQ=zZ((qQ=QQ).prototype,"material",[WQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZQ=zZ(qQ.prototype,"engine",[$Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JQ=zZ(qQ.prototype,"shaderModule",[XQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YQ=qQ))||YQ);function o0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}!function(e){e[e.Standard=0]="Standard"}(r0||(r0={}));var s0=function(e){cJ(n,e);var t=o0(n);function n(e){var r;return LZ(this,n),(r=t.call(this,e)).strategy=r0.Standard,r.visibilityPlaneMask=0,r.visible=!1,Object.assign(pJ(r),e),r}return n}(YZ),a0=function(){function e(t,n){LZ(this,e),this.center=void 0,this.halfExtents=void 0,this.min=XJ(),this.max=XJ(),this.update(t,n)}return GZ(e,[{key:"update",value:function(e,t){this.center=e||XJ(),this.halfExtents=t||KJ(.5,.5,.5),this.min=aQ(this.min,this.center,this.halfExtents),this.max=QJ(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(e,t){QJ(this.center,t,e),tQ(this.center,this.center,.5),aQ(this.halfExtents,t,e),tQ(this.halfExtents,this.halfExtents,.5),ZJ(this.min,e),ZJ(this.max,t)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){var t=this.center,n=t[0],r=t[1],i=t[2],o=this.halfExtents,s=o[0],a=o[1],l=o[2],c=n-s,u=n+s,h=r-a,d=r+a,f=i-l,p=i+l,g=e.center,m=g[0],v=g[1],y=g[2],b=e.halfExtents,x=b[0],w=b[1],C=b[2],E=m-x,_=m+x,S=v-w,O=v+w,A=y-C,k=y+C;E<c&&(c=E),_>u&&(u=_),S<h&&(h=S),O>d&&(d=O),A<f&&(f=A),k>p&&(p=k),t[0]=.5*(c+u),t[1]=.5*(h+d),t[2]=.5*(f+p),o[0]=.5*(u-c),o[1]=.5*(d-h),o[2]=.5*(p-f),this.min[0]=c,this.min[1]=h,this.min[2]=f,this.max[0]=u,this.max[1]=d,this.max[2]=p}},{key:"intersects",value:function(e){var t=this.getMax(),n=this.getMin(),r=e.getMax(),i=e.getMin();return n[0]<=r[0]&&t[0]>=i[0]&&n[1]<=r[1]&&t[1]>=i[1]&&n[2]<=r[2]&&t[2]>=i[2]}},{key:"containsPoint",value:function(e){var t=this.getMin(),n=this.getMax();return!(e[0]<t[0]||e[0]>n[0]||e[1]<t[1]||e[1]>n[1]||e[2]<t[2]||e[2]>n[2])}},{key:"getNegativeFarPoint",value:function(e){return 273===e.pnVertexFlag?ZJ(XJ(),this.min):272===e.pnVertexFlag?KJ(this.min[0],this.min[1],this.max[2]):257===e.pnVertexFlag?KJ(this.min[0],this.max[1],this.min[2]):256===e.pnVertexFlag?KJ(this.min[0],this.max[1],this.max[2]):17===e.pnVertexFlag?KJ(this.max[0],this.min[1],this.min[2]):16===e.pnVertexFlag?KJ(this.max[0],this.min[1],this.max[2]):1===e.pnVertexFlag?KJ(this.max[0],this.max[1],this.min[2]):KJ(this.max[0],this.max[1],this.max[2])}},{key:"getPositiveFarPoint",value:function(e){return 273===e.pnVertexFlag?ZJ(XJ(),this.max):272===e.pnVertexFlag?KJ(this.max[0],this.max[1],this.min[2]):257===e.pnVertexFlag?KJ(this.max[0],this.min[1],this.max[2]):256===e.pnVertexFlag?KJ(this.max[0],this.min[1],this.min[2]):17===e.pnVertexFlag?KJ(this.min[0],this.max[1],this.max[2]):16===e.pnVertexFlag?KJ(this.min[0],this.max[1],this.min[2]):1===e.pnVertexFlag?KJ(this.min[0],this.min[1],this.max[2]):KJ(this.min[0],this.min[1],this.min[2])}}]),e}();function l0(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var c0,u0=function(e){cJ(n,e);var t=l0(n);function n(e){var r;return LZ(this,n),(r=t.call(this,e)).material=void 0,r.geometry=void 0,r.aabb=new a0,r.aabbDirty=!0,r.model=void 0,r.visible=!0,r.children=[],Object.assign(pJ(r),e),r}return n}(YZ),h0=function(){function e(t,n){LZ(this,e),this.distance=void 0,this.normal=void 0,this.pnVertexFlag=void 0,this.distance=t||0,this.normal=n||KJ(0,1,0),this.updatePNVertexFlag()}return GZ(e,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(e){return rQ(e,this.normal)-this.distance}},{key:"normalize",value:function(){var e=1/cQ(this.normal);tQ(this.normal,this.normal,e),this.distance*=e}},{key:"intersectsLine",value:function(e,t,n){var r=this.distanceToPoint(e),i=r/(r-this.distanceToPoint(t)),o=i>=0&&i<=1;return o&&n&&iQ(n,e,t,i),o}}]),e}();!function(e){e[e.OUTSIDE=4294967295]="OUTSIDE",e[e.INSIDE=0]="INSIDE",e[e.INDETERMINATE=2147483647]="INDETERMINATE"}(c0||(c0={}));var d0,f0,p0,g0,m0,v0,y0,b0,x0,w0,C0,E0,_0,S0,O0=function(){function e(t){if(LZ(this,e),this.planes=[],t)this.planes=t;else for(var n=0;n<6;n++)this.planes.push(new h0)}return GZ(e,[{key:"extractFromVPMatrix",value:function(e){var t=nJ(e,16),n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],m=t[14],v=t[15];JJ(this.planes[0].normal,o-n,c-s,f-u),this.planes[0].distance=-(v-p),JJ(this.planes[1].normal,o+n,c+s,f+u),this.planes[1].distance=-(v+p),JJ(this.planes[2].normal,o+r,c+a,f+h),this.planes[2].distance=-(v+g),JJ(this.planes[3].normal,o-r,c-a,f-h),this.planes[3].distance=-(v-g),JJ(this.planes[4].normal,o-i,c-l,f-d),this.planes[4].distance=-(v-m),JJ(this.planes[5].normal,o+i,c+l,f+d),this.planes[5].distance=-(v+m),this.planes.forEach((function(e){e.normalize(),e.updatePNVertexFlag()}))}}]),e}();function A0(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function k0(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return M0(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M0(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function M0(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var T0,P0,D0,N0,R0,I0,j0,L0,F0,G0,B0,z0,U0,V0,H0,W0,$0,X0,Y0,q0,K0,Z0,J0,Q0,e2=(d0=f.injectable(),f0=f.inject(rJ.MeshComponentManager),p0=f.inject(rJ.CullableComponentManager),g0=f.inject(rJ.GeometryComponentManager),m0=f.inject(rJ.HierarchyComponentManager),v0=f.inject(rJ.TransformComponentManager),d0((S0=function(){function e(){LZ(this,e),IZ(this,"mesh",x0,this),IZ(this,"cullable",w0,this),IZ(this,"geometry",C0,this),IZ(this,"hierarchy",E0,this),IZ(this,"transform",_0,this),this.planes=void 0}var t;return GZ(e,[{key:"setFrustumPlanes",value:function(e){this.planes=e}},{key:"execute",value:(t=WZ(VZ.mark((function e(t){var n,r,i,o,s,a,l,c,u,h,d,f,p,g,m,v,y,b,x,w,C;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=k0(t);try{for(n.s();!(r=n.n()).done;){i=r.value,o=i.getScene(),s=i.getCamera(),a=k0(o.getEntities());try{for(a.s();!(l=a.n()).done;)c=l.value,(u=this.mesh.getComponentByEntity(c))&&(h=this.hierarchy.getComponentByEntity(c),d=this.cullable.getComponentByEntity(c),f=u.geometry,p=this.transform.getComponentByEntity(c),f&&f.aabb&&p&&u.aabbDirty&&(g=p.worldTransform,m=f.aabb,v=m.center,y=m.halfExtents,b=oQ(XJ(),v,g),x=A0(g,RJ()),w=sQ(XJ(),y,x),u.aabb.update(b,w),u.aabbDirty=!1),d&&f&&(C=this.cullable.getComponentByEntity((null==h?void 0:h.parentID)||-1),d.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(u.aabb,(null==C?void 0:C.visibilityPlaneMask)||c0.INDETERMINATE,this.planes||s.getFrustum().planes),d.visible=d.visibilityPlaneMask!==c0.OUTSIDE))}catch(e){a.e(e)}finally{a.f()}}}catch(e){n.e(e)}finally{n.f()}case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"tearDown",value:function(){this.cullable.clear(),this.mesh.clear()}},{key:"computeVisibilityWithPlaneMask",value:function(e,t,n){if(t===c0.OUTSIDE||t===c0.INSIDE)return t;for(var r=c0.INSIDE,i=0,o=n.length;i<o;++i){var s=i<31?1<<i:0;if(!(i<31&&0==(t&s))){var a=n[i],l=a.normal,c=a.distance;if(rQ(l,e.getNegativeFarPoint(n[i]))+c>0)return c0.OUTSIDE;rQ(l,e.getPositiveFarPoint(n[i]))+c>0&&(r|=s)}}return r}}]),e}(),x0=zZ((b0=S0).prototype,"mesh",[f0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w0=zZ(b0.prototype,"cullable",[p0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C0=zZ(b0.prototype,"geometry",[g0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E0=zZ(b0.prototype,"hierarchy",[m0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_0=zZ(b0.prototype,"transform",[v0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y0=b0))||y0);function t2(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return n2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return n2(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function n2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var r2,i2,o2,s2,a2,l2,c2,u2,h2,d2,f2,p2,g2,m2=(T0=f.injectable(),P0=f.inject(rJ.MeshComponentManager),D0=f.inject(rJ.GeometryComponentManager),N0=f.inject(rJ.MaterialComponentManager),R0=f.inject(rJ.CullableComponentManager),I0=f.inject(rJ.TransformComponentManager),j0=f.inject(rJ.HierarchyComponentManager),L0=f.inject(rJ.Systems),F0=f.named(rJ.FrameGraphSystem),G0=f.inject(rJ.RenderEngine),B0=f.inject(rJ.ResourcePool),T0((Q0=J0=function(){function e(){var t=this;LZ(this,e),IZ(this,"mesh",V0,this),IZ(this,"geometry",H0,this),IZ(this,"material",W0,this),IZ(this,"cullable",$0,this),IZ(this,"transform",X0,this),IZ(this,"hierarchy",Y0,this),IZ(this,"frameGraphSystem",q0,this),IZ(this,"engine",K0,this),IZ(this,"resourcePool",Z0,this),this.modelCache={},this.setup=function(e,t,n){var r=e.createRenderTarget(t,"color buffer",{width:1,height:1,usage:TQ.RENDER_ATTACHMENT|TQ.SAMPLED|TQ.COPY_SRC});n.data={output:t.write(e,r)}},this.execute=function(){var e=WZ(VZ.mark((function e(n,r,i){var o,s,a,l,c,u;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=n.getResourceNode(r.data.output),s=t.resourcePool.getOrCreateResource(o.resource),a=t2(i),e.prev=3,a.s();case 5:if((l=a.n()).done){e.next=11;break}return c=l.value,e.next=9,t.initView(c);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),a.e(e.t0);case 16:return e.prev=16,a.f(),e.finish(16);case 19:u=t.engine.getCanvas(),s.resize({width:u.width,height:u.height}),t.engine.setScissor({enable:!1}),t.engine.clear({framebuffer:s,color:i[0].getClearColor(),depth:1}),t.engine.useFramebuffer(s,(function(){var e,n=t2(i);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.renderView(r)}}catch(e){n.e(e)}finally{n.f()}}));case 24:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t,n,r){return e.apply(this,arguments)}}()}var t,n;return GZ(e,[{key:"renderView",value:function(e){var t=e.getScene(),n=e.getCamera(),r=n.getViewTransform(),i=GJ(IJ(),n.getPerspective(),r);n.getFrustum().extractFromVPMatrix(i);var o=e.getViewport(),s=o.x,a=o.y,l=o.width,c=o.height;this.engine.viewport({x:s,y:a,width:l,height:c});var u,h=t2(t.getEntities());try{for(h.s();!(u=h.n()).done;){var d=u.value;this.renderMesh(d,{camera:n,view:e,viewMatrix:r})}}catch(e){h.e(e)}finally{h.f()}}},{key:"renderMesh",value:function(e,t){var n=t.camera,r=t.view,i=t.viewMatrix,o=this.mesh.getComponentByEntity(e);if(o&&o.visible){var s=o.material,a=o.geometry;if(a&&!a.dirty&&s){var l=this.transform.getComponentByEntity(e),c=GJ(IJ(),i,l.worldTransform),u=r.getViewport(),h=u.width,d=u.height;s.setUniform({projectionMatrix:n.getPerspective(),modelViewMatrix:c,modelMatrix:l.worldTransform,viewMatrix:i,cameraPosition:n.getPosition(),u_viewport:[h,d]}),o.model&&(o.model.draw({uniforms:s.uniforms.reduce((function(e,t){return e[t.name]=t.data,e}),{})}),s.uniforms.forEach((function(e){e.dirty=!1})),s.dirty=!1)}}}},{key:"initMesh",value:(n=WZ(VZ.mark((function e(t,n){var r,i,o,s,a,l,c,u;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.mesh.getComponentByEntity(t)){e.next=3;break}return e.abrupt("return");case 3:if(i=r.material,(o=r.geometry)&&!o.dirty&&i){e.next=7;break}return e.abrupt("return");case 7:if(r.model){e.next=24;break}if(s="m-".concat(i.entity,"-g-").concat(o.entity),!this.modelCache[s]){e.next=12;break}return r.model=this.modelCache[s],e.abrupt("return");case 12:return i.setUniform({projectionMatrix:1,modelViewMatrix:1,modelMatrix:1,viewMatrix:1,cameraPosition:1,u_viewport:1}),a=this.engine,l=a.createModel,c=a.createAttribute,u={vs:i.vertexShaderGLSL,fs:i.fragmentShaderGLSL,defines:i.defines,attributes:o.attributes.reduce((function(e,t){return t.data&&t.buffer&&(e[t.name]=c({buffer:t.buffer,attributes:t.attributes,arrayStride:t.arrayStride,stepMode:t.stepMode,divisor:"vertex"===t.stepMode?0:1})),e}),{}),uniforms:i.uniforms.reduce((function(e,t){return e[t.name]=t.data,e}),{}),scissor:{enable:!0,box:function(){return n.getViewport()}}},i.cull&&(u.cull=i.cull),i.depth&&(u.depth=i.depth),i.blend&&(u.blend=i.blend),o.indicesBuffer&&(u.elements=o.indicesBuffer),o.maxInstancedCount&&(u.instances=o.maxInstancedCount,u.count=o.vertexCount||3),e.next=22,l(u);case 22:r.model=e.sent,this.modelCache[s]=r.model;case 24:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"initView",value:(t=WZ(VZ.mark((function e(t){var n,r,i,o;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.getScene(),r=t2(n.getEntities()),e.prev=2,r.s();case 4:if((i=r.n()).done){e.next=10;break}return o=i.value,e.next=8,this.initMesh(o,t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e){return t.apply(this,arguments)})}]),e}(),J0.IDENTIFIER="Render Pass",V0=zZ((U0=Q0).prototype,"mesh",[P0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H0=zZ(U0.prototype,"geometry",[D0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W0=zZ(U0.prototype,"material",[N0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$0=zZ(U0.prototype,"cullable",[R0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X0=zZ(U0.prototype,"transform",[I0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y0=zZ(U0.prototype,"hierarchy",[j0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q0=zZ(U0.prototype,"frameGraphSystem",[L0,F0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K0=zZ(U0.prototype,"engine",[G0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z0=zZ(U0.prototype,"resourcePool",[B0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z0=U0))||z0);function v2(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return y2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y2(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function y2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b2,x2,w2,C2,E2,_2,S2,O2,A2,k2,M2,T2,P2,D2,N2,R2,I2,j2,L2,F2,G2,B2,z2=1,U2=2,V2=(r2=f.injectable(),i2=f.inject(rJ.RenderEngine),o2=f.inject(rJ.ResourcePool),s2=f.inject(rJ.RenderPassFactory),a2=f.inject(rJ.MeshComponentManager),r2((g2=p2=function(){function e(){var t=this;LZ(this,e),IZ(this,"engine",u2,this),IZ(this,"resourcePool",h2,this),IZ(this,"renderPassFactory",d2,this),IZ(this,"mesh",f2,this),this.pickingFBO=void 0,this.views=void 0,this.highlightEnabled=!0,this.highlightColor=[255,0,0,255],this.alreadyInRendering=!1,this.setup=function(e,t,n){var r=e.createRenderTarget(t,"picking fbo",{width:1,height:1});n.data={output:t.write(e,r)},t.hasSideEffect=!0},this.execute=function(){var e=WZ(VZ.mark((function e(n,r,i){var o,s,a;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.views=i,!t.alreadyInRendering){e.next=3;break}return e.abrupt("return");case 3:o=v2(i);try{for(a=function(){var e=s.value,i=e.getViewport(),o=i.width,a=i.height;t.alreadyInRendering=!0;var l=n.getResourceNode(r.data.output);t.pickingFBO=t.resourcePool.getOrCreateResource(l.resource),t.pickingFBO.resize({width:o,height:a}),t.engine.useFramebuffer(t.pickingFBO,(function(){t.engine.clear({framebuffer:t.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var n,r=t.renderPassFactory(m2.IDENTIFIER),i=[],o=v2(e.getScene().getEntities());try{for(o.s();!(n=o.n()).done;){var s=n.value,a=t.mesh.getComponentByEntity(s);a.material.setUniform("u_PickingStage",z2),i.push(a)}}catch(e){o.e(e)}finally{o.f()}r.renderView(e),i.forEach((function(e){e.material.setUniform("u_PickingStage",U2)})),t.alreadyInRendering=!1}))},o.s();!(s=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),this.pick=function(e,n){var r,i,o=e.x,s=e.y,a=t.engine,l=a.readPixels,c=a.useFramebuffer,u=n.getViewport(),h=u.width,d=u.height,f=o*window.devicePixelRatio,p=s*window.devicePixelRatio;if(!(f>h||f<0||p>d||p<0))return c(t.pickingFBO,(function(){0===(r=l({x:Math.round(f),y:Math.round(d-(s+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(4),framebuffer:t.pickingFBO}))[0]&&0===r[1]&&0===r[2]||(i=function(e){var t=nJ(e,3);return t[0]+256*t[1]+65536*t[2]-1}(r),t.highlightEnabled&&t.highlightPickedFeature(r,n))})),i}}return GZ(e,[{key:"enableHighlight",value:function(e){this.highlightEnabled=e}},{key:"setHighlightColor",value:function(e){this.highlightColor=e}},{key:"highlightPickedFeature",value:function(e,t){if(e){var n,r=v2(t.getScene().getEntities());try{for(r.s();!(n=r.n()).done;){var i=n.value,o=this.mesh.getComponentByEntity(i).material;o.setUniform("u_PickingStage",U2),o.setUniform("u_PickingColor",[e[0],e[1],e[2]]),o.setUniform("u_HighlightColor",this.highlightColor)}}catch(e){r.e(e)}finally{r.f()}}}}]),e}(),p2.IDENTIFIER="PixelPicking Pass",u2=zZ((c2=g2).prototype,"engine",[i2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h2=zZ(c2.prototype,"resourcePool",[o2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d2=zZ(c2.prototype,"renderPassFactory",[s2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f2=zZ(c2.prototype,"mesh",[a2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l2=c2))||l2),H2=(b2=f.injectable(),x2=f.inject(rJ.RenderEngine),w2=f.inject(rJ.ResourcePool),b2((A2=O2=function e(){var t=this;LZ(this,e),IZ(this,"engine",_2,this),IZ(this,"resourcePool",S2,this),this.model=void 0,this.setup=function(e,t,n){var r=e.getPass(m2.IDENTIFIER);if(r){var i=e.createRenderTarget(t,"render to screen",{width:1,height:1});n.data={input:t.read(r.data.output),output:t.write(e,i)}}},this.execute=function(){var e=WZ(VZ.mark((function e(n,r){var i,o,s,a,l,c,u;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.engine,o=i.createModel,s=i.createAttribute,a=i.createBuffer,t.model){e.next=6;break}return e.next=4,o({vs:t.engine.supportWebGPU?"layout(location = 0) in vec2 a_Position;\nlayout(location = 0) out vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}":"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:t.engine.supportWebGPU?"layout(set = 0, binding = 0) uniform sampler u_TextureSampler;\nlayout(set = 0, binding = 1) uniform texture2D u_Texture;\n\nlayout(location = 0) in vec2 v_UV;\nlayout(location = 0) out vec4 outColor;\n\nvoid main() {\n  outColor = texture(sampler2D(u_Texture, u_TextureSampler), v_UV);\n}":"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}",attributes:{a_Position:s({buffer:a({data:[-4,-4,4,-4,0,4],type:TQ.FLOAT}),size:2,arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})},uniforms:{u_Texture:null},depth:{enable:!1},count:3,blend:{enable:!0}});case 4:l=e.sent,t.model=l;case 6:c=n.getResourceNode(r.data.input),u=t.resourcePool.getOrCreateResource(c.resource),t.engine.useFramebuffer(null,(function(){t.engine.clear({framebuffer:null,color:[0,0,0,0],depth:1,stencil:0}),t.model.draw({uniforms:{u_Texture:u}})}));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.tearDown=function(){t.model=void 0}},O2.IDENTIFIER="Copy Pass",_2=zZ((E2=A2).prototype,"engine",[x2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S2=zZ(E2.prototype,"resourcePool",[w2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C2=E2))||C2),W2=(k2=f.injectable(),M2=f.inject(rJ.Systems),T2=f.named(rJ.FrameGraphSystem),P2=f.inject(rJ.RenderPassFactory),D2=f.inject(rJ.ConfigService),N2=f.inject(rJ.ResourcePool),k2((B2=function(){function e(){LZ(this,e),IZ(this,"frameGraphSystem",j2,this),IZ(this,"renderPassFactory",L2,this),IZ(this,"configService",F2,this),IZ(this,"resourcePool",G2,this)}var t;return GZ(e,[{key:"execute",value:(t=WZ(VZ.mark((function e(t){var n,r,i,o,s,a,l,c;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.renderPassFactory(m2.IDENTIFIER),r=n.setup,i=n.execute,this.frameGraphSystem.addPass(m2.IDENTIFIER,r,i),o=this.renderPassFactory(H2.IDENTIFIER),s=o.setup,a=o.execute,l=o.tearDown,c=this.frameGraphSystem.addPass(H2.IDENTIFIER,s,a,l),this.frameGraphSystem.present(c.data.output);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"tearDown",value:function(){this.resourcePool.clean()}},{key:"pick",value:function(e,t){return this.renderPassFactory(V2.IDENTIFIER).pick(e,t)}}]),e}(),j2=zZ((I2=B2).prototype,"frameGraphSystem",[M2,T2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L2=zZ(I2.prototype,"renderPassFactory",[P2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F2=zZ(I2.prototype,"configService",[D2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G2=zZ(I2.prototype,"resourcePool",[N2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R2=I2))||R2);function $2(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var X2,Y2,q2,K2,Z2,J2,Q2,e1,t1,n1,r1=function(e){cJ(n,e);var t=$2(n);function n(e){var r;return LZ(this,n),(r=t.call(this,e)).parentID=void 0,Object.assign(pJ(r),e),r}return n}(YZ),i1=(X2=f.injectable(),Y2=f.inject(rJ.HierarchyComponentManager),q2=f.inject(rJ.TransformComponentManager),K2=f.inject(rJ.MeshComponentManager),X2((n1=function(){function e(){LZ(this,e),IZ(this,"hierarchy",Q2,this),IZ(this,"transform",e1,this),IZ(this,"mesh",t1,this)}var t;return GZ(e,[{key:"execute",value:(t=WZ(VZ.mark((function e(){return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.runTransformUpdateSystem(),this.runHierarchyUpdateSystem();case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"tearDown",value:function(){this.hierarchy.clear(),this.transform.clear()}},{key:"getHierarchyComponentManager",value:function(){return this.hierarchy}},{key:"getTransformComponentManager",value:function(){return this.transform}},{key:"runTransformUpdateSystem",value:function(){var e=this;this.transform.forEach((function(t,n){(n.isDirty()||n.isLocalDirty())&&(e.setMeshAABBDirty(e.mesh.getComponentByEntity(t)),n.updateTransform())}))}},{key:"runHierarchyUpdateSystem",value:function(){var e=this;this.hierarchy.forEach((function(t,n){var r=e.transform.getComponentByEntity(t),i=e.transform.getComponentByEntity(n.parentID);null!==r&&null!==i&&r.updateTransformWithParent(i)}))}},{key:"attach",value:function(e,t,n){this.hierarchy.contains(e)&&this.detach(e),this.hierarchy.create(e,{parentID:t});var r=this.mesh.getComponentByEntity(t);if(this.setMeshAABBDirty(r),r&&-1===r.children.indexOf(e)&&r.children.push(e),this.hierarchy.getCount()>1)for(var i=this.hierarchy.getCount()-1;i>0;--i)for(var o=this.hierarchy.getEntity(i),s=0;s<i;++s){if(this.hierarchy.getComponent(s).parentID===o){this.hierarchy.moveItem(i,s),++i;break}}this.hierarchy.getComponentByEntity(e);var a=this.transform.getComponentByEntity(t);null===a&&(a=this.transform.create(t));var l=this.transform.getComponentByEntity(e);null===l&&(l=this.transform.create(e),a=this.transform.getComponentByEntity(t)),l.parent=a,!n&&a&&(l.matrixTransform(FJ(IJ(),a.worldTransform)),l.updateTransform()),a&&l.updateTransformWithParent(a)}},{key:"detach",value:function(e){var t=this.hierarchy.getComponentByEntity(e);if(null!==t){var n=this.transform.getComponentByEntity(e);null!==n&&(n.parent=null,n.applyTransform()),this.hierarchy.removeKeepSorted(e);var r=this.mesh.getComponentByEntity(t.parentID);if(r){var i=r.children.indexOf(e);r.children.splice(i,1)}this.setMeshAABBDirty(r)}}},{key:"detachChildren",value:function(e){var t=this.mesh.getComponentByEntity(e);t&&(t.children=[]);for(var n=0;n<this.hierarchy.getCount();){var r;if((null===(r=this.hierarchy.getComponent(n))||void 0===r?void 0:r.parentID)===e){var i=this.hierarchy.getEntity(n);this.detach(i)}else++n}}},{key:"setMeshAABBDirty",value:function(e){e&&(e.aabbDirty=!0)}}]),e}(),Q2=zZ((J2=n1).prototype,"hierarchy",[Y2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e1=zZ(J2.prototype,"transform",[q2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t1=zZ(J2.prototype,"mesh",[K2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z2=J2))||Z2);function o1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var s1=function(e){cJ(n,e);var t=o1(n);function n(e){var r,i,o,s,a,l,c,u,h,d,f,p,g,m,v;return LZ(this,n),(r=t.call(this,e)).dirtyFlag=void 0,r.localDirtyFlag=void 0,r.parent=null,r.localPosition=KJ(0,0,0),r.localRotation=bQ(0,0,0,1),r.localScale=KJ(1,1,1),r.localTransform=IJ(),r.position=KJ(0,0,0),r.rotation=bQ(0,0,0,1),r.scaling=KJ(1,1,1),r.worldTransform=IJ(),r.matrixTransform=(i=IJ(),function(e){GJ(i,r.getLocalTransform(),e),UJ(r.localScale,i),zJ(r.localPosition,i),VJ(r.localRotation,i)}),r.rotateRollPitchYaw=(o=fQ(),s=fQ(),a=fQ(),function(e,t,n){r.setDirty(),yQ(o,e,0,0),yQ(s,0,t,0),yQ(a,0,0,n),gQ(r.localRotation,o,r.localRotation),gQ(r.localRotation,r.localRotation,s),gQ(r.localRotation,a,r.localRotation),CQ(r.localRotation,r.localRotation)}),r.lerp=(l=XJ(),c=fQ(),u=XJ(),h=XJ(),d=fQ(),f=XJ(),function(e,t,n){r.setDirty(),UJ(l,e.worldTransform),zJ(u,e.worldTransform),VJ(c,e.worldTransform),UJ(h,t.worldTransform),zJ(f,t.worldTransform),VJ(d,t.worldTransform),iQ(r.localScale,l,h,n),mQ(r.localRotation,c,d,n),iQ(r.localPosition,u,f,n)}),r.translate=(p=XJ(),function(e){return QJ(p,r.getPosition(),e),r.setPosition(p),r.setDirty(!0),pJ(r)}),r.translateLocal=function(e){return function(e,t,n){var r=n[0],i=n[1],o=n[2],s=n[3],a=t[0],l=t[1],c=t[2],u=i*c-o*l,h=o*a-r*c,d=r*l-i*a,f=i*d-o*h,p=o*u-r*d,g=r*h-i*u,m=2*s;u*=m,h*=m,d*=m,f*=2,p*=2,g*=2,e[0]=a+u+f,e[1]=l+h+p,e[2]=c+d+g}(e,e,r.localRotation),QJ(r.localPosition,r.localPosition,e),r.setLocalDirty(!0),pJ(r)},r.setPosition=(g=IJ(),function(e){return r.position=e,r.setLocalDirty(!0),null===r.parent?ZJ(r.localPosition,e):(jJ(g,r.parent.worldTransform),FJ(g,g),oQ(r.localPosition,e,g)),pJ(r)}),r.rotate=(m=fQ(),function(e){if(null===r.parent)gQ(r.localRotation,r.localRotation,e),CQ(r.localRotation,r.localRotation);else{var t=r.getRotation(),n=r.parent.getRotation();xQ(m,n),vQ(m,m),gQ(m,m,e),gQ(r.localRotation,e,t),CQ(r.localRotation,r.localRotation)}return r.setLocalDirty(),pJ(r)}),r.rotateLocal=function(e){return gQ(r.localRotation,r.localRotation,e),CQ(r.localRotation,r.localRotation),r.setLocalDirty(!0),pJ(r)},r.setRotation=(v=fQ(),function(e){return null===r.parent?xQ(r.localRotation,e):(xQ(v,r.parent.getRotation()),vQ(v,v),xQ(r.localRotation,v),wQ(r.localRotation,r.localRotation,e)),r.setLocalDirty(!0),pJ(r)}),r}return GZ(n,[{key:"setLocalPosition",value:function(e){ZJ(this.localPosition,e),this.setLocalDirty(!0)}},{key:"setLocalScale",value:function(e){ZJ(this.localScale,e),this.setLocalDirty(!0)}},{key:"setLocalRotation",value:function(e){return xQ(this.localRotation,e),this.setLocalDirty(!0),this}},{key:"isDirty",value:function(){return this.dirtyFlag}},{key:"setDirty",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?this.dirtyFlag|=n.DIRTY:this.dirtyFlag&=~n.DIRTY}},{key:"isLocalDirty",value:function(){return this.localDirtyFlag}},{key:"setLocalDirty",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?(this.localDirtyFlag|=n.DIRTY,this.setDirty(!0)):this.localDirtyFlag&=~n.DIRTY}},{key:"updateTransform",value:function(){this.isLocalDirty()&&this.getLocalTransform(),this.isDirty()&&null===this.parent&&(jJ(this.worldTransform,this.getLocalTransform()),this.setDirty(!1))}},{key:"updateTransformWithParent",value:function(e){GJ(this.worldTransform,e.worldTransform,this.getLocalTransform())}},{key:"applyTransform",value:function(){this.setDirty(),UJ(this.localScale,this.worldTransform),zJ(this.localPosition,this.worldTransform),VJ(this.localRotation,this.worldTransform)}},{key:"clearTransform",value:function(){this.setDirty(),this.localPosition=KJ(0,0,0),this.localRotation=bQ(0,0,0,1),this.localScale=KJ(1,1,1)}},{key:"scaleLocal",value:function(e){return this.setLocalDirty(),function(e,t,n){e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2]}(this.localScale,this.localScale,e),this}},{key:"getLocalPosition",value:function(){return this.localPosition}},{key:"getLocalRotation",value:function(){return this.localRotation}},{key:"getLocalScale",value:function(){return this.localScale}},{key:"getLocalTransform",value:function(){return this.localDirtyFlag&&(!function(e,t,n,r){var i=t[0],o=t[1],s=t[2],a=t[3],l=i+i,c=o+o,u=s+s,h=i*l,d=i*c,f=i*u,p=o*c,g=o*u,m=s*u,v=a*l,y=a*c,b=a*u,x=r[0],w=r[1],C=r[2];e[0]=(1-(p+m))*x,e[1]=(d+b)*x,e[2]=(f-y)*x,e[3]=0,e[4]=(d-b)*w,e[5]=(1-(h+m))*w,e[6]=(g+v)*w,e[7]=0,e[8]=(f+y)*C,e[9]=(g-v)*C,e[10]=(1-(h+p))*C,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1}(this.localTransform,this.localRotation,this.localPosition,this.localScale),this.setLocalDirty(!1)),this.localTransform}},{key:"getWorldTransform",value:function(){return this.isLocalDirty()||this.isDirty()?(this.parent&&this.parent.getWorldTransform(),this.updateTransform(),this.worldTransform):this.worldTransform}},{key:"getPosition",value:function(){return zJ(this.position,this.worldTransform),this.position}},{key:"getRotation",value:function(){return VJ(this.rotation,this.worldTransform),this.rotation}},{key:"getScale",value:function(){return UJ(this.scaling,this.worldTransform),this.scaling}}]),n}(YZ);s1.DIRTY=1;var a1={},l1={};Object.defineProperty(l1,"__esModule",{value:!0});var c1=Symbol.for("INJECTION");function u1(e,t,n,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){return r&&!Reflect.hasMetadata(c1,this,t)&&Reflect.defineMetadata(c1,n(),this,t),Reflect.hasMetadata(c1,this,t)?Reflect.getMetadata(c1,this,t):n()},set:function(e){Reflect.defineMetadata(c1,e,this,t)}})}l1.makePropertyInjectDecorator=function(e,t){return function(n){return function(r,i){u1(r,i,(function(){return e.get(n)}),t)}}},l1.makePropertyInjectNamedDecorator=function(e,t){return function(n,r){return function(i,o){u1(i,o,(function(){return e.getNamed(n,r)}),t)}}},l1.makePropertyInjectTaggedDecorator=function(e,t){return function(n,r,i){return function(o,s){u1(o,s,(function(){return e.getTagged(n,r,i)}),t)}}},l1.makePropertyMultiInjectDecorator=function(e,t){return function(n){return function(r,i){u1(r,i,(function(){return e.getAll(n)}),t)}}},Object.defineProperty(a1,"__esModule",{value:!0});var h1=l1;var d1,f1,p1,g1,m1,v1,y1=a1.default=function(e,t){return void 0===t&&(t=!0),{lazyInject:h1.makePropertyInjectDecorator(e,t),lazyInjectNamed:h1.makePropertyInjectNamedDecorator(e,t),lazyInjectTagged:h1.makePropertyInjectTaggedDecorator(e,t),lazyMultiInject:h1.makePropertyMultiInjectDecorator(e,t)}},b1=(d1=f.injectable(),f1=f.inject(rJ.RenderEngine),d1((v1=function(){function e(){LZ(this,e),IZ(this,"engine",m1,this),this.resourcePool={}}return GZ(e,[{key:"getOrCreateResource",value:function(e){if(!this.resourcePool[e.name]){var t=e.descriptor,n=t.width,r=t.height,i=t.usage;this.resourcePool[e.name]=this.engine.createFramebuffer({color:this.engine.createTexture2D({width:n,height:r,wrapS:TQ.CLAMP_TO_EDGE,wrapT:TQ.CLAMP_TO_EDGE,usage:i})})}return this.resourcePool[e.name]}},{key:"clean",value:function(){this.resourcePool={}}}]),e}(),m1=zZ((g1=v1).prototype,"engine",[f1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p1=g1))||p1);function x1(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var w1,C1,E1,_1,S1=function(e){cJ(n,e);var t=x1(n);function n(e){var r;return LZ(this,n),(r=t.call(this,e)).name=void 0,r.name=e.name||"",r}return n}(YZ),O1=f.injectable()((C1=function(){function e(){LZ(this,e),this.config=void 0}return GZ(e,[{key:"get",value:function(){return this.config}},{key:"set",value:function(e){this.config=e}}]),e}(),w1=C1))||w1;!function(e){e.PANSTART="PANSTART",e.PANEND="PANEND",e.PANMOVE="PANMOVE",e.PINCH="PINCH",e.KEYDOWN="KEYDOWN",e.KEYUP="KEYUP",e.HOVER="HOVER"}(_1||(_1={}));var A1=f.injectable()(E1=function(){function e(){LZ(this,e)}return GZ(e,[{key:"listen",value:function(e){}},{key:"on",value:function(e,t){}},{key:"connect",value:function(){}},{key:"disconnect",value:function(){}},{key:"destroy",value:function(){}}]),e}())||E1;var k1,M1,T1=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function P1(e){var t={};return e=e.replace(T1,(function(e,n,r){var i=r.split(":"),o=i[0].trim(),s="";switch(i.length>1&&(s=i[1].trim()),n){case"bool":s="true"===s;break;case"float":case"int":s=Number(s);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":s=s?s.replace("[","").replace("]","").split(",").reduce((function(e,t){return e.push(Number(t.trim())),e}),[]):new Array(function(e){var t=0;switch(e){case"vec2":case"ivec2":t=2;break;case"vec3":case"ivec3":t=3;break;case"vec4":case"ivec4":case"mat2":t=4;break;case"mat3":t=9;break;case"mat4":t=16}return t}(n)).fill(0)}return t[o]=s,"uniform ".concat(n," ").concat(o,";\n")})),{content:e,uniforms:t}}function D1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D1(Object(n),!0).forEach((function(t){PJ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D1(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R1=/precision\s+(high|low|medium)p\s+float/,I1=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,j1=f.injectable()((M1=function(){function e(){LZ(this,e),this.moduleCache={},this.rawContentCache={}}return GZ(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("picking",{vs:"attribute vec3 a_PickingColor;\nvarying vec4 v_PickingResult;\n\nuniform vec3 u_PickingColor : [0, 0, 0];\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\nuniform float u_PickingThreshold : 1.0;\nuniform float u_PickingBuffer: 0.0;\n\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&\n    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&\n    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;\n}\n\nvoid setPickingColor(vec3 pickingColor) {\n  // compares only in highlight stage\n  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));\n\n  // Stores the picking color so that the fragment shader can render it during picking\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\n\nfloat setPickingSize(float x) {\n   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;\n}",fs:"varying vec4 v_PickingResult;\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\n\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 filterHighlightColor(vec4 color) {\n  bool selected = bool(v_PickingResult.a);\n\n  if (selected) {\n    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));\n\n    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(resultRGB, color.a);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 filterPickingColor(vec4 color) {\n  vec3 pickingColor = v_PickingResult.rgb;\n  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 filterColor(vec4 color) {\n  return filterPickingColor(filterHighlightColor(color));\n}\n"}),this.registerModule("sdf2d",{vs:"",fs:"/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\nfloat sdEquilateralTriangle(vec2 p) {\n  float k = sqrt(3.0);\n  p.x = abs(p.x) - 1.0;\n  p.y = p.y + 1.0/k;\n  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;\n  p.x -= clamp( p.x, -2.0, 0.0 );\n  return -length(p)*sign(p.y);\n}\n\nfloat sdBox(vec2 p, vec2 b) {\n  vec2 d = abs(p)-b;\n  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);\n}\n\nfloat sdPentagon(vec2 p, float r) {\n  vec3 k = vec3(0.809016994,0.587785252,0.726542528);\n  p.x = abs(p.x);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagon(vec2 p, float r) {\n  vec3 k = vec3(-0.866025404,0.5,0.577350269);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdOctogon(vec2 p, float r) {\n  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );\n  p = abs(p);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagram(vec2 p, float r) {\n  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;\n  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdRhombus(vec2 p, vec2 b) {\n  vec2 q = abs(p);\n  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);\n  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );\n  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );\n}\n\nfloat sdVesica(vec2 p, float r, float d) {\n  p = abs(p);\n  float b = sqrt(r*r-d*d); // can delay this sqrt\n  return ((p.y-b)*d>p.x*b)\n          ? length(p-vec2(0.0,b))\n          : length(p-vec2(-d,0.0))-r;\n}"})}},{key:"registerModule",value:function(e,t){if(!this.rawContentCache[e]){var n=t.vs,r=void 0===n?"":n,i=t.fs,o=void 0===i?"":i,s=t.uniforms,a=P1(r),l=a.content,c=a.uniforms,u=P1(o),h=u.content,d=u.uniforms;this.rawContentCache[e]={fs:h,uniforms:N1(N1(N1({},c),d),s),vs:l}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(e){var t=this;if(this.moduleCache[e])return this.moduleCache[e];var n=this.rawContentCache[e].vs||"",r=this.rawContentCache[e].fs||"",i=this.processModule(n,[],"vs"),o=i.content,s=i.includeList,a=this.processModule(r,[],"fs"),l=a.content,c=a.includeList,u=l,h=function(e){return e.filter((function(e,t,n){return n.indexOf(e)===t}))}(s.concat(c).concat(e)).reduce((function(e,n){return N1(N1({},e),t.rawContentCache[n].uniforms)}),{});return R1.test(l)||(u="#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n #else\n precision mediump float;\n#endif\n"+l),this.moduleCache[e]={fs:u.trim(),uniforms:h,vs:o.trim()},this.moduleCache[e]}},{key:"processModule",value:function(e,t,n){var r=this;return{content:e.replace(I1,(function(e,i){var o=i.split(" ")[0].replace(/"/g,"");if(t.indexOf(o)>-1)return"";var s=r.rawContentCache[o][n];return t.push(o),r.processModule(s||"",t,n).content})),includeList:t}}}]),e}(),k1=M1))||k1,L1=new f.Container;function F1(){var e=new f.Container;return e.parent=L1,e.bind(rJ.Systems).to(i1).inSingletonScope().whenTargetNamed(rJ.SceneGraphSystem),e.bind(rJ.Systems).to(MJ).inSingletonScope().whenTargetNamed(rJ.FrameGraphSystem),e.bind(rJ.Systems).to(e2).inSingletonScope().whenTargetNamed(rJ.MeshSystem),e.bind(rJ.Systems).to(BQ).inSingletonScope().whenTargetNamed(rJ.GeometrySystem),e.bind(rJ.Systems).to(i0).inSingletonScope().whenTargetNamed(rJ.MaterialSystem),e.bind(rJ.Systems).to(W2).inSingletonScope().whenTargetNamed(rJ.RendererSystem),e.bind(rJ.ResourcePool).to(b1).inSingletonScope(),e.bind(rJ.ConfigService).to(O1).inSingletonScope(),e.bind(rJ.InteractorService).to(A1).inSingletonScope(),e.bind(rJ.RenderPass).to(m2).inSingletonScope().whenTargetNamed(m2.IDENTIFIER),e.bind(rJ.RenderPass).to(H2).inSingletonScope().whenTargetNamed(H2.IDENTIFIER),e.bind(rJ.RenderPass).to(V2).inSingletonScope().whenTargetNamed(V2.IDENTIFIER),e.bind(rJ.RenderPassFactory).toFactory((function(e){return function(t){return e.container.getNamed(rJ.RenderPass,t)}})),e}function G1(e){for(var t=new a0,n=KJ(e[0],e[1],e[2]),r=KJ(e[0],e[1],e[2]),i=3;i<e.length;){var o=e[i++],s=e[i++],a=e[i++];o<n[0]&&(n[0]=o),s<n[1]&&(n[1]=s),a<n[2]&&(n[2]=a),o>r[0]&&(r[0]=o),s>r[1]&&(r[1]=s),a>r[2]&&(r[2]=a)}return t.setMinMax(n,r),t}y1(L1,!1),L1.bind(rJ.ShaderModuleService).to(j1).inSingletonScope(),L1.bind(rJ.NameComponentManager).toConstantValue(new qZ(S1)),L1.bind(rJ.HierarchyComponentManager).toConstantValue(new qZ(r1)),L1.bind(rJ.TransformComponentManager).toConstantValue(new qZ(s1)),L1.bind(rJ.MeshComponentManager).toConstantValue(new qZ(u0)),L1.bind(rJ.CullableComponentManager).toConstantValue(new qZ(s0)),L1.bind(rJ.GeometryComponentManager).toConstantValue(new qZ(GQ)),L1.bind(rJ.MaterialComponentManager).toConstantValue(new qZ(e0));var B1,z1,U1,V1,H1,W1="undefined"!=typeof navigator&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent);XJ(),XJ(),XJ(),XJ(),XJ(),XJ(),function(e){e.Normal="normal",e.PostProcessing="post-processing"}(B1||(B1={})),function(e){e.Void="Void",e.Boolean="Boolean",e.Float="Float",e.Uint32="Uint32",e.Int32="Int32",e.Vector="Vector",e.Vector2Float="vec2<f32>",e.Vector3Float="vec3<f32>",e.Vector4Float="vec4<f32>",e.Vector2Boolean="vec2<bool>",e.Vector3Boolean="vec3<bool>",e.Vector4Boolean="vec4<bool>",e.Vector2Uint="vec2<u32>",e.Vector3Uint="vec3<u32>",e.Vector4Uint="vec4<u32>",e.Vector2Int="vec2<i32>",e.Vector3Int="vec3<i32>",e.Vector4Int="vec4<i32>",e.Matrix="Matrix",e.Matrix3x3Float="mat3x3<f32>",e.Matrix4x4Float="mat4x4<i32>",e.Struct="Struct",e.FloatArray="Float[]",e.Vector4FloatArray="vec4<f32>[]"}(z1||(z1={})),function(e){e.Program="Program",e.Identifier="Identifier",e.VariableDeclaration="VariableDeclaration",e.BlockStatement="BlockStatement",e.ReturnStatement="ReturnStatement",e.FunctionDeclaration="FunctionDeclaration",e.VariableDeclarator="VariableDeclarator",e.AssignmentExpression="AssignmentExpression",e.LogicalExpression="LogicalExpression",e.BinaryExpression="BinaryExpression",e.ArrayExpression="ArrayExpression",e.UnaryExpression="UnaryExpression",e.UpdateExpression="UpdateExpression",e.FunctionExpression="FunctionExpression",e.MemberExpression="MemberExpression",e.ConditionalExpression="ConditionalExpression",e.ExpressionStatement="ExpressionStatement",e.CallExpression="CallExpression",e.NumThreadStatement="NumThreadStatement",e.StorageStatement="StorageStatement",e.DoWhileStatement="DoWhileStatement",e.WhileStatement="WhileStatement",e.ForStatement="ForStatement",e.BreakStatement="BreakStatement",e.ContinueStatement="ContinueStatement",e.IfStatement="IfStatement",e.ImportedFunctionStatement="ImportedFunctionStatement"}(U1||(U1={})),function(e){e.Input="Input",e.Output="Output",e.Uniform="Uniform",e.Workgroup="Workgroup",e.UniformConstant="UniformConstant",e.Image="Image",e.StorageBuffer="StorageBuffer",e.Private="Private",e.Function="Function"}(V1||(V1={})),function(e){e.GLSL100="GLSL100",e.GLSL450="GLSL450",e.WGSL="WGSL"}(H1||(H1={}));function $1(e){return"number"==typeof e}function X1(e){return void 0===e?0:e>360||e<-360?e%360:e}function Y1(e,t,n){return $1(e)?KJ(e,t,n):3===e.length?YJ(e):KJ(e[0],e[1],e[2])}var q1,K1,Z1,J1,Q1,e3,t3,n3,r3,i3,o3=function(){function e(t,n){LZ(this,e),this.name=void 0,this.matrix=void 0,this.right=void 0,this.up=void 0,this.forward=void 0,this.position=void 0,this.focalPoint=void 0,this.distanceVector=void 0,this.distance=void 0,this.dollyingStep=void 0,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.name=t,this.matrix=function(e){var t=new NJ(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}(n.matrix),this.right=YJ(n.right),this.up=YJ(n.up),this.forward=YJ(n.forward),this.position=YJ(n.position),this.focalPoint=YJ(n.focalPoint),this.distanceVector=YJ(n.distanceVector),this.azimuth=n.azimuth,this.elevation=n.elevation,this.roll=n.roll,this.relAzimuth=n.relAzimuth,this.relElevation=n.relElevation,this.relRoll=n.relRoll,this.dollyingStep=n.dollyingStep,this.distance=n.distance}return GZ(e,[{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getRoll",value:function(){return this.roll}},{key:"retrieve",value:function(e){e.matrix=jJ(e.matrix,this.matrix),e.right=ZJ(e.right,this.right),e.up=ZJ(e.up,this.up),e.forward=ZJ(e.forward,this.forward),e.position=ZJ(e.position,this.position),e.focalPoint=ZJ(e.focalPoint,this.focalPoint),e.distanceVector=ZJ(e.distanceVector,this.distanceVector),e.azimuth=this.azimuth,e.elevation=this.elevation,e.roll=this.roll,e.relAzimuth=this.relAzimuth,e.relElevation=this.relElevation,e.relRoll=this.relRoll,e.dollyingStep=this.dollyingStep,e.distance=this.distance}}]),e}();!function(e){e.ORBITING="ORBITING",e.EXPLORING="EXPLORING",e.TRACKING="TRACKING"}(n3||(n3={})),function(e){e.DEFAULT="DEFAULT",e.ROTATIONAL="ROTATIONAL",e.TRANSLATIONAL="TRANSLATIONAL",e.CINEMATIC="CINEMATIC"}(r3||(r3={})),function(e){e.ORTHOGRAPHIC="ORTHOGRAPHIC",e.PERSPECTIVE="PERSPECTIVE"}(i3||(i3={}));var s3,a3,l3,c3,u3,h3,d3,f3=Math.PI/180,p3=180/Math.PI,g3=(q1=f.injectable(),K1=f.inject(rJ.InteractorService),q1((t3=e3=function(){function e(){LZ(this,e),this.matrix=IJ(),this.right=KJ(1,0,0),this.up=KJ(0,1,0),this.forward=KJ(0,0,1),this.position=KJ(0,0,1),this.focalPoint=KJ(0,0,0),this.distanceVector=KJ(0,0,0),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.rotateWorld=!1,IZ(this,"interactor",Q1,this),this.fov=30,this.near=.1,this.far=1e4,this.aspect=1,this.left=void 0,this.rright=void 0,this.top=void 0,this.bottom=void 0,this.zoom=1,this.perspective=IJ(),this.view=void 0,this.following=void 0,this.type=n3.EXPLORING,this.trackingMode=r3.DEFAULT,this.projectionMode=i3.PERSPECTIVE,this.frustum=new O0,this.landmarks=[],this.landmarkAnimationID=void 0}return GZ(e,[{key:"clone",value:function(){var t=new e;return t.setType(this.type,void 0),t.interactor=this.interactor,t}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.perspective}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"setType",value:function(e,t){return this.type=e,this.type===n3.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===n3.TRACKING&&void 0!==t&&this.setTrackingMode(t),this}},{key:"setProjectionMode",value:function(e){return this.projectionMode=e,this}},{key:"setTrackingMode",value:function(e){if(this.type!==n3.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this}},{key:"setWorldRotation",value:function(e){this.rotateWorld=e,this._getAngles()}},{key:"getViewTransform",value:function(){return FJ(IJ(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"setMatrix",value:function(e){return this.matrix=e,this._update(),this}},{key:"setAspect",value:function(e){return this.setPerspective(this.near,this.far,this.fov,e),this}},{key:"setViewOffset",value:function(e,t,n,r,i,o){return this.aspect=e/t,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.projectionMode===i3.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===i3.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setPerspective",value:function(e,t,n,r){return this.projectionMode=i3.PERSPECTIVE,this.fov=n,this.near=e,this.far=t,this.aspect=r,WJ(this.perspective,this.fov*f3,this.aspect,this.near,this.far),this}},{key:"setOrthographic",value:function(e,t,n,r,i,o){this.projectionMode=i3.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=n,this.bottom=r,this.near=i,this.far=o;var s=(this.rright-this.left)/(2*this.zoom),a=(this.top-this.bottom)/(2*this.zoom),l=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,u=l-s,h=l+s,d=c+a,f=c-a;if(void 0!==this.view&&this.view.enabled){var p=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h=(u+=p*this.view.offsetX)+p*this.view.width,f=(d-=g*this.view.offsetY)-g*this.view.height}return $J(this.perspective,u,h,d,f,i,o),this}},{key:"setPosition",value:function(e,t,n){return this._setPosition(e,t,n),this.setFocalPoint(this.focalPoint),this}},{key:"setFocalPoint",value:function(e,t,n){var r=KJ(0,1,0);if(this.focalPoint=Y1(e,t,n),this.trackingMode===r3.CINEMATIC){var i=eQ(XJ(),this.focalPoint,this.position);e=i[0],t=i[1],n=i[2];var o=qJ(i),s=Math.asin(t/o)*p3,a=90+Math.atan2(n,e)*p3,l=IJ();!function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],s=t[1],a=t[2],l=t[3],c=t[8],u=t[9],h=t[10],d=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*r,e[1]=s*i-u*r,e[2]=a*i-h*r,e[3]=l*i-d*r,e[8]=o*r+c*i,e[9]=s*r+u*i,e[10]=a*r+h*i,e[11]=l*r+d*i}(l,l,a*f3),function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=s*i+u*r,e[6]=a*i+h*r,e[7]=l*i+d*r,e[8]=c*i-o*r,e[9]=u*i-s*r,e[10]=h*i-a*r,e[11]=d*i-l*r}(l,l,s*f3),r=oQ(XJ(),[0,1,0],l)}return FJ(this.matrix,function(e,t,n,r){var i,o,s,a,l,c,u,h,d,f,p=t[0],g=t[1],m=t[2],v=r[0],y=r[1],b=r[2],x=n[0],w=n[1],C=n[2];return Math.abs(p-x)<DJ&&Math.abs(g-w)<DJ&&Math.abs(m-C)<DJ?LJ(e):(u=p-x,h=g-w,d=m-C,i=y*(d*=f=1/Math.hypot(u,h,d))-b*(h*=f),o=b*(u*=f)-v*d,s=v*h-y*u,(f=Math.hypot(i,o,s))?(i*=f=1/f,o*=f,s*=f):(i=0,o=0,s=0),a=h*s-d*o,l=d*i-u*s,c=u*o-h*i,(f=Math.hypot(a,l,c))?(a*=f=1/f,l*=f,c*=f):(a=0,l=0,c=0),e[0]=i,e[1]=a,e[2]=u,e[3]=0,e[4]=o,e[5]=l,e[6]=h,e[7]=0,e[8]=s,e[9]=c,e[10]=d,e[11]=0,e[12]=-(i*p+o*g+s*m),e[13]=-(a*p+l*g+c*m),e[14]=-(u*p+h*g+d*m),e[15]=1,e)}(IJ(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this}},{key:"setDistance",value:function(e){if(!(this.distance===e||e<0)){this.distance=e,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var t=XJ();e=this.distance;var n=this.forward,r=this.focalPoint;return t[0]=e*n[0]+r[0],t[1]=e*n[1]+r[1],t[2]=e*n[2]+r[2],this._setPosition(t),this}}},{key:"setMaxDistance",value:function(e){return this.maxDistance=e,this}},{key:"setMinDistance",value:function(e){return this.minDistance=e,this}},{key:"changeAzimuth",value:function(e){return this.setAzimuth(this.azimuth+e),this}},{key:"changeElevation",value:function(e){return this.setElevation(this.elevation+e),this}},{key:"changeRoll",value:function(e){return this.setRoll(this.roll+e),this}},{key:"setAzimuth",value:function(e){return this.azimuth=X1(e),this.computeMatrix(),this._getAxes(),this.type===n3.ORBITING||this.type===n3.EXPLORING?this._getPosition():this.type===n3.TRACKING&&this._getFocalPoint(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(e){return this.elevation=X1(e),this.computeMatrix(),this._getAxes(),this.type===n3.ORBITING||this.type===n3.EXPLORING?this._getPosition():this.type===n3.TRACKING&&this._getFocalPoint(),this}},{key:"setRoll",value:function(e){return this.roll=X1(e),this.computeMatrix(),this._getAxes(),this.type===n3.ORBITING||this.type===n3.EXPLORING?this._getPosition():this.type===n3.TRACKING&&this._getFocalPoint(),this}},{key:"rotate",value:function(e,t,n){if(this.type===n3.EXPLORING){e=X1(e),t=X1(t),n=X1(n);var r=pQ(fQ(),[1,0,0],(this.rotateWorld?1:-1)*t*f3),i=pQ(fQ(),[0,1,0],(this.rotateWorld?1:-1)*e*f3),o=pQ(fQ(),[0,0,1],n*f3),s=gQ(fQ(),i,r);s=gQ(fQ(),s,o);var a=HJ(IJ(),s);BJ(this.matrix,this.matrix,[0,0,-this.distance]),GJ(this.matrix,this.matrix,a),BJ(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation+t)>90)return;this.relElevation=X1(t),this.relAzimuth=X1(e),this.relRoll=X1(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.computeMatrix()}return this._getAxes(),this.type===n3.ORBITING||this.type===n3.EXPLORING?this._getPosition():this.type===n3.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(e,t){var n=Y1(e,t,0),r=YJ(this.position);return QJ(r,r,tQ(XJ(),this.right,n[0])),QJ(r,r,tQ(XJ(),this.up,n[1])),this._setPosition(r),this}},{key:"dolly",value:function(e){var t=this.forward,n=YJ(this.position),r=this.dollyingStep,i=this.distance+e*this.dollyingStep;return r=Math.max(Math.min(i,this.maxDistance),this.minDistance)-this.distance,n[0]+=r*t[0],n[1]+=r*t[1],n[2]+=r*t[2],this._setPosition(n),this.type===n3.ORBITING||this.type===n3.EXPLORING?this._getDistance():this.type===n3.TRACKING&&QJ(this.focalPoint,n,this.distanceVector),this}},{key:"createLandmark",value:function(e,t){var n=this.clone();n.setPosition(t.position),n.setFocalPoint(t.focalPoint),void 0!==t.roll&&n.setRoll(t.roll);var r=new o3(e,n);return this.landmarks.push(r),r}},{key:"setLandmark",value:function(e){var t=new o3(e,this);return this.landmarks.push(t),this}},{key:"gotoLandmark",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,r=this.landmarks.find((function(t){return t.name===e}));if(r){if(0===n)return void r.retrieve(this);void 0!==this.landmarkAnimationID&&window.cancelAnimationFrame(this.landmarkAnimationID),this.interactor.disconnect();var i,o=r.getPosition(),s=r.getFocalPoint(),a=r.getRoll(),l=function e(r){void 0===i&&(i=r);var l,c=r-i,u=(1-Math.cos(c/n*Math.PI))/2,h=XJ(),d=XJ();if(iQ(h,t.focalPoint,s,u),iQ(d,t.position,o,u),l=t.roll*(1-u)+a*u,t.setFocalPoint(h),t.setPosition(d),t.setRoll(l),t.computeMatrix(),!(lQ(h,s)+lQ(d,o)>.01))return t.setFocalPoint(h),t.setPosition(d),t.setRoll(l),t.computeMatrix(),void t.interactor.connect();c<n&&(t.landmarkAnimationID=window.requestAnimationFrame(e))};window.requestAnimationFrame(l)}}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles()}},{key:"computeMatrix",value:function(){var e,t,n=pQ(fQ(),[0,0,1],this.roll*f3);LJ(this.matrix),e=pQ(fQ(),[1,0,0],(this.rotateWorld&&this.type!==n3.TRACKING||this.type===n3.TRACKING?1:-1)*this.elevation*f3),t=pQ(fQ(),[0,1,0],(this.rotateWorld&&this.type!==n3.TRACKING||this.type===n3.TRACKING?1:-1)*this.azimuth*f3);var r=gQ(fQ(),t,e);r=gQ(fQ(),r,n);var i=HJ(IJ(),r);this.type===n3.ORBITING||this.type===n3.EXPLORING?(BJ(this.matrix,this.matrix,this.focalPoint),GJ(this.matrix,this.matrix,i),BJ(this.matrix,this.matrix,[0,0,this.distance])):this.type===n3.TRACKING&&(BJ(this.matrix,this.matrix,this.position),GJ(this.matrix,this.matrix,i))}},{key:"_setPosition",value:function(e,t,n){this.position=Y1(e,t,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1}},{key:"_getAxes",value:function(){ZJ(this.right,Y1(dQ(uQ(),[1,0,0,0],this.matrix))),ZJ(this.up,Y1(dQ(uQ(),[0,1,0,0],this.matrix))),ZJ(this.forward,Y1(dQ(uQ(),[0,0,1,0],this.matrix))),nQ(this.right,this.right),nQ(this.up,this.up),nQ(this.forward,this.forward)}},{key:"_getAngles",value:function(){var e=this.distanceVector[0],t=this.distanceVector[1],n=this.distanceVector[2],r=qJ(this.distanceVector);if(0===r)return this.elevation=0,void(this.azimuth=0);this.type===n3.TRACKING||this.rotateWorld?(this.elevation=Math.asin(t/r)*p3,this.azimuth=Math.atan2(-e,-n)*p3):(this.elevation=-Math.asin(t/r)*p3,this.azimuth=-Math.atan2(-e,-n)*p3)}},{key:"_getPosition",value:function(){ZJ(this.position,Y1(dQ(uQ(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){sQ(this.distanceVector,[0,0,-this.distance],function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}(RJ(),this.matrix)),QJ(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=eQ(XJ(),this.focalPoint,this.position),this.distance=qJ(this.distanceVector),this.dollyingStep=this.distance/100}}]),e}(),e3.ProjectionMode={ORTHOGRAPHIC:"ORTHOGRAPHIC",PERSPECTIVE:"PERSPECTIVE"},Q1=zZ((J1=t3).prototype,"interactor",[K1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z1=J1))||Z1),m3=(s3=f.injectable(),a3=f.inject(rJ.GeometryComponentManager),s3((d3=h3=function(){function e(){LZ(this,e),this.config=void 0,IZ(this,"geometry",u3,this),this.entity=void 0,this.component=void 0}return GZ(e,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(e){this.config=e}},{key:"setEntity",value:function(e){this.entity=e,this.component=this.geometry.create(e),this.component.entity=e,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),e}(),h3.BOX="box",h3.SPHERE="sphere",h3.PLANE="plane",h3.MERGED="merged",u3=zZ((c3=d3).prototype,"geometry",[a3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l3=c3))||l3),v3={};function y3(){if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}!function(e){var t,n,r,i,o,s,a,l,c,u,h,d,f,p,g,m,v,y,b,x,w,C,E,_,S;Object.defineProperty(e,"__esModule",{value:!0}),(e.ExtensionName||(e.ExtensionName={})).TextureCompressionBC="texture-compression-bc",(t=e.AddressMode||(e.AddressMode={})).ClampToEdge="clamp-to-edge",t.Repeat="repeat",t.MirrorRepeat="mirror-repeat",(n=e.BindingType||(e.BindingType={})).UniformBuffer="uniform-buffer",n.StorageBuffer="storage-buffer",n.ReadonlyStorageBuffer="readonly-storage-buffer",n.Sampler="sampler",n.ComparisonSampler="comparison-sampler",n.SampledTexture="sampled-texture",n.ReadonlyStorageTexture="readonly-storage-texture",n.WriteonlyStorageTexture="writeonly-storage-texture",(r=e.BlendFactor||(e.BlendFactor={})).Zero="zero",r.One="one",r.SrcColor="src-color",r.OneMinusSrcColor="one-minus-src-color",r.SrcAlpha="src-alpha",r.OneMinusSrcAlpha="one-minus-src-alpha",r.DstColor="dst-color",r.OneMinusDstColor="one-minus-dst-color",r.DstAlpha="dst-alpha",r.OneMinusDstAlpha="one-minus-dst-alpha",r.SrcAlphaSaturated="src-alpha-saturated",r.BlendColor="blend-color",r.OneMinusBlendColor="one-minus-blend-color",(i=e.BlendOperation||(e.BlendOperation={})).Add="add",i.Subtract="subtract",i.ReverseSubtract="reverse-subtract",i.Min="min",i.Max="max",(o=e.CompareFunction||(e.CompareFunction={})).Never="never",o.Less="less",o.Equal="equal",o.LessEqual="less-equal",o.Greater="greater",o.NotEqual="not-equal",o.GreaterEqual="greater-equal",o.Always="always",(s=e.CullMode||(e.CullMode={})).None="none",s.Front="front",s.Back="back",(a=e.FilterMode||(e.FilterMode={})).Nearest="nearest",a.Linear="linear",(l=e.FrontFace||(e.FrontFace={})).CCW="ccw",l.CW="cw",(c=e.IndexFormat||(e.IndexFormat={})).Uint16="uint16",c.Uint32="uint32",(u=e.InputStepMode||(e.InputStepMode={})).Vertex="vertex",u.Instance="instance",(e.LoadOp||(e.LoadOp={})).Load="load",(h=e.PrimitiveTopology||(e.PrimitiveTopology={})).PointList="point-list",h.LineList="line-list",h.LineStrip="line-strip",h.TriangleList="triangle-list",h.TriangleStrip="triangle-strip",(d=e.StencilOperation||(e.StencilOperation={})).Keep="keep",d.Zero="zero",d.Replace="replace",d.Invert="invert",d.IncrementClamp="increment-clamp",d.DecrementClamp="decrement-clamp",d.IncrementWrap="increment-wrap",d.DecrementWrap="decrement-wrap",(f=e.StoreOp||(e.StoreOp={})).Store="store",f.Clear="clear",(p=e.TextureDimension||(e.TextureDimension={})).E1d="1d",p.E2d="2d",p.E3d="3d",(g=e.TextureFormat||(e.TextureFormat={})).R8Unorm="r8unorm",g.R8Snorm="r8snorm",g.R8Uint="r8uint",g.R8Sint="r8sint",g.R16Uint="r16uint",g.R16Sint="r16sint",g.R16Float="r16float",g.RG8Unorm="rg8unorm",g.RG8Snorm="rg8snorm",g.RG8Uint="rg8uint",g.RG8Sint="rg8sint",g.R32Uint="r32uint",g.R32Sint="r32sint",g.R32Float="r32float",g.RG16Uint="rg16uint",g.RG16Sint="rg16sint",g.RG16Float="rg16float",g.RGBA8Unorm="rgba8unorm",g.RGBA8UnormSRGB="rgba8unorm-srgb",g.RGBA8Snorm="rgba8snorm",g.RGBA8Uint="rgba8uint",g.RGBA8Sint="rgba8sint",g.BGRA8Unorm="bgra8unorm",g.BGRA8UnormSRGB="bgra8unorm-srgb",g.RGB10A2Unorm="rgb10a2unorm",g.RG11B10Float="rg11b10float",g.RG32Uint="rg32uint",g.RG32Sint="rg32sint",g.RG32Float="rg32float",g.RGBA16Uint="rgba16uint",g.RGBA16Sint="rgba16sint",g.RGBA16Float="rgba16float",g.RGBA32Uint="rgba32uint",g.RGBA32Sint="rgba32sint",g.RGBA32Float="rgba32float",g.Depth32Float="depth32float",g.Depth24Plus="depth24plus",g.Depth24PlusStencil8="depth24plus-stencil8",(m=e.TextureComponentType||(e.TextureComponentType={})).Float="float",m.Sint="sint",m.Uint="uint",(v=e.TextureViewDimension||(e.TextureViewDimension={})).E1d="1d",v.E2d="2d",v.E2dArray="2d-array",v.Cube="cube",v.CubeArray="cube-array",v.E3d="3d",(y=e.VertexFormat||(e.VertexFormat={})).Uchar2="uchar2",y.Uchar4="uchar4",y.Char2="char2",y.Char4="char4",y.Uchar2Norm="uchar2norm",y.Uchar4Norm="uchar4norm",y.Char2Norm="char2norm",y.Char4Norm="char4norm",y.Ushort2="ushort2",y.Ushort4="ushort4",y.Short2="short2",y.Short4="short4",y.Ushort2Norm="ushort2norm",y.Ushort4Norm="ushort4norm",y.Short2Norm="short2norm",y.Short4Norm="short4norm",y.Half2="half2",y.Half4="half4",y.Float="float",y.Float2="float2",y.Float3="float3",y.Float4="float4",y.Uint="uint",y.Uint2="uint2",y.Uint3="uint3",y.Uint4="uint4",y.Int="int",y.Int2="int2",y.Int3="int3",y.Int4="int4",(b=e.TextureAspect||(e.TextureAspect={})).All="all",b.StencilOnly="stencil-only",b.DepthOnly="depth-only",(x=e.CompilationMessageType||(e.CompilationMessageType={})).Error="error",x.Warning="warning",x.Info="info",(e.QueryType||(e.QueryType={})).Occlusion="occlusion",(w=e.BufferUsage||(e.BufferUsage={}))[w.MapRead=1]="MapRead",w[w.MapWrite=2]="MapWrite",w[w.CopySrc=4]="CopySrc",w[w.CopyDst=8]="CopyDst",w[w.Index=16]="Index",w[w.Vertex=32]="Vertex",w[w.Uniform=64]="Uniform",w[w.Storage=128]="Storage",w[w.Indirect=256]="Indirect",w[w.QueryResolve=512]="QueryResolve",(C=e.ColorWrite||(e.ColorWrite={}))[C.Red=1]="Red",C[C.Green=2]="Green",C[C.Blue=4]="Blue",C[C.Alpha=8]="Alpha",C[C.All=15]="All",(E=e.ShaderStage||(e.ShaderStage={}))[E.Vertex=1]="Vertex",E[E.Fragment=2]="Fragment",E[E.Compute=4]="Compute",(_=e.TextureUsage||(e.TextureUsage={}))[_.CopySrc=1]="CopySrc",_[_.CopyDst=2]="CopyDst",_[_.Sampled=4]="Sampled",_[_.Storage=8]="Storage",_[_.OutputAttachment=16]="OutputAttachment",(S=e.MapMode||(e.MapMode={}))[S.Read=1]="Read",S[S.Write=2]="Write"}(v3);var b3={}.toString,x3=function(e){return Array.isArray?Array.isArray(e):function(e,t){return b3.call(e)==="[object "+t+"]"}(e,"Array")},w3=9007199254740991,C3={};C3["[object Float32Array]"]=C3["[object Float64Array]"]=C3["[object Int8Array]"]=C3["[object Int16Array]"]=C3["[object Int32Array]"]=C3["[object Uint8Array]"]=C3["[object Uint8ClampedArray]"]=C3["[object Uint16Array]"]=C3["[object Uint32Array]"]=!0,C3["[object Arguments]"]=C3["[object Array]"]=C3["[object ArrayBuffer]"]=C3["[object Boolean]"]=C3["[object DataView]"]=C3["[object Date]"]=C3["[object Error]"]=C3["[object Function]"]=C3["[object Map]"]=C3["[object Number]"]=C3["[object Object]"]=C3["[object RegExp]"]=C3["[object Set]"]=C3["[object String]"]=C3["[object WeakMap]"]=!1;var E3=Object.prototype.toString;var _3,S3,O3,A3,k3,M3,T3,P3,D3=function(e){return function(e){return!!e&&"object"===dJ(e)}(e)&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=w3}(e.length)&&!!C3[E3.call(e)]};function N3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R3(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N3(Object(n),!0).forEach((function(t){PJ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N3(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I3,j3,L3,F3,G3,B3,z3,U3,V3,H3,W3,$3,X3,Y3,q3,K3,Z3,J3,Q3,e4,t4,n4=(_3=f.injectable(),S3=f.inject(rJ.RenderEngine),O3=f.inject(rJ.ConfigService),_3((P3=function(){function e(){LZ(this,e),IZ(this,"engine",M3,this),IZ(this,"configService",T3,this),this.entity=XZ(),this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}var t,n,r;return GZ(e,[{key:"init",value:function(){var e=this.configService.get(),t=e.canvas,n=e.engineOptions;this.initPromise=this.engine.init(R3({canvas:t||y3(),swapChainFormat:v3.TextureFormat.BGRA8Unorm,antialiasing:!1},n))}},{key:"setBundle",value:function(e){this.compiledBundle=JSON.parse(JSON.stringify(e))}},{key:"setDispatch",value:function(e){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=e),this}},{key:"setMaxIteration",value:function(e){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=e),this}},{key:"setBinding",value:function(e,t){var n=this;if("string"==typeof e){var r=$1(t)||D3(t)||x3(t);if(this.compiledBundle&&this.compiledBundle.context){var i=this.compiledBundle.context.defines.find((function(t){return t.name===e}));if(i)return i.value=t,this;var o=this.compiledBundle.context.uniforms.find((function(t){return t.name===e}));o&&(r?(o.data=t,o.isReferer=!1,o.storageClass===V1.Uniform?this.model&&this.model.updateUniform(e,t):this.model&&this.model.updateBuffer(e,t)):(o.isReferer=!0,o.data=t))}}else Object.keys(e).forEach((function(t){n.setBinding(t,e[t])}));return this}},{key:"execute",value:(r=WZ(VZ.mark((function e(){var t,n,r=this,i=arguments;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:1,!this.dirty){e.next=6;break}return this.compiledBundle.context&&(t>1?this.compiledBundle.context.maxIteration=t:this.compiledBundle.context.maxIteration++),e.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter((function(e){return e.isReferer})).forEach((function(e){var t=e.data,n=e.name;r.model.confirmInput(t.model,n)})),n=0;n<t;n++)this.model.run();return this.engine.endFrame(),e.abrupt("return",this);case 12:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getOutput",value:(n=WZ(VZ.mark((function e(){return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.readData());case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"compile",value:(t=WZ(VZ.mark((function e(){var t,n,r;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initPromise;case 2:return t=R3({},this.compiledBundle.context),n=this.engine.supportWebGPU?this.engine.useWGSL?H1.WGSL:H1.GLSL450:H1.GLSL100,r=this.compiledBundle.shaders[n],t.defines.filter((function(e){return e.runtime})).forEach((function(e){var t="".concat("__DefineValuePlaceholder__").concat(e.name);r=r.replace(t,"".concat(e.value))})),t.shader=r,t.uniforms.forEach((function(e){if(!e.data&&e.storageClass===V1.StorageBuffer){var n=1;e.type===z1.FloatArray?n=1:e.type===z1.Vector4FloatArray&&(n=4),e.data=new Float32Array(t.output.length*n).fill(0)}})),this.compiledBundle.context=t,e.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=e.sent;case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),M3=zZ((k3=P3).prototype,"engine",[S3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T3=zZ(k3.prototype,"configService",[O3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A3=k3))||A3),r4=(I3=f.injectable(),j3=f.inject(rJ.MaterialComponentManager),I3((z3=B3=function(){function e(){LZ(this,e),this.config=void 0,IZ(this,"material",G3,this),this.entity=void 0,this.component=void 0}return GZ(e,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(e){this.config=e}},{key:"setEntity",value:function(e,t){this.entity=e,this.component=this.material.create(e),this.component.entity=e,this.component.type=t,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),e}(),B3.BASIC="basic",G3=zZ((F3=z3).prototype,"material",[j3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L3=F3))||L3),i4=(U3=f.injectable(),V3=f.inject(rJ.MeshComponentManager),H3=f.inject(rJ.CullableComponentManager),W3=f.inject(rJ.TransformComponentManager),$3=f.inject(rJ.Systems),X3=f.named(rJ.SceneGraphSystem),U3((t4=e4=function(){function e(){LZ(this,e),this.attributes={},this.config=void 0,IZ(this,"mesh",K3,this),IZ(this,"cullable",Z3,this),IZ(this,"transform",J3,this),IZ(this,"sceneGraphSystem",Q3,this),this.meshComponent=void 0,this.transformComponent=void 0,this.entity=void 0}return GZ(e,[{key:"getEntity",value:function(){return this.entity}},{key:"getTransformComponent",value:function(){return this.transformComponent}},{key:"getMeshComponent",value:function(){return this.meshComponent}},{key:"setConfig",value:function(e){this.config=e}},{key:"setEntity",value:function(e){this.entity=e,this.cullable.create(e),this.meshComponent=this.mesh.create(e),this.transformComponent=this.transform.create(e),this.onEntityCreated()}},{key:"setMaterial",value:function(e){return this.meshComponent.material=e,this}},{key:"setGeometry",value:function(e){return this.meshComponent.geometry=e,this}},{key:"setAttributes",value:function(e){var t=this;Object.keys(e).forEach((function(n){void 0!==e[n]&&e[n]!==t.attributes[n]&&(t.onAttributeChanged({name:n,data:e[n]}),t.attributes[n]=e[n])}))}},{key:"setVisible",value:function(e){var t=this;return this.meshComponent.visible=e,this.meshComponent.children.forEach((function(n){var r=t.mesh.getComponentByEntity(n);r&&(r.visible=e)})),this}},{key:"isVisible",value:function(){return this.meshComponent.visible}},{key:"attach",value:function(e){return this.sceneGraphSystem.attach(this.entity,e.entity),this}},{key:"detach",value:function(){return this.sceneGraphSystem.detach(this.entity),this}},{key:"detachChildren",value:function(){return this.sceneGraphSystem.detachChildren(this.entity),this}},{key:"onEntityCreated",value:function(){}},{key:"onAttributeChanged",value:function(e){var t=e.name,n=e.data;this.meshComponent&&this.meshComponent.material&&this.meshComponent.material.setUniform(this.convertAttributeName2UniformName(t),n)}},{key:"convertAttributeName2UniformName",value:function(e){return e}}]),e}(),e4.POINT="point",e4.LINE="line",e4.GRID="grid",K3=zZ((q3=t4).prototype,"mesh",[V3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z3=zZ(q3.prototype,"cullable",[H3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J3=zZ(q3.prototype,"transform",[W3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q3=zZ(q3.prototype,"sceneGraphSystem",[$3,X3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y3=q3))||Y3),o4={exports:{}};!function(e,t){e.exports=function(){var e=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},t=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},n="\n";function r(e){return"undefined"!=typeof atob?atob(e):"base64:"+e}function i(e){var t=new Error("(regl) "+e);throw console.error(t),t}function o(e,t){e||i(t)}function s(e){return e?": "+e:""}function a(e,t,n){e in t||i("unknown parameter ("+e+")"+s(n)+". possible values: "+Object.keys(t).join())}function l(t,n){e(t)||i("invalid parameter type"+s(n)+". must be a typed array")}function c(e,t){switch(t){case"number":return"number"==typeof e;case"object":return"object"==typeof e;case"string":return"string"==typeof e;case"boolean":return"boolean"==typeof e;case"function":return"function"==typeof e;case"undefined":return void 0===e;case"symbol":return"symbol"==typeof e}}function u(e,t,n){c(e,t)||i("invalid parameter type"+s(n)+". expected "+t+", got "+typeof e)}function h(e,t){e>=0&&(0|e)===e||i("invalid parameter type, ("+e+")"+s(t)+". must be a nonnegative integer")}function d(e,t,n){t.indexOf(e)<0&&i("invalid value"+s(n)+". must be one of: "+t)}var f=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function p(e){Object.keys(e).forEach((function(e){f.indexOf(e)<0&&i('invalid regl constructor argument "'+e+'". must be one of '+f)}))}function g(e,t){for(e+="";e.length<t;)e=" "+e;return e}function m(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function v(e,t){this.number=e,this.line=t,this.errors=[]}function y(e,t,n){this.file=e,this.line=t,this.message=n}function b(){var e=new Error,t=(e.stack||e).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return r?r[1]:"unknown"}function x(){var e=new Error,t=(e.stack||e).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return r?r[1]:"unknown"}function w(e,t){var n=e.split("\n"),i=1,o=0,s={unknown:new m,0:new m};s.unknown.name=s[0].name=t||b(),s.unknown.lines.push(new v(0,""));for(var a=0;a<n.length;++a){var l=n[a],c=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(l);if(c)switch(c[1]){case"line":var u=/(\d+)(\s+\d+)?/.exec(c[2]);u&&(i=0|u[1],u[2]&&((o=0|u[2])in s||(s[o]=new m)));break;case"define":var h=/SHADER_NAME(_B64)?\s+(.*)$/.exec(c[2]);h&&(s[o].name=h[1]?r(h[2]):h[2])}s[o].lines.push(new v(i++,l))}return Object.keys(s).forEach((function(e){var t=s[e];t.lines.forEach((function(e){t.index[e.number]=e}))})),s}function C(e){var t=[];return e.split("\n").forEach((function(e){if(!(e.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(e);n?t.push(new y(0|n[1],0|n[2],n[3].trim())):e.length>0&&t.push(new y("unknown",0,e))}})),t}function E(e,t){t.forEach((function(t){var n=e[t.file];if(n){var r=n.index[t.line];if(r)return r.errors.push(t),void(n.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)}))}function _(e,t,r,i,s){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var a=e.getShaderInfoLog(t),l=i===e.FRAGMENT_SHADER?"fragment":"vertex";P(r,"string",l+" shader source must be a string",s);var c=w(r,s),u=C(a);E(c,u),Object.keys(c).forEach((function(e){var t=c[e];if(t.hasErrors){var r=[""],i=[""];o("file number "+e+": "+t.name+"\n","color:red;text-decoration:underline;font-weight:bold"),t.lines.forEach((function(e){if(e.errors.length>0){o(g(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(e.line+n,"color:red; background-color:yellow; font-weight:bold");var t=0;e.errors.forEach((function(r){var i=r.message,s=/^\s*'(.*)'\s*:\s*(.*)$/.exec(i);if(s){var a=s[1];i=s[2],"assign"===a&&(a="="),t=Math.max(e.line.indexOf(a,t),0)}else t=0;o(g("| ",6)),o(g("^^^",t+3)+n,"font-weight:bold"),o(g("| ",6)),o(i+n,"font-weight:bold")})),o(g("| ",6)+n)}else o(g(e.number,4)+"|  "),o(e.line+n,"color:red")})),"undefined"==typeof document||window.chrome?console.log(r.join("")):(i[0]=r.join("%c"),console.log.apply(console,i))}function o(e,t){r.push(e),i.push(t||"")}})),o.raise("Error compiling "+l+" shader, "+c[0].name)}}function S(e,t,r,i,s){if(!e.getProgramParameter(t,e.LINK_STATUS)){var a=e.getProgramInfoLog(t),l=w(r,s),c='Error linking program with vertex shader, "'+w(i,s)[0].name+'", and fragment shader "'+l[0].name+'"';"undefined"!=typeof document?console.log("%c"+c+n+"%c"+a,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(c+n+a),o.raise(c)}}function O(e){e._commandRef=b()}function A(e,t,n,r){function i(e){return e?r.id(e):0}function o(e,t){Object.keys(t).forEach((function(t){e[r.id(t)]=!0}))}O(e),e._fragId=i(e.static.frag),e._vertId=i(e.static.vert);var s=e._uniformSet={};o(s,t.static),o(s,t.dynamic);var a=e._attributeSet={};o(a,n.static),o(a,n.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic}function k(e,t){var n=x();i(e+" in command "+(t||b())+("unknown"===n?"":" called from "+n))}function M(e,t,n){e||k(t,n||b())}function T(e,t,n,r){e in t||k("unknown parameter ("+e+")"+s(n)+". possible values: "+Object.keys(t).join(),r||b())}function P(e,t,n,r){c(e,t)||k("invalid parameter type"+s(n)+". expected "+t+", got "+typeof e,r||b())}function D(e){e()}function N(e,t,n){e.texture?d(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):d(e.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")}var R=33071,I=9728,j=9984,L=9985,F=9986,G=9987,B=5121,z=5122,U=5123,V=5124,H=5125,W=5126,$=32819,X=32820,Y=33635,q=34042,K=36193,Z={};function J(e,t){return e===X||e===$||e===Y?2:e===q?4:Z[e]*t}function Q(e){return!(e&e-1||!e)}function ee(e,t,n){var r,i=t.width,s=t.height,a=t.channels;o(i>0&&i<=n.maxTextureSize&&s>0&&s<=n.maxTextureSize,"invalid texture shape"),e.wrapS===R&&e.wrapT===R||o(Q(i)&&Q(s),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==i&&1!==s&&o(e.minFilter!==j&&e.minFilter!==F&&e.minFilter!==L&&e.minFilter!==G,"min filter requires mipmap"):(o(Q(i)&&Q(s),"texture must be a square power of 2 to support mipmapping"),o(t.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),t.type===W&&(n.extensions.indexOf("oes_texture_float_linear")<0&&o(e.minFilter===I&&e.magFilter===I,"filter not supported, must enable oes_texture_float_linear"),o(!e.genMipmaps,"mipmap generation not supported with float textures"));var l=t.images;for(r=0;r<16;++r)if(l[r]){var c=i>>r,u=s>>r;o(t.mipmask&1<<r,"missing mipmap data");var h=l[r];if(o(h.width===c&&h.height===u,"invalid shape for mip images"),o(h.format===t.format&&h.internalformat===t.internalformat&&h.type===t.type,"incompatible type for mip image"),h.compressed);else if(h.data){var d=Math.ceil(J(h.type,a)*c/h.unpackAlignment)*h.unpackAlignment;o(h.data.byteLength===d*u,"invalid data for image, buffer size is inconsistent with image format")}else h.element||h.copy}else e.genMipmaps||o(0==(t.mipmask&1<<r),"extra mipmap data");t.compressed&&o(!e.genMipmaps,"mipmap generation for compressed images not supported")}function te(e,t,n,r){var i=e.width,s=e.height,a=e.channels;o(i>0&&i<=r.maxTextureSize&&s>0&&s<=r.maxTextureSize,"invalid texture shape"),o(i===s,"cube map must be square"),o(t.wrapS===R&&t.wrapT===R,"wrap mode not supported by cube map");for(var l=0;l<n.length;++l){var c=n[l];o(c.width===i&&c.height===s,"inconsistent cube map face shape"),t.genMipmaps&&(o(!c.compressed,"can not generate mipmap for compressed textures"),o(1===c.mipmask,"can not specify mipmaps and generate mipmaps"));for(var u=c.images,h=0;h<16;++h){var d=u[h];if(d){var f=i>>h,p=s>>h;o(c.mipmask&1<<h,"missing mipmap data"),o(d.width===f&&d.height===p,"invalid shape for mip images"),o(d.format===e.format&&d.internalformat===e.internalformat&&d.type===e.type,"incompatible type for mip image"),d.compressed||(d.data?o(d.data.byteLength===f*p*Math.max(J(d.type,a),d.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):d.element||d.copy)}}}}Z[5120]=Z[B]=1,Z[z]=Z[U]=Z[K]=Z[Y]=Z[$]=Z[X]=2,Z[V]=Z[H]=Z[W]=Z[q]=4;var ne=t(o,{optional:D,raise:i,commandRaise:k,command:M,parameter:a,commandParameter:T,constructor:p,type:u,commandType:P,isTypedArray:l,nni:h,oneOf:d,shaderError:_,linkError:S,callSite:x,saveCommandRef:O,saveDrawInfo:A,framebufferFormat:N,guessCommand:b,texture2D:ee,textureCube:te}),re=0,ie=0,oe=5,se=6;function ae(e,t){this.id=re++,this.type=e,this.data=t}function le(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function ce(e){if(0===e.length)return[];var t=e.charAt(0),n=e.charAt(e.length-1);if(e.length>1&&t===n&&('"'===t||"'"===t))return['"'+le(e.substr(1,e.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(r)return ce(e.substr(0,r.index)).concat(ce(r[1])).concat(ce(e.substr(r.index+r[0].length)));var i=e.split(".");if(1===i.length)return['"'+le(e)+'"'];for(var o=[],s=0;s<i.length;++s)o=o.concat(ce(i[s]));return o}function ue(e){return"["+ce(e).join("][")+"]"}function he(e,t){return new ae(e,ue(t+""))}function de(e){return"function"==typeof e&&!e._reglType||e instanceof ae}function fe(e,t){return"function"==typeof e?new ae(ie,e):"number"==typeof e||"boolean"==typeof e?new ae(oe,e):Array.isArray(e)?new ae(se,e.map(((e,n)=>fe(e,t+"["+n+"]")))):e instanceof ae?e:void ne(!1,"invalid option type in uniform "+t)}var pe={DynamicVariable:ae,define:he,isDynamic:de,unbox:fe,accessor:ue},ge={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},me="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function ve(){var e={"":0},t=[""];return{id:function(n){var r=e[n];return r||(r=e[n]=t.length,t.push(n),r)},str:function(e){return t[e]}}}function ye(e,n,r){var i,o=document.createElement("canvas");function s(){var n=window.innerWidth,i=window.innerHeight;if(e!==document.body){var s=e.getBoundingClientRect();n=s.right-s.left,i=s.bottom-s.top}o.width=r*n,o.height=r*i,t(o.style,{width:n+"px",height:i+"px"})}function a(){i?i.disconnect():window.removeEventListener("resize",s),e.removeChild(o)}return t(o.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(o),e===document.body&&(o.style.position="absolute",t(e.style,{margin:0,padding:0})),e!==document.body&&"function"==typeof ResizeObserver?(i=new ResizeObserver((function(){setTimeout(s)}))).observe(e):window.addEventListener("resize",s,!1),s(),{canvas:o,onDestroy:a}}function be(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function xe(e){return"string"==typeof e.nodeName&&"function"==typeof e.appendChild&&"function"==typeof e.getBoundingClientRect}function we(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}function Ce(e){return"string"==typeof e?e.split():(ne(Array.isArray(e),"invalid extension array"),e)}function Ee(e){return"string"==typeof e?(ne("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function _e(e){var t,n,r,i,o=e||{},s={},a=[],l=[],c="undefined"==typeof window?1:window.devicePixelRatio,u=!1,h=function(e){e&&ne.raise(e)},d=function(){};if("string"==typeof o?(ne("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),t=document.querySelector(o),ne(t,"invalid query string for element")):"object"==typeof o?xe(o)?t=o:we(o)?r=(i=o).canvas:(ne.constructor(o),"gl"in o?i=o.gl:"canvas"in o?r=Ee(o.canvas):"container"in o&&(n=Ee(o.container)),"attributes"in o&&(s=o.attributes,ne.type(s,"object","invalid context attributes")),"extensions"in o&&(a=Ce(o.extensions)),"optionalExtensions"in o&&(l=Ce(o.optionalExtensions)),"onDone"in o&&(ne.type(o.onDone,"function","invalid or missing onDone callback"),h=o.onDone),"profile"in o&&(u=!!o.profile),"pixelRatio"in o&&(c=+o.pixelRatio,ne(c>0,"invalid pixel ratio"))):ne.raise("invalid arguments to regl"),t&&("canvas"===t.nodeName.toLowerCase()?r=t:n=t),!i){if(!r){ne("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var f=ye(n||document.body,h,c);if(!f)return null;r=f.canvas,d=f.onDestroy}void 0===s.premultipliedAlpha&&(s.premultipliedAlpha=!0),i=be(r,s)}return i?{gl:i,canvas:r,container:n,extensions:a,optionalExtensions:l,pixelRatio:c,profile:u,onDone:h,onDestroy:d}:(d(),h("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Se(e,t){var n={};function r(t){ne.type(t,"string","extension name must be string");var r,i=t.toLowerCase();try{r=n[i]=e.getExtension(i)}catch(e){}return!!r}for(var i=0;i<t.extensions.length;++i){var o=t.extensions[i];if(!r(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(r),{extensions:n,restore:function(){Object.keys(n).forEach((function(e){if(n[e]&&!r(e))throw new Error("(regl): error restoring extension "+e)}))}}}function Oe(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}var Ae=5120,ke=5121,Me=5122,Te=5123,Pe=5124,De=5125,Ne=5126;function Re(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}function Ie(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1}function je(){var e=Oe(8,(function(){return[]}));function t(t){var n=Re(t),r=e[Ie(n)>>2];return r.length>0?r.pop():new ArrayBuffer(n)}function n(t){e[Ie(t.byteLength)>>2].push(t)}function r(e,n){var r=null;switch(e){case Ae:r=new Int8Array(t(n),0,n);break;case ke:r=new Uint8Array(t(n),0,n);break;case Me:r=new Int16Array(t(2*n),0,n);break;case Te:r=new Uint16Array(t(2*n),0,n);break;case Pe:r=new Int32Array(t(4*n),0,n);break;case De:r=new Uint32Array(t(4*n),0,n);break;case Ne:r=new Float32Array(t(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r}function i(e){n(e.buffer)}return{alloc:t,free:n,allocType:r,freeType:i}}var Le=je();Le.zero=je();var Fe=3408,Ge=3410,Be=3411,ze=3412,Ue=3413,Ve=3414,He=3415,We=33901,$e=33902,Xe=3379,Ye=3386,qe=34921,Ke=36347,Ze=36348,Je=35661,Qe=35660,et=34930,tt=36349,nt=34076,rt=34024,it=7936,ot=7937,st=7938,at=35724,lt=34047,ct=36063,ut=34852,ht=3553,dt=34067,ft=34069,pt=33984,gt=6408,mt=5126,vt=5121,yt=36160,bt=36053,xt=36064,wt=16384,Ct=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(lt));var r=1,i=1;t.webgl_draw_buffers&&(r=e.getParameter(ut),i=e.getParameter(ct));var o=!!t.oes_texture_float;if(o){var s=e.createTexture();e.bindTexture(ht,s),e.texImage2D(ht,0,gt,1,1,0,gt,mt,null);var a=e.createFramebuffer();if(e.bindFramebuffer(yt,a),e.framebufferTexture2D(yt,xt,ht,s,0),e.bindTexture(ht,null),e.checkFramebufferStatus(yt)!==bt)o=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(wt);var l=Le.allocType(mt,4);e.readPixels(0,0,1,1,gt,mt,l),e.getError()?o=!1:(e.deleteFramebuffer(a),e.deleteTexture(s),o=1===l[0]),Le.freeType(l)}}var c=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var u=e.createTexture(),h=Le.allocType(vt,36);e.activeTexture(pt),e.bindTexture(dt,u),e.texImage2D(ft,0,gt,3,3,0,gt,vt,h),Le.freeType(h),e.bindTexture(dt,null),e.deleteTexture(u),c=!e.getError()}return{colorBits:[e.getParameter(Ge),e.getParameter(Be),e.getParameter(ze),e.getParameter(Ue)],depthBits:e.getParameter(Ve),stencilBits:e.getParameter(He),subpixelBits:e.getParameter(Fe),extensions:Object.keys(t).filter((function(e){return!!t[e]})),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(We),lineWidthDims:e.getParameter($e),maxViewportDims:e.getParameter(Ye),maxCombinedTextureUnits:e.getParameter(Je),maxCubeMapSize:e.getParameter(nt),maxRenderbufferSize:e.getParameter(rt),maxTextureUnits:e.getParameter(et),maxTextureSize:e.getParameter(Xe),maxAttributes:e.getParameter(qe),maxVertexUniforms:e.getParameter(Ke),maxVertexTextureUnits:e.getParameter(Qe),maxVaryingVectors:e.getParameter(Ze),maxFragmentUniforms:e.getParameter(tt),glsl:e.getParameter(at),renderer:e.getParameter(ot),vendor:e.getParameter(it),version:e.getParameter(st),readFloat:o,npotTextureCube:c}};function Et(t){return!!t&&"object"==typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"==typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||e(t.data))}var _t=function(e){return Object.keys(e).map((function(t){return e[t]}))},St={shape:Pt,flatten:Tt};function Ot(e,t,n){for(var r=0;r<t;++r)n[r]=e[r]}function At(e,t,n,r){for(var i=0,o=0;o<t;++o)for(var s=e[o],a=0;a<n;++a)r[i++]=s[a]}function kt(e,t,n,r,i,o){for(var s=o,a=0;a<t;++a)for(var l=e[a],c=0;c<n;++c)for(var u=l[c],h=0;h<r;++h)i[s++]=u[h]}function Mt(e,t,n,r,i){for(var o=1,s=n+1;s<t.length;++s)o*=t[s];var a=t[n];if(t.length-n==4){var l=t[n+1],c=t[n+2],u=t[n+3];for(s=0;s<a;++s)kt(e[s],l,c,u,r,i),i+=o}else for(s=0;s<a;++s)Mt(e[s],t,n+1,r,i),i+=o}function Tt(e,t,n,r){var i=1;if(t.length)for(var o=0;o<t.length;++o)i*=t[o];else i=0;var s=r||Le.allocType(n,i);switch(t.length){case 0:break;case 1:Ot(e,t[0],s);break;case 2:At(e,t[0],t[1],s);break;case 3:kt(e,t[0],t[1],t[2],s,0);break;default:Mt(e,t,0,s,0)}return s}function Pt(e){for(var t=[],n=e;n.length;n=n[0])t.push(n.length);return t}var Dt={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Nt={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Rt={dynamic:35048,stream:35040,static:35044},It=St.flatten,jt=St.shape,Lt=35044,Ft=35040,Gt=5121,Bt=5126,zt=[];function Ut(e){return 0|Dt[Object.prototype.toString.call(e)]}function Vt(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function Ht(e,t,n,r,i,o,s){for(var a=0,l=0;l<n;++l)for(var c=0;c<r;++c)e[a++]=t[i*l+o*c+s]}function Wt(t,n,r,i){var o=0,s={};function a(e){this.id=o++,this.buffer=t.createBuffer(),this.type=e,this.usage=Lt,this.byteLength=0,this.dimension=1,this.dtype=Gt,this.persistentData=null,r.profile&&(this.stats={size:0})}a.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)},a.prototype.destroy=function(){f(this)};var l=[];function c(e,t){var n=l.pop();return n||(n=new a(e)),n.bind(),d(n,t,Ft,0,1,!1),n}function u(e){l.push(e)}function h(e,n,r){e.byteLength=n.byteLength,t.bufferData(e.type,n,r)}function d(t,n,r,i,o,s){var a,l;if(t.usage=r,Array.isArray(n)){if(t.dtype=i||Bt,n.length>0)if(Array.isArray(n[0])){a=jt(n);for(var c=1,u=1;u<a.length;++u)c*=a[u];t.dimension=c,h(t,l=It(n,a,t.dtype),r),s?t.persistentData=l:Le.freeType(l)}else if("number"==typeof n[0]){t.dimension=o;var d=Le.allocType(t.dtype,n.length);Vt(d,n),h(t,d,r),s?t.persistentData=d:Le.freeType(d)}else e(n[0])?(t.dimension=n[0].length,t.dtype=i||Ut(n[0])||Bt,h(t,l=It(n,[n.length,n[0].length],t.dtype),r),s?t.persistentData=l:Le.freeType(l)):ne.raise("invalid buffer data")}else if(e(n))t.dtype=i||Ut(n),t.dimension=o,h(t,n,r),s&&(t.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(Et(n)){a=n.shape;var f=n.stride,p=n.offset,g=0,m=0,v=0,y=0;1===a.length?(g=a[0],m=1,v=f[0],y=0):2===a.length?(g=a[0],m=a[1],v=f[0],y=f[1]):ne.raise("invalid shape"),t.dtype=i||Ut(n.data)||Bt,t.dimension=m;var b=Le.allocType(t.dtype,g*m);Ht(b,n.data,g,m,v,y,p),h(t,b,r),s?t.persistentData=b:Le.freeType(b)}else n instanceof ArrayBuffer?(t.dtype=Gt,t.dimension=o,h(t,n,r),s&&(t.persistentData=new Uint8Array(new Uint8Array(n)))):ne.raise("invalid buffer data")}function f(e){n.bufferCount--,i(e);var r=e.buffer;ne(r,"buffer must not be deleted already"),t.deleteBuffer(r),e.buffer=null,delete s[e.id]}function p(i,o,l,c){n.bufferCount++;var u=new a(o);function h(n){var i=Lt,o=null,s=0,a=0,l=1;return Array.isArray(n)||e(n)||Et(n)||n instanceof ArrayBuffer?o=n:"number"==typeof n?s=0|n:n&&(ne.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(ne(null===o||Array.isArray(o)||e(o)||Et(o),"invalid data for buffer"),o=n.data),"usage"in n&&(ne.parameter(n.usage,Rt,"invalid buffer usage"),i=Rt[n.usage]),"type"in n&&(ne.parameter(n.type,Nt,"invalid buffer type"),a=Nt[n.type]),"dimension"in n&&(ne.type(n.dimension,"number","invalid dimension"),l=0|n.dimension),"length"in n&&(ne.nni(s,"buffer length must be a nonnegative integer"),s=0|n.length)),u.bind(),o?d(u,o,i,a,l,c):(s&&t.bufferData(u.type,s,i),u.dtype=a||Gt,u.usage=i,u.dimension=l,u.byteLength=s),r.profile&&(u.stats.size=u.byteLength*zt[u.dtype]),h}function p(e,n){ne(n+e.byteLength<=u.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+e.byteLength+" starting from offset "+n+" to a buffer of size "+u.byteLength),t.bufferSubData(u.type,n,e)}function g(t,n){var r,i=0|(n||0);if(u.bind(),e(t)||t instanceof ArrayBuffer)p(t,i);else if(Array.isArray(t)){if(t.length>0)if("number"==typeof t[0]){var o=Le.allocType(u.dtype,t.length);Vt(o,t),p(o,i),Le.freeType(o)}else if(Array.isArray(t[0])||e(t[0])){r=jt(t);var s=It(t,r,u.dtype);p(s,i),Le.freeType(s)}else ne.raise("invalid buffer data")}else if(Et(t)){r=t.shape;var a=t.stride,l=0,c=0,d=0,f=0;1===r.length?(l=r[0],c=1,d=a[0],f=0):2===r.length?(l=r[0],c=r[1],d=a[0],f=a[1]):ne.raise("invalid shape");var g=Array.isArray(t.data)?u.dtype:Ut(t.data),m=Le.allocType(g,l*c);Ht(m,t.data,l,c,d,f,t.offset),p(m,i),Le.freeType(m)}else ne.raise("invalid data for buffer subdata");return h}return s[u.id]=u,l||h(i),h._reglType="buffer",h._buffer=u,h.subdata=g,r.profile&&(h.stats=u.stats),h.destroy=function(){f(u)},h}function g(){_t(s).forEach((function(e){e.buffer=t.createBuffer(),t.bindBuffer(e.type,e.buffer),t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)}))}return r.profile&&(n.getTotalBufferSize=function(){var e=0;return Object.keys(s).forEach((function(t){e+=s[t].stats.size})),e}),{create:p,createStream:c,destroyStream:u,clear:function(){_t(s).forEach(f),l.forEach(f)},getBuffer:function(e){return e&&e._buffer instanceof a?e._buffer:null},restore:g,_initBuffer:d}}zt[5120]=1,zt[5122]=2,zt[5124]=4,zt[5121]=1,zt[5123]=2,zt[5125]=4,zt[5126]=4;var $t={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Xt=0,Yt=1,qt=4,Kt=5120,Zt=5121,Jt=5122,Qt=5123,en=5124,tn=5125,nn=34963,rn=35040,on=35044;function sn(t,n,r,i){var o={},s=0,a={uint8:Zt,uint16:Qt};function l(e){this.id=s++,o[this.id]=this,this.buffer=e,this.primType=qt,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(a.uint32=tn),l.prototype.bind=function(){this.buffer.bind()};var c=[];function u(e){var t=c.pop();return t||(t=new l(r.create(null,nn,!0,!1)._buffer)),d(t,e,rn,-1,-1,0,0),t}function h(e){c.push(e)}function d(i,o,s,a,l,c,u){var h;if(i.buffer.bind(),o){var d=u;u||e(o)&&(!Et(o)||e(o.data))||(d=n.oes_element_index_uint?tn:Qt),r._initBuffer(i.buffer,o,s,d,3)}else t.bufferData(nn,c,s),i.buffer.dtype=h||Zt,i.buffer.usage=s,i.buffer.dimension=3,i.buffer.byteLength=c;if(h=u,!u){switch(i.buffer.dtype){case Zt:case Kt:h=Zt;break;case Qt:case Jt:h=Qt;break;case tn:case en:h=tn;break;default:ne.raise("unsupported type for element array")}i.buffer.dtype=h}i.type=h,ne(h!==tn||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var f=l;f<0&&(f=i.buffer.byteLength,h===Qt?f>>=1:h===tn&&(f>>=2)),i.vertCount=f;var p=a;if(a<0){p=qt;var g=i.buffer.dimension;1===g&&(p=Xt),2===g&&(p=Yt),3===g&&(p=qt)}i.primType=p}function f(e){i.elementsCount--,ne(null!==e.buffer,"must not double destroy elements"),delete o[e.id],e.buffer.destroy(),e.buffer=null}function p(t,n){var o=r.create(null,nn,!0),s=new l(o._buffer);function c(t){if(t)if("number"==typeof t)o(t),s.primType=qt,s.vertCount=0|t,s.type=Zt;else{var n=null,r=on,i=-1,l=-1,u=0,h=0;Array.isArray(t)||e(t)||Et(t)?n=t:(ne.type(t,"object","invalid arguments for elements"),"data"in t&&(n=t.data,ne(Array.isArray(n)||e(n)||Et(n),"invalid data for element buffer")),"usage"in t&&(ne.parameter(t.usage,Rt,"invalid element buffer usage"),r=Rt[t.usage]),"primitive"in t&&(ne.parameter(t.primitive,$t,"invalid element buffer primitive"),i=$t[t.primitive]),"count"in t&&(ne("number"==typeof t.count&&t.count>=0,"invalid vertex count for elements"),l=0|t.count),"type"in t&&(ne.parameter(t.type,a,"invalid buffer type"),h=a[t.type]),"length"in t?u=0|t.length:(u=l,h===Qt||h===Jt?u*=2:h!==tn&&h!==en||(u*=4))),d(s,n,r,i,l,u,h)}else o(),s.primType=qt,s.vertCount=0,s.type=Zt;return c}return i.elementsCount++,c(t),c._reglType="elements",c._elements=s,c.subdata=function(e,t){return o.subdata(e,t),c},c.destroy=function(){f(s)},c}return{create:p,createStream:u,destroyStream:h,getElements:function(e){return"function"==typeof e&&e._elements instanceof l?e._elements:null},clear:function(){_t(o).forEach(f)}}}var an=new Float32Array(1),ln=new Uint32Array(an.buffer),cn=5123;function un(e){for(var t=Le.allocType(cn,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(e[n]===1/0)t[n]=31744;else if(e[n]===-1/0)t[n]=64512;else{an[0]=e[n];var r=ln[0],i=r>>>31<<15,o=(r<<1>>>24)-127,s=r>>13&1023;if(o<-24)t[n]=i;else if(o<-14){var a=-14-o;t[n]=i+(s+1024>>a)}else t[n]=o>15?i+31744:i+(o+15<<10)+s}return t}function hn(t){return Array.isArray(t)||e(t)}var dn=function(e){return!(e&e-1||!e)},fn=34467,pn=3553,gn=34067,mn=34069,vn=6408,yn=6406,bn=6407,xn=6409,wn=6410,Cn=32854,En=32855,_n=36194,Sn=32819,On=32820,An=33635,kn=34042,Mn=6402,Tn=34041,Pn=35904,Dn=35906,Nn=36193,Rn=33776,In=33777,jn=33778,Ln=33779,Fn=35986,Gn=35987,Bn=34798,zn=35840,Un=35841,Vn=35842,Hn=35843,Wn=36196,$n=5121,Xn=5123,Yn=5125,qn=5126,Kn=10242,Zn=10243,Jn=10497,Qn=33071,er=33648,tr=10240,nr=10241,rr=9728,ir=9729,or=9984,sr=9985,ar=9986,lr=9987,cr=33170,ur=4352,hr=4353,dr=4354,fr=34046,pr=3317,gr=37440,mr=37441,vr=37443,yr=37444,br=33984,xr=[or,ar,sr,lr],wr=[0,xn,wn,bn,vn],Cr={};function Er(e){return"[object "+e+"]"}Cr[xn]=Cr[yn]=Cr[Mn]=1,Cr[Tn]=Cr[wn]=2,Cr[bn]=Cr[Pn]=3,Cr[vn]=Cr[Dn]=4;var _r=Er("HTMLCanvasElement"),Sr=Er("OffscreenCanvas"),Or=Er("CanvasRenderingContext2D"),Ar=Er("ImageBitmap"),kr=Er("HTMLImageElement"),Mr=Er("HTMLVideoElement"),Tr=Object.keys(Dt).concat([_r,Sr,Or,Ar,kr,Mr]),Pr=[];Pr[$n]=1,Pr[qn]=4,Pr[Nn]=2,Pr[Xn]=2,Pr[Yn]=4;var Dr=[];function Nr(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function Rr(e){return!!Array.isArray(e)&&!(0===e.length||!hn(e[0]))}function Ir(e){return Object.prototype.toString.call(e)}function jr(e){return Ir(e)===_r}function Lr(e){return Ir(e)===Sr}function Fr(e){return Ir(e)===Or}function Gr(e){return Ir(e)===Ar}function Br(e){return Ir(e)===kr}function zr(e){return Ir(e)===Mr}function Ur(e){if(!e)return!1;var t=Ir(e);return Tr.indexOf(t)>=0||Nr(e)||Rr(e)||Et(e)}function Vr(e){return 0|Dt[Object.prototype.toString.call(e)]}function Hr(e,t){var n=t.length;switch(e.type){case $n:case Xn:case Yn:case qn:var r=Le.allocType(e.type,n);r.set(t),e.data=r;break;case Nn:e.data=un(t);break;default:ne.raise("unsupported texture type, must specify a typed array")}}function Wr(e,t){return Le.allocType(e.type===Nn?qn:e.type,t)}function $r(e,t){e.type===Nn?(e.data=un(t),Le.freeType(t)):e.data=t}function Xr(e,t,n,r,i,o){for(var s=e.width,a=e.height,l=e.channels,c=Wr(e,s*a*l),u=0,h=0;h<a;++h)for(var d=0;d<s;++d)for(var f=0;f<l;++f)c[u++]=t[n*d+r*h+i*f+o];$r(e,c)}function Yr(e,t,n,r,i,o){var s;if(s=void 0!==Dr[e]?Dr[e]:Cr[e]*Pr[t],o&&(s*=6),i){for(var a=0,l=n;l>=1;)a+=s*l*l,l/=2;return a}return s*n*r}function qr(n,r,i,o,s,a,l){var c={"don't care":ur,"dont care":ur,nice:dr,fast:hr},u={repeat:Jn,clamp:Qn,mirror:er},h={nearest:rr,linear:ir},d=t({mipmap:lr,"nearest mipmap nearest":or,"linear mipmap nearest":sr,"nearest mipmap linear":ar,"linear mipmap linear":lr},h),f={none:0,browser:yr},p={uint8:$n,rgba4:Sn,rgb565:An,"rgb5 a1":On},g={alpha:yn,luminance:xn,"luminance alpha":wn,rgb:bn,rgba:vn,rgba4:Cn,"rgb5 a1":En,rgb565:_n},m={};r.ext_srgb&&(g.srgb=Pn,g.srgba=Dn),r.oes_texture_float&&(p.float32=p.float=qn),r.oes_texture_half_float&&(p.float16=p["half float"]=Nn),r.webgl_depth_texture&&(t(g,{depth:Mn,"depth stencil":Tn}),t(p,{uint16:Xn,uint32:Yn,"depth stencil":kn})),r.webgl_compressed_texture_s3tc&&t(m,{"rgb s3tc dxt1":Rn,"rgba s3tc dxt1":In,"rgba s3tc dxt3":jn,"rgba s3tc dxt5":Ln}),r.webgl_compressed_texture_atc&&t(m,{"rgb atc":Fn,"rgba atc explicit alpha":Gn,"rgba atc interpolated alpha":Bn}),r.webgl_compressed_texture_pvrtc&&t(m,{"rgb pvrtc 4bppv1":zn,"rgb pvrtc 2bppv1":Un,"rgba pvrtc 4bppv1":Vn,"rgba pvrtc 2bppv1":Hn}),r.webgl_compressed_texture_etc1&&(m["rgb etc1"]=Wn);var v=Array.prototype.slice.call(n.getParameter(fn));Object.keys(m).forEach((function(e){var t=m[e];v.indexOf(t)>=0&&(g[e]=t)}));var y=Object.keys(g);i.textureFormats=y;var b=[];Object.keys(g).forEach((function(e){var t=g[e];b[t]=e}));var x=[];Object.keys(p).forEach((function(e){var t=p[e];x[t]=e}));var w=[];Object.keys(h).forEach((function(e){var t=h[e];w[t]=e}));var C=[];Object.keys(d).forEach((function(e){var t=d[e];C[t]=e}));var E=[];Object.keys(u).forEach((function(e){var t=u[e];E[t]=e}));var _=y.reduce((function(e,t){var n=g[t];return n===xn||n===yn||n===xn||n===wn||n===Mn||n===Tn||r.ext_srgb&&(n===Pn||n===Dn)?e[n]=n:n===En||t.indexOf("rgba")>=0?e[n]=vn:e[n]=bn,e}),{});function S(){this.internalformat=vn,this.format=vn,this.type=$n,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=yr,this.width=0,this.height=0,this.channels=0}function O(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function A(e,t){if("object"==typeof t&&t){if("premultiplyAlpha"in t&&(ne.type(t.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(ne.type(t.flipY,"boolean","invalid texture flip"),e.flipY=t.flipY),"alignment"in t&&(ne.oneOf(t.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=t.alignment),"colorSpace"in t&&(ne.parameter(t.colorSpace,f,"invalid colorSpace"),e.colorSpace=f[t.colorSpace]),"type"in t){var n=t.type;ne(r.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),ne(r.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),ne(r.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ne.parameter(n,p,"invalid texture type"),e.type=p[n]}var o=e.width,s=e.height,a=e.channels,l=!1;"shape"in t?(ne(Array.isArray(t.shape)&&t.shape.length>=2,"shape must be an array"),o=t.shape[0],s=t.shape[1],3===t.shape.length&&(a=t.shape[2],ne(a>0&&a<=4,"invalid number of channels"),l=!0),ne(o>=0&&o<=i.maxTextureSize,"invalid width"),ne(s>=0&&s<=i.maxTextureSize,"invalid height")):("radius"in t&&(o=s=t.radius,ne(o>=0&&o<=i.maxTextureSize,"invalid radius")),"width"in t&&(o=t.width,ne(o>=0&&o<=i.maxTextureSize,"invalid width")),"height"in t&&(s=t.height,ne(s>=0&&s<=i.maxTextureSize,"invalid height")),"channels"in t&&(a=t.channels,ne(a>0&&a<=4,"invalid number of channels"),l=!0)),e.width=0|o,e.height=0|s,e.channels=0|a;var c=!1;if("format"in t){var u=t.format;ne(r.webgl_depth_texture||!("depth"===u||"depth stencil"===u),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ne.parameter(u,g,"invalid texture format");var h=e.internalformat=g[u];e.format=_[h],u in p&&("type"in t||(e.type=p[u])),u in m&&(e.compressed=!0),c=!0}!l&&c?e.channels=Cr[e.format]:l&&!c?e.channels!==wr[e.format]&&(e.format=e.internalformat=wr[e.channels]):c&&l&&ne(e.channels===Cr[e.format],"number of channels inconsistent with specified format")}}function k(e){n.pixelStorei(gr,e.flipY),n.pixelStorei(mr,e.premultiplyAlpha),n.pixelStorei(vr,e.colorSpace),n.pixelStorei(pr,e.unpackAlignment)}function M(){S.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function T(t,n){var r=null;if(Ur(n)?r=n:n&&(ne.type(n,"object","invalid pixel data type"),A(t,n),"x"in n&&(t.xOffset=0|n.x),"y"in n&&(t.yOffset=0|n.y),Ur(n.data)&&(r=n.data)),ne(!t.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){ne(!r,"can not specify copy and data field for the same texture");var o=s.viewportWidth,a=s.viewportHeight;t.width=t.width||o-t.xOffset,t.height=t.height||a-t.yOffset,t.needsCopy=!0,ne(t.xOffset>=0&&t.xOffset<o&&t.yOffset>=0&&t.yOffset<a&&t.width>0&&t.width<=o&&t.height>0&&t.height<=a,"copy texture read out of bounds")}else if(r){if(e(r))t.channels=t.channels||4,t.data=r,"type"in n||t.type!==$n||(t.type=Vr(r));else if(Nr(r))t.channels=t.channels||4,Hr(t,r),t.alignment=1,t.needsFree=!0;else if(Et(r)){var l=r.data;Array.isArray(l)||t.type!==$n||(t.type=Vr(l));var c,u,h,d,f,p,g=r.shape,m=r.stride;3===g.length?(h=g[2],p=m[2]):(ne(2===g.length,"invalid ndarray pixel data, must be 2 or 3D"),h=1,p=1),c=g[0],u=g[1],d=m[0],f=m[1],t.alignment=1,t.width=c,t.height=u,t.channels=h,t.format=t.internalformat=wr[h],t.needsFree=!0,Xr(t,l,d,f,p,r.offset)}else if(jr(r)||Lr(r)||Fr(r))jr(r)||Lr(r)?t.element=r:t.element=r.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(Gr(r))t.element=r,t.width=r.width,t.height=r.height,t.channels=4;else if(Br(r))t.element=r,t.width=r.naturalWidth,t.height=r.naturalHeight,t.channels=4;else if(zr(r))t.element=r,t.width=r.videoWidth,t.height=r.videoHeight,t.channels=4;else if(Rr(r)){var v=t.width||r[0].length,y=t.height||r.length,b=t.channels;b=hn(r[0][0])?b||r[0][0].length:b||1;for(var x=St.shape(r),w=1,C=0;C<x.length;++C)w*=x[C];var E=Wr(t,w);St.flatten(r,x,"",E),$r(t,E),t.alignment=1,t.width=v,t.height=y,t.channels=b,t.format=t.internalformat=wr[b],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;t.type===qn?ne(i.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):t.type===Nn&&ne(i.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function P(e,t,r){var i=e.element,s=e.data,a=e.internalformat,l=e.format,c=e.type,u=e.width,h=e.height;k(e),i?n.texImage2D(t,r,l,l,c,i):e.compressed?n.compressedTexImage2D(t,r,a,u,h,0,s):e.needsCopy?(o(),n.copyTexImage2D(t,r,l,e.xOffset,e.yOffset,u,h,0)):n.texImage2D(t,r,l,u,h,0,l,c,s||null)}function D(e,t,r,i,s){var a=e.element,l=e.data,c=e.internalformat,u=e.format,h=e.type,d=e.width,f=e.height;k(e),a?n.texSubImage2D(t,s,r,i,u,h,a):e.compressed?n.compressedTexSubImage2D(t,s,r,i,c,d,f,l):e.needsCopy?(o(),n.copyTexSubImage2D(t,s,r,i,e.xOffset,e.yOffset,d,f)):n.texSubImage2D(t,s,r,i,d,f,u,h,l)}var N=[];function R(){return N.pop()||new M}function I(e){e.needsFree&&Le.freeType(e.data),M.call(e),N.push(e)}function j(){S.call(this),this.genMipmaps=!1,this.mipmapHint=ur,this.mipmask=0,this.images=Array(16)}function L(e,t,n){var r=e.images[0]=R();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function F(e,t){var n=null;if(Ur(t))O(n=e.images[0]=R(),e),T(n,t),e.mipmask=1;else if(A(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)O(n=e.images[i]=R(),e),n.width>>=i,n.height>>=i,T(n,r[i]),e.mipmask|=1<<i;else O(n=e.images[0]=R(),e),T(n,t),e.mipmask=1;O(e,e.images[0]),!e.compressed||e.internalformat!==Rn&&e.internalformat!==In&&e.internalformat!==jn&&e.internalformat!==Ln||ne(e.width%4==0&&e.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function G(e,t){for(var n=e.images,r=0;r<n.length;++r){if(!n[r])return;P(n[r],t,r)}}var B=[];function z(){var e=B.pop()||new j;S.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function U(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&I(t[n]),t[n]=null;B.push(e)}function V(){this.minFilter=rr,this.magFilter=rr,this.wrapS=Qn,this.wrapT=Qn,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=ur}function H(e,t){if("min"in t){var n=t.min;ne.parameter(n,d),e.minFilter=d[n],xr.indexOf(e.minFilter)>=0&&!("faces"in t)&&(e.genMipmaps=!0)}if("mag"in t){var r=t.mag;ne.parameter(r,h),e.magFilter=h[r]}var o=e.wrapS,s=e.wrapT;if("wrap"in t){var a=t.wrap;"string"==typeof a?(ne.parameter(a,u),o=s=u[a]):Array.isArray(a)&&(ne.parameter(a[0],u),ne.parameter(a[1],u),o=u[a[0]],s=u[a[1]])}else{if("wrapS"in t){var l=t.wrapS;ne.parameter(l,u),o=u[l]}if("wrapT"in t){var f=t.wrapT;ne.parameter(f,u),s=u[f]}}if(e.wrapS=o,e.wrapT=s,"anisotropic"in t){var p=t.anisotropic;ne("number"==typeof p&&p>=1&&p<=i.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var g=!1;switch(typeof t.mipmap){case"string":ne.parameter(t.mipmap,c,"invalid mipmap hint"),e.mipmapHint=c[t.mipmap],e.genMipmaps=!0,g=!0;break;case"boolean":g=e.genMipmaps=t.mipmap;break;case"object":ne(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,g=!0;break;default:ne.raise("invalid mipmap type")}g&&!("min"in t)&&(e.minFilter=or)}}function W(e,t){n.texParameteri(t,nr,e.minFilter),n.texParameteri(t,tr,e.magFilter),n.texParameteri(t,Kn,e.wrapS),n.texParameteri(t,Zn,e.wrapT),r.ext_texture_filter_anisotropic&&n.texParameteri(t,fr,e.anisotropic),e.genMipmaps&&(n.hint(cr,e.mipmapHint),n.generateMipmap(t))}var $=0,X={},Y=i.maxTextureUnits,q=Array(Y).map((function(){return null}));function K(e){S.call(this),this.mipmask=0,this.internalformat=vn,this.id=$++,this.refCount=1,this.target=e,this.texture=n.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new V,l.profile&&(this.stats={size:0})}function Z(e){n.activeTexture(br),n.bindTexture(e.target,e.texture)}function J(){var e=q[0];e?n.bindTexture(e.target,e.texture):n.bindTexture(pn,null)}function Q(e){var t=e.texture;ne(t,"must not double destroy texture");var r=e.unit,i=e.target;r>=0&&(n.activeTexture(br+r),n.bindTexture(i,null),q[r]=null),n.deleteTexture(t),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete X[e.id],a.textureCount--}function ee(e,t){var r=new K(pn);function o(e,t){var n=r.texInfo;V.call(n);var s=z();return"number"==typeof e?L(s,0|e,"number"==typeof t?0|t:0|e):e?(ne.type(e,"object","invalid arguments to regl.texture"),H(n,e),F(s,e)):L(s,1,1),n.genMipmaps&&(s.mipmask=(s.width<<1)-1),r.mipmask=s.mipmask,O(r,s),ne.texture2D(n,s,i),r.internalformat=s.internalformat,o.width=s.width,o.height=s.height,Z(r),G(s,pn),W(n,pn),J(),U(s),l.profile&&(r.stats.size=Yr(r.internalformat,r.type,s.width,s.height,n.genMipmaps,!1)),o.format=b[r.internalformat],o.type=x[r.type],o.mag=w[n.magFilter],o.min=C[n.minFilter],o.wrapS=E[n.wrapS],o.wrapT=E[n.wrapT],o}function s(e,t,n,i){ne(!!e,"must specify image data");var s=0|t,a=0|n,l=0|i,c=R();return O(c,r),c.width=0,c.height=0,T(c,e),c.width=c.width||(r.width>>l)-s,c.height=c.height||(r.height>>l)-a,ne(r.type===c.type&&r.format===c.format&&r.internalformat===c.internalformat,"incompatible format for texture.subimage"),ne(s>=0&&a>=0&&s+c.width<=r.width&&a+c.height<=r.height,"texture.subimage write out of bounds"),ne(r.mipmask&1<<l,"missing mipmap data"),ne(c.data||c.element||c.needsCopy,"missing image data"),Z(r),D(c,pn,s,a,l),J(),I(c),o}function c(e,t){var i=0|e,s=0|t||i;if(i===r.width&&s===r.height)return o;o.width=r.width=i,o.height=r.height=s,Z(r);for(var a=0;r.mipmask>>a;++a){var c=i>>a,u=s>>a;if(!c||!u)break;n.texImage2D(pn,a,r.format,c,u,0,r.format,r.type,null)}return J(),l.profile&&(r.stats.size=Yr(r.internalformat,r.type,i,s,!1,!1)),o}return X[r.id]=r,a.textureCount++,o(e,t),o.subimage=s,o.resize=c,o._reglType="texture2d",o._texture=r,l.profile&&(o.stats=r.stats),o.destroy=function(){r.decRef()},o}function te(e,t,r,o,s,c){var u=new K(gn);X[u.id]=u,a.cubeCount++;var h=new Array(6);function d(e,t,n,r,o,s){var a,c=u.texInfo;for(V.call(c),a=0;a<6;++a)h[a]=z();if("number"!=typeof e&&e)if("object"==typeof e)if(t)F(h[0],e),F(h[1],t),F(h[2],n),F(h[3],r),F(h[4],o),F(h[5],s);else if(H(c,e),A(u,e),"faces"in e){var f=e.faces;for(ne(Array.isArray(f)&&6===f.length,"cube faces must be a length 6 array"),a=0;a<6;++a)ne("object"==typeof f[a]&&!!f[a],"invalid input for cube map face"),O(h[a],u),F(h[a],f[a])}else for(a=0;a<6;++a)F(h[a],e);else ne.raise("invalid arguments to cube map");else{var p=0|e||1;for(a=0;a<6;++a)L(h[a],p,p)}for(O(u,h[0]),i.npotTextureCube||ne(dn(u.width)&&dn(u.height),"your browser does not support non power or two texture dimensions"),c.genMipmaps?u.mipmask=(h[0].width<<1)-1:u.mipmask=h[0].mipmask,ne.textureCube(u,c,h,i),u.internalformat=h[0].internalformat,d.width=h[0].width,d.height=h[0].height,Z(u),a=0;a<6;++a)G(h[a],mn+a);for(W(c,gn),J(),l.profile&&(u.stats.size=Yr(u.internalformat,u.type,d.width,d.height,c.genMipmaps,!0)),d.format=b[u.internalformat],d.type=x[u.type],d.mag=w[c.magFilter],d.min=C[c.minFilter],d.wrapS=E[c.wrapS],d.wrapT=E[c.wrapT],a=0;a<6;++a)U(h[a]);return d}function f(e,t,n,r,i){ne(!!t,"must specify image data"),ne("number"==typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var o=0|n,s=0|r,a=0|i,l=R();return O(l,u),l.width=0,l.height=0,T(l,t),l.width=l.width||(u.width>>a)-o,l.height=l.height||(u.height>>a)-s,ne(u.type===l.type&&u.format===l.format&&u.internalformat===l.internalformat,"incompatible format for texture.subimage"),ne(o>=0&&s>=0&&o+l.width<=u.width&&s+l.height<=u.height,"texture.subimage write out of bounds"),ne(u.mipmask&1<<a,"missing mipmap data"),ne(l.data||l.element||l.needsCopy,"missing image data"),Z(u),D(l,mn+e,o,s,a),J(),I(l),d}function p(e){var t=0|e;if(t!==u.width){d.width=u.width=t,d.height=u.height=t,Z(u);for(var r=0;r<6;++r)for(var i=0;u.mipmask>>i;++i)n.texImage2D(mn+r,i,u.format,t>>i,t>>i,0,u.format,u.type,null);return J(),l.profile&&(u.stats.size=Yr(u.internalformat,u.type,d.width,d.height,!1,!0)),d}}return d(e,t,r,o,s,c),d.subimage=f,d.resize=p,d._reglType="textureCube",d._texture=u,l.profile&&(d.stats=u.stats),d.destroy=function(){u.decRef()},d}function re(){for(var e=0;e<Y;++e)n.activeTexture(br+e),n.bindTexture(pn,null),q[e]=null;_t(X).forEach(Q),a.cubeCount=0,a.textureCount=0}function ie(){for(var e=0;e<Y;++e){var t=q[e];t&&(t.bindCount=0,t.unit=-1,q[e]=null)}_t(X).forEach((function(e){e.texture=n.createTexture(),n.bindTexture(e.target,e.texture);for(var t=0;t<32;++t)if(0!=(e.mipmask&1<<t))if(e.target===pn)n.texImage2D(pn,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);else for(var r=0;r<6;++r)n.texImage2D(mn+r,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);W(e.texInfo,e.target)}))}function oe(){for(var e=0;e<Y;++e){var t=q[e];t&&(t.bindCount=0,t.unit=-1,q[e]=null),n.activeTexture(br+e),n.bindTexture(pn,null),n.bindTexture(gn,null)}}return t(K.prototype,{bind:function(){var e=this;e.bindCount+=1;var t=e.unit;if(t<0){for(var r=0;r<Y;++r){var i=q[r];if(i){if(i.bindCount>0)continue;i.unit=-1}q[r]=e,t=r;break}t>=Y&&ne.raise("insufficient number of texture units"),l.profile&&a.maxTextureUnits<t+1&&(a.maxTextureUnits=t+1),e.unit=t,n.activeTexture(br+t),n.bindTexture(e.target,e.texture)}return t},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Q(this)}}),l.profile&&(a.getTotalTextureSize=function(){var e=0;return Object.keys(X).forEach((function(t){e+=X[t].stats.size})),e}),{create2D:ee,createCube:te,clear:re,getTexture:function(e){return null},restore:ie,refresh:oe}}Dr[Cn]=2,Dr[En]=2,Dr[_n]=2,Dr[Tn]=4,Dr[Rn]=.5,Dr[In]=.5,Dr[jn]=1,Dr[Ln]=1,Dr[Fn]=.5,Dr[Gn]=1,Dr[Bn]=1,Dr[zn]=.5,Dr[Un]=.25,Dr[Vn]=.5,Dr[Hn]=.25,Dr[Wn]=.5;var Kr=36161,Zr=32854,Jr=32855,Qr=36194,ei=33189,ti=36168,ni=34041,ri=35907,ii=34836,oi=34842,si=34843,ai=[];function li(e,t,n){return ai[e]*t*n}ai[Zr]=2,ai[Jr]=2,ai[Qr]=2,ai[ei]=2,ai[ti]=1,ai[ni]=4,ai[ri]=4,ai[ii]=16,ai[oi]=8,ai[si]=6;var ci=function(e,t,n,r,i){var o={rgba4:Zr,rgb565:Qr,"rgb5 a1":Jr,depth:ei,stencil:ti,"depth stencil":ni};t.ext_srgb&&(o.srgba=ri),t.ext_color_buffer_half_float&&(o.rgba16f=oi,o.rgb16f=si),t.webgl_color_buffer_float&&(o.rgba32f=ii);var s=[];Object.keys(o).forEach((function(e){var t=o[e];s[t]=e}));var a=0,l={};function c(e){this.id=a++,this.refCount=1,this.renderbuffer=e,this.format=Zr,this.width=0,this.height=0,i.profile&&(this.stats={size:0})}function u(t){var n=t.renderbuffer;ne(n,"must not double destroy renderbuffer"),e.bindRenderbuffer(Kr,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete l[t.id],r.renderbufferCount--}function h(t,a){var u=new c(e.createRenderbuffer());function h(t,r){var a=0,l=0,c=Zr;if("object"==typeof t&&t){var d=t;if("shape"in d){var f=d.shape;ne(Array.isArray(f)&&f.length>=2,"invalid renderbuffer shape"),a=0|f[0],l=0|f[1]}else"radius"in d&&(a=l=0|d.radius),"width"in d&&(a=0|d.width),"height"in d&&(l=0|d.height);"format"in d&&(ne.parameter(d.format,o,"invalid renderbuffer format"),c=o[d.format])}else"number"==typeof t?(a=0|t,l="number"==typeof r?0|r:a):t?ne.raise("invalid arguments to renderbuffer constructor"):a=l=1;if(ne(a>0&&l>0&&a<=n.maxRenderbufferSize&&l<=n.maxRenderbufferSize,"invalid renderbuffer size"),a!==u.width||l!==u.height||c!==u.format)return h.width=u.width=a,h.height=u.height=l,u.format=c,e.bindRenderbuffer(Kr,u.renderbuffer),e.renderbufferStorage(Kr,c,a,l),ne(0===e.getError(),"invalid render buffer format"),i.profile&&(u.stats.size=li(u.format,u.width,u.height)),h.format=s[u.format],h}function d(t,r){var o=0|t,s=0|r||o;return o===u.width&&s===u.height||(ne(o>0&&s>0&&o<=n.maxRenderbufferSize&&s<=n.maxRenderbufferSize,"invalid renderbuffer size"),h.width=u.width=o,h.height=u.height=s,e.bindRenderbuffer(Kr,u.renderbuffer),e.renderbufferStorage(Kr,u.format,o,s),ne(0===e.getError(),"invalid render buffer format"),i.profile&&(u.stats.size=li(u.format,u.width,u.height))),h}return l[u.id]=u,r.renderbufferCount++,h(t,a),h.resize=d,h._reglType="renderbuffer",h._renderbuffer=u,i.profile&&(h.stats=u.stats),h.destroy=function(){u.decRef()},h}function d(){_t(l).forEach((function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(Kr,t.renderbuffer),e.renderbufferStorage(Kr,t.format,t.width,t.height)})),e.bindRenderbuffer(Kr,null)}return c.prototype.decRef=function(){--this.refCount<=0&&u(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(l).forEach((function(t){e+=l[t].stats.size})),e}),{create:h,clear:function(){_t(l).forEach(u)},restore:d}},ui=36160,hi=36161,di=3553,fi=34069,pi=36064,gi=36096,mi=36128,vi=33306,yi=36053,bi=36054,xi=36055,wi=36057,Ci=36061,Ei=36193,_i=5121,Si=5126,Oi=6407,Ai=6408,ki=6402,Mi=[Oi,Ai],Ti=[];Ti[Ai]=4,Ti[Oi]=3;var Pi=[];Pi[_i]=1,Pi[Si]=4,Pi[Ei]=2;var Di=33189,Ni=36168,Ri=34041,Ii=[32854,32855,36194,35907,34842,34843,34836],ji={};function Li(e,n,r,i,o,s){var a={cur:null,next:null,dirty:!1,setFBO:null},l=["rgba"],c=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&c.push("srgba"),n.ext_color_buffer_half_float&&c.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&c.push("rgba32f");var u=["uint8"];function h(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=0,i=0;t?(r=t.width,i=t.height):n&&(r=n.width,i=n.height),this.width=r,this.height=i}function d(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function f(e,t,n){if(e)if(e.texture){var r=e.texture._texture,i=Math.max(1,r.width),o=Math.max(1,r.height);ne(i===t&&o===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var s=e.renderbuffer._renderbuffer;ne(s.width===t&&s.height===n,"inconsistent width/height for renderbuffer"),s.refCount+=1}}function p(t,n){n&&(n.texture?e.framebufferTexture2D(ui,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(ui,t,hi,n.renderbuffer._renderbuffer.renderbuffer))}function g(e){var t=di,n=null,r=null,i=e;"object"==typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),ne.type(i,"function","invalid attachment data");var o=i._reglType;return"texture2d"===o?(n=i,ne(t===di)):"textureCube"===o?(n=i,ne(t>=fi&&t<fi+6,"invalid cube map target")):"renderbuffer"===o?(r=i,t=hi):ne.raise("invalid regl object for attachment"),new h(t,n,r)}function m(e,t,n,r,s){if(n){var a=i.create2D({width:e,height:t,format:r,type:s});return a._texture.refCount=0,new h(di,a,null)}var l=o.create({width:e,height:t,format:r});return l._renderbuffer.refCount=0,new h(hi,null,l)}function v(e){return e&&(e.texture||e.renderbuffer)}function y(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n),e.width=t,e.height=n)}n.oes_texture_half_float&&u.push("half float","float16"),n.oes_texture_float&&u.push("float","float32");var b=0,x={};function w(){this.id=b++,x[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function C(e){e.colorAttachments.forEach(d),d(e.depthAttachment),d(e.stencilAttachment),d(e.depthStencilAttachment)}function E(t){var n=t.framebuffer;ne(n,"must not double destroy framebuffer"),e.deleteFramebuffer(n),t.framebuffer=null,s.framebufferCount--,delete x[t.id]}function _(t){var n;e.bindFramebuffer(ui,t.framebuffer);var i=t.colorAttachments;for(n=0;n<i.length;++n)p(pi+n,i[n]);for(n=i.length;n<r.maxColorAttachments;++n)e.framebufferTexture2D(ui,pi+n,di,null,0);e.framebufferTexture2D(ui,vi,di,null,0),e.framebufferTexture2D(ui,gi,di,null,0),e.framebufferTexture2D(ui,mi,di,null,0),p(gi,t.depthAttachment),p(mi,t.stencilAttachment),p(vi,t.depthStencilAttachment);var o=e.checkFramebufferStatus(ui);e.isContextLost()||o===yi||ne.raise("framebuffer configuration not supported, status = "+ji[o]),e.bindFramebuffer(ui,a.next?a.next.framebuffer:null),a.cur=a.next,e.getError()}function S(e,i){var o=new w;function h(e,t){var i;ne(a.next!==o,"can not update framebuffer which is currently in use");var s=0,d=0,p=!0,y=!0,b=null,x=!0,w="rgba",E="uint8",S=1,O=null,A=null,k=null,M=!1;if("number"==typeof e)s=0|e,d=0|t||s;else if(e){ne.type(e,"object","invalid arguments for framebuffer");var T=e;if("shape"in T){var P=T.shape;ne(Array.isArray(P)&&P.length>=2,"invalid shape for framebuffer"),s=P[0],d=P[1]}else"radius"in T&&(s=d=T.radius),"width"in T&&(s=T.width),"height"in T&&(d=T.height);("color"in T||"colors"in T)&&(b=T.color||T.colors,Array.isArray(b)&&ne(1===b.length||n.webgl_draw_buffers,"multiple render targets not supported")),b||("colorCount"in T&&(S=0|T.colorCount,ne(S>0,"invalid color buffer count")),"colorTexture"in T&&(x=!!T.colorTexture,w="rgba4"),"colorType"in T&&(E=T.colorType,x?(ne(n.oes_texture_float||!("float"===E||"float32"===E),"you must enable OES_texture_float in order to use floating point framebuffer objects"),ne(n.oes_texture_half_float||!("half float"===E||"float16"===E),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===E||"float16"===E?(ne(n.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),w="rgba16f"):"float"!==E&&"float32"!==E||(ne(n.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),w="rgba32f"),ne.oneOf(E,u,"invalid color type")),"colorFormat"in T&&(w=T.colorFormat,l.indexOf(w)>=0?x=!0:c.indexOf(w)>=0?x=!1:x?ne.oneOf(T.colorFormat,l,"invalid color format for texture"):ne.oneOf(T.colorFormat,c,"invalid color format for renderbuffer"))),("depthTexture"in T||"depthStencilTexture"in T)&&(M=!(!T.depthTexture&&!T.depthStencilTexture),ne(!M||n.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in T&&("boolean"==typeof T.depth?p=T.depth:(O=T.depth,y=!1)),"stencil"in T&&("boolean"==typeof T.stencil?y=T.stencil:(A=T.stencil,p=!1)),"depthStencil"in T&&("boolean"==typeof T.depthStencil?p=y=T.depthStencil:(k=T.depthStencil,p=!1,y=!1))}else s=d=1;var D=null,N=null,R=null,I=null;if(Array.isArray(b))D=b.map(g);else if(b)D=[g(b)];else for(D=new Array(S),i=0;i<S;++i)D[i]=m(s,d,x,w,E);ne(n.webgl_draw_buffers||D.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),ne(D.length<=r.maxColorAttachments,"too many color attachments, not supported"),s=s||D[0].width,d=d||D[0].height,O?N=g(O):p&&!y&&(N=m(s,d,M,"depth","uint32")),A?R=g(A):y&&!p&&(R=m(s,d,!1,"stencil","uint8")),k?I=g(k):!O&&!A&&y&&p&&(I=m(s,d,M,"depth stencil","depth stencil")),ne(!!O+!!A+!!k<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var j=null;for(i=0;i<D.length;++i)if(f(D[i],s,d),ne(!D[i]||D[i].texture&&Mi.indexOf(D[i].texture._texture.format)>=0||D[i].renderbuffer&&Ii.indexOf(D[i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+i+" is invalid"),D[i]&&D[i].texture){var L=Ti[D[i].texture._texture.format]*Pi[D[i].texture._texture.type];null===j?j=L:ne(j===L,"all color attachments much have the same number of bits per pixel.")}return f(N,s,d),ne(!N||N.texture&&N.texture._texture.format===ki||N.renderbuffer&&N.renderbuffer._renderbuffer.format===Di,"invalid depth attachment for framebuffer object"),f(R,s,d),ne(!R||R.renderbuffer&&R.renderbuffer._renderbuffer.format===Ni,"invalid stencil attachment for framebuffer object"),f(I,s,d),ne(!I||I.texture&&I.texture._texture.format===Ri||I.renderbuffer&&I.renderbuffer._renderbuffer.format===Ri,"invalid depth-stencil attachment for framebuffer object"),C(o),o.width=s,o.height=d,o.colorAttachments=D,o.depthAttachment=N,o.stencilAttachment=R,o.depthStencilAttachment=I,h.color=D.map(v),h.depth=v(N),h.stencil=v(R),h.depthStencil=v(I),h.width=o.width,h.height=o.height,_(o),h}function d(e,t){ne(a.next!==o,"can not resize a framebuffer which is currently in use");var n=Math.max(0|e,1),r=Math.max(0|t||n,1);if(n===o.width&&r===o.height)return h;for(var i=o.colorAttachments,s=0;s<i.length;++s)y(i[s],n,r);return y(o.depthAttachment,n,r),y(o.stencilAttachment,n,r),y(o.depthStencilAttachment,n,r),o.width=h.width=n,o.height=h.height=r,_(o),h}return s.framebufferCount++,h(e,i),t(h,{resize:d,_reglType:"framebuffer",_framebuffer:o,destroy:function(){E(o),C(o)},use:function(e){a.setFBO({framebuffer:h},e)}})}function O(e){var o=Array(6);function s(e){var r;ne(o.indexOf(a.next)<0,"can not update framebuffer which is currently in use");var c,h={color:null},d=0,f=null,p="rgba",g="uint8",m=1;if("number"==typeof e)d=0|e;else if(e){ne.type(e,"object","invalid arguments for framebuffer");var v=e;if("shape"in v){var y=v.shape;ne(Array.isArray(y)&&y.length>=2,"invalid shape for framebuffer"),ne(y[0]===y[1],"cube framebuffer must be square"),d=y[0]}else"radius"in v&&(d=0|v.radius),"width"in v?(d=0|v.width,"height"in v&&ne(v.height===d,"must be square")):"height"in v&&(d=0|v.height);("color"in v||"colors"in v)&&(f=v.color||v.colors,Array.isArray(f)&&ne(1===f.length||n.webgl_draw_buffers,"multiple render targets not supported")),f||("colorCount"in v&&(m=0|v.colorCount,ne(m>0,"invalid color buffer count")),"colorType"in v&&(ne.oneOf(v.colorType,u,"invalid color type"),g=v.colorType),"colorFormat"in v&&(p=v.colorFormat,ne.oneOf(v.colorFormat,l,"invalid color format for texture"))),"depth"in v&&(h.depth=v.depth),"stencil"in v&&(h.stencil=v.stencil),"depthStencil"in v&&(h.depthStencil=v.depthStencil)}else d=1;if(f)if(Array.isArray(f))for(c=[],r=0;r<f.length;++r)c[r]=f[r];else c=[f];else{c=Array(m);var b={radius:d,format:p,type:g};for(r=0;r<m;++r)c[r]=i.createCube(b)}for(h.color=Array(c.length),r=0;r<c.length;++r){var x=c[r];ne("function"==typeof x&&"textureCube"===x._reglType,"invalid cube map"),d=d||x.width,ne(x.width===d&&x.height===d,"invalid cube map shape"),h.color[r]={target:fi,data:c[r]}}for(r=0;r<6;++r){for(var w=0;w<c.length;++w)h.color[w].target=fi+r;r>0&&(h.depth=o[0].depth,h.stencil=o[0].stencil,h.depthStencil=o[0].depthStencil),o[r]?o[r](h):o[r]=S(h)}return t(s,{width:d,height:d,color:c})}function c(e){var t,n=0|e;if(ne(n>0&&n<=r.maxCubeMapSize,"invalid radius for cube fbo"),n===s.width)return s;var i=s.color;for(t=0;t<i.length;++t)i[t].resize(n);for(t=0;t<6;++t)o[t].resize(n);return s.width=s.height=n,s}return s(e),t(s,{faces:o,resize:c,_reglType:"framebufferCube",destroy:function(){o.forEach((function(e){e.destroy()}))}})}function A(){a.cur=null,a.next=null,a.dirty=!0,_t(x).forEach((function(t){t.framebuffer=e.createFramebuffer(),_(t)}))}return t(a,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof w)return t}return null},create:S,createCube:O,clear:function(){_t(x).forEach(E)},restore:A})}ji[yi]="complete",ji[bi]="incomplete attachment",ji[wi]="incomplete dimensions",ji[xi]="incomplete, missing attachment",ji[Ci]="unsupported";var Fi=5126,Gi=34962;function Bi(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Fi,this.offset=0,this.stride=0,this.divisor=0}function zi(t,n,r,i,o){for(var s=r.maxAttributes,a=new Array(s),l=0;l<s;++l)a[l]=new Bi;var c=0,u={},h={Record:Bi,scope:{},state:a,currentVAO:null,targetVAO:null,restore:f()?x:function(){},createVAO:w,getVAO:g,destroyBuffer:d,setVAO:f()?m:v,clear:f()?y:function(){}};function d(e){for(var n=0;n<a.length;++n){var r=a[n];r.buffer===e&&(t.disableVertexAttribArray(n),r.buffer=null)}}function f(){return n.oes_vertex_array_object}function p(){return n.angle_instanced_arrays}function g(e){return"function"==typeof e&&e._vao?e._vao:null}function m(e){if(e!==h.currentVAO){var t=f();e?t.bindVertexArrayOES(e.vao):t.bindVertexArrayOES(null),h.currentVAO=e}}function v(e){if(e!==h.currentVAO){if(e)e.bindAttrs();else for(var n=p(),r=0;r<a.length;++r){var i=a[r];i.buffer?(t.enableVertexAttribArray(r),t.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offfset),n&&i.divisor&&n.vertexAttribDivisorANGLE(r,i.divisor)):(t.disableVertexAttribArray(r),t.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}h.currentVAO=e}}function y(){_t(u).forEach((function(e){e.destroy()}))}function b(){this.id=++c,this.attributes=[];var e=f();this.vao=e?e.createVertexArrayOES():null,u[this.id]=this,this.buffers=[]}function x(){f()&&_t(u).forEach((function(e){e.refresh()}))}function w(t){var r=new b;function a(t){ne(Array.isArray(t),"arguments to vertex array constructor must be an array"),ne(t.length<s,"too many attributes"),ne(t.length>0,"must specify at least one attribute");var i={},l=r.attributes;l.length=t.length;for(var c=0;c<t.length;++c){var u,h=t[c],d=l[c]=new Bi,f=h.data||h;Array.isArray(f)||e(f)||Et(f)?(r.buffers[c]&&(u=r.buffers[c],e(f)&&u._buffer.byteLength>=f.byteLength?u.subdata(f):(u.destroy(),r.buffers[c]=null)),r.buffers[c]||(u=r.buffers[c]=o.create(h,Gi,!1,!0)),d.buffer=o.getBuffer(u),d.size=0|d.buffer.dimension,d.normalized=!1,d.type=d.buffer.dtype,d.offset=0,d.stride=0,d.divisor=0,d.state=1,i[c]=1):o.getBuffer(h)?(d.buffer=o.getBuffer(h),d.size=0|d.buffer.dimension,d.normalized=!1,d.type=d.buffer.dtype,d.offset=0,d.stride=0,d.divisor=0,d.state=1):o.getBuffer(h.buffer)?(d.buffer=o.getBuffer(h.buffer),d.size=0|(+h.size||d.buffer.dimension),d.normalized=!!h.normalized||!1,"type"in h?(ne.parameter(h.type,Nt,"invalid buffer type"),d.type=Nt[h.type]):d.type=d.buffer.dtype,d.offset=0|(h.offset||0),d.stride=0|(h.stride||0),d.divisor=0|(h.divisor||0),d.state=1,ne(d.size>=1&&d.size<=4,"size must be between 1 and 4"),ne(d.offset>=0,"invalid offset"),ne(d.stride>=0&&d.stride<=255,"stride must be between 0 and 255"),ne(d.divisor>=0,"divisor must be positive"),ne(!d.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in h?(ne(c>0,"first attribute must not be a constant"),d.x=+h.x||0,d.y=+h.y||0,d.z=+h.z||0,d.w=+h.w||0,d.state=2):ne(!1,"invalid attribute spec for location "+c)}for(var p=0;p<r.buffers.length;++p)!i[p]&&r.buffers[p]&&(r.buffers[p].destroy(),r.buffers[p]=null);return r.refresh(),a}return i.vaoCount+=1,a.destroy=function(){for(var e=0;e<r.buffers.length;++e)r.buffers[e]&&r.buffers[e].destroy();r.buffers.length=0,r.destroy()},a._vao=r,a._reglType="vao",a(t)}return b.prototype.bindAttrs=function(){for(var e=p(),n=this.attributes,r=0;r<n.length;++r){var i=n[r];i.buffer?(t.enableVertexAttribArray(r),t.bindBuffer(Gi,i.buffer.buffer),t.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offset),e&&i.divisor&&e.vertexAttribDivisorANGLE(r,i.divisor)):(t.disableVertexAttribArray(r),t.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}for(var o=n.length;o<s;++o)t.disableVertexAttribArray(o)},b.prototype.refresh=function(){var e=f();e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),h.currentVAO=this)},b.prototype.destroy=function(){if(this.vao){var e=f();this===h.currentVAO&&(h.currentVAO=null,e.bindVertexArrayOES(null)),e.deleteVertexArrayOES(this.vao),this.vao=null}u[this.id]&&(delete u[this.id],i.vaoCount-=1)},h}var Ui=35632,Vi=35633,Hi=35718,Wi=35721;function $i(e,n,r,i){var o={},s={};function a(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function l(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function c(t,r,i){var a=t===Ui?o:s,l=a[r];if(!l){var c=n.str(r);l=e.createShader(t),e.shaderSource(l,c),e.compileShader(l),ne.shaderError(e,l,c,t,i),a[r]=l}return l}var u={},h=[],d=0;function f(e,t){this.id=d++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,i.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function p(t,r,o){var s,u,h=c(Ui,t.fragId),d=c(Vi,t.vertId),f=t.program=e.createProgram();if(e.attachShader(f,h),e.attachShader(f,d),o)for(s=0;s<o.length;++s){var p=o[s];e.bindAttribLocation(f,p[0],p[1])}e.linkProgram(f),ne.linkError(e,f,n.str(t.fragId),n.str(t.vertId),r);var g=e.getProgramParameter(f,Hi);i.profile&&(t.stats.uniformsCount=g);var m=t.uniforms;for(s=0;s<g;++s)if(u=e.getActiveUniform(f,s))if(u.size>1)for(var v=0;v<u.size;++v){var y=u.name.replace("[0]","["+v+"]");l(m,new a(y,n.id(y),e.getUniformLocation(f,y),u))}else l(m,new a(u.name,n.id(u.name),e.getUniformLocation(f,u.name),u));var b=e.getProgramParameter(f,Wi);i.profile&&(t.stats.attributesCount=b);var x=t.attributes;for(s=0;s<b;++s)(u=e.getActiveAttrib(f,s))&&l(x,new a(u.name,n.id(u.name),e.getAttribLocation(f,u.name),u))}function g(){o={},s={};for(var e=0;e<h.length;++e)p(h[e],null,h[e].attributes.map((function(e){return[e.location,e.name]})))}return i.profile&&(r.getMaxUniformsCount=function(){var e=0;return h.forEach((function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)})),e},r.getMaxAttributesCount=function(){var e=0;return h.forEach((function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)})),e}),{clear:function(){var t=e.deleteShader.bind(e);_t(o).forEach(t),o={},_t(s).forEach(t),s={},h.forEach((function(t){e.deleteProgram(t.program)})),h.length=0,u={},r.shaderCount=0},program:function(n,i,a,l){ne.command(n>=0,"missing vertex shader",a),ne.command(i>=0,"missing fragment shader",a);var c=u[i];c||(c=u[i]={});var d=c[n];if(d&&(d.refCount++,!l))return d;var g=new f(i,n);return r.shaderCount++,p(g,a,l),d||(c[n]=g),h.push(g),t(g,{destroy:function(){if(g.refCount--,g.refCount<=0){e.deleteProgram(g.program);var t=h.indexOf(g);h.splice(t,1),r.shaderCount--}c[g.vertId].refCount<=0&&(e.deleteShader(s[g.vertId]),delete s[g.vertId],delete u[g.fragId][g.vertId]),Object.keys(u[g.fragId]).length||(e.deleteShader(o[g.fragId]),delete o[g.fragId],delete u[g.fragId])}})},restore:g,shader:c,frag:-1,vert:-1}}var Xi=6408,Yi=5121,qi=3333,Ki=5126;function Zi(t,n,r,i,o,s,a){function l(l){var c;null===n.next?(ne(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),c=Yi):(ne(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),c=n.next.colorAttachments[0].texture._texture.type,s.oes_texture_float?(ne(c===Yi||c===Ki,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),c===Ki&&ne(a.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):ne(c===Yi,"Reading from a framebuffer is only allowed for the type 'uint8'"));var u=0,h=0,d=i.framebufferWidth,f=i.framebufferHeight,p=null;e(l)?p=l:l&&(ne.type(l,"object","invalid arguments to regl.read()"),u=0|l.x,h=0|l.y,ne(u>=0&&u<i.framebufferWidth,"invalid x offset for regl.read"),ne(h>=0&&h<i.framebufferHeight,"invalid y offset for regl.read"),d=0|(l.width||i.framebufferWidth-u),f=0|(l.height||i.framebufferHeight-h),p=l.data||null),p&&(c===Yi?ne(p instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):c===Ki&&ne(p instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),ne(d>0&&d+u<=i.framebufferWidth,"invalid width for read pixels"),ne(f>0&&f+h<=i.framebufferHeight,"invalid height for read pixels"),r();var g=d*f*4;return p||(c===Yi?p=new Uint8Array(g):c===Ki&&(p=p||new Float32Array(g))),ne.isTypedArray(p,"data buffer for regl.read() must be a typedarray"),ne(p.byteLength>=g,"data buffer for regl.read() too small"),t.pixelStorei(qi,4),t.readPixels(u,h,d,f,Xi,c,p),p}function c(e){var t;return n.setFBO({framebuffer:e.framebuffer},(function(){t=l(e)})),t}function u(e){return e&&"framebuffer"in e?c(e):l(e)}return u}function Ji(e){return Array.prototype.slice.call(e)}function Qi(e){return Ji(e).join("")}function eo(){var e=0,n=[],r=[];function i(t){for(var i=0;i<r.length;++i)if(r[i]===t)return n[i];var o="g"+e++;return n.push(o),r.push(t),o}function o(){var n=[];function r(){n.push.apply(n,Ji(arguments))}var i=[];function o(){var t="v"+e++;return i.push(t),arguments.length>0&&(n.push(t,"="),n.push.apply(n,Ji(arguments)),n.push(";")),t}return t(r,{def:o,toString:function(){return Qi([i.length>0?"var "+i.join(",")+";":"",Qi(n)])}})}function s(){var e=o(),n=o(),r=e.toString,i=n.toString;function s(t,r){n(t,r,"=",e.def(t,r),";")}return t((function(){e.apply(e,Ji(arguments))}),{def:e.def,entry:e,exit:n,save:s,set:function(t,n,r){s(t,n),e(t,n,"=",r,";")},toString:function(){return r()+i()}})}function a(){var e=Qi(arguments),n=s(),r=s(),i=n.toString,o=r.toString;return t(n,{then:function(){return n.apply(n,Ji(arguments)),this},else:function(){return r.apply(r,Ji(arguments)),this},toString:function(){var t=o();return t&&(t="else{"+t+"}"),Qi(["if(",e,"){",i(),"}",t])}})}var l=o(),c={};function u(e,n){var r=[];function i(){var e="a"+r.length;return r.push(e),e}n=n||0;for(var o=0;o<n;++o)i();var a=s(),l=a.toString;return c[e]=t(a,{arg:i,toString:function(){return Qi(["function(",r.join(),"){",l(),"}"])}})}function h(){var e=['"use strict";',l,"return {"];Object.keys(c).forEach((function(t){e.push('"',t,'":',c[t].toString(),",")})),e.push("}");var t=Qi(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(t)).apply(null,r)}return{global:l,link:i,block:o,proc:u,scope:s,cond:a,compile:h}}var to="xyzw".split(""),no=5121,ro=1,io=2,oo=0,so=1,ao=2,lo=3,co=4,uo=5,ho=6,fo="dither",po="blend.enable",go="blend.color",mo="blend.equation",vo="blend.func",yo="depth.enable",bo="depth.func",xo="depth.range",wo="depth.mask",Co="colorMask",Eo="cull.enable",_o="cull.face",So="frontFace",Oo="lineWidth",Ao="polygonOffset.enable",ko="polygonOffset.offset",Mo="sample.alpha",To="sample.enable",Po="sample.coverage",Do="stencil.enable",No="stencil.mask",Ro="stencil.func",Io="stencil.opFront",jo="stencil.opBack",Lo="scissor.enable",Fo="scissor.box",Go="viewport",Bo="profile",zo="framebuffer",Uo="vert",Vo="frag",Ho="elements",Wo="primitive",$o="count",Xo="offset",Yo="instances",qo="vao",Ko="Width",Zo="Height",Jo=zo+Ko,Qo=zo+Zo,es=Go+Ko,ts=Go+Zo,ns="drawingBuffer",rs=ns+Ko,is=ns+Zo,os=[vo,mo,Ro,Io,jo,Po,Go,Fo,ko],ss=34962,as=34963,ls=3553,cs=34067,us=2884,hs=3042,ds=3024,fs=2960,ps=2929,gs=3089,ms=32823,vs=32926,ys=32928,bs=5126,xs=35664,ws=35665,Cs=35666,Es=5124,_s=35667,Ss=35668,Os=35669,As=35670,ks=35671,Ms=35672,Ts=35673,Ps=35674,Ds=35675,Ns=35676,Rs=35678,Is=35680,js=4,Ls=1028,Fs=1029,Gs=2304,Bs=2305,zs=32775,Us=32776,Vs=519,Hs=7680,Ws=0,$s=1,Xs=32774,Ys=513,qs=36160,Ks=36064,Zs={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Js=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Qs={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ea={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ta={frag:35632,vert:35633},na={cw:Gs,ccw:Bs};function ra(t){return Array.isArray(t)||e(t)||Et(t)}function ia(e){return e.sort((function(e,t){return e===Go?-1:t===Go?1:e<t?-1:1}))}function oa(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function sa(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function aa(e){return new oa(!1,!1,!1,e)}function la(e,t){var n=e.type;if(n===oo){var r=e.data.length;return new oa(!0,r>=1,r>=2,t)}if(n===co){var i=e.data;return new oa(i.thisDep,i.contextDep,i.propDep,t)}if(n===uo)return new oa(!1,!1,!1,t);if(n===ho){for(var o=!1,s=!1,a=!1,l=0;l<e.data.length;++l){var c=e.data[l];if(c.type===so)a=!0;else if(c.type===ao)s=!0;else if(c.type===lo)o=!0;else if(c.type===oo){o=!0;var u=c.data;u>=1&&(s=!0),u>=2&&(a=!0)}else c.type===co&&(o=o||c.data.thisDep,s=s||c.data.contextDep,a=a||c.data.propDep)}return new oa(o,s,a,t)}return new oa(n===lo,n===ao,n===so,t)}var ca=new oa(!1,!1,!1,(function(){}));function ua(e,n,r,i,o,s,a,l,c,u,h,d,f,p,g){var m=u.Record,v={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(v.min=zs,v.max=Us);var y=r.angle_instanced_arrays,b=r.webgl_draw_buffers,x={dirty:!0,profile:g.profile},w={},C=[],E={},_={};function S(e){return e.replace(".","_")}function O(e,t,n){var r=S(e);C.push(e),w[r]=x[r]=!!n,E[r]=t}function A(e,t,n){var r=S(e);C.push(e),Array.isArray(n)?(x[r]=n.slice(),w[r]=n.slice()):x[r]=w[r]=n,_[r]=t}O(fo,ds),O(po,hs),A(go,"blendColor",[0,0,0,0]),A(mo,"blendEquationSeparate",[Xs,Xs]),A(vo,"blendFuncSeparate",[$s,Ws,$s,Ws]),O(yo,ps,!0),A(bo,"depthFunc",Ys),A(xo,"depthRange",[0,1]),A(wo,"depthMask",!0),A(Co,Co,[!0,!0,!0,!0]),O(Eo,us),A(_o,"cullFace",Fs),A(So,So,Bs),A(Oo,Oo,1),O(Ao,ms),A(ko,"polygonOffset",[0,0]),O(Mo,vs),O(To,ys),A(Po,"sampleCoverage",[1,!1]),O(Do,fs),A(No,"stencilMask",-1),A(Ro,"stencilFunc",[Vs,0,-1]),A(Io,"stencilOpSeparate",[Ls,Hs,Hs,Hs]),A(jo,"stencilOpSeparate",[Fs,Hs,Hs,Hs]),O(Lo,gs),A(Fo,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),A(Go,Go,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var k={gl:e,context:f,strings:n,next:w,current:x,draw:d,elements:s,buffer:o,shader:h,attributes:u.state,vao:u,uniforms:c,framebuffer:l,extensions:r,timer:p,isBufferArgs:ra},M={primTypes:$t,compareFuncs:Qs,blendFuncs:Zs,blendEquations:v,stencilOps:ea,glTypes:Nt,orientationType:na};ne.optional((function(){k.isArrayLike=hn})),b&&(M.backBuffer=[Fs],M.drawBuffer=Oe(i.maxDrawbuffers,(function(e){return 0===e?[0]:Oe(e,(function(e){return Ks+e}))})));var T=0;function P(){var e=eo(),t=e.link,r=e.global;e.id=T++,e.batchId="0";var i=t(k),o=e.shared={props:"a0"};Object.keys(k).forEach((function(e){o[e]=r.def(i,".",e)})),ne.optional((function(){e.CHECK=t(ne),e.commandStr=ne.guessCommand(),e.command=t(e.commandStr),e.assert=function(e,n,r){e("if(!(",n,"))",this.CHECK,".commandRaise(",t(r),",",this.command,");")},M.invalidBlendCombinations=Js}));var s=e.next={},a=e.current={};Object.keys(_).forEach((function(e){Array.isArray(x[e])&&(s[e]=r.def(o.next,".",e),a[e]=r.def(o.current,".",e))}));var l=e.constants={};Object.keys(M).forEach((function(e){l[e]=r.def(JSON.stringify(M[e]))})),e.invoke=function(n,r){switch(r.type){case oo:var i=["this",o.context,o.props,e.batchId];return n.def(t(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case so:return n.def(o.props,r.data);case ao:return n.def(o.context,r.data);case lo:return n.def("this",r.data);case co:return r.data.append(e,n),r.data.ref;case uo:return r.data.toString();case ho:return r.data.map((function(t){return e.invoke(n,t)}))}},e.attribCache={};var c={};return e.scopeAttrib=function(e){var r=n.id(e);if(r in c)return c[r];var i=u.scope[r];return i||(i=u.scope[r]=new m),c[r]=t(i)},e}function D(e){var t,n=e.static,r=e.dynamic;if(Bo in n){var i=!!n[Bo];(t=aa((function(e,t){return i}))).enable=i}else if(Bo in r){var o=r[Bo];t=la(o,(function(e,t){return e.invoke(t,o)}))}return t}function N(e,t){var n=e.static,r=e.dynamic;if(zo in n){var i=n[zo];return i?(i=l.getFramebuffer(i),ne.command(i,"invalid framebuffer object"),aa((function(e,t){var n=e.link(i),r=e.shared;t.set(r.framebuffer,".next",n);var o=r.context;return t.set(o,"."+Jo,n+".width"),t.set(o,"."+Qo,n+".height"),n}))):aa((function(e,t){var n=e.shared;t.set(n.framebuffer,".next","null");var r=n.context;return t.set(r,"."+Jo,r+"."+rs),t.set(r,"."+Qo,r+"."+is),"null"}))}if(zo in r){var o=r[zo];return la(o,(function(e,t){var n=e.invoke(t,o),r=e.shared,i=r.framebuffer,s=t.def(i,".getFramebuffer(",n,")");ne.optional((function(){e.assert(t,"!"+n+"||"+s,"invalid framebuffer object")})),t.set(i,".next",s);var a=r.context;return t.set(a,"."+Jo,s+"?"+s+".width:"+a+"."+rs),t.set(a,"."+Qo,s+"?"+s+".height:"+a+"."+is),s}))}return null}function R(e,t,n){var r=e.static,i=e.dynamic;function o(e){if(e in r){var o=r[e];ne.commandType(o,"object","invalid "+e,n.commandStr);var s,a,l=!0,c=0|o.x,u=0|o.y;return"width"in o?(s=0|o.width,ne.command(s>=0,"invalid "+e,n.commandStr)):l=!1,"height"in o?(a=0|o.height,ne.command(a>=0,"invalid "+e,n.commandStr)):l=!1,new oa(!l&&t&&t.thisDep,!l&&t&&t.contextDep,!l&&t&&t.propDep,(function(e,t){var n=e.shared.context,r=s;"width"in o||(r=t.def(n,".",Jo,"-",c));var i=a;return"height"in o||(i=t.def(n,".",Qo,"-",u)),[c,u,r,i]}))}if(e in i){var h=i[e],d=la(h,(function(t,n){var r=t.invoke(n,h);ne.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}));var i=t.shared.context,o=n.def(r,".x|0"),s=n.def(r,".y|0"),a=n.def('"width" in ',r,"?",r,".width|0:","(",i,".",Jo,"-",o,")"),l=n.def('"height" in ',r,"?",r,".height|0:","(",i,".",Qo,"-",s,")");return ne.optional((function(){t.assert(n,a+">=0&&"+l+">=0","invalid "+e)})),[o,s,a,l]}));return t&&(d.thisDep=d.thisDep||t.thisDep,d.contextDep=d.contextDep||t.contextDep,d.propDep=d.propDep||t.propDep),d}return t?new oa(t.thisDep,t.contextDep,t.propDep,(function(e,t){var n=e.shared.context;return[0,0,t.def(n,".",Jo),t.def(n,".",Qo)]})):null}var s=o(Go);if(s){var a=s;s=new oa(s.thisDep,s.contextDep,s.propDep,(function(e,t){var n=a.append(e,t),r=e.shared.context;return t.set(r,"."+es,n[2]),t.set(r,"."+ts,n[3]),n}))}return{viewport:s,scissor_box:o(Fo)}}function I(e,t){var n=e.static;if("string"==typeof n[Vo]&&"string"==typeof n[Uo]){if(Object.keys(t.dynamic).length>0)return null;var r=t.static,i=Object.keys(r);if(i.length>0&&"number"==typeof r[i[0]]){for(var o=[],s=0;s<i.length;++s)ne("number"==typeof r[i[s]],"must specify all vertex attribute locations when using vaos"),o.push([0|r[i[s]],i[s]]);return o}}return null}function j(e,t,r){var i=e.static,o=e.dynamic;function s(e){if(e in i){var t=n.id(i[e]);ne.optional((function(){h.shader(ta[e],t,ne.guessCommand())}));var r=aa((function(){return t}));return r.id=t,r}if(e in o){var s=o[e];return la(s,(function(t,n){var r=t.invoke(n,s),i=n.def(t.shared.strings,".id(",r,")");return ne.optional((function(){n(t.shared.shader,".shader(",ta[e],",",i,",",t.command,");")})),i}))}return null}var a,l=s(Vo),c=s(Uo),u=null;return sa(l)&&sa(c)?(u=h.program(c.id,l.id,null,r),a=aa((function(e,t){return e.link(u)}))):a=new oa(l&&l.thisDep||c&&c.thisDep,l&&l.contextDep||c&&c.contextDep,l&&l.propDep||c&&c.propDep,(function(e,t){var n,r=e.shared.shader;n=l?l.append(e,t):t.def(r,".",Vo);var i=r+".program("+(c?c.append(e,t):t.def(r,".",Uo))+","+n;return ne.optional((function(){i+=","+e.command})),t.def(i+")")})),{frag:l,vert:c,progVar:a,program:u}}function L(e,t){var n=e.static,r=e.dynamic;function i(){if(Ho in n){var e=n[Ho];ra(e)?e=s.getElements(s.create(e,!0)):e&&(e=s.getElements(e),ne.command(e,"invalid elements",t.commandStr));var i=aa((function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r,r}return t.ELEMENTS=null,null}));return i.value=e,i}if(Ho in r){var o=r[Ho];return la(o,(function(e,t){var n=e.shared,r=n.isBufferArgs,i=n.elements,s=e.invoke(t,o),a=t.def("null"),l=t.def(r,"(",s,")"),c=e.cond(l).then(a,"=",i,".createStream(",s,");").else(a,"=",i,".getElements(",s,");");return ne.optional((function(){e.assert(c.else,"!"+s+"||"+a,"invalid elements")})),t.entry(c),t.exit(e.cond(l).then(i,".destroyStream(",a,");")),e.ELEMENTS=a,a}))}return null}var o=i();function a(){if(Wo in n){var e=n[Wo];return ne.commandParameter(e,$t,"invalid primitve",t.commandStr),aa((function(t,n){return $t[e]}))}if(Wo in r){var i=r[Wo];return la(i,(function(e,t){var n=e.constants.primTypes,r=e.invoke(t,i);return ne.optional((function(){e.assert(t,r+" in "+n,"invalid primitive, must be one of "+Object.keys($t))})),t.def(n,"[",r,"]")}))}return o?sa(o)?o.value?aa((function(e,t){return t.def(e.ELEMENTS,".primType")})):aa((function(){return js})):new oa(o.thisDep,o.contextDep,o.propDep,(function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",js)})):null}function l(e,i){if(e in n){var s=0|n[e];return ne.command(!i||s>=0,"invalid "+e,t.commandStr),aa((function(e,t){return i&&(e.OFFSET=s),s}))}if(e in r){var a=r[e];return la(a,(function(t,n){var r=t.invoke(n,a);return i&&(t.OFFSET=r,ne.optional((function(){t.assert(n,r+">=0","invalid "+e)}))),r}))}return i&&o?aa((function(e,t){return e.OFFSET="0",0})):null}var c=l(Xo,!0);function u(){if($o in n){var e=0|n[$o];return ne.command("number"==typeof e&&e>=0,"invalid vertex count",t.commandStr),aa((function(){return e}))}if($o in r){var i=r[$o];return la(i,(function(e,t){var n=e.invoke(t,i);return ne.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(o){if(sa(o)){if(o)return c?new oa(c.thisDep,c.contextDep,c.propDep,(function(e,t){var n=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return ne.optional((function(){e.assert(t,n+">=0","invalid vertex offset/element buffer too small")})),n})):aa((function(e,t){return t.def(e.ELEMENTS,".vertCount")}));var s=aa((function(){return-1}));return ne.optional((function(){s.MISSING=!0})),s}var a=new oa(o.thisDep||c.thisDep,o.contextDep||c.contextDep,o.propDep||c.propDep,(function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}));return ne.optional((function(){a.DYNAMIC=!0})),a}return null}return{elements:o,primitive:a(),count:u(),instances:l(Yo,!1),offset:c}}function F(e,t){var n=e.static,r=e.dynamic,o={};return C.forEach((function(e){var s=S(e);function a(t,i){if(e in n){var a=t(n[e]);o[s]=aa((function(){return a}))}else if(e in r){var l=r[e];o[s]=la(l,(function(e,t){return i(e,t,e.invoke(t,l))}))}}switch(e){case Eo:case po:case fo:case Do:case yo:case Lo:case Ao:case Mo:case To:case wo:return a((function(n){return ne.commandType(n,"boolean",e,t.commandStr),n}),(function(t,n,r){return ne.optional((function(){t.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+e,t.commandStr)})),r}));case bo:return a((function(n){return ne.commandParameter(n,Qs,"invalid "+e,t.commandStr),Qs[n]}),(function(t,n,r){var i=t.constants.compareFuncs;return ne.optional((function(){t.assert(n,r+" in "+i,"invalid "+e+", must be one of "+Object.keys(Qs))})),n.def(i,"[",r,"]")}));case xo:return a((function(e){return ne.command(hn(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e}),(function(e,t,n){return ne.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")})),[t.def("+",n,"[0]"),t.def("+",n,"[1]")]}));case vo:return a((function(e){ne.commandType(e,"object","blend.func",t.commandStr);var n="srcRGB"in e?e.srcRGB:e.src,r="srcAlpha"in e?e.srcAlpha:e.src,i="dstRGB"in e?e.dstRGB:e.dst,o="dstAlpha"in e?e.dstAlpha:e.dst;return ne.commandParameter(n,Zs,s+".srcRGB",t.commandStr),ne.commandParameter(r,Zs,s+".srcAlpha",t.commandStr),ne.commandParameter(i,Zs,s+".dstRGB",t.commandStr),ne.commandParameter(o,Zs,s+".dstAlpha",t.commandStr),ne.command(-1===Js.indexOf(n+", "+i),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+i+")",t.commandStr),[Zs[n],Zs[i],Zs[r],Zs[o]]}),(function(t,n,r){var i=t.constants.blendFuncs;function o(o,s){var a=n.def('"',o,s,'" in ',r,"?",r,".",o,s,":",r,".",o);return ne.optional((function(){t.assert(n,a+" in "+i,"invalid "+e+"."+o+s+", must be one of "+Object.keys(Zs))})),a}ne.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")}));var s=o("src","RGB"),a=o("dst","RGB");ne.optional((function(){var e=t.constants.invalidBlendCombinations;t.assert(n,e+".indexOf("+s+'+", "+'+a+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var l=n.def(i,"[",s,"]"),c=n.def(i,"[",o("src","Alpha"),"]");return[l,n.def(i,"[",a,"]"),c,n.def(i,"[",o("dst","Alpha"),"]")]}));case mo:return a((function(n){return"string"==typeof n?(ne.commandParameter(n,v,"invalid "+e,t.commandStr),[v[n],v[n]]):"object"==typeof n?(ne.commandParameter(n.rgb,v,e+".rgb",t.commandStr),ne.commandParameter(n.alpha,v,e+".alpha",t.commandStr),[v[n.rgb],v[n.alpha]]):void ne.commandRaise("invalid blend.equation",t.commandStr)}),(function(t,n,r){var i=t.constants.blendEquations,o=n.def(),s=n.def(),a=t.cond("typeof ",r,'==="string"');return ne.optional((function(){function n(e,n,r){t.assert(e,r+" in "+i,"invalid "+n+", must be one of "+Object.keys(v))}n(a.then,e,r),t.assert(a.else,r+"&&typeof "+r+'==="object"',"invalid "+e),n(a.else,e+".rgb",r+".rgb"),n(a.else,e+".alpha",r+".alpha")})),a.then(o,"=",s,"=",i,"[",r,"];"),a.else(o,"=",i,"[",r,".rgb];",s,"=",i,"[",r,".alpha];"),n(a),[o,s]}));case go:return a((function(e){return ne.command(hn(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),Oe(4,(function(t){return+e[t]}))}),(function(e,t,n){return ne.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),Oe(4,(function(e){return t.def("+",n,"[",e,"]")}))}));case No:return a((function(e){return ne.commandType(e,"number",s,t.commandStr),0|e}),(function(e,t,n){return ne.optional((function(){e.assert(t,"typeof "+n+'==="number"',"invalid stencil.mask")})),t.def(n,"|0")}));case Ro:return a((function(n){ne.commandType(n,"object",s,t.commandStr);var r=n.cmp||"keep",i=n.ref||0,o="mask"in n?n.mask:-1;return ne.commandParameter(r,Qs,e+".cmp",t.commandStr),ne.commandType(i,"number",e+".ref",t.commandStr),ne.commandType(o,"number",e+".mask",t.commandStr),[Qs[r],i,o]}),(function(e,t,n){var r=e.constants.compareFuncs;return ne.optional((function(){function i(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}i(n+"&&typeof ",n,'==="object"'),i('!("cmp" in ',n,")||(",n,".cmp in ",r,")")})),[t.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",Hs),t.def(n,".ref|0"),t.def('"mask" in ',n,"?",n,".mask|0:-1")]}));case Io:case jo:return a((function(n){ne.commandType(n,"object",s,t.commandStr);var r=n.fail||"keep",i=n.zfail||"keep",o=n.zpass||"keep";return ne.commandParameter(r,ea,e+".fail",t.commandStr),ne.commandParameter(i,ea,e+".zfail",t.commandStr),ne.commandParameter(o,ea,e+".zpass",t.commandStr),[e===jo?Fs:Ls,ea[r],ea[i],ea[o]]}),(function(t,n,r){var i=t.constants.stencilOps;function o(o){return ne.optional((function(){t.assert(n,'!("'+o+'" in '+r+")||("+r+"."+o+" in "+i+")","invalid "+e+"."+o+", must be one of "+Object.keys(ea))})),n.def('"',o,'" in ',r,"?",i,"[",r,".",o,"]:",Hs)}return ne.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)})),[e===jo?Fs:Ls,o("fail"),o("zfail"),o("zpass")]}));case ko:return a((function(e){ne.commandType(e,"object",s,t.commandStr);var n=0|e.factor,r=0|e.units;return ne.commandType(n,"number",s+".factor",t.commandStr),ne.commandType(r,"number",s+".units",t.commandStr),[n,r]}),(function(t,n,r){return ne.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)})),[n.def(r,".factor|0"),n.def(r,".units|0")]}));case _o:return a((function(e){var n=0;return"front"===e?n=Ls:"back"===e&&(n=Fs),ne.command(!!n,s,t.commandStr),n}),(function(e,t,n){return ne.optional((function(){e.assert(t,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),t.def(n,'==="front"?',Ls,":",Fs)}));case Oo:return a((function(e){return ne.command("number"==typeof e&&e>=i.lineWidthDims[0]&&e<=i.lineWidthDims[1],"invalid line width, must be a positive number between "+i.lineWidthDims[0]+" and "+i.lineWidthDims[1],t.commandStr),e}),(function(e,t,n){return ne.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">="+i.lineWidthDims[0]+"&&"+n+"<="+i.lineWidthDims[1],"invalid line width")})),n}));case So:return a((function(e){return ne.commandParameter(e,na,s,t.commandStr),na[e]}),(function(e,t,n){return ne.optional((function(){e.assert(t,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),t.def(n+'==="cw"?'+Gs+":"+Bs)}));case Co:return a((function(e){return ne.command(hn(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map((function(e){return!!e}))}),(function(e,t,n){return ne.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),Oe(4,(function(e){return"!!"+n+"["+e+"]"}))}));case Po:return a((function(e){ne.command("object"==typeof e&&e,s,t.commandStr);var n="value"in e?e.value:1,r=!!e.invert;return ne.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[n,r]}),(function(e,t,n){return ne.optional((function(){e.assert(t,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")})),[t.def('"value" in ',n,"?+",n,".value:1"),t.def("!!",n,".invert")]}))}})),o}function G(e,t){var n=e.static,r=e.dynamic,i={};return Object.keys(n).forEach((function(e){var r,o=n[e];if("number"==typeof o||"boolean"==typeof o)r=aa((function(){return o}));else if("function"==typeof o){var s=o._reglType;"texture2d"===s||"textureCube"===s?r=aa((function(e){return e.link(o)})):"framebuffer"===s||"framebufferCube"===s?(ne.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"',t.commandStr),r=aa((function(e){return e.link(o.color[0])}))):ne.commandRaise('invalid data for uniform "'+e+'"',t.commandStr)}else hn(o)?r=aa((function(t){var n=t.global.def("[",Oe(o.length,(function(n){return ne.command("number"==typeof o[n]||"boolean"==typeof o[n],"invalid uniform "+e,t.commandStr),o[n]})),"]");return n})):ne.commandRaise('invalid or missing data for uniform "'+e+'"',t.commandStr);r.value=o,i[e]=r})),Object.keys(r).forEach((function(e){var t=r[e];i[e]=la(t,(function(e,n){return e.invoke(n,t)}))})),i}function B(e,t){var r=e.static,i=e.dynamic,s={};return Object.keys(r).forEach((function(e){var i=r[e],a=n.id(e),l=new m;if(ra(i))l.state=ro,l.buffer=o.getBuffer(o.create(i,ss,!1,!0)),l.type=0;else{var c=o.getBuffer(i);if(c)l.state=ro,l.buffer=c,l.type=0;else if(ne.command("object"==typeof i&&i,"invalid data for attribute "+e,t.commandStr),"constant"in i){var u=i.constant;l.buffer="null",l.state=io,"number"==typeof u?l.x=u:(ne.command(hn(u)&&u.length>0&&u.length<=4,"invalid constant for attribute "+e,t.commandStr),to.forEach((function(e,t){t<u.length&&(l[e]=u[t])})))}else{c=ra(i.buffer)?o.getBuffer(o.create(i.buffer,ss,!1,!0)):o.getBuffer(i.buffer),ne.command(!!c,'missing buffer for attribute "'+e+'"',t.commandStr);var h=0|i.offset;ne.command(h>=0,'invalid offset for attribute "'+e+'"',t.commandStr);var d=0|i.stride;ne.command(d>=0&&d<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]',t.commandStr);var f=0|i.size;ne.command(!("size"in i)||f>0&&f<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4',t.commandStr);var p=!!i.normalized,g=0;"type"in i&&(ne.commandParameter(i.type,Nt,"invalid type for attribute "+e,t.commandStr),g=Nt[i.type]);var v=0|i.divisor;"divisor"in i&&(ne.command(0===v||y,'cannot specify divisor for attribute "'+e+'", instancing not supported',t.commandStr),ne.command(v>=0,'invalid divisor for attribute "'+e+'"',t.commandStr)),ne.optional((function(){var n=t.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(i).forEach((function(t){ne.command(r.indexOf(t)>=0,'unknown parameter "'+t+'" for attribute pointer "'+e+'" (valid parameters are '+r+")",n)}))})),l.buffer=c,l.state=ro,l.size=f,l.normalized=p,l.type=g||c.dtype,l.offset=h,l.stride=d,l.divisor=v}}s[e]=aa((function(e,t){var n=e.attribCache;if(a in n)return n[a];var r={isStream:!1};return Object.keys(l).forEach((function(e){r[e]=l[e]})),l.buffer&&(r.buffer=e.link(l.buffer),r.type=r.type||r.buffer+".dtype"),n[a]=r,r}))})),Object.keys(i).forEach((function(e){var t=i[e];function n(n,r){var i=n.invoke(r,t),o=n.shared,s=n.constants,a=o.isBufferArgs,l=o.buffer;ne.optional((function(){n.assert(r,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+a+"("+i+")||"+l+".getBuffer("+i+")||"+l+".getBuffer("+i+".buffer)||"+a+"("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+o.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+e+'"')}));var c={isStream:r.def(!1)},u=new m;u.state=ro,Object.keys(u).forEach((function(e){c[e]=r.def(""+u[e])}));var h=c.buffer,d=c.type;function f(e){r(c[e],"=",i,".",e,"|0;")}return r("if(",a,"(",i,")){",c.isStream,"=true;",h,"=",l,".createStream(",ss,",",i,");",d,"=",h,".dtype;","}else{",h,"=",l,".getBuffer(",i,");","if(",h,"){",d,"=",h,".dtype;",'}else if("constant" in ',i,"){",c.state,"=",io,";","if(typeof "+i+'.constant === "number"){',c[to[0]],"=",i,".constant;",to.slice(1).map((function(e){return c[e]})).join("="),"=0;","}else{",to.map((function(e,t){return c[e]+"="+i+".constant.length>"+t+"?"+i+".constant["+t+"]:0;"})).join(""),"}}else{","if(",a,"(",i,".buffer)){",h,"=",l,".createStream(",ss,",",i,".buffer);","}else{",h,"=",l,".getBuffer(",i,".buffer);","}",d,'="type" in ',i,"?",s.glTypes,"[",i,".type]:",h,".dtype;",c.normalized,"=!!",i,".normalized;"),f("size"),f("offset"),f("stride"),f("divisor"),r("}}"),r.exit("if(",c.isStream,"){",l,".destroyStream(",h,");","}"),c}s[e]=la(t,n)})),s}function z(e,t){var n=e.static,r=e.dynamic;if(qo in n){var i=n[qo];return null!==i&&null===u.getVAO(i)&&(i=u.createVAO(i)),aa((function(e){return e.link(u.getVAO(i))}))}if(qo in r){var o=r[qo];return la(o,(function(e,t){var n=e.invoke(t,o);return t.def(e.shared.vao+".getVAO("+n+")")}))}return null}function U(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach((function(e){var n=t[e];r[e]=aa((function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)}))})),Object.keys(n).forEach((function(e){var t=n[e];r[e]=la(t,(function(e,n){return e.invoke(n,t)}))})),r}function V(e,t,n,i,o){var s=e.static,a=e.dynamic;ne.optional((function(){var e=[zo,Uo,Vo,Ho,Wo,Xo,$o,Yo,Bo,qo].concat(C);function t(t){Object.keys(t).forEach((function(t){ne.command(e.indexOf(t)>=0,'unknown parameter "'+t+'"',o.commandStr)}))}t(s),t(a)}));var l=I(e,t),c=N(e),h=R(e,c,o),d=L(e,o),f=F(e,o),p=j(e,o,l);function g(e){var t=h[e];t&&(f[e]=t)}g(Go),g(S(Fo));var m=Object.keys(f).length>0,v={framebuffer:c,draw:d,shader:p,state:f,dirty:m,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(v.profile=D(e),v.uniforms=G(n,o),v.drawVAO=v.scopeVAO=z(e),!v.drawVAO&&p.program&&!l&&r.angle_instanced_arrays){var y=!0,b=p.program.attributes.map((function(e){var n=t.static[e];return y=y&&!!n,n}));if(y&&b.length>0){var x=u.getVAO(u.createVAO(b));v.drawVAO=new oa(null,null,null,(function(e,t){return e.link(x)})),v.useVAO=!0}}return l?v.useVAO=!0:v.attributes=B(t,o),v.context=U(i),v}function H(e,t,n){var r=e.shared.context,i=e.scope();Object.keys(n).forEach((function(o){t.save(r,"."+o);var s=n[o].append(e,t);Array.isArray(s)?i(r,".",o,"=[",s.join(),"];"):i(r,".",o,"=",s,";")})),t(i)}function W(e,t,n,r){var i,o=e.shared,s=o.gl,a=o.framebuffer;b&&(i=t.def(o.extensions,".webgl_draw_buffers"));var l,c=e.constants,u=c.drawBuffer,h=c.backBuffer;l=n?n.append(e,t):t.def(a,".next"),r||t("if(",l,"!==",a,".cur){"),t("if(",l,"){",s,".bindFramebuffer(",qs,",",l,".framebuffer);"),b&&t(i,".drawBuffersWEBGL(",u,"[",l,".colorAttachments.length]);"),t("}else{",s,".bindFramebuffer(",qs,",null);"),b&&t(i,".drawBuffersWEBGL(",h,");"),t("}",a,".cur=",l,";"),r||t("}")}function $(e,t,n){var r=e.shared,i=r.gl,o=e.current,s=e.next,a=r.current,l=r.next,c=e.cond(a,".dirty");C.forEach((function(t){var r,u,h=S(t);if(!(h in n.state))if(h in s){r=s[h],u=o[h];var d=Oe(x[h].length,(function(e){return c.def(r,"[",e,"]")}));c(e.cond(d.map((function(e,t){return e+"!=="+u+"["+t+"]"})).join("||")).then(i,".",_[h],"(",d,");",d.map((function(e,t){return u+"["+t+"]="+e})).join(";"),";"))}else{r=c.def(l,".",h);var f=e.cond(r,"!==",a,".",h);c(f),h in E?f(e.cond(r).then(i,".enable(",E[h],");").else(i,".disable(",E[h],");"),a,".",h,"=",r,";"):f(i,".",_[h],"(",r,");",a,".",h,"=",r,";")}})),0===Object.keys(n.state).length&&c(a,".dirty=false;"),t(c)}function X(e,t,n,r){var i=e.shared,o=e.current,s=i.current,a=i.gl;ia(Object.keys(n)).forEach((function(i){var l=n[i];if(!r||r(l)){var c=l.append(e,t);if(E[i]){var u=E[i];sa(l)?t(a,c?".enable(":".disable(",u,");"):t(e.cond(c).then(a,".enable(",u,");").else(a,".disable(",u,");")),t(s,".",i,"=",c,";")}else if(hn(c)){var h=o[i];t(a,".",_[i],"(",c,");",c.map((function(e,t){return h+"["+t+"]="+e})).join(";"),";")}else t(a,".",_[i],"(",c,");",s,".",i,"=",c,";")}}))}function Y(e,t){y&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function q(e,t,n,r,i){var o,s,a,l=e.shared,c=e.stats,u=l.current,h=l.timer,d=n.profile;function f(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function g(e){e(o=t.def(),"=",f(),";"),"string"==typeof i?e(c,".count+=",i,";"):e(c,".count++;"),p&&(r?e(s=t.def(),"=",h,".getNumPendingQueries();"):e(h,".beginQuery(",c,");"))}function m(e){e(c,".cpuTime+=",f(),"-",o,";"),p&&(r?e(h,".pushScopeStats(",s,",",h,".getNumPendingQueries(),",c,");"):e(h,".endQuery();"))}function v(e){var n=t.def(u,".profile");t(u,".profile=",e,";"),t.exit(u,".profile=",n,";")}if(d){if(sa(d))return void(d.enable?(g(t),m(t.exit),v("true")):v("false"));v(a=d.append(e,t))}else a=t.def(u,".profile");var y=e.block();g(y),t("if(",a,"){",y,"}");var b=e.block();m(b),t.exit("if(",a,"){",b,"}")}function K(e,t,n,r,i){var o=e.shared;function s(e){switch(e){case xs:case _s:case ks:return 2;case ws:case Ss:case Ms:return 3;case Cs:case Os:case Ts:return 4;default:return 1}}function a(n,r,i){var s=o.gl,a=t.def(n,".location"),l=t.def(o.attributes,"[",a,"]"),c=i.state,u=i.buffer,h=[i.x,i.y,i.z,i.w],d=["buffer","normalized","offset","stride"];function f(){t("if(!",l,".buffer){",s,".enableVertexAttribArray(",a,");}");var n,o=i.type;if(n=i.size?t.def(i.size,"||",r):r,t("if(",l,".type!==",o,"||",l,".size!==",n,"||",d.map((function(e){return l+"."+e+"!=="+i[e]})).join("||"),"){",s,".bindBuffer(",ss,",",u,".buffer);",s,".vertexAttribPointer(",[a,n,o,i.normalized,i.stride,i.offset],");",l,".type=",o,";",l,".size=",n,";",d.map((function(e){return l+"."+e+"="+i[e]+";"})).join(""),"}"),y){var c=i.divisor;t("if(",l,".divisor!==",c,"){",e.instancing,".vertexAttribDivisorANGLE(",[a,c],");",l,".divisor=",c,";}")}}function p(){t("if(",l,".buffer){",s,".disableVertexAttribArray(",a,");",l,".buffer=null;","}if(",to.map((function(e,t){return l+"."+e+"!=="+h[t]})).join("||"),"){",s,".vertexAttrib4f(",a,",",h,");",to.map((function(e,t){return l+"."+e+"="+h[t]+";"})).join(""),"}")}c===ro?f():c===io?p():(t("if(",c,"===",ro,"){"),f(),t("}else{"),p(),t("}"))}r.forEach((function(r){var o,l=r.name,c=n.attributes[l];if(c){if(!i(c))return;o=c.append(e,t)}else{if(!i(ca))return;var u=e.scopeAttrib(l);ne.optional((function(){e.assert(t,u+".state","missing attribute "+l)})),o={},Object.keys(new m).forEach((function(e){o[e]=t.def(u,".",e)}))}a(e.link(r),s(r.info.type),o)}))}function Z(e,t,r,i,o){for(var s,a=e.shared,l=a.gl,c=0;c<i.length;++c){var u,h=i[c],d=h.name,f=h.info.type,p=r.uniforms[d],g=e.link(h)+".location";if(p){if(!o(p))continue;if(sa(p)){var m=p.value;if(ne.command(null!=m,'missing uniform "'+d+'"',e.commandStr),f===Rs||f===Is){ne.command("function"==typeof m&&(f===Rs&&("texture2d"===m._reglType||"framebuffer"===m._reglType)||f===Is&&("textureCube"===m._reglType||"framebufferCube"===m._reglType)),"invalid texture for uniform "+d,e.commandStr);var v=e.link(m._texture||m.color[0]._texture);t(l,".uniform1i(",g,",",v+".bind());"),t.exit(v,".unbind();")}else if(f===Ps||f===Ds||f===Ns){ne.optional((function(){ne.command(hn(m),"invalid matrix for uniform "+d,e.commandStr),ne.command(f===Ps&&4===m.length||f===Ds&&9===m.length||f===Ns&&16===m.length,"invalid length for matrix uniform "+d,e.commandStr)}));var y=e.global.def("new Float32Array(["+Array.prototype.slice.call(m)+"])"),b=2;f===Ds?b=3:f===Ns&&(b=4),t(l,".uniformMatrix",b,"fv(",g,",false,",y,");")}else{switch(f){case bs:ne.commandType(m,"number","uniform "+d,e.commandStr),s="1f";break;case xs:ne.command(hn(m)&&2===m.length,"uniform "+d,e.commandStr),s="2f";break;case ws:ne.command(hn(m)&&3===m.length,"uniform "+d,e.commandStr),s="3f";break;case Cs:ne.command(hn(m)&&4===m.length,"uniform "+d,e.commandStr),s="4f";break;case As:ne.commandType(m,"boolean","uniform "+d,e.commandStr),s="1i";break;case Es:ne.commandType(m,"number","uniform "+d,e.commandStr),s="1i";break;case ks:case _s:ne.command(hn(m)&&2===m.length,"uniform "+d,e.commandStr),s="2i";break;case Ms:case Ss:ne.command(hn(m)&&3===m.length,"uniform "+d,e.commandStr),s="3i";break;case Ts:case Os:ne.command(hn(m)&&4===m.length,"uniform "+d,e.commandStr),s="4i"}t(l,".uniform",s,"(",g,",",hn(m)?Array.prototype.slice.call(m):m,");")}continue}u=p.append(e,t)}else{if(!o(ca))continue;u=t.def(a.uniforms,"[",n.id(d),"]")}f===Rs?(ne(!Array.isArray(u),"must specify a scalar prop for textures"),t("if(",u,"&&",u,'._reglType==="framebuffer"){',u,"=",u,".color[0];","}")):f===Is&&(ne(!Array.isArray(u),"must specify a scalar prop for cube maps"),t("if(",u,"&&",u,'._reglType==="framebufferCube"){',u,"=",u,".color[0];","}")),ne.optional((function(){function n(n,r){e.assert(t,n,'bad data or missing for uniform "'+d+'".  '+r)}function r(e){ne(!Array.isArray(u),"must not specify an array type for uniform"),n("typeof "+u+'==="'+e+'"',"invalid type, expected "+e)}function i(t,r){Array.isArray(u)?ne(u.length===t,"must have length "+t):n(a.isArrayLike+"("+u+")&&"+u+".length==="+t,"invalid vector, should have length "+t,e.commandStr)}function o(t){ne(!Array.isArray(u),"must not specify a value type"),n("typeof "+u+'==="function"&&'+u+'._reglType==="texture'+(t===ls?"2d":"Cube")+'"',"invalid texture type",e.commandStr)}switch(f){case Es:case bs:r("number");break;case _s:case xs:case ks:i(2);break;case Ss:case ws:case Ms:i(3);break;case Os:case Cs:case Ts:case Ps:i(4);break;case As:r("boolean");break;case Ds:i(9);break;case Ns:i(16);break;case Rs:o(ls);break;case Is:o(cs)}}));var x=1;switch(f){case Rs:case Is:var w=t.def(u,"._texture");t(l,".uniform1i(",g,",",w,".bind());"),t.exit(w,".unbind();");continue;case Es:case As:s="1i";break;case _s:case ks:s="2i",x=2;break;case Ss:case Ms:s="3i",x=3;break;case Os:case Ts:s="4i",x=4;break;case bs:s="1f";break;case xs:s="2f",x=2;break;case ws:s="3f",x=3;break;case Cs:s="4f",x=4;break;case Ps:s="Matrix2fv";break;case Ds:s="Matrix3fv";break;case Ns:s="Matrix4fv"}if(t(l,".uniform",s,"(",g,","),"M"===s.charAt(0)){var C=Math.pow(f-Ps+2,2),E=e.global.def("new Float32Array(",C,")");Array.isArray(u)?t("false,(",Oe(C,(function(e){return E+"["+e+"]="+u[e]})),",",E,")"):t("false,(Array.isArray(",u,")||",u," instanceof Float32Array)?",u,":(",Oe(C,(function(e){return E+"["+e+"]="+u+"["+e+"]"})),",",E,")")}else x>1?t(Oe(x,(function(e){return Array.isArray(u)?u[e]:u+"["+e+"]"}))):(ne(!Array.isArray(u),"uniform value must not be an array"),t(u));t(");")}}function J(e,t,n,r){var i=e.shared,o=i.gl,s=i.draw,a=r.draw;function l(){var i,l=a.elements,c=t;return l?((l.contextDep&&r.contextDynamic||l.propDep)&&(c=n),i=l.append(e,c)):i=c.def(s,".",Ho),i&&c("if("+i+")"+o+".bindBuffer("+as+","+i+".buffer.buffer);"),i}function c(){var i,o=a.count,l=t;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(l=n),i=o.append(e,l),ne.optional((function(){o.MISSING&&e.assert(t,"false","missing vertex count"),o.DYNAMIC&&e.assert(l,i+">=0","missing vertex count")}))):(i=l.def(s,".",$o),ne.optional((function(){e.assert(l,i+">=0","missing vertex count")}))),i}var u=l();function h(i){var o=a[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(e,n):o.append(e,t):t.def(s,".",i)}var d,f,p=h(Wo),g=h(Xo),m=c();if("number"==typeof m){if(0===m)return}else n("if(",m,"){"),n.exit("}");y&&(d=h(Yo),f=e.instancing);var v=u+".type",b=a.elements&&sa(a.elements);function x(){function e(){n(f,".drawElementsInstancedANGLE(",[p,m,v,g+"<<(("+v+"-"+no+")>>1)",d],");")}function t(){n(f,".drawArraysInstancedANGLE(",[p,g,m,d],");")}u?b?e():(n("if(",u,"){"),e(),n("}else{"),t(),n("}")):t()}function w(){function e(){n(o+".drawElements("+[p,m,v,g+"<<(("+v+"-"+no+")>>1)"]+");")}function t(){n(o+".drawArrays("+[p,g,m]+");")}u?b?e():(n("if(",u,"){"),e(),n("}else{"),t(),n("}")):t()}y&&("number"!=typeof d||d>=0)?"string"==typeof d?(n("if(",d,">0){"),x(),n("}else if(",d,"<0){"),w(),n("}")):x():w()}function Q(e,t,n,r,i){var o=P(),s=o.proc("body",i);return ne.optional((function(){o.commandStr=t.commandStr,o.command=o.link(t.commandStr)})),y&&(o.instancing=s.def(o.shared.extensions,".angle_instanced_arrays")),e(o,s,n,r),o.compile().body}function ee(e,t,n,r){Y(e,t),n.useVAO?n.drawVAO?t(e.shared.vao,".setVAO(",n.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),K(e,t,n,r.attributes,(function(){return!0}))),Z(e,t,n,r.uniforms,(function(){return!0})),J(e,t,t,n)}function te(e,t){var n=e.proc("draw",1);Y(e,n),H(e,n,t.context),W(e,n,t.framebuffer),$(e,n,t),X(e,n,t.state),q(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)ee(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var i=e.global.def("{}"),o=n.def(r,".id"),s=n.def(i,"[",o,"]");n(e.cond(s).then(s,".call(this,a0);").else(s,"=",i,"[",o,"]=",e.link((function(n){return Q(ee,e,t,n,1)})),"(",r,");",s,".call(this,a0);"))}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}function re(e,t,n,r){function i(){return!0}e.batchId="a1",Y(e,t),K(e,t,n,r.attributes,i),Z(e,t,n,r.uniforms,i),J(e,t,t,n)}function ie(e,t,n,r){Y(e,t);var i=n.contextDep,o=t.def(),s="a0",a="a1",l=t.def();e.shared.props=l,e.batchId=o;var c=e.scope(),u=e.scope();function h(e){return e.contextDep&&i||e.propDep}function d(e){return!h(e)}if(t(c.entry,"for(",o,"=0;",o,"<",a,";++",o,"){",l,"=",s,"[",o,"];",u,"}",c.exit),n.needsContext&&H(e,u,n.context),n.needsFramebuffer&&W(e,u,n.framebuffer),X(e,u,n.state,h),n.profile&&h(n.profile)&&q(e,u,n,!1,!0),r)n.useVAO?n.drawVAO?h(n.drawVAO)?u(e.shared.vao,".setVAO(",n.drawVAO.append(e,u),");"):c(e.shared.vao,".setVAO(",n.drawVAO.append(e,c),");"):c(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(c(e.shared.vao,".setVAO(null);"),K(e,c,n,r.attributes,d),K(e,u,n,r.attributes,h)),Z(e,c,n,r.uniforms,d),Z(e,u,n,r.uniforms,h),J(e,c,u,n);else{var f=e.global.def("{}"),p=n.shader.progVar.append(e,u),g=u.def(p,".id"),m=u.def(f,"[",g,"]");u(e.shared.gl,".useProgram(",p,".program);","if(!",m,"){",m,"=",f,"[",g,"]=",e.link((function(t){return Q(re,e,n,t,2)})),"(",p,");}",m,".call(this,a0[",o,"],",o,");")}}function oe(e,t){var n=e.proc("batch",2);e.batchId="0",Y(e,n);var r=!1,i=!0;Object.keys(t.context).forEach((function(e){r=r||t.context[e].propDep})),r||(H(e,n,t.context),i=!1);var o=t.framebuffer,s=!1;function a(e){return e.contextDep&&r||e.propDep}o?(o.propDep?r=s=!0:o.contextDep&&r&&(s=!0),s||W(e,n,o)):W(e,n,null),t.state.viewport&&t.state.viewport.propDep&&(r=!0),$(e,n,t),X(e,n,t.state,(function(e){return!a(e)})),t.profile&&a(t.profile)||q(e,n,t,!1,"a1"),t.contextDep=r,t.needsContext=i,t.needsFramebuffer=s;var l=t.shader.progVar;if(l.contextDep&&r||l.propDep)ie(e,n,t,null);else{var c=l.append(e,n);if(n(e.shared.gl,".useProgram(",c,".program);"),t.shader.program)ie(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var u=e.global.def("{}"),h=n.def(c,".id"),d=n.def(u,"[",h,"]");n(e.cond(d).then(d,".call(this,a0,a1);").else(d,"=",u,"[",h,"]=",e.link((function(n){return Q(ie,e,t,n,2)})),"(",c,");",d,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}function se(e,t){var r=e.proc("scope",3);e.batchId="a2";var i=e.shared,o=i.current;function s(n){var o=t.shader[n];o&&r.set(i.shader,"."+n,o.append(e,r))}H(e,r,t.context),t.framebuffer&&t.framebuffer.append(e,r),ia(Object.keys(t.state)).forEach((function(n){var o=t.state[n].append(e,r);hn(o)?o.forEach((function(t,i){r.set(e.next[n],"["+i+"]",t)})):r.set(i.next,"."+n,o)})),q(e,r,t,!0,!0),[Ho,Xo,$o,Yo,Wo].forEach((function(n){var o=t.draw[n];o&&r.set(i.draw,"."+n,""+o.append(e,r))})),Object.keys(t.uniforms).forEach((function(o){var s=t.uniforms[o].append(e,r);Array.isArray(s)&&(s="["+s.join()+"]"),r.set(i.uniforms,"["+n.id(o)+"]",s)})),Object.keys(t.attributes).forEach((function(n){var i=t.attributes[n].append(e,r),o=e.scopeAttrib(n);Object.keys(new m).forEach((function(e){r.set(o,"."+e,i[e])}))})),t.scopeVAO&&r.set(i.vao,".targetVAO",t.scopeVAO.append(e,r)),s(Uo),s(Vo),Object.keys(t.state).length>0&&(r(o,".dirty=true;"),r.exit(o,".dirty=true;")),r("a1(",e.shared.context,",a0,",e.batchId,");")}function ae(e){if("object"==typeof e&&!hn(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(pe.isDynamic(e[t[n]]))return!0;return!1}}function le(e,t,n){var r=t.static[n];if(r&&ae(r)){var i=e.global,o=Object.keys(r),s=!1,a=!1,l=!1,c=e.global.def("{}");o.forEach((function(t){var n=r[t];if(pe.isDynamic(n)){"function"==typeof n&&(n=r[t]=pe.unbox(n));var o=la(n,null);s=s||o.thisDep,l=l||o.propDep,a=a||o.contextDep}else{switch(i(c,".",t,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(e.link(n))}i(";")}})),t.dynamic[n]=new pe.DynamicVariable(co,{thisDep:s,contextDep:a,propDep:l,ref:c,append:u}),delete t.static[n]}function u(e,t){o.forEach((function(n){var i=r[n];if(pe.isDynamic(i)){var o=e.invoke(t,i);t(c,".",n,"=",o,";")}}))}}function ce(e,n,r,i,o){var s=P();s.stats=s.link(o),Object.keys(n.static).forEach((function(e){le(s,n,e)})),os.forEach((function(t){le(s,e,t)}));var a=V(e,n,r,i,s);return te(s,a),se(s,a),oe(s,a),t(s.compile(),{destroy:function(){a.shader.program.destroy()}})}return{next:w,current:x,procs:function(){var e=P(),t=e.proc("poll"),n=e.proc("refresh"),o=e.block();t(o),n(o);var s,a=e.shared,l=a.gl,c=a.next,u=a.current;o(u,".dirty=false;"),W(e,t),W(e,n,null,!0),y&&(s=e.link(y)),r.oes_vertex_array_object&&n(e.link(r.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var h=0;h<i.maxAttributes;++h){var d=n.def(a.attributes,"[",h,"]"),f=e.cond(d,".buffer");f.then(l,".enableVertexAttribArray(",h,");",l,".bindBuffer(",ss,",",d,".buffer.buffer);",l,".vertexAttribPointer(",h,",",d,".size,",d,".type,",d,".normalized,",d,".stride,",d,".offset);").else(l,".disableVertexAttribArray(",h,");",l,".vertexAttrib4f(",h,",",d,".x,",d,".y,",d,".z,",d,".w);",d,".buffer=null;"),n(f),y&&n(s,".vertexAttribDivisorANGLE(",h,",",d,".divisor);")}return n(e.shared.vao,".currentVAO=null;",e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"),Object.keys(E).forEach((function(r){var i=E[r],s=o.def(c,".",r),a=e.block();a("if(",s,"){",l,".enable(",i,")}else{",l,".disable(",i,")}",u,".",r,"=",s,";"),n(a),t("if(",s,"!==",u,".",r,"){",a,"}")})),Object.keys(_).forEach((function(r){var i,s,a=_[r],h=x[r],d=e.block();if(d(l,".",a,"("),hn(h)){var f=h.length;i=e.global.def(c,".",r),s=e.global.def(u,".",r),d(Oe(f,(function(e){return i+"["+e+"]"})),");",Oe(f,(function(e){return s+"["+e+"]="+i+"["+e+"];"})).join("")),t("if(",Oe(f,(function(e){return i+"["+e+"]!=="+s+"["+e+"]"})).join("||"),"){",d,"}")}else i=o.def(c,".",r),s=o.def(u,".",r),d(i,");",u,".",r,"=",i,";"),t("if(",i,"!==",s,"){",d,"}");n(d)})),e.compile()}(),compile:ce}}function ha(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var da=34918,fa=34919,pa=35007,ga=function(e,t){if(!t.ext_disjoint_timer_query)return null;var n=[];function r(){return n.pop()||t.ext_disjoint_timer_query.createQueryEXT()}function i(e){n.push(e)}var o=[];function s(e){var n=r();t.ext_disjoint_timer_query.beginQueryEXT(pa,n),o.push(n),f(o.length-1,o.length,e)}function a(){t.ext_disjoint_timer_query.endQueryEXT(pa)}function l(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var c=[];function u(){return c.pop()||new l}function h(e){c.push(e)}var d=[];function f(e,t,n){var r=u();r.startQueryIndex=e,r.endQueryIndex=t,r.sum=0,r.stats=n,d.push(r)}var p=[],g=[];function m(){var e,n,r=o.length;if(0!==r){g.length=Math.max(g.length,r+1),p.length=Math.max(p.length,r+1),p[0]=0,g[0]=0;var s=0;for(e=0,n=0;n<o.length;++n){var a=o[n];t.ext_disjoint_timer_query.getQueryObjectEXT(a,fa)?(s+=t.ext_disjoint_timer_query.getQueryObjectEXT(a,da),i(a)):o[e++]=a,p[n+1]=s,g[n+1]=e}for(o.length=e,e=0,n=0;n<d.length;++n){var l=d[n],c=l.startQueryIndex,u=l.endQueryIndex;l.sum+=p[u]-p[c];var f=g[c],m=g[u];m===f?(l.stats.gpuTime+=l.sum/1e6,h(l)):(l.startQueryIndex=f,l.endQueryIndex=m,d[e++]=l)}d.length=e}}return{beginQuery:s,endQuery:a,pushScopeStats:f,update:m,getNumPendingQueries:function(){return o.length},clear:function(){n.push.apply(n,o);for(var e=0;e<n.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(n[e]);o.length=0,n.length=0},restore:function(){o.length=0,n.length=0}}},ma=16384,va=256,ya=1024,ba=34962,xa="webglcontextlost",wa="webglcontextrestored",Ca=1,Ea=2,_a=3;function Sa(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}function Oa(e){var n=_e(e);if(!n)return null;var r=n.gl,i=r.getContextAttributes(),o=r.isContextLost(),s=Se(r,n);if(!s)return null;var a=ve(),l=ha(),c=s.extensions,u=ga(r,c),h=me(),d=r.drawingBufferWidth,f=r.drawingBufferHeight,p={tick:0,time:0,viewportWidth:d,viewportHeight:f,framebufferWidth:d,framebufferHeight:f,drawingBufferWidth:d,drawingBufferHeight:f,pixelRatio:n.pixelRatio},g={},m={elements:null,primitive:4,count:-1,offset:0,instances:-1},v=Ct(r,c),y=Wt(r,l,n,x),b=zi(r,c,v,l,y);function x(e){return b.destroyBuffer(e)}var w=sn(r,c,y,l),C=$i(r,a,l,n),E=qr(r,c,v,(function(){O.procs.poll()}),p,l,n),_=ci(r,c,v,l,n),S=Li(r,c,v,E,_,l),O=ua(r,a,c,v,y,w,E,S,g,b,C,m,p,u,n),A=Zi(r,S,O.procs.poll,p,i,c,v),k=O.next,M=r.canvas,T=[],P=[],D=[],N=[n.onDestroy],R=null;function I(){if(0===T.length)return u&&u.update(),void(R=null);R=ge.next(I),X();for(var e=T.length-1;e>=0;--e){var t=T[e];t&&t(p,null,0)}r.flush(),u&&u.update()}function j(){!R&&T.length>0&&(R=ge.next(I))}function L(){R&&(ge.cancel(I),R=null)}function F(e){e.preventDefault(),o=!0,L(),P.forEach((function(e){e()}))}function G(e){r.getError(),o=!1,s.restore(),C.restore(),y.restore(),E.restore(),_.restore(),S.restore(),b.restore(),u&&u.restore(),O.procs.refresh(),j(),D.forEach((function(e){e()}))}function B(){T.length=0,L(),M&&(M.removeEventListener(xa,F),M.removeEventListener(wa,G)),C.clear(),S.clear(),_.clear(),E.clear(),w.clear(),y.clear(),b.clear(),u&&u.clear(),N.forEach((function(e){e()}))}function z(e){function n(e){var n=t({},e);function r(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach((function(r){n[e+"."+r]=t[r]}))}}return delete n.uniforms,delete n.attributes,delete n.context,delete n.vao,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),r("blend"),r("depth"),r("cull"),r("stencil"),r("polygonOffset"),r("scissor"),r("sample"),"vao"in e&&(n.vao=e.vao),n}function r(e,t){var n={},r={};return Object.keys(e).forEach((function(i){var o=e[i];if(pe.isDynamic(o))r[i]=pe.unbox(o,i);else{if(t&&Array.isArray(o))for(var s=0;s<o.length;++s)if(pe.isDynamic(o[s]))return void(r[i]=pe.unbox(o,i));n[i]=o}})),{dynamic:r,static:n}}ne(!!e,"invalid args to regl({...})"),ne.type(e,"object","invalid args to regl({...})");var i=r(e.context||{},!0),s=r(e.uniforms||{},!0),a=r(e.attributes||{},!1),l=r(n(e),!1),c={gpuTime:0,cpuTime:0,count:0},u=O.compile(l,a,s,i,c),h=u.draw,d=u.batch,f=u.scope,p=[];function g(e){for(;p.length<e;)p.push(null);return p}function m(e,t){var n;if(o&&ne.raise("context lost"),"function"==typeof e)return f.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(n=0;n<e;++n)f.call(this,null,t,n);else{if(!Array.isArray(e))return f.call(this,e,t,0);for(n=0;n<e.length;++n)f.call(this,e[n],t,n)}else if("number"==typeof e){if(e>0)return d.call(this,g(0|e),0|e)}else{if(!Array.isArray(e))return h.call(this,e);if(e.length)return d.call(this,e,e.length)}}return t(m,{stats:c,destroy:function(){u.destroy()}})}M&&(M.addEventListener(xa,F,!1),M.addEventListener(wa,G,!1));var U=S.setFBO=z({framebuffer:pe.define.call(null,Ca,"framebuffer")});function V(e,t){var n=0;O.procs.poll();var i=t.color;i&&(r.clearColor(+i[0]||0,+i[1]||0,+i[2]||0,+i[3]||0),n|=ma),"depth"in t&&(r.clearDepth(+t.depth),n|=va),"stencil"in t&&(r.clearStencil(0|t.stencil),n|=ya),ne(!!n,"called regl.clear with no buffer specified"),r.clear(n)}function H(e){if(ne("object"==typeof e&&e,"regl.clear() takes an object as input"),"framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var n=0;n<6;++n)U(t({framebuffer:e.framebuffer.faces[n]},e),V);else U(e,V);else V(null,e)}function W(e){function t(){var t=Sa(T,e);function n(){var e=Sa(T,n);T[e]=T[T.length-1],T.length-=1,T.length<=0&&L()}ne(t>=0,"cannot cancel a frame twice"),T[t]=n}return ne.type(e,"function","regl.frame() callback must be a function"),T.push(e),j(),{cancel:t}}function $(){var e=k.viewport,t=k.scissor_box;e[0]=e[1]=t[0]=t[1]=0,p.viewportWidth=p.framebufferWidth=p.drawingBufferWidth=e[2]=t[2]=r.drawingBufferWidth,p.viewportHeight=p.framebufferHeight=p.drawingBufferHeight=e[3]=t[3]=r.drawingBufferHeight}function X(){p.tick+=1,p.time=q(),$(),O.procs.poll()}function Y(){E.refresh(),$(),O.procs.refresh(),u&&u.update()}function q(){return(me()-h)/1e3}function K(e,t){var n;switch(ne.type(t,"function","listener callback must be a function"),e){case"frame":return W(t);case"lost":n=P;break;case"restore":n=D;break;case"destroy":n=N;break;default:ne.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t)return n[e]=n[n.length-1],void n.pop()}}}Y();var Z=t(z,{clear:H,prop:pe.define.bind(null,Ca),context:pe.define.bind(null,Ea),this:pe.define.bind(null,_a),draw:z({}),buffer:function(e){return y.create(e,ba,!1,!1)},elements:function(e){return w.create(e,!1)},texture:E.create2D,cube:E.createCube,renderbuffer:_.create,framebuffer:S.create,framebufferCube:S.createCube,vao:b.createVAO,attributes:i,frame:W,on:K,limits:v,hasExtension:function(e){return v.extensions.indexOf(e.toLowerCase())>=0},read:A,destroy:B,_gl:r,_refresh:Y,poll:function(){X(),u&&u.update()},now:q,stats:l});return n.onDone(null,Z),Z}return Oa}()}(o4);var s4,a4,l4,c4,u4,h4,d4,f4,p4,g4,m4,v4,y4,b4,x4=o4.exports,w4=function(){function e(t,n){LZ(this,e),this.attribute=void 0,this.buffer=void 0;var r=n.buffer,i=n.offset,o=n.stride,s=n.normalized,a=n.size,l=n.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:i||0,stride:o||0,normalized:s||!1,divisor:l||0},a&&(this.attribute.size=a)}return GZ(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(e){this.buffer.subData(e)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),C4=(PJ(s4={},TQ.POINTS,"points"),PJ(s4,TQ.LINES,"lines"),PJ(s4,TQ.LINE_LOOP,"line loop"),PJ(s4,TQ.LINE_STRIP,"line strip"),PJ(s4,TQ.TRIANGLES,"triangles"),PJ(s4,TQ.TRIANGLE_FAN,"triangle fan"),PJ(s4,TQ.TRIANGLE_STRIP,"triangle strip"),s4),E4=(PJ(a4={},TQ.STATIC_DRAW,"static"),PJ(a4,TQ.DYNAMIC_DRAW,"dynamic"),PJ(a4,TQ.STREAM_DRAW,"stream"),a4),_4=(PJ(l4={},TQ.BYTE,"int8"),PJ(l4,TQ.UNSIGNED_INT,"int16"),PJ(l4,TQ.INT,"int32"),PJ(l4,TQ.UNSIGNED_BYTE,"uint8"),PJ(l4,TQ.UNSIGNED_SHORT,"uint16"),PJ(l4,TQ.UNSIGNED_INT,"uint32"),PJ(l4,TQ.FLOAT,"float"),l4),S4=(PJ(c4={},TQ.ALPHA,"alpha"),PJ(c4,TQ.LUMINANCE,"luminance"),PJ(c4,TQ.LUMINANCE_ALPHA,"luminance alpha"),PJ(c4,TQ.RGB,"rgb"),PJ(c4,TQ.RGBA,"rgba"),PJ(c4,TQ.RGBA4,"rgba4"),PJ(c4,TQ.RGB5_A1,"rgb5 a1"),PJ(c4,TQ.RGB565,"rgb565"),PJ(c4,TQ.DEPTH_COMPONENT,"depth"),PJ(c4,TQ.DEPTH_STENCIL,"depth stencil"),c4),O4=(PJ(u4={},TQ.DONT_CARE,"dont care"),PJ(u4,TQ.NICEST,"nice"),PJ(u4,TQ.FASTEST,"fast"),u4),A4=(PJ(h4={},TQ.NEAREST,"nearest"),PJ(h4,TQ.LINEAR,"linear"),PJ(h4,TQ.LINEAR_MIPMAP_LINEAR,"mipmap"),PJ(h4,TQ.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),PJ(h4,TQ.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),PJ(h4,TQ.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),h4),k4=(PJ(d4={},TQ.REPEAT,"repeat"),PJ(d4,TQ.CLAMP_TO_EDGE,"clamp"),PJ(d4,TQ.MIRRORED_REPEAT,"mirror"),d4),M4=(PJ(f4={},TQ.NONE,"none"),PJ(f4,TQ.BROWSER_DEFAULT_WEBGL,"browser"),f4),T4=(PJ(p4={},TQ.NEVER,"never"),PJ(p4,TQ.ALWAYS,"always"),PJ(p4,TQ.LESS,"less"),PJ(p4,TQ.LEQUAL,"lequal"),PJ(p4,TQ.GREATER,"greater"),PJ(p4,TQ.GEQUAL,"gequal"),PJ(p4,TQ.EQUAL,"equal"),PJ(p4,TQ.NOTEQUAL,"notequal"),p4),P4=(PJ(g4={},TQ.FUNC_ADD,"add"),PJ(g4,TQ.MIN_EXT,"min"),PJ(g4,TQ.MAX_EXT,"max"),PJ(g4,TQ.FUNC_SUBTRACT,"subtract"),PJ(g4,TQ.FUNC_REVERSE_SUBTRACT,"reverse subtract"),g4),D4=(PJ(m4={},TQ.ZERO,"zero"),PJ(m4,TQ.ONE,"one"),PJ(m4,TQ.SRC_COLOR,"src color"),PJ(m4,TQ.ONE_MINUS_SRC_COLOR,"one minus src color"),PJ(m4,TQ.SRC_ALPHA,"src alpha"),PJ(m4,TQ.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),PJ(m4,TQ.DST_COLOR,"dst color"),PJ(m4,TQ.ONE_MINUS_DST_COLOR,"one minus dst color"),PJ(m4,TQ.DST_ALPHA,"dst alpha"),PJ(m4,TQ.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),PJ(m4,TQ.CONSTANT_COLOR,"constant color"),PJ(m4,TQ.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),PJ(m4,TQ.CONSTANT_ALPHA,"constant alpha"),PJ(m4,TQ.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),PJ(m4,TQ.SRC_ALPHA_SATURATE,"src alpha saturate"),m4),N4=(PJ(v4={},TQ.NEVER,"never"),PJ(v4,TQ.ALWAYS,"always"),PJ(v4,TQ.LESS,"less"),PJ(v4,TQ.LEQUAL,"lequal"),PJ(v4,TQ.GREATER,"greater"),PJ(v4,TQ.GEQUAL,"gequal"),PJ(v4,TQ.EQUAL,"equal"),PJ(v4,TQ.NOTEQUAL,"notequal"),v4),R4=(PJ(y4={},TQ.ZERO,"zero"),PJ(y4,TQ.KEEP,"keep"),PJ(y4,TQ.REPLACE,"replace"),PJ(y4,TQ.INVERT,"invert"),PJ(y4,TQ.INCR,"increment"),PJ(y4,TQ.DECR,"decrement"),PJ(y4,TQ.INCR_WRAP,"increment wrap"),PJ(y4,TQ.DECR_WRAP,"decrement wrap"),y4),I4=(PJ(b4={},TQ.FRONT,"front"),PJ(b4,TQ.BACK,"back"),b4),j4=function(){function e(t,n){LZ(this,e),this.buffer=void 0;var r=n.data,i=n.usage,o=n.type;this.buffer=t.buffer({data:r,usage:E4[i||TQ.STATIC_DRAW],type:_4[o||TQ.UNSIGNED_BYTE]})}return GZ(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(e){var t=e.data,n=e.offset;this.buffer.subdata(t,n)}}]),e}(),L4={exports:{}},F4={exports:{}};!function(e){var t=eJ.exports;e.exports=function(e){if(Array.isArray(e))return t(e)},e.exports.default=e.exports,e.exports.__esModule=!0}(F4);var G4={exports:{}};!function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0}(G4);var B4={exports:{}};!function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}(B4),function(e){var t=F4.exports,n=G4.exports,r=QZ.exports,i=B4.exports;e.exports=function(e){return t(e)||n(e)||r(e)||i()},e.exports.default=e.exports,e.exports.__esModule=!0}(L4);var z4=h(L4.exports),U4=9007199254740991,V4={};V4["[object Float32Array]"]=V4["[object Float64Array]"]=V4["[object Int8Array]"]=V4["[object Int16Array]"]=V4["[object Int32Array]"]=V4["[object Uint8Array]"]=V4["[object Uint8ClampedArray]"]=V4["[object Uint16Array]"]=V4["[object Uint32Array]"]=!0,V4["[object Arguments]"]=V4["[object Array]"]=V4["[object ArrayBuffer]"]=V4["[object Boolean]"]=V4["[object DataView]"]=V4["[object Date]"]=V4["[object Error]"]=V4["[object Function]"]=V4["[object Map]"]=V4["[object Number]"]=V4["[object Object]"]=V4["[object RegExp]"]=V4["[object Set]"]=V4["[object String]"]=V4["[object WeakMap]"]=!1;var H4=Object.prototype.toString;var W4=function(e){return function(e){return!!e&&"object"===dJ(e)}(e)&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=U4}(e.length)&&!!V4[H4.call(e)]};function $4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X4(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$4(Object(n),!0).forEach((function(t){PJ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$4(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Y4=0,q4=function(){function e(t,n){var r=this;LZ(this,e),this.reGl=t,this.context=n,this.entity=XZ(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var i={};this.context.uniforms.forEach((function(e){var t=e.name,n=e.type,o=e.data,s=e.isReferer,a=e.storageClass;if(a===V1.StorageBuffer){if(s)r.textureCache[t]={data:void 0},i["".concat(t,"Size")]=function(){return o.compiledBundle.context.output.textureSize};else{r.textureCache[t]=r.calcDataTexture(t,n,o);var l=r.textureCache[t],c=l.textureWidth,u=l.isOutput;i["".concat(t,"Size")]=[c,c],u&&(r.outputTextureName=t,r.context.needPingpong&&(r.outputTextureName="".concat(t,"Output"),r.textureCache[r.outputTextureName]=r.calcDataTexture(t,n,o)))}i[t]=function(){return r.textureCache[t].texture}}else if(a===V1.Uniform){if(o&&(Array.isArray(o)||W4(o))&&o.length>16)throw new Error("invalid data type ".concat(n));i[t]=function(){return e.data}}}));var o=this.getOuputDataTexture(),s=o.textureWidth,a=o.texelCount;i.u_OutputTextureSize=[s,s],i.u_OutputTexelCount=a,this.context.output.textureSize=[s,s];var l={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n".concat(this.context.shader),uniforms:i,vert:"attribute vec3 a_Position;\nattribute vec2 a_TexCoord;\n\nvarying vec2 v_TexCoord;\n\nvoid main() {\n  gl_Position = vec4(a_Position, 1.0);\n  v_TexCoord = a_TexCoord;\n}",primitive:"triangle strip",count:4};this.computeCommand=this.reGl(l)}var t;return GZ(e,[{key:"run",value:function(){var e=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use((function(){e.computeCommand()}))}},{key:"readData",value:(t=WZ(VZ.mark((function e(){var t,n,r,i,o,s,a,l,c=this;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.reGl({framebuffer:this.texFBO})((function(){t=c.reGl.read()})),!t){e.next=6;break}if(n=this.getOuputDataTexture(),r=n.originalDataLength,i=n.elementsPerTexel,o=n.typedArrayConstructor,s=void 0===o?Float32Array:o,a=[],4!==i)for(l=0;l<t.length;l+=4)1===i?a.push(t[l]):2===i?a.push(t[l],t[l+1]):a.push(t[l],t[l+1],t[l+2]);else a=t;return e.abrupt("return",new s(a.slice(0,r)));case 6:return e.abrupt("return",new Float32Array);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"confirmInput",value:function(e,t){var n;this.entity===e.entity?(this.dynamicPingpong=!0,n=this):n=e,this.textureCache[t].id=n.getOuputDataTexture().id,this.textureCache[t].texture=n.getOuputDataTexture().texture}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(e,t){var n=this.context.uniforms.find((function(t){return t.name===e}));if(n){var r=this.calcDataTexture(e,n.type,t),i=r.texture,o=r.data;this.textureCache[e].data=o,this.textureCache[e].texture=i}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var e=this.context.output.name;this.textureCache[e].id=this.getOuputDataTexture().id,this.textureCache[e].texture=this.getOuputDataTexture().texture}var t=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=t}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var e=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=e}},{key:"cloneDataTexture",value:function(e){var t=e.data,n=e.textureWidth;return X4(X4({},e),{},{id:Y4++,texture:this.reGl.texture({width:n,height:n,data:t,type:"float"})})}},{key:"calcDataTexture",value:function(e,t,n){var r=1;t===z1.Vector4FloatArray&&(r=4);for(var i=[],o=0;o<n.length;o+=r)1===r?i.push(n[o],0,0,0):2===r?i.push(n[o],n[o+1],0,0):3===r?i.push(n[o],n[o+1],n[o+2],0):4===r&&i.push(n[o],n[o+1],n[o+2],n[o+3]);var s=n.length,a=Math.ceil(s/r),l=Math.ceil(Math.sqrt(a)),c=l*l;a<c&&i.push.apply(i,z4(new Array(4*(c-a)).fill(0)));var u=this.reGl.texture({width:l,height:l,data:i,type:"float"});return{id:Y4++,data:i,originalDataLength:s,typedArrayConstructor:W4(n)?n.constructor:void 0,textureWidth:l,texture:u,texelCount:a,elementsPerTexel:r,isOutput:e===this.context.output.name}}}]),e}(),K4=function(){function e(t,n){LZ(this,e),this.elements=void 0;var r=n.data,i=n.usage,o=n.type,s=n.count;this.elements=t.elements({data:r,usage:E4[i||TQ.STATIC_DRAW],type:_4[o||TQ.UNSIGNED_BYTE],count:s})}return GZ(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(e){var t=e.data;this.elements.subdata(t)}},{key:"destroy",value:function(){this.elements.destroy()}}]),e}(),Z4=function(){function e(t,n){LZ(this,e),this.framebuffer=void 0;var r=n.width,i=n.height,o=n.color,s=n.colors;n.depth,n.stencil;var a={width:r,height:i};Array.isArray(s)&&(a.colors=s.map((function(e){return e.get()}))),o&&"boolean"!=typeof o&&(a.color=o.get()),this.framebuffer=t.framebuffer(a)}return GZ(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(e){var t=e.width,n=e.height;this.framebuffer.resize(t,n)}}]),e}();function J4(e){var t={};return Object.keys(e).forEach((function(n){Q4(n,e[n],t,"")})),t}function Q4(e,t,n,r){var i,o;null===t||"number"==typeof t||"boolean"==typeof t||Array.isArray(t)&&"number"==typeof t[0]||W4(t)||""===t||void 0!==t.resize?n["".concat(r&&r+".").concat(e)]=t:(o=dJ(i=t),null==i||"object"!==o&&"function"!==o||Object.keys(t).forEach((function(i){Q4(i,t[i],n,"".concat(r&&r+".").concat(e))})),Array.isArray(t)&&t.forEach((function(t,i){Object.keys(t).forEach((function(o){Q4(o,t[o],n,"".concat(r&&r+".").concat(e,"[").concat(i,"]"))}))})))}function e6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t6(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?e6(Object(n),!0).forEach((function(t){PJ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e6(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var n6,r6,i6,o6=function(){function e(t,n){LZ(this,e),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=t;var r=n.vs,i=n.fs,o=n.defines,s=n.attributes,a=n.uniforms,l=n.primitive,c=n.count,u=n.elements,h=n.depth,d=n.blend,f=n.stencil,p=n.cull,g=n.instances,m=n.scissor,v=n.viewport,y={};a&&(this.uniforms=J4(a),Object.keys(a).forEach((function(e){y[e]=t.prop(e)})));var b={};Object.keys(s).forEach((function(e){b[e]=s[e].get()}));var x=o&&this.generateDefines(o)||"",w={attributes:b,frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n".concat(x,"\n").concat(i),uniforms:y,vert:"\n".concat(x,"\n").concat(r),primitive:C4[void 0===l?TQ.TRIANGLES:l]};g&&(w.instances=g),c&&(w.count=c),u&&(w.elements=u.get()),m&&(w.scissor=m),v&&(w.viewport=v),this.initDepthDrawParams({depth:h},w),this.initBlendDrawParams({blend:d},w),this.initStencilDrawParams({stencil:f},w),this.initCullDrawParams({cull:p},w),this.drawCommand=t(w)}return GZ(e,[{key:"addUniforms",value:function(e){this.uniforms=t6(t6({},this.uniforms),J4(e))}},{key:"draw",value:function(e){var t=t6(t6({},this.uniforms),J4(e.uniforms||{})),n={};Object.keys(t).forEach((function(e){var r=dJ(t[e]);"boolean"===r||"number"===r||Array.isArray(t[e])||t[e].BYTES_PER_ELEMENT?n[e]=t[e]:"string"===r||(n[e]=t[e].get())})),this.drawCommand(n)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(e,t){var n=e.depth;n&&(t.depth={enable:void 0===n.enable||!!n.enable,mask:void 0===n.mask||!!n.mask,func:T4[n.func||TQ.LESS],range:n.range||[0,1]})}},{key:"initBlendDrawParams",value:function(e,t){var n=e.blend;if(n){var r=n.enable,i=n.func,o=n.equation,s=n.color,a=void 0===s?[0,0,0,0]:s;t.blend={enable:!!r,func:{srcRGB:D4[i&&i.srcRGB||TQ.SRC_ALPHA],srcAlpha:D4[i&&i.srcAlpha||TQ.SRC_ALPHA],dstRGB:D4[i&&i.dstRGB||TQ.ONE_MINUS_SRC_ALPHA],dstAlpha:D4[i&&i.dstAlpha||TQ.ONE_MINUS_SRC_ALPHA]},equation:{rgb:P4[o&&o.rgb||TQ.FUNC_ADD],alpha:P4[o&&o.alpha||TQ.FUNC_ADD]},color:a}}}},{key:"initStencilDrawParams",value:function(e,t){var n=e.stencil;if(n){var r=n.enable,i=n.mask,o=void 0===i?-1:i,s=n.func,a=void 0===s?{cmp:TQ.ALWAYS,ref:0,mask:-1}:s,l=n.opFront,c=void 0===l?{fail:TQ.KEEP,zfail:TQ.KEEP,zpass:TQ.KEEP}:l,u=n.opBack,h=void 0===u?{fail:TQ.KEEP,zfail:TQ.KEEP,zpass:TQ.KEEP}:u;t.stencil={enable:!!r,mask:o,func:t6(t6({},a),{},{cmp:N4[a.cmp]}),opFront:{fail:R4[c.fail],zfail:R4[c.zfail],zpass:R4[c.zpass]},opBack:{fail:R4[h.fail],zfail:R4[h.zfail],zpass:R4[h.zpass]}}}}},{key:"initCullDrawParams",value:function(e,t){var n=e.cull;if(n){var r=n.enable,i=n.face,o=void 0===i?TQ.BACK:i;t.cull={enable:!!r,face:I4[o]}}}},{key:"generateDefines",value:function(e){return Object.keys(e).map((function(t){return"#define ".concat(t," ").concat(Number(e[t]))})).join("\n")}}]),e}(),s6=function(){function e(t,n){LZ(this,e),this.texture=void 0,this.width=void 0,this.height=void 0;var r=n.data,i=n.type,o=void 0===i?TQ.UNSIGNED_BYTE:i,s=n.width,a=n.height,l=n.flipY,c=void 0!==l&&l,u=n.format,h=void 0===u?TQ.RGBA:u,d=n.mipmap,f=void 0!==d&&d,p=n.wrapS,g=void 0===p?TQ.CLAMP_TO_EDGE:p,m=n.wrapT,v=void 0===m?TQ.CLAMP_TO_EDGE:m,y=n.aniso,b=void 0===y?0:y,x=n.alignment,w=void 0===x?1:x,C=n.premultiplyAlpha,E=void 0!==C&&C,_=n.mag,S=void 0===_?TQ.NEAREST:_,O=n.min,A=void 0===O?TQ.NEAREST:O,k=n.colorSpace,M=void 0===k?TQ.BROWSER_DEFAULT_WEBGL:k;this.width=s,this.height=a;var T={width:s,height:a,type:_4[o],format:S4[h],wrapS:k4[g],wrapT:k4[v],mag:A4[S],min:A4[A],alignment:w,flipY:c,colorSpace:M4[M],premultiplyAlpha:E,aniso:b};r&&(T.data=r),"number"==typeof f?T.mipmap=O4[f]:"boolean"==typeof f&&(T.mipmap=f),this.texture=t.texture(T)}return GZ(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(e){var t=e.width,n=e.height;this.texture.resize(t,n),this.width=t,this.height=n}},{key:"destroy",value:function(){this.texture.destroy()}}]),e}(),a6=f.injectable()((r6=function(){function e(){var t=this;LZ(this,e),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var e=WZ(VZ.mark((function e(n){return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.uniforms){e.next=3;break}return e.next=3,Promise.all(Object.keys(n.uniforms).map(function(){var e=WZ(VZ.mark((function e(t){var r;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.uniforms[t]||void 0===n.uniforms[t].load){e.next=5;break}return e.next=3,n.uniforms[t].load();case 3:r=e.sent,n.uniforms[t]=r;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return e.abrupt("return",new o6(t.gl,n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.createAttribute=function(e){return new w4(t.gl,e)},this.createBuffer=function(e){return new j4(t.gl,e)},this.createElements=function(e){return new K4(t.gl,e)},this.createTexture2D=function(e){return new s6(t.gl,e)},this.createFramebuffer=function(e){return new Z4(t.gl,e)},this.useFramebuffer=function(e,n){t.gl({framebuffer:e?e.get():null})(n)},this.createComputeModel=function(){var e=WZ(VZ.mark((function e(n){return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new q4(t.gl,n));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.clear=function(e){var n=e.color,r=e.depth,i=e.stencil,o=e.framebuffer,s=void 0===o?null:o,a={color:n,depth:r,stencil:i};a.framebuffer=null===s?s:s.get(),t.gl.clear(a)},this.setScissor=function(e){t.gl&&t.gl._gl&&(e.enable&&e.box?(t.gl._gl.enable(TQ.SCISSOR_TEST),t.gl._gl.scissor(e.box.x,e.box.y,e.box.width,e.box.height)):t.gl._gl.disable(TQ.SCISSOR_TEST),t.gl._refresh())},this.viewport=function(e){var n=e.x,r=e.y,i=e.width,o=e.height;t.gl&&t.gl._gl&&(t.gl._gl.viewport(n,r,i,o),t.gl._refresh())},this.readPixels=function(e){var n=e.framebuffer,r={x:e.x,y:e.y,width:e.width,height:e.height};return n&&(r.framebuffer=n.get()),t.gl.read(r)},this.getCanvas=function(){return t.$canvas},this.getGLContext=function(){return t.gl._gl},this.destroy=function(){t.gl&&(t.gl.destroy(),t.inited=!1)}}var t;return GZ(e,[{key:"init",value:(t=WZ(VZ.mark((function e(t){return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inited){e.next=2;break}return e.abrupt("return");case 2:return this.$canvas=t.canvas,e.next=5,new Promise((function(e,n){x4({canvas:t.canvas,attributes:{alpha:!0,antialias:t.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(t,r){!t&&r||n(t),e(r)}})}));case 5:this.gl=e.sent,this.inited=!0;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),e}(),n6=r6))||n6;function l6(e,t,n,r){if("undefined"!=typeof window){var i=document.getElementsByTagName("head")[0],o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",e),r&&(o.id=r),o.onload=function(){t&&t()},o.onerror=function(t){n&&n("Unable to load script '".concat(e,"'"),t)},i.appendChild(o)}}function c6(e,t){return new Promise((function(t,n){l6(e,(function(){t()}),(function(e,t){n(t)}))}))}function u6(){return h6.apply(this,arguments)}function h6(){return(h6=WZ(VZ.mark((function e(){return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i6){e.next=2;break}return e.abrupt("return",i6);case 2:return e.next=4,c6("https://preview.babylonjs.com/glslang/glslang.js");case 4:return i6=window.glslang("https://preview.babylonjs.com/glslang/glslang.wasm"),e.abrupt("return",i6);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var d6=function(){function e(t,n){LZ(this,e),this.engine=t,this.options=n,this.attribute=void 0,this.buffer=void 0;var r=n,i=r.buffer,o=r.offset,s=r.stride,a=r.normalized,l=r.size,c=r.divisor,u=r.arrayStride,h=r.attributes,d=r.stepMode;this.buffer=i,this.attribute={buffer:i.get(),offset:o||0,stride:s||0,normalized:a||!1,divisor:c||0,arrayStride:u||0,attributes:h,stepMode:d||"vertex"},l&&(this.attribute.size=l)}return GZ(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(e){this.buffer.subData(e)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),f6=function(){function e(t,n){LZ(this,e),this.engine=t,this.options=n,this.buffer=void 0;var r=n,i=r.data,o=r.usage;r.type,this.buffer=this.createBuffer(i instanceof Array?new Float32Array(i):i,o||v3.BufferUsage.Vertex|v3.BufferUsage.CopyDst)}return GZ(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(e){var t=e.data,n=e.offset;this.setSubData(this.buffer,n,t instanceof Array?new Float32Array(t):t)}},{key:"createBuffer",value:function(e,t){var n=e.byteLength%4,r={size:e.byteLength+n,usage:t},i=this.engine.device.createBuffer(r);return this.setSubData(i,0,e),i}},{key:"setSubData",value:function(e,t,n){(W1?this.engine.device.getQueue():this.engine.device.defaultQueue).writeBuffer(e,t,n)}}]),e}();var p6,g6,m6,v6,y6,b6,x6,w6=function(){function e(t,n){LZ(this,e),this.engine=t,this.context=n,this.entity=XZ(),this.uniformGPUBufferLayout=[],this.uniformBuffer=void 0,this.vertexBuffers={},this.outputBuffer=void 0,this.bindGroupEntries=void 0,this.bindGroup=void 0,this.computePipeline=void 0}var t,n,r;return GZ(e,[{key:"init",value:(r=WZ(VZ.mark((function e(){var t,n,r,i,o,s,a,l=this;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.compileComputePipelineStageDescriptor(this.context.shader);case 2:t=e.sent,n=t.computeStage,r=this.context.uniforms.filter((function(e){return e.storageClass===V1.StorageBuffer})),i=this.context.uniforms.filter((function(e){return e.storageClass===V1.Uniform})),o=i.length?1:0,this.bindGroupEntries=[],o&&(s=0,a=[],i.forEach((function(e){if("number"==typeof e.data)l.uniformGPUBufferLayout.push({name:e.name,offset:s}),s+=4,a.push(e.data);else{var t,n=(null===(t=e.data)||void 0===t?void 0:t.length)||1;3===n&&(n=4,e.data.push(0));var r=s/4%4;if(r>0){var i=4-r;if(n>1&&n<=i)2===n&&(3===i&&(s+=4,a.push(0)),a.push.apply(a,z4(e.data)),l.uniformGPUBufferLayout.push({name:e.name,offset:s}));else{for(var o=0;o<i;o++)s+=4,a.push(0);a.push.apply(a,z4(e.data)),l.uniformGPUBufferLayout.push({name:e.name,offset:s})}}s+=4*n}})),this.uniformBuffer=new f6(this.engine,{data:a instanceof Array?new Float32Array(a):a,usage:v3.BufferUsage.Uniform|v3.BufferUsage.CopyDst}),this.bindGroupEntries.push({binding:0,resource:{buffer:this.uniformBuffer.get()}})),r.forEach((function(e){var t;null!==e.data&&(e.type!==z1.Vector4FloatArray&&e.type!==z1.FloatArray||(e.name===l.context.output.name?(t=new f6(l.engine,{data:isFinite(Number(e.data))?[e.data]:e.data,usage:v3.BufferUsage.Storage|v3.BufferUsage.CopyDst|v3.BufferUsage.CopySrc}),l.outputBuffer=t,l.context.output={name:e.name,length:isFinite(Number(e.data))?1:e.data.length,typedArrayConstructor:Float32Array,gpuBuffer:t.get()}):e.isReferer?e.data.model&&e.data.model.outputBuffer&&(t=e.data.model.outputBuffer):t=new f6(l.engine,{data:isFinite(Number(e.data))?[e.data]:e.data,usage:v3.BufferUsage.Storage|v3.BufferUsage.CopyDst|v3.BufferUsage.CopySrc}),l.vertexBuffers[e.name]=t,l.bindGroupEntries.push({binding:o,resource:{name:e.name,refer:t?void 0:e.data,buffer:t?t.get():void 0}}),o++))})),this.computePipeline=this.engine.device.createComputePipeline({computeStage:n}),console.log(this.bindGroupEntries),this.bindGroup=this.engine.device.createBindGroup({layout:this.computePipeline.getBindGroupLayout(0),entries:this.bindGroupEntries});case 13:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"destroy",value:function(){var e=this;this.uniformBuffer&&this.uniformBuffer.destroy(),Object.keys(this.vertexBuffers).forEach((function(t){return e.vertexBuffers[t].destroy()}))}},{key:"readData",value:(n=WZ(VZ.mark((function e(){var t,n,r,i,o,s,a,l,c;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.context.output)){e.next=16;break}if(n=t.length,r=t.typedArrayConstructor,!(i=t.gpuBuffer)){e.next=16;break}return o=n*r.BYTES_PER_ELEMENT,s=this.engine.device.createBuffer({size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),(a=this.engine.device.createCommandEncoder()).copyBufferToBuffer(i,0,s,0,o),(W1?this.engine.device.getQueue():this.engine.device.defaultQueue).submit([a.finish()]),e.next=12,s.mapAsync(v3.MapMode.Read);case 12:return l=s.getMappedRange(),c=new r(l.slice(0)),s.unmap(),e.abrupt("return",c);case 16:return e.abrupt("return",new Float32Array);case 17:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"run",value:function(){var e;this.engine.currentComputePass&&(this.engine.currentComputePass.setPipeline(this.computePipeline),this.engine.currentComputePass.setBindGroup(0,this.bindGroup),(e=this.engine.currentComputePass).dispatch.apply(e,z4(this.context.dispatch)))}},{key:"updateBuffer",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.vertexBuffers[e];r&&r.subData({data:t,offset:n})}},{key:"updateUniform",value:function(e,t){var n=this.uniformGPUBufferLayout.find((function(t){return t.name===e}));n&&this.uniformBuffer.subData({data:Number.isFinite(t)?new Float32Array([t]):new Float32Array(t),offset:n.offset})}},{key:"confirmInput",value:function(e,t){var n=this.vertexBuffers[t],r=e.outputBuffer;if(n&&r&&n!==r){var i=this.engine.device.createCommandEncoder(),o=e.context.output,s=o.length*o.typedArrayConstructor.BYTES_PER_ELEMENT;i.copyBufferToBuffer(r.get(),0,n.get(),0,s),(W1?this.engine.device.getQueue():this.engine.device.defaultQueue).submit([i.finish()])}}},{key:"compileShaderToSpirV",value:function(e,t,n){return this.compileRawShaderToSpirV(n+e,t)}},{key:"compileRawShaderToSpirV",value:function(e,t){return this.engine.glslang.compileGLSL(e,t)}},{key:"compileComputePipelineStageDescriptor",value:(t=WZ(VZ.mark((function e(t){var n;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,this.engine.options.useWGSL){e.next=6;break}return e.next=5,this.compileShaderToSpirV(t,"compute","#version 450\n");case 5:n=e.sent;case 6:return e.abrupt("return",{computeStage:{module:this.engine.device.createShaderModule({code:n,isWHLSL:W1}),entryPoint:"main"}});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),C6=function(){function e(t,n){LZ(this,e),this.engine=t,this.options=n,this.indexCount=void 0,this.buffer=void 0;var r=n,i=r.data;r.usage,r.type;var o=r.count;this.indexCount=o||0,this.buffer=new f6(t,{data:i instanceof Array?new Uint16Array(i):i,usage:v3.BufferUsage.Index|v3.BufferUsage.CopyDst})}return GZ(e,[{key:"get",value:function(){return this.buffer}},{key:"subData",value:function(e){this.buffer.subData(e)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),E6=function(){function e(t,n){LZ(this,e),this.engine=t,this.options=n,this.colorTexture=void 0,this.depthTexture=void 0,this.width=0,this.height=0;var r=n;r.width,r.height;var i=r.color;r.colors;var o=r.depth;r.stencil,i&&(this.colorTexture=i),o&&(this.depthTexture=o)}return GZ(e,[{key:"get",value:function(){var e,t;return{color:null===(e=this.colorTexture)||void 0===e?void 0:e.get(),depth:null===(t=this.depthTexture)||void 0===t?void 0:t.get()}}},{key:"destroy",value:function(){var e,t;null===(e=this.colorTexture)||void 0===e||e.destroy(),null===(t=this.depthTexture)||void 0===t||t.destroy()}},{key:"resize",value:function(e){var t,n,r=e.width,i=e.height;r===this.width&&i===this.height||(null===(t=this.colorTexture)||void 0===t||t.resize({width:r,height:i}),null===(n=this.depthTexture)||void 0===n||n.resize({width:r,height:i}));this.width=r,this.height=i}}]),e}(),_6=(PJ(p6={},TQ.POINTS,v3.PrimitiveTopology.PointList),PJ(p6,TQ.LINES,v3.PrimitiveTopology.LineList),PJ(p6,TQ.LINE_LOOP,v3.PrimitiveTopology.LineList),PJ(p6,TQ.LINE_STRIP,v3.PrimitiveTopology.LineStrip),PJ(p6,TQ.TRIANGLES,v3.PrimitiveTopology.TriangleList),PJ(p6,TQ.TRIANGLE_FAN,v3.PrimitiveTopology.TriangleList),PJ(p6,TQ.TRIANGLE_STRIP,v3.PrimitiveTopology.TriangleStrip),p6),S6=(PJ(g6={},TQ.NEVER,v3.CompareFunction.Never),PJ(g6,TQ.ALWAYS,v3.CompareFunction.Always),PJ(g6,TQ.LESS,v3.CompareFunction.Less),PJ(g6,TQ.LEQUAL,v3.CompareFunction.LessEqual),PJ(g6,TQ.GREATER,v3.CompareFunction.Greater),PJ(g6,TQ.GEQUAL,v3.CompareFunction.GreaterEqual),PJ(g6,TQ.EQUAL,v3.CompareFunction.Equal),PJ(g6,TQ.NOTEQUAL,v3.CompareFunction.NotEqual),g6),O6=(PJ(m6={},TQ.FUNC_ADD,v3.BlendOperation.Add),PJ(m6,TQ.MIN_EXT,v3.BlendOperation.Min),PJ(m6,TQ.MAX_EXT,v3.BlendOperation.Max),PJ(m6,TQ.FUNC_SUBTRACT,v3.BlendOperation.Subtract),PJ(m6,TQ.FUNC_REVERSE_SUBTRACT,v3.BlendOperation.ReverseSubtract),m6),A6=(PJ(v6={},TQ.ZERO,v3.BlendFactor.Zero),PJ(v6,TQ.ONE,v3.BlendFactor.One),PJ(v6,TQ.SRC_COLOR,v3.BlendFactor.SrcColor),PJ(v6,TQ.ONE_MINUS_SRC_COLOR,v3.BlendFactor.OneMinusSrcColor),PJ(v6,TQ.SRC_ALPHA,v3.BlendFactor.SrcAlpha),PJ(v6,TQ.ONE_MINUS_SRC_ALPHA,v3.BlendFactor.OneMinusSrcAlpha),PJ(v6,TQ.DST_COLOR,v3.BlendFactor.DstColor),PJ(v6,TQ.ONE_MINUS_DST_COLOR,v3.BlendFactor.OneMinusDstColor),PJ(v6,TQ.DST_ALPHA,v3.BlendFactor.DstAlpha),PJ(v6,TQ.ONE_MINUS_DST_ALPHA,v3.BlendFactor.OneMinusDstAlpha),PJ(v6,TQ.CONSTANT_COLOR,v3.BlendFactor.BlendColor),PJ(v6,TQ.ONE_MINUS_CONSTANT_COLOR,v3.BlendFactor.OneMinusBlendColor),PJ(v6,TQ.SRC_ALPHA_SATURATE,v3.BlendFactor.SrcAlphaSaturated),v6),k6=(PJ(y6={},TQ.ALPHA,"r8unorm"),PJ(y6,TQ.RGBA,"rgba8unorm"),PJ(y6,TQ.DEPTH_COMPONENT,"depth32float"),PJ(y6,TQ.DEPTH_STENCIL,"depth24plus-stencil8"),y6),M6=(PJ(b6={},TQ.NEAREST,"nearest"),PJ(b6,TQ.LINEAR,"linear"),b6),T6=(PJ(x6={},TQ.REPEAT,"repeat"),PJ(x6,TQ.CLAMP_TO_EDGE,"clamp-to-edge"),PJ(x6,TQ.MIRRORED_REPEAT,"mirror-repeat"),x6);function P6(e){var t=e.cull;return t&&t.enable?t.face?t.face===TQ.FRONT?v3.CullMode.Front:v3.CullMode.Back:void 0:v3.CullMode.None}function D6(e){var t=e.depth;e.stencil;var n={compare:v3.CompareFunction.Always,depthFailOp:v3.StencilOperation.Keep,failOp:v3.StencilOperation.Keep,passOp:v3.StencilOperation.Keep};return{depthWriteEnabled:t&&t.enable,depthCompare:S6[(null==t?void 0:t.func)||TQ.ALWAYS],format:v3.TextureFormat.Depth24PlusStencil8,stencilFront:n,stencilBack:n,stencilReadMask:4294967295,stencilWriteMask:4294967295}}function N6(e,t){var n=e.blend;return[{format:t,alphaBlend:{srcFactor:A6[n&&n.func&&n.func.srcAlpha||TQ.ONE],dstFactor:A6[n&&n.func&&n.func.dstAlpha||TQ.ZERO],operation:O6[n&&n.equation&&n.equation.alpha||TQ.FUNC_ADD]},colorBlend:{srcFactor:A6[n&&n.func&&n.func.srcRGB||TQ.ONE],dstFactor:A6[n&&n.func&&n.func.dstRGB||TQ.ZERO],operation:O6[n&&n.equation&&n.equation.rgb||TQ.FUNC_ADD]},writeMask:v3.ColorWrite.All}]}function R6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I6(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R6(Object(n),!0).forEach((function(t){PJ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R6(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j6(e){for(var t=0,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=0,s=r;o<s.length;o++){var a=s[o];t+=a.length}for(var l=new e(t),c=0,u=0,h=r;u<h.length;u++){var d=h[u];l.set(d,c),c+=d.length}return l}var L6,F6,G6,B6=function(){function e(t,n){LZ(this,e),this.engine=t,this.options=n,this.pipelineLayout=void 0,this.renderPipeline=void 0,this.uniformsBindGroupLayout=void 0,this.uniformBindGroup=void 0,this.uniformBuffer=void 0,this.uniforms={},this.uniformGPUBufferLayout=[],this.attributeCache={},this.indexBuffer=void 0,this.indexCount=void 0}var t,n;return GZ(e,[{key:"init",value:(n=WZ(VZ.mark((function e(){var t,n,r,i,o,s,a,l,c,u,h,d,f,p,g,m,v=this;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.options,n=t.vs,r=t.fs,i=t.attributes,o=t.uniforms,s=t.primitive,a=t.elements,l=t.depth,c=t.blend,u=t.stencil,h=t.cull,e.next=3,this.compilePipelineStageDescriptor(n,r,null);case 3:d=e.sent,f=d.vertexStage,p=d.fragmentStage,o&&this.buildUniformBindGroup(o),a&&(this.indexBuffer=a.get(),this.indexCount=a.indexCount),g={vertexBuffers:Object.keys(i).map((function(e,t){var n=i[e],r=n.get(),o=r.arrayStride,s=r.stepMode,a=r.attributes;return v.attributeCache[e]=n,{arrayStride:o,stepMode:s,attributes:a}}))},m={sampleCount:this.engine.mainPassSampleCount,primitiveTopology:_6[s||TQ.TRIANGLES],rasterizationState:I6(I6({},this.getDefaultRasterizationStateDescriptor()),{},{cullMode:P6({cull:h})}),depthStencilState:D6({depth:l,stencil:u}),colorStates:N6({blend:c},this.engine.options.swapChainFormat),layout:this.pipelineLayout,vertexStage:f,fragmentStage:p,vertexState:g},this.renderPipeline=this.engine.device.createRenderPipeline(m);case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"addUniforms",value:function(e){this.uniforms=I6(I6({},this.uniforms),J4(e))}},{key:"draw",value:function(e){var t=this,n=this.engine.getCurrentRenderPass(),r=I6(I6({},this.uniforms),J4(e.uniforms||{})),i=[];Object.keys(r).forEach((function(e){var n=dJ(r[e]);if("boolean"===n||"number"===n||Array.isArray(r[e])||r[e].BYTES_PER_ELEMENT){var o,s=null===(o=t.uniformGPUBufferLayout.find((function(t){return t.name===e})))||void 0===o?void 0:o.offset;null!==s&&t.uniformBuffer.subData({data:r[e],offset:s})}else{var a,l=null===(a=t.uniformGPUBufferLayout.find((function(t){return t.name===e})))||void 0===a?void 0:a.offset;if(null!==l){var c=r[e].get(),u=c.color||c,h=u.texture,d=u.sampler;d&&(i.push({binding:l,resource:d}),l++),i.push({binding:l,resource:h.createView()})}}})),this.uniformBuffer&&(i[0]={binding:0,resource:{buffer:this.uniformBuffer.get()}}),this.uniformBindGroup=this.engine.device.createBindGroup({layout:this.uniformsBindGroupLayout,entries:i}),this.renderPipeline&&n.setPipeline(this.renderPipeline),n.setBindGroup(0,this.uniformBindGroup),this.indexBuffer&&n.setIndexBuffer(this.indexBuffer.get(),v3.IndexFormat.Uint32,0),Object.keys(this.attributeCache).forEach((function(e,r){n.setVertexBuffer(0+r,t.attributeCache[e].get().buffer,0)})),this.indexBuffer?n.drawIndexed(this.indexCount,this.options.instances||1,0,0,0):n.draw(this.options.count||0,this.options.instances||0,0,0)}},{key:"destroy",value:function(){throw new Error("Method not implemented.")}},{key:"compilePipelineStageDescriptor",value:(t=WZ(VZ.mark((function e(t,n,r){var i,o,s;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i="#version 450\n",o=t,s=n,this.engine.options.useWGSL){e.next=10;break}return e.next=6,this.compileShaderToSpirV(t,"vertex",i);case 6:return o=e.sent,e.next=9,this.compileShaderToSpirV(n,"fragment",i);case 9:s=e.sent;case 10:return e.abrupt("return",this.createPipelineStageDescriptor(o,s));case 11:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"compileShaderToSpirV",value:function(e,t,n){return this.compileRawShaderToSpirV(n+e,t)}},{key:"compileRawShaderToSpirV",value:function(e,t){return this.engine.glslang.compileGLSL(e,t)}},{key:"createPipelineStageDescriptor",value:function(e,t){return{vertexStage:{module:this.engine.device.createShaderModule({code:e,isWHLSL:W1}),entryPoint:"main"},fragmentStage:{module:this.engine.device.createShaderModule({code:t,isWHLSL:W1}),entryPoint:"main"}}}},{key:"getDefaultRasterizationStateDescriptor",value:function(){return{frontFace:v3.FrontFace.CCW,cullMode:v3.CullMode.None,depthBias:0,depthBiasSlopeScale:0,depthBiasClamp:0}}},{key:"buildUniformBindGroup",value:function(e){var t=this,n=0,r=j6.apply(void 0,[Float32Array].concat(z4(Object.keys(e).map((function(r){return e[r]?(t.uniformGPUBufferLayout.push({name:r,offset:n}),n+=4*(e[r].length||1),e[r]):[]}))))),i=[],o=!1;r.length&&(o=!0,i.push({binding:0,visibility:v3.ShaderStage.Fragment|v3.ShaderStage.Vertex,type:v3.BindingType.UniformBuffer})),Object.keys(e).filter((function(t){return null===e[t]})).forEach((function(e,n){t.uniformGPUBufferLayout.push({name:e,offset:2*n+(o?1:0)}),i.push({binding:2*n+(o?1:0),visibility:v3.ShaderStage.Fragment,type:v3.BindingType.Sampler},{binding:2*n+(o?1:0)+1,visibility:v3.ShaderStage.Fragment,type:v3.BindingType.SampledTexture})})),this.uniformsBindGroupLayout=this.engine.device.createBindGroupLayout({entries:i}),this.pipelineLayout=this.engine.device.createPipelineLayout({bindGroupLayouts:[this.uniformsBindGroupLayout]}),o&&(this.uniformBuffer=new f6(this.engine,{data:r instanceof Array?new Float32Array(r):r,usage:v3.BufferUsage.Uniform|v3.BufferUsage.CopyDst}))}}]),e}(),z6=function(){function e(t,n){LZ(this,e),this.engine=t,this.options=n,this.texture=void 0,this.sampler=void 0,this.width=void 0,this.height=void 0,this.createTexture()}return GZ(e,[{key:"get",value:function(){return{texture:this.texture,sampler:this.sampler}}},{key:"update",value:function(){}},{key:"resize",value:function(e){var t=e.width,n=e.height;t===this.width&&n===this.height||(this.destroy(),this.createTexture()),this.width=t,this.height=n}},{key:"destroy",value:function(){this.texture&&this.texture.destroy()}},{key:"createTexture",value:function(){var e=this.options;e.data;var t=e.type;void 0===t&&TQ.UNSIGNED_BYTE;var n=e.width,r=e.height;e.flipY;var i=e.format,o=void 0===i?TQ.RGBA:i;e.mipmap;var s=e.wrapS,a=void 0===s?TQ.CLAMP_TO_EDGE:s,l=e.wrapT,c=void 0===l?TQ.CLAMP_TO_EDGE:l,u=e.aniso,h=void 0===u?0:u;e.alignment,e.premultiplyAlpha;var d=e.mag,f=void 0===d?TQ.NEAREST:d,p=e.min,g=void 0===p?TQ.NEAREST:p,m=e.colorSpace;void 0===m&&TQ.BROWSER_DEFAULT_WEBGL;var v=e.usage;this.width=n,this.height=r,this.texture=this.engine.device.createTexture({size:[n,r,1],mipLevelCount:1,sampleCount:1,dimension:v3.TextureDimension.E2d,format:k6[o],usage:v||v3.TextureUsage.Sampled|v3.TextureUsage.CopyDst}),(!v||v&v3.TextureUsage.Sampled)&&(this.sampler=this.engine.device.createSampler({addressModeU:T6[a],addressModeV:T6[c],addressModeW:T6[a],magFilter:M6[f],minFilter:M6[g],maxAnisotropy:h}))}}]),e}(),U6=f.injectable()((F6=function(){function e(){var t=this;LZ(this,e),this.supportWebGPU=!0,this.useWGSL=!1,this.options=void 0,this.canvas=void 0,this.context=void 0,this.glslang=void 0,this.adapter=void 0,this.device=void 0,this.swapChain=void 0,this.mainPassSampleCount=void 0,this.mainTexture=void 0,this.depthTexture=void 0,this.mainColorAttachments=void 0,this.mainTextureExtends=void 0,this.mainDepthAttachment=void 0,this.uploadEncoder=void 0,this.renderEncoder=void 0,this.computeEncoder=void 0,this.renderTargetEncoder=void 0,this.commandBuffers=new Array(4).fill(void 0),this.currentRenderPass=null,this.mainRenderPass=null,this.currentRenderTargetViewDescriptor=void 0,this.currentComputePass=null,this.bundleEncoder=void 0,this.tempBuffers=[],this.currentRenderTarget=null,this.uploadEncoderDescriptor={label:"upload"},this.renderEncoderDescriptor={label:"render"},this.renderTargetEncoderDescriptor={label:"renderTarget"},this.computeEncoderDescriptor={label:"compute"},this.pipelines={},this.computePipelines={},this.defaultSampleCount=4,this.clearDepthValue=1,this.clearStencilValue=0,this.transientViewport={x:1/0,y:0,width:0,height:0},this.cachedViewport={x:0,y:0,width:0,height:0},this.clear=function(e){e.framebuffer;var n=e.color,r=e.depth,i=e.stencil;t.options.supportCompute&&t.startComputePass(),t.currentRenderTarget?(t.currentRenderPass&&t.endRenderTargetRenderPass(),t.startRenderTargetRenderPass(t.currentRenderTarget,n||null,!!r,!!i)):(t.mainColorAttachments[0].loadValue=n||v3.LoadOp.Load,t.mainDepthAttachment.depthLoadValue=r||v3.LoadOp.Load,t.mainDepthAttachment.stencilLoadValue=i?t.clearStencilValue:v3.LoadOp.Load,t.mainRenderPass&&t.endMainRenderPass(),t.startMainRenderPass())},this.createModel=function(){var e=WZ(VZ.mark((function e(n){var r;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new B6(t,n),e.next=3,r.init();case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.createAttribute=function(e){return new d6(t,e)},this.createBuffer=function(e){return new f6(t,e)},this.createElements=function(e){return new C6(t,e)},this.createTexture2D=function(e){return new z6(t,e)},this.createFramebuffer=function(e){return new E6(t,e)},this.useFramebuffer=function(e,n){t.currentRenderTarget&&t.unbindFramebuffer(t.currentRenderTarget),t.currentRenderTarget=e,t.currentRenderTargetViewDescriptor={dimension:v3.TextureViewDimension.E2d,arrayLayerCount:1,aspect:v3.TextureAspect.All},t.currentRenderPass=null,n()},this.createComputeModel=function(){var e=WZ(VZ.mark((function e(n){var r;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new w6(t,n),e.next=3,r.init();case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getCanvas=function(){return t.canvas},this.getGLContext=function(){throw new Error("Method not implemented.")},this.viewport=function(e){var n=e.x,r=e.y,i=e.width,o=e.height;if(t.currentRenderPass){if(t.transientViewport.x!==1/0){t.getCurrentRenderPass().setViewport(t.transientViewport.x,t.transientViewport.y,t.transientViewport.width,t.transientViewport.height,0,1)}else if(n!==t.cachedViewport.x||r!==t.cachedViewport.y||i!==t.cachedViewport.width||o!==t.cachedViewport.height){t.cachedViewport={x:n,y:r,width:i,height:o},t.getCurrentRenderPass().setViewport(n,r,i,o,0,1)}}else t.transientViewport={x:n,y:r,width:i,height:o}},this.readPixels=function(e){throw new Error("Method not implemented.")}}var t,n;return GZ(e,[{key:"isFloatSupported",value:function(){return!0}},{key:"init",value:(n=WZ(VZ.mark((function e(t){return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.canvas=t.canvas,this.options=t,this.useWGSL=!!t.useWGSL,this.mainPassSampleCount=t.antialiasing?this.defaultSampleCount:1,e.next=6,this.initGlslang();case 6:this.initContextAndSwapChain(),this.initMainAttachments();case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setScissor",value:function(e){throw new Error("Method not implemented.")}},{key:"destroy",value:function(){this.mainTexture&&this.mainTexture.destroy(),this.depthTexture&&this.depthTexture.destroy(),this.tempBuffers.forEach((function(e){return e.destroy()})),this.tempBuffers=[]}},{key:"beginFrame",value:function(){this.uploadEncoder=this.device.createCommandEncoder(this.uploadEncoderDescriptor),this.renderEncoder=this.device.createCommandEncoder(this.renderEncoderDescriptor),this.renderTargetEncoder=this.device.createCommandEncoder(this.renderTargetEncoderDescriptor),this.options.supportCompute&&(this.computeEncoder=this.device.createCommandEncoder(this.computeEncoderDescriptor))}},{key:"endFrame",value:function(){this.options.supportCompute&&this.endComputePass(),this.endMainRenderPass(),this.commandBuffers[0]=this.uploadEncoder.finish(),this.commandBuffers[1]=this.renderEncoder.finish(),this.options.supportCompute&&(this.commandBuffers[2]=this.computeEncoder.finish()),this.commandBuffers[3]=this.renderTargetEncoder.finish(),W1?this.device.getQueue().submit(this.commandBuffers.filter((function(e){return e}))):this.device.defaultQueue.submit(this.commandBuffers.filter((function(e){return e})))}},{key:"getCurrentRenderPass",value:function(){return this.currentRenderTarget&&!this.currentRenderPass?this.startRenderTargetRenderPass(this.currentRenderTarget,null,!1,!1):this.currentRenderPass||this.startMainRenderPass(),this.currentRenderPass}},{key:"initGlslang",value:(t=WZ(VZ.mark((function e(){var t,n;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u6();case 2:return this.glslang=e.sent,e.next=5,null===(t=navigator)||void 0===t||null===(n=t.gpu)||void 0===n?void 0:n.requestAdapter();case 5:return this.adapter=e.sent,e.next=8,this.adapter.requestDevice();case 8:this.device=e.sent;case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"initContextAndSwapChain",value:function(){this.context=this.canvas.getContext(W1?"gpu":"gpupresent"),this.swapChain=this.context.configureSwapChain({device:this.device,format:this.options.swapChainFormat,usage:v3.TextureUsage.OutputAttachment|v3.TextureUsage.CopySrc})}},{key:"initMainAttachments",value:function(){if(this.mainTextureExtends={width:this.canvas.width,height:this.canvas.height,depth:1},this.options.antialiasing){var e={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:v3.TextureDimension.E2d,format:v3.TextureFormat.BGRA8Unorm,usage:v3.TextureUsage.OutputAttachment};this.mainTexture&&this.mainTexture.destroy(),this.mainTexture=this.device.createTexture(e),this.mainColorAttachments=[{attachment:W1?this.mainTexture.createDefaultView():this.mainTexture.createView(),loadValue:[0,0,0,1],storeOp:v3.StoreOp.Store}]}else this.mainColorAttachments=[{attachment:W1?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),loadValue:[0,0,0,1],storeOp:v3.StoreOp.Store}];var t={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:v3.TextureDimension.E2d,format:W1?"depth32float-stencil8":v3.TextureFormat.Depth24PlusStencil8,usage:v3.TextureUsage.OutputAttachment};this.depthTexture&&this.depthTexture.destroy(),this.depthTexture=this.device.createTexture(t),this.mainDepthAttachment={attachment:W1?this.depthTexture.createDefaultView():this.depthTexture.createView(),depthLoadValue:this.clearDepthValue,depthStoreOp:v3.StoreOp.Store,stencilLoadValue:this.clearStencilValue,stencilStoreOp:v3.StoreOp.Store}}},{key:"startComputePass",value:function(){this.currentComputePass&&this.endComputePass(),this.currentComputePass=this.computeEncoder.beginComputePass()}},{key:"startMainRenderPass",value:function(){this.currentRenderPass&&!this.currentRenderTarget&&this.endMainRenderPass(),this.options.antialiasing?this.mainColorAttachments[0].resolveTarget=W1?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView():this.mainColorAttachments[0].attachment=W1?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),this.currentRenderPass=this.renderEncoder.beginRenderPass({colorAttachments:this.mainColorAttachments,depthStencilAttachment:this.mainDepthAttachment}),this.mainRenderPass=this.currentRenderPass,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"startRenderTargetRenderPass",value:function(e,t,n){var r,i,o,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=null===(r=e.get().color)||void 0===r?void 0:r.texture;a&&(o=a.createView(this.currentRenderTargetViewDescriptor));var l,c=null===(i=e.get().depth)||void 0===i?void 0:i.texture;c&&(l=c.createView());var u=this.renderTargetEncoder.beginRenderPass({colorAttachments:[{attachment:o,loadValue:null!==t?t:v3.LoadOp.Load,storeOp:v3.StoreOp.Store}],depthStencilAttachment:c&&l?{attachment:l,depthLoadValue:n?this.clearDepthValue:v3.LoadOp.Load,depthStoreOp:v3.StoreOp.Store,stencilLoadValue:s?this.clearStencilValue:v3.LoadOp.Load,stencilStoreOp:v3.StoreOp.Store}:void 0});this.currentRenderPass=u,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"endMainRenderPass",value:function(){this.currentRenderPass===this.mainRenderPass&&null!==this.currentRenderPass&&(this.currentRenderPass.endPass(),this.resetCachedViewport(),this.currentRenderPass=null,this.mainRenderPass=null)}},{key:"endComputePass",value:function(){this.currentComputePass&&(this.currentComputePass.endPass(),this.currentComputePass=null)}},{key:"endRenderTargetRenderPass",value:function(){this.currentRenderPass&&(this.currentRenderPass.endPass(),this.resetCachedViewport())}},{key:"resetCachedViewport",value:function(){this.cachedViewport={x:0,y:0,width:0,height:0}}},{key:"unbindFramebuffer",value:function(e){this.currentRenderPass&&this.currentRenderPass!==this.mainRenderPass&&this.endRenderTargetRenderPass(),this.transientViewport.x=1/0,this.currentRenderTarget=null,this.currentRenderPass=this.mainRenderPass}}]),e}(),L6=F6))||L6;function V6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var H6,W6=4/64,$6=f.injectable()(G6=function(e){cJ(n,e);var t=V6(n);function n(){return LZ(this,n),t.apply(this,arguments)}return GZ(n,[{key:"onEntityCreated",value:function(){var e=this.config,t=e.widthSegments,n=void 0===t?1:t,r=e.heightSegments,i=void 0===r?1:r,o=e.depthSegments,s=void 0===o?1:o,a=e.halfExtents,l=void 0===a?KJ(.5,.5,.5):a,c=n,u=i,h=s,d=nJ(l,3),f=d[0],p=d[1],g=d[2],m=[KJ(-f,-p,g),KJ(f,-p,g),KJ(f,p,g),KJ(-f,p,g),KJ(f,-p,-g),KJ(-f,-p,-g),KJ(-f,p,-g),KJ(f,p,-g)],v=[[0,1,3],[4,5,7],[3,2,6],[1,0,4],[1,4,2],[5,0,6]],y=[[0,0,1],[0,0,-1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0]],b=1,x=2,w=3,C=4,E=5,_=[],S=[],O=[],A=[],k=0,M=function(e,t,n){var r,i,o,s;for(o=0;o<=t;o++)for(s=0;s<=n;s++){var a=XJ(),l=XJ(),c=XJ(),u=XJ();iQ(a,m[v[e][0]],m[v[e][1]],o/t),iQ(l,m[v[e][0]],m[v[e][2]],s/n),aQ(c,l,m[v[e][0]]),QJ(u,a,c),r=o/t,i=s/n,_.push(u[0],u[1],u[2]),S.push(y[e][0],y[e][1],y[e][2]),O.push(r,i),r=.875*(r/=3)+W6,i=.875*(i/=3)+W6,r+=e%3/3,i+=Math.floor(e/3)/3,o<t&&s<n&&(A.push(k+n+1,k+1,k),A.push(k+n+1,k+n+2,k+1)),k++}};M(0,c,u),M(b,c,u),M(x,c,h),M(w,c,h),M(C,h,u),M(E,h,u);var T=G1(_),P=this.getComponent();P.indices=Uint32Array.from(A),P.aabb=T,P.vertexCount=k,P.attributes=[{dirty:!0,name:"position",data:Float32Array.from(_),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(S),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(O),arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}(m3))||G6;function X6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var Y6,q6=f.injectable()(H6=function(e){cJ(n,e);var t=X6(n);function n(){return LZ(this,n),t.apply(this,arguments)}return GZ(n,[{key:"onEntityCreated",value:function(){var e=this.config.geometries,t=void 0===e?[]:e,n=this.getComponent();n.aabb=new a0;var r=[],i=[],o=0;t.forEach((function(e){var t=e.aabb,s=e.indices,a=e.vertexCount,l=e.attributes;n.aabb.add(t),n.vertexCount+=a,s&&i.push.apply(i,z4(s.map((function(e){return e+o})))),o+=a,l.forEach((function(e,t){r[t]?e.data&&($1(e.data)?r[t].push(e.data):D3(e.data)?r[t].data=function(e,t){if(!e&&!t)throw new Error("Please specify valid arguments for parameters a and b.");if(!t||0===t.length)return e;if(!e||0===e.length)return t;if(Object.prototype.toString.call(e)!==Object.prototype.toString.call(t))throw new Error("The types of the two arguments passed for parameters a and b do not match.");var n=new e.constructor(e.length+t.length);return n.set(e),n.set(t,e.length),n}(r[t].data,e.data):r[t].data=r[t].data.concat(e.data)):(r[t]=e,r[t].dirty=!0)}))})),n.attributes=r,n.indices=Uint32Array.from(i),n.dirty=!0}}]),n}(m3))||H6;function K6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var Z6,J6=f.injectable()(Y6=function(e){cJ(n,e);var t=K6(n);function n(){return LZ(this,n),t.apply(this,arguments)}return GZ(n,[{key:"onEntityCreated",value:function(){for(var e=this.config,t=e.halfExtents,n=void 0===t?[.5,.5]:t,r=e.widthSegments,i=void 0===r?5:r,o=e.lengthSegments,s=void 0===o?5:o,a=[],l=[],c=[],u=[],h=0,d=0;d<=i;d++)for(var f=0;f<=s;f++){var p=-n[0]+2*n[0]*d/i,g=-(-n[1]+2*n[1]*f/s),m=d/i,v=f/s;a.push(p,0,g),l.push(0,1,0),c.push(m,v),d<i&&f<s&&(u.push(h+s+1,h+1,h),u.push(h+s+1,h+s+2,h+1)),h++}var y=G1(a),b=this.getComponent();b.indices=Uint32Array.from(u),b.aabb=y,b.vertexCount=h,b.attributes=[{dirty:!0,name:"position",data:Float32Array.from(a),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(l),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(c),arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}(m3))||Y6;function Q6(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var e5,t5,n5,r5,i5,o5,s5,a5,l5=f.injectable()(Z6=function(e){cJ(n,e);var t=Q6(n);function n(){return LZ(this,n),t.apply(this,arguments)}return GZ(n,[{key:"onEntityCreated",value:function(){for(var e=this.config,t=e.radius,n=void 0===t?.5:t,r=e.latitudeBands,i=void 0===r?16:r,o=e.longitudeBands,s=void 0===o?16:o,a=[],l=[],c=[],u=[],h=0;h<=i;h++)for(var d=h*Math.PI/i,f=Math.sin(d),p=Math.cos(d),g=0;g<=s;g++){var m=2*g*Math.PI/s-Math.PI/2,v=Math.sin(m),y=Math.cos(m)*f,b=p,x=v*f,w=1-g/s,C=1-h/i;a.push(y*n,b*n,x*n),l.push(y,b,x),c.push(w,C)}for(var E=0;E<i;++E)for(var _=0;_<s;++_){var S=E*(s+1)+_,O=S+s+1;u.push(S+1,O,S),u.push(S+1,O+1,O)}var A=G1(a),k=this.getComponent();k.indices=Uint32Array.from(u),k.aabb=A,k.vertexCount=a.length/3,k.attributes=[{dirty:!0,name:"position",data:Float32Array.from(a),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(l),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(c),arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}(m3))||Z6;function c5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var u5,h5,d5,f5,p5,g5,m5,v5,y5,b5,x5,w5,C5=(e5=f.injectable(),t5=f.inject(rJ.RenderEngine),n5=f.inject(rJ.ShaderModuleService),e5((a5=function(e){cJ(n,e);var t=c5(n);function n(){var e;LZ(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),IZ(e,"engine",o5,pJ(e)),IZ(e,"shaderModuleService",s5,pJ(e)),e}return GZ(n,[{key:"onEntityCreated",value:function(){var e=this.getComponent(),t=this.engine.supportWebGPU?"layout(set = 0, binding = 0) uniform Uniforms {\n  vec4 color;\n  mat4 projectionMatrix;\n  mat4 modelViewMatrix;\n} uniforms;\n\nlayout(location = 0) in vec3 position;\n// layout(location = 1) in vec3 barycentric;\n\nlayout(location = 0) out vec4 fragColor;\n// layout(location = 1) out vec3 v_Barycentric;\n\nvoid main() {\n  gl_Position = uniforms.projectionMatrix * uniforms.modelViewMatrix * vec4(position, 1.0);\n  fragColor = uniforms.color;\n  // v_Barycentric = barycentric;\n}":'attribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform vec4 color;\n\nvarying vec4 fragColor;\n\n#pragma include "uv.vert.declaration"\n\nvoid main() {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  fragColor = color;\n\n  #pragma include "uv.vert.main"\n}',n=this.engine.supportWebGPU?"// layout(set = 0, binding = 1) uniform WireframeUniforms {\n//   float lineWidth;\n//   vec4 lineColor;\n// } wireframe;\n\nlayout(location = 0) in vec4 fragColor;\n// layout(location = 1) in vec3 v_Barycentric;\n\nlayout(location = 0) out vec4 outColor;\n\n// wireframe\n// float edgeFactor() {\n//   vec3 d = fwidth(v_Barycentric);\n//   vec3 a3 = smoothstep(vec3(0.0), d * wireframe.lineWidth, v_Barycentric);\n//   return min(min(a3.x, a3.y), a3.z);\n// }\n\nvoid main() {\n  // outColor = mix(fragColor, wireframe.lineColor, (1.0 - edgeFactor()));\n  outColor = fragColor;\n}":'varying vec4 fragColor;\n\n#pragma include "uv.frag.declaration"\n#pragma include "map.frag.declaration"\n\nvoid main() {\n  vec4 diffuseColor = fragColor;\n\n  #pragma include "map.frag.main"\n\n  gl_FragColor = diffuseColor;\n}';this.shaderModuleService.registerModule("material-basic",{vs:t,fs:n});var r=this.shaderModuleService.getModule("material-basic"),i=r.vs,o=r.fs,s=r.uniforms;e.vertexShaderGLSL=i,e.fragmentShaderGLSL=o,e.setUniform(s),this.config.map&&(e.setDefines({USE_UV:1,USE_MAP:1}),e.setUniform({map:this.config.map,uvTransform:RJ()}))}}]),n}(r4),o5=zZ((i5=a5).prototype,"engine",[t5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s5=zZ(i5.prototype,"shaderModuleService",[n5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r5=i5))||r5);function E5(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var _5=(u5=f.injectable(),h5=f.inject(rJ.Systems),d5=f.named(rJ.MaterialSystem),f5=f.inject(rJ.Systems),p5=f.named(rJ.GeometrySystem),g5=f.inject(rJ.ShaderModuleService),u5((w5=function(e){cJ(n,e);var t=E5(n);function n(){var e;LZ(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),IZ(e,"materialSystem",y5,pJ(e)),IZ(e,"geometrySystem",b5,pJ(e)),IZ(e,"shaderModuleService",x5,pJ(e)),e}return GZ(n,[{key:"onAttributeChanged",value:function(e){var t=e.name,n=e.data,r=this.getMeshComponent();r&&r.material&&("gridColor"===t?(r.material.setUniform("u_GridColor",n),r.material.setUniform("u_GridColor2",n)):"gridSize"===t&&(r.material.setUniform("u_GridSize",n),r.material.setUniform("u_GridSize2",n)))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:"attribute vec3 a_Position;\n\nvarying vec3 v_Position;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nvoid main() {\n  v_Position = a_Position;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_Position, 1.);\n}",fs:"// generate grid, borrow from clay.gl viewer\n// @see https://github.com/pissang/clay-viewer/blob/master/src/graphic/ground.glsl\n#extension GL_OES_standard_derivatives : enable\n\nvarying vec3 v_Position;\n// varying vec3 v_Normal;\n\nuniform float u_GridSize : 5;\nuniform float u_GridSize2 : .5;\nuniform vec4 u_GridColor : [0, 0, 0, 1];\nuniform vec4 u_GridColor2 : [0.3, 0.3, 0.3, 1];\nuniform bool u_GridEnabled : true;\n\n// uniform vec3 u_LightDirection;\n// uniform vec3 u_LightColor;\n// uniform vec3 u_Camera;\n\nvoid main() {\n  // vec3 n = v_Normal;\n  // vec3 l = normalize(u_LightDirection);\n  // float NdotL = clamp(dot(n, l), 0.001, 1.0);\n\n  gl_FragColor = vec4(1.);\n\n  if (u_GridEnabled) {\n    float wx = v_Position.x;\n    float wz = v_Position.z;\n    // float x0 = abs(fract(wx / u_GridSize - 0.5) - 0.5) / fwidth(wx) * u_GridSize / 2.0;\n    // float z0 = abs(fract(wz / u_GridSize - 0.5) - 0.5) / fwidth(wz) * u_GridSize / 2.0;\n\n    float x1 = abs(fract(wx / u_GridSize2 - 0.5) - 0.5) / fwidth(wx) * u_GridSize2;\n    float z1 = abs(fract(wz / u_GridSize2 - 0.5) - 0.5) / fwidth(wz) * u_GridSize2;\n\n    // float v0 = 1.0 - clamp(min(x0, z0), 0.0, 1.0);\n    float v1 = 1.0 - clamp(min(x1, z1), 0.0, 1.0);\n    // if (v0 > 0.1) {\n        // gl_FragColor = mix(gl_FragColor, u_GridColor, v0);\n    // }\n    // else {\n        gl_FragColor = mix(gl_FragColor, u_GridColor2, v1);\n    // }\n  }\n\n  // float shadowFactor = calcShadow(u_ShadowMap, v_PositionFromLight, l, n);\n  // vec3 diffuseColor = u_LightColor * NdotL * shadowFactor;\n\n  // gl_FragColor.rgb *= diffuseColor;\n}"});var e=this.shaderModuleService.getModule("grid"),t=e.vs,n=e.fs,r=e.uniforms,i=this.materialSystem.createShaderMaterial({vertexShader:t,fragmentShader:n});this.setMaterial(i);var o=this.geometrySystem.createBufferGeometry({vertexCount:4});this.setGeometry(o),i.setCull({enable:!1,face:TQ.BACK}).setDepth({enable:!0,func:TQ.LESS}),i.setUniform(r),this.setAttributes({gridColor:this.config.gridColor,gridSize:this.config.gridSize}),o.setIndex([0,3,2,2,1,0]),o.setAttribute("a_Position",Float32Array.from([-4,-1,-4,4,-1,-4,4,-1,4,-4,-1,4]),{arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})}}]),n}(i4),y5=zZ((v5=w5).prototype,"materialSystem",[h5,d5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b5=zZ(v5.prototype,"geometrySystem",[f5,p5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x5=zZ(v5.prototype,"shaderModuleService",[g5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m5=v5))||m5),S5=1e-6,O5=function(){var e=new Float32Array(2);return e[0]=0,e[1]=0,e};var A5=function(e){var t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t};var k5=function(e,t){var n=new Float32Array(2);return n[0]=e,n[1]=t,n};var M5=function(e,t){return e[0]=t[0],e[1]=t[1],e};var T5=function(e,t,n){return e[0]=t,e[1]=n,e};var P5=function(e,t){var n=e[0],r=e[1],i=t[0],o=t[1];return Math.abs(n-i)<=D5*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=D5*Math.max(1,Math.abs(r),Math.abs(o))},D5=S5;var N5=function(e,t){return e[0]===t[0]&&e[1]===t[1]};var R5=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e};var I5=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e};var j5=I5,L5=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e};var F5=L5,G5=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e};var B5=G5,z5=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e};var U5=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e};var V5=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e};var H5=function(e,t,n){var r=Math.cos(n),i=Math.sin(n),o=t[0],s=t[1];return e[0]=o*r-s*i,e[1]=o*i+s*r,e};var W5=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e};var $5=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e};var X5=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e};var Y5=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e};var q5=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e};var K5=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)};var Z5=K5,J5=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r};var Q5=J5,e8=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)};var t8=e8,n8=function(e){var t=e[0],n=e[1];return t*t+n*n};var r8=n8,i8=function(e,t){return e[0]=-t[0],e[1]=-t[1],e};var o8=function(e,t){var n=t[0],r=t[1],i=n*n+r*r;i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i);return e};var s8=function(e,t){return e[0]*t[0]+e[1]*t[1]};var a8=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e};var l8=function(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e};var c8=function(e,t){t=t||1;var n=2*Math.random()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e};var u8=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e};var h8=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e};var d8=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e};var f8=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e};var p8=function(e,t,n,r,i,o){var s,a;t||(t=2);n||(n=0);a=r?Math.min(r*t+n,e.length):e.length;for(s=n;s<a;s+=t)g8[0]=e[s],g8[1]=e[s+1],i(g8,g8,o),e[s]=g8[0],e[s+1]=g8[1];return e},g8=O5();var m8=function(e,t,n){var r=t[0]*t[0]+t[1]*t[1];if(r>n*n){var i=Math.sqrt(r);e[0]=t[0]/i*n,e[1]=t[1]/i*n}else e[0]=t[0],e[1]=t[1];return e};var v8,y8,b8,x8,w8,C8,E8,_8,S8,O8,A8,k8,M8={EPSILON:S5,create:O5,clone:A5,fromValues:k5,copy:M5,set:T5,equals:P5,exactEquals:N5,add:R5,subtract:I5,sub:j5,multiply:L5,mul:F5,divide:G5,div:B5,inverse:z5,min:U5,max:V5,rotate:H5,floor:W5,ceil:$5,round:X5,scale:Y5,scaleAndAdd:q5,distance:K5,dist:Z5,squaredDistance:J5,sqrDist:Q5,length:e8,len:t8,squaredLength:n8,sqrLen:r8,negate:i8,normalize:o8,dot:s8,cross:a8,lerp:l8,random:c8,transformMat2:u8,transformMat2d:h8,transformMat3:d8,transformMat4:f8,forEach:p8,limit:m8},T8=R5,P8=T5,D8=o8,N8=I5,R8=s8,I8=[0,0],j8=function(e,t,n,r,i){return T8(e,n,r),D8(e,e),P8(t,-e[1],e[0]),P8(I8,-n[1],n[0]),i/R8(t,I8)},L8=function(e,t){return P8(e,-t[1],t[0]),e},F8=function(e,t,n){return N8(e,t,n),D8(e,e),e};function G8(e,t,n,r,i){B8(t,r,-i),B8(t,r,i),e.push(n),e.push(n)}function B8(e,t,n){e.push([[t[0],t[1]],n])}function z8(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var U8,V8,H8,W8,$8,X8,Y8,q8,K8,Z8,J8,Q8,e7=(v8=f.injectable(),y8=f.inject(rJ.Systems),b8=f.named(rJ.MaterialSystem),x8=f.inject(rJ.Systems),w8=f.named(rJ.GeometrySystem),C8=f.inject(rJ.ShaderModuleService),v8((k8=function(e){cJ(n,e);var t=z8(n);function n(){var e;LZ(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),IZ(e,"materialSystem",S8,pJ(e)),IZ(e,"geometrySystem",O8,pJ(e)),IZ(e,"shaderModuleService",A8,pJ(e)),e.vertexCount=void 0,e}return GZ(n,[{key:"onAttributeChanged",value:function(e){var t=e.name,n=e.data,r=this.getMeshComponent();if(r&&r.material)switch(t){case"dashArray":r.material.setUniform("u_dash_array",n);break;case"dashOffset":r.material.setUniform("u_dash_offset",n);break;case"dashRatio":r.material.setUniform("u_dash_ratio",n);break;case"thickness":r.material.setUniform("u_thickness",n);break;case"color":var i=new Array(this.vertexCount).fill(void 0).map((function(){return n})).reduce((function(e,t){return[].concat(z4(e),z4(t))}),[]);r.geometry.setAttribute("a_color",Float32Array.from(i),{arrayStride:16,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]})}}},{key:"onEntityCreated",value:function(){var e=this;this.shaderModuleService.registerModule("line",{vs:"attribute vec2 a_pos;\nattribute vec4 a_color;\nattribute float a_line_miter;\nattribute vec2 a_line_normal;\nattribute float a_counters;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform float u_thickness : 0.02;\nuniform vec2 u_viewport;\n\nvarying vec4 v_color;\nvarying vec2 v_normal;\nvarying float v_counters;\n\nvoid main() {\n  v_color = a_color;\n  v_counters = a_counters;\n\n  vec3 normal = normalize(vec3(a_line_normal, 0.0));\n\n  vec4 offset = vec4(normal * u_thickness / 2.0 * a_line_miter, 0.0);\n\n  v_normal = vec2(normal * sign(a_line_miter));\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_pos, 0.0, 1.0) + offset;\n}\n",fs:"uniform float u_dash_array : 0.02;\nuniform float u_dash_offset : 0;\nuniform float u_dash_ratio : 0;\nuniform float u_thickness : 0.02;\n\nvarying vec4 v_color;\nvarying vec2 v_normal;\nvarying float v_counters;\n\nvoid main() {\n    float blur = 1. - smoothstep(0.98, 1., length(v_normal));\n\n    gl_FragColor = v_color;\n    gl_FragColor.a *= blur * ceil(mod(v_counters + u_dash_offset, u_dash_array) - (u_dash_array * u_dash_ratio));\n}"});var t=this.shaderModuleService.getModule("line"),n=t.vs,r=t.fs,i=t.uniforms,o=this.materialSystem.createShaderMaterial({vertexShader:n,fragmentShader:r}),s=function(e,t,n){var r=[0,0],i=[0,0],o=[0,0],s=[0,0],a=-1,l=!1,c=null,u=M8.create(),h=n||0,d=[],f=[],p=[],g=[0,0];t&&(e=e.slice()).push(e[0]);for(var m=e.length,v=1;v<m;v++){var y=h,b=e[v-1],x=e[v],w=v<e.length-1?e[v+1]:null;if(g.push(v/m,v/m),F8(r,x,b),c||L8(c=[0,0],r),l||(l=!0,G8(f,d,b,c,1)),p.push([y+0,y+1,y+2]),w){F8(i,w,x);var C=j8(o,s,r,i,1),E=M8.dot(o,c)<0?-1:1,_=C>3;if(!isFinite(C)){L8(c,r),G8(f,d,x,c,1),p.push(1===a?[y,y+2,y+3]:[y+2,y+1,y+3]),h+=2,a=E;continue}_?(C=3,g.push(v/m),B8(d,c,-E),f.push(x),B8(d,s,C*E),f.push(x),p.push(a!==-E?[y,y+2,y+3]:[y+2,y+1,y+3]),p.push([y+2,y+3,y+4]),L8(u,i),M8.copy(c,u),B8(d,c,-E),f.push(x),h+=3):(G8(f,d,x,s,C),p.push(1===a?[y,y+2,y+3]:[y+2,y+1,y+3]),E=-1,M8.copy(c,s),h+=2),a=E}else L8(c,r),G8(f,d,x,c,1),p.push(1===a?[y,y+2,y+3]:[y+2,y+1,y+3]),h+=2}return{normals:d,attrIndex:p,attrPos:f,attrCounters:g}}(this.config.points,!1),a=s.normals,l=s.attrIndex,c=s.attrPos,u=s.attrCounters,h=c.length;this.vertexCount=h;var d=this.geometrySystem.createBufferGeometry({vertexCount:h});this.setMaterial(o),this.setGeometry(d),o.setCull({enable:!1,face:TQ.BACK}).setUniform(i),this.setAttributes({dashArray:this.config.dashArray,dashOffset:this.config.dashOffset,dashRatio:this.config.dashRatio,thickness:this.config.thickness});var f=[],p=[];a.forEach((function(e){var t=e[0],n=e[1];f.push([t[0],t[1]]),p.push(n)})),d.setIndex(l.reduce((function(e,t){return[].concat(z4(e),z4(t))}),[])),d.setAttribute("a_pos",Float32Array.from(c.reduce((function(e,t){return[].concat(z4(e),z4(t))}),[])),{arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]});var g=new Array(h).fill(void 0).map((function(){return z4(e.config.color)})).reduce((function(e,t){return[].concat(z4(e),z4(t))}),[]);d.setAttribute("a_color",Float32Array.from(g),{arrayStride:16,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]}),d.setAttribute("a_line_miter",Float32Array.from(p),{arrayStride:4,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float"}]}),d.setAttribute("a_line_normal",Float32Array.from(f.reduce((function(e,t){return[].concat(z4(e),z4(t))}),[])),{arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:3,offset:0,format:"float2"}]}),d.setAttribute("a_counters",Float32Array.from(u),{arrayStride:4,stepMode:"vertex",attributes:[{shaderLocation:4,offset:0,format:"float"}]})}}]),n}(i4),S8=zZ((_8=k8).prototype,"materialSystem",[y8,b8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O8=zZ(_8.prototype,"geometrySystem",[x8,w8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A8=zZ(_8.prototype,"shaderModuleService",[C8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E8=_8))||E8);function t7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n7(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vJ(e);if(t){var i=vJ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gJ(this,n)}}var r7,i7,o7,s7,a7,l7,c7,u7,h7,d7,f7=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],p7=(U8=f.injectable(),V8=f.inject(rJ.Systems),H8=f.named(rJ.MaterialSystem),W8=f.inject(rJ.Systems),$8=f.named(rJ.GeometrySystem),X8=f.inject(rJ.ShaderModuleService),U8((Q8=function(e){cJ(n,e);var t=n7(n);function n(){var e;LZ(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),IZ(e,"materialSystem",K8,pJ(e)),IZ(e,"geometrySystem",Z8,pJ(e)),IZ(e,"shaderModuleService",J8,pJ(e)),e}return GZ(n,[{key:"onAttributeChanged",value:function(e){var t=e.name,n=e.data,r=this.getMeshComponent();r&&r.material&&("strokeWidth"===t?r.material.setUniform("u_stroke_width",n):"strokeColor"===t?r.material.setUniform("u_stroke_color",n):"strokeOpacity"===t?r.material.setUniform("u_stroke_opacity",n):"opacity"===t?r.material.setUniform("u_opacity",n):"blur"===t&&r.material.setUniform("u_blur",n))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:'attribute vec2 position;\nattribute vec4 color;\nattribute float shape;\nattribute vec2 offset;\nattribute float size;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nuniform float u_stroke_width : 0.01;\nuniform float u_device_pixel_ratio;\nuniform vec2 u_viewport;\n\nvarying vec4 v_color;\nvarying vec4 v_data;\nvarying float v_radius;\n\n#pragma include "picking"\n\nvoid main() {\n  v_color = color;\n  v_radius = size;\n\n  lowp float antialiasblur = 1.0 / u_device_pixel_ratio * (size + u_stroke_width);\n\n  // construct point coords\n  v_data = vec4(position, antialiasblur, shape);\n\n  gl_Position = projectionMatrix * modelViewMatrix\n    * vec4(position * size + offset, 0.0, 1.0);\n\n  setPickingColor(a_PickingColor);\n}',fs:"uniform float u_blur : 0.05;\nuniform float u_opacity : 0.7;\nuniform float u_stroke_width : 0.01;\nuniform vec4 u_stroke_color : [0, 0, 0, 0];\nuniform float u_stroke_opacity : 1;\n\nvarying vec4 v_color;\nvarying vec4 v_data;\nvarying float v_radius;\n\n#pragma include \"sdf2d\"\n#pragma include \"picking\"\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n\n  float antialiasblur = v_data.z;\n  float antialiased_blur = -max(u_blur, antialiasblur);\n  float r = v_radius / (v_radius + u_stroke_width);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  // if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  // } else if (shape == 1) {\n  //   outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n  //   inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  // } else if (shape == 2) {\n  //   outer_df = sdBox(v_data.xy, vec2(1.));\n  //   inner_df = sdBox(v_data.xy, vec2(r));\n  // } else if (shape == 3) {\n  //   outer_df = sdPentagon(v_data.xy, 0.8);\n  //   inner_df = sdPentagon(v_data.xy, r * 0.8);\n  // } else if (shape == 4) {\n  //   outer_df = sdHexagon(v_data.xy, 0.8);\n  //   inner_df = sdHexagon(v_data.xy, r * 0.8);\n  // } else if (shape == 5) {\n  //   outer_df = sdOctogon(v_data.xy, 1.0);\n  //   inner_df = sdOctogon(v_data.xy, r);\n  // } else if (shape == 6) {\n  //   outer_df = sdHexagram(v_data.xy, 0.52);\n  //   inner_df = sdHexagram(v_data.xy, r * 0.52);\n  // } else if (shape == 7) {\n  //   outer_df = sdRhombus(v_data.xy, vec2(1.0));\n  //   inner_df = sdRhombus(v_data.xy, vec2(r));\n  // } else if (shape == 8) {\n  //   outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n  //   inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  // }\n\n  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);\n\n  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    inner_df\n  );\n  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;\n\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);\n  gl_FragColor.a = gl_FragColor.a * opacity_t;\n\n  gl_FragColor = filterColor(gl_FragColor);\n}"});var e=this.shaderModuleService.getModule("grid"),t=e.vs,n=e.fs,r=e.uniforms,i=this.materialSystem.createShaderMaterial({vertexShader:t,fragmentShader:n,cull:{enable:!1},depth:{enable:!1},blend:{enable:!0,func:{srcRGB:TQ.SRC_ALPHA,dstRGB:TQ.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}});i.setUniform(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?t7(Object(n),!0).forEach((function(t){PJ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t7(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({u_device_pixel_ratio:window.devicePixelRatio},r));var o=this.buildAttributes(),s=this.geometrySystem.createInstancedBufferGeometry({maxInstancedCount:o.instancedOffsets.length/2,vertexCount:6});s.setIndex([0,2,1,0,3,2]),s.setAttribute("position",Float32Array.from(o.positions),{arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]}),s.setAttribute("offset",Float32Array.from(o.instancedOffsets),{arrayStride:8,stepMode:"instance",attributes:[{shaderLocation:1,offset:0,format:"float2"}]}),s.setAttribute("color",Float32Array.from(o.instancedColors),{arrayStride:16,stepMode:"instance",attributes:[{shaderLocation:2,offset:0,format:"float4"}]}),s.setAttribute("size",Float32Array.from(o.instancedSizes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:3,offset:0,format:"float"}]}),s.setAttribute("shape",Float32Array.from(o.instancedShapes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:4,offset:0,format:"float"}]}),s.setAttribute("a_PickingColor",Float32Array.from(o.instancedPickingColors),{arrayStride:12,stepMode:"instance",attributes:[{shaderLocation:6,offset:0,format:"float3"}]}),this.setMaterial(i),this.setGeometry(s)}},{key:"buildAttribute",value:function(e,t,n){var r,i,o,s,a;(r=t.instancedPickingColors).push.apply(r,z4([(a=e.id||n)+1&255,a+1>>8&255,a+1>>8>>8&255])),t.instancedShapes.push(f7.indexOf(e.shape||"circle")),(i=t.instancedColors).push.apply(i,z4(e.color||[1,0,0,1])),(o=t.instancedOffsets).push.apply(o,z4(e.position||[0,0])),(s=t.instancedSizes).push.apply(s,z4(e.size||[.2,.2]))}},{key:"buildAttributes",value:function(){var e=this,t={positions:[1,1,1,-1,-1,-1,-1,1],instancedOffsets:[],instancedColors:[],instancedSizes:[],instancedShapes:[],instancedPickingColors:[]};return Array.isArray(this.config)?this.config.forEach((function(n,r){e.buildAttribute(n,t,r)})):this.buildAttribute(this.config,t,0),t}}]),n}(i4),K8=zZ((q8=Q8).prototype,"materialSystem",[V8,H8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z8=zZ(q8.prototype,"geometrySystem",[W8,$8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J8=zZ(q8.prototype,"shaderModuleService",[X8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y8=q8))||Y8);function g7(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return m7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m7(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function m7(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v7,y7,b7,x7,w7,C7,E7,_7,S7,O7,A7,k7,M7=(r7=f.injectable(),i7=f.inject(rJ.RenderEngine),o7=f.inject(rJ.ShaderModuleService),s7=f.inject(rJ.ConfigService),r7((d7=function(){function e(){LZ(this,e),this.container=void 0,IZ(this,"engine",c7,this),IZ(this,"shaderModule",u7,this),IZ(this,"configService",h7,this),this.inited=!1,this.rendering=!1,this.pendings=[],this.views=[],this.size=void 0}var t,n;return GZ(e,[{key:"init",value:(n=WZ(VZ.mark((function e(){var t,n,r,i,o;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.shaderModule.registerBuiltinModules(),this.shaderModule.registerModule("uv.vert.declaration",{vs:"#ifdef USE_UV\n  attribute vec2 uv;\n\t#ifdef UVS_VERTEX_ONLY\n    vec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif"}),this.shaderModule.registerModule("uv.vert.main",{vs:"#ifdef USE_UV\n  vUv = (uvTransform * vec3(uv, 1)).xy;\n#endif"}),this.shaderModule.registerModule("uv.frag.declaration",{fs:"#if (defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ))\n  varying vec2 vUv;\n#endif"}),this.shaderModule.registerModule("map.frag.declaration",{fs:"#ifdef USE_MAP\n  uniform sampler2D map;\n#endif"}),this.shaderModule.registerModule("map.frag.main",{fs:"#ifdef USE_MAP\n  vec4 texelColor = texture2D(map, vUv);\n  // texelColor = mapTexelToLinear(texelColor);\n  diffuseColor *= texelColor;\n#endif"}),t=this.container.getAll(rJ.Systems),!(n=this.configService.get()).canvas){e.next=30;break}return e.next=11,this.engine.init({canvas:n.canvas,swapChainFormat:v3.TextureFormat.BGRA8Unorm,antialiasing:!1});case 11:r=g7(t),e.prev=12,r.s();case 14:if((i=r.n()).done){e.next=21;break}if(!(o=i.value).initialize){e.next=19;break}return e.next=19,o.initialize();case 19:e.next=14;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(12),r.e(e.t0);case 26:return e.prev=26,r.f(),e.finish(26);case 29:this.inited=!0;case 30:case"end":return e.stop()}}),e,this,[[12,23,26,29]])}))),function(){return n.apply(this,arguments)})},{key:"render",value:(t=WZ(VZ.mark((function e(){var t,n,r,i,o,s,a,l=arguments;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.inited&&!this.rendering){e.next=2;break}return e.abrupt("return");case 2:for(this.pendings.length&&this.pendings.forEach((function(e){e()})),this.rendering=!0,this.engine.beginFrame(),t=this.container.getAll(rJ.Systems),n=l.length,r=new Array(n),i=0;i<n;i++)r[i]=l[i];o=g7(t),e.prev=8,o.s();case 10:if((s=o.n()).done){e.next=17;break}if(!(a=s.value).execute){e.next=15;break}return e.next=15,a.execute(r);case 15:e.next=10;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(8),o.e(e.t0);case 22:return e.prev=22,o.f(),e.finish(22);case 25:this.engine.endFrame(),this.rendering=!1;case 27:case"end":return e.stop()}}),e,this,[[8,19,22,25]])}))),function(){return t.apply(this,arguments)})},{key:"clear",value:function(e){var t=this;return this.inited?this.engine.clear(e):this.pendings.unshift((function(){t.engine.clear(e),t.pendings.shift()})),this}},{key:"setSize",value:function(e){var t=e.width,n=e.height,r=this.engine.getCanvas();return this.size={width:t,height:n},r.width=t,r.height=n,this}},{key:"getSize",value:function(){return this.size}}]),e}(),c7=zZ((l7=d7).prototype,"engine",[i7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u7=zZ(l7.prototype,"shaderModule",[o7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h7=zZ(l7.prototype,"configService",[s7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a7=l7))||a7),T7=f.injectable()((y7=function(){function e(){LZ(this,e),this.entities=[]}return GZ(e,[{key:"getEntities",value:function(){return this.entities}},{key:"addRenderable",value:function(e){return this.addEntity(e.getEntity()),this}},{key:"removeRenderable",value:function(e){return this.removeEntity(e.getEntity()),this}},{key:"addLight",value:function(){}},{key:"addEntity",value:function(e){return-1===this.entities.indexOf(e)&&this.entities.push(e),this}},{key:"removeEntity",value:function(e){var t=this.entities.indexOf(e);return this.entities.splice(t,1),this}}]),e}(),v7=y7))||v7,P7=f.injectable()((x7=function(){function e(){LZ(this,e),this.cache={}}return GZ(e,[{key:"get",value:function(e){return this.cache[e]}},{key:"set",value:function(e,t){this.cache[e]=t}}]),e}(),b7=x7))||b7;function D7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N7(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D7(Object(n),!0).forEach((function(t){PJ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D7(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R7,I7,j7,L7,F7,G7,B7,z7,U7,V7,H7,W7,$7,X7=(w7=f.injectable(),C7=f.inject(P7),E7=f.inject(rJ.RenderEngine),w7((k7=function(){function e(){LZ(this,e),IZ(this,"textureCache",O7,this),IZ(this,"engine",A7,this),this.config=void 0,this.loaded=!1,this.texture=void 0}var t;return GZ(e,[{key:"setConfig",value:function(e){this.config=e}},{key:"isLoaded",value:function(){return this.loaded}},{key:"load",value:(t=WZ(VZ.mark((function e(){var t=this;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.config.url){e.next=4;break}return e.abrupt("return",new Promise((function(e,n){var r=t.textureCache.get(t.config.url);if(r)e(r);else{var i=new Image;i.crossOrigin="Anonymous",i.src=t.config.url,i.onload=function(){var n=t.engine.createTexture2D(N7(N7({},t.config),{},{data:i,width:i.width,height:i.height,flipY:!0}));t.textureCache.set(t.config.url,n),t.texture=n,t.loaded=!0,e(n)},i.onerror=function(){n()}}})));case 4:return this.loaded=!0,this.texture=this.engine.createTexture2D(this.config),e.abrupt("return",this.texture);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),O7=zZ((S7=k7).prototype,"textureCache",[C7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A7=zZ(S7.prototype,"engine",[E7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_7=S7))||_7),Y7=(R7=f.injectable(),I7=f.inject(rJ.Systems),j7=f.named(rJ.RendererSystem),R7((B7=function(){function e(){LZ(this,e),IZ(this,"rendererSystem",G7,this),this.camera=void 0,this.scene=void 0,this.viewport={x:0,y:0,width:0,height:0},this.clearColor=[1,1,1,1]}return GZ(e,[{key:"getCamera",value:function(){return this.camera}},{key:"getScene",value:function(){return this.scene}},{key:"getViewport",value:function(){return this.viewport}},{key:"getClearColor",value:function(){return this.clearColor}},{key:"setCamera",value:function(e){return this.camera=e,this}},{key:"setScene",value:function(e){return this.scene=e,this}},{key:"setViewport",value:function(e){return this.viewport=e,this}},{key:"setClearColor",value:function(e){return this.clearColor=e,this}},{key:"pick",value:function(e){return this.rendererSystem.pick(e,this)}}]),e}(),G7=zZ((F7=B7).prototype,"rendererSystem",[I7,j7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L7=F7))||L7);function q7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K7(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q7(Object(n),!0).forEach((function(t){PJ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q7(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z7=(z7=f.injectable(),U7=f.inject(rJ.ConfigService),z7(($7=function(){function e(){LZ(this,e),IZ(this,"configService",W7,this),this.container=void 0}var t;return GZ(e,[{key:"getEngine",value:(t=WZ(VZ.mark((function e(){var t,n,r,i;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.container.get(rJ.RenderEngine),n=this.configService.get(),r=n.canvas,i=n.engineOptions,e.next=4,t.init(K7({canvas:r||y3(),swapChainFormat:v3.TextureFormat.BGRA8Unorm,antialiasing:!1},i));case 4:return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getTransformComponent",value:function(e){return this.container.get(rJ.TransformComponentManager).getComponentByEntity(e)}},{key:"getMeshComponent",value:function(e){return this.container.get(rJ.MeshComponentManager).getComponentByEntity(e)}},{key:"setConfig",value:function(e){this.configService.set(e)}},{key:"setContainer",value:function(e){this.container=e}},{key:"getContainer",value:function(){return this.container}},{key:"createEntity",value:function(){return XZ()}},{key:"createScene",value:function(){return this.container.get(T7)}},{key:"createCamera",value:function(){return this.container.get(g3)}},{key:"createView",value:function(){return this.container.get(Y7)}},{key:"createRenderable",value:function(e,t){var n=e?this.container.getNamed(rJ.Renderable,e):this.container.get(i4),r=XZ();return n.setConfig(t||{}),n.setEntity(r),n}},{key:"createGeometry",value:function(e,t){var n=this.container.getNamed(rJ.Geometry,e),r=XZ();return n.setConfig(t||{}),n.setEntity(r),n.getComponent()}},{key:"createMaterial",value:function(e,t){var n=this.container.getNamed(rJ.Material,e),r=XZ();return n.setConfig(t||{}),n.setEntity(r,e),n.getComponent()}},{key:"createTexture2D",value:function(e){var t=this.container.get(X7);return t.setConfig(e),t}},{key:"createBufferGeometry",value:function(e){return this.container.getNamed(rJ.Systems,rJ.GeometrySystem).createBufferGeometry(e)}},{key:"createInstancedBufferGeometry",value:function(e){return this.container.getNamed(rJ.Systems,rJ.GeometrySystem).createInstancedBufferGeometry(e)}},{key:"createShaderMaterial",value:function(e){return this.container.getNamed(rJ.Systems,rJ.MaterialSystem).createShaderMaterial(e)}},{key:"createKernel",value:function(e){var t=this.container.get(n4);return"string"==typeof e?t.setBundle(JSON.parse(e)):t.setBundle(e),t.init(),t}},{key:"createRenderer",value:function(){var e=this.container.get(M7);return e.container=this.container,e.init(),e}},{key:"destroy",value:function(){this.container.getAll(rJ.Systems).forEach((function(e){e.tearDown&&e.tearDown()})),this.container.get(rJ.RenderEngine).destroy(),this.container.get(rJ.InteractorService).destroy()}}],[{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=F1(),r=navigator.gpu?U6:a6;n.isBound(rJ.RenderEngine)||n.bind(rJ.RenderEngine).to(r).inSingletonScope(),n.bind(M7).toSelf(),n.bind(n4).toSelf(),n.bind(i4).toSelf(),n.bind(Y7).toSelf(),n.bind(g3).toSelf(),n.bind(T7).toSelf(),n.bind(e).toSelf(),n.bind(P7).toSelf(),n.bind(X7).toSelf(),n.bind(rJ.Geometry).to($6).whenTargetNamed(m3.BOX),n.bind(rJ.Geometry).to(l5).whenTargetNamed(m3.SPHERE),n.bind(rJ.Geometry).to(J6).whenTargetNamed(m3.PLANE),n.bind(rJ.Geometry).to(q6).whenTargetNamed(m3.MERGED),n.bind(rJ.Material).to(C5).whenTargetNamed(r4.BASIC),n.bind(rJ.Renderable).to(p7).whenTargetNamed(i4.POINT),n.bind(rJ.Renderable).to(e7).whenTargetNamed(i4.LINE),n.bind(rJ.Renderable).to(_5).whenTargetNamed(i4.GRID);var i=n.get(e);return i.setContainer(n),i.setConfig(t),i}}]),e}(),W7=zZ((H7=$7).prototype,"configService",[U7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V7=H7))||V7);const J7=(e,t)=>{let n;return n=e?FD(e)?()=>e:e:()=>t||1,n},Q7=e=>{const t=[],n=e.length,r=e[0].length;for(let i=0;i<r;i++)e.forEach(((e,r)=>{if(t.push(e[i]),r===n-1)for(;t.length%4!=0;)t.push(0)}));return new Float32Array(t)};var e9=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};var t9=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class n9{constructor(e){this.id=e.id||0,this.rx=e.rx,this.ry=e.ry,this.fx=0,this.fy=0,this.mass=e.mass,this.degree=e.degree,this.g=e.g||0}distanceTo(e){const t=this.rx-e.rx,n=this.ry-e.ry;return Math.hypot(t,n)}setPos(e,t){this.rx=e,this.ry=t}resetForce(){this.fx=0,this.fy=0}addForce(e){const t=e.rx-this.rx,n=e.ry-this.ry;let r=Math.hypot(t,n);r=r<1e-4?1e-4:r;const i=this.g*(this.degree+1)*(e.degree+1)/r;this.fx+=i*t/r,this.fy+=i*n/r}in(e){return e.contains(this.rx,this.ry)}add(e){const t=this.mass+e.mass,n=(this.rx*this.mass+e.rx*e.mass)/t,r=(this.ry*this.mass+e.ry*e.mass)/t,i=this.degree+e.degree;return new n9({rx:n,ry:r,mass:t,degree:i})}}class r9{constructor(e){this.xmid=e.xmid,this.ymid=e.ymid,this.length=e.length,this.massCenter=e.massCenter||[0,0],this.mass=e.mass||1}getLength(){return this.length}contains(e,t){const n=this.length/2;return e<=this.xmid+n&&e>=this.xmid-n&&t<=this.ymid+n&&t>=this.ymid-n}NW(){const e=this.xmid-this.length/4,t=this.ymid+this.length/4,n=this.length/2;return new r9({xmid:e,ymid:t,length:n})}NE(){const e=this.xmid+this.length/4,t=this.ymid+this.length/4,n=this.length/2;return new r9({xmid:e,ymid:t,length:n})}SW(){const e=this.xmid-this.length/4,t=this.ymid-this.length/4,n=this.length/2;return new r9({xmid:e,ymid:t,length:n})}SE(){const e=this.xmid+this.length/4,t=this.ymid-this.length/4,n=this.length/2;return new r9({xmid:e,ymid:t,length:n})}}class i9{constructor(e){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=e&&(this.quad=e)}insert(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new i9(this.quad.NW()),this.NE=new i9(this.quad.NE()),this.SW=new i9(this.quad.SW()),this.SE=new i9(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e}_putBody(e){this.quad&&(e.in(this.quad.NW())&&this.NW?this.NW.insert(e):e.in(this.quad.NE())&&this.NE?this.NE.insert(e):e.in(this.quad.SW())&&this.SW?this.SW.insert(e):e.in(this.quad.SE())&&this.SE&&this.SE.insert(e))}_isExternal(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE}updateForce(e){if(null!=this.body&&e!==this.body)if(this._isExternal())e.addForce(this.body);else{(this.quad?this.quad.getLength():0)/this.body.distanceTo(e)<this.theta?e.addForce(this.body):(this.NW&&this.NW.updateForce(e),this.NE&&this.NE.updateForce(e),this.SW&&this.SW.updateForce(e),this.SE&&this.SE.updateForce(e))}}}class o9{constructor(){this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}init(e,t,n){this.cells=[],this.CELL_W=n.CELL_W||o9.DEFAULT_CELL_W,this.CELL_H=n.CELL_H||o9.DEFAULT_CELL_H,this.columnNum=Math.ceil(e/this.CELL_W),this.rowNum=Math.ceil(t/this.CELL_H),o9.MIN_DIST=Math.pow(e,2)+Math.pow(t,2);for(let e=0;e<this.columnNum;e++){const t=[];for(let n=0;n<this.rowNum;n++){const r={dx:e,dy:n,x:e*this.CELL_W,y:n*this.CELL_H,occupied:!1};t.push(r)}this.cells.push(t)}}findGridByNodeId(e){var t,n;for(let r=0;r<this.columnNum;r++)for(let i=0;i<this.rowNum;i++)if(this.cells[r][i].node&&(null===(n=null===(t=this.cells[r][i])||void 0===t?void 0:t.node)||void 0===n?void 0:n.id)===e)return{column:r,row:i};return null}sqdist(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)}occupyNearest(e){let t,n=o9.MIN_DIST,r=null;for(let i=0;i<this.columnNum;i++)for(let o=0;o<this.rowNum;o++)!this.cells[i][o].occupied&&(t=this.sqdist(e,this.cells[i][o]))<n&&(n=t,r=this.cells[i][o]);return r&&(r.occupied=!0),r}insertColumn(e,t){if(!(t<=0)){for(let e=0;e<t;e++){this.cells[e+this.columnNum]=[];for(let t=0;t<this.rowNum;t++)this.cells[e+this.columnNum][t]={dx:e,dy:t,x:e*this.CELL_W,y:t*this.CELL_H,occupied:!1,node:null}}for(let n=this.columnNum-1;n>e;n--)for(let e=0;e<this.rowNum;e++)this.cells[n+t][e]=Object.assign(Object.assign({},this.cells[n][e]),{x:(n+t)*this.CELL_W,y:e*this.CELL_H}),this.cells[n][e]={x:n*this.CELL_W,y:e*this.CELL_H,occupied:!0,node:null};for(let n=0;n<this.additionColumn.length;n++)this.additionColumn[n]>=e&&(this.additionColumn[n]+=t);for(let n=0;n<t;n++)this.additionColumn.push(e+n+1);this.columnNum+=t}}insertRow(e,t){if(!(t<=0)){for(let e=0;e<t;e++)for(let t=0;t<this.columnNum;t++)this.cells[t][e+this.rowNum]={dx:t,dy:e,x:t*this.CELL_W,y:e*this.CELL_H,occupied:!1,node:null};for(let n=0;n<this.columnNum;n++)for(let r=this.rowNum-1;r>e;r--)this.cells[n][r+t]=Object.assign(Object.assign({},this.cells[n][r]),{dx:n,dy:r+t,x:n*this.CELL_W,y:(r+t)*this.CELL_H}),this.cells[n][r]={dx:n,dy:r,x:n*this.CELL_W,y:r*this.CELL_H,occupied:!1,node:null};for(let n=0;n<this.additionRow.length;n++)this.additionRow[n]>=e&&(this.additionRow[n]+=t);for(let n=0;n<t;n++)this.additionRow.push(e+n+1);this.rowNum+=t}}getNodes(){const e=[];for(let t=0;t<this.columnNum;t++)for(let n=0;n<this.rowNum;n++)this.cells[t][n].node&&e.push(this.cells[t][n]);return e}}o9.MIN_DIST=50,o9.DEFAULT_CELL_W=80,o9.DEFAULT_CELL_H=80;const s9=1e7,a9=1.5707963267948966,l9=new Map;let c9=.8;function u9(e,t){const n=(l9.get(e.id)||[]).find((e=>e.source===t.id||e.target===t.id)),r=e.size[0]*e.size[1],i=t.size[0]*t.size[1],o=r>i?t:e,s=r>i?e:t,a=o.x-o.size[0]/2,l=o.y-o.size[1]/2,c=o.x+o.size[0]/2,u=o.y+o.size[1]/2,h=s.x-s.size[0]/2,d=s.y-s.size[1]/2,f=s.x+s.size[0]/2,p=s.y+s.size[1]/2,g=o.x,m=o.y,v=s.x,y=s.y;let b=0,x=0;if(c>=h&&f>=a&&u>=d&&p>=l){x=Math.sqrt(Math.pow(v-g,2)+Math.pow(y-m,2));0===x&&(x=1e-7),b=10/x*100+((c<f?c:f)-(a>h?a:h))*((u<p?u:p)-(l>d?l:d)),b*=s9}else{let e=!1;const t=function(e,t,n){const r=e.x-e.size[0]/2,i=e.y-e.size[1]/2,o=e.x+e.size[0]/2,s=e.y+e.size[1]/2,a=t.x-t.size[0]/2,l=t.y-t.size[1]/2,c=t.x+t.size[0]/2,u=t.y+t.size[1]/2,h=e.x,d=e.y,f=t.x,p=t.y,g=f-h,m=Math.atan2(g,p-d);let v=0,y=0,b=0,x=0;m>a9?(y=i-u,v=a-o,b=parseFloat(y?(y/Math.cos(m)).toFixed(2):v.toFixed(2)),x=parseFloat(v?(v/Math.sin(m)).toFixed(2):y.toFixed(2))):0<m&&m<=a9?(y=l-s,v=a-o,b=x=y>v?parseFloat(y?(y/Math.cos(m)).toFixed(2):v.toFixed(2)):parseFloat(v?(v/Math.sin(m)).toFixed(2):y.toFixed(2))):m<-a9?(y=i-u,v=-(c-r),b=x=y>v?parseFloat(y?(y/Math.cos(m)).toFixed(2):v.toFixed(2)):parseFloat(v?(v/Math.sin(m)).toFixed(2):y.toFixed(2))):(y=l-s,v=Math.abs(g)>(o-r)/2?r-c:g,b=x=y>v?parseFloat(y?(y/Math.cos(m)).toFixed(2):v.toFixed(2)):parseFloat(v&&0!==m?(v/Math.sin(m)).toFixed(2):y.toFixed(2)));const w=parseFloat(m.toFixed(2));let C=n;return n&&(C=1.1780972450961724<w&&w<1.9634954084936207),{distance:Math.abs(b<x?b:x),isHoriz:C}}(o,s,e);x=t.distance,e=t.isHoriz,x<=10?b+=0!==x?n?10+1e7/x:10+1e8/x:s9:(b+=x,n&&(b+=x*x))}return b}function h9(e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];(r.x<0||r.y<0||r.x>1200||r.y>800)&&(t+=1e12);for(let i=n+1;i<e.length;i++)t+=u9(r,e[i])}return t}function d9(e,t,n,r){const i=new Map;n.forEach(((e,t)=>{i.set(e.id,e)}));const o=r.filter((t=>t.source===e.id||t.target===e.id))||[],s=[];o.forEach((t=>{const n=t.source===e.id?t.target:t.source,r=i.get(n);r&&s.push(r)}));let a=!0;for(let n=0;n<s.length;n++){const r=s[n],i=180*Math.atan((e.y-r.y)/(r.x-e.y)),o=180*Math.atan((t.y-r.y)/(r.x-t.y)),l=o<30||o>150,c=i>70&&i<110,u=o>70&&o<110;if((i<30||i>150)&&!l||i*o<0){a=!1;break}if(c&&!u||i*o<0){a=!1;break}if((r.x-e.x)*(r.x-t.x)<0){a=!1;break}if((r.y-e.y)*(r.y-t.y)<0){a=!1;break}}return a}function f9(e,t){let n=!1;const r=[10,-10,0,0],i=[0,0,10,-10];for(let o=0;o<e.length;++o){const s=e[o];let a=p9(s,e);for(let o=0;o<r.length;o++){if(d9(s,{x:s.x+r[o],y:s.y+i[o]},e,t)){s.x+=r[o],s.y+=i[o];const t=p9(s,e),l=Math.random();t<a||l<c9&&l>.1?(a=t,n=!0):(s.x-=r[o],s.y-=i[o])}}}return c9>.1&&(c9*=.5),n?h9(e):0}function p9(e,t){let n=0;(e.x<0||e.y<0||e.x+e.size[0]+20>1200||e.y+e.size[1]+20>800)&&(n+=1e12);for(let r=0;r<t.length;++r)e.id!==t[r].id&&(n+=u9(e,t[r]));return n}function g9(e,t){const{nodes:n,edges:r}=e,i=t.width,o=t.height;if(!(null==n?void 0:n.length))return Promise.resolve();const s=[];n.forEach((e=>{if(r.filter((t=>t.source===e.id||t.target===e.id)).length>1){const t=Object.assign({},e);delete t.size,s.push(t)}}));const a=[];r.forEach((e=>{const t=s.find((t=>t.id===e.source)),n=s.find((t=>t.id===e.target));t&&n&&a.push(e)}));const l=new iZ({type:"dagre",ranksep:t.nodeMinGap,nodesep:t.nodeMinGap}),{nodes:c}=l.layout({nodes:s,edges:a});n.forEach((e=>{const t=(c||[]).find((t=>t.id===e.id));e.x=(null==t?void 0:t.x)||i/2,e.y=(null==t?void 0:t.y)||o/2}));const u=JSON.parse(JSON.stringify(n)),h=JSON.parse(JSON.stringify(r)),d=KD.exports.forceSimulation().nodes(u).force("link",KD.exports.forceLink(h).id((e=>e.id)).distance((e=>a.find((t=>t.source===e.source&&t.target===e.target))?30:20))).force("charge",KD.exports.forceManyBody()).force("center",KD.exports.forceCenter(i/2,o/2)).force("x",KD.exports.forceX(i/2)).force("y",KD.exports.forceY(o/2)).alpha(.3).alphaDecay(.08).alphaMin(.001),f=new Promise((e=>{d.on("end",(()=>{n.forEach((e=>{const t=u.find((t=>t.id===e.id));t&&(e.x=t.x,e.y=t.y)}));const s=Math.min(...n.map((e=>e.x))),a=Math.max(...n.map((e=>e.x))),l=Math.min(...n.map((e=>e.y))),c=Math.max(...n.map((e=>e.y))),h=i/(a-s),d=o/(c-l);n.forEach((e=>{void 0!==e.x&&h<1&&(e.x=(e.x-s)*h),void 0!==e.y&&d<1&&(e.y=(e.y-l)*d)})),n.forEach((e=>{e.sizeTemp=e.size,e.size=[10,10]})),function(e,t){if(0===e.length)return{nodes:e,edges:t};e.forEach((e=>{const n=t.filter((t=>t.source===e.id||t.target===e.id));l9.set(e,n)})),e.sort(((e,t)=>{var n,r;return(null===(n=l9.get(e.id))||void 0===n?void 0:n.length)-(null===(r=l9.get(t.id))||void 0===r?void 0:r.length)}));let n=h9(e),r=20,i=1,o=0,s=0;for(;r>0&&(s++,!(s>=50));){const s=f9(e,t);0!==s&&(o=s),i=o-n,n=o,0===i?--r:r=20}e.forEach((e=>{e.x=e.x-e.size[0]/2,e.y=e.y-e.size[1]/2}))}(n,r),n.forEach((e=>{e.size=e.sizeTemp||[],delete e.sizeTemp})),function(e,t){if(!e.nodes||0===e.nodes.length)return e;const n=t.width,r=t.height,i=t.nodeMinGap;let o=1e4,s=1e4;e.nodes.forEach((e=>{const t=e.size[0]||50,n=e.size[1]||50;o=Math.min(t,o),s=Math.min(n,s)}));const a=new o9;a.init(n,r,{CELL_H:s,CELL_W:o}),e.nodes.forEach((e=>{const t=a.occupyNearest(e);t&&(t.node={id:e.id,size:e.size},e.x=t.x,e.y=t.y,e.dx=t.dx,e.dy=t.dy)}));for(let t=0;t<e.nodes.length;t++){const n=e.nodes[t],r=a.findGridByNodeId(n.id);if(!r)throw new Error("can not find node cell");const{column:l,row:c}=r;if(n.size[0]+i>o){const e=Math.ceil((n.size[0]+i)/o)-1;let t=e;for(let n=0;n<e&&(a.additionColumn.indexOf(l+n+1)>-1&&!a.cells[l+n+1][c].node);n++)t--;a.insertColumn(l,t)}if(n.size[1]+i>s){const e=Math.ceil((n.size[1]+i)/s)-1;let t=e;for(let n=0;n<e&&(a.additionRow.indexOf(c+n+1)>-1&&!a.cells[l][c+n+1].node);n++)t--;a.insertRow(c,t)}}for(let t=0;t<a.columnNum;t++)for(let n=0;n<a.rowNum;n++){const r=a.cells[t][n];if(r.node){const t=e.nodes.find((e=>{var t;return e.id===(null===(t=null==r?void 0:r.node)||void 0===t?void 0:t.id)}));t&&(t.x=r.x+t.size[0]/2,t.y=r.y+t.size[1]/2)}}}({nodes:n,edges:r},t),e()}))}));return f}const m9={force:class extends ID{constructor(e){super(),this.center=[0,0],this.nodeStrength=null,this.edgeStrength=null,this.preventOverlap=!1,this.clusterNodeStrength=null,this.clusterEdgeStrength=null,this.clusterEdgeDistance=null,this.clusterNodeSize=null,this.clusterFociStrength=null,this.linkDistance=50,this.alphaDecay=.028,this.alphaMin=.001,this.alpha=.3,this.collideStrength=1,this.workerEnabled=!1,this.tick=()=>{},this.onLayoutEnd=()=>{},this.ticking=void 0,e&&this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick(){},onLayoutEnd(){},workerEnabled:!1}}init(e){const t=this;t.nodes=e.nodes||[];const n=e.edges||[];t.edges=n.map((e=>{const t={},n=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(e).forEach((r=>{n.indexOf(r)>-1||(t[r]=e[r])})),t})),t.ticking=!1}execute(e){const t=this,n=t.nodes,r=t.edges;if(t.ticking)return;let i=t.forceSimulation;const o=t.alphaMin,s=t.alphaDecay,a=t.alpha;if(i){if(e)if(t.clustering&&t.clusterForce&&(t.clusterForce.nodes(n),t.clusterForce.links(r)),i.nodes(n),r&&t.edgeForce)t.edgeForce.links(r);else if(r&&!t.edgeForce){const e=KD.exports.forceLink().id((e=>e.id)).links(r);t.edgeStrength&&e.strength(t.edgeStrength),t.linkDistance&&e.distance(t.linkDistance),t.edgeForce=e,i.force("link",e)}t.preventOverlap&&t.overlapProcess(i),i.alpha(a).restart(),this.ticking=!0}else try{const e=KD.exports.forceManyBody();if(t.nodeStrength&&e.strength(t.nodeStrength),i=KD.exports.forceSimulation().nodes(n),t.clustering){const e=eN();e.centerX(t.center[0]).centerY(t.center[1]).template("force").strength(t.clusterFociStrength),r&&e.links(r),n&&e.nodes(n),e.forceLinkDistance(t.clusterEdgeDistance).forceLinkStrength(t.clusterEdgeStrength).forceCharge(t.clusterNodeStrength).forceNodeSize(t.clusterNodeSize),t.clusterForce=e,i.force("group",e)}if(i.force("center",KD.exports.forceCenter(t.center[0],t.center[1])).force("charge",e).alpha(a).alphaDecay(s).alphaMin(o),t.preventOverlap&&t.overlapProcess(i),r){const e=KD.exports.forceLink().id((e=>e.id)).links(r);t.edgeStrength&&e.strength(t.edgeStrength),t.linkDistance&&e.distance(t.linkDistance),t.edgeForce=e,i.force("link",e)}if(t.workerEnabled&&!rN()&&(t.workerEnabled=!1,console.warn("workerEnabled option is only supported when running in web worker.")),t.workerEnabled){i.stop();const e=function(e){const t=e.alphaMin(),n=e.alphaTarget(),r=e.alpha(),i=Math.log((t-n)/(r-n))/Math.log(1-e.alphaDecay());return Math.ceil(i)}(i);for(let t=1;t<=e;t++)i.tick(),postMessage({nodes:n,currentTick:t,totalTicks:e,type:tN},void 0);t.ticking=!1}else i.on("tick",(()=>{t.tick()})).on("end",(()=>{t.ticking=!1,t.onLayoutEnd&&t.onLayoutEnd()})),t.ticking=!0;t.forceSimulation=i,t.ticking=!0}catch(e){t.ticking=!1,console.warn(e)}}overlapProcess(e){const t=this,n=t.nodeSize,r=t.nodeSpacing;let i,o;const s=t.collideStrength;if(o=FD(r)?()=>r:YD(r)?r:()=>0,n)if(YD(n))i=e=>n(e)+o(e);else if(LD(n)){const e=(n[0]>n[1]?n[0]:n[1])/2;i=t=>e+o(t)}else if(FD(n)){const e=n/2;i=t=>e+o(t)}else i=()=>10;else i=e=>{if(e.size){if(LD(e.size)){return(e.size[0]>e.size[1]?e.size[0]:e.size[1])/2+o(e)}if(BD(e.size)){return(e.size.width>e.size.height?e.size.width:e.size.height)/2+o(e)}return e.size/2+o(e)}return 10+o(e)};e.force("collisionForce",KD.exports.forceCollide(i).strength(s))}updateCfg(e){const t=this;t.ticking&&(t.forceSimulation.stop(),t.ticking=!1),t.forceSimulation=null,Object.assign(t,e)}destroy(){const e=this;e.ticking&&(e.forceSimulation.stop(),e.ticking=!1),e.nodes=null,e.edges=null,e.destroyed=!0}},fruchterman:class extends ID{constructor(e){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.gravity=10,this.speed=5,this.clustering=!1,this.clusterGravity=10,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.onLayoutEnd=()=>{},this.tick=()=>{},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){var e,t;const n=this,r=n.nodes;if(void 0!==n.timeInterval&&"undefined"!=typeof window&&window.clearInterval(n.timeInterval),!r||0===r.length)return void(null===(e=n.onLayoutEnd)||void 0===e||e.call(n));n.width||"undefined"==typeof window||(n.width=window.innerWidth),n.height||"undefined"==typeof window||(n.height=window.innerHeight),n.center||(n.center=[n.width/2,n.height/2]);const i=n.center;if(1===r.length)return r[0].x=i[0],r[0].y=i[1],void(null===(t=n.onLayoutEnd)||void 0===t||t.call(n));const o={},s={};return r.forEach(((e,t)=>{FD(e.x)||(e.x=Math.random()*this.width),FD(e.y)||(e.y=Math.random()*this.height),o[e.id]=e,s[e.id]=t})),n.nodeMap=o,n.nodeIdxMap=s,n.run()}run(){var e;const t=this,n=t.nodes;if(!n)return;const{edges:r,maxIteration:i,workerEnabled:o}=t,s=t.clustering,a={};if(s){n.forEach((e=>{if(void 0===a[e.cluster]){const t={name:e.cluster,cx:0,cy:0,count:0};a[e.cluster]=t}const t=a[e.cluster];FD(e.x)&&(t.cx+=e.x),FD(e.y)&&(t.cy+=e.y),t.count++}));for(const e in a)a[e].cx/=a[e].count,a[e].cy/=a[e].count}if(o){for(let e=0;e<i;e++)t.runOneStep(a);null===(e=t.onLayoutEnd)||void 0===e||e.call(t)}else{if("undefined"==typeof window)return;let e=0;this.timeInterval=window.setInterval((()=>{var n;t.runOneStep(a),e++,e>=i&&(null===(n=t.onLayoutEnd)||void 0===n||n.call(t),window.clearInterval(t.timeInterval))}),0)}return{nodes:n,edges:r}}runOneStep(e){var t;const n=this,r=n.nodes;if(!r)return;const{edges:i,center:o,gravity:s,speed:a,clustering:l}=n,c=n.height*n.width,u=Math.sqrt(c)/10,h=c/(r.length+1),d=Math.sqrt(h),f=[];if(r.forEach(((e,t)=>{f[t]={x:0,y:0}})),n.applyCalculate(r,i,f,d,h),l){const t=n.clusterGravity||s;r.forEach(((n,r)=>{if(!FD(n.x)||!FD(n.y))return;const i=e[n.cluster],o=Math.sqrt((n.x-i.cx)*(n.x-i.cx)+(n.y-i.cy)*(n.y-i.cy)),s=d*t;f[r].x-=s*(n.x-i.cx)/o,f[r].y-=s*(n.y-i.cy)/o}));for(const t in e)e[t].cx=0,e[t].cy=0,e[t].count=0;r.forEach((t=>{const n=e[t.cluster];FD(t.x)&&(n.cx+=t.x),FD(t.y)&&(n.cy+=t.y),n.count++}));for(const t in e)e[t].cx/=e[t].count,e[t].cy/=e[t].count}r.forEach(((e,t)=>{if(!FD(e.x)||!FD(e.y))return;const n=.01*d*s;f[t].x-=n*(e.x-o[0]),f[t].y-=n*(e.y-o[1])})),r.forEach(((e,t)=>{if(FD(e.fx)&&FD(e.fy))return e.x=e.fx,void(e.y=e.fy);if(!FD(e.x)||!FD(e.y))return;const n=Math.sqrt(f[t].x*f[t].x+f[t].y*f[t].y);if(n>0){const r=Math.min(u*(a/800),n);e.x+=f[t].x/n*r,e.y+=f[t].y/n*r}})),null===(t=n.tick)||void 0===t||t.call(n)}applyCalculate(e,t,n,r,i){this.calRepulsive(e,n,i),t&&this.calAttractive(t,n,r)}calRepulsive(e,t,n){e.forEach(((r,i)=>{t[i]={x:0,y:0},e.forEach(((e,o)=>{if(i===o)return;if(!(FD(r.x)&&FD(e.x)&&FD(r.y)&&FD(e.y)))return;let s=r.x-e.x,a=r.y-e.y,l=s*s+a*a;if(0===l){l=1;const e=i>o?1:-1;s=.01*e,a=.01*e}const c=n/l;t[i].x+=s*c,t[i].y+=a*c}))}))}calAttractive(e,t,n){e.forEach((e=>{const r=UD(e,"source"),i=UD(e,"target");if(!r||!i)return;const o=this.nodeIdxMap[r],s=this.nodeIdxMap[i];if(o===s)return;const a=this.nodeMap[r],l=this.nodeMap[i];if(!(FD(l.x)&&FD(a.x)&&FD(l.y)&&FD(a.y)))return;const c=l.x-a.x,u=l.y-a.y,h=Math.sqrt(c*c+u*u),d=h*h/n;t[s].x-=c/h*d,t[s].y-=u/h*d,t[o].x+=c/h*d,t[o].y+=u/h*d}))}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval)}destroy(){const e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0}getType(){return"fruchterman"}},forceAtlas2:class extends ID{constructor(e){super(),this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.kr=5,this.kg=1,this.mode="normal",this.preventOverlap=!1,this.dissuadeHubs=!1,this.barnesHut=void 0,this.maxIteration=0,this.ks=.1,this.ksmax=10,this.tao=.1,this.onLayoutEnd=()=>{},this.prune=void 0,this.updateCfg(e)}getDefaultCfg(){return{}}execute(){const e=this,{nodes:t,onLayoutEnd:n,prune:r}=e;let i=e.maxIteration;e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight);const o=[],s=t.length;for(let n=0;n<s;n+=1){const r=t[n];let i=10,s=10;FD(r.size)&&(i=r.size,s=r.size),LD(r.size)?(isNaN(r.size[0])||(i=r.size[0]),isNaN(r.size[1])||(s=r.size[1])):BD(r.size)&&(i=r.size.width,s=r.size.height),e.getWidth&&!isNaN(e.getWidth(r))&&(s=e.getWidth(r)),e.getHeight&&!isNaN(e.getHeight(r))&&(i=e.getHeight(r));const a=Math.max(i,s);o.push(a)}void 0===e.barnesHut&&s>250&&(e.barnesHut=!0),void 0===e.prune&&s>100&&(e.prune=!0),0!==this.maxIteration||e.prune?0===this.maxIteration&&r&&(i=100,s<=200&&s>100?i=500:s>200&&(i=950),this.maxIteration=i):(i=250,s<=200&&s>100?i=1e3:s>200&&(i=1200),this.maxIteration=i),e.kr||(e.kr=50,s>100&&s<=500?e.kr=20:s>500&&(e.kr=1)),e.kg||(e.kg=20,s>100&&s<=500?e.kg=10:s>500&&(e.kg=1)),this.nodes=e.updateNodesByForces(o),n()}updateNodesByForces(e){const t=this,{edges:n,maxIteration:r}=t;let i=t.nodes;const o=n.filter((e=>UD(e,"source")!==UD(e,"target"))),s=i.length,a=o.length,l=[],c={},u={},h=[];for(let e=0;e<s;e+=1)c[i[e].id]=e,l[e]=0,(void 0===i[e].x||isNaN(i[e].x))&&(i[e].x=1e3*Math.random()),(void 0===i[e].y||isNaN(i[e].y))&&(i[e].y=1e3*Math.random()),h.push({x:i[e].x,y:i[e].y});for(let e=0;e<a;e+=1){let t,n,r=0,a=0;for(let l=0;l<s;l+=1){const s=UD(o[e],"source"),c=UD(o[e],"target");i[l].id===s?(t=i[l],r=l):i[l].id===c&&(n=i[l],a=l),u[e]={sourceIdx:r,targetIdx:a}}t&&(l[c[t.id]]+=1),n&&(l[c[n.id]]+=1)}let d=r;if(i=this.iterate(d,c,u,a,l,e),t.prune){for(let e=0;e<a;e+=1)l[u[e].sourceIdx]<=1?(i[u[e].sourceIdx].x=i[u[e].targetIdx].x,i[u[e].sourceIdx].y=i[u[e].targetIdx].y):l[u[e].targetIdx]<=1&&(i[u[e].targetIdx].x=i[u[e].sourceIdx].x,i[u[e].targetIdx].y=i[u[e].sourceIdx].y);t.prune=!1,t.barnesHut=!1,d=100,i=this.iterate(d,c,u,a,l,e)}return i}iterate(e,t,n,r,i,o){const s=this;let{nodes:a}=s;const{kr:l,preventOverlap:c}=s,{barnesHut:u}=s,h=a.length;let d=0;let f=e;let p=[];const g=[],m=[];for(let e=0;e<h;e+=1)if(p[2*e]=0,p[2*e+1]=0,u){const t={id:e,rx:a[e].x,ry:a[e].y,mass:1,g:l,degree:i[e]};m[e]=new n9(t)}for(;f>0;){for(let e=0;e<h;e+=1)g[2*e]=p[2*e],g[2*e+1]=p[2*e+1],p[2*e]=0,p[2*e+1]=0;p=this.getAttrForces(f,50,r,t,n,i,o,p),p=u&&(c&&f>50||!c)?this.getOptRepGraForces(p,m,i):this.getRepGraForces(f,50,p,100,o,i);const e=this.updatePos(p,g,d,i);a=e.nodes,d=e.sg,f--,s.tick&&s.tick()}return a}getAttrForces(e,t,n,r,i,o,s,a){const{nodes:l,preventOverlap:c,dissuadeHubs:u,mode:h,prune:d}=this;for(let f=0;f<n;f+=1){const n=l[i[f].sourceIdx],p=i[f].sourceIdx,g=l[i[f].targetIdx],m=i[f].targetIdx;if(d&&(o[p]<=1||o[m]<=1))continue;const v=[g.x-n.x,g.y-n.y];let y=Math.hypot(v[0],v[1]);y=y<1e-4?1e-4:y,v[0]=v[0]/y,v[1]=v[1]/y,c&&e<t&&(y=y-s[p]-s[m]);let b=y,x=b;"linlog"===h&&(b=Math.log(1+y),x=b),u&&(b=y/o[p],x=y/o[m]),c&&e<t&&y<=0?(b=0,x=0):c&&e<t&&y>0&&(b=y,x=y),a[2*r[n.id]]+=b*v[0],a[2*r[g.id]]-=x*v[0],a[2*r[n.id]+1]+=b*v[1],a[2*r[g.id]+1]-=x*v[1]}return a}getRepGraForces(e,t,n,r,i,o){const{nodes:s,preventOverlap:a,kr:l,kg:c,center:u,prune:h}=this,d=s.length;for(let f=0;f<d;f+=1){for(let c=f+1;c<d;c+=1){if(h&&(o[f]<=1||o[c]<=1))continue;const u=[s[c].x-s[f].x,s[c].y-s[f].y];let d=Math.hypot(u[0],u[1]);d=d<1e-4?1e-4:d,u[0]=u[0]/d,u[1]=u[1]/d,a&&e<t&&(d=d-i[f]-i[c]);let p=l*(o[f]+1)*(o[c]+1)/d;a&&e<t&&d<0?p=r*(o[f]+1)*(o[c]+1):a&&e<t&&0===d?p=0:a&&e<t&&d>0&&(p=l*(o[f]+1)*(o[c]+1)/d),n[2*f]-=p*u[0],n[2*c]+=p*u[0],n[2*f+1]-=p*u[1],n[2*c+1]+=p*u[1]}const p=[s[f].x-u[0],s[f].y-u[1]],g=Math.hypot(p[0],p[1]);p[0]=p[0]/g,p[1]=p[1]/g;const m=c*(o[f]+1);n[2*f]-=m*p[0],n[2*f+1]-=m*p[1]}return n}getOptRepGraForces(e,t,n){const{nodes:r,kg:i,center:o,prune:s}=this,a=r.length;let l=9e10,c=-9e10,u=9e10,h=-9e10;for(let e=0;e<a;e+=1)s&&n[e]<=1||(t[e].setPos(r[e].x,r[e].y),r[e].x>=c&&(c=r[e].x),r[e].x<=l&&(l=r[e].x),r[e].y>=h&&(h=r[e].y),r[e].y<=u&&(u=r[e].y));const d=Math.max(c-l,h-u),f=new r9({xmid:(c+l)/2,ymid:(h+u)/2,length:d,massCenter:o,mass:a}),p=new i9(f);for(let e=0;e<a;e+=1)s&&n[e]<=1||t[e].in(f)&&p.insert(t[e]);for(let l=0;l<a;l+=1){if(s&&n[l]<=1)continue;t[l].resetForce(),p.updateForce(t[l]),e[2*l]-=t[l].fx,e[2*l+1]-=t[l].fy;const a=[r[l].x-o[0],r[l].y-o[1]];let c=Math.hypot(a[0],a[1]);c=c<1e-4?1e-4:c,a[0]=a[0]/c,a[1]=a[1]/c;const u=i*(n[l]+1);e[2*l]-=u*a[0],e[2*l+1]-=u*a[1]}return e}updatePos(e,t,n,r){const{nodes:i,ks:o,tao:s,prune:a,ksmax:l}=this,c=i.length,u=[],h=[];let d=0,f=0;for(let n=0;n<c;n+=1){if(a&&r[n]<=1)continue;const i=[e[2*n]-t[2*n],e[2*n+1]-t[2*n+1]],o=Math.hypot(i[0],i[1]),s=[e[2*n]+t[2*n],e[2*n+1]+t[2*n+1]],l=Math.hypot(s[0],s[1]);u[n]=o,h[n]=l/2,d+=(r[n]+1)*u[n],f+=(r[n]+1)*h[n]}const p=n;n=s*f/d,0!==p&&(n=n>1.5*p?1.5*p:n);for(let t=0;t<c;t+=1){if(a&&r[t]<=1)continue;let s=o*n/(1+n*Math.sqrt(u[t])),c=Math.hypot(e[2*t],e[2*t+1]);c=c<1e-4?1e-4:c;const h=l/c;s=s>h?h:s;const d=s*e[2*t],f=s*e[2*t+1];i[t].x+=d,i[t].y+=f}return{nodes:i,sg:n}}},gForce:class extends ID{constructor(e){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.preventOverlap=!0,this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0}}execute(){var e,t;const n=this,r=n.nodes;if(void 0!==n.timeInterval&&"undefined"!=typeof window&&window.clearInterval(n.timeInterval),!r||0===r.length)return void(null===(e=n.onLayoutEnd)||void 0===e||e.call(n));n.width||"undefined"==typeof window||(n.width=window.innerWidth),n.height||"undefined"==typeof window||(n.height=window.innerHeight),n.center||(n.center=[n.width/2,n.height/2]);const i=n.center;if(1===r.length)return r[0].x=i[0],r[0].y=i[1],void(null===(t=n.onLayoutEnd)||void 0===t||t.call(n));const o={},s={};r.forEach(((e,t)=>{FD(e.x)||(e.x=Math.random()*n.width),FD(e.y)||(e.y=Math.random()*n.height),o[e.id]=e,s[e.id]=t})),n.nodeMap=o,n.nodeIdxMap=s,n.linkDistance=qD(n.linkDistance,1),n.nodeStrength=qD(n.nodeStrength,1),n.edgeStrength=qD(n.edgeStrength,1);const a=n.nodeSize;let l;if(n.preventOverlap){const e=n.nodeSpacing;let t;t=FD(e)?()=>e:YD(e)?e:()=>0,l=a?LD(a)?e=>(a[0]>a[1]?a[0]:a[1])+t(e):e=>a+t(e):e=>{if(e.size){if(LD(e.size)){return(e.size[0]>e.size[1]?e.size[0]:e.size[1])+t(e)}if(BD(e.size)){return(e.size.width>e.size.height?e.size.width:e.size.height)+t(e)}return e.size+t(e)}return 10+t(e)}}n.nodeSize=l;const c=n.edges;n.degrees=VD(r.length,n.nodeIdxMap,c),n.getMass||(n.getMass=e=>n.degrees[n.nodeIdxMap[e.id]]||1),n.run()}run(){var e;const t=this,{maxIteration:n,nodes:r,workerEnabled:i,minMovement:o}=t;if(r)if(i){for(let e=0;e<n;e++){const n=t.runOneStep(e);if(t.reachMoveThreshold(r,n,o))break}null===(e=t.onLayoutEnd)||void 0===e||e.call(t)}else{if("undefined"==typeof window)return;let e=0;this.timeInterval=window.setInterval((()=>{var i,s;if(!r)return;const a=t.runOneStep(e)||[];t.reachMoveThreshold(r,a,o)&&(null===(i=t.onLayoutEnd)||void 0===i||i.call(t),window.clearInterval(t.timeInterval)),e++,e>=n&&(null===(s=t.onLayoutEnd)||void 0===s||s.call(t),window.clearInterval(t.timeInterval))}),0)}}reachMoveThreshold(e,t,n){let r=0;return e.forEach(((e,n)=>{const i=e.x-t[n].x,o=e.y-t[n].y;r+=Math.sqrt(i*i+o*o)})),r/=e.length,r<n}runOneStep(e){var t;const n=this,{nodes:r,edges:i}=n,o=[],s=[];if(!r)return;r.forEach(((e,t)=>{o[2*t]=0,o[2*t+1]=0,s[2*t]=0,s[2*t+1]=0})),n.calRepulsive(o,r),i&&n.calAttractive(o,i),n.calGravity(o,r);const a=Math.max(.02,n.interval-.002*e);n.updateVelocity(o,s,a,r);const l=[];return r.forEach((e=>{l.push({x:e.x,y:e.y})})),n.updatePosition(s,a,r),null===(t=n.tick)||void 0===t||t.call(n),l}calRepulsive(e,t){const n=this,r=n.getMass,i=n.nodeStrength,o=n.factor,s=n.coulombDisScale,a=n.preventOverlap,l=n.nodeSize;t.forEach(((n,c)=>{const u=r?r(n):1;t.forEach(((t,h)=>{if(c>=h)return;const d=n.x-t.x,f=n.y-t.y,p=Math.sqrt(d*d+f*f)+.01,g=(p+.1)*s,m=d/p,v=f/p,y=(i(n)+i(t))/2*o/(g*g),b=r?r(t):1;if(e[2*c]+=m*y,e[2*c+1]+=v*y,e[2*h]-=m*y,e[2*h+1]-=v*y,a&&p<(l(n)+l(t))/2){const r=(i(n)+i(t))/2/(p*p);e[2*c]+=m*r/u,e[2*c+1]+=v*r/u,e[2*h]-=m*r/b,e[2*h+1]-=v*r/b}}))}))}calAttractive(e,t){const n=this,r=n.nodeMap,i=n.nodeIdxMap,o=n.linkDistance,s=n.edgeStrength,a=n.getMass;t.forEach(((t,n)=>{const l=UD(t,"source"),c=UD(t,"target"),u=r[l],h=r[c],d=h.x-u.x,f=h.y-u.y,p=Math.sqrt(d*d+f*f)+.01,g=d/p,m=f/p,v=((o(t)||1)-p)*s(t),y=i[l],b=i[c],x=a?a(u):1,w=a?a(h):1;e[2*y]-=g*v/x,e[2*y+1]-=m*v/x,e[2*b]+=g*v/w,e[2*b+1]+=m*v/w}))}calGravity(e,t){const n=this,r=n.center,i=n.gravity,o=n.degrees,s=t.length;for(let a=0;a<s;a++){const s=t[a];let l=s.x-r[0],c=s.y-r[1],u=i;if(n.getCenter){const e=n.getCenter(s,o[a]);e&&FD(e[0])&&FD(e[1])&&FD(e[2])&&(l=s.x-e[0],c=s.y-e[1],u=e[2])}u&&(e[2*a]-=u*l,e[2*a+1]-=u*c)}}updateVelocity(e,t,n,r){const i=this,o=n*i.damping;r.forEach(((n,r)=>{let s=e[2*r]*o||.01,a=e[2*r+1]*o||.01;const l=Math.sqrt(s*s+a*a);if(l>i.maxSpeed){const e=i.maxSpeed/l;s*=e,a*=e}t[2*r]=s,t[2*r+1]=a}))}updatePosition(e,t,n){n.forEach(((n,r)=>{if(FD(n.fx)&&FD(n.fy))return n.x=n.fx,void(n.y=n.fy);const i=e[2*r]*t,o=e[2*r+1]*t;n.x+=i,n.y+=o}))}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval)}destroy(){const e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0}getType(){return"gForce"}},dagre:iZ,circular:class extends ID{constructor(e){super(),this.radius=null,this.startRadius=null,this.endRadius=null,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.divisions=1,this.ordering=null,this.angleRatio=1,this.nodes=[],this.edges=[],this.nodeMap={},this.degrees=[],this.width=300,this.height=300,this.updateCfg(e)}getDefaultCfg(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}}execute(){const e=this,t=e.nodes,n=e.edges,r=t.length;if(0===r)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const i=e.center;if(1===r)return t[0].x=i[0],t[0].y=i[1],void(e.onLayoutEnd&&e.onLayoutEnd());let o=e.radius,s=e.startRadius,a=e.endRadius;const l=e.divisions,c=e.startAngle,u=e.endAngle,h=(u-c)/r,d={};t.forEach(((e,t)=>{d[e.id]=t})),e.nodeMap=d;const f=VD(t.length,d,n);e.degrees=f,o||s||a?!s&&a?s=a:s&&!a&&(a=s):o=e.height>e.width?e.width/2:e.height/2;const p=h*e.angleRatio,g=e.ordering;let m=[];m="topology"===g?e.topologyOrdering():"topology-directed"===g?e.topologyOrdering(!0):"degree"===g?e.degreeOrdering():t;const v=e.clockwise,y=Math.ceil(r/l);for(let e=0;e<r;++e){let t=o;t||null===s||null===a||(t=s+e*(a-s)/(r-1)),t||(t=10+100*e/(r-1));let n=c+e%y*p+2*Math.PI/l*Math.floor(e/y);v||(n=u-e%y*p-2*Math.PI/l*Math.floor(e/y)),m[e].x=i[0]+Math.cos(n)*t,m[e].y=i[1]+Math.sin(n)*t,m[e].weight=f[e]}return e.onLayoutEnd&&e.onLayoutEnd(),{nodes:m,edges:this.edges}}topologyOrdering(e=!1){const t=this,n=t.degrees,r=t.edges,i=t.nodes,o=zD(i),s=t.nodeMap,a=[o[0]],l=[i[0]],c=[],u=i.length;c[0]=!0,function(e,t,n,r){e.forEach(((t,n)=>{e[n].children=[],e[n].parent=[]})),r?t.forEach((t=>{const r=UD(t,"source"),i=UD(t,"target");let o=0;r&&(o=n[r]);let s=0;i&&(s=n[i]);const a=e[o].children,l=e[s].parent;a.push(e[s].id),l.push(e[o].id)})):t.forEach((t=>{const r=UD(t,"source"),i=UD(t,"target");let o=0;r&&(o=n[r]);let s=0;i&&(s=n[i]);const a=e[o].children,l=e[s].children;a.push(e[s].id),l.push(e[o].id)}))}(o,r,s,e);let h=0;return o.forEach(((e,t)=>{if(0!==t)if(t!==u-1&&n[t]===n[t+1]&&!function(e,t,n){const r=n.length;for(let i=0;i<r;i++){const r=UD(n[i],"source"),o=UD(n[i],"target");if(e.id===r&&t.id===o||t.id===r&&e.id===o)return!0}return!1}(a[h],e,r)||c[t]){const e=a[h].children;let r=!1;for(let u=0;u<e.length;u++){const h=s[e[u]];if(n[h]===n[t]&&!c[h]){a.push(o[h]),l.push(i[s[o[h].id]]),c[h]=!0,r=!0;break}}let d=0;for(;!r&&(c[d]||(a.push(o[d]),l.push(i[s[o[d].id]]),c[d]=!0,r=!0),d++,d!==u););}else a.push(e),l.push(i[s[e.id]]),c[t]=!0,h++})),l}degreeOrdering(){const e=this.nodes,t=[],n=this.degrees;return e.forEach(((e,r)=>{e.degree=n[r],t.push(e)})),t.sort(iN),t}getType(){return"circular"}},radial:class extends ID{constructor(e){super(),this.maxIteration=1e3,this.focusNode=null,this.unitRadius=null,this.linkDistance=50,this.preventOverlap=!1,this.strictRadial=!0,this.maxPreventOverlapIteration=200,this.sortStrength=10,this.nodes=[],this.edges=[],this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}}execute(){const e=this,t=e.nodes,n=e.edges||[];if(!t||0===t.length)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const r=e.center;if(1===t.length)return t[0].x=r[0],t[0].y=r[1],void(e.onLayoutEnd&&e.onLayoutEnd());const i=e.linkDistance;let o=null;if(jD(e.focusNode)){let n=!1;for(let r=0;r<t.length;r++)t[r].id===e.focusNode&&(o=t[r],e.focusNode=o,n=!0,r=t.length);n||(o=null)}else o=e.focusNode;o||(o=t[0],e.focusNode=o);const s=function(e,t){let n=-1;return e.forEach(((e,r)=>{e.id===t&&(n=r)})),n}(t,o.id);e.focusIndex=s;const a=WD({nodes:t,edges:n},!1),l=HD(a),c=e.maxToFocus(l,s);e.handleInfinity(l,s,c+1),e.distances=l;const u=l[s],h=e.width||500,d=e.height||500;let f=h-r[0]>r[0]?r[0]:h-r[0],p=d-r[1]>r[1]?r[1]:d-r[1];0===f&&(f=h/2),0===p&&(p=d/2);const g=p>f?f:p,m=Math.max(...u),v=[];u.forEach(((t,n)=>{e.unitRadius||(e.unitRadius=g/m),v[n]=t*e.unitRadius})),e.radii=v;const y=e.eIdealDisMatrix();e.eIdealDistances=y;const b=function(e){const t=e.length,n=e[0].length,r=[];for(let i=0;i<t;i++){const t=[];for(let r=0;r<n;r++)0!==e[i][r]?t.push(1/(e[i][r]*e[i][r])):t.push(0);r.push(t)}return r}(y);e.weights=b;let x=new PZ({linkDistance:i,distances:y}).layout();x.forEach((e=>{GD(e[0])&&(e[0]=Math.random()*i),GD(e[1])&&(e[1]=Math.random()*i)})),e.positions=x,x.forEach(((e,n)=>{t[n].x=e[0]+r[0],t[n].y=e[1]+r[1]})),x.forEach((e=>{e[0]-=x[s][0],e[1]-=x[s][1]})),e.run();const w=e.preventOverlap,C=e.nodeSize;let E;const _=e.strictRadial;if(w){const n=e.nodeSpacing;let r;r=FD(n)?()=>n:YD(n)?n:()=>0,E=C?LD(C)?e=>(C[0]>C[1]?C[0]:C[1])+r(e):e=>C+r(e):e=>{if(e.size){if(LD(e.size)){return(e.size[0]>e.size[1]?e.size[0]:e.size[1])+r(e)}if(BD(e.size)){return(e.size.width>e.size.height?e.size.width:e.size.height)+r(e)}return e.size+r(e)}return 10+r(e)};const i={nodes:t,nodeSizeFunc:E,adjMatrix:a,positions:x,radii:v,height:d,width:h,strictRadial:_,focusID:s,iterations:e.maxPreventOverlapIteration||200,k:x.length/4.5},o=new DZ(i);x=o.layout()}return x.forEach(((e,n)=>{t[n].x=e[0]+r[0],t[n].y=e[1]+r[1]})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}run(){const e=this,t=e.maxIteration,n=e.positions||[],r=e.weights||[],i=e.eIdealDistances||[],o=e.radii||[];for(let s=0;s<=t;s++){const a=s/t;e.oneIteration(a,n,o,i,r)}}oneIteration(e,t,n,r,i){const o=1-e,s=this.focusIndex;t.forEach(((a,l)=>{const c=NZ(a,[0,0]),u=0===c?0:1/c;if(l===s)return;let h=0,d=0,f=0;t.forEach(((e,t)=>{if(l===t)return;const n=NZ(a,e),o=0===n?0:1/n,s=r[t][l];f+=i[l][t],h+=i[l][t]*(e[0]+s*(a[0]-e[0])*o),d+=i[l][t]*(e[1]+s*(a[1]-e[1])*o)}));const p=0===n[l]?0:1/n[l];f*=o,f+=e*p*p,h*=o,h+=e*p*a[0]*u,a[0]=h/f,d*=o,d+=e*p*a[1]*u,a[1]=d/f}))}eIdealDisMatrix(){const e=this,t=e.nodes;if(!t)return[];const n=e.distances,r=e.linkDistance,i=e.radii||[],o=e.unitRadius||50,s=[];return n&&n.forEach(((n,a)=>{const l=[];n.forEach(((n,s)=>{if(a===s)l.push(0);else if(i[a]===i[s])if("data"===e.sortBy)l.push(n*(Math.abs(a-s)*e.sortStrength)/(i[a]/o));else if(e.sortBy){let r=t[a][e.sortBy]||0,c=t[s][e.sortBy]||0;jD(r)&&(r=r.charCodeAt(0)),jD(c)&&(c=c.charCodeAt(0)),l.push(n*(Math.abs(r-c)*e.sortStrength)/(i[a]/o))}else l.push(n*r/(i[a]/o));else{const e=(r+o)/2;l.push(n*e)}})),s.push(l)})),s}handleInfinity(e,t,n){const r=e.length;for(let i=0;i<r;i++)if(e[t][i]===1/0){e[t][i]=n,e[i][t]=n;for(let o=0;o<r;o++)e[i][o]!==1/0&&e[t][o]===1/0&&(e[t][o]=n+e[i][o],e[o][t]=n+e[i][o])}for(let n=0;n<r;n++)if(n!==t)for(let i=0;i<r;i++)if(e[n][i]===1/0){let r=Math.abs(e[t][n]-e[t][i]);r=0===r?1:r,e[n][i]=r}}maxToFocus(e,t){let n=0;for(let r=0;r<e[t].length;r++)e[t][r]!==1/0&&(n=e[t][r]>n?e[t][r]:n);return n}getType(){return"radial"}},concentric:class extends ID{constructor(e){super(),this.nodeSize=30,this.minNodeSpacing=10,this.preventOverlap=!1,this.equidistant=!1,this.startAngle=1.5*Math.PI,this.clockwise=!0,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{nodeSize:30,minNodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}}execute(){const e=this,t=e.nodes,n=e.edges,r=t.length;if(0===r)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const i=e.center;if(1===r)return t[0].x=i[0],t[0].y=i[1],void(e.onLayoutEnd&&e.onLayoutEnd());const o=[];let s;s=LD(e.nodeSize)?Math.max(e.nodeSize[0],e.nodeSize[1]):e.nodeSize,t.forEach((e=>{o.push(e);let t=s;LD(e.size)?t=Math.max(e.size[0],e.size[1]):FD(e.size)?t=e.size:BD(e.size)&&(t=Math.max(e.size.width,e.size.height)),s=Math.max(s,t)})),e.clockwise=void 0!==e.counterclockwise?!e.counterclockwise:e.clockwise;const a={},l={};if(o.forEach(((e,t)=>{a[e.id]=e,l[e.id]=t})),!("degree"!==e.sortBy&&jD(e.sortBy)&&void 0!==o[0][e.sortBy]||(e.sortBy="degree",FD(t[0].degree)))){const e=VD(t.length,l,n);o.forEach(((t,n)=>{t.degree=e[n]}))}o.sort(((t,n)=>n[e.sortBy]-t[e.sortBy])),e.maxValueNode=o[0],e.maxLevelDiff=e.maxLevelDiff||e.maxValueNode[e.sortBy]/4;const c=[[]];let u=c[0];o.forEach((t=>{if(u.length>0){const n=Math.abs(u[0][e.sortBy]-t[e.sortBy]);e.maxLevelDiff&&n>=e.maxLevelDiff&&(u=[],c.push(u))}u.push(t)}));let h=s+e.minNodeSpacing;if(!e.preventOverlap){const t=c.length>0&&c[0].length>1,n=(Math.min(e.width,e.height)/2-h)/(c.length+(t?1:0));h=Math.min(h,n)}let d=0;if(c.forEach((t=>{let n=e.sweep;void 0===n&&(n=2*Math.PI-2*Math.PI/t.length);const r=t.dTheta=n/Math.max(1,t.length-1);if(t.length>1&&e.preventOverlap){const e=Math.cos(r)-Math.cos(0),t=Math.sin(r)-Math.sin(0),n=Math.sqrt(h*h/(e*e+t*t));d=Math.max(n,d)}t.r=d,d+=h})),e.equidistant){let e=0,t=0;for(let n=0;n<c.length;n++){const r=c[n].r-t;e=Math.max(e,r)}t=0,c.forEach(((n,r)=>{0===r&&(t=n.r),n.r=t,t+=e}))}return c.forEach((t=>{const n=t.dTheta,r=t.r;t.forEach(((t,o)=>{const s=e.startAngle+(e.clockwise?1:-1)*n*o;t.x=i[0]+r*Math.cos(s),t.y=i[1]+r*Math.sin(s)}))})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}getType(){return"concentric"}},grid:class extends ID{constructor(e){super(),this.begin=[0,0],this.preventOverlap=!0,this.preventOverlapPadding=10,this.condense=!1,this.sortBy="degree",this.nodeSize=30,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.row=0,this.col=0,this.cellWidth=0,this.cellHeight=0,this.cellUsed={},this.id2manPos={},this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}}execute(){const e=this,t=e.nodes,n=e.edges,r=t.length,i=e.begin;if(0===r)return e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n};if(1===r)return t[0].x=i[0],t[0].y=i[1],e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n};const o=[];t.forEach((e=>{o.push(e)}));const s={};if(o.forEach(((e,t)=>{s[e.id]=t})),("degree"===e.sortBy||!jD(e.sortBy)||void 0===o[0][e.sortBy])&&(e.sortBy="degree",GD(t[0].degree))){const e=VD(o.length,s,n);o.forEach(((t,n)=>{t.degree=e[n]}))}o.sort(((t,n)=>n[e.sortBy]-t[e.sortBy])),e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight);const a=e.rows,l=null!=e.cols?e.cols:e.columns;if(e.cells=r,null!=a&&null!=l?(e.rows=a,e.cols=l):null!=a&&null==l?(e.rows=a,e.cols=Math.ceil(e.cells/e.rows)):null==a&&null!=l?(e.cols=l,e.rows=Math.ceil(e.cells/e.cols)):(e.splits=Math.sqrt(e.cells*e.height/e.width),e.rows=Math.round(e.splits),e.cols=Math.round(e.width/e.height*e.splits)),e.cols*e.rows>e.cells){const t=e.small(),n=e.large();(t-1)*n>=e.cells?e.small(t-1):(n-1)*t>=e.cells&&e.large(n-1)}else for(;e.cols*e.rows<e.cells;){const t=e.small(),n=e.large();(n+1)*t>=e.cells?e.large(n+1):e.small(t+1)}e.cellWidth=e.width/e.cols,e.cellHeight=e.height/e.rows,e.condense&&(e.cellWidth=0,e.cellHeight=0),e.preventOverlap&&o.forEach((t=>{let n,r;t.x&&t.y||(t.x=0,t.y=0),LD(t.size)?(n=t.size[0],r=t.size[1]):FD(t.size)?(n=t.size,r=t.size):BD(t.size)&&(n=t.size.width,r=t.size.height),void 0!==n&&void 0!==r||(LD(e.nodeSize)?(n=e.nodeSize[0],r=e.nodeSize[1]):FD(e.nodeSize)?(n=e.nodeSize,r=e.nodeSize):(n=30,r=30));const i=e.preventOverlapPadding,o=n+i,s=r+i;e.cellWidth=Math.max(e.cellWidth,o),e.cellHeight=Math.max(e.cellHeight,s)})),e.cellUsed={},e.row=0,e.col=0,e.id2manPos={};for(let t=0;t<o.length;t++){const n=o[t];let r;if(e.position&&(r=e.position(n)),r&&(void 0!==r.row||void 0!==r.col)){const t={row:r.row,col:r.col};if(void 0===t.col)for(t.col=0;e.used(t.row,t.col);)t.col++;else if(void 0===t.row)for(t.row=0;e.used(t.row,t.col);)t.row++;e.id2manPos[n.id]=t,e.use(t.row,t.col)}e.getPos(n)}return e.onLayoutEnd&&e.onLayoutEnd(),{edges:n,nodes:o}}small(e){const t=this;let n;const r=t.rows||5,i=t.cols||5;if(null==e)n=Math.min(r,i);else{Math.min(r,i)===t.rows?t.rows=e:t.cols=e}return n}large(e){const t=this;let n;const r=t.rows||5,i=t.cols||5;if(null==e)n=Math.max(r,i);else{Math.max(r,i)===t.rows?t.rows=e:t.cols=e}return n}used(e,t){return this.cellUsed[`c-${e}-${t}`]||!1}use(e,t){this.cellUsed[`c-${e}-${t}`]=!0}moveToNextCell(){const e=this,t=e.cols||5;e.col++,e.col>=t&&(e.col=0,e.row++)}getPos(e){const t=this,n=t.begin,r=t.cellWidth,i=t.cellHeight;let o,s;const a=t.id2manPos[e.id];if(a)o=a.col*r+r/2+n[0],s=a.row*i+i/2+n[1];else{for(;t.used(t.row,t.col);)t.moveToNextCell();o=t.col*r+r/2+n[0],s=t.row*i+i/2+n[1],t.use(t.row,t.col),t.moveToNextCell()}e.x=o,e.y=s}getType(){return"grid"}},mds:class extends ID{constructor(e){super(),this.center=[0,0],this.linkDistance=50,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],linkDistance:50}}execute(){const e=this,{nodes:t,edges:n=[]}=e,r=e.center;if(!t||0===t.length)return void(e.onLayoutEnd&&e.onLayoutEnd());if(1===t.length)return t[0].x=r[0],t[0].y=r[1],void(e.onLayoutEnd&&e.onLayoutEnd());const i=e.linkDistance,o=WD({nodes:t,edges:n},!1),s=HD(o);e.handleInfinity(s);const a=((e,t)=>{const n=[];return e.forEach((e=>{const r=[];e.forEach((e=>{r.push(e*t)})),n.push(r)})),n})(s,i);e.scaledDistances=a;const l=e.runMDS();return e.positions=l,l.forEach(((e,n)=>{t[n].x=e[0]+r[0],t[n].y=e[1]+r[1]})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}runMDS(){const e=this.scaledDistances,t=AZ.mul(AZ.pow(e,2),-.5),n=t.mean("row"),r=t.mean("column"),i=t.mean();t.add(i).subRowVector(n).subColumnVector(r);const o=new TZ(t),s=AZ.sqrt(o.diagonalMatrix).diagonal();return o.leftSingularVectors.toJSON().map((e=>AZ.mul([e],[s]).toJSON()[0].splice(0,2)))}handleInfinity(e){let t=-999999;e.forEach((e=>{e.forEach((e=>{e!==1/0&&t<e&&(t=e)}))})),e.forEach(((n,r)=>{n.forEach(((n,i)=>{n===1/0&&(e[r][i]=t)}))}))}getType(){return"mds"}},comboForce:class extends ID{constructor(e){super(),this.center=[0,0],this.maxIteration=100,this.gravity=10,this.comboGravity=10,this.linkDistance=10,this.alpha=1,this.alphaMin=.001,this.alphaDecay=1-Math.pow(this.alphaMin,1/300),this.alphaTarget=0,this.velocityDecay=.6,this.edgeStrength=.6,this.nodeStrength=30,this.preventOverlap=!1,this.preventNodeOverlap=!1,this.preventComboOverlap=!1,this.collideStrength=void 0,this.nodeCollideStrength=.5,this.comboCollideStrength=.5,this.comboSpacing=20,this.comboPadding=10,this.optimizeRangeFactor=1,this.onTick=()=>{},this.onLayoutEnd=()=>{},this.depthAttractiveForceScale=1,this.depthRepulsiveForceScale=2,this.nodes=[],this.edges=[],this.combos=[],this.comboTrees=[],this.width=300,this.height=300,this.bias=[],this.nodeMap={},this.oriComboMap={},this.indexMap={},this.comboMap={},this.previousLayouted=!1,this.updateCfg(e)}getDefaultCfg(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}}execute(){const e=this,t=e.nodes,n=e.center;if(e.comboTree={id:"comboTreeRoot",depth:-1,children:e.comboTrees},t&&0!==t.length){if(1===t.length)return t[0].x=n[0],t[0].y=n[1],void(e.onLayoutEnd&&e.onLayoutEnd());e.initVals(),e.run(),e.onLayoutEnd&&e.onLayoutEnd()}else e.onLayoutEnd&&e.onLayoutEnd()}run(){const e=this,t=e.nodes,n=e.previousLayouted?e.maxIteration/5:e.maxIteration;e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight);const r=e.center,i=e.velocityDecay,o=e.comboMap;e.previousLayouted||e.initPos(o);for(let r=0;r<n;r++){const n=[];t.forEach(((e,t)=>{n[t]={x:0,y:0}})),e.applyCalculate(n),e.applyComboCenterForce(n),t.forEach(((e,t)=>{FD(e.x)&&FD(e.y)&&(e.x+=n[t].x*i,e.y+=n[t].y*i)})),e.alpha+=(e.alphaTarget-e.alpha)*e.alphaDecay,e.onTick()}const s=[0,0];t.forEach((e=>{FD(e.x)&&FD(e.y)&&(s[0]+=e.x,s[1]+=e.y)})),s[0]/=t.length,s[1]/=t.length;const a=[r[0]-s[0],r[1]-s[1]];t.forEach(((e,t)=>{FD(e.x)&&FD(e.y)&&(e.x+=a[0],e.y+=a[1])})),e.combos.forEach((e=>{const t=o[e.id];t&&t.empty&&(e.x=t.cx||e.x,e.y=t.cy||e.y)})),e.previousLayouted=!0}initVals(){const e=this,t=e.edges,n=e.nodes,r=e.combos,i={},o={},s={};n.forEach(((e,t)=>{o[e.id]=e,s[e.id]=t})),e.nodeMap=o,e.indexMap=s;const a={};r.forEach((e=>{a[e.id]=e})),e.oriComboMap=a,e.comboMap=e.getComboMap();const l=e.preventOverlap;e.preventComboOverlap=e.preventComboOverlap||l,e.preventNodeOverlap=e.preventNodeOverlap||l;const c=e.collideStrength;c&&(e.comboCollideStrength=c,e.nodeCollideStrength=c),e.comboCollideStrength=e.comboCollideStrength?e.comboCollideStrength:0,e.nodeCollideStrength=e.nodeCollideStrength?e.nodeCollideStrength:0;for(let e=0;e<t.length;++e){const n=UD(t[e],"source"),r=UD(t[e],"target");i[n]?i[n]++:i[n]=1,i[r]?i[r]++:i[r]=1}const u=[];for(let e=0;e<t.length;++e){const n=UD(t[e],"source"),r=UD(t[e],"target");u[e]=i[n]/(i[n]+i[r])}this.bias=u;const h=e.nodeSize,d=e.nodeSpacing;let f,p;if(p=FD(d)?()=>d:YD(d)?d:()=>0,this.nodeSpacing=p,h)if(YD(h))f=e=>h(e);else if(LD(h)){const e=(h[0]>h[1]?h[0]:h[1])/2;f=t=>e}else{const e=h/2;f=t=>e}else f=e=>{if(e.size){if(LD(e.size)){return(e.size[0]>e.size[1]?e.size[0]:e.size[1])/2}if(BD(e.size)){return(e.size.width>e.size.height?e.size.width:e.size.height)/2}return e.size/2}return 10};this.nodeSize=f;const g=e.comboSpacing;let m;m=FD(g)?()=>g:YD(g)?g:()=>0,this.comboSpacing=m;const v=e.comboPadding;let y;y=FD(v)?()=>v:LD(v)?()=>Math.max.apply(null,v):YD(v)?v:()=>0,this.comboPadding=y;let b,x=this.linkDistance;x||(x=10),b=FD(x)?e=>x:x,this.linkDistance=b;let w,C=this.edgeStrength;C||(C=1),w=FD(C)?e=>C:C,this.edgeStrength=w;let E,_=this.nodeStrength;_||(_=30),E=FD(_)?e=>_:_,this.nodeStrength=E}initPos(e){this.nodes.forEach(((t,n)=>{const r=t.comboId,i=e[r];r&&i?(t.x=i.cx+100/(n+1),t.y=i.cy+100/(n+1)):(t.x=100/(n+1),t.y=100/(n+1))}))}getComboMap(){const e=this,t=e.nodeMap,n=e.indexMap,r=e.comboTrees,i=e.oriComboMap,o={};return(r||[]).forEach((r=>{const s=[];XD(r,(r=>{if("node"===r.itemType)return!0;if(!i[r.id])return!0;if(void 0===o[r.id]){const t={id:r.id,name:r.id,cx:0,cy:0,count:0,depth:e.oriComboMap[r.id].depth||0,children:[]};o[r.id]=t}const a=r.children;a&&a.forEach((e=>{if(!o[e.id]&&!t[e.id])return!0;s.push(e)}));const l=o[r.id];if(l.cx=0,l.cy=0,0===s.length){l.empty=!0;const o=i[r.id],a=Object.keys(t).length,c=`${r.id}-visual-child-${a}`,u={id:c,x:o.x,y:o.y,depth:l.depth+1,itemType:"node"};e.nodes.push(u),t[c]=u,n[c]=a,l.cx=o.x,l.cy=o.y,s.push(u)}return s.forEach((e=>{if(l.count++,"node"!==e.itemType){const t=o[e.id];return FD(t.cx)&&(l.cx+=t.cx),void(FD(t.cy)&&(l.cy+=t.cy))}const n=t[e.id];n&&(FD(n.x)&&(l.cx+=n.x),FD(n.y)&&(l.cy+=n.y))})),l.cx/=l.count,l.cy/=l.count,l.children=s,!0}))})),o}applyComboCenterForce(e){const t=this,n=t.gravity,r=t.comboGravity||n,i=this.alpha,o=t.comboTrees,s=t.indexMap,a=t.nodeMap,l=t.comboMap;(o||[]).forEach((t=>{XD(t,(t=>{if("node"===t.itemType)return!0;if(!l[t.id])return!0;const n=l[t.id],o=(n.depth+1)/10*.5,c=n.cx,u=n.cy;return n.cx=0,n.cy=0,n.children.forEach((t=>{if("node"!==t.itemType){const e=l[t.id];return e&&FD(e.cx)&&(n.cx+=e.cx),void(e&&FD(e.cy)&&(n.cy+=e.cy))}const h=a[t.id],d=h.x-c||.005,f=h.y-u||.005,p=Math.sqrt(d*d+f*f),g=s[h.id],m=r*i/p*o;e[g].x-=d*m,e[g].y-=f*m,FD(h.x)&&(n.cx+=h.x),FD(h.y)&&(n.cy+=h.y)})),n.cx/=n.count,n.cy/=n.count,!0}))}))}applyCalculate(e){const t=this,n=t.comboMap,r=t.nodes,i={};r.forEach(((e,t)=>{r.forEach(((n,r)=>{if(t<r)return;const o=e.x-n.x||.005,s=e.y-n.y||.005;let a=o*o+s*s;const l=Math.sqrt(a);a<1&&(a=l),i[`${e.id}-${n.id}`]={vx:o,vy:s,vl2:a,vl:l},i[`${n.id}-${e.id}`]={vl2:a,vl:l,vx:-o,vy:-s}}))})),t.updateComboSizes(n),t.calRepulsive(e,i),t.calAttractive(e,i);t.preventComboOverlap&&t.comboNonOverlapping(e,n)}updateComboSizes(e){const t=this,n=t.comboTrees,r=t.nodeMap,i=t.nodeSize,o=t.comboSpacing,s=t.comboPadding;(n||[]).forEach((n=>{const a=[];XD(n,(n=>{if("node"===n.itemType)return!0;const l=e[n.id];if(!l)return!1;const c=n.children;c&&c.forEach((t=>{(e[t.id]||r[t.id])&&a.push(t)})),l.minX=1/0,l.minY=1/0,l.maxX=-1/0,l.maxY=-1/0,a.forEach((e=>{if("node"!==e.itemType)return!0;const t=r[e.id];if(!t)return!0;const n=i(t),o=t.x-n,s=t.y-n,a=t.x+n,c=t.y+n;l.minX>o&&(l.minX=o),l.minY>s&&(l.minY=s),l.maxX<a&&(l.maxX=a),l.maxY<c&&(l.maxY=c)}));let u=t.oriComboMap[n.id].size||10;LD(u)&&(u=u[0]);const h=Math.max(l.maxX-l.minX,l.maxY-l.minY,u);return l.r=h/2+o(l)/2+s(l),!0}))}))}comboNonOverlapping(e,t){const n=this,r=n.comboTree,i=n.comboCollideStrength,o=n.indexMap,s=n.nodeMap;XD(r,(n=>{if(!t[n.id]&&!s[n.id]&&"comboTreeRoot"!==n.id)return!1;const r=n.children;return r&&r.length>1&&r.forEach(((n,a)=>{if("node"===n.itemType)return!1;const l=t[n.id];l&&r.forEach(((r,c)=>{if(a<=c)return!1;if("node"===r.itemType)return!1;const u=t[r.id];if(!u)return!1;const h=l.cx-u.cx||.005,d=l.cy-u.cy||.005,f=h*h+d*d,p=l.r||1,g=u.r||1,m=p+g,v=g*g,y=p*p;if(f<m*m){const t=n.children;if(!t||0===t.length)return!1;const a=r.children;if(!a||0===a.length)return!1;const l=Math.sqrt(f),c=(m-l)/l*i,u=h*c,p=d*c,g=v/(y+v),b=1-g;t.forEach((t=>{if("node"!==t.itemType)return!1;if(!s[t.id])return;const n=o[t.id];a.forEach((t=>{if("node"!==t.itemType)return!1;if(!s[t.id])return!1;const r=o[t.id];e[n].x+=u*g,e[n].y+=p*g,e[r].x-=u*b,e[r].y-=p*b}))}))}}))})),!0}))}calRepulsive(e,t){const n=this,r=n.nodes,i=n.width*n.optimizeRangeFactor,o=n.nodeStrength,s=n.alpha,a=n.nodeCollideStrength,l=n.preventNodeOverlap,c=n.nodeSize,u=n.nodeSpacing,h=n.depthRepulsiveForceScale,d=n.center;r.forEach(((f,p)=>{if(f.x&&f.y){if(d){const t=n.gravity,r=f.x-d[0]||.005,i=f.y-d[1]||.005,o=Math.sqrt(r*r+i*i);e[p].x-=r*t*s/o,e[p].y-=i*t*s/o}r.forEach(((n,r)=>{if(p===r)return;if(!n.x||!n.y)return;const{vl2:d,vl:g}=t[`${f.id}-${n.id}`];if(g>i)return;const{vx:m,vy:v}=t[`${f.id}-${n.id}`];let y=Math.log(Math.abs(n.depth-f.depth)/10)+1||1;y=y<1?1:y,n.comboId!==f.comboId&&(y+=1);const b=y?Math.pow(h,y):1,x=o(n)*s/d*b;if(e[p].x+=m*x,e[p].y+=v*x,p<r&&l){const t=c(f)+u(f)||1,i=c(n)+u(n)||1,o=t+i;if(d<o*o){const n=(o-g)/g*a,s=i*i;let l=s/(t*t+s);const c=m*n,u=v*n;e[p].x+=c*l,e[p].y+=u*l,l=1-l,e[r].x-=c*l,e[r].y-=u*l}}}))}}))}calAttractive(e,t){const n=this,r=n.edges,i=n.linkDistance,o=n.alpha,s=n.edgeStrength,a=n.bias,l=n.depthAttractiveForceScale;r.forEach(((r,c)=>{const u=UD(r,"source"),h=UD(r,"target");if(!u||!h||u===h)return;const d=n.indexMap[u],f=n.indexMap[h],p=n.nodeMap[u],g=n.nodeMap[h];if(!p||!g)return;let m=p.depth===g.depth?0:Math.log(Math.abs(p.depth-g.depth)/10);p.comboId===g.comboId&&(m/=2);let v=m?Math.pow(l,m):1;if(p.comboId!==g.comboId&&1===v?v=l/2:p.comboId===g.comboId&&(v=2),!(FD(g.x)&&FD(p.x)&&FD(g.y)&&FD(p.y)))return;const{vl:y,vx:b,vy:x}=t[`${h}-${u}`],w=(y-i(r))/y*o*s(r)*v,C=b*w,E=x*w,_=a[c];e[f].x-=C*_,e[f].y-=E*_,e[d].x+=C*(1-_),e[d].y+=E*(1-_)}))}getType(){return"comboForce"}},random:class extends ID{constructor(e){super(),this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],width:300,height:300}}execute(){const e=this,t=e.nodes,n=e.center;return e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),t&&t.forEach((t=>{t.x=.9*(Math.random()-.5)*e.width+n[0],t.y=.9*(Math.random()-.5)*e.height+n[1]})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:this.edges}}getType(){return"random"}},"gForce-gpu":class extends ID{constructor(e){super(),this.maxIteration=1e3,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}}execute(){return t9(this,void 0,void 0,(function*(){const e=this,t=e.nodes;if(!t||0===t.length)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const n=e.center;if(1===t.length)return t[0].x=n[0],t[0].y=n[1],void(e.onLayoutEnd&&e.onLayoutEnd());const r={},i={};t.forEach(((t,n)=>{FD(t.x)||(t.x=Math.random()*e.width),FD(t.y)||(t.y=Math.random()*e.height),r[t.id]=t,i[t.id]=n})),e.nodeMap=r,e.nodeIdxMap=i,e.nodeStrength=J7(e.nodeStrength,1),e.edgeStrength=J7(e.edgeStrength,1),yield e.run()}))}executeWithWorker(e,t){const n=this,r=n.nodes,i=n.center;if(!r||0===r.length)return;if(1===r.length)return r[0].x=i[0],void(r[0].y=i[1]);const o={},s={};r.forEach(((e,t)=>{FD(e.x)||(e.x=Math.random()*n.width),FD(e.y)||(e.y=Math.random()*n.height),o[e.id]=e,s[e.id]=t})),n.nodeMap=o,n.nodeIdxMap=s,n.nodeStrength=J7(n.nodeStrength,1),n.edgeStrength=J7(n.edgeStrength,1),n.run(e,t)}run(e,t){return t9(this,void 0,void 0,(function*(){const n=this,r=n.nodes,i=n.edges,o=n.maxIteration;n.width||"undefined"==typeof window||(n.width=window.innerWidth),n.height||"undefined"==typeof window||(n.height=window.innerHeight);const s=r.length;n.linkDistance=J7(n.linkDistance),n.edgeStrength=J7(n.edgeStrength);const{maxEdgePerVetex:a,array:l}=((e,t,n,r)=>{const i=[],o=[],s={};let a=0;for(a=0;a<e.length;a++){const t=e[a];s[t.id]=a,i.push(t.x),i.push(t.y),i.push(0),i.push(0),o.push([])}for(a=0;a<t.length;a++){const e=t[a],i=UD(e,"source"),l=UD(e,"target");o[s[i]].push(s[l]),o[s[i]].push(n(e)),o[s[i]].push(r(e)),o[s[i]].push(0),o[s[l]].push(s[i]),o[s[l]].push(n(e)),o[s[l]].push(r(e)),o[s[l]].push(0)}let l=0;for(a=0;a<e.length;a++){const e=i.length,t=o[a],n=t.length;i[4*a+2]=e+1048576*n/4,i[4*a+3]=0,l=Math.max(l,n/4);for(let e=0;e<n;++e){const n=t[e];i.push(+n)}}for(;i.length%4!=0;)i.push(0);return{maxEdgePerVetex:l,array:new Float32Array(i)}})(r,i,n.linkDistance,n.edgeStrength);n.degrees=VD(r.length,n.nodeIdxMap,i);const c=[],u=[],h=[],d=[],f=[],p=[],g=[];n.getMass||(n.getMass=e=>n.degrees[n.nodeIdxMap[e.id]]||1);const m=n.gravity,v=n.center;r.forEach(((e,t)=>{c.push(n.getMass(e)),u.push(n.nodeStrength(e)),n.degrees[t]||(n.degrees[t]=0);let r=[v[0],v[1],m];if(n.getCenter){const i=n.getCenter(e,n.degrees[t]);i&&FD(i[0])&&FD(i[1])&&FD(i[2])&&(r=i)}h.push(r[0]),d.push(r[1]),f.push(r[2]),FD(e.fx)&&FD(e.fy)?(p.push(e.fx||.001),g.push(e.fy||.001)):(p.push(0),g.push(0))}));const y=Q7([c,n.degrees,u,p]),b=Q7([h,d,f,g]);let x;x=n.workerEnabled?Z7.create({canvas:e,engineOptions:{supportCompute:!0}}):Z7.create({engineOptions:{supportCompute:!0}});const w=n.onLayoutEnd,C=[];l.forEach((e=>{C.push(e)}));for(let e=0;e<4;e++)C.push(0);const E=x.createKernel('{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_damping : f32;\\n  [[offset 4]] u_maxSpeed : f32;\\n  [[offset 8]] u_minMovement : f32;\\n  \\n  [[offset 12]] u_coulombDisScale : f32;\\n  [[offset 16]] u_factor : f32;\\n  \\n  \\n  [[offset 20]] u_interval : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray1 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\ntype GWebGPUBuffer3 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray2 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 4, set 0]] var<storage_buffer> gWebGPUBuffer3 : GWebGPUBuffer3;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn unpack_float(packedValue : f32) -> vec2<i32> {var packedIntValue : i32 = i32(packedValue);\\nvar v0 : i32 = packedIntValue / 1048576;\\nreturn vec2<i32>(v0, packedIntValue - (v0 * 1048576));}\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar vx : f32 = currentNode.x - nextNode.x;\\nvar vy : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar n_dist : f32 = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar attributesi : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar attributesj : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nvar massi : f32 = attributesi.x;\\nvar nodeStrengthi : f32 = attributesi.z;\\nvar nodeStrengthj : f32 = attributesj.z;\\nvar nodeStrength : f32 = (nodeStrengthi + nodeStrengthj) / 2.0;\\nvar param : f32 = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax = ax + direx * param;\\nay = ay + direy * param;}}\\nreturn vec2<f32>(ax, ay);}\\nfn calcGravity(i : i32, currentNode : vec4<f32>, attributes2 : vec4<f32>) -> vec2<f32> {var vx : f32 = currentNode.x - attributes2.x;\\nvar vy : f32 = currentNode.y - attributes2.y;\\nvar ax : f32 = vx * attributes2.z;\\nvar ay : f32 = vy * attributes2.z;\\nreturn vec2<f32>(ax, ay);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>, attributes1 : vec4<f32>) -> vec2<f32> {var mass : f32 = attributes1.x;\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nvar compressed : vec2<i32> = unpack_float(currentNode.z);\\nvar length : i32 = compressed.x;\\nvar arr_offset : i32 = compressed.y;\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + (4 * p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = node_buffer.x;\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar vx : f32 = nextNode.x - currentNode.x;\\nvar vy : f32 = nextNode.y - currentNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar edgeLength : f32 = node_buffer.y;\\nvar edgeStrength : f32 = node_buffer.z;\\nvar diff : f32 = edgeLength - dist;\\nvar param : f32 = (diff * edgeStrength) / mass;\\nax = ax - direx * param;\\nay = ay - direy * param;}\\nreturn vec2<f32>(ax, ay);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar movement : vec4<f32> = gWebGPUBuffer1.u_AveMovement[0];\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nif ((i >= __DefineValuePlaceholder__VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes1 : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar nodeAttributes2 : vec4<f32> = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\nax = ax + repulsive.x;\\nay = ay + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode, nodeAttributes1);\\nax = ax + attractive.x;\\nay = ay + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(i, currentNode, nodeAttributes2);\\nax = ax - gravity.x;\\nay = ay - gravity.y;\\nvar param : f32 = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nvar vx : f32 = ax * param;\\nvar vy : f32 = ay * param;\\nvar vlength : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {var param2 : f32 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nvar distx : f32 = vx * gWebGPUUniformParams.u_interval;\\nvar disty : f32 = vy * gWebGPUUniformParams.u_interval;\\nvar distLength : f32 = std::sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_damping;\\n  float u_maxSpeed;\\n  float u_minMovement;\\n  \\n  float u_coulombDisScale;\\n  float u_factor;\\n  \\n  \\n  float u_interval;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_NodeAttributeArray1[];\\n} gWebGPUBuffer2;\\n\\nlayout(std430, set = 0, binding = 4) buffer readonly  GWebGPUBuffer3 {\\n  vec4 u_NodeAttributeArray2[];\\n} gWebGPUBuffer3;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nivec2 unpack_float(float packedValue) {int packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {float ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 attributesj = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {float vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {float mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nvec4 movement = gWebGPUBuffer1.u_AveMovement[0];\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes1 = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 nodeAttributes2 = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {float param2 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * gWebGPUUniformParams.u_interval;\\nfloat disty = vy * gWebGPUUniformParams.u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {gl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([s,1,1]).setBinding({u_Data:l,u_damping:n.damping,u_maxSpeed:n.maxSpeed,u_minMovement:n.minMovement,u_coulombDisScale:n.coulombDisScale,u_factor:n.factor,u_NodeAttributeArray1:y,u_NodeAttributeArray2:b,MAX_EDGE_PER_VERTEX:a,VERTEX_COUNT:s,u_AveMovement:C,u_interval:n.interval}),_=x.createKernel('{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_iter : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var movement : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nmovement = movement + vertex.w;}\\nmovement = movement / f32(__DefineValuePlaceholder__VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4<f32>(movement, 0.0, 0.0, 0.0);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_iter;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {float movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = gWebGPUBuffer0.u_Data[j];\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4(movement, 0.0, 0.0, 0.0);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([1,1,1]).setBinding({u_Data:l,VERTEX_COUNT:s,u_AveMovement:[0,0,0,0]});yield(()=>t9(this,void 0,void 0,(function*(){for(let e=0;e<o;e++){yield E.execute(),_.setBinding({u_Data:E}),yield _.execute();const t=Math.max(.02,n.interval-.002*e);E.setBinding({u_interval:t,u_AveMovement:_})}const i=yield E.getOutput();e?t.postMessage({type:nN,vertexEdgeData:i}):r.forEach(((e,t)=>{const n=i[4*t],r=i[4*t+1];e.x=n,e.y=r})),w&&w()})))()}))}getType(){return"gForce-gpu"}},"fruchterman-gpu":class extends ID{constructor(e){super(),this.maxIteration=1e3,this.gravity=10,this.speed=1,this.clustering=!1,this.clusterField="cluster",this.clusterGravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){return e9(this,void 0,void 0,(function*(){const e=this,t=e.nodes;if(!t||0===t.length)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const n=e.center;if(1===t.length)return t[0].x=n[0],t[0].y=n[1],void(e.onLayoutEnd&&e.onLayoutEnd());const r={},i={};t.forEach(((e,t)=>{FD(e.x)||(e.x=Math.random()*this.width),FD(e.y)||(e.y=Math.random()*this.height),r[e.id]=e,i[e.id]=t})),e.nodeMap=r,e.nodeIdxMap=i,yield e.run()}))}executeWithWorker(e,t){return e9(this,void 0,void 0,(function*(){const n=this,r=n.nodes,i=n.center;if(!r||0===r.length)return;if(1===r.length)return r[0].x=i[0],void(r[0].y=i[1]);const o={},s={};r.forEach(((e,t)=>{FD(e.x)||(e.x=Math.random()*this.width),FD(e.y)||(e.y=Math.random()*this.height),o[e.id]=e,s[e.id]=t})),n.nodeMap=o,n.nodeIdxMap=s,yield n.run(e,t)}))}run(e,t){return e9(this,void 0,void 0,(function*(){const n=this,r=n.nodes,i=n.edges,o=n.maxIteration,s=n.center,a=n.height*n.width;let l=Math.sqrt(a)/10;const c=a/(r.length+1),u=Math.sqrt(c),h=n.speed,d=n.clustering,{array:f,count:p}=((e,t)=>{const n=[],r=e.length,i={};return t.forEach((t=>{e.forEach(((e,o)=>{if(void 0===i[t[e]]&&(i[t[e]]=Object.keys(i).length),n.push(i[t[e]]),o===r-1)for(;n.length%4!=0;)n.push(0)}))})),{array:new Float32Array(n),count:Object.keys(i).length}})([n.clusterField],r);r.forEach(((e,t)=>{let n=0,r=0;FD(e.fx)&&FD(e.fy)&&(n=e.fx||.001,r=e.fy||.001),f[4*t+1]=n,f[4*t+2]=r}));const g=r.length,{maxEdgePerVetex:m,array:v}=((e,t)=>{const n=[],r=[],i={};let o=0;for(o=0;o<e.length;o++){const t=e[o];i[t.id]=o,n.push(t.x),n.push(t.y),n.push(0),n.push(0),r.push([])}for(o=0;o<t.length;o++){const e=t[o],n=UD(e,"source"),s=UD(e,"target");r[i[n]].push(i[s]),r[i[s]].push(i[n])}let s=0;for(o=0;o<e.length;o++){const e=n.length,t=r[o],i=t.length;n[4*o+2]=e,n[4*o+3]=t.length,s=Math.max(s,t.length);for(let e=0;e<i;++e){const r=t[e];n.push(+r)}}for(;n.length%4!=0;)n.push(0);return{maxEdgePerVetex:s,array:new Float32Array(n)}})(r,i);let y;y=n.workerEnabled?Z7.create({canvas:e,engineOptions:{supportCompute:!0}}):Z7.create({engineOptions:{supportCompute:!0}});const b=n.onLayoutEnd,x=[];for(let e=0;e<p;e++)x.push(0,0,0,0);const w=y.createKernel('{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_K : f32;\\n  [[offset 4]] u_K2 : f32;\\n  [[offset 8]] u_Center : vec2<f32>;\\n  [[offset 16]] u_Gravity : f32;\\n  [[offset 20]] u_ClusterGravity : f32;\\n  [[offset 24]] u_Speed : f32;\\n  [[offset 28]] u_MaxDisplace : f32;\\n  [[offset 32]] u_Clustering : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AttributeArray : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar param : f32 = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx = dx + param * xDist;\\ndy = dy + param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < j);\\ndx = dx + param * std::sign;\\ndy = dy + param * std::sign;}}}}\\nreturn vec2<f32>(dx, dy);}\\nfn calcGravity(currentNode : vec4<f32>, nodeAttributes : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar vx : f32 = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nvar vy : f32 = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nvar gf : f32 = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {var clusterIdx : i32 = i32(nodeAttributes.x);\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nvar cvx : f32 = currentNode.x - center.x;\\nvar cvy : f32 = currentNode.y - center.y;\\nvar dist : f32 = std::sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nvar parma : f32 = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx = dx + parma * cvx;\\ndy = dy + parma * cvy;}\\nreturn vec2<f32>(dx, dy);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar arr_offset : i32 = i32(std::floor(currentNode.z + 0.5));\\nvar length : i32 = i32(std::floor(currentNode.w + 0.5));\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + i32(p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = select(node_buffer.x, select(node_buffer.y, select(node_buffer.z, node_buffer.w, buf_offset == 2), buf_offset == 1), buf_offset == 0);\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar attractiveF : f32 = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx = dx - xDist * attractiveF;\\ndy = dy - yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < i32(float_j));\\ndx = dx - std::sign * attractiveF;\\ndy = dy - std::sign * attractiveF;}}}\\nreturn vec2<f32>(dx, dy);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nif (i >= __DefineValuePlaceholder__VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes : vec4<f32> = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\ndx = dx + repulsive.x;\\ndy = dy + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode);\\ndx = dx + attractive.x;\\ndy = dy + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(currentNode, nodeAttributes);\\ndx = dx - gravity.x;\\ndy = dy - gravity.y;\\ndx = dx * gWebGPUUniformParams.u_Speed;\\ndy = dy * gWebGPUUniformParams.u_Speed;\\nvar distLength : f32 = std::sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {var limitedDist : f32 = std::min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_K;\\n  float u_K2;\\n  vec2 u_Center;\\n  float u_Gravity;\\n  float u_ClusterGravity;\\n  float u_Speed;\\n  float u_MaxDisplace;\\n  float u_Clustering;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AttributeArray[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nvec2 calcRepulsive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {float dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nfloat vy = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nfloat gf = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= gWebGPUUniformParams.u_Speed;\\ndy *= gWebGPUUniformParams.u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([g,1,1]).setBinding({u_Data:v,u_K:u,u_K2:c,u_Gravity:n.gravity,u_ClusterGravity:n.clusterGravity||n.gravity||1,u_Speed:h,u_MaxDisplace:l,u_Clustering:d?1:0,u_Center:s,u_AttributeArray:f,u_ClusterCenters:x,MAX_EDGE_PER_VERTEX:m,VERTEX_COUNT:g});let C;d&&(C=y.createKernel('{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\n\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 0, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributes : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[i];\\nvar sumx : f32 = 0.0;\\nvar sumy : f32 = 0.0;\\nvar count : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var attributes : vec4<f32> = gWebGPUBuffer1.u_NodeAttributes[j];\\nvar clusterIdx : i32 = i32(attributes.x);\\nvar vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx = sumx + vertex.x;\\nsumy = sumy + vertex.y;\\ncount = count + 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4<f32>(sumx / count, sumy / count, count, i);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\n\\nlayout(std430, set = 0, binding = 0) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_NodeAttributes[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {int i = globalInvocationID.x;\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[i];\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = gWebGPUBuffer1.u_NodeAttributes[j];\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4(sumx / count, sumy / count, count, i);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([p,1,1]).setBinding({u_Data:v,u_NodeAttributes:f,u_ClusterCenters:x,VERTEX_COUNT:g,CLUSTER_COUNT:p}));yield(()=>e9(this,void 0,void 0,(function*(){for(let e=0;e<o;e++)yield w.execute(),d&&(C.setBinding({u_Data:w}),yield C.execute(),w.setBinding({u_ClusterCenters:C})),w.setBinding({u_MaxDisplace:l*=.99});const n=yield w.getOutput();e?t.postMessage({type:nN,vertexEdgeData:n}):r.forEach(((e,t)=>{const r=n[4*t],i=n[4*t+1];e.x=r,e.y=i})),b&&b()})))()}))}getType(){return"fruchterman-gpu"}},er:class extends ID{constructor(e){super(),this.width=300,this.height=300,this.nodeMinGap=50,this.onLayoutEnd=()=>{},e&&this.updateCfg(e)}getDefaultCfg(){return{width:300,height:300,nodeMinGap:50}}execute(){const e=this,t=e.nodes,n=e.edges;return null==t||t.forEach((e=>{e.size||(e.size=[50,50])})),g9({nodes:t,edges:n},{width:this.width,height:this.height,nodeMinGap:this.nodeMinGap}).then((()=>{e.onLayoutEnd&&e.onLayoutEnd()}))}getType(){return"er"}}};var v9,y9=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},b9=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},x9=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.GRAPH_LAYOUT,t.hookKey="graphLayout"}(v9||(v9={}));let w9=class{constructor(){this.execute=()=>x9(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),r=yield n.graphLayout.call(e,(e=>x9(this,void 0,void 0,(function*(){const{layoutType:t,layoutOptions:n,customLayout:r}=e,i=r||(e=>new(0,m9[t])(Object.assign({},n)).layout(e));return yield i(e.graphData),{graphData:e.graphData}}))),t);return this.ctx.setResult(r),this})),this.undo=()=>x9(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>x9(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};y9([Wn(oM),b9("design:type",Object)],w9.prototype,"contextProvider",void 0),y9([f.postConstruct(),b9("design:type",Function),b9("design:paramtypes",[]),b9("design:returntype",void 0)],w9.prototype,"init",null),w9=y9([Vn({token:{token:iM,named:v9.command.id}})],w9);var C9,E9,_9=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},S9=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},O9=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.isNodeEqual=function(e,t){return r.isEqual(e,t)},e.isEdgeEqual=function(e,t){return r.isEqual(e,t)}}(C9||(C9={})),function(t){t.command=e.XFlowGraphCommands.GRAPH_RENDER,t.hookKey="graphRender"}(E9||(E9={}));let A9=class{constructor(){this.execute=()=>O9(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),r=yield n.graphRender.call(e,(e=>O9(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),n=yield this.ctx.getGraphMeta(),{beforeRender:r,graphData:i,isNodeEqual:o,isEdgeEqual:s,afterRender:a}=e;return r&&r(n),yield this.doLoadGraph(t,i,o,s),a&&a(i,n),{}}))),t);return this.ctx.setResult(r),this})),this.undo=()=>O9(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>O9(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this})),this.doLoadGraph=(t,n,r,i)=>O9(this,void 0,void 0,(function*(){(null==t?void 0:t.isFrozen())||null==t||t.freeze();const o=this.ctx.getCommands(),{addNodeConfigs:s,addEdgeConfigs:a,removeNodes:l,removeEdges:c,updateNodes:u,updateEdges:h}=this.graphDataDiff(t,n,r,i);for(const t of s)yield o.executeCommand(e.XFlowNodeCommands.ADD_NODE.id,{nodeConfig:t},{name:"remove servcie",handler:e=>O9(this,void 0,void 0,(function*(){delete e.createNodeService}))});yield o.executeCommand(e.XFlowGroupCommands.INIT_GROUP.id,{graphData:{nodes:s,edges:[]}});for(const t of a)yield o.executeCommand(e.XFlowEdgeCommands.ADD_EDGE.id,{edgeConfig:t},{name:"remove servcie",handler:e=>O9(this,void 0,void 0,(function*(){delete e.createEdgeService}))});for(const t of l){const n=null==t?void 0:t.getData();n.isGroup?yield o.executeCommand(e.XFlowGroupCommands.DEL_GROUP.id,{nodeConfig:n}):yield o.executeCommand(e.XFlowNodeCommands.DEL_NODE.id,{nodeConfig:n})}for(const t of c){const n=null==t?void 0:t.getData();yield o.executeCommand(e.XFlowEdgeCommands.DEL_EDGE.id,{edgeConfig:n})}for(const t of u){const n=null==t?void 0:t.getData();yield o.executeCommand(e.XFlowNodeCommands.UPDATE_NODE.id,{nodeConfig:n})}for(const t of h){const n=null==t?void 0:t.getData();yield o.executeCommand(e.XFlowEdgeCommands.UPDATE_EDGE.id,{edgeConfig:n})}(null==t?void 0:t.isFrozen())&&(null==t||t.unfreeze())}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}graphDataDiff(e,t,n,r){const{nodes:i,edges:o}=t,s=[];i.forEach((t=>{e.getCellById(null==t?void 0:t.id)||s.push(t)}));const a=[],l=[],c=[];e.getNodes().forEach((e=>{const t=i.find((t=>(null==t?void 0:t.id)===(null==e?void 0:e.id)));if(t){let r=!0;n?r=n(null==e?void 0:e.data,t):(null==e?void 0:e.data)&&t&&(r=C9.isNodeEqual(null==e?void 0:e.data,t)),r||e.setData(t),!0===r?a.push(e):l.push(e)}else c.push(e)}));const u=[];o.forEach((t=>{e.getCellById(null==t?void 0:t.id)||u.push(t)}));const h=[],d=[],f=[];return e.getEdges().forEach((e=>{const t=o.find((t=>(null==t?void 0:t.id)===(null==e?void 0:e.id)));if(t){let n=!0;r?n=r(null==e?void 0:e.data,t):(null==e?void 0:e.data)&&t&&(n=C9.isEdgeEqual(null==e?void 0:e.data,t)),n||e.setData(t),!0===n?h.push(e):d.push(e)}else f.push(e)})),{addNodeConfigs:s,addEdgeConfigs:u,retainNodes:a,retainEdges:h,removeNodes:c,removeEdges:f,updateNodes:l,updateEdges:d}}};_9([Wn(oM),S9("design:type",Object)],A9.prototype,"contextProvider",void 0),_9([f.postConstruct(),S9("design:type",Function),S9("design:paramtypes",[]),S9("design:returntype",void 0)],A9.prototype,"init",null),A9=_9([Vn({token:{token:iM,named:E9.command.id}})],A9);var k9,M9=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},T9=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},P9=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.GRAPH_RESIZE,t.hookKey="graphResize"}(k9||(k9={}));let D9=class{constructor(){this.execute=()=>P9(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),r=yield this.ctx.getGraphConfig(),i=r.rootContainer.clientHeight,o=r.rootContainer.clientWidth,s=yield n.graphResize.call(e,(e=>P9(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{width:n=o,height:r=i}=e;return null==t||t.resize(n,r),{}}))),t);return this.ctx.setResult(s),this})),this.undo=()=>P9(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>P9(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};M9([Wn(oM),T9("design:type",Object)],D9.prototype,"contextProvider",void 0),M9([f.postConstruct(),T9("design:type",Function),T9("design:paramtypes",[]),T9("design:returntype",void 0)],D9.prototype,"init",null),D9=M9([Vn({token:{token:iM,named:k9.command.id}})],D9);var N9,R9=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},I9=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},j9=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.GRAPH_ZOOM,t.MAX_SCALE=1.5,t.MIN_SCALE=.05,t.defaultZoomOptions={maxScale:t.MAX_SCALE,minScale:t.MIN_SCALE},t.hookKey="graphZoom"}(N9||(N9={}));let L9=class{constructor(){this.execute=()=>j9(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),r=yield n.graphZoom.call(e,(e=>j9(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{factor:n,zoomFitPadding:r=12,zoomOptions:i=N9.defaultZoomOptions}=e;return"number"==typeof n?null==t||t.zoom(n,i||{}):"fit"===n?null==t||t.zoomToFit(Object.assign(Object.assign({},i),{padding:r})):"real"===n&&(null==t||t.scale(1),null==t||t.centerContent()),{factor:n,zoomFitPadding:r,zoomOptions:i}}))),t);return this.ctx.setResult(r),this})),this.undo=()=>j9(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>j9(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};R9([Wn(oM),I9("design:type",Object)],L9.prototype,"contextProvider",void 0),R9([f.postConstruct(),I9("design:type",Function),I9("design:paramtypes",[]),I9("design:returntype",void 0)],L9.prototype,"init",null),L9=R9([Vn({token:{token:iM,named:N9.command.id}})],L9);var F9,G9=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},B9=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},z9=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.GRAPH_COPY,t.hookKey="graphCopySelection"}(F9||(F9={}));let U9=class{constructor(){this.parseCells=e=>{e.forEach((t=>{const n=t.getData();if(t.isNode()&&n.isGroup){t.getChildren().forEach((t=>{e.push(t)}))}}));const t=e.filter((e=>e.isNode())).map((e=>e.id)),n=e.reduce(((e,n)=>{if(n.isEdge()){const r=n.getSourceCellId(),i=n.getTargetCellId();r&&i&&t.includes(r)&&t.includes(i)&&e.set(n.id,n)}else e.set(n.id,n);return e}),new Map),r=Array.from(n.values());return QT(r)},this.execute=()=>z9(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks(),o=yield i.graphCopySelection.call(n,(()=>z9(this,void 0,void 0,(function*(){const n=(yield t.getX6Graph()).getSelectedCells(),r=this.parseCells(n),i=window.localStorage.getItem(Z_);return window.localStorage.setItem(Z_,JSON.stringify(r)),t.addUndo(e.Disposable.create((()=>z9(this,void 0,void 0,(function*(){window.localStorage.setItem(Z_,i)}))))),{err:null}}))),r);return t.setResult(o),this})),this.undo=()=>z9(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>z9(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};G9([Wn(oM),B9("design:type",Object)],U9.prototype,"contextProvider",void 0),U9=G9([Vn({token:{token:iM,named:F9.command.id}})],U9);var V9=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};let H9=class{constructor(){this.groupNodeMap=new Map,this.nodeMap=new Map,this.nodeMappingRecord=new Map,this.portMap=new Map,this.portMappingRecord=new Map,this.edgeMap=new Map,this.edgeMappingRecord=new Map,this.getNodesByType=e=>e.reduce(((e,t)=>(t.isGroup?e.groupNodes.push(t):e.normalNodes.push(t),e)),{normalNodes:[],groupNodes:[]}),this.getNodePorts=e=>Array.isArray(e.ports)?e.ports:e.ports&&Array.isArray(e.ports.items)?e.ports.items:[],this.addNodes=e=>{e.forEach((e=>{if(e.isGroup)this.groupNodeMap.set(e.id,e);else{const t=this.getNodePorts(e);this.nodeMap.set(e.id,e),t.forEach((e=>{this.portMap.set(e.id,e)}))}}))},this.addEdge=e=>{e.forEach((e=>{this.edgeMap.set(e.id,e)}))},this.buildNodeMapping=(e,t)=>{const n=e.id||e.originId,r=t.id;this.nodeMappingRecord.set(n,r);this.getNodePorts(e).forEach(((e,n)=>{const r=t.ports[n];r&&(this.portMap.set(r.id,r),this.portMappingRecord.set(e.id,r.id))}))},this.createEdgeBetweenNodes=e=>{const{source:t,sourcePortId:n,target:r,targetPortId:i}=e;return Object.assign(Object.assign({},e),{source:this.nodeMappingRecord.get(t),target:this.nodeMappingRecord.get(r),sourcePortId:this.portMappingRecord.get(n),targetPortId:this.portMappingRecord.get(i)})},this.buildGroupRelations=e=>{const{groupChildren:t}=e,n=t.map((e=>this.nodeMappingRecord.get(e)));return Object.assign(Object.assign({},e),{groupChildren:n})}}};H9=V9([Vn()],H9);var W9,$9,X9=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Y9=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},q9=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};function K9(e,t=0){return Math.floor(Math.random()*(e-t)+t)}!function(t){t.command=e.XFlowGraphCommands.GRAPH_PASTE,t.hookKey="graphPasteSelection"}($9||($9={}));let Z9=W9=class{constructor(){this.updateNodeCopiedProps=(e,t)=>{let n=K9(100),r=K9(100);return e&&(n=t.x-e.x+K9(30),r=t.y-e.y+K9(30)),t.x+=n,t.y+=r,t.originId=t.id,delete t.id,t.label=`${t.label}_copied`,t.isCollapsed=!1,t},this.execute=()=>q9(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks();if(W9.doing)return this;W9.doing=!0;const o=yield i.graphPasteSelection.call(n,(n=>q9(this,void 0,void 0,(function*(){const{commandService:r,position:i}=n,o=function(e,t=null){try{return JSON.parse(e)||t}catch(e){return console.error(e),t}}(window.localStorage.getItem(Z_),{nodes:[],edges:[]}),{nodes:s=[],edges:a=[]}=o,{normalNodes:l,groupNodes:c}=this.mappingHelper.getNodesByType(s);return this.mappingHelper.addNodes(s),yield Promise.all(l.map((t=>q9(this,void 0,void 0,(function*(){const n=(yield r.executeCommand(e.XFlowNodeCommands.ADD_NODE.id,{nodeConfig:this.updateNodeCopiedProps(i,t)})).contextProvider().getResult();this.mappingHelper.buildNodeMapping(t,n.nodeConfig)}))))),yield Promise.all(c.map((t=>q9(this,void 0,void 0,(function*(){const n=this.mappingHelper.buildGroupRelations(t);yield r.executeCommand(e.XFlowGroupCommands.ADD_GROUP.id,{nodeConfig:this.updateNodeCopiedProps(i,n)})}))))),yield Promise.all(a.map((t=>{const n=this.mappingHelper.createEdgeBetweenNodes(t);return r.executeCommand(e.XFlowEdgeCommands.ADD_EDGE.id,{edgeConfig:n})}))),t.addUndo(e.Disposable.create((()=>q9(this,void 0,void 0,(function*(){window.localStorage.setItem(Z_,null)}))))),{err:null}}))),r);return t.setResult(o),W9.doing=!1,this})),this.undo=()=>q9(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>q9(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};Z9.doing=!1,X9([Wn(oM),Y9("design:type",Object)],Z9.prototype,"contextProvider",void 0),X9([Wn(H9),Y9("design:type",H9)],Z9.prototype,"mappingHelper",void 0),Z9=W9=X9([Vn({token:{token:iM,named:$9.command.id}})],Z9);var J9,Q9=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},eee=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},tee=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.GRAPH_TOGGLE_MULTI_SELECT,t.hookKey="toggleMultiSelect"}(J9||(J9={}));let nee=class{constructor(){this.execute=()=>tee(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),r=yield n.toggleMultiSelect.call(e,(e=>tee(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),n=yield this.ctx.getGraphConfig(),{isEnable:r,modelService:i}=e,o=yield bT.getModel(i),s="boolean"==typeof r?r:!t.isRubberbandEnabled();return s?(t.enableRubberband(),t.scroller&&t.scroller.widget?t.scroller.disablePanning():t.disablePanning(),n.graphContainer.style.cursor="crosshair"):(t.disableRubberband(),t.scroller&&t.scroller.widget?t.scroller.enablePanning():t.enablePanning(),n.graphContainer.style.cursor="grab"),o.setValue({isEnable:s}),{isEnable:s}}))),t);return this.ctx.setResult(r),this})),this.undo=()=>tee(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>tee(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};Q9([Wn(oM),eee("design:type",Object)],nee.prototype,"contextProvider",void 0),Q9([f.postConstruct(),eee("design:type",Function),eee("design:paramtypes",[]),eee("design:returntype",void 0)],nee.prototype,"init",null),nee=Q9([Vn({token:{token:iM,named:J9.command.id}})],nee);var ree,iee=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},oee=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},see=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.GRAPH_HISTORY_UNDO,t.hookKey="historyUndo"}(ree||(ree={}));let aee=class{constructor(){this.execute=()=>see(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks(),o=yield i.historyUndo.call(n,(n=>see(this,void 0,void 0,(function*(){const r=yield t.getX6Graph();return!1===r.isHistoryEnabled()?{err:"history is disabled"}:(r.undo(),t.addUndo(e.Disposable.create((()=>see(this,void 0,void 0,(function*(){const{commandService:t}=n;t.executeCommand(e.XFlowGraphCommands.GRAPH_HISTORY_REDO.id,{})}))))),{err:null})}))),r);return t.setResult(o),this})),this.undo=()=>see(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>see(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};iee([Wn(oM),oee("design:type",Object)],aee.prototype,"contextProvider",void 0),aee=iee([Vn({token:{token:iM,named:ree.command.id}})],aee);var lee,cee=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},uee=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hee=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.GRAPH_HISTORY_REDO,t.hookKey="historyRedo"}(lee||(lee={}));let dee=class{constructor(){this.execute=()=>hee(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks(),o=yield i.historyRedo.call(n,(n=>hee(this,void 0,void 0,(function*(){const r=yield t.getX6Graph();return!1===r.isHistoryEnabled()?{err:"history is disabled"}:(r.redo(),t.addUndo(e.Disposable.create((()=>hee(this,void 0,void 0,(function*(){const{commandService:t}=n;t.executeCommand(e.XFlowGraphCommands.GRAPH_HISTORY_UNDO.id,{})}))))),{err:null})}))),r);return t.setResult(o),this})),this.undo=()=>hee(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>hee(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};cee([Wn(oM),uee("design:type",Object)],dee.prototype,"contextProvider",void 0),dee=cee([Vn({token:{token:iM,named:lee.command.id}})],dee);var fee,pee=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},gee=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},mee=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.GRAPH_HISTORY_TOGGLE,t.hookKey="historyToggle"}(fee||(fee={}));let vee=class{constructor(){this.execute=()=>mee(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks(),o=yield i.historyToggle.call(n,(n=>mee(this,void 0,void 0,(function*(){const r=yield t.getX6Graph();if(!1===r.isHistoryEnabled())return{err:"history is disabled"};const i=r.isHistoryEnabled(),{enabled:o}=n;return r.toggleHistory(o),t.addUndo(e.Disposable.create((()=>mee(this,void 0,void 0,(function*(){const{commandService:t}=n;t.executeCommand(e.XFlowGraphCommands.GRAPH_HISTORY_TOGGLE.id,{enabled:i})}))))),{err:null}}))),r);return t.setResult(o),this})),this.undo=()=>mee(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>mee(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};pee([Wn(oM),gee("design:type",Object)],vee.prototype,"contextProvider",void 0),vee=pee([Vn({token:{token:iM,named:fee.command.id}})],vee);var yee,bee=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},xee=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},wee=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.GRAPH_HISTORY_RESET,t.hookKey="historyReset"}(yee||(yee={}));let Cee=class{constructor(){this.execute=()=>wee(this,void 0,void 0,(function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),r=e.getHooks(),i=yield r.historyReset.call(t,(()=>wee(this,void 0,void 0,(function*(){return(yield e.getX6Graph()).cleanHistory(),{err:null}}))),n);return e.setResult(i),this})),this.undo=()=>wee(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>wee(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};bee([Wn(oM),xee("design:type",Object)],Cee.prototype,"contextProvider",void 0),Cee=bee([Vn({token:{token:iM,named:yee.command.id}})],Cee);var Eee,_ee=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},See=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Oee=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.GRAPH_ADD_TOOL,t.hookKey="addTool"}(Eee||(Eee={}));let Aee=class{constructor(){this.execute=()=>Oee(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks(),o=yield i.addTool.call(n,(n=>Oee(this,void 0,void 0,(function*(){const{cellId:r,toolConfig:i,commandService:o}=n,s=(yield t.getX6Graph()).getCellById(r);return s&&(s.addTools(i.items,i.options),t.addUndo(e.Disposable.create((()=>Oee(this,void 0,void 0,(function*(){Array.isArray(i.items)&&i.items.forEach((t=>{o.executeCommand(e.XFlowGraphCommands.GRAPH_DEL_TOOL.id,{cellId:r,toolname:t})}))})))))),{err:null}}))),r);return t.setResult(o),this})),this.undo=()=>Oee(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>Oee(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};_ee([Wn(oM),See("design:type",Object)],Aee.prototype,"contextProvider",void 0),Aee=_ee([Vn({token:{token:iM,named:Eee.command.id}})],Aee);var kee,Mee=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Tee=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Pee=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.GRAPH_DEL_TOOL,t.hookKey="delTool"}(kee||(kee={}));let Dee=class{constructor(){this.execute=()=>Pee(this,void 0,void 0,(function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),r=e.getHooks(),i=yield r.delTool.call(t,(t=>Pee(this,void 0,void 0,(function*(){const{cellId:n,toolName:r,toolConfig:i}=t,o=(yield e.getX6Graph()).getCellById(n);return o&&("*"===r?o.removeTools(i):o.removeTool(r,i)),{err:null}}))),n);return e.setResult(i),this})),this.undo=()=>Pee(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>Pee(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};Mee([Wn(oM),Tee("design:type",Object)],Dee.prototype,"contextProvider",void 0),Dee=Mee([Vn({token:{token:iM,named:kee.command.id}})],Dee);var Nee,Ree=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Iee=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},jee=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.REDO_CMD,t.hookKey="redoCommand"}(Nee||(Nee={}));let Lee=class{constructor(){this.execute=()=>jee(this,void 0,void 0,(function*(){const t=this.ctx,{args:n,hooks:r}=t.getArgs(),i=t.getHooks();return yield i.redoCommand.call(n,(()=>jee(this,void 0,void 0,(function*(){const n=t.getCommands();return n.isRedoable&&n.redoCommand(),this.ctx.addUndo(e.Disposable.create((()=>{n.redoCommand()}))),{}}))),r),this})),this.undo=()=>jee(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>jee(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};Ree([Wn(oM),Iee("design:type",Object)],Lee.prototype,"contextProvider",void 0),Ree([f.postConstruct(),Iee("design:type",Function),Iee("design:paramtypes",[]),Iee("design:returntype",void 0)],Lee.prototype,"init",null),Lee=Ree([Vn({token:{token:iM,named:Nee.command.id}})],Lee);var Fee,Gee=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Bee=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},zee=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGraphCommands.UNDO_CMD,t.hookKey="undoCommand"}(Fee||(Fee={}));let Uee=class{constructor(){this.execute=()=>zee(this,void 0,void 0,(function*(){const t=this.ctx,{args:n,hooks:r}=t.getArgs(),i=t.getHooks();return yield i.undoCommand.call(n,(()=>zee(this,void 0,void 0,(function*(){const n=t.getCommands();return n.isUndoable&&n.undoCommand(),this.ctx.addUndo(e.Disposable.create((()=>{n.redoCommand()}))),{}}))),r),this})),this.undo=()=>zee(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>zee(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};Gee([Wn(oM),Bee("design:type",Object)],Uee.prototype,"contextProvider",void 0),Gee([f.postConstruct(),Bee("design:type",Function),Bee("design:paramtypes",[]),Bee("design:returntype",void 0)],Uee.prototype,"init",null),Uee=Gee([Vn({token:{token:iM,named:Fee.command.id}})],Uee);const Vee=[xD,SD,TD,ree,lee,yee,fee,v9,E9,k9,Nee,Fee,N9,J9,F9,$9,Eee,kee];var Hee,Wee=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},$ee=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Xee=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowEdgeCommands.ADD_EDGE,t.hookKey="addEdge",t.createEdgeId=e=>`${e.source}:${e.sourcePortId}-${e.target}:${e.targetPortId}`}(Hee||(Hee={}));let Yee=class{constructor(){this.processEdgeConfig=(e,t)=>Xee(this,void 0,void 0,(function*(){if(!t.id){const{createIdService:n=Hee.createEdgeId}=e;t.id=yield n(t)}return t})),this.execute=()=>Xee(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),r=this.ctx.getHooks(),i=yield r.addEdge.call(t,(t=>Xee(this,void 0,void 0,(function*(){const{cellFactory:n,createEdgeService:r,commandService:i}=t,o=r?yield r(t):t.edgeConfig,s=yield this.ctx.getX6Graph();let a;if(yield this.processEdgeConfig(t,o),n){const e=yield n(o,this);a=s.addEdge(e)}else a=s.addEdge(Object.assign(Object.assign({},o),{label:(null==o?void 0:o.label)||o,data:Object.assign({},o)}));const l=e.Disposable.create((()=>{i.executeCommand(e.XFlowEdgeCommands.DEL_EDGE.id,{x6Edge:a})}));return this.ctx.addUndo(l),{edgeConfig:o,edgeCell:a}}))),n);return this.ctx.setResult(i),this})),this.undo=()=>Xee(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>Xee(this,void 0,void 0,(function*(){return this.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};Wee([Wn(oM),$ee("design:type",Object)],Yee.prototype,"contextProvider",void 0),Wee([f.postConstruct(),$ee("design:type",Function),$ee("design:paramtypes",[]),$ee("design:returntype",void 0)],Yee.prototype,"init",null),Yee=Wee([Vn({token:{token:iM,named:Hee.command.id}})],Yee);var qee,Kee=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Zee=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Jee=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){var n;t.command=e.XFlowEdgeCommands.DEL_EDGE,t.hookKey="delEdge",(n=t.ErrEnum||(t.ErrEnum={})).EDGE_NOT_EXIST="edge is not exist",n.EDGE_INVALID_CELL="this is not a valid cell",n.X6_DELETE_FAILED="x6 throw err when call delete edge",n.SERVICE_REJECT="service reject to delete"}(qee||(qee={}));let Qee=class{constructor(){this.execute=()=>Jee(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),r=this.ctx.getHooks(),i=yield r.delEdge.call(t,(t=>Jee(this,void 0,void 0,(function*(){const{edgeConfig:n,x6Edge:r,deleteEdgeService:i,commandService:o}=t;let s=r;if(!s&&(s=yield this.findEdgeById(n),!s))return console.error(qee.ErrEnum.EDGE_NOT_EXIST,n),{err:qee.ErrEnum.EDGE_NOT_EXIST};if(!(s&&s.isEdge()))return console.error(qee.ErrEnum.EDGE_NOT_EXIST,s),{err:qee.ErrEnum.EDGE_NOT_EXIST};if(i){if(!(yield i(t)))return{err:qee.ErrEnum.SERVICE_REJECT}}try{const t=s.getTargetCell(),n=s.getSourceCell(),r=s.getSourcePortId(),i=s.getTargetPortId(),a=n.id,l=t.id;s.remove();const c=e.Disposable.create((()=>{o.executeCommand(e.XFlowEdgeCommands.ADD_EDGE.id,{edgeConfig:{source:a,target:l,sourcePortId:r,targetPortId:i}})}));return this.ctx.addUndo(c),{err:null,edgeConfig:{source:a,target:l,sourcePortId:r,targetPortId:i},targetCell:t,sourceCell:n,sourcePortId:r,targetPortId:i}}catch(e){return console.error(qee.ErrEnum.X6_DELETE_FAILED,e),{err:qee.ErrEnum.X6_DELETE_FAILED}}}))),n);return this.ctx.setResult(i),this})),this.findEdgeById=e=>Jee(this,void 0,void 0,(function*(){return(yield this.ctx.getX6Graph()).getCellById(e.id)})),this.undo=()=>Jee(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>Jee(this,void 0,void 0,(function*(){return this.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};Kee([Wn(oM),Zee("design:type",Object)],Qee.prototype,"contextProvider",void 0),Kee([f.postConstruct(),Zee("design:type",Function),Zee("design:paramtypes",[]),Zee("design:returntype",void 0)],Qee.prototype,"init",null),Qee=Kee([Vn({token:{token:iM,named:qee.command.id}})],Qee);var ete,tte=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},nte=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},rte=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowEdgeCommands.UPDATE_EDGE,t.hookKey="updateEdge"}(ete||(ete={}));let ite=class{constructor(){this.execute=()=>rte(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),r=yield n.updateEdge.call(e,(e=>rte(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{updateEdgeService:n}=e,r=n?yield n(e):null==e?void 0:e.edgeConfig,i=null==t?void 0:t.getCellById(null==r?void 0:r.id);return null==i||i.setData(r),null==i||i.setLabelAt(0,(null==r?void 0:r.label)||r),r.attrs&&i.setAttrs(r.attrs),{edgeConfig:r,edgeCell:i}}))),t);return this.ctx.setResult(r),this})),this.undo=()=>rte(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>rte(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};tte([Wn(oM),nte("design:type",Object)],ite.prototype,"contextProvider",void 0),tte([f.postConstruct(),nte("design:type",Function),nte("design:paramtypes",[]),nte("design:returntype",void 0)],ite.prototype,"init",null),ite=tte([Vn({token:{token:iM,named:ete.command.id}})],ite);var ote,ste=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},ate=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},lte=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowEdgeCommands.HIGHLIGHT_EDGE,t.hookKey="highlightEdge"}(ote||(ote={}));let cte=class{constructor(){this.execute=()=>lte(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),r=this.ctx.getHooks(),i=yield r.highlightEdge.call(t,(t=>lte(this,void 0,void 0,(function*(){var n,r;const i=yield this.ctx.getX6Graph(),{edgeId:o,strokeColor:s,strokeWidth:a}=t,l=i.getEdges(),c=l.find((e=>e.id===o)),u=l.filter((e=>e.id!==o));if(c){const i=c.getAttrs();(null===(n=null==i?void 0:i.line)||void 0===n?void 0:n.stroke)===s&&(null===(r=null==i?void 0:i.line)||void 0===r?void 0:r.strokeWidth)===a||(null==c||c.setAttrs({line:{stroke:s,strokeWidth:a||2}}),u.forEach((e=>{e.setAttrs({line:null==i?void 0:i.line})})),t.commandService.executeCommand(e.XFlowEdgeCommands.FRONT_EDGE.id,{edgeId:o}))}else console.error(o,"this edgeId is not exist");return{}}))),n);return this.ctx.setResult(i),this})),this.undo=()=>lte(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>lte(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};ste([Wn(oM),ate("design:type",Object)],cte.prototype,"contextProvider",void 0),ste([f.postConstruct(),ate("design:type",Function),ate("design:paramtypes",[]),ate("design:returntype",void 0)],cte.prototype,"init",null),cte=ste([Vn({token:{token:iM,named:ote.command.id}})],cte);var ute,hte=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},dte=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},fte=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowEdgeCommands.FRONT_EDGE,t.hookKey="frontEdge"}(ute||(ute={}));let pte=class{constructor(){this.execute=()=>fte(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),r=this.ctx.getHooks(),i=yield r.frontEdge.call(t,(t=>fte(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),{edgeId:r}=t,i=null==n?void 0:n.getCellById(r);return i?(i.toFront(),this.ctx.addUndo(e.Disposable.create((()=>fte(this,void 0,void 0,(function*(){t.commandService.executeCommand(e.XFlowEdgeCommands.BACK_EDGE.id,{edgeId:r})})))))):console.error(r,"this edgeId is not exist"),{}}))),n);return this.ctx.setResult(i),this})),this.undo=()=>fte(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>fte(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};hte([Wn(oM),dte("design:type",Object)],pte.prototype,"contextProvider",void 0),hte([f.postConstruct(),dte("design:type",Function),dte("design:paramtypes",[]),dte("design:returntype",void 0)],pte.prototype,"init",null),pte=hte([Vn({token:{token:iM,named:ute.command.id}})],pte);var gte,mte=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},vte=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},yte=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowEdgeCommands.BACK_EDGE,t.hookKey="frontEdge"}(gte||(gte={}));let bte=class{constructor(){this.execute=()=>yte(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),r=this.ctx.getHooks(),i=yield r.frontEdge.call(t,(t=>yte(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),{edgeId:r}=t,i=null==n?void 0:n.getCellById(r);return i?(i.toBack(),this.ctx.addUndo(e.Disposable.create((()=>yte(this,void 0,void 0,(function*(){t.commandService.executeCommand(e.XFlowEdgeCommands.FRONT_EDGE.id,{edgeId:r})})))))):console.error(r,"this edgeId is not exist"),{}}))),n);return this.ctx.setResult(i),this})),this.undo=()=>yte(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>yte(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};mte([Wn(oM),vte("design:type",Object)],bte.prototype,"contextProvider",void 0),mte([f.postConstruct(),vte("design:type",Function),vte("design:paramtypes",[]),vte("design:returntype",void 0)],bte.prototype,"init",null),bte=mte([Vn({token:{token:iM,named:gte.command.id}})],bte);const xte=[Hee,qee,ete,ote,ute,gte];var wte,Cte=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Ete=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},_te=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGroupCommands.ADD_GROUP,t.hookKey="addGroup",t.GROUP_PADDING=12,t.GROUP_HEADER_HEIGHT=40}(wte||(wte={}));let Ste=class{constructor(){this.getBBox=(e,t,n)=>{const{groupHeaderHeight:r=wte.GROUP_HEADER_HEIGHT,groupPadding:i=wte.GROUP_PADDING}=t,o=n.getCellsBBox(e.children);return o.moveAndExpand({x:-i,y:-(i+r),width:2*i,height:2*i+r}),o},this.execute=()=>_te(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks(),o=yield i.addGroup.call(n,(n=>_te(this,void 0,void 0,(function*(){const{nodeConfig:r,createService:i,cellFactory:o,commandService:s}=n,a=yield t.getX6Graph(),l=yield s.executeCommand(e.XFlowNodeCommands.ADD_NODE.id,{cellFactory:o,createNodeService:i,nodeConfig:r}),{nodeCell:c}=l.contextProvider().getResult(),{id:u}=c,{groupChildren:h}=r;if(h.length){h.forEach((e=>{const t=a.getCellById(e);t&&(t.setData(Object.assign(Object.assign({},t.getData()),{group:u,isCollapsed:!1})),t.prop("group",u),c.addChild(t),a.unselect(t))}));const e=this.getBBox(c,r,a);c.position(e.x,e.y),c.size(e.width,e.height),c.setZIndex(0),c.prop("isGroup",!0),c.setData(Object.assign(Object.assign({},c.getData()),{width:e.width,height:e.height,groupChildrenSize:{width:e.width,height:e.height},x:e.x,y:e.y,isGroup:!0})),a.select(c)}return r.isCollapsed&&(yield s.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:r.id,isCollapsed:r.isCollapsed})),t.addUndo(e.Disposable.create((()=>_te(this,void 0,void 0,(function*(){s.executeCommand(e.XFlowGroupCommands.DEL_GROUP.id,{nodeConfig:r})}))))),{nodeConfig:r,nodeCell:c}}))),r);return t.setResult(o),this})),this.undo=()=>_te(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>_te(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};Cte([Wn(oM),Ete("design:type",Object)],Ste.prototype,"contextProvider",void 0),Ste=Cte([Vn({token:{token:iM,named:wte.command.id}})],Ste);var Ote,Ate=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},kte=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Mte=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGroupCommands.DEL_GROUP,t.hookKey="delGroup"}(Ote||(Ote={}));let Tte=class{constructor(){this.execute=()=>Mte(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks(),o=yield i.delGroup.call(n,(n=>Mte(this,void 0,void 0,(function*(){const r=yield t.getX6Graph(),{nodeConfig:i,commandService:o,deleteService:s}=n,{id:a}=i,l=r.getCellById(a);if(s){if(!(yield s(n)))return{err:"service rejected"}}if(!l)return{err:"target node is not exist"};if(!0!==l.getProp("isGroup"))return{err:"target node is not group"};const{isCollapsed:c}=l.getData();c&&(yield o.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:l.id,isCollapsed:!1,collapsedSize:{width:0,height:0}}));const u=l.getChildren();return u&&u.forEach((e=>{l.unembed(e),e.prop("group",""),e.setData(Object.assign(Object.assign({},e.getData()),{group:""}))})),yield o.executeCommand(e.XFlowNodeCommands.DEL_NODE.id,{nodeConfig:i}),t.addUndo(e.Disposable.create((()=>Mte(this,void 0,void 0,(function*(){o.executeCommand(e.XFlowGroupCommands.ADD_GROUP.id,{nodeConfig:i})}))))),{err:null}}))),r);return t.setResult(o),this})),this.undo=()=>Mte(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>Mte(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};Ate([Wn(oM),kte("design:type",Object)],Tte.prototype,"contextProvider",void 0),Tte=Ate([Vn({token:{token:iM,named:Ote.command.id}})],Tte);var Pte,Dte=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Nte=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Rte=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGroupCommands.INIT_GROUP,t.hookKey="initGroup"}(Pte||(Pte={}));let Ite=class{constructor(){this.execute=()=>Rte(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks(),o=yield i.initGroup.call(n,(n=>Rte(this,void 0,void 0,(function*(){const{graphData:r,commandService:i}=n,o=yield t.getX6Graph(),{nodes:s}=r,a={};return s.forEach((e=>{const{id:t,group:n}=e;n&&(a[n]?a[n].push(t):a[n]=[t])})),Object.keys(a).forEach((t=>Rte(this,void 0,void 0,(function*(){const r=o.getCellById(t),s=r.getData(),l=a[t]||[];r.prop("isGroup",!0),r.setData(Object.assign(Object.assign({},s),{isGroup:!0,groupChildren:l})),l.forEach((e=>{const t=o.getCellById(e);r.embed(t)})),r.toBack();const{isCollapsed:c,groupCollapsedSize:u}=s;if(c){const t=n.collapsedSize||u||J_;yield i.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{collapsedSize:t,isCollapsed:!0,nodeId:r.id})}})))),{}}))),r);return t.setResult(o),this})),this.undo=()=>Rte(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>Rte(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};Dte([Wn(oM),Nte("design:type",Object)],Ite.prototype,"contextProvider",void 0),Ite=Dte([Vn({token:{token:iM,named:Pte.command.id}})],Ite);var jte,Lte=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Fte=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Gte=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowGroupCommands.COLLAPSE_GROUP,t.hookKey="collapseGroup"}(jte||(jte={}));let Bte=class{constructor(){this.toggleVisible=(e,t,n)=>{e.forEach((e=>{n.findViewByCell(e).container.style.visibility=t?"visible":"hidden"}))},this.toggleCollapse=(e,t,n)=>{const r=e.getChildren().filter((e=>e.isNode())),i=e.getData(),{isCollapsed:o,gap:s=0}=n;if(o){const t=n.collapsedSize||i.groupCollapsedSize||J_;e.prop("previousSize",e.size()),e.size(t)}else e.size(e.prop("previousSize"));r&&r.forEach((n=>{const i=e.position(),a=t.getConnectedEdges(n).filter((e=>{const t=e.getSourceNode(),n=e.getTargetNode();return r.includes(t)&&r.includes(n)}));if(o){this.toggleVisible([n,...a],!1,t),n.prop("previousSize",n.size()),n.prop("previousRelativePosition",n.position({relative:!0})),n.position(i.x+s,i.y+s);const r=e.size();n.size({width:r.width-2*s,height:r.height-2*s})}else{this.toggleVisible([n,...a],!0,t);const e=n.prop("previousRelativePosition"),r=n.prop("previousSize");n.position(e.x,e.y,{relative:!0}),n.size(r)}})),e.prop("isCollapsed",o),e.setData(Object.assign(Object.assign({},e.getData()),{isCollapsed:o}))},this.execute=()=>Gte(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),r=this.ctx.getHooks(),i=yield r.collapseGroup.call(t,(n=>Gte(this,void 0,void 0,(function*(){const r=yield this.ctx.getX6Graph(),i=r.getCellById(t.nodeId),{toggleService:o}=n;if(o){if(!(yield o(n)))return{err:"service rejected"}}return i&&(this.toggleCollapse(i,r,t),this.ctx.addUndo(e.Disposable.create((()=>Gte(this,void 0,void 0,(function*(){i&&this.toggleCollapse(i,r,Object.assign(t,{isCollapsed:!t.isCollapsed}))})))))),{err:null}}))),n);return this.ctx.setResult(i),this})),this.undo=()=>Gte(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>Gte(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};Lte([Wn(oM),Fte("design:type",Object)],Bte.prototype,"contextProvider",void 0),Lte([f.postConstruct(),Fte("design:type",Function),Fte("design:paramtypes",[]),Fte("design:returntype",void 0)],Bte.prototype,"init",null),Bte=Lte([Vn({token:{token:iM,named:jte.command.id}})],Bte);const zte=[wte,Ote,Pte,jte];var Ute,Vte=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Hte=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Wte=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(t){t.command=e.XFlowModelCommands.UPDATE_MODEL,t.hookKey="updateModel"}(Ute||(Ute={}));let $te=class{constructor(){this.execute=()=>Wte(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks(),o=yield i.updateModel.call(n,(n=>Wte(this,void 0,void 0,(function*(){const{updateModel:r,getModel:i,modelService:o}=n,s=yield i(o),a=s.getValue(),l=Jk(a);yield r(l);const c=Qk(l);return s.setValue(c),t.addUndo(e.Disposable.create((()=>Wte(this,void 0,void 0,(function*(){s.setValue(c)}))))),{model:s,value:c}}))),r);return t.setResult(o),this})),this.undo=()=>Wte(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>Wte(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};Vte([Wn(oM),Hte("design:type",Object)],$te.prototype,"contextProvider",void 0),$te=Vte([Vn({token:{token:iM,named:Ute.command.id}})],$te);var Xte=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Yte=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},qte=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Kte=[...bD,...xte,...zte,...Vee,...[Ute]],Zte=()=>new SM;let Jte=class{constructor(){this.registerHook=t=>qte(this,void 0,void 0,(function*(){const n=t.x6Events.registerHook({name:"bind group node move event",handler:e=>qte(this,void 0,void 0,(function*(){const t={eventName:"node:moving",callback:({node:e})=>qte(this,void 0,void 0,(function*(){if(e.prop("isGroup"))return void e.prop("originPosition",e.getPosition());const t=e.model.graph,{group:n}=e.getData(),r=t.getNodes().find((e=>e.id===n));if(!r)return;const i=r.getProp("isCollapsed");let o=r.getProp("originSize"),s=!1;null==o&&(o=r.size(),r.prop("originSize",o));let a=r.prop("originPosition");null==a&&(a=r.getPosition(),r.prop("originPosition",a));let l=a.x,c=a.y,u=a.x+o.width,h=a.y+o.height;const d=r.getChildren();if(d&&d.forEach((e=>{const t=e.getBBox().inflate(12),n=t.getCorner();t.x<l&&(l=t.x,s=!0),t.y<c&&(c=t.y,s=!0),n.x>u&&(u=n.x,s=!0),n.y>h&&(h=n.y,s=!0)})),s){r.prop({position:{x:l,y:c},size:{width:u-l,height:h-c}});const e=Object.assign(Object.assign({},r.getData()),{x:l,y:c,width:u-l,height:h-c});!0!==i&&(e.groupChildrenSize={width:u-l,height:h-c}),r.setData(e)}}))};e.push(t)}))});return e.Disposable.create((()=>{n.dispose()}))})),this.registerHookHub=e=>qte(this,void 0,void 0,(function*(){const t=new V_;return Kte.forEach((({hookKey:n,createHook:r=Zte})=>{const i=e.registerHookHub(n,r());t.push(i)})),this.commandConfig.getConfig().then((({getContributions:n})=>{n().forEach((({hookKey:n,createHook:r=Zte})=>{const i=e.registerHookHub(n,r());t.push(i)}))})),t}))}registerGraphCommands(e){Kte.forEach((({command:t})=>{e.registerCommand(t,{createCommand:this.commandFactory})})),this.commandConfig.getConfig().then((({getContributions:t})=>{t().forEach((t=>{e.registerCommand(t.command,{createCommand:this.commandFactory})}))}))}};Xte([Wn(sM),Yte("design:type",Function)],Jte.prototype,"commandFactory",void 0),Xte([Wn(AP),Yte("design:type",AP)],Jte.prototype,"commandConfig",void 0),Jte=Xte([Hn({contrib:[aM,AM]})],Jte);const Qte=(e,t)=>{t.getCommandContributions().forEach((t=>{const{CommandHandler:n,command:r}=t;e({token:{token:iM,named:r.id},useClass:n})})),(e=>{e(_D),e(RD),e(MD),e(w9),e(A9),e(D9),e(aee),e(dee),e(vee),e(Cee),e(Lee),e(Uee),e(L9),e(nee),e(U9),e(Z9),e(Aee),e(Dee)})(e),(e=>{e(DP),e(LP),e(UP),e(XP),e(JP),e(rD),e(lD),e(fD),e(yD)})(e),(e=>{e(Yee),e(Qee),e(ite),e(cte),e(pte),e(bte)})(e),(e=>{e(Ste),e(Tte),e(Ite),e(Bte)})(e),(e=>{e($te)})(e),e(Jte)},ene=e=>rr((t=>{t(H9),((e,t)=>{e({token:AP,contrib:[AM],lifecycle:Sn.Lifecycle.singleton,useDynamic:()=>t})})(t,e),Qte(t,e),t(_P),t(sM,{useFactory:e=>(t,n,r)=>{const i=e.container.createChild(),o=i.get(_P);i.register(oM,{useDynamic:()=>()=>o});const s=i.getNamed(iM,t);return o.setArgs(n,r),o.handlerInstance=s,s}})})),tne=e=>{const t=ZM(),n=a.default.useMemo((()=>e.config?e.config:new AP),[]);return a.default.useEffect((()=>{t.addCoreModule({config:n,createModule:ene})}),[]),null},nne=Symbol("IToolbarService"),rne=Sn.defineToken("IToolbarContribution");var ine=WN,one=aX,sne=PW,ane=Math.max,lne=Math.min;var cne=function(e,t,n){var r,i,o,s,a,l,c=0,u=!1,h=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var n=r,o=i;return r=i=void 0,c=t,s=e.apply(o,n)}function p(e){return c=e,a=setTimeout(m,t),u?f(e):s}function g(e){var n=e-l;return void 0===l||n>=t||n<0||h&&e-c>=o}function m(){var e=one();if(g(e))return v(e);a=setTimeout(m,function(e){var n=t-(e-l);return h?lne(n,o-(e-c)):n}(e))}function v(e){return a=void 0,d&&r?f(e):(r=i=void 0,s)}function y(){var e=one(),n=g(e);if(r=arguments,i=this,l=e,n){if(void 0===a)return p(l);if(h)return clearTimeout(a),a=setTimeout(m,t),f(l)}return void 0===a&&(a=setTimeout(m,t)),s}return t=sne(t)||0,ine(n)&&(u=!!n.leading,o=(h="maxWait"in n)?ane(sne(n.maxWait)||0,t):o,d="trailing"in n?!!n.trailing:d),y.cancel=function(){void 0!==a&&clearTimeout(a),c=0,r=l=i=a=void 0},y.flush=function(){return void 0===a?s:v(one())},y},une=HN,hne=xI;var dne=function(e){return!0===e||!1===e||hne(e)&&"[object Boolean]"==une(e)},fne=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},pne=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let gne=class{constructor(){this.toDispose=new V_,this.toolbarItems=new Map,this.onDidChangeEvent=new tM(null),this.onDidChange=this.onDidChangeEvent.watch,this.fireOnDidChange=cne((()=>this.onDidChangeEvent.setValue(void 0)),16),this.registerDisposableToolbar=e=>{const t=new V_,n={registerToolbarItem:e=>{const n=this.registerItem(e);return t.push(n),n}};return e(n),this.toDispose.push(t),t},this.getToolbarModel=e=>{const{layout:t,mainGroups:n=[],extraGroups:r=[]}=e;return new tM({layout:t,mainGroups:this.createToolbarGroupModel(n),extraGroups:this.createToolbarGroupModel(r)})},this.createToolbarGroupModel=e=>{const t=e.map((e=>{const{items:t=[]}=e;return Object.assign(Object.assign({},e),{items:t.map((e=>this.createToolbarModel({id:e.id}))).filter((e=>!!e))})}));return t}}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerToolbarItems(this)}onStop(){this.toDispose.dispose()}registerItem(t){this.toolbarItems.has(t.id)&&console.warn(`ToolbarRegistry ${t.id} is duplicated, in`,t),this.toolbarItems.set(t.id,t),this.fireOnDidChange();return new V_(e.Disposable.create((()=>this.fireOnDidChange())),e.Disposable.create((()=>this.toolbarItems.delete(t.id))))}createToolbarModel(e){const t=tW(this.toolbarItems.get(e.id)),n=!dne(t.isEnabled)||t.isEnabled,r=!dne(t.isVisible)||t.isVisible;return Object.assign(Object.assign({},t),{isEnabled:n,isVisible:r,iconName:t.iconName,text:t.text})}};fne([Wn(rM),pne("design:type",Object)],gne.prototype,"commandService",void 0),fne([Wn(pM),pne("design:type",Object)],gne.prototype,"modelService",void 0),fne([or(rne),pne("design:type",Object)],gne.prototype,"contributionProvider",void 0),gne=fne([Hn({contrib:[nM,nne]})],gne);const mne=()=>rr((e=>{ir.register(e,rne),e(gne)}));var vne=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const yne=e=>{const t=ZM();return a.default.useEffect((()=>{const e=t.addCoreModule({config:{CONFIG_TYPE:"ToolbarRegistry",getConfig:()=>vne(void 0,void 0,void 0,(function*(){}))},createModule:mne});return()=>{e.dispose()}}),[t]),null};yne.defaultProps={XFlowModuleType:"ToolbarRegistry"};const bne=Symbol("IMenuService"),xne=Sn.defineToken("IMenuContribution");var wne;e.MenuItemType=void 0,(wne=e.MenuItemType||(e.MenuItemType={})).Separator="separator",wne.Submenu="submenu",wne.Root="root",wne.Leaf="leaf";var Cne=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Ene=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let _ne=class{constructor(){this.toDispose=new V_,this.menuMap=new Map,this.getMenu=e=>this.menuMap.get(e),this.registerDisposableMenu=e=>{const t=new V_,n={registerMenu:e=>{const n=this.registerMenu(e);return t.push(n),n}};return e(n),this.toDispose.push(t),t}}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerMenu(this)}onStop(){this.toDispose.dispose()}registerMenu(t){return this.menuMap.set(t.id,t),e.Disposable.create((()=>this.menuMap.delete(t.id)))}};Cne([or(xne),Ene("design:type",Object)],_ne.prototype,"contributionProvider",void 0),_ne=Cne([Hn({contrib:[nM,bne]})],_ne);const Sne=()=>rr((e=>{ir.register(e,xne),e(_ne)}));var One=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Ane=e=>{const t=ZM();return a.default.useEffect((()=>{const e=t.addCoreModule({config:{CONFIG_TYPE:"MenuRegistry",getConfig:()=>One(void 0,void 0,void 0,(function*(){}))},createModule:Sne});return()=>{e.dispose()}}),[]),null};Ane.defaultProps={XFlowModuleType:"MenuRegistry"};var kne=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Mne=t=>{const{meta:n,graphConfig:r,graphData:i,graphLayout:o,onLoad:s,isAutoCenter:l,hookConfig:c,modelServiceConfig:u,commandConfig:h,onAppConfigReady:d,onAppDestroy:f,children:p=[],className:g}=t,[m,v]=a.default.useState(),y=a.default.useMemo((()=>new qM),[]);a.default.useEffect((()=>{d&&d(y);const t=(t=>{const n=t.getAllExtensions(),r=new qn,i=n.map((e=>{const{createModule:t,config:n}=e;return t(n)}));return r.load(rP),r.load(fM),r.load(KT),i.forEach((e=>{r.load(e)})),r.get(e.IApplication)})(y);t.start().then((()=>kne(void 0,void 0,void 0,(function*(){v(t),n&&(yield t.commandService.executeCommand(e.XFlowGraphCommands.LOAD_META.id,{meta:n})),s&&s(t,y),i&&(o&&(yield t.commandService.executeCommand(e.XFlowGraphCommands.GRAPH_LAYOUT.id,Object.assign({graphData:i},o))),yield t.commandService.executeCommand(e.XFlowGraphCommands.GRAPH_RENDER.id,{graphData:i}))}))));return()=>{kne(void 0,void 0,void 0,(function*(){f&&f(t)}))}}),[]),a.default.useEffect((()=>{m&&m.commandService.executeCommand(e.XFlowGraphCommands.LOAD_META.id,{meta:n})}),[n]),a.default.useEffect((()=>{kne(void 0,void 0,void 0,(function*(){m&&(i&&o&&(yield m.commandService.executeCommand(e.XFlowGraphCommands.GRAPH_LAYOUT.id,Object.assign({graphData:i},o))),yield m.commandService.executeCommand(e.XFlowGraphCommands.GRAPH_RENDER.id,{graphData:i}),l)&&(yield m.getGraphInstance()).centerContent()}))}),[i]);const b=hr("xflow-app-workspace",g,...y.getContainerClassNames()),x=(Array.isArray(p)?p:[p]).some((e=>e&&e.props.isXFlowCanvas));return a.default.createElement(nA,{app:m},a.default.createElement(KM.Provider,{value:y},a.default.createElement("div",{className:b,id:y.getInstaceId()},!x&&a.default.createElement(xP,{config:r,position:{top:0,bottom:0,left:0,right:0}}),p,a.default.createElement(JT,{config:u}),a.default.createElement(tne,{config:h}),a.default.createElement(JM,{config:c}),a.default.createElement(yne,null),a.default.createElement(Ane,null))))};Mne.defaultProps={};var Tne=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Pne=()=>{const e=a.default.useRef(!0);return a.default.useEffect((()=>()=>{e.current=!1}),[]),e},Dne=t=>{const n=Pne(),[r,i]=a.default.useState(t.getValue());a.default.useEffect((()=>{const e=t.watch((e=>{(e=>e&&e.current)(n)&&i(e)}));return()=>{e.dispose()}}),[i]);const o=r,s=e.NsModel.isValidValue(o);return[o,a.default.useCallback((e=>t.setValue(e)),[t]),s]},Nne=e=>{const t=a.default.useMemo((()=>new tM(e)),[]),[n,r,i]=Dne(t);return a.default.useEffect((()=>()=>{t.dispose()}),[t]),[n,r,t,i]},Rne=e=>{const{getModel:t,initialState:n}=e,r=Pne(),i=a.default.useRef(),[o,s]=a.default.useState(n);return a.default.useEffect((()=>{let e;return t().then((t=>Tne(void 0,void 0,void 0,(function*(){i.current=t;const n=yield t.getValidValue();r.current&&(s(n),e=t.watch((e=>{r.current&&s(e)})))})))),()=>{e&&e.dispose&&e.dispose()}}),[]),[o,s,i.current]},Ine=Symbol("IKeyBindingService"),jne=Sn.defineToken("IKeyBindingContribution"),Lne=Symbol("IKeyBindingOptionProvider");var Fne=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Gne=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Bne=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let zne=class{constructor(){this.toDispose=new V_,this.keyBindingMap=new Map,this.enabledKeyBindingMap=new Map,this.registerExternalKeybindings=()=>Bne(this,void 0,void 0,(function*(){const{registerKeybindingFunc:e}=yield this.optionProvider.getOption();return e(this)})),this.registerKeybinding=(t=[])=>{const n=new V_;return t.forEach((t=>{this.keyBindingMap.set(t.id,t),this.enableKeyBindings(t.id).then((r=>{n.push(e.Disposable.create((()=>{r.dispose(),this.keyBindingMap.delete(t.id)})))}))})),this.toDispose.push(n),n},this.enableKeyBindings=t=>Bne(this,void 0,void 0,(function*(){this.disableKeyBindings([t]);const n=this.keyBindingMap.get(t),r=yield this.getX6Graph(),i=this.runCommand(n);r.bindKey(n.keybinding,i);const o=e.Disposable.create((()=>{r.unbindKey(n.keybinding),this.enabledKeyBindingMap.delete(n.id)}));return this.enabledKeyBindingMap.set(n.id,o),o})),this.disableKeyBindings=e=>{e.forEach((e=>{const t=this.enabledKeyBindingMap.get(e);t&&t.dispose()}))},this.runCommand=e=>t=>Bne(this,void 0,void 0,(function*(){yield e.callback(e,this.modelService,this.commandService,t)})),this.getX6Graph=()=>Bne(this,void 0,void 0,(function*(){return yield this.graphProvider.getGraphInstance()}))}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerKeybinding(this);this.registerExternalKeybindings()}onStop(){this.toDispose.dispose()}};Fne([Wn(Lne),Gne("design:type",Object)],zne.prototype,"optionProvider",void 0),Fne([Wn(rM),Gne("design:type",Object)],zne.prototype,"commandService",void 0),Fne([Wn(pM),Gne("design:type",Object)],zne.prototype,"modelService",void 0),Fne([or(jne),Gne("design:type",Object)],zne.prototype,"contributionProvider",void 0),Fne([Wn(iT),Gne("design:type",Object)],zne.prototype,"graphProvider",void 0),zne=Fne([Hn({contrib:[nM,Ine]})],zne);var Une=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Vne=e=>rr((t=>{((e,t)=>{e(Lne,{useDynamic:()=>({getOption:()=>Une(void 0,void 0,void 0,(function*(){return t.getConfig()}))}),lifecycle:Sn.Lifecycle.singleton})})(t,e),ir.register(t,jne),t(zne)}));var Hne,Wne=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.CONFIG_TYPE="CONTEXT_CONFIG"}(Hne||(Hne={}));const $ne=()=>e.Disposable.create((()=>{}));class Xne{constructor(){this.CONFIG_TYPE=Hne.CONFIG_TYPE,this.keybindingFunc=$ne,this.isMounted=new H_,this.setKeybindingFunc=e=>{this.keybindingFunc=e},this.setMountState=()=>{this.isMounted.resolve(!0)},this.getConfig=()=>Wne(this,void 0,void 0,(function*(){return yield this.isMounted.promise,{CONFIG_TYPE:this.CONFIG_TYPE,registerKeybindingFunc:this.keybindingFunc}})),this.dispose=()=>{this.keybindingFunc=$ne,this.isMounted=new H_}}}function Yne(e){return new Promise((t=>setTimeout((()=>t(!0)),e)))}const qne=new class{constructor(){this.map=new Map([["default",VO],["QuestionCircleOutlined",VO]]),this.map.set("default",VO),this.map.set("QuestionCircleOutlined",VO)}get(e){return this.map.get(e)}set(e,t){this.map.set(e,t)}has(e){return this.map.has(e)}};var Kne=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Zne=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let Jne=class{constructor(){this.toDispose=new V_,this.registerHookHub=()=>Zne(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{}))})),this.registerHook=t=>Zne(this,void 0,void 0,(function*(){const n=new V_,r=[t.graphOptions.registerHook({name:"add snapline options",handler:e=>Zne(this,void 0,void 0,(function*(){e.snapline={enabled:!0,className:"xflow-snapline",clean:5e3}}))})];return n.pushAll(r),e.Disposable.create((()=>{}))}))}};Jne=Kne([Hn({contrib:AM})],Jne);const Qne=()=>rr((e=>{e(Jne)}));var ere=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const tre="#faad14";var nre,rre,ire=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.MOUSE_ENTER="node-port:mouseenter",e.MOUSE_LEAVE="node-port:mouseleave"}(nre||(nre={})),function(e){e.id="ACTIVE_NODE_PORT",e.useModel=t=>ire(this,void 0,void 0,(function*(){const n=yield t.awaitModel(e.id);return{data:yield n.getValidValue(),model:n}}))}(rre||(rre={}));var ore=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},sre=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},are=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let lre=class{constructor(){this.toDispose=new V_,this.getGraphInstance=()=>are(this,void 0,void 0,(function*(){return{graph:yield this.graphProvider.getGraphInstance(),config:yield this.graphProvider.getGraphOptions()}})),this.getPortRenderConfig=()=>{const e={onPortRendered(e){var t,n;const r=this,{port:i,node:o}=e,{contentSelectors:s}=e,a=s&&s["xflow-port-group"];a instanceof Element&&(a.setAttribute("class",hr("xflow-port-group",{connected:i.connected&&"out"!==i.group,groupPort:(null===(t=o)||void 0===t?void 0:t.isGroup)&&(null===(n=o)||void 0===n?void 0:n.isGroup())})),a.addEventListener("mouseenter",(e=>{const t={e:e,portId:i.id,nodeId:o.id,portData:i,nodeData:o.getData(),tooltip:i.tooltip,placement:i.group};r.trigger(nre.MOUSE_ENTER,t)})),a.addEventListener("mouseleave",(e=>{const t={e:e,portId:i.id,nodeId:o.id,portData:i,nodeData:o.getData(),tooltip:i.tooltip,placement:i.group};r.trigger(nre.MOUSE_LEAVE,t)})))}};return e},this.registerHookHub=()=>are(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{}))})),this.registerHook=t=>are(this,void 0,void 0,(function*(){const n=new V_,r=[t.graphOptions.registerHook({name:"add onPortRendered options ",handler:e=>are(this,void 0,void 0,(function*(){Object.assign(e,this.getPortRenderConfig())}))})];return n.pushAll(r),e.Disposable.create((()=>{}))}))}registerModel(t){t.registerModel({id:rre.id,watchChange:t=>are(this,void 0,void 0,(function*(){const{graph:n,config:r}=yield this.getGraphInstance(),i=e=>{const{x:t,y:n,width:i,height:o}=e.target.getBoundingClientRect(),s=r.rootContainer.getBoundingClientRect();return{x:t-((null==s?void 0:s.x)||0)+i/2,y:n-((null==s?void 0:s.y)||0)+o/2}},o=e=>{t.setValue(Object.assign(Object.assign({},e),{position:i(e.e)}))},s=()=>{t.setValue(null)};return n.on(nre.MOUSE_ENTER,o),n.on(nre.MOUSE_LEAVE,s),n.on("cell:mouseleave",s),e.Disposable.create((()=>{n.off(nre.MOUSE_ENTER,o),n.off(nre.MOUSE_LEAVE,s)}))}))})}};ore([Wn(iT),sre("design:type",Object)],lre.prototype,"graphProvider",void 0),lre=ore([Hn({contrib:[AM,gM]})],lre);const cre=()=>rr((e=>{e(lre)}));var ure=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const hre=e=>{const t=eA(),[n,,r]=Nne(null);a.default.useEffect((()=>{if(!t)return;const e=ure(void 0,void 0,void 0,(function*(){const{model:e}=yield rre.useModel(t.modelService);return e.watch((e=>{r.setValue(e)}))}));return()=>{e.then((e=>{e.dispose()}))}}),[r,t]);const o=!!(n&&n.position&&n.position.x);if(!o)return null;const s=e.getTooltip?e.getTooltip(n):n.tooltip;return a.default.createElement(i.Tooltip,{visible:o,title:s,placement:n.placement||"top"},a.default.createElement("span",{className:"canvas-node-port-tooltip",style:{position:"absolute",left:n.position.x,top:n.position.y}}))};var dre,fre,pre=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.CONFIG_TYPE="ContextMenuConfig"}(dre||(dre={}));class gre{constructor(e){this.CONFIG_TYPE=dre.CONFIG_TYPE,this.setMenuModelService=e=>{this.menuModelService=e},this.setCustomMenuRender=e=>{this.menuCustomRender=e},this.getConfig=()=>pre(this,void 0,void 0,(function*(){return{CONFIG_TYPE:this.CONFIG_TYPE,menuCustomRender:this.menuCustomRender,menuModelService:this.menuModelService}})),this.moduleId=e||eS()}dispose(){}}!function(e){e.id="CONTEXT_MENU_MODEL",e.useValue=yT(e.id),e.getModel=vT(e.id)}(fre||(fre={}));var mre=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},vre=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},yre=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const{inject:bre,singleton:xre}=lr;let wre=class{constructor(){this.toDispose=new V_,this.getMenuModelValue=t=>yre(this,void 0,void 0,(function*(){const n=yield this.menuConfig.getConfig(),{anchor:r,type:i,cell:o}=t,s=new V_;this.toDispose.push(s);const a=o?o.getData():null,l=new tM({id:"menuroot",type:e.MenuItemType.Root,submenu:[]});s.push(e.Disposable.create((()=>{l.dispose()})));const c={toDispose:s,anchor:r,target:{data:a,type:i},customRender:null,menuModel:l};return n.menuCustomRender&&(c.customRender=yield n.menuCustomRender(t,this.modelService)),n.menuModelService&&(yield n.menuModelService(t,c.menuModel,this.modelService,s)),c}))}registerModel(e){const t=[e.registerModel({id:fre.id,getInitialValue:()=>null,watchChange:(e,t)=>yre(this,void 0,void 0,(function*(){return(yield PT.getModel(t)).watch((t=>yre(this,void 0,void 0,(function*(){const n=yield this.getMenuModelValue(t);e.setValue(n)}))))}))})];this.toDispose.pushAll(t)}};mre([bre(gre),vre("design:type",gre)],wre.prototype,"menuConfig",void 0),mre([bre(pM),vre("design:type",Object)],wre.prototype,"modelService",void 0),wre=mre([xre({contrib:[gM]})],wre);const Cre=e=>rr((t=>{t(wre),t(gre,{useValue:e})})),Ere=a.default.createContext({});class _re extends a.default.PureComponent{constructor(){super(...arguments),this.onHotkey=()=>{this.triggerHandler()},this.onClick=e=>{this.triggerHandler(e)}}componentDidMount(){const{hotkey:e}=this.props;e&&this.props.context.registerHotkey(e,this.onHotkey)}componentWillUnmount(){const{hotkey:e}=this.props;e&&this.props.context.unregisterHotkey(e,this.onHotkey)}triggerHandler(e){this.props.disabled||this.props.hidden||(this.props.name&&this.props.context.onClick(this.props.name,e),this.props.onClick&&this.props.onClick())}render(){return a.default.createElement("div",Object.assign({},_re.getProps(this.props)),_re.getContent(this.props,this.onClick))}}!function(e){e.getProps=function(e,t){const{className:n,disabled:r,active:i,hidden:o}=e,{prefixCls:s}=e.context,a=`${s}-item`;return{className:hr(a,t,{[`${a}-active`]:i,[`${a}-hidden`]:o,[`${a}-disabled`]:r},n)}},e.getContent=function(e,t,n,r){const{icon:i,text:o,hotkey:s,children:l}=e,{prefixCls:c}=e.context,u=`${c}-item`;return a.default.createElement(a.default.Fragment,null,a.default.createElement("button",{type:"button",className:`${u}-button`,onClick:t},i&&a.default.isValidElement(i)&&a.default.createElement("span",{className:`${u}-icon`},i),a.default.createElement("span",{className:`${u}-text`},o||l),s&&a.default.createElement("span",{className:`${u}-hotkey`},s),n),r)}}(_re||(_re={}));const Sre=e=>a.default.createElement(Ere.Consumer,null,(t=>a.default.createElement(_re,Object.assign({context:t},e)))),Ore=()=>a.default.createElement(Ere.Consumer,null,(({prefixCls:e})=>a.default.createElement("div",{className:`${e}-item ${e}-item-divider`})));var Are=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const kre=e=>{const{hotkey:t,children:n}=e,r=Are(e,["hotkey","children"]);return a.default.createElement(Ere.Consumer,null,(t=>{const{prefixCls:i}=t,o=_re.getProps(Object.assign({context:t},e),`${i}-submenu`);return a.default.createElement("div",Object.assign({},o),_re.getContent(Object.assign({context:t},r),null,a.default.createElement("span",{className:`${i}-submenu-arrow`}),a.default.createElement("div",{className:`${i}-submenu-menu`},n)))}))};class Mre extends a.default.PureComponent{constructor(){super(...arguments),this.onClick=(e,t)=>{this.props.stopPropagation&&null!=t&&t.stopPropagation(),this.props.onClick&&this.props.onClick(e)},this.registerHotkey=(e,t)=>{this.props.registerHotkey&&this.props.registerHotkey(e,t)},this.unregisterHotkey=(e,t)=>{this.props.unregisterHotkey&&this.props.unregisterHotkey(e,t)}}render(){const{prefixCls:e,className:t,children:n,hasIcon:r}=this.props,i=`${e}-menu`,o=Ere.Provider,s={prefixCls:i,onClick:this.onClick,registerHotkey:this.registerHotkey,unregisterHotkey:this.unregisterHotkey};return a.default.createElement("div",{className:hr(i,{[`${i}-has-icon`]:r},t)},a.default.createElement(o,{value:s},n))}}!function(e){e.Item=Sre,e.Divider=Ore,e.SubMenu=kre,e.defaultProps={prefixCls:"x6",stopPropagation:!1}}(Mre||(Mre={}));
/*
	object-assign
	(c) Sindre Sorhus
	@license MIT
	*/
Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function Tre(){return Tre=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Tre.apply(this,arguments)}function Pre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dre(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nre(e,t,n){return t&&Dre(e.prototype,t),n&&Dre(e,n),e}function Rre(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ire(e,t){return Ire=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ire(e,t)}function jre(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ire(e,t)}function Lre(e){return Lre=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lre(e)}function Fre(e,t){if(t&&("object"===dJ(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Rre(e)}function Gre(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lre(e);if(t){var i=Lre(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Fre(this,n)}}!function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map((function(e){return t[e]}));if("0123456789"!==r.join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()||Object.assign;var Bre=function(e){return+setTimeout(e,16)},zre=function(e){return clearTimeout(e)};"undefined"!=typeof window&&"requestAnimationFrame"in window&&(Bre=function(e){return window.requestAnimationFrame(e)},zre=function(e){return window.cancelAnimationFrame(e)});var Ure=0,Vre=new Map;function Hre(e){Vre.delete(e)}function Wre(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Ure+=1;function r(t){if(0===t)Hre(n),e();else{var i=Bre((function(){r(t-1)}));Vre.set(n,i)}}return r(t),n}function $re(e,t){return!!e&&e.contains(t)}function Xre(e){return e instanceof HTMLElement?e:c.default.findDOMNode(e)}Wre.cancel=function(e){var t=Vre.get(e);return Hre(t),zre(t)};var Yre={exports:{}},qre={},Kre="function"==typeof Symbol&&Symbol.for,Zre=Kre?Symbol.for("react.element"):60103,Jre=Kre?Symbol.for("react.portal"):60106,Qre=Kre?Symbol.for("react.fragment"):60107,eie=Kre?Symbol.for("react.strict_mode"):60108,tie=Kre?Symbol.for("react.profiler"):60114,nie=Kre?Symbol.for("react.provider"):60109,rie=Kre?Symbol.for("react.context"):60110,iie=Kre?Symbol.for("react.async_mode"):60111,oie=Kre?Symbol.for("react.concurrent_mode"):60111,sie=Kre?Symbol.for("react.forward_ref"):60112,aie=Kre?Symbol.for("react.suspense"):60113,lie=Kre?Symbol.for("react.suspense_list"):60120,cie=Kre?Symbol.for("react.memo"):60115,uie=Kre?Symbol.for("react.lazy"):60116,hie=Kre?Symbol.for("react.block"):60121,die=Kre?Symbol.for("react.fundamental"):60117,fie=Kre?Symbol.for("react.responder"):60118,pie=Kre?Symbol.for("react.scope"):60119;function gie(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case Zre:switch(e=e.type){case iie:case oie:case Qre:case tie:case eie:case aie:return e;default:switch(e=e&&e.$$typeof){case rie:case sie:case uie:case cie:case nie:return e;default:return t}}case Jre:return t}}}function mie(e){return gie(e)===oie}function vie(e,t){"function"==typeof e?e(t):"object"===lS(e)&&e&&"current"in e&&(e.current=t)}function yie(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach((function(t){vie(t,e)}))}}function bie(e,t,n,r){var i=c.default.unstable_batchedUpdates?function(e){c.default.unstable_batchedUpdates(n,e)}:n;return e.addEventListener&&e.addEventListener(t,i,r),{remove:function(){e.removeEventListener&&e.removeEventListener(t,i)}}}qre.AsyncMode=iie,qre.ConcurrentMode=oie,qre.ContextConsumer=rie,qre.ContextProvider=nie,qre.Element=Zre,qre.ForwardRef=sie,qre.Fragment=Qre,qre.Lazy=uie,qre.Memo=cie,qre.Portal=Jre,qre.Profiler=tie,qre.StrictMode=eie,qre.Suspense=aie,qre.isAsyncMode=function(e){return mie(e)||gie(e)===iie},qre.isConcurrentMode=mie,qre.isContextConsumer=function(e){return gie(e)===rie},qre.isContextProvider=function(e){return gie(e)===nie},qre.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===Zre},qre.isForwardRef=function(e){return gie(e)===sie},qre.isFragment=function(e){return gie(e)===Qre},qre.isLazy=function(e){return gie(e)===uie},qre.isMemo=function(e){return gie(e)===cie},qre.isPortal=function(e){return gie(e)===Jre},qre.isProfiler=function(e){return gie(e)===tie},qre.isStrictMode=function(e){return gie(e)===eie},qre.isSuspense=function(e){return gie(e)===aie},qre.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===Qre||e===oie||e===tie||e===eie||e===aie||e===lie||"object"==typeof e&&null!==e&&(e.$$typeof===uie||e.$$typeof===cie||e.$$typeof===nie||e.$$typeof===rie||e.$$typeof===sie||e.$$typeof===die||e.$$typeof===fie||e.$$typeof===pie||e.$$typeof===hie)},qre.typeOf=gie,Yre.exports=qre;var xie=t.forwardRef((function(e,n){var r=e.didUpdate,i=e.getContainer,o=e.children,s=t.useRef();t.useImperativeHandle(n,(function(){return{}}));var a=t.useRef(!1);return!a.current&&jS()&&(s.current=i(),a.current=!0),t.useEffect((function(){null==r||r(e)})),t.useEffect((function(){return function(){var e,t;null===(e=s.current)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(s.current)}}),[]),s.current?c.default.createPortal(o,s.current):null}));function wie(e,t,n){return n?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}function Cie(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit".concat(e)]="webkit".concat(t),n["Moz".concat(e)]="moz".concat(t),n["ms".concat(e)]="MS".concat(t),n["O".concat(e)]="o".concat(t.toLowerCase()),n}var Eie,_ie,Sie,Oie=(Eie=jS(),_ie="undefined"!=typeof window?window:{},Sie={animationend:Cie("Animation","AnimationEnd"),transitionend:Cie("Transition","TransitionEnd")},Eie&&("AnimationEvent"in _ie||delete Sie.animationend.animation,"TransitionEvent"in _ie||delete Sie.transitionend.transition),Sie),Aie={};if(jS()){var kie=document.createElement("div");Aie=kie.style}var Mie={};function Tie(e){if(Mie[e])return Mie[e];var t=Oie[e];if(t)for(var n=Object.keys(t),r=n.length,i=0;i<r;i+=1){var o=n[i];if(Object.prototype.hasOwnProperty.call(t,o)&&o in Aie)return Mie[e]=t[o],Mie[e]}return""}var Pie=Tie("animationend"),Die=Tie("transitionend"),Nie=!(!Pie||!Die),Rie=Pie||"animationend",Iie=Die||"transitionend";function jie(e,t){return e?"object"===lS(e)?e[t.replace(/-\w/g,(function(e){return e[1].toUpperCase()}))]:"".concat(e,"-").concat(t):null}var Lie="none",Fie="appear",Gie="enter",Bie="leave",zie="none",Uie="prepare",Vie="start",Hie="active",Wie="end";function $ie(e){var n=t.useRef(!1),r=sS(t.useState(e),2),i=r[0],o=r[1];return t.useEffect((function(){return function(){n.current=!0}}),[]),[i,function(e){n.current||o(e)}]}var Xie=jS()?t.useLayoutEffect:t.useEffect,Yie=[Uie,Vie,Hie,Wie];function qie(e){return e===Hie||e===Wie}var Kie=function(e,t){var n=sS(l.useState(zie),2),r=n[0],i=n[1],o=function(){var e=l.useRef(null);function t(){Wre.cancel(e.current)}return l.useEffect((function(){return function(){t()}}),[]),[function n(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;t();var o=Wre((function(){i<=1?r({isCanceled:function(){return o!==e.current}}):n(r,i-1)}));e.current=o},t]}(),s=sS(o,2),a=s[0],c=s[1];return Xie((function(){if(r!==zie&&r!==Wie){var e=Yie.indexOf(r),n=Yie[e+1],o=t(r);false===o?i(n):a((function(e){function t(){e.isCanceled()||i(n)}!0===o?t():Promise.resolve(o).then(t)}))}}),[e,r]),l.useEffect((function(){return function(){c()}}),[]),[function(){i(Uie)},r]};function Zie(e,n,r,i){var o=i.motionEnter,s=void 0===o||o,a=i.motionAppear,c=void 0===a||a,u=i.motionLeave,h=void 0===u||u,d=i.motionDeadline,f=i.motionLeaveImmediately,p=i.onAppearPrepare,g=i.onEnterPrepare,m=i.onLeavePrepare,v=i.onAppearStart,y=i.onEnterStart,b=i.onLeaveStart,x=i.onAppearActive,w=i.onEnterActive,C=i.onLeaveActive,E=i.onAppearEnd,_=i.onEnterEnd,S=i.onLeaveEnd,O=i.onVisibleChanged,A=sS($ie(),2),k=A[0],M=A[1],T=sS($ie(Lie),2),P=T[0],D=T[1],N=sS($ie(null),2),R=N[0],I=N[1],j=t.useRef(!1),L=t.useRef(null),F=t.useRef(!1),G=t.useRef(null);function B(){return r()||G.current}var z=t.useRef(!1);function U(e){var t,n=B();e&&!e.deadline&&e.target!==n||(P===Fie&&z.current?t=null==E?void 0:E(n,e):P===Gie&&z.current?t=null==_?void 0:_(n,e):P===Bie&&z.current&&(t=null==S?void 0:S(n,e)),!1===t||F.current||(D(Lie),I(null)))}var V=function(e){var n=t.useRef(),r=t.useRef(e);r.current=e;var i=l.useCallback((function(e){r.current(e)}),[]);function o(e){e&&(e.removeEventListener(Iie,i),e.removeEventListener(Rie,i))}return l.useEffect((function(){return function(){o(n.current)}}),[]),[function(e){n.current&&n.current!==e&&o(n.current),e&&e!==n.current&&(e.addEventListener(Iie,i),e.addEventListener(Rie,i),n.current=e)},o]}(U),H=sS(V,1)[0],W=l.useMemo((function(){var e,t,n;switch(P){case"appear":return nS(e={},Uie,p),nS(e,Vie,v),nS(e,Hie,x),e;case"enter":return nS(t={},Uie,g),nS(t,Vie,y),nS(t,Hie,w),t;case"leave":return nS(n={},Uie,m),nS(n,Vie,b),nS(n,Hie,C),n;default:return{}}}),[P]),$=sS(Kie(P,(function(e){if(e===Uie){var t=W.prepare;return!!t&&t(B())}var n;Y in W&&I((null===(n=W[Y])||void 0===n?void 0:n.call(W,B(),null))||null);return Y===Hie&&(H(B()),d>0&&(clearTimeout(L.current),L.current=setTimeout((function(){U({deadline:!0})}),d))),true})),2),X=$[0],Y=$[1],q=qie(Y);z.current=q,Xie((function(){M(n);var t,r=j.current;(j.current=!0,e)&&(!r&&n&&c&&(t=Fie),r&&n&&s&&(t=Gie),(r&&!n&&h||!r&&f&&!n&&h)&&(t=Bie),t&&(D(t),X()))}),[n]),t.useEffect((function(){(P===Fie&&!c||P===Gie&&!s||P===Bie&&!h)&&D(Lie)}),[c,s,h]),t.useEffect((function(){return function(){clearTimeout(L.current),F.current=!0}}),[]),t.useEffect((function(){void 0!==k&&P===Lie&&(null==O||O(k))}),[k,P]);var K=R;return W.prepare&&Y===Vie&&(K=iS({transition:"none"},K)),[P,Y,K,null!=k?k:n]}var Jie=function(e){jre(n,e);var t=Gre(n);function n(){return Pre(this,n),t.apply(this,arguments)}return Nre(n,[{key:"render",value:function(){return this.props.children}}]),n}(l.Component);var Qie=function(e){var n=e;function r(e){return!(!e.motionName||!n)}"object"===lS(e)&&(n=e.transitionSupport);var i=l.forwardRef((function(e,n){var i=e.visible,o=void 0===i||i,s=e.removeOnLeave,a=void 0===s||s,c=e.forceRender,u=e.children,h=e.motionName,d=e.leavedClassName,f=e.eventProps,p=r(e),g=t.useRef(),m=t.useRef();var v=sS(Zie(p,o,(function(){try{return Xre(g.current||m.current)}catch(e){return null}}),e),4),y=v[0],b=v[1],x=v[2],w=v[3],C=l.useRef(w);w&&(C.current=!0);var E=t.useRef(n);E.current=n;var _,S=l.useCallback((function(e){g.current=e,vie(E.current,e)}),[]),O=iS(iS({},f),{},{visible:o});if(u)if(y!==Lie&&r(e)){var A,k;b===Uie?k="prepare":qie(b)?k="active":b===Vie&&(k="start"),_=u(iS(iS({},O),{},{className:hr(jie(h,y),(A={},nS(A,jie(h,"".concat(y,"-").concat(k)),k),nS(A,h,"string"==typeof h),A)),style:x}),S)}else _=w?u(iS({},O),S):!a&&C.current?u(iS(iS({},O),{},{className:d}),S):c?u(iS(iS({},O),{},{style:{display:"none"}}),S):null;else _=null;return l.createElement(Jie,{ref:m},_)}));return i.displayName="CSSMotion",i}(Nie);function eoe(e){var t=e.prefixCls,n=e.motion,r=e.animation,i=e.transitionName;return n||(r?{motionName:"".concat(t,"-").concat(r)}:i?{motionName:i}:null)}function toe(e){var t=e.prefixCls,n=e.visible,r=e.zIndex,i=e.mask,o=e.maskMotion,s=e.maskAnimation,a=e.maskTransitionName;if(!i)return null;var c={};return(o||a||s)&&(c=iS({motionAppear:!0},eoe({motion:o,prefixCls:t,transitionName:a,animation:s}))),l.createElement(Qie,Tre({},c,{visible:n,removeOnLeave:!0}),(function(e){var n=e.className;return l.createElement("div",{style:{zIndex:r},className:hr("".concat(t,"-mask"),n)})}))}var noe;function roe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ioe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?roe(Object(n),!0).forEach((function(t){soe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):roe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ooe(e){return ooe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ooe(e)}function soe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var aoe={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-",O:"-o-"};function loe(){if(void 0!==noe)return noe;noe="";var e=document.createElement("p").style;for(var t in aoe)t+"Transform"in e&&(noe=t);return noe}function coe(){return loe()?"".concat(loe(),"TransitionProperty"):"transitionProperty"}function uoe(){return loe()?"".concat(loe(),"Transform"):"transform"}function hoe(e,t){var n=coe();n&&(e.style[n]=t,"transitionProperty"!==n&&(e.style.transitionProperty=t))}function doe(e,t){var n=uoe();n&&(e.style[n]=t,"transform"!==n&&(e.style.transform=t))}var foe,poe=/matrix\((.*)\)/,goe=/matrix3d\((.*)\)/;function moe(e){var t=e.style.display;e.style.display="none",e.offsetHeight,e.style.display=t}function voe(e,t,n){var r=n;if("object"!==ooe(t))return void 0!==r?("number"==typeof r&&(r="".concat(r,"px")),void(e.style[t]=r)):foe(e,t);for(var i in t)t.hasOwnProperty(i)&&voe(e,i,t[i])}function yoe(e,t){var n=e["page".concat(t?"Y":"X","Offset")],r="scroll".concat(t?"Top":"Left");if("number"!=typeof n){var i=e.document;"number"!=typeof(n=i.documentElement[r])&&(n=i.body[r])}return n}function boe(e){return yoe(e)}function xoe(e){return yoe(e,!0)}function woe(e){var t=function(e){var t,n,r,i=e.ownerDocument,o=i.body,s=i&&i.documentElement;return n=(t=e.getBoundingClientRect()).left,r=t.top,{left:n-=s.clientLeft||o.clientLeft||0,top:r-=s.clientTop||o.clientTop||0}}(e),n=e.ownerDocument,r=n.defaultView||n.parentWindow;return t.left+=boe(r),t.top+=xoe(r),t}function Coe(e){return null!=e&&e==e.window}function Eoe(e){return Coe(e)?e.document:9===e.nodeType?e:e.ownerDocument}var _oe=new RegExp("^(".concat(/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,")(?!px)[a-z%]+$"),"i"),Soe=/^(top|right|bottom|left)$/;function Ooe(e,t){return"left"===e?t.useCssRight?"right":e:t.useCssBottom?"bottom":e}function Aoe(e){return"left"===e?"right":"right"===e?"left":"top"===e?"bottom":"bottom"===e?"top":void 0}function koe(e,t,n){"static"===voe(e,"position")&&(e.style.position="relative");var r=-999,i=-999,o=Ooe("left",n),s=Ooe("top",n),a=Aoe(o),l=Aoe(s);"left"!==o&&(r=999),"top"!==s&&(i=999);var c,u="",h=woe(e);("left"in t||"top"in t)&&(u=(c=e).style.transitionProperty||c.style[coe()]||"",hoe(e,"none")),"left"in t&&(e.style[a]="",e.style[o]="".concat(r,"px")),"top"in t&&(e.style[l]="",e.style[s]="".concat(i,"px")),moe(e);var d=woe(e),f={};for(var p in t)if(t.hasOwnProperty(p)){var g=Ooe(p,n),m="left"===p?r:i,v=h[p]-d[p];f[g]=g===p?m+v:m-v}voe(e,f),moe(e),("left"in t||"top"in t)&&hoe(e,u);var y={};for(var b in t)if(t.hasOwnProperty(b)){var x=Ooe(b,n),w=t[b]-h[b];y[x]=b===x?f[x]+w:f[x]-w}voe(e,y)}function Moe(e,t){var n=woe(e),r=function(e){var t=window.getComputedStyle(e,null),n=t.getPropertyValue("transform")||t.getPropertyValue(uoe());if(n&&"none"!==n){var r=n.replace(/[^0-9\-.,]/g,"").split(",");return{x:parseFloat(r[12]||r[4],0),y:parseFloat(r[13]||r[5],0)}}return{x:0,y:0}}(e),i={x:r.x,y:r.y};"left"in t&&(i.x=r.x+t.left-n.left),"top"in t&&(i.y=r.y+t.top-n.top),function(e,t){var n=window.getComputedStyle(e,null),r=n.getPropertyValue("transform")||n.getPropertyValue(uoe());if(r&&"none"!==r){var i,o=r.match(poe);o?((i=(o=o[1]).split(",").map((function(e){return parseFloat(e,10)})))[4]=t.x,i[5]=t.y,doe(e,"matrix(".concat(i.join(","),")"))):((i=r.match(goe)[1].split(",").map((function(e){return parseFloat(e,10)})))[12]=t.x,i[13]=t.y,doe(e,"matrix3d(".concat(i.join(","),")")))}else doe(e,"translateX(".concat(t.x,"px) translateY(").concat(t.y,"px) translateZ(0)"))}(e,i)}function Toe(e,t){for(var n=0;n<e.length;n++)t(e[n])}function Poe(e){return"border-box"===foe(e,"boxSizing")}"undefined"!=typeof window&&(foe=window.getComputedStyle?function(e,t,n){var r=n,i="",o=Eoe(e);return(r=r||o.defaultView.getComputedStyle(e,null))&&(i=r.getPropertyValue(t)||r[t]),i}:function(e,t){var n=e.currentStyle&&e.currentStyle[t];if(_oe.test(n)&&!Soe.test(t)){var r=e.style,i=r.left,o=e.runtimeStyle.left;e.runtimeStyle.left=e.currentStyle.left,r.left="fontSize"===t?"1em":n||0,n=r.pixelLeft+"px",r.left=i,e.runtimeStyle.left=o}return""===n?"auto":n});var Doe=["margin","border","padding"];function Noe(e,t,n){var r,i={},o=e.style;for(r in t)t.hasOwnProperty(r)&&(i[r]=o[r],o[r]=t[r]);for(r in n.call(e),t)t.hasOwnProperty(r)&&(o[r]=i[r])}function Roe(e,t,n){var r,i,o,s=0;for(i=0;i<t.length;i++)if(r=t[i])for(o=0;o<n.length;o++){var a=void 0;a="border"===r?"".concat(r).concat(n[o],"Width"):r+n[o],s+=parseFloat(foe(e,a))||0}return s}var Ioe={getParent:function(e){var t=e;do{t=11===t.nodeType&&t.host?t.host:t.parentNode}while(t&&1!==t.nodeType&&9!==t.nodeType);return t}};function joe(e,t,n){var r=n;if(Coe(e))return"width"===t?Ioe.viewportWidth(e):Ioe.viewportHeight(e);if(9===e.nodeType)return"width"===t?Ioe.docWidth(e):Ioe.docHeight(e);var i="width"===t?["Left","Right"]:["Top","Bottom"],o="width"===t?e.getBoundingClientRect().width:e.getBoundingClientRect().height,s=Poe(e),a=0;(null==o||o<=0)&&(o=void 0,(null==(a=foe(e,t))||Number(a)<0)&&(a=e.style[t]||0),a=parseFloat(a)||0),void 0===r&&(r=s?1:-1);var l=void 0!==o||s,c=o||a;return-1===r?l?c-Roe(e,["border","padding"],i):a:l?1===r?c:c+(2===r?-Roe(e,["border"],i):Roe(e,["margin"],i)):a+Roe(e,Doe.slice(r),i)}Toe(["Width","Height"],(function(e){Ioe["doc".concat(e)]=function(t){var n=t.document;return Math.max(n.documentElement["scroll".concat(e)],n.body["scroll".concat(e)],Ioe["viewport".concat(e)](n))},Ioe["viewport".concat(e)]=function(t){var n="client".concat(e),r=t.document,i=r.body,o=r.documentElement[n];return"CSS1Compat"===r.compatMode&&o||i&&i[n]||o}}));var Loe={position:"absolute",visibility:"hidden",display:"block"};function Foe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=t[0];return 0!==i.offsetWidth?r=joe.apply(void 0,t):Noe(i,Loe,(function(){r=joe.apply(void 0,t)})),r}function Goe(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}Toe(["width","height"],(function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);Ioe["outer".concat(t)]=function(t,n){return t&&Foe(t,e,n?0:1)};var n="width"===e?["Left","Right"]:["Top","Bottom"];Ioe[e]=function(t,r){var i=r;return void 0!==i?t?(Poe(t)&&(i+=Roe(t,["padding","border"],n)),voe(t,e,i)):void 0:t&&Foe(t,e,-1)}}));var Boe={getWindow:function(e){if(e&&e.document&&e.setTimeout)return e;var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getDocument:Eoe,offset:function(e,t,n){if(void 0===t)return woe(e);!function(e,t,n){if(n.ignoreShake){var r=woe(e),i=r.left.toFixed(0),o=r.top.toFixed(0),s=t.left.toFixed(0),a=t.top.toFixed(0);if(i===s&&o===a)return}n.useCssRight||n.useCssBottom?koe(e,t,n):n.useCssTransform&&uoe()in document.body.style?Moe(e,t):koe(e,t,n)}(e,t,n||{})},isWindow:Coe,each:Toe,css:voe,clone:function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);if(e.overflow)for(t in e)e.hasOwnProperty(t)&&(n.overflow[t]=e.overflow[t]);return n},mix:Goe,getWindowScrollLeft:function(e){return boe(e)},getWindowScrollTop:function(e){return xoe(e)},merge:function(){for(var e={},t=0;t<arguments.length;t++)Boe.mix(e,t<0||arguments.length<=t?void 0:arguments[t]);return e},viewportWidth:0,viewportHeight:0};Goe(Boe,Ioe);var zoe=Boe.getParent;function Uoe(e){if(Boe.isWindow(e)||9===e.nodeType)return null;var t,n=Boe.getDocument(e).body,r=Boe.css(e,"position");if(!("fixed"===r||"absolute"===r))return"html"===e.nodeName.toLowerCase()?null:zoe(e);for(t=zoe(e);t&&t!==n&&9!==t.nodeType;t=zoe(t))if("static"!==(r=Boe.css(t,"position")))return t;return null}var Voe=Boe.getParent;function Hoe(e,t){for(var n={left:0,right:1/0,top:0,bottom:1/0},r=Uoe(e),i=Boe.getDocument(e),o=i.defaultView||i.parentWindow,s=i.body,a=i.documentElement;r;){if(-1!==navigator.userAgent.indexOf("MSIE")&&0===r.clientWidth||r===s||r===a||"visible"===Boe.css(r,"overflow")){if(r===s||r===a)break}else{var l=Boe.offset(r);l.left+=r.clientLeft,l.top+=r.clientTop,n.top=Math.max(n.top,l.top),n.right=Math.min(n.right,l.left+r.clientWidth),n.bottom=Math.min(n.bottom,l.top+r.clientHeight),n.left=Math.max(n.left,l.left)}r=Uoe(r)}var c=null;Boe.isWindow(e)||9===e.nodeType||(c=e.style.position,"absolute"===Boe.css(e,"position")&&(e.style.position="fixed"));var u=Boe.getWindowScrollLeft(o),h=Boe.getWindowScrollTop(o),d=Boe.viewportWidth(o),f=Boe.viewportHeight(o),p=a.scrollWidth,g=a.scrollHeight,m=window.getComputedStyle(s);if("hidden"===m.overflowX&&(p=o.innerWidth),"hidden"===m.overflowY&&(g=o.innerHeight),e.style&&(e.style.position=c),t||function(e){if(Boe.isWindow(e)||9===e.nodeType)return!1;var t=Boe.getDocument(e),n=t.body,r=null;for(r=Voe(e);r&&r!==n&&r!==t;r=Voe(r))if("fixed"===Boe.css(r,"position"))return!0;return!1}(e))n.left=Math.max(n.left,u),n.top=Math.max(n.top,h),n.right=Math.min(n.right,u+d),n.bottom=Math.min(n.bottom,h+f);else{var v=Math.max(p,u+d);n.right=Math.min(n.right,v);var y=Math.max(g,h+f);n.bottom=Math.min(n.bottom,y)}return n.top>=0&&n.left>=0&&n.bottom>n.top&&n.right>n.left?n:null}function Woe(e){var t,n,r;if(Boe.isWindow(e)||9===e.nodeType){var i=Boe.getWindow(e);t={left:Boe.getWindowScrollLeft(i),top:Boe.getWindowScrollTop(i)},n=Boe.viewportWidth(i),r=Boe.viewportHeight(i)}else t=Boe.offset(e),n=Boe.outerWidth(e),r=Boe.outerHeight(e);return t.width=n,t.height=r,t}function $oe(e,t){var n=t.charAt(0),r=t.charAt(1),i=e.width,o=e.height,s=e.left,a=e.top;return"c"===n?a+=o/2:"b"===n&&(a+=o),"c"===r?s+=i/2:"r"===r&&(s+=i),{left:s,top:a}}function Xoe(e,t,n,r,i){var o=$oe(t,n[1]),s=$oe(e,n[0]),a=[s.left-o.left,s.top-o.top];return{left:Math.round(e.left-a[0]+r[0]-i[0]),top:Math.round(e.top-a[1]+r[1]-i[1])}}function Yoe(e,t,n){return e.left<n.left||e.left+t.width>n.right}function qoe(e,t,n){return e.top<n.top||e.top+t.height>n.bottom}function Koe(e,t,n){var r=[];return Boe.each(e,(function(e){r.push(e.replace(t,(function(e){return n[e]})))})),r}function Zoe(e,t){return e[t]=-e[t],e}function Joe(e,t){return(/%$/.test(e)?parseInt(e.substring(0,e.length-1),10)/100*t:parseInt(e,10))||0}function Qoe(e,t){e[0]=Joe(e[0],t.width),e[1]=Joe(e[1],t.height)}function ese(e,t,n,r){var i=n.points,o=n.offset||[0,0],s=n.targetOffset||[0,0],a=n.overflow,l=n.source||e;o=[].concat(o),s=[].concat(s);var c={},u=0,h=Hoe(l,!(!(a=a||{})||!a.alwaysByViewport)),d=Woe(l);Qoe(o,d),Qoe(s,t);var f=Xoe(d,t,i,o,s),p=Boe.merge(d,f);if(h&&(a.adjustX||a.adjustY)&&r){if(a.adjustX&&Yoe(f,d,h)){var g=Koe(i,/[lr]/gi,{l:"r",r:"l"}),m=Zoe(o,0),v=Zoe(s,0);(function(e,t,n){return e.left>n.right||e.left+t.width<n.left})(Xoe(d,t,g,m,v),d,h)||(u=1,i=g,o=m,s=v)}if(a.adjustY&&qoe(f,d,h)){var y=Koe(i,/[tb]/gi,{t:"b",b:"t"}),b=Zoe(o,1),x=Zoe(s,1);(function(e,t,n){return e.top>n.bottom||e.top+t.height<n.top})(Xoe(d,t,y,b,x),d,h)||(u=1,i=y,o=b,s=x)}u&&(f=Xoe(d,t,i,o,s),Boe.mix(p,f));var w=Yoe(f,d,h),C=qoe(f,d,h);if(w||C){var E=i;w&&(E=Koe(i,/[lr]/gi,{l:"r",r:"l"})),C&&(E=Koe(i,/[tb]/gi,{t:"b",b:"t"})),i=E,o=n.offset||[0,0],s=n.targetOffset||[0,0]}c.adjustX=a.adjustX&&w,c.adjustY=a.adjustY&&C,(c.adjustX||c.adjustY)&&(p=function(e,t,n,r){var i=Boe.clone(e),o={width:t.width,height:t.height};return r.adjustX&&i.left<n.left&&(i.left=n.left),r.resizeWidth&&i.left>=n.left&&i.left+o.width>n.right&&(o.width-=i.left+o.width-n.right),r.adjustX&&i.left+o.width>n.right&&(i.left=Math.max(n.right-o.width,n.left)),r.adjustY&&i.top<n.top&&(i.top=n.top),r.resizeHeight&&i.top>=n.top&&i.top+o.height>n.bottom&&(o.height-=i.top+o.height-n.bottom),r.adjustY&&i.top+o.height>n.bottom&&(i.top=Math.max(n.bottom-o.height,n.top)),Boe.mix(i,o)}(f,d,h,c))}return p.width!==d.width&&Boe.css(l,"width",Boe.width(l)+p.width-d.width),p.height!==d.height&&Boe.css(l,"height",Boe.height(l)+p.height-d.height),Boe.offset(l,{left:p.left,top:p.top},{useCssRight:n.useCssRight,useCssBottom:n.useCssBottom,useCssTransform:n.useCssTransform,ignoreShake:n.ignoreShake}),{points:i,offset:o,targetOffset:s,overflow:c}}function tse(e,t,n){var r=n.target||t,i=Woe(r),o=!function(e,t){var n=Hoe(e,t),r=Woe(e);return!n||r.left+r.width<=n.left||r.top+r.height<=n.top||r.left>=n.right||r.top>=n.bottom}(r,n.overflow&&n.overflow.alwaysByViewport);return ese(e,i,n,o)}tse.__getOffsetParent=Uoe,tse.__getVisibleRectForElement=Hoe;var nse=nB;var rse=function(e,t){return nse(e,t)},ise=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,r){return e[0]===t&&(n=r,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var i=r[n];e.call(t,i[1],i[0])}},t}()}(),ose="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,sse="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),ase="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(sse):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var lse=["top","right","bottom","left","width","height","size","weight"],cse="undefined"!=typeof MutationObserver,use=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,r=!1,i=0;function o(){n&&(n=!1,e()),r&&a()}function s(){ase(o)}function a(){var e=Date.now();if(n){if(e-i<2)return;r=!0}else n=!0,r=!1,setTimeout(s,t);i=e}return a}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){ose&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),cse?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){ose&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;lse.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),hse=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},dse=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||sse},fse=bse(0,0,0,0);function pse(e){return parseFloat(e)||0}function gse(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+pse(e["border-"+n+"-width"])}),0)}function mse(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return fse;var r=dse(e).getComputedStyle(e),i=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var i=r[n],o=e["padding-"+i];t[i]=pse(o)}return t}(r),o=i.left+i.right,s=i.top+i.bottom,a=pse(r.width),l=pse(r.height);if("border-box"===r.boxSizing&&(Math.round(a+o)!==t&&(a-=gse(r,"left","right")+o),Math.round(l+s)!==n&&(l-=gse(r,"top","bottom")+s)),!function(e){return e===dse(e).document.documentElement}(e)){var c=Math.round(a+o)-t,u=Math.round(l+s)-n;1!==Math.abs(c)&&(a-=c),1!==Math.abs(u)&&(l-=u)}return bse(i.left,i.top,a,l)}var vse="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof dse(e).SVGGraphicsElement}:function(e){return e instanceof dse(e).SVGElement&&"function"==typeof e.getBBox};function yse(e){return ose?vse(e)?function(e){var t=e.getBBox();return bse(0,0,t.width,t.height)}(e):mse(e):fse}function bse(e,t,n,r){return{x:e,y:t,width:n,height:r}}var xse=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=bse(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=yse(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),wse=function(e,t){var n=function(e){var t=e.x,n=e.y,r=e.width,i=e.height,o="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,s=Object.create(o.prototype);return hse(s,{x:t,y:n,width:r,height:i,top:n,right:t+r,bottom:i+n,left:t}),s}(t);hse(this,{target:e,contentRect:n})},Cse=function(){function e(e,t,n){if(this.activeObservations_=[],this.observations_=new ise,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof dse(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new xse(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof dse(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new wse(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),Ese="undefined"!=typeof WeakMap?new WeakMap:new ise,_se=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=use.getInstance(),r=new Cse(t,n,this);Ese.set(this,r)};["observe","unobserve","disconnect"].forEach((function(e){_se.prototype[e]=function(){var t;return(t=Ese.get(this))[e].apply(t,arguments)}}));var Sse=void 0!==sse.ResizeObserver?sse.ResizeObserver:_se;function Ose(e,t){var n=null,r=null;var i=new Sse((function(e){var i=sS(e,1)[0].target;if(document.documentElement.contains(i)){var o=i.getBoundingClientRect(),s=o.width,a=o.height,l=Math.floor(s),c=Math.floor(a);n===l&&r===c||Promise.resolve().then((function(){t({width:l,height:c})})),n=l,r=c}}));return e&&i.observe(e),function(){i.disconnect()}}function Ase(e){return"function"!=typeof e?null:e()}function kse(e){return"object"===lS(e)&&e?e:null}var Mse=function(e,t){var n=e.children,r=e.disabled,i=e.target,o=e.align,s=e.onAlign,l=e.monitorWindowResize,c=e.monitorBufferTime,u=void 0===c?0:c,h=a.default.useRef({}),d=a.default.useRef(),f=a.default.Children.only(n),p=a.default.useRef({});p.current.disabled=r,p.current.target=i,p.current.align=o,p.current.onAlign=s;var g=function(e,t){var n=a.default.useRef(!1),r=a.default.useRef(null);function i(){window.clearTimeout(r.current)}return[function o(s){if(n.current&&!0!==s)i(),r.current=window.setTimeout((function(){n.current=!1,o()}),t);else{if(!1===e())return;n.current=!0,i(),r.current=window.setTimeout((function(){n.current=!1}),t)}},function(){n.current=!1,i()}]}((function(){var e=p.current,t=e.disabled,n=e.target,r=e.align,i=e.onAlign;if(!t&&n){var o,s=d.current,a=Ase(n),l=kse(n);h.current.element=a,h.current.point=l,h.current.align=r;var c=document.activeElement;return a&&function(e){if(!e)return!1;if(e.offsetParent)return!0;if(e.getBBox){var t=e.getBBox();if(t.width||t.height)return!0}if(e.getBoundingClientRect){var n=e.getBoundingClientRect();if(n.width||n.height)return!0}return!1}(a)?o=tse(s,a,r):l&&(o=function(e,t,n){var r,i,o=Boe.getDocument(e),s=o.defaultView||o.parentWindow,a=Boe.getWindowScrollLeft(s),l=Boe.getWindowScrollTop(s),c=Boe.viewportWidth(s),u=Boe.viewportHeight(s),h={left:r="pageX"in t?t.pageX:a+t.clientX,top:i="pageY"in t?t.pageY:l+t.clientY,width:0,height:0},d=r>=0&&r<=a+c&&i>=0&&i<=l+u,f=[n.points[0],"cc"];return ese(e,h,ioe(ioe({},n),{},{points:f}),d)}(s,l,r)),function(e,t){e!==document.activeElement&&$re(t,e)&&"function"==typeof e.focus&&e.focus()}(c,s),i&&o&&i(s,o),!0}return!1}),u),m=sS(g,2),v=m[0],y=m[1],b=a.default.useRef({cancel:function(){}}),x=a.default.useRef({cancel:function(){}});a.default.useEffect((function(){var e,t,n=Ase(i),r=kse(i);d.current!==x.current.element&&(x.current.cancel(),x.current.element=d.current,x.current.cancel=Ose(d.current,v)),h.current.element===n&&((e=h.current.point)===(t=r)||e&&t&&("pageX"in t&&"pageY"in t?e.pageX===t.pageX&&e.pageY===t.pageY:"clientX"in t&&"clientY"in t&&e.clientX===t.clientX&&e.clientY===t.clientY))&&rse(h.current.align,o)||(v(),b.current.element!==n&&(b.current.cancel(),b.current.element=n,b.current.cancel=Ose(n,v)))})),a.default.useEffect((function(){r?y():v()}),[r]);var w=a.default.useRef(null);return a.default.useEffect((function(){l?w.current||(w.current=bie(window,"resize",v)):w.current&&(w.current.remove(),w.current=null)}),[l]),a.default.useEffect((function(){return function(){b.current.cancel(),x.current.cancel(),w.current&&w.current.remove(),y()}}),[]),a.default.useImperativeHandle(t,(function(){return{forceAlign:function(){return v(!0)}}})),a.default.isValidElement(f)&&(f=a.default.cloneElement(f,{ref:yie(f.ref,d)})),f},Tse=a.default.forwardRef(Mse);function Pse(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function Dse(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){Pse(o,r,i,s,a,"next",e)}function a(e){Pse(o,r,i,s,a,"throw",e)}s(void 0)}))}}Tse.displayName="Align";var Nse=["measure","align",null,"motion"],Rse=l.forwardRef((function(e,n){var r=e.visible,i=e.prefixCls,o=e.className,s=e.style,a=e.children,c=e.zIndex,u=e.stretch,h=e.destroyPopupOnHide,d=e.forceRender,f=e.align,p=e.point,g=e.getRootDomNode,m=e.getClassNameFromAlign,v=e.onAlign,y=e.onMouseEnter,b=e.onMouseLeave,x=e.onMouseDown,w=e.onTouchStart,C=t.useRef(),E=t.useRef(),_=sS(t.useState(),2),S=_[0],O=_[1],A=function(e){var t=sS(l.useState({width:0,height:0}),2),n=t[0],r=t[1],i=l.useMemo((function(){var t={};if(e){var r=n.width,i=n.height;-1!==e.indexOf("height")&&i?t.height=i:-1!==e.indexOf("minHeight")&&i&&(t.minHeight=i),-1!==e.indexOf("width")&&r?t.width=r:-1!==e.indexOf("minWidth")&&r&&(t.minWidth=r)}return t}),[e,n]);return[i,function(e){r({width:e.offsetWidth,height:e.offsetHeight})}]}(u),k=sS(A,2),M=k[0],T=k[1];var P=function(e,n){var r=sS(t.useState(null),2),i=r[0],o=r[1],s=t.useRef(),a=t.useRef(!1);function l(e){a.current||o(e)}function c(){Wre.cancel(s.current)}return t.useEffect((function(){l("measure")}),[e]),t.useEffect((function(){"measure"===i&&n(),i&&(s.current=Wre(Dse(VZ.mark((function e(){var t,n;return VZ.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Nse.indexOf(i),(n=Nse[t+1])&&-1!==t&&l(n);case 3:case"end":return e.stop()}}),e)})))))}),[i]),t.useEffect((function(){return function(){a.current=!0,c()}}),[]),[i,function(e){c(),s.current=Wre((function(){l((function(e){switch(i){case"align":return"motion";case"motion":return"stable"}return e})),null==e||e()}))}]}(r,(function(){u&&T(g())})),D=sS(P,2),N=D[0],R=D[1],I=t.useRef();function j(){var e;null===(e=C.current)||void 0===e||e.forceAlign()}function L(e,t){var n=m(t);S!==n&&O(n),"align"===N&&(S!==n?Promise.resolve().then((function(){j()})):R((function(){var e;null===(e=I.current)||void 0===e||e.call(I)})),null==v||v(e,t))}var F=iS({},eoe(e));function G(){return new Promise((function(e){I.current=e}))}["onAppearEnd","onEnterEnd","onLeaveEnd"].forEach((function(e){var t=F[e];F[e]=function(e,n){return R(),null==t?void 0:t(e,n)}})),l.useEffect((function(){F.motionName||"motion"!==N||R()}),[F.motionName,N]),l.useImperativeHandle(n,(function(){return{forceAlign:j,getElement:function(){return E.current}}}));var B=iS(iS({},M),{},{zIndex:c,opacity:"motion"!==N&&"stable"!==N&&r?0:void 0,pointerEvents:"stable"===N?void 0:"none"},s),z=!0;!(null==f?void 0:f.points)||"align"!==N&&"stable"!==N||(z=!1);var U=a;return l.Children.count(a)>1&&(U=l.createElement("div",{className:"".concat(i,"-content")},a)),l.createElement(Qie,Tre({visible:r,ref:E,leavedClassName:"".concat(i,"-hidden")},F,{onAppearPrepare:G,onEnterPrepare:G,removeOnLeave:h,forceRender:d}),(function(e,t){var n=e.className,r=e.style,s=hr(i,o,S,n);return l.createElement(Tse,{target:p||g,key:"popup",ref:C,monitorWindowResize:!0,disabled:z,align:f,onAlign:L},l.createElement("div",{ref:t,className:s,onMouseEnter:y,onMouseLeave:b,onMouseDownCapture:x,onTouchStartCapture:w,style:iS(iS({},r),B)},U))}))}));Rse.displayName="PopupInner";var Ise=l.forwardRef((function(e,t){var n=e.prefixCls,r=e.visible,i=e.zIndex,o=e.children,s=e.mobile,a=(s=void 0===s?{}:s).popupClassName,c=s.popupStyle,u=s.popupMotion,h=void 0===u?{}:u,d=s.popupRender,f=l.useRef();l.useImperativeHandle(t,(function(){return{forceAlign:function(){},getElement:function(){return f.current}}}));var p=iS({zIndex:i},c),g=o;return l.Children.count(o)>1&&(g=l.createElement("div",{className:"".concat(n,"-content")},o)),d&&(g=d(g)),l.createElement(Qie,Tre({visible:r,ref:f,removeOnLeave:!0},h),(function(e,t){var r=e.className,i=e.style,o=hr(n,a,r);return l.createElement("div",{ref:t,className:o,style:iS(iS({},i),p)},g)}))}));Ise.displayName="MobilePopupInner";var jse=["visible","mobile"],Lse=l.forwardRef((function(e,n){var r=e.visible,i=e.mobile,o=aS(e,jse),s=sS(t.useState(r),2),a=s[0],c=s[1],u=sS(t.useState(!1),2),h=u[0],d=u[1],f=iS(iS({},o),{},{visible:a});t.useEffect((function(){c(r),r&&i&&d(function(){if("undefined"==typeof navigator||"undefined"==typeof window)return!1;var e=navigator.userAgent||navigator.vendor||window.opera;return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(null==e?void 0:e.substr(0,4)))}())}),[r,i]);var p=h?l.createElement(Ise,Tre({},f,{mobile:i,ref:n})):l.createElement(Rse,Tre({},f,{ref:n}));return l.createElement("div",null,l.createElement(toe,f),p)}));Lse.displayName="Popup";var Fse=l.createContext(null);function Gse(){}function Bse(){return""}function zse(e){return e?e.ownerDocument:window.document}var Use=["onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur","onContextMenu"];var Vse=function(e){var t=function(t){jre(r,t);var n=Gre(r);function r(e){var t,i;return Pre(this,r),(t=n.call(this,e)).popupRef=l.createRef(),t.triggerRef=l.createRef(),t.attachId=void 0,t.clickOutsideHandler=void 0,t.touchOutsideHandler=void 0,t.contextMenuOutsideHandler1=void 0,t.contextMenuOutsideHandler2=void 0,t.mouseDownTimeout=void 0,t.focusTime=void 0,t.preClickTime=void 0,t.preTouchTime=void 0,t.delayTimer=void 0,t.hasPopupMouseDown=void 0,t.onMouseEnter=function(e){var n=t.props.mouseEnterDelay;t.fireEvents("onMouseEnter",e),t.delaySetPopupVisible(!0,n,n?null:e)},t.onMouseMove=function(e){t.fireEvents("onMouseMove",e),t.setPoint(e)},t.onMouseLeave=function(e){t.fireEvents("onMouseLeave",e),t.delaySetPopupVisible(!1,t.props.mouseLeaveDelay)},t.onPopupMouseEnter=function(){t.clearDelayTimer()},t.onPopupMouseLeave=function(e){var n;e.relatedTarget&&!e.relatedTarget.setTimeout&&$re(null===(n=t.popupRef.current)||void 0===n?void 0:n.getElement(),e.relatedTarget)||t.delaySetPopupVisible(!1,t.props.mouseLeaveDelay)},t.onFocus=function(e){t.fireEvents("onFocus",e),t.clearDelayTimer(),t.isFocusToShow()&&(t.focusTime=Date.now(),t.delaySetPopupVisible(!0,t.props.focusDelay))},t.onMouseDown=function(e){t.fireEvents("onMouseDown",e),t.preClickTime=Date.now()},t.onTouchStart=function(e){t.fireEvents("onTouchStart",e),t.preTouchTime=Date.now()},t.onBlur=function(e){t.fireEvents("onBlur",e),t.clearDelayTimer(),t.isBlurToHide()&&t.delaySetPopupVisible(!1,t.props.blurDelay)},t.onContextMenu=function(e){e.preventDefault(),t.fireEvents("onContextMenu",e),t.setPopupVisible(!0,e)},t.onContextMenuClose=function(){t.isContextMenuToShow()&&t.close()},t.onClick=function(e){if(t.fireEvents("onClick",e),t.focusTime){var n;if(t.preClickTime&&t.preTouchTime?n=Math.min(t.preClickTime,t.preTouchTime):t.preClickTime?n=t.preClickTime:t.preTouchTime&&(n=t.preTouchTime),Math.abs(n-t.focusTime)<20)return;t.focusTime=0}t.preClickTime=0,t.preTouchTime=0,t.isClickToShow()&&(t.isClickToHide()||t.isBlurToHide())&&e&&e.preventDefault&&e.preventDefault();var r=!t.state.popupVisible;(t.isClickToHide()&&!r||r&&t.isClickToShow())&&t.setPopupVisible(!t.state.popupVisible,e)},t.onPopupMouseDown=function(){var e;(t.hasPopupMouseDown=!0,clearTimeout(t.mouseDownTimeout),t.mouseDownTimeout=window.setTimeout((function(){t.hasPopupMouseDown=!1}),0),t.context)&&(e=t.context).onPopupMouseDown.apply(e,arguments)},t.onDocumentClick=function(e){if(!t.props.mask||t.props.maskClosable){var n=e.target,r=t.getRootDomNode(),i=t.getPopupDomNode();$re(r,n)&&!t.isContextMenuOnly()||$re(i,n)||t.hasPopupMouseDown||t.close()}},t.getRootDomNode=function(){var e=t.props.getTriggerDOMNode;if(e)return e(t.triggerRef.current);try{var n=Xre(t.triggerRef.current);if(n)return n}catch(e){}return c.default.findDOMNode(Rre(t))},t.getPopupClassNameFromAlign=function(e){var n=[],r=t.props,i=r.popupPlacement,o=r.builtinPlacements,s=r.prefixCls,a=r.alignPoint,l=r.getPopupClassNameFromAlign;return i&&o&&n.push(function(e,t,n,r){for(var i=n.points,o=Object.keys(e),s=0;s<o.length;s+=1){var a=o[s];if(wie(e[a].points,i,r))return"".concat(t,"-placement-").concat(a)}return""}(o,s,e,a)),l&&n.push(l(e)),n.join(" ")},t.getComponent=function(){var e=t.props,n=e.prefixCls,r=e.destroyPopupOnHide,i=e.popupClassName,o=e.onPopupAlign,s=e.popupMotion,a=e.popupAnimation,c=e.popupTransitionName,u=e.popupStyle,h=e.mask,d=e.maskAnimation,f=e.maskTransitionName,p=e.maskMotion,g=e.zIndex,m=e.popup,v=e.stretch,y=e.alignPoint,b=e.mobile,x=e.forceRender,w=t.state,C=w.popupVisible,E=w.point,_=t.getPopupAlign(),S={};return t.isMouseEnterToShow()&&(S.onMouseEnter=t.onPopupMouseEnter),t.isMouseLeaveToHide()&&(S.onMouseLeave=t.onPopupMouseLeave),S.onMouseDown=t.onPopupMouseDown,S.onTouchStart=t.onPopupMouseDown,l.createElement(Lse,Tre({prefixCls:n,destroyPopupOnHide:r,visible:C,point:y&&E,className:i,align:_,onAlign:o,animation:a,getClassNameFromAlign:t.getPopupClassNameFromAlign},S,{stretch:v,getRootDomNode:t.getRootDomNode,style:u,mask:h,zIndex:g,transitionName:c,maskAnimation:d,maskTransitionName:f,maskMotion:p,ref:t.popupRef,motion:s,mobile:b,forceRender:x}),"function"==typeof m?m():m)},t.attachParent=function(e){Wre.cancel(t.attachId);var n,r=t.props,i=r.getPopupContainer,o=r.getDocument,s=t.getRootDomNode();i?(s||0===i.length)&&(n=i(s)):n=o(t.getRootDomNode()).body,n?n.appendChild(e):t.attachId=Wre((function(){t.attachParent(e)}))},t.getContainer=function(){var e=(0,t.props.getDocument)(t.getRootDomNode()).createElement("div");return e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",t.attachParent(e),e},t.setPoint=function(e){t.props.alignPoint&&e&&t.setState({point:{pageX:e.pageX,pageY:e.pageY}})},t.handlePortalUpdate=function(){t.state.prevPopupVisible!==t.state.popupVisible&&t.props.afterPopupVisibleChange(t.state.popupVisible)},t.triggerContextValue={onPopupMouseDown:t.onPopupMouseDown},i="popupVisible"in e?!!e.popupVisible:!!e.defaultPopupVisible,t.state={prevPopupVisible:i,popupVisible:i},Use.forEach((function(e){t["fire".concat(e)]=function(n){t.fireEvents(e,n)}})),t}return Nre(r,[{key:"componentDidMount",value:function(){this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){var e,t=this.props;if(this.state.popupVisible)return this.clickOutsideHandler||!this.isClickToHide()&&!this.isContextMenuToShow()||(e=t.getDocument(this.getRootDomNode()),this.clickOutsideHandler=bie(e,"mousedown",this.onDocumentClick)),this.touchOutsideHandler||(e=e||t.getDocument(this.getRootDomNode()),this.touchOutsideHandler=bie(e,"touchstart",this.onDocumentClick)),!this.contextMenuOutsideHandler1&&this.isContextMenuToShow()&&(e=e||t.getDocument(this.getRootDomNode()),this.contextMenuOutsideHandler1=bie(e,"scroll",this.onContextMenuClose)),void(!this.contextMenuOutsideHandler2&&this.isContextMenuToShow()&&(this.contextMenuOutsideHandler2=bie(window,"blur",this.onContextMenuClose)));this.clearOutsideHandler()}},{key:"componentWillUnmount",value:function(){this.clearDelayTimer(),this.clearOutsideHandler(),clearTimeout(this.mouseDownTimeout),Wre.cancel(this.attachId)}},{key:"getPopupDomNode",value:function(){var e;return(null===(e=this.popupRef.current)||void 0===e?void 0:e.getElement())||null}},{key:"getPopupAlign",value:function(){var e=this.props,t=e.popupPlacement,n=e.popupAlign,r=e.builtinPlacements;return t&&r?function(e,t,n){return iS(iS({},e[t]||{}),n)}(r,t,n):n}},{key:"setPopupVisible",value:function(e,t){var n=this.props.alignPoint,r=this.state.popupVisible;this.clearDelayTimer(),r!==e&&("popupVisible"in this.props||this.setState({popupVisible:e,prevPopupVisible:r}),this.props.onPopupVisibleChange(e)),n&&t&&e&&this.setPoint(t)}},{key:"delaySetPopupVisible",value:function(e,t,n){var r=this,i=1e3*t;if(this.clearDelayTimer(),i){var o=n?{pageX:n.pageX,pageY:n.pageY}:null;this.delayTimer=window.setTimeout((function(){r.setPopupVisible(e,o),r.clearDelayTimer()}),i)}else this.setPopupVisible(e,n)}},{key:"clearDelayTimer",value:function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)}},{key:"clearOutsideHandler",value:function(){this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.clickOutsideHandler=null),this.contextMenuOutsideHandler1&&(this.contextMenuOutsideHandler1.remove(),this.contextMenuOutsideHandler1=null),this.contextMenuOutsideHandler2&&(this.contextMenuOutsideHandler2.remove(),this.contextMenuOutsideHandler2=null),this.touchOutsideHandler&&(this.touchOutsideHandler.remove(),this.touchOutsideHandler=null)}},{key:"createTwoChains",value:function(e){var t=this.props.children.props,n=this.props;return t[e]&&n[e]?this["fire".concat(e)]:t[e]||n[e]}},{key:"isClickToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("click")||-1!==n.indexOf("click")}},{key:"isContextMenuOnly",value:function(){var e=this.props.action;return"contextMenu"===e||1===e.length&&"contextMenu"===e[0]}},{key:"isContextMenuToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("contextMenu")||-1!==n.indexOf("contextMenu")}},{key:"isClickToHide",value:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("click")||-1!==n.indexOf("click")}},{key:"isMouseEnterToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("hover")||-1!==n.indexOf("mouseEnter")}},{key:"isMouseLeaveToHide",value:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("hover")||-1!==n.indexOf("mouseLeave")}},{key:"isFocusToShow",value:function(){var e=this.props,t=e.action,n=e.showAction;return-1!==t.indexOf("focus")||-1!==n.indexOf("focus")}},{key:"isBlurToHide",value:function(){var e=this.props,t=e.action,n=e.hideAction;return-1!==t.indexOf("focus")||-1!==n.indexOf("blur")}},{key:"forcePopupAlign",value:function(){var e;this.state.popupVisible&&(null===(e=this.popupRef.current)||void 0===e||e.forceAlign())}},{key:"fireEvents",value:function(e,t){var n=this.props.children.props[e];n&&n(t);var r=this.props[e];r&&r(t)}},{key:"close",value:function(){this.setPopupVisible(!1)}},{key:"render",value:function(){var t=this.state.popupVisible,n=this.props,r=n.children,i=n.forceRender,o=n.alignPoint,s=n.className,a=n.autoDestroy,c=l.Children.only(r),u={key:"trigger"};this.isContextMenuToShow()?u.onContextMenu=this.onContextMenu:u.onContextMenu=this.createTwoChains("onContextMenu"),this.isClickToHide()||this.isClickToShow()?(u.onClick=this.onClick,u.onMouseDown=this.onMouseDown,u.onTouchStart=this.onTouchStart):(u.onClick=this.createTwoChains("onClick"),u.onMouseDown=this.createTwoChains("onMouseDown"),u.onTouchStart=this.createTwoChains("onTouchStart")),this.isMouseEnterToShow()?(u.onMouseEnter=this.onMouseEnter,o&&(u.onMouseMove=this.onMouseMove)):u.onMouseEnter=this.createTwoChains("onMouseEnter"),this.isMouseLeaveToHide()?u.onMouseLeave=this.onMouseLeave:u.onMouseLeave=this.createTwoChains("onMouseLeave"),this.isFocusToShow()||this.isBlurToHide()?(u.onFocus=this.onFocus,u.onBlur=this.onBlur):(u.onFocus=this.createTwoChains("onFocus"),u.onBlur=this.createTwoChains("onBlur"));var h=hr(c&&c.props&&c.props.className,s);h&&(u.className=h);var d,f,p,g,m=iS({},u);d=c,"function"==typeof(g=Yre.exports.isMemo(d)?d.type.type:d.type)&&!(null===(f=g.prototype)||void 0===f?void 0:f.render)||"function"==typeof d&&!(null===(p=d.prototype)||void 0===p?void 0:p.render)||(m.ref=yie(this.triggerRef,c.ref));var v,y=l.cloneElement(c,m);return(t||this.popupRef.current||i)&&(v=l.createElement(e,{key:"portal",getContainer:this.getContainer,didUpdate:this.handlePortalUpdate},this.getComponent())),!t&&a&&(v=null),l.createElement(Fse.Provider,{value:this.triggerContextValue},y,v)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.popupVisible,r={};return void 0!==n&&t.popupVisible!==n&&(r.popupVisible=n,r.prevPopupVisible=t.popupVisible),r}}]),r}(l.Component);return t.contextType=Fse,t.defaultProps={prefixCls:"rc-trigger-popup",getPopupClassNameFromAlign:Bse,getDocument:zse,onPopupVisibleChange:Gse,afterPopupVisibleChange:Gse,onPopupAlign:Gse,popupClassName:"",mouseEnterDelay:0,mouseLeaveDelay:.1,focusDelay:0,blurDelay:.15,popupStyle:{},destroyPopupOnHide:!1,popupAlign:{},defaultPopupVisible:!1,mask:!1,maskClosable:!0,action:[],showAction:[],hideAction:[],autoDestroy:!1},t}(xie),Hse={adjustX:1,adjustY:1},Wse=[0,0],$se={topLeft:{points:["bl","tl"],overflow:Hse,offset:[0,-4],targetOffset:Wse},topCenter:{points:["bc","tc"],overflow:Hse,offset:[0,-4],targetOffset:Wse},topRight:{points:["br","tr"],overflow:Hse,offset:[0,-4],targetOffset:Wse},bottomLeft:{points:["tl","bl"],overflow:Hse,offset:[0,4],targetOffset:Wse},bottomCenter:{points:["tc","bc"],overflow:Hse,offset:[0,4],targetOffset:Wse},bottomRight:{points:["tr","br"],overflow:Hse,offset:[0,4],targetOffset:Wse}};var Xse=l.forwardRef((function(e,t){var n=e.arrow,r=void 0!==n&&n,i=e.prefixCls,o=void 0===i?"rc-dropdown":i,s=e.transitionName,a=e.animation,c=e.align,u=e.placement,h=void 0===u?"bottomLeft":u,d=e.placements,f=void 0===d?$se:d,p=e.getPopupContainer,g=e.showAction,m=e.hideAction,v=e.overlayClassName,y=e.overlayStyle,b=e.visible,x=e.trigger,w=void 0===x?["hover"]:x,C=aS(e,["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger"]),E=sS(l.useState(),2),_=E[0],S=E[1],O="visible"in e?b:_,A=l.useRef(null);l.useImperativeHandle(t,(function(){return A.current}));var k,M,T,P,D=function(){var t=e.overlay;return"function"==typeof t?t():t},N=function(t){var n=e.onOverlayClick,r=D().props;S(!1),n&&n(t),r.onClick&&r.onClick(t)},R=function(){var e=D(),t={prefixCls:"".concat(o,"-menu"),onClick:N};return"string"==typeof e.type&&delete t.prefixCls,l.createElement(l.Fragment,null,r&&l.createElement("div",{className:"".concat(o,"-arrow")}),l.cloneElement(e,t))},I=m;return I||-1===w.indexOf("contextMenu")||(I=["click"]),l.createElement(Vse,Object.assign({},C,{prefixCls:o,ref:A,popupClassName:hr(v,nS({},"".concat(o,"-show-arrow"),r)),popupStyle:y,builtinPlacements:f,action:w,showAction:g,hideAction:I||[],popupPlacement:h,popupAlign:c,popupTransitionName:s,popupAnimation:a,popupVisible:O,stretch:function(){var t=e.minOverlayWidthMatchTrigger,n=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?t:!n}()?"minWidth":"",popup:"function"==typeof e.overlay?R:R(),onPopupVisibleChange:function(t){var n=e.onVisibleChange;S(t),"function"==typeof n&&n(t)},getPopupContainer:p}),(M=e.children,T=M.props?M.props:{},P=hr(T.className,void 0!==(k=e.openClassName)?k:"".concat(o,"-open")),_&&M?l.cloneElement(M,{className:P}):M))}));class Yse extends a.default.Component{render(){const{children:e,trigger:t,disabled:n}=this.props,r=`${this.props.prefixCls}-dropdown`,i=a.default.Children.only(e),o=a.default.cloneElement(i,{className:hr(e.props.className,`${r}-trigger`),disabled:n}),s=n?[]:Array.isArray(t)?t:[t];let l=!1;s&&-1!==s.indexOf("contextMenu")&&(l=!0);const c=a.default.Children.only(this.props.overlay),u=a.default.createElement("div",{className:`${r}-overlay`},c);return a.default.createElement(Xse,Object.assign({},this.props,{prefixCls:r,overlay:u,alignPoint:l,trigger:s}),o)}}!function(e){e.defaultProps={trigger:"hover",prefixCls:"x6",mouseEnterDelay:.15,mouseLeaveDelay:.1,placement:"bottomLeft"}}(Yse||(Yse={}));!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}('.ant-tooltip{font-feature-settings:"tnum";box-sizing:border-box;color:rgba(0,0,0,.85);display:block;font-size:14px;font-variant:tabular-nums;line-height:1.5715;list-style:none;margin:0;max-width:250px;padding:0;position:absolute;visibility:visible;width:-webkit-max-content;width:-moz-max-content;width:max-content;z-index:1070}.ant-tooltip-hidden{display:none}.ant-tooltip-placement-top,.ant-tooltip-placement-topLeft,.ant-tooltip-placement-topRight{padding-bottom:8px}.ant-tooltip-placement-right,.ant-tooltip-placement-rightBottom,.ant-tooltip-placement-rightTop{padding-left:8px}.ant-tooltip-placement-bottom,.ant-tooltip-placement-bottomLeft,.ant-tooltip-placement-bottomRight{padding-top:8px}.ant-tooltip-placement-left,.ant-tooltip-placement-leftBottom,.ant-tooltip-placement-leftTop{padding-right:8px}.ant-tooltip-inner{word-wrap:break-word;background-color:rgba(0,0,0,.75);border-radius:2px;box-shadow:0 3px 6px -4px rgba(0,0,0,.12),0 6px 16px 0 rgba(0,0,0,.08),0 9px 28px 8px rgba(0,0,0,.05);color:#fff;min-height:32px;min-width:30px;padding:6px 8px;text-align:left;text-decoration:none}.ant-tooltip-arrow{background:transparent;display:block;height:13.07106781px;overflow:hidden;pointer-events:none;position:absolute;width:13.07106781px}.ant-tooltip-arrow-content{background-color:rgba(0,0,0,.75);bottom:0;content:"";display:block;height:5px;left:0;margin:auto;pointer-events:auto;position:absolute;right:0;top:0;width:5px}.ant-tooltip-placement-top .ant-tooltip-arrow,.ant-tooltip-placement-topLeft .ant-tooltip-arrow,.ant-tooltip-placement-topRight .ant-tooltip-arrow{bottom:-5.07106781px}.ant-tooltip-placement-top .ant-tooltip-arrow-content,.ant-tooltip-placement-topLeft .ant-tooltip-arrow-content,.ant-tooltip-placement-topRight .ant-tooltip-arrow-content{box-shadow:3px 3px 7px rgba(0,0,0,.07);transform:translateY(-6.53553391px) rotate(45deg)}.ant-tooltip-placement-top .ant-tooltip-arrow{left:50%;transform:translateX(-50%)}.ant-tooltip-placement-topLeft .ant-tooltip-arrow{left:13px}.ant-tooltip-placement-topRight .ant-tooltip-arrow{right:13px}.ant-tooltip-placement-right .ant-tooltip-arrow,.ant-tooltip-placement-rightBottom .ant-tooltip-arrow,.ant-tooltip-placement-rightTop .ant-tooltip-arrow{left:-5.07106781px}.ant-tooltip-placement-right .ant-tooltip-arrow-content,.ant-tooltip-placement-rightBottom .ant-tooltip-arrow-content,.ant-tooltip-placement-rightTop .ant-tooltip-arrow-content{box-shadow:-3px 3px 7px rgba(0,0,0,.07);transform:translateX(6.53553391px) rotate(45deg)}.ant-tooltip-placement-right .ant-tooltip-arrow{top:50%;transform:translateY(-50%)}.ant-tooltip-placement-rightTop .ant-tooltip-arrow{top:5px}.ant-tooltip-placement-rightBottom .ant-tooltip-arrow{bottom:5px}.ant-tooltip-placement-left .ant-tooltip-arrow,.ant-tooltip-placement-leftBottom .ant-tooltip-arrow,.ant-tooltip-placement-leftTop .ant-tooltip-arrow{right:-5.07106781px}.ant-tooltip-placement-left .ant-tooltip-arrow-content,.ant-tooltip-placement-leftBottom .ant-tooltip-arrow-content,.ant-tooltip-placement-leftTop .ant-tooltip-arrow-content{box-shadow:3px -3px 7px rgba(0,0,0,.07);transform:translateX(-6.53553391px) rotate(45deg)}.ant-tooltip-placement-left .ant-tooltip-arrow{top:50%;transform:translateY(-50%)}.ant-tooltip-placement-leftTop .ant-tooltip-arrow{top:5px}.ant-tooltip-placement-leftBottom .ant-tooltip-arrow{bottom:5px}.ant-tooltip-placement-bottom .ant-tooltip-arrow,.ant-tooltip-placement-bottomLeft .ant-tooltip-arrow,.ant-tooltip-placement-bottomRight .ant-tooltip-arrow{top:-5.07106781px}.ant-tooltip-placement-bottom .ant-tooltip-arrow-content,.ant-tooltip-placement-bottomLeft .ant-tooltip-arrow-content,.ant-tooltip-placement-bottomRight .ant-tooltip-arrow-content{box-shadow:-3px -3px 7px rgba(0,0,0,.07);transform:translateY(6.53553391px) rotate(45deg)}.ant-tooltip-placement-bottom .ant-tooltip-arrow{left:50%;transform:translateX(-50%)}.ant-tooltip-placement-bottomLeft .ant-tooltip-arrow{left:13px}.ant-tooltip-placement-bottomRight .ant-tooltip-arrow{right:13px}.ant-tooltip-magenta .ant-tooltip-arrow-content,.ant-tooltip-magenta .ant-tooltip-inner,.ant-tooltip-pink .ant-tooltip-arrow-content,.ant-tooltip-pink .ant-tooltip-inner{background-color:#eb2f96}.ant-tooltip-red .ant-tooltip-arrow-content,.ant-tooltip-red .ant-tooltip-inner{background-color:#f5222d}.ant-tooltip-volcano .ant-tooltip-arrow-content,.ant-tooltip-volcano .ant-tooltip-inner{background-color:#fa541c}.ant-tooltip-orange .ant-tooltip-arrow-content,.ant-tooltip-orange .ant-tooltip-inner{background-color:#fa8c16}.ant-tooltip-yellow .ant-tooltip-arrow-content,.ant-tooltip-yellow .ant-tooltip-inner{background-color:#fadb14}.ant-tooltip-gold .ant-tooltip-arrow-content,.ant-tooltip-gold .ant-tooltip-inner{background-color:#faad14}.ant-tooltip-cyan .ant-tooltip-arrow-content,.ant-tooltip-cyan .ant-tooltip-inner{background-color:#13c2c2}.ant-tooltip-lime .ant-tooltip-arrow-content,.ant-tooltip-lime .ant-tooltip-inner{background-color:#a0d911}.ant-tooltip-green .ant-tooltip-arrow-content,.ant-tooltip-green .ant-tooltip-inner{background-color:#52c41a}.ant-tooltip-blue .ant-tooltip-arrow-content,.ant-tooltip-blue .ant-tooltip-inner{background-color:#1890ff}.ant-tooltip-geekblue .ant-tooltip-arrow-content,.ant-tooltip-geekblue .ant-tooltip-inner{background-color:#2f54eb}.ant-tooltip-purple .ant-tooltip-arrow-content,.ant-tooltip-purple .ant-tooltip-inner{background-color:#722ed1}.ant-tooltip-rtl{direction:rtl}.ant-tooltip-rtl .ant-tooltip-inner{text-align:right}');const qse=a.default.createContext({});class Kse extends a.default.PureComponent{constructor(){super(...arguments),this.handleClick=()=>{this.processClick()},this.handleDropdownItemClick=e=>{this.processClick(e,!1)}}processClick(e=this.props.name,t=this.props.dropdown){this.props.disabled||t||(e&&this.props.context.onClick(e),this.props.onClick&&this.props.onClick(e))}renderButton(){const{className:e,hidden:t,disabled:n,active:r,icon:o,text:s,dropdown:l,dropdownArrow:c,tooltip:u,tooltipProps:h,tooltipAsTitle:d,children:f}=this.props,{prefixCls:p}=this.props.context,g=`${p}-item`,m={onClick:this.handleClick,className:hr(g,{[`${g}-hidden`]:t,[`${g}-active`]:r,[`${g}-disabled`]:n,[`${g}-dropdown`]:l},e)};u&&d&&(m.title=u);const v=a.default.createElement("button",Object.assign({type:"button"},m),o&&a.default.isValidElement(o)&&a.default.createElement("span",{className:`${g}-icon`},o),(s||f)&&a.default.createElement("span",{className:`${g}-text`},s||f),l&&c&&a.default.createElement("span",{className:`${g}-dropdown-arrow`}));return!u||d||n?v:a.default.createElement(i.Tooltip,Object.assign({title:u,placement:"bottom",mouseEnterDelay:0,mouseLeaveDelay:0},h),v)}render(){const{dropdown:e,dropdownProps:t,disabled:n}=this.props,r=this.renderButton();if(null!=e&&!n){const i=a.default.createElement("div",null,e.type===Mre?a.default.cloneElement(e,{onClick:this.handleDropdownItemClick}):e),o=Object.assign(Object.assign({trigger:["click"]},t),{disabled:n,overlay:i});return a.default.createElement(Yse,Object.assign({},o),r)}return r}}const Zse=e=>a.default.createElement(qse.Consumer,null,(t=>a.default.createElement(Kse,Object.assign({context:t},e))));Zse.defaultProps={dropdownArrow:!0};const Jse=({children:e,className:t})=>a.default.createElement(qse.Consumer,null,(({prefixCls:n})=>a.default.createElement("div",{className:hr(`${n}-group`,t)},e)));class Qse extends a.default.PureComponent{constructor(){super(...arguments),this.onClick=(e,t)=>{this.props.onClick&&this.props.onClick(e,t)}}render(){const{prefixCls:e,className:t,children:n,extra:r,size:i,align:o,hoverEffect:s}=this.props,l=`${e}-toolbar`;return a.default.createElement("div",{className:hr(l,t,{[`${l}-${i}`]:i,[`${l}-align-right`]:"right"===o,[`${l}-hover-effect`]:s})},a.default.createElement("div",{className:`${l}-content`},a.default.createElement("div",{className:`${l}-content-inner`},a.default.createElement(qse.Provider,{value:{prefixCls:l,onClick:this.onClick}},n)),r&&a.default.createElement("div",{className:`${l}-content-extras`},r)))}}!function(e){e.Item=Zse,e.Group=Jse,e.defaultProps={prefixCls:"x6",hoverEffect:!1}}(Qse||(Qse={}));var eae={},tae={},nae={},rae={},iae=nG,oae=lG;var sae=function(e,t){return e&&iae(e,oae(t))};Object.defineProperty(rae,"__esModule",{value:!0}),rae.flattenNames=void 0;var aae=hae(yU),lae=hae(sae),cae=hae(v$),uae=hae(sU);function hae(e){return e&&e.__esModule?e:{default:e}}var dae=rae.flattenNames=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[];return(0,uae.default)(t,(function(t){Array.isArray(t)?e(t).map((function(e){return n.push(e)})):(0,cae.default)(t)?(0,lae.default)(t,(function(e,t){!0===e&&n.push(t),n.push(t+"-"+e)})):(0,aae.default)(t)&&n.push(t)})),n};rae.default=dae;var fae={};Object.defineProperty(fae,"__esModule",{value:!0}),fae.mergeClasses=void 0;var pae=vae(sae),gae=vae(tW),mae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function vae(e){return e&&e.__esModule?e:{default:e}}var yae=fae.mergeClasses=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.default&&(0,gae.default)(e.default)||{};return t.map((function(t){var r=e[t];return r&&(0,pae.default)(r,(function(e,t){n[t]||(n[t]={}),n[t]=mae({},n[t],r[t])})),t})),n};fae.default=yae;var bae={};Object.defineProperty(bae,"__esModule",{value:!0}),bae.autoprefix=void 0;var xae,wae=(xae=sae)&&xae.__esModule?xae:{default:xae},Cae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var Eae={borderRadius:function(e){return{msBorderRadius:e,MozBorderRadius:e,OBorderRadius:e,WebkitBorderRadius:e,borderRadius:e}},boxShadow:function(e){return{msBoxShadow:e,MozBoxShadow:e,OBoxShadow:e,WebkitBoxShadow:e,boxShadow:e}},userSelect:function(e){return{WebkitTouchCallout:e,KhtmlUserSelect:e,MozUserSelect:e,msUserSelect:e,WebkitUserSelect:e,userSelect:e}},flex:function(e){return{WebkitBoxFlex:e,MozBoxFlex:e,WebkitFlex:e,msFlex:e,flex:e}},flexBasis:function(e){return{WebkitFlexBasis:e,flexBasis:e}},justifyContent:function(e){return{WebkitJustifyContent:e,justifyContent:e}},transition:function(e){return{msTransition:e,MozTransition:e,OTransition:e,WebkitTransition:e,transition:e}},transform:function(e){return{msTransform:e,MozTransform:e,OTransform:e,WebkitTransform:e,transform:e}},absolute:function(e){var t=e&&e.split(" ");return{position:"absolute",top:t&&t[0],right:t&&t[1],bottom:t&&t[2],left:t&&t[3]}},extend:function(e,t){var n=t[e];return n||{extend:e}}},_ae=bae.autoprefix=function(e){var t={};return(0,wae.default)(e,(function(e,n){var r={};(0,wae.default)(e,(function(e,t){var n=Eae[t];n?r=Cae({},r,n(e)):r[t]=e})),t[n]=r})),t};bae.default=_ae;var Sae={};Object.defineProperty(Sae,"__esModule",{value:!0}),Sae.hover=void 0;var Oae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Aae=function(e){return e&&e.__esModule?e:{default:e}}(a.default);function kae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mae(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Tae(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Pae=Sae.hover=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(n){function r(){var n,i,o;kae(this,r);for(var s=arguments.length,a=Array(s),l=0;l<s;l++)a[l]=arguments[l];return i=o=Mae(this,(n=r.__proto__||Object.getPrototypeOf(r)).call.apply(n,[this].concat(a))),o.state={hover:!1},o.handleMouseOver=function(){return o.setState({hover:!0})},o.handleMouseOut=function(){return o.setState({hover:!1})},o.render=function(){return Aae.default.createElement(t,{onMouseOver:o.handleMouseOver,onMouseOut:o.handleMouseOut},Aae.default.createElement(e,Oae({},o.props,o.state)))},Mae(o,i)}return Tae(r,n),r}(Aae.default.Component)};Sae.default=Pae;var Dae={};Object.defineProperty(Dae,"__esModule",{value:!0}),Dae.active=void 0;var Nae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Rae=function(e){return e&&e.__esModule?e:{default:e}}(a.default);function Iae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jae(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Lae(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Fae=Dae.active=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(n){function r(){var n,i,o;Iae(this,r);for(var s=arguments.length,a=Array(s),l=0;l<s;l++)a[l]=arguments[l];return i=o=jae(this,(n=r.__proto__||Object.getPrototypeOf(r)).call.apply(n,[this].concat(a))),o.state={active:!1},o.handleMouseDown=function(){return o.setState({active:!0})},o.handleMouseUp=function(){return o.setState({active:!1})},o.render=function(){return Rae.default.createElement(t,{onMouseDown:o.handleMouseDown,onMouseUp:o.handleMouseUp},Rae.default.createElement(e,Nae({},o.props,o.state)))},jae(o,i)}return Lae(r,n),r}(Rae.default.Component)};Dae.default=Fae;var Gae={};Object.defineProperty(Gae,"__esModule",{value:!0});Gae.default=function(e,t){var n={},r=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n[e]=t};return 0===e&&r("first-child"),e===t-1&&r("last-child"),(0===e||e%2==0)&&r("even"),1===Math.abs(e%2)&&r("odd"),r("nth-child",e),n},Object.defineProperty(nae,"__esModule",{value:!0}),nae.ReactCSS=nae.loop=nae.handleActive=nae.handleHover=nae.hover=void 0;var Bae=$ae(rae),zae=$ae(fae),Uae=$ae(bae),Vae=$ae(Sae),Hae=$ae(Dae),Wae=$ae(Gae);function $ae(e){return e&&e.__esModule?e:{default:e}}nae.hover=Vae.default,nae.handleHover=Vae.default,nae.handleActive=Hae.default,nae.loop=Wae.default;var Xae=nae.ReactCSS=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=(0,Bae.default)(n),o=(0,zae.default)(e,i);return(0,Uae.default)(o)};nae.default=Xae;var Yae={},qae={},Kae={};Object.defineProperty(Kae,"__esModule",{value:!0}),Kae.calculateChange=function(e,t,n,r,i){e.preventDefault();var o=i.clientWidth,s=i.clientHeight,a="number"==typeof e.pageX?e.pageX:e.touches[0].pageX,l="number"==typeof e.pageY?e.pageY:e.touches[0].pageY,c=a-(i.getBoundingClientRect().left+window.pageXOffset),u=l-(i.getBoundingClientRect().top+window.pageYOffset);if("vertical"===n){var h=void 0;if(h=u<0?0:u>s?1:Math.round(100*u/s)/100,t.a!==h)return{h:t.h,s:t.s,l:t.l,a:h,source:"rgb"}}else{var d=void 0;if(r!==(d=c<0?0:c>o?1:Math.round(100*c/o)/100))return{h:t.h,s:t.s,l:t.l,a:d,source:"rgb"}}return null};var Zae={},Jae={};Object.defineProperty(Jae,"__esModule",{value:!0});var Qae={},ele=Jae.render=function(e,t,n,r){if("undefined"==typeof document&&!r)return null;var i=r?new r:document.createElement("canvas");i.width=2*n,i.height=2*n;var o=i.getContext("2d");return o?(o.fillStyle=e,o.fillRect(0,0,i.width,i.height),o.fillStyle=t,o.fillRect(0,0,n,n),o.translate(n,n),o.fillRect(0,0,n,n),i.toDataURL()):null};Jae.get=function(e,t,n,r){var i=e+"-"+t+"-"+n+(r?"-server":"");if(Qae[i])return Qae[i];var o=ele(e,t,n,r);return Qae[i]=o,o},Object.defineProperty(Zae,"__esModule",{value:!0}),Zae.Checkboard=void 0;var tle=ile(a.default),nle=ile(nae),rle=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(Jae);function ile(e){return e&&e.__esModule?e:{default:e}}var ole=Zae.Checkboard=function(e){var t=e.white,n=e.grey,r=e.size,i=e.renderers,o=e.borderRadius,s=e.boxShadow,a=(0,nle.default)({default:{grid:{borderRadius:o,boxShadow:s,absolute:"0px 0px 0px 0px",background:"url("+rle.get(t,n,r,i.canvas)+") center left"}}});return tle.default.createElement("div",{style:a.grid})};ole.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}},Zae.default=ole,Object.defineProperty(qae,"__esModule",{value:!0}),qae.Alpha=void 0;var sle=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ale=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),lle=a.default,cle=fle(lle),ule=fle(nae),hle=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(Kae),dle=fle(Zae);function fle(e){return e&&e.__esModule?e:{default:e}}function ple(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gle(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var mle=qae.Alpha=function(e){function t(){var e,n,r;ple(this,t);for(var i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=r=gle(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),r.handleChange=function(e){var t=hle.calculateChange(e,r.props.hsl,r.props.direction,r.props.a,r.container);t&&"function"==typeof r.props.onChange&&r.props.onChange(t,e)},r.handleMouseDown=function(e){r.handleChange(e),window.addEventListener("mousemove",r.handleChange),window.addEventListener("mouseup",r.handleMouseUp)},r.handleMouseUp=function(){r.unbindEventListeners()},r.unbindEventListeners=function(){window.removeEventListener("mousemove",r.handleChange),window.removeEventListener("mouseup",r.handleMouseUp)},gle(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),ale(t,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var e=this,t=this.props.rgb,n=(0,ule.default)({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+t.r+","+t.g+","+t.b+", 0) 0%,\n           rgba("+t.r+","+t.g+","+t.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:100*t.a+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+t.r+","+t.g+","+t.b+", 0) 0%,\n           rgba("+t.r+","+t.g+","+t.b+", 1) 100%)"},pointer:{left:0,top:100*t.a+"%"}},overwrite:sle({},this.props.style)},{vertical:"vertical"===this.props.direction,overwrite:!0});return cle.default.createElement("div",{style:n.alpha},cle.default.createElement("div",{style:n.checkboard},cle.default.createElement(dle.default,{renderers:this.props.renderers})),cle.default.createElement("div",{style:n.gradient}),cle.default.createElement("div",{style:n.container,ref:function(t){return e.container=t},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},cle.default.createElement("div",{style:n.pointer},this.props.pointer?cle.default.createElement(this.props.pointer,this.props):cle.default.createElement("div",{style:n.slider}))))}}]),t}(lle.PureComponent||lle.Component);qae.default=mle;var vle={};Object.defineProperty(vle,"__esModule",{value:!0}),vle.EditableInput=void 0;var yle=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ble=a.default,xle=Cle(ble),wle=Cle(nae);function Cle(e){return e&&e.__esModule?e:{default:e}}var Ele=[38,40],_le=function(e){return e+"%"},Sle=vle.EditableInput=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.handleBlur=function(){n.state.blurValue&&n.setState({value:n.state.blurValue,blurValue:null})},n.handleChange=function(e){n.setUpdatedValue(e.target.value,e)},n.handleKeyDown=function(e){var t,r=function(e){return Number(String(e).replace(/%/g,""))}(e.target.value);if(!isNaN(r)&&(t=e.keyCode,Ele.indexOf(t)>-1)){var i=n.getArrowOffset(),o=38===e.keyCode?r+i:r-i;n.setUpdatedValue(o,e)}},n.handleDrag=function(e){if(n.props.dragLabel){var t=Math.round(n.props.value+e.movementX);t>=0&&t<=n.props.dragMax&&n.props.onChange&&n.props.onChange(n.getValueObjectWithLabel(t),e)}},n.handleMouseDown=function(e){n.props.dragLabel&&(e.preventDefault(),n.handleDrag(e),window.addEventListener("mousemove",n.handleDrag),window.addEventListener("mouseup",n.handleMouseUp))},n.handleMouseUp=function(){n.unbindEventListeners()},n.unbindEventListeners=function(){window.removeEventListener("mousemove",n.handleDrag),window.removeEventListener("mouseup",n.handleMouseUp)},n.state={value:String(e.value).toUpperCase(),blurValue:String(e.value).toUpperCase()},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),yle(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.input;e.value!==this.state.value&&(t===document.activeElement?this.setState({blurValue:String(e.value).toUpperCase()}):this.setState({value:String(e.value).toUpperCase(),blurValue:!this.state.blurValue&&String(e.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(e){return function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},this.props.label,e)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||1}},{key:"setUpdatedValue",value:function(e,t){var n=null!==this.props.label?this.getValueObjectWithLabel(e):e;this.props.onChange&&this.props.onChange(n,t);var r=function(e){return String(e).indexOf("%")>-1}(t.target.value);this.setState({value:r?_le(e):e})}},{key:"render",value:function(){var e=this,t=(0,wle.default)({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return xle.default.createElement("div",{style:t.wrap},xle.default.createElement("input",{style:t.input,ref:function(t){return e.input=t},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?xle.default.createElement("span",{style:t.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),t}(ble.PureComponent||ble.Component);vle.default=Sle;var Ole={},Ale={};Object.defineProperty(Ale,"__esModule",{value:!0}),Ale.calculateChange=function(e,t,n,r){e.preventDefault();var i=r.clientWidth,o=r.clientHeight,s="number"==typeof e.pageX?e.pageX:e.touches[0].pageX,a="number"==typeof e.pageY?e.pageY:e.touches[0].pageY,l=s-(r.getBoundingClientRect().left+window.pageXOffset),c=a-(r.getBoundingClientRect().top+window.pageYOffset);if("vertical"===t){var u=void 0;if(c<0)u=359;else if(c>o)u=0;else{u=360*(-100*c/o+100)/100}if(n.h!==u)return{h:u,s:n.s,l:n.l,a:n.a,source:"rgb"}}else{var h=void 0;if(l<0)h=0;else if(l>i)h=359;else{h=360*(100*l/i)/100}if(n.h!==h)return{h:h,s:n.s,l:n.l,a:n.a,source:"rgb"}}return null},Object.defineProperty(Ole,"__esModule",{value:!0}),Ole.Hue=void 0;var kle=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Mle=a.default,Tle=Nle(Mle),Ple=Nle(nae),Dle=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(Ale);function Nle(e){return e&&e.__esModule?e:{default:e}}function Rle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ile(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var jle=Ole.Hue=function(e){function t(){var e,n,r;Rle(this,t);for(var i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=r=Ile(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),r.handleChange=function(e){var t=Dle.calculateChange(e,r.props.direction,r.props.hsl,r.container);t&&"function"==typeof r.props.onChange&&r.props.onChange(t,e)},r.handleMouseDown=function(e){r.handleChange(e),window.addEventListener("mousemove",r.handleChange),window.addEventListener("mouseup",r.handleMouseUp)},r.handleMouseUp=function(){r.unbindEventListeners()},Ile(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),kle(t,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var e=this,t=this.props.direction,n=void 0===t?"horizontal":t,r=(0,Ple.default)({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:100*this.props.hsl.h/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-100*this.props.hsl.h/360+100+"%"}}},{vertical:"vertical"===n});return Tle.default.createElement("div",{style:r.hue},Tle.default.createElement("div",{className:"hue-"+n,style:r.container,ref:function(t){return e.container=t},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},Tle.default.createElement("style",null,"\n            .hue-horizontal {\n              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0\n                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n              background: -webkit-linear-gradient(to right, #f00 0%, #ff0\n                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n            }\n\n            .hue-vertical {\n              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,\n                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,\n                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n            }\n          "),Tle.default.createElement("div",{style:r.pointer},this.props.pointer?Tle.default.createElement(this.props.pointer,this.props):Tle.default.createElement("div",{style:r.slider}))))}}]),t}(Mle.PureComponent||Mle.Component);Ole.default=jle;var Lle={},Fle={exports:{}};Function.call.bind(Object.prototype.hasOwnProperty);function Gle(){}function Ble(){}Ble.resetWarningCache=Gle;Fle.exports=function(){function e(e,t,n,r,i,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Ble,resetWarningCache:Gle};return n.PropTypes=n,n}(),Object.defineProperty(Lle,"__esModule",{value:!0}),Lle.Raised=void 0;var zle=Wle(a.default),Ule=Wle(Fle.exports),Vle=Wle(nae),Hle=Wle(K$);function Wle(e){return e&&e.__esModule?e:{default:e}}var $le=Lle.Raised=function(e){var t=e.zDepth,n=e.radius,r=e.background,i=e.children,o=e.styles,s=void 0===o?{}:o,a=(0,Vle.default)((0,Hle.default)({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+t+"px "+4*t+"px rgba(0,0,0,.24)",borderRadius:n,background:r}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},s),{"zDepth-1":1===t});return zle.default.createElement("div",{style:a.wrap},zle.default.createElement("div",{style:a.bg}),zle.default.createElement("div",{style:a.content},i))};$le.propTypes={background:Ule.default.string,zDepth:Ule.default.oneOf([0,1,2,3,4,5]),radius:Ule.default.number,styles:Ule.default.object},$le.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}},Lle.default=$le;var Xle={},Yle=cne,qle=WN;var Kle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return qle(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Yle(e,t,{leading:r,maxWait:t,trailing:i})},Zle={};Object.defineProperty(Zle,"__esModule",{value:!0}),Zle.calculateChange=function(e,t,n){e.preventDefault();var r=n.getBoundingClientRect(),i=r.width,o=r.height,s="number"==typeof e.pageX?e.pageX:e.touches[0].pageX,a="number"==typeof e.pageY?e.pageY:e.touches[0].pageY,l=s-(n.getBoundingClientRect().left+window.pageXOffset),c=a-(n.getBoundingClientRect().top+window.pageYOffset);l<0?l=0:l>i?l=i:c<0?c=0:c>o&&(c=o);var u=100*l/i,h=-100*c/o+100;return{h:t.h,s:u,v:h,a:t.a,source:"rgb"}},Object.defineProperty(Xle,"__esModule",{value:!0}),Xle.Saturation=void 0;var Jle=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Qle=a.default,ece=ice(Qle),tce=ice(nae),nce=ice(Kle),rce=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(Zle);function ice(e){return e&&e.__esModule?e:{default:e}}var oce=Xle.Saturation=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=function(e){"function"==typeof n.props.onChange&&n.throttle(n.props.onChange,rce.calculateChange(e,n.props.hsl,n.container),e)},n.handleMouseDown=function(e){n.handleChange(e),window.addEventListener("mousemove",n.handleChange),window.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},n.throttle=(0,nce.default)((function(e,t,n){e(t,n)}),50),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Jle(t,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var e=this,t=this.props.style||{},n=t.color,r=t.white,i=t.black,o=t.pointer,s=t.circle,a=(0,tce.default)({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-100*this.props.hsv.v+100+"%",left:100*this.props.hsv.s+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:"0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),\n            0 0 1px 2px rgba(0,0,0,.4)",borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:n,white:r,black:i,pointer:o,circle:s}},{custom:!!this.props.style});return ece.default.createElement("div",{style:a.color,ref:function(t){return e.container=t},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},ece.default.createElement("style",null,"\n          .saturation-white {\n            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));\n            background: linear-gradient(to right, #fff, rgba(255,255,255,0));\n          }\n          .saturation-black {\n            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));\n            background: linear-gradient(to top, #000, rgba(0,0,0,0));\n          }\n        "),ece.default.createElement("div",{style:a.white,className:"saturation-white"},ece.default.createElement("div",{style:a.black,className:"saturation-black"}),ece.default.createElement("div",{style:a.pointer},this.props.pointer?ece.default.createElement(this.props.pointer,this.props):ece.default.createElement("div",{style:a.circle}))))}}]),t}(Qle.PureComponent||Qle.Component);Xle.default=oce;var sce={},ace={},lce={exports:{}};!function(e){!function(t){var n=/^\s+/,r=/\s+$/,i=0,o=t.round,s=t.min,a=t.max,l=t.random;function c(e,l){if(l=l||{},(e=e||"")instanceof c)return e;if(!(this instanceof c))return new c(e,l);var u=function(e){var i={r:0,g:0,b:0},o=1,l=null,c=null,u=null,h=!1,d=!1;"string"==typeof e&&(e=function(e){e=e.replace(n,"").replace(r,"").toLowerCase();var t,i=!1;if(A[e])e=A[e],i=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=L.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=L.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=L.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=L.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=L.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=L.hsva.exec(e))return{h:t[1],s:t[2],v:t[3],a:t[4]};if(t=L.hex8.exec(e))return{r:D(t[1]),g:D(t[2]),b:D(t[3]),a:j(t[4]),format:i?"name":"hex8"};if(t=L.hex6.exec(e))return{r:D(t[1]),g:D(t[2]),b:D(t[3]),format:i?"name":"hex"};if(t=L.hex4.exec(e))return{r:D(t[1]+""+t[1]),g:D(t[2]+""+t[2]),b:D(t[3]+""+t[3]),a:j(t[4]+""+t[4]),format:i?"name":"hex8"};if(t=L.hex3.exec(e))return{r:D(t[1]+""+t[1]),g:D(t[2]+""+t[2]),b:D(t[3]+""+t[3]),format:i?"name":"hex"};return!1}(e));"object"==typeof e&&(F(e.r)&&F(e.g)&&F(e.b)?(i=function(e,t,n){return{r:255*T(e,255),g:255*T(t,255),b:255*T(n,255)}}(e.r,e.g,e.b),h=!0,d="%"===String(e.r).substr(-1)?"prgb":"rgb"):F(e.h)&&F(e.s)&&F(e.v)?(l=R(e.s),c=R(e.v),i=function(e,n,r){e=6*T(e,360),n=T(n,100),r=T(r,100);var i=t.floor(e),o=e-i,s=r*(1-n),a=r*(1-o*n),l=r*(1-(1-o)*n),c=i%6;return{r:255*[r,a,s,s,l,r][c],g:255*[l,r,r,a,s,s][c],b:255*[s,s,l,r,r,a][c]}}(e.h,l,c),h=!0,d="hsv"):F(e.h)&&F(e.s)&&F(e.l)&&(l=R(e.s),u=R(e.l),i=function(e,t,n){var r,i,o;function s(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=T(e,360),t=T(t,100),n=T(n,100),0===t)r=i=o=n;else{var a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;r=s(l,a,e+1/3),i=s(l,a,e),o=s(l,a,e-1/3)}return{r:255*r,g:255*i,b:255*o}}(e.h,l,u),h=!0,d="hsl"),e.hasOwnProperty("a")&&(o=e.a));return o=M(o),{ok:h,format:e.format||d,r:s(255,a(i.r,0)),g:s(255,a(i.g,0)),b:s(255,a(i.b,0)),a:o}}(e);this._originalInput=e,this._r=u.r,this._g=u.g,this._b=u.b,this._a=u.a,this._roundA=o(100*this._a)/100,this._format=l.format||u.format,this._gradientType=l.gradientType,this._r<1&&(this._r=o(this._r)),this._g<1&&(this._g=o(this._g)),this._b<1&&(this._b=o(this._b)),this._ok=u.ok,this._tc_id=i++}function u(e,t,n){e=T(e,255),t=T(t,255),n=T(n,255);var r,i,o=a(e,t,n),l=s(e,t,n),c=(o+l)/2;if(o==l)r=i=0;else{var u=o-l;switch(i=c>.5?u/(2-o-l):u/(o+l),o){case e:r=(t-n)/u+(t<n?6:0);break;case t:r=(n-e)/u+2;break;case n:r=(e-t)/u+4}r/=6}return{h:r,s:i,l:c}}function h(e,t,n){e=T(e,255),t=T(t,255),n=T(n,255);var r,i,o=a(e,t,n),l=s(e,t,n),c=o,u=o-l;if(i=0===o?0:u/o,o==l)r=0;else{switch(o){case e:r=(t-n)/u+(t<n?6:0);break;case t:r=(n-e)/u+2;break;case n:r=(e-t)/u+4}r/=6}return{h:r,s:i,v:c}}function d(e,t,n,r){var i=[N(o(e).toString(16)),N(o(t).toString(16)),N(o(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function f(e,t,n,r){return[N(I(r)),N(o(e).toString(16)),N(o(t).toString(16)),N(o(n).toString(16))].join("")}function p(e,t){t=0===t?0:t||10;var n=c(e).toHsl();return n.s-=t/100,n.s=P(n.s),c(n)}function g(e,t){t=0===t?0:t||10;var n=c(e).toHsl();return n.s+=t/100,n.s=P(n.s),c(n)}function m(e){return c(e).desaturate(100)}function v(e,t){t=0===t?0:t||10;var n=c(e).toHsl();return n.l+=t/100,n.l=P(n.l),c(n)}function y(e,t){t=0===t?0:t||10;var n=c(e).toRgb();return n.r=a(0,s(255,n.r-o(-t/100*255))),n.g=a(0,s(255,n.g-o(-t/100*255))),n.b=a(0,s(255,n.b-o(-t/100*255))),c(n)}function b(e,t){t=0===t?0:t||10;var n=c(e).toHsl();return n.l-=t/100,n.l=P(n.l),c(n)}function x(e,t){var n=c(e).toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,c(n)}function w(e){var t=c(e).toHsl();return t.h=(t.h+180)%360,c(t)}function C(e){var t=c(e).toHsl(),n=t.h;return[c(e),c({h:(n+120)%360,s:t.s,l:t.l}),c({h:(n+240)%360,s:t.s,l:t.l})]}function E(e){var t=c(e).toHsl(),n=t.h;return[c(e),c({h:(n+90)%360,s:t.s,l:t.l}),c({h:(n+180)%360,s:t.s,l:t.l}),c({h:(n+270)%360,s:t.s,l:t.l})]}function _(e){var t=c(e).toHsl(),n=t.h;return[c(e),c({h:(n+72)%360,s:t.s,l:t.l}),c({h:(n+216)%360,s:t.s,l:t.l})]}function S(e,t,n){t=t||6,n=n||30;var r=c(e).toHsl(),i=360/n,o=[c(e)];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,o.push(c(r));return o}function O(e,t){t=t||6;for(var n=c(e).toHsv(),r=n.h,i=n.s,o=n.v,s=[],a=1/t;t--;)s.push(c({h:r,s:i,v:o})),o=(o+a)%1;return s}c.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,n,r,i=this.toRgb();return e=i.r/255,n=i.g/255,r=i.b/255,.2126*(e<=.03928?e/12.92:t.pow((e+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:t.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:t.pow((r+.055)/1.055,2.4))},setAlpha:function(e){return this._a=M(e),this._roundA=o(100*this._a)/100,this},toHsv:function(){var e=h(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=h(this._r,this._g,this._b),t=o(360*e.h),n=o(100*e.s),r=o(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=u(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=u(this._r,this._g,this._b),t=o(360*e.h),n=o(100*e.s),r=o(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return d(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,n,r,i){var s=[N(o(e).toString(16)),N(o(t).toString(16)),N(o(n).toString(16)),N(I(r))];if(i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1))return s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0);return s.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:o(this._r),g:o(this._g),b:o(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+o(this._r)+", "+o(this._g)+", "+o(this._b)+")":"rgba("+o(this._r)+", "+o(this._g)+", "+o(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:o(100*T(this._r,255))+"%",g:o(100*T(this._g,255))+"%",b:o(100*T(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+o(100*T(this._r,255))+"%, "+o(100*T(this._g,255))+"%, "+o(100*T(this._b,255))+"%)":"rgba("+o(100*T(this._r,255))+"%, "+o(100*T(this._g,255))+"%, "+o(100*T(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(k[d(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+f(this._r,this._g,this._b,this._a),n=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var i=c(e);n="#"+f(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,r=this._a<1&&this._a>=0;return t||!r||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return c(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(v,arguments)},brighten:function(){return this._applyModification(y,arguments)},darken:function(){return this._applyModification(b,arguments)},desaturate:function(){return this._applyModification(p,arguments)},saturate:function(){return this._applyModification(g,arguments)},greyscale:function(){return this._applyModification(m,arguments)},spin:function(){return this._applyModification(x,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(S,arguments)},complement:function(){return this._applyCombination(w,arguments)},monochromatic:function(){return this._applyCombination(O,arguments)},splitcomplement:function(){return this._applyCombination(_,arguments)},triad:function(){return this._applyCombination(C,arguments)},tetrad:function(){return this._applyCombination(E,arguments)}},c.fromRatio=function(e,t){if("object"==typeof e){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]="a"===r?e[r]:R(e[r]));e=n}return c(e,t)},c.equals=function(e,t){return!(!e||!t)&&c(e).toRgbString()==c(t).toRgbString()},c.random=function(){return c.fromRatio({r:l(),g:l(),b:l()})},c.mix=function(e,t,n){n=0===n?0:n||50;var r=c(e).toRgb(),i=c(t).toRgb(),o=n/100;return c({r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a})},c.readability=function(e,n){var r=c(e),i=c(n);return(t.max(r.getLuminance(),i.getLuminance())+.05)/(t.min(r.getLuminance(),i.getLuminance())+.05)},c.isReadable=function(e,t,n){var r,i,o=c.readability(e,t);switch(i=!1,r=function(e){var t,n;t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase(),n=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA");"small"!==n&&"large"!==n&&(n="small");return{level:t,size:n}}(n),r.level+r.size){case"AAsmall":case"AAAlarge":i=o>=4.5;break;case"AAlarge":i=o>=3;break;case"AAAsmall":i=o>=7}return i},c.mostReadable=function(e,t,n){var r,i,o,s,a=null,l=0;i=(n=n||{}).includeFallbackColors,o=n.level,s=n.size;for(var u=0;u<t.length;u++)(r=c.readability(e,t[u]))>l&&(l=r,a=c(t[u]));return c.isReadable(e,a,{level:o,size:s})||!i?a:(n.includeFallbackColors=!1,c.mostReadable(e,["#fff","#000"],n))};var A=c.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},k=c.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(A);function M(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function T(e,n){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var r=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=s(n,a(0,parseFloat(e))),r&&(e=parseInt(e*n,10)/100),t.abs(e-n)<1e-6?1:e%n/parseFloat(n)}function P(e){return s(1,a(0,e))}function D(e){return parseInt(e,16)}function N(e){return 1==e.length?"0"+e:""+e}function R(e){return e<=1&&(e=100*e+"%"),e}function I(e){return t.round(255*parseFloat(e)).toString(16)}function j(e){return D(e)/255}var L=function(){var e="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",t="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",n="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?";return{CSS_UNIT:new RegExp(e),rgb:new RegExp("rgb"+t),rgba:new RegExp("rgba"+n),hsl:new RegExp("hsl"+t),hsla:new RegExp("hsla"+n),hsv:new RegExp("hsv"+t),hsva:new RegExp("hsva"+n),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function F(e){return!!L.CSS_UNIT.exec(e)}e.exports?e.exports=c:window.tinycolor=c}(Math)}(lce),Object.defineProperty(ace,"__esModule",{value:!0}),ace.red=void 0;var cce=hce(pG),uce=hce(lce.exports);function hce(e){return e&&e.__esModule?e:{default:e}}ace.default={simpleCheckForValidColor:function(e){var t=0,n=0;return(0,cce.default)(["r","g","b","a","h","s","l","v"],(function(r){if(e[r]&&(t+=1,isNaN(e[r])||(n+=1),"s"===r||"l"===r)){/^\d+%$/.test(e[r])&&(n+=1)}})),t===n&&e},toState:function(e,t){var n=e.hex?(0,uce.default)(e.hex):(0,uce.default)(e),r=n.toHsl(),i=n.toHsv(),o=n.toRgb(),s=n.toHex();return 0===r.s&&(r.h=t||0,i.h=t||0),{hsl:r,hex:"000000"===s&&0===o.a?"transparent":"#"+s,rgb:o,hsv:i,oldHue:e.h||t||r.h,source:e.source}},isValidHex:function(e){var t="#"===String(e).charAt(0)?1:0;return e.length!==4+t&&e.length<7+t&&(0,uce.default)(e).isValid()},getContrastingColor:function(e){if(!e)return"#fff";var t=this.toState(e);return"transparent"===t.hex?"rgba(0,0,0,0.4)":(299*t.rgb.r+587*t.rgb.g+114*t.rgb.b)/1e3>=128?"#000":"#fff"}},ace.red={hsl:{a:1,h:0,l:.5,s:1},hex:"#ff0000",rgb:{r:255,g:0,b:0,a:1},hsv:{h:0,s:1,v:1,a:1}},Object.defineProperty(sce,"__esModule",{value:!0}),sce.ColorWrap=void 0;var dce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fce=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),pce=a.default,gce=yce(pce),mce=yce(cne),vce=yce(ace);function yce(e){return e&&e.__esModule?e:{default:e}}var bce=sce.ColorWrap=function(e){var t=function(t){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.handleChange=function(e,n){if(vce.default.simpleCheckForValidColor(e)){var r=vce.default.toState(e,e.h||t.state.oldHue);t.setState(r),t.props.onChangeComplete&&t.debounce(t.props.onChangeComplete,r,n),t.props.onChange&&t.props.onChange(r,n)}},t.handleSwatchHover=function(e,n){if(vce.default.simpleCheckForValidColor(e)){var r=vce.default.toState(e,e.h||t.state.oldHue);t.setState(r),t.props.onSwatchHover&&t.props.onSwatchHover(r,n)}},t.state=dce({},vce.default.toState(e.color,0)),t.debounce=(0,mce.default)((function(e,t,n){e(t,n)}),100),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,t),fce(n,[{key:"componentWillReceiveProps",value:function(e){this.setState(dce({},vce.default.toState(e.color,this.state.oldHue)))}},{key:"render",value:function(){var t={};return this.props.onSwatchHover&&(t.onSwatchHover=this.handleSwatchHover),gce.default.createElement(e,dce({},this.props,this.state,{onChange:this.handleChange},t))}}]),n}(pce.PureComponent||pce.Component);return t.propTypes=dce({},e.propTypes),t.defaultProps=dce({},e.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),t};sce.default=bce;var xce={},wce={};Object.defineProperty(wce,"__esModule",{value:!0}),wce.handleFocus=void 0;var Cce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ece=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_ce=function(e){return e&&e.__esModule?e:{default:e}}(a.default);function Sce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oce(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Ace(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}wce.handleFocus=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(n){function r(){var e,t,n;Sce(this,r);for(var i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];return t=n=Oce(this,(e=r.__proto__||Object.getPrototypeOf(r)).call.apply(e,[this].concat(o))),n.state={focus:!1},n.handleFocus=function(){return n.setState({focus:!0})},n.handleBlur=function(){return n.setState({focus:!1})},Oce(n,t)}return Ace(r,n),Ece(r,[{key:"render",value:function(){return _ce.default.createElement(t,{onFocus:this.handleFocus,onBlur:this.handleBlur},_ce.default.createElement(e,Cce({},this.props,this.state)))}}]),r}(_ce.default.Component)},Object.defineProperty(xce,"__esModule",{value:!0}),xce.Swatch=void 0;var kce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mce=Nce(a.default),Tce=Nce(nae),Pce=wce,Dce=Nce(Zae);function Nce(e){return e&&e.__esModule?e:{default:e}}var Rce=xce.Swatch=function(e){var t=e.color,n=e.style,r=e.onClick,i=void 0===r?function(){}:r,o=e.onHover,s=e.title,a=void 0===s?t:s,l=e.children,c=e.focus,u=e.focusStyle,h=void 0===u?{}:u,d="transparent"===t,f=(0,Tce.default)({default:{swatch:kce({background:t,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},n,c?h:{})}}),p={};return o&&(p.onMouseOver=function(e){return o(t,e)}),Mce.default.createElement("div",kce({style:f.swatch,onClick:function(e){return i(t,e)},title:a,tabIndex:0,onKeyDown:function(e){return 13===e.keyCode&&i(t,e)}},p),l,d&&Mce.default.createElement(Dce.default,{borderRadius:f.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};xce.default=(0,Pce.handleFocus)(Rce),function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=qae;Object.defineProperty(e,"Alpha",{enumerable:!0,get:function(){return c(t).default}});var n=Zae;Object.defineProperty(e,"Checkboard",{enumerable:!0,get:function(){return c(n).default}});var r=vle;Object.defineProperty(e,"EditableInput",{enumerable:!0,get:function(){return c(r).default}});var i=Ole;Object.defineProperty(e,"Hue",{enumerable:!0,get:function(){return c(i).default}});var o=Lle;Object.defineProperty(e,"Raised",{enumerable:!0,get:function(){return c(o).default}});var s=Xle;Object.defineProperty(e,"Saturation",{enumerable:!0,get:function(){return c(s).default}});var a=sce;Object.defineProperty(e,"ColorWrap",{enumerable:!0,get:function(){return c(a).default}});var l=xce;function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"Swatch",{enumerable:!0,get:function(){return c(l).default}})}(Yae);var Ice={};Object.defineProperty(Ice,"__esModule",{value:!0}),Ice.AlphaPointer=void 0;var jce=Fce(a.default),Lce=Fce(nae);function Fce(e){return e&&e.__esModule?e:{default:e}}var Gce=Ice.AlphaPointer=function(e){var t=e.direction,n=(0,Lce.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:"vertical"===t});return jce.default.createElement("div",{style:n.picker})};Ice.default=Gce,Object.defineProperty(tae,"__esModule",{value:!0}),tae.AlphaPicker=void 0;var Bce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zce=Wce(a.default),Uce=Wce(nae),Vce=Yae,Hce=Wce(Ice);function Wce(e){return e&&e.__esModule?e:{default:e}}var $ce=tae.AlphaPicker=function(e){var t=e.rgb,n=e.hsl,r=e.width,i=e.height,o=e.onChange,s=e.direction,a=e.style,l=e.renderers,c=e.pointer,u=e.className,h=void 0===u?"":u,d=(0,Uce.default)({default:{picker:{position:"relative",width:r,height:i},alpha:{radius:"2px",style:a}}});return zce.default.createElement("div",{style:d.picker,className:"alpha-picker "+h},zce.default.createElement(Vce.Alpha,Bce({},d.alpha,{rgb:t,hsl:n,pointer:c,renderers:l,onChange:o,direction:s})))};$ce.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:Hce.default},tae.default=(0,Vce.ColorWrap)($ce);var Xce={},Yce={};Object.defineProperty(Yce,"__esModule",{value:!0}),Yce.BlockSwatches=void 0;var qce=Qce(a.default),Kce=Qce(nae),Zce=Qce(sU),Jce=Yae;function Qce(e){return e&&e.__esModule?e:{default:e}}var eue=Yce.BlockSwatches=function(e){var t=e.colors,n=e.onClick,r=e.onSwatchHover,i=(0,Kce.default)({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return qce.default.createElement("div",{style:i.swatches},(0,Zce.default)(t,(function(e){return qce.default.createElement(Jce.Swatch,{key:e,color:e,style:i.swatch,onClick:n,onHover:r,focusStyle:{boxShadow:"0 0 4px "+e}})})),qce.default.createElement("div",{style:i.clear}))};Yce.default=eue,Object.defineProperty(Xce,"__esModule",{value:!0}),Xce.Block=void 0;var tue=lue(a.default),nue=lue(Fle.exports),rue=lue(nae),iue=lue(K$),oue=lue(ace),sue=Yae,aue=lue(Yce);function lue(e){return e&&e.__esModule?e:{default:e}}var cue=Xce.Block=function(e){var t=e.onChange,n=e.onSwatchHover,r=e.hex,i=e.colors,o=e.width,s=e.triangle,a=e.styles,l=void 0===a?{}:a,c=e.className,u=void 0===c?"":c,h="transparent"===r,d=function(e,n){oue.default.isValidHex(e)&&t({hex:e,source:"hex"},n)},f=(0,rue.default)((0,iue.default)({default:{card:{width:o,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:r,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:oue.default.getContrastingColor(r),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+r+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},l),{"hide-triangle":"hide"===s});return tue.default.createElement("div",{style:f.card,className:"block-picker "+u},tue.default.createElement("div",{style:f.triangle}),tue.default.createElement("div",{style:f.head},h&&tue.default.createElement(sue.Checkboard,{borderRadius:"6px 6px 0 0"}),tue.default.createElement("div",{style:f.label},r)),tue.default.createElement("div",{style:f.body},tue.default.createElement(aue.default,{colors:i,onClick:d,onSwatchHover:n}),tue.default.createElement(sue.EditableInput,{style:{input:f.input},value:r,onChange:d})))};cue.propTypes={width:nue.default.oneOfType([nue.default.string,nue.default.number]),colors:nue.default.arrayOf(nue.default.string),triangle:nue.default.oneOf(["top","hide"]),styles:nue.default.object},cue.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}},Xce.default=(0,sue.ColorWrap)(cue);var uue={},hue={exports:{}};!function(e,t){e.exports={red:{50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",a100:"#ff8a80",a200:"#ff5252",a400:"#ff1744",a700:"#d50000"},pink:{50:"#fce4ec",100:"#f8bbd0",200:"#f48fb1",300:"#f06292",400:"#ec407a",500:"#e91e63",600:"#d81b60",700:"#c2185b",800:"#ad1457",900:"#880e4f",a100:"#ff80ab",a200:"#ff4081",a400:"#f50057",a700:"#c51162"},purple:{50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",a100:"#ea80fc",a200:"#e040fb",a400:"#d500f9",a700:"#aa00ff"},deepPurple:{50:"#ede7f6",100:"#d1c4e9",200:"#b39ddb",300:"#9575cd",400:"#7e57c2",500:"#673ab7",600:"#5e35b1",700:"#512da8",800:"#4527a0",900:"#311b92",a100:"#b388ff",a200:"#7c4dff",a400:"#651fff",a700:"#6200ea"},indigo:{50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",a100:"#8c9eff",a200:"#536dfe",a400:"#3d5afe",a700:"#304ffe"},blue:{50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",a100:"#82b1ff",a200:"#448aff",a400:"#2979ff",a700:"#2962ff"},lightBlue:{50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",a100:"#80d8ff",a200:"#40c4ff",a400:"#00b0ff",a700:"#0091ea"},cyan:{50:"#e0f7fa",100:"#b2ebf2",200:"#80deea",300:"#4dd0e1",400:"#26c6da",500:"#00bcd4",600:"#00acc1",700:"#0097a7",800:"#00838f",900:"#006064",a100:"#84ffff",a200:"#18ffff",a400:"#00e5ff",a700:"#00b8d4"},teal:{50:"#e0f2f1",100:"#b2dfdb",200:"#80cbc4",300:"#4db6ac",400:"#26a69a",500:"#009688",600:"#00897b",700:"#00796b",800:"#00695c",900:"#004d40",a100:"#a7ffeb",a200:"#64ffda",a400:"#1de9b6",a700:"#00bfa5"},green:{50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",a100:"#b9f6ca",a200:"#69f0ae",a400:"#00e676",a700:"#00c853"},lightGreen:{50:"#f1f8e9",100:"#dcedc8",200:"#c5e1a5",300:"#aed581",400:"#9ccc65",500:"#8bc34a",600:"#7cb342",700:"#689f38",800:"#558b2f",900:"#33691e",a100:"#ccff90",a200:"#b2ff59",a400:"#76ff03",a700:"#64dd17"},lime:{50:"#f9fbe7",100:"#f0f4c3",200:"#e6ee9c",300:"#dce775",400:"#d4e157",500:"#cddc39",600:"#c0ca33",700:"#afb42b",800:"#9e9d24",900:"#827717",a100:"#f4ff81",a200:"#eeff41",a400:"#c6ff00",a700:"#aeea00"},yellow:{50:"#fffde7",100:"#fff9c4",200:"#fff59d",300:"#fff176",400:"#ffee58",500:"#ffeb3b",600:"#fdd835",700:"#fbc02d",800:"#f9a825",900:"#f57f17",a100:"#ffff8d",a200:"#ffff00",a400:"#ffea00",a700:"#ffd600"},amber:{50:"#fff8e1",100:"#ffecb3",200:"#ffe082",300:"#ffd54f",400:"#ffca28",500:"#ffc107",600:"#ffb300",700:"#ffa000",800:"#ff8f00",900:"#ff6f00",a100:"#ffe57f",a200:"#ffd740",a400:"#ffc400",a700:"#ffab00"},orange:{50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",a100:"#ffd180",a200:"#ffab40",a400:"#ff9100",a700:"#ff6d00"},deepOrange:{50:"#fbe9e7",100:"#ffccbc",200:"#ffab91",300:"#ff8a65",400:"#ff7043",500:"#ff5722",600:"#f4511e",700:"#e64a19",800:"#d84315",900:"#bf360c",a100:"#ff9e80",a200:"#ff6e40",a400:"#ff3d00",a700:"#dd2c00"},brown:{50:"#efebe9",100:"#d7ccc8",200:"#bcaaa4",300:"#a1887f",400:"#8d6e63",500:"#795548",600:"#6d4c41",700:"#5d4037",800:"#4e342e",900:"#3e2723"},grey:{50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121"},blueGrey:{50:"#eceff1",100:"#cfd8dc",200:"#b0bec5",300:"#90a4ae",400:"#78909c",500:"#607d8b",600:"#546e7a",700:"#455a64",800:"#37474f",900:"#263238"},darkText:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",dividers:"rgba(0, 0, 0, 0.12)"},lightText:{primary:"rgba(255, 255, 255, 1)",secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",dividers:"rgba(255, 255, 255, 0.12)"},darkIcons:{active:"rgba(0, 0, 0, 0.54)",inactive:"rgba(0, 0, 0, 0.38)"},lightIcons:{active:"rgba(255, 255, 255, 1)",inactive:"rgba(255, 255, 255, 0.5)"},white:"#ffffff",black:"#000000"}}(hue);var due={};Object.defineProperty(due,"__esModule",{value:!0}),due.CircleSwatch=void 0;var fue=vue(a.default),pue=nae,gue=vue(pue),mue=Yae;function vue(e){return e&&e.__esModule?e:{default:e}}var yue=due.CircleSwatch=function(e){var t=e.color,n=e.onClick,r=e.onSwatchHover,i=e.hover,o=e.active,s=e.circleSize,a=e.circleSpacing,l=(0,gue.default)({default:{swatch:{width:s,height:s,marginRight:a,marginBottom:a,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+s/2+"px "+t,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+t}}},{hover:i,active:o});return fue.default.createElement("div",{style:l.swatch},fue.default.createElement(mue.Swatch,{style:l.Swatch,color:t,onClick:n,onHover:r,focusStyle:{boxShadow:l.Swatch.boxShadow+", 0 0 5px "+t}}))};yue.defaultProps={circleSize:28,circleSpacing:14},due.default=(0,pue.handleHover)(yue),Object.defineProperty(uue,"__esModule",{value:!0}),uue.Circle=void 0;var bue=Aue(a.default),xue=Aue(Fle.exports),wue=Aue(nae),Cue=Aue(sU),Eue=Aue(K$),_ue=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(hue.exports),Sue=Yae,Oue=Aue(due);function Aue(e){return e&&e.__esModule?e:{default:e}}var kue=uue.Circle=function(e){var t=e.width,n=e.onChange,r=e.onSwatchHover,i=e.colors,o=e.hex,s=e.circleSize,a=e.styles,l=void 0===a?{}:a,c=e.circleSpacing,u=e.className,h=void 0===u?"":u,d=(0,wue.default)((0,Eue.default)({default:{card:{width:t,display:"flex",flexWrap:"wrap",marginRight:-c,marginBottom:-c}}},l)),f=function(e,t){return n({hex:e,source:"hex"},t)};return bue.default.createElement("div",{style:d.card,className:"circle-picker "+h},(0,Cue.default)(i,(function(e){return bue.default.createElement(Oue.default,{key:e,color:e,onClick:f,onSwatchHover:r,active:o===e.toLowerCase(),circleSize:s,circleSpacing:c})})))};kue.propTypes={width:xue.default.oneOfType([xue.default.string,xue.default.number]),circleSize:xue.default.number,circleSpacing:xue.default.number,styles:xue.default.object},kue.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[_ue.red[500],_ue.pink[500],_ue.purple[500],_ue.deepPurple[500],_ue.indigo[500],_ue.blue[500],_ue.lightBlue[500],_ue.cyan[500],_ue.teal[500],_ue.green[500],_ue.lightGreen[500],_ue.lime[500],_ue.yellow[500],_ue.amber[500],_ue.orange[500],_ue.deepOrange[500],_ue.brown[500],_ue.blueGrey[500]],styles:{}},uue.default=(0,Sue.ColorWrap)(kue);var Mue={},Tue={},Pue={};Object.defineProperty(Pue,"__esModule",{value:!0});var Due=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Nue=function(e){return e&&e.__esModule?e:{default:e}}(a.default);Pue.default=function(e){var t=e.fill,n=void 0===t?"currentColor":t,r=e.width,i=void 0===r?24:r,o=e.height,s=void 0===o?24:o,a=e.style,l=void 0===a?{}:a,c=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["fill","width","height","style"]);return Nue.default.createElement("svg",Due({viewBox:"0 0 24 24",style:Due({fill:n,width:i,height:s},l)},c),Nue.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))},Object.defineProperty(Tue,"__esModule",{value:!0}),Tue.ChromeFields=void 0;var Rue=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Iue=Bue(a.default),jue=Bue(nae),Lue=Bue(ace),Fue=Yae,Gue=Bue(Pue);function Bue(e){return e&&e.__esModule?e:{default:e}}function zue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uue(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Vue=Tue.ChromeFields=function(e){function t(){var e,n,r;zue(this,t);for(var i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=r=Uue(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),r.state={view:""},r.toggleViews=function(){"hex"===r.state.view?r.setState({view:"rgb"}):"rgb"===r.state.view?r.setState({view:"hsl"}):"hsl"===r.state.view&&(1===r.props.hsl.a?r.setState({view:"hex"}):r.setState({view:"rgb"}))},r.handleChange=function(e,t){e.hex?Lue.default.isValidHex(e.hex)&&r.props.onChange({hex:e.hex,source:"hex"},t):e.r||e.g||e.b?r.props.onChange({r:e.r||r.props.rgb.r,g:e.g||r.props.rgb.g,b:e.b||r.props.rgb.b,source:"rgb"},t):e.a?(e.a<0?e.a=0:e.a>1&&(e.a=1),r.props.onChange({h:r.props.hsl.h,s:r.props.hsl.s,l:r.props.hsl.l,a:Math.round(100*e.a)/100,source:"rgb"},t)):(e.h||e.s||e.l)&&("string"==typeof e.s&&e.s.includes("%")&&(e.s=e.s.replace("%","")),"string"==typeof e.l&&e.l.includes("%")&&(e.l=e.l.replace("%","")),r.props.onChange({h:e.h||r.props.hsl.h,s:Number(e.s&&e.s||r.props.hsl.s),l:Number(e.l&&e.l||r.props.hsl.l),source:"hsl"},t))},r.showHighlight=function(e){e.currentTarget.style.background="#eee"},r.hideHighlight=function(e){e.currentTarget.style.background="transparent"},Uue(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Rue(t,[{key:"componentDidMount",value:function(){1===this.props.hsl.a&&"hex"!==this.state.view?this.setState({view:"hex"}):"rgb"!==this.state.view&&"hsl"!==this.state.view&&this.setState({view:"rgb"})}},{key:"componentWillReceiveProps",value:function(e){1!==e.hsl.a&&"hex"===this.state.view&&this.setState({view:"rgb"})}},{key:"render",value:function(){var e=this,t=(0,jue.default)({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),n=void 0;return"hex"===this.state.view?n=Iue.default.createElement("div",{style:t.fields,className:"flexbox-fix"},Iue.default.createElement("div",{style:t.field},Iue.default.createElement(Fue.EditableInput,{style:{input:t.input,label:t.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):"rgb"===this.state.view?n=Iue.default.createElement("div",{style:t.fields,className:"flexbox-fix"},Iue.default.createElement("div",{style:t.field},Iue.default.createElement(Fue.EditableInput,{style:{input:t.input,label:t.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),Iue.default.createElement("div",{style:t.field},Iue.default.createElement(Fue.EditableInput,{style:{input:t.input,label:t.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),Iue.default.createElement("div",{style:t.field},Iue.default.createElement(Fue.EditableInput,{style:{input:t.input,label:t.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),Iue.default.createElement("div",{style:t.alpha},Iue.default.createElement(Fue.EditableInput,{style:{input:t.input,label:t.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):"hsl"===this.state.view&&(n=Iue.default.createElement("div",{style:t.fields,className:"flexbox-fix"},Iue.default.createElement("div",{style:t.field},Iue.default.createElement(Fue.EditableInput,{style:{input:t.input,label:t.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),Iue.default.createElement("div",{style:t.field},Iue.default.createElement(Fue.EditableInput,{style:{input:t.input,label:t.label},label:"s",value:Math.round(100*this.props.hsl.s)+"%",onChange:this.handleChange})),Iue.default.createElement("div",{style:t.field},Iue.default.createElement(Fue.EditableInput,{style:{input:t.input,label:t.label},label:"l",value:Math.round(100*this.props.hsl.l)+"%",onChange:this.handleChange})),Iue.default.createElement("div",{style:t.alpha},Iue.default.createElement(Fue.EditableInput,{style:{input:t.input,label:t.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),Iue.default.createElement("div",{style:t.wrap,className:"flexbox-fix"},n,Iue.default.createElement("div",{style:t.toggle},Iue.default.createElement("div",{style:t.icon,onClick:this.toggleViews,ref:function(t){return e.icon=t}},Iue.default.createElement(Gue.default,{style:t.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}]),t}(Iue.default.Component);Tue.default=Vue;var Hue={};Object.defineProperty(Hue,"__esModule",{value:!0}),Hue.ChromePointer=void 0;var Wue=Xue(a.default),$ue=Xue(nae);function Xue(e){return e&&e.__esModule?e:{default:e}}var Yue=Hue.ChromePointer=function(){var e=(0,$ue.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return Wue.default.createElement("div",{style:e.picker})};Hue.default=Yue;var que={};Object.defineProperty(que,"__esModule",{value:!0}),que.ChromePointerCircle=void 0;var Kue=Jue(a.default),Zue=Jue(nae);function Jue(e){return e&&e.__esModule?e:{default:e}}var Que=que.ChromePointerCircle=function(){var e=(0,Zue.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return Kue.default.createElement("div",{style:e.picker})};que.default=Que,Object.defineProperty(Mue,"__esModule",{value:!0}),Mue.Chrome=void 0;var ehe=lhe(a.default),the=lhe(Fle.exports),nhe=lhe(nae),rhe=lhe(K$),ihe=Yae,ohe=lhe(Tue),she=lhe(Hue),ahe=lhe(que);function lhe(e){return e&&e.__esModule?e:{default:e}}var che=Mue.Chrome=function(e){var t=e.width,n=e.onChange,r=e.disableAlpha,i=e.rgb,o=e.hsl,s=e.hsv,a=e.hex,l=e.renderers,c=e.styles,u=void 0===c?{}:c,h=e.className,d=void 0===h?"":h,f=(0,nhe.default)((0,rhe.default)({default:{picker:{width:t,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+i.r+", "+i.g+", "+i.b+", "+i.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},u),{disableAlpha:r});return ehe.default.createElement("div",{style:f.picker,className:"chrome-picker "+d},ehe.default.createElement("div",{style:f.saturation},ehe.default.createElement(ihe.Saturation,{style:f.Saturation,hsl:o,hsv:s,pointer:ahe.default,onChange:n})),ehe.default.createElement("div",{style:f.body},ehe.default.createElement("div",{style:f.controls,className:"flexbox-fix"},ehe.default.createElement("div",{style:f.color},ehe.default.createElement("div",{style:f.swatch},ehe.default.createElement("div",{style:f.active}),ehe.default.createElement(ihe.Checkboard,{renderers:l}))),ehe.default.createElement("div",{style:f.toggles},ehe.default.createElement("div",{style:f.hue},ehe.default.createElement(ihe.Hue,{style:f.Hue,hsl:o,pointer:she.default,onChange:n})),ehe.default.createElement("div",{style:f.alpha},ehe.default.createElement(ihe.Alpha,{style:f.Alpha,rgb:i,hsl:o,pointer:she.default,renderers:l,onChange:n})))),ehe.default.createElement(ohe.default,{rgb:i,hsl:o,hex:a,onChange:n,disableAlpha:r})))};che.propTypes={width:the.default.oneOfType([the.default.string,the.default.number]),disableAlpha:the.default.bool,styles:the.default.object},che.defaultProps={width:225,disableAlpha:!1,styles:{}},Mue.default=(0,ihe.ColorWrap)(che);var uhe={},hhe={};Object.defineProperty(hhe,"__esModule",{value:!0}),hhe.CompactColor=void 0;var dhe=mhe(a.default),fhe=mhe(nae),phe=mhe(ace),ghe=Yae;function mhe(e){return e&&e.__esModule?e:{default:e}}var vhe=hhe.CompactColor=function(e){var t=e.color,n=e.onClick,r=void 0===n?function(){}:n,i=e.onSwatchHover,o=e.active,s=(0,fhe.default)({default:{color:{background:t,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:phe.default.getContrastingColor(t),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:o,"color-#FFFFFF":"#FFFFFF"===t,transparent:"transparent"===t});return dhe.default.createElement(ghe.Swatch,{style:s.color,color:t,onClick:r,onHover:i,focusStyle:{boxShadow:"0 0 4px "+t}},dhe.default.createElement("div",{style:s.dot}))};hhe.default=vhe;var yhe={};Object.defineProperty(yhe,"__esModule",{value:!0}),yhe.CompactFields=void 0;var bhe=Che(a.default),xhe=Che(nae),whe=Yae;function Che(e){return e&&e.__esModule?e:{default:e}}var Ehe=yhe.CompactFields=function(e){var t=e.hex,n=e.rgb,r=e.onChange,i=(0,xhe.default)({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:t},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),o=function(e,t){e.r||e.g||e.b?r({r:e.r||n.r,g:e.g||n.g,b:e.b||n.b,source:"rgb"},t):r({hex:e.hex,source:"hex"},t)};return bhe.default.createElement("div",{style:i.fields,className:"flexbox-fix"},bhe.default.createElement("div",{style:i.active}),bhe.default.createElement(whe.EditableInput,{style:{wrap:i.HEXwrap,input:i.HEXinput,label:i.HEXlabel},label:"hex",value:t,onChange:o}),bhe.default.createElement(whe.EditableInput,{style:{wrap:i.RGBwrap,input:i.RGBinput,label:i.RGBlabel},label:"r",value:n.r,onChange:o}),bhe.default.createElement(whe.EditableInput,{style:{wrap:i.RGBwrap,input:i.RGBinput,label:i.RGBlabel},label:"g",value:n.g,onChange:o}),bhe.default.createElement(whe.EditableInput,{style:{wrap:i.RGBwrap,input:i.RGBinput,label:i.RGBlabel},label:"b",value:n.b,onChange:o}))};yhe.default=Ehe,Object.defineProperty(uhe,"__esModule",{value:!0}),uhe.Compact=void 0;var _he=Nhe(a.default),She=Nhe(Fle.exports),Ohe=Nhe(nae),Ahe=Nhe(sU),khe=Nhe(K$),Mhe=Nhe(ace),The=Yae,Phe=Nhe(hhe),Dhe=Nhe(yhe);function Nhe(e){return e&&e.__esModule?e:{default:e}}var Rhe=uhe.Compact=function(e){var t=e.onChange,n=e.onSwatchHover,r=e.colors,i=e.hex,o=e.rgb,s=e.styles,a=void 0===s?{}:s,l=e.className,c=void 0===l?"":l,u=(0,Ohe.default)((0,khe.default)({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},a)),h=function(e,n){e.hex?Mhe.default.isValidHex(e.hex)&&t({hex:e.hex,source:"hex"},n):t(e,n)};return _he.default.createElement(The.Raised,{style:u.Compact,styles:a},_he.default.createElement("div",{style:u.compact,className:"compact-picker "+c},_he.default.createElement("div",null,(0,Ahe.default)(r,(function(e){return _he.default.createElement(Phe.default,{key:e,color:e,active:e.toLowerCase()===i,onClick:h,onSwatchHover:n})})),_he.default.createElement("div",{style:u.clear})),_he.default.createElement(Dhe.default,{hex:i,rgb:o,onChange:h})))};Rhe.propTypes={colors:She.default.arrayOf(She.default.string),styles:She.default.object},Rhe.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}},uhe.default=(0,The.ColorWrap)(Rhe);var Ihe={},jhe={};Object.defineProperty(jhe,"__esModule",{value:!0}),jhe.GithubSwatch=void 0;var Lhe=zhe(a.default),Fhe=nae,Ghe=zhe(Fhe),Bhe=Yae;function zhe(e){return e&&e.__esModule?e:{default:e}}var Uhe=jhe.GithubSwatch=function(e){var t=e.hover,n=e.color,r=e.onClick,i=e.onSwatchHover,o={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},s=(0,Ghe.default)({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:o}},{hover:t});return Lhe.default.createElement("div",{style:s.swatch},Lhe.default.createElement(Bhe.Swatch,{color:n,onClick:r,onHover:i,focusStyle:o}))};jhe.default=(0,Fhe.handleHover)(Uhe),Object.defineProperty(Ihe,"__esModule",{value:!0}),Ihe.Github=void 0;var Vhe=Khe(a.default),Hhe=Khe(Fle.exports),Whe=Khe(nae),$he=Khe(sU),Xhe=Khe(K$),Yhe=Yae,qhe=Khe(jhe);function Khe(e){return e&&e.__esModule?e:{default:e}}var Zhe=Ihe.Github=function(e){var t=e.width,n=e.colors,r=e.onChange,i=e.onSwatchHover,o=e.triangle,s=e.styles,a=void 0===s?{}:s,l=e.className,c=void 0===l?"":l,u=(0,Whe.default)((0,Xhe.default)({default:{card:{width:t,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},a),{"hide-triangle":"hide"===o,"top-left-triangle":"top-left"===o,"top-right-triangle":"top-right"===o,"bottom-left-triangle":"bottom-left"===o,"bottom-right-triangle":"bottom-right"===o}),h=function(e,t){return r({hex:e,source:"hex"},t)};return Vhe.default.createElement("div",{style:u.card,className:"github-picker "+c},Vhe.default.createElement("div",{style:u.triangleShadow}),Vhe.default.createElement("div",{style:u.triangle}),(0,$he.default)(n,(function(e){return Vhe.default.createElement(qhe.default,{color:e,key:e,onClick:h,onSwatchHover:i})})))};Zhe.propTypes={width:Hhe.default.oneOfType([Hhe.default.string,Hhe.default.number]),colors:Hhe.default.arrayOf(Hhe.default.string),triangle:Hhe.default.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:Hhe.default.object},Zhe.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}},Ihe.default=(0,Yhe.ColorWrap)(Zhe);var Jhe={},Qhe={};Object.defineProperty(Qhe,"__esModule",{value:!0}),Qhe.SliderPointer=void 0;var ede=nde(a.default),tde=nde(nae);function nde(e){return e&&e.__esModule?e:{default:e}}var rde=Qhe.SliderPointer=function(e){var t=e.direction,n=(0,tde.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:"vertical"===t});return ede.default.createElement("div",{style:n.picker})};Qhe.default=rde,Object.defineProperty(Jhe,"__esModule",{value:!0}),Jhe.HuePicker=void 0;var ide=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ode=hde(a.default),sde=hde(Fle.exports),ade=hde(nae),lde=hde(K$),cde=Yae,ude=hde(Qhe);function hde(e){return e&&e.__esModule?e:{default:e}}var dde=Jhe.HuePicker=function(e){var t=e.width,n=e.height,r=e.onChange,i=e.hsl,o=e.direction,s=e.pointer,a=e.styles,l=void 0===a?{}:a,c=e.className,u=void 0===c?"":c,h=(0,ade.default)((0,lde.default)({default:{picker:{position:"relative",width:t,height:n},hue:{radius:"2px"}}},l));return ode.default.createElement("div",{style:h.picker,className:"hue-picker "+u},ode.default.createElement(cde.Hue,ide({},h.hue,{hsl:i,pointer:s,onChange:function(e){return r({a:1,h:e.h,l:.5,s:1})},direction:o})))};dde.propTypes={styles:sde.default.object},dde.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:ude.default,styles:{}},Jhe.default=(0,cde.ColorWrap)(dde);var fde={};Object.defineProperty(fde,"__esModule",{value:!0}),fde.Material=void 0;var pde=bde(a.default),gde=bde(nae),mde=bde(K$),vde=bde(ace),yde=Yae;function bde(e){return e&&e.__esModule?e:{default:e}}var xde=fde.Material=function(e){var t=e.onChange,n=e.hex,r=e.rgb,i=e.styles,o=void 0===i?{}:i,s=e.className,a=void 0===s?"":s,l=(0,gde.default)((0,mde.default)({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+n,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},o)),c=function(e,n){e.hex?vde.default.isValidHex(e.hex)&&t({hex:e.hex,source:"hex"},n):(e.r||e.g||e.b)&&t({r:e.r||r.r,g:e.g||r.g,b:e.b||r.b,source:"rgb"},n)};return pde.default.createElement(yde.Raised,{styles:o},pde.default.createElement("div",{style:l.material,className:"material-picker "+a},pde.default.createElement(yde.EditableInput,{style:{wrap:l.HEXwrap,input:l.HEXinput,label:l.HEXlabel},label:"hex",value:n,onChange:c}),pde.default.createElement("div",{style:l.split,className:"flexbox-fix"},pde.default.createElement("div",{style:l.third},pde.default.createElement(yde.EditableInput,{style:{wrap:l.RGBwrap,input:l.RGBinput,label:l.RGBlabel},label:"r",value:r.r,onChange:c})),pde.default.createElement("div",{style:l.third},pde.default.createElement(yde.EditableInput,{style:{wrap:l.RGBwrap,input:l.RGBinput,label:l.RGBlabel},label:"g",value:r.g,onChange:c})),pde.default.createElement("div",{style:l.third},pde.default.createElement(yde.EditableInput,{style:{wrap:l.RGBwrap,input:l.RGBinput,label:l.RGBlabel},label:"b",value:r.b,onChange:c})))))};fde.default=(0,yde.ColorWrap)(xde);var wde={},Cde={};Object.defineProperty(Cde,"__esModule",{value:!0}),Cde.PhotoshopPicker=void 0;var Ede=Ade(a.default),_de=Ade(nae),Sde=Ade(ace),Ode=Yae;function Ade(e){return e&&e.__esModule?e:{default:e}}var kde=Cde.PhotoshopPicker=function(e){var t=e.onChange,n=e.rgb,r=e.hsv,i=e.hex,o=(0,_de.default)({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),s=function(e,i){e["#"]?Sde.default.isValidHex(e["#"])&&t({hex:e["#"],source:"hex"},i):e.r||e.g||e.b?t({r:e.r||n.r,g:e.g||n.g,b:e.b||n.b,source:"rgb"},i):(e.h||e.s||e.v)&&t({h:e.h||r.h,s:e.s||r.s,v:e.v||r.v,source:"hsv"},i)};return Ede.default.createElement("div",{style:o.fields},Ede.default.createElement(Ode.EditableInput,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"h",value:Math.round(r.h),onChange:s}),Ede.default.createElement(Ode.EditableInput,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"s",value:Math.round(100*r.s),onChange:s}),Ede.default.createElement(Ode.EditableInput,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"v",value:Math.round(100*r.v),onChange:s}),Ede.default.createElement("div",{style:o.divider}),Ede.default.createElement(Ode.EditableInput,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"r",value:n.r,onChange:s}),Ede.default.createElement(Ode.EditableInput,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"g",value:n.g,onChange:s}),Ede.default.createElement(Ode.EditableInput,{style:{wrap:o.RGBwrap,input:o.RGBinput,label:o.RGBlabel},label:"b",value:n.b,onChange:s}),Ede.default.createElement("div",{style:o.divider}),Ede.default.createElement(Ode.EditableInput,{style:{wrap:o.HEXwrap,input:o.HEXinput,label:o.HEXlabel},label:"#",value:i.replace("#",""),onChange:s}),Ede.default.createElement("div",{style:o.fieldSymbols},Ede.default.createElement("div",{style:o.symbol},"°"),Ede.default.createElement("div",{style:o.symbol},"%"),Ede.default.createElement("div",{style:o.symbol},"%")))};Cde.default=kde;var Mde={};Object.defineProperty(Mde,"__esModule",{value:!0}),Mde.PhotoshopPointerCircle=void 0;var Tde=Dde(a.default),Pde=Dde(nae);function Dde(e){return e&&e.__esModule?e:{default:e}}var Nde=Mde.PhotoshopPointerCircle=function(e){var t=e.hsl,n=(0,Pde.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":t.l>.5});return Tde.default.createElement("div",{style:n.picker})};Mde.default=Nde;var Rde={};Object.defineProperty(Rde,"__esModule",{value:!0}),Rde.PhotoshopPointerCircle=void 0;var Ide=Lde(a.default),jde=Lde(nae);function Lde(e){return e&&e.__esModule?e:{default:e}}var Fde=Rde.PhotoshopPointerCircle=function(){var e=(0,jde.default)({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return Ide.default.createElement("div",{style:e.pointer},Ide.default.createElement("div",{style:e.left},Ide.default.createElement("div",{style:e.leftInside})),Ide.default.createElement("div",{style:e.right},Ide.default.createElement("div",{style:e.rightInside})))};Rde.default=Fde;var Gde={};Object.defineProperty(Gde,"__esModule",{value:!0}),Gde.PhotoshopButton=void 0;var Bde=Ude(a.default),zde=Ude(nae);function Ude(e){return e&&e.__esModule?e:{default:e}}var Vde=Gde.PhotoshopButton=function(e){var t=e.onClick,n=e.label,r=e.children,i=e.active,o=(0,zde.default)({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:i});return Bde.default.createElement("div",{style:o.button,onClick:t},n||r)};Gde.default=Vde;var Hde={};Object.defineProperty(Hde,"__esModule",{value:!0}),Hde.PhotoshopPreviews=void 0;var Wde=Xde(a.default),$de=Xde(nae);function Xde(e){return e&&e.__esModule?e:{default:e}}var Yde=Hde.PhotoshopPreviews=function(e){var t=e.rgb,n=e.currentColor,r=(0,$de.default)({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+t.r+","+t.g+", "+t.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:n,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return Wde.default.createElement("div",null,Wde.default.createElement("div",{style:r.label},"new"),Wde.default.createElement("div",{style:r.swatches},Wde.default.createElement("div",{style:r.new}),Wde.default.createElement("div",{style:r.current})),Wde.default.createElement("div",{style:r.label},"current"))};Hde.default=Yde,Object.defineProperty(wde,"__esModule",{value:!0}),wde.Photoshop=void 0;var qde=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Kde=sfe(a.default),Zde=sfe(Fle.exports),Jde=sfe(nae),Qde=sfe(K$),efe=Yae,tfe=sfe(Cde),nfe=sfe(Mde),rfe=sfe(Rde),ife=sfe(Gde),ofe=sfe(Hde);function sfe(e){return e&&e.__esModule?e:{default:e}}var afe=wde.Photoshop=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.state={currentColor:e.hex},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),qde(t,[{key:"render",value:function(){var e=this.props,t=e.styles,n=void 0===t?{}:t,r=e.className,i=void 0===r?"":r,o=(0,Jde.default)((0,Qde.default)({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},n));return Kde.default.createElement("div",{style:o.picker,className:"photoshop-picker "+i},Kde.default.createElement("div",{style:o.head},this.props.header),Kde.default.createElement("div",{style:o.body,className:"flexbox-fix"},Kde.default.createElement("div",{style:o.saturation},Kde.default.createElement(efe.Saturation,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:nfe.default,onChange:this.props.onChange})),Kde.default.createElement("div",{style:o.hue},Kde.default.createElement(efe.Hue,{direction:"vertical",hsl:this.props.hsl,pointer:rfe.default,onChange:this.props.onChange})),Kde.default.createElement("div",{style:o.controls},Kde.default.createElement("div",{style:o.top,className:"flexbox-fix"},Kde.default.createElement("div",{style:o.previews},Kde.default.createElement(ofe.default,{rgb:this.props.rgb,currentColor:this.state.currentColor})),Kde.default.createElement("div",{style:o.actions},Kde.default.createElement(ife.default,{label:"OK",onClick:this.props.onAccept,active:!0}),Kde.default.createElement(ife.default,{label:"Cancel",onClick:this.props.onCancel}),Kde.default.createElement(tfe.default,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),t}(Kde.default.Component);afe.propTypes={header:Zde.default.string,styles:Zde.default.object},afe.defaultProps={header:"Color Picker",styles:{}},wde.default=(0,efe.ColorWrap)(afe);var lfe={},cfe={};Object.defineProperty(cfe,"__esModule",{value:!0}),cfe.SketchFields=void 0;var ufe=pfe(a.default),hfe=pfe(nae),dfe=pfe(ace),ffe=Yae;function pfe(e){return e&&e.__esModule?e:{default:e}}var gfe=cfe.SketchFields=function(e){var t=e.onChange,n=e.rgb,r=e.hsl,i=e.hex,o=e.disableAlpha,s=(0,hfe.default)({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:o}),a=function(e,i){e.hex?dfe.default.isValidHex(e.hex)&&t({hex:e.hex,source:"hex"},i):e.r||e.g||e.b?t({r:e.r||n.r,g:e.g||n.g,b:e.b||n.b,a:n.a,source:"rgb"},i):e.a&&(e.a<0?e.a=0:e.a>100&&(e.a=100),e.a/=100,t({h:r.h,s:r.s,l:r.l,a:e.a,source:"rgb"},i))};return ufe.default.createElement("div",{style:s.fields,className:"flexbox-fix"},ufe.default.createElement("div",{style:s.double},ufe.default.createElement(ffe.EditableInput,{style:{input:s.input,label:s.label},label:"hex",value:i.replace("#",""),onChange:a})),ufe.default.createElement("div",{style:s.single},ufe.default.createElement(ffe.EditableInput,{style:{input:s.input,label:s.label},label:"r",value:n.r,onChange:a,dragLabel:"true",dragMax:"255"})),ufe.default.createElement("div",{style:s.single},ufe.default.createElement(ffe.EditableInput,{style:{input:s.input,label:s.label},label:"g",value:n.g,onChange:a,dragLabel:"true",dragMax:"255"})),ufe.default.createElement("div",{style:s.single},ufe.default.createElement(ffe.EditableInput,{style:{input:s.input,label:s.label},label:"b",value:n.b,onChange:a,dragLabel:"true",dragMax:"255"})),ufe.default.createElement("div",{style:s.alpha},ufe.default.createElement(ffe.EditableInput,{style:{input:s.input,label:s.label},label:"a",value:Math.round(100*n.a),onChange:a,dragLabel:"true",dragMax:"100"})))};cfe.default=gfe;var mfe={};Object.defineProperty(mfe,"__esModule",{value:!0}),mfe.SketchPresetColors=void 0;var vfe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yfe=Cfe(a.default),bfe=Cfe(Fle.exports),xfe=Cfe(nae),wfe=Yae;function Cfe(e){return e&&e.__esModule?e:{default:e}}var Efe=mfe.SketchPresetColors=function(e){var t=e.colors,n=e.onClick,r=void 0===n?function(){}:n,i=e.onSwatchHover,o=(0,xfe.default)({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!t||!t.length}),s=function(e,t){r({hex:e,source:"hex"},t)};return yfe.default.createElement("div",{style:o.colors,className:"flexbox-fix"},t.map((function(e){var t="string"==typeof e?{color:e}:e,n=""+t.color+(t.title||"");return yfe.default.createElement("div",{key:n,style:o.swatchWrap},yfe.default.createElement(wfe.Swatch,vfe({},t,{style:o.swatch,onClick:s,onHover:i,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+t.color}})))})))};Efe.propTypes={colors:bfe.default.arrayOf(bfe.default.oneOfType([bfe.default.string,bfe.default.shape({color:bfe.default.string,title:bfe.default.string})])).isRequired},mfe.default=Efe,Object.defineProperty(lfe,"__esModule",{value:!0}),lfe.Sketch=void 0;var _fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Sfe=Dfe(a.default),Ofe=Dfe(Fle.exports),Afe=Dfe(nae),kfe=Dfe(K$),Mfe=Yae,Tfe=Dfe(cfe),Pfe=Dfe(mfe);function Dfe(e){return e&&e.__esModule?e:{default:e}}var Nfe=lfe.Sketch=function(e){var t=e.width,n=e.rgb,r=e.hex,i=e.hsv,o=e.hsl,s=e.onChange,a=e.onSwatchHover,l=e.disableAlpha,c=e.presetColors,u=e.renderers,h=e.styles,d=void 0===h?{}:h,f=e.className,p=void 0===f?"":f,g=(0,Afe.default)((0,kfe.default)({default:_fe({picker:{width:t,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+n.r+","+n.g+","+n.b+","+n.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},d),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},d),{disableAlpha:l});return Sfe.default.createElement("div",{style:g.picker,className:"sketch-picker "+p},Sfe.default.createElement("div",{style:g.saturation},Sfe.default.createElement(Mfe.Saturation,{style:g.Saturation,hsl:o,hsv:i,onChange:s})),Sfe.default.createElement("div",{style:g.controls,className:"flexbox-fix"},Sfe.default.createElement("div",{style:g.sliders},Sfe.default.createElement("div",{style:g.hue},Sfe.default.createElement(Mfe.Hue,{style:g.Hue,hsl:o,onChange:s})),Sfe.default.createElement("div",{style:g.alpha},Sfe.default.createElement(Mfe.Alpha,{style:g.Alpha,rgb:n,hsl:o,renderers:u,onChange:s}))),Sfe.default.createElement("div",{style:g.color},Sfe.default.createElement(Mfe.Checkboard,null),Sfe.default.createElement("div",{style:g.activeColor}))),Sfe.default.createElement(Tfe.default,{rgb:n,hsl:o,hex:r,onChange:s,disableAlpha:l}),Sfe.default.createElement(Pfe.default,{colors:c,onClick:s,onSwatchHover:a}))};Nfe.propTypes={disableAlpha:Ofe.default.bool,width:Ofe.default.oneOfType([Ofe.default.string,Ofe.default.number]),styles:Ofe.default.object},Nfe.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]},lfe.default=(0,Mfe.ColorWrap)(Nfe);var Rfe={},Ife={},jfe={};Object.defineProperty(jfe,"__esModule",{value:!0}),jfe.SliderSwatch=void 0;var Lfe=Gfe(a.default),Ffe=Gfe(nae);function Gfe(e){return e&&e.__esModule?e:{default:e}}var Bfe=jfe.SliderSwatch=function(e){var t=e.hsl,n=e.offset,r=e.onClick,i=void 0===r?function(){}:r,o=e.active,s=e.first,a=e.last,l=(0,Ffe.default)({default:{swatch:{height:"12px",background:"hsl("+t.h+", 50%, "+100*n+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:o,first:s,last:a});return Lfe.default.createElement("div",{style:l.swatch,onClick:function(e){return i({h:t.h,s:.5,l:n,source:"hsl"},e)}})};jfe.default=Bfe,Object.defineProperty(Ife,"__esModule",{value:!0}),Ife.SliderSwatches=void 0;var zfe=Hfe(a.default),Ufe=Hfe(nae),Vfe=Hfe(jfe);function Hfe(e){return e&&e.__esModule?e:{default:e}}var Wfe=Ife.SliderSwatches=function(e){var t=e.onClick,n=e.hsl,r=(0,Ufe.default)({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}}),i=.1;return zfe.default.createElement("div",{style:r.swatches},zfe.default.createElement("div",{style:r.swatch},zfe.default.createElement(Vfe.default,{hsl:n,offset:".80",active:Math.abs(n.l-.8)<i&&Math.abs(n.s-.5)<i,onClick:t,first:!0})),zfe.default.createElement("div",{style:r.swatch},zfe.default.createElement(Vfe.default,{hsl:n,offset:".65",active:Math.abs(n.l-.65)<i&&Math.abs(n.s-.5)<i,onClick:t})),zfe.default.createElement("div",{style:r.swatch},zfe.default.createElement(Vfe.default,{hsl:n,offset:".50",active:Math.abs(n.l-.5)<i&&Math.abs(n.s-.5)<i,onClick:t})),zfe.default.createElement("div",{style:r.swatch},zfe.default.createElement(Vfe.default,{hsl:n,offset:".35",active:Math.abs(n.l-.35)<i&&Math.abs(n.s-.5)<i,onClick:t})),zfe.default.createElement("div",{style:r.swatch},zfe.default.createElement(Vfe.default,{hsl:n,offset:".20",active:Math.abs(n.l-.2)<i&&Math.abs(n.s-.5)<i,onClick:t,last:!0})),zfe.default.createElement("div",{style:r.clear}))};Ife.default=Wfe;var $fe={};Object.defineProperty($fe,"__esModule",{value:!0}),$fe.SliderPointer=void 0;var Xfe=qfe(a.default),Yfe=qfe(nae);function qfe(e){return e&&e.__esModule?e:{default:e}}var Kfe=$fe.SliderPointer=function(){var e=(0,Yfe.default)({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return Xfe.default.createElement("div",{style:e.picker})};$fe.default=Kfe,Object.defineProperty(Rfe,"__esModule",{value:!0}),Rfe.Slider=void 0;var Zfe=ipe(a.default),Jfe=ipe(Fle.exports),Qfe=ipe(nae),epe=ipe(K$),tpe=Yae,npe=ipe(Ife),rpe=ipe($fe);function ipe(e){return e&&e.__esModule?e:{default:e}}var ope=Rfe.Slider=function(e){var t=e.hsl,n=e.onChange,r=e.pointer,i=e.styles,o=void 0===i?{}:i,s=e.className,a=void 0===s?"":s,l=(0,Qfe.default)((0,epe.default)({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},o));return Zfe.default.createElement("div",{style:l.wrap||{},className:"slider-picker "+a},Zfe.default.createElement("div",{style:l.hue},Zfe.default.createElement(tpe.Hue,{style:l.Hue,hsl:t,pointer:r,onChange:n})),Zfe.default.createElement("div",{style:l.swatches},Zfe.default.createElement(npe.default,{hsl:t,onClick:n})))};ope.propTypes={styles:Jfe.default.object},ope.defaultProps={pointer:rpe.default,styles:{}},Rfe.default=(0,tpe.ColorWrap)(ope);var spe={},ape={},lpe={},cpe={};Object.defineProperty(cpe,"__esModule",{value:!0});var upe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hpe=function(e){return e&&e.__esModule?e:{default:e}}(a.default);cpe.default=function(e){var t=e.fill,n=void 0===t?"currentColor":t,r=e.width,i=void 0===r?24:r,o=e.height,s=void 0===o?24:o,a=e.style,l=void 0===a?{}:a,c=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["fill","width","height","style"]);return hpe.default.createElement("svg",upe({viewBox:"0 0 24 24",style:upe({fill:n,width:i,height:s},l)},c),hpe.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))},Object.defineProperty(lpe,"__esModule",{value:!0}),lpe.SwatchesColor=void 0;var dpe=vpe(a.default),fpe=vpe(nae),ppe=vpe(ace),gpe=Yae,mpe=vpe(cpe);function vpe(e){return e&&e.__esModule?e:{default:e}}var ype=lpe.SwatchesColor=function(e){var t=e.color,n=e.onClick,r=void 0===n?function(){}:n,i=e.onSwatchHover,o=e.first,s=e.last,a=e.active,l=(0,fpe.default)({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:t,marginBottom:"1px"},check:{color:ppe.default.getContrastingColor(t),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:o,last:s,active:a,"color-#FFFFFF":"#FFFFFF"===t,transparent:"transparent"===t});return dpe.default.createElement(gpe.Swatch,{color:t,style:l.color,onClick:r,onHover:i,focusStyle:{boxShadow:"0 0 4px "+t}},dpe.default.createElement("div",{style:l.check},dpe.default.createElement(mpe.default,null)))};lpe.default=ype,Object.defineProperty(ape,"__esModule",{value:!0}),ape.SwatchesGroup=void 0;var bpe=Epe(a.default),xpe=Epe(nae),wpe=Epe(sU),Cpe=Epe(lpe);function Epe(e){return e&&e.__esModule?e:{default:e}}var _pe=ape.SwatchesGroup=function(e){var t=e.onClick,n=e.onSwatchHover,r=e.group,i=e.active,o=(0,xpe.default)({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return bpe.default.createElement("div",{style:o.group},(0,wpe.default)(r,(function(e,o){return bpe.default.createElement(Cpe.default,{key:e,color:e,active:e.toLowerCase()===i,first:0===o,last:o===r.length-1,onClick:t,onSwatchHover:n})})))};ape.default=_pe,Object.defineProperty(spe,"__esModule",{value:!0}),spe.Swatches=void 0;var Spe=Rpe(a.default),Ope=Rpe(Fle.exports),Ape=Rpe(nae),kpe=Rpe(sU),Mpe=Rpe(K$),Tpe=Rpe(ace),Ppe=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(hue.exports),Dpe=Yae,Npe=Rpe(ape);function Rpe(e){return e&&e.__esModule?e:{default:e}}var Ipe=spe.Swatches=function(e){var t=e.width,n=e.height,r=e.onChange,i=e.onSwatchHover,o=e.colors,s=e.hex,a=e.styles,l=void 0===a?{}:a,c=e.className,u=void 0===c?"":c,h=(0,Ape.default)((0,Mpe.default)({default:{picker:{width:t,height:n},overflow:{height:n,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},l)),d=function(e,t){Tpe.default.isValidHex(e)&&r({hex:e,source:"hex"},t)};return Spe.default.createElement("div",{style:h.picker,className:"swatches-picker "+u},Spe.default.createElement(Dpe.Raised,null,Spe.default.createElement("div",{style:h.overflow},Spe.default.createElement("div",{style:h.body},(0,kpe.default)(o,(function(e){return Spe.default.createElement(Npe.default,{key:e.toString(),group:e,active:s,onClick:d,onSwatchHover:i})})),Spe.default.createElement("div",{style:h.clear})))))};Ipe.propTypes={width:Ope.default.oneOfType([Ope.default.string,Ope.default.number]),height:Ope.default.oneOfType([Ope.default.string,Ope.default.number]),colors:Ope.default.arrayOf(Ope.default.arrayOf(Ope.default.string)),styles:Ope.default.object},Ipe.defaultProps={width:320,height:240,colors:[[Ppe.red[900],Ppe.red[700],Ppe.red[500],Ppe.red[300],Ppe.red[100]],[Ppe.pink[900],Ppe.pink[700],Ppe.pink[500],Ppe.pink[300],Ppe.pink[100]],[Ppe.purple[900],Ppe.purple[700],Ppe.purple[500],Ppe.purple[300],Ppe.purple[100]],[Ppe.deepPurple[900],Ppe.deepPurple[700],Ppe.deepPurple[500],Ppe.deepPurple[300],Ppe.deepPurple[100]],[Ppe.indigo[900],Ppe.indigo[700],Ppe.indigo[500],Ppe.indigo[300],Ppe.indigo[100]],[Ppe.blue[900],Ppe.blue[700],Ppe.blue[500],Ppe.blue[300],Ppe.blue[100]],[Ppe.lightBlue[900],Ppe.lightBlue[700],Ppe.lightBlue[500],Ppe.lightBlue[300],Ppe.lightBlue[100]],[Ppe.cyan[900],Ppe.cyan[700],Ppe.cyan[500],Ppe.cyan[300],Ppe.cyan[100]],[Ppe.teal[900],Ppe.teal[700],Ppe.teal[500],Ppe.teal[300],Ppe.teal[100]],["#194D33",Ppe.green[700],Ppe.green[500],Ppe.green[300],Ppe.green[100]],[Ppe.lightGreen[900],Ppe.lightGreen[700],Ppe.lightGreen[500],Ppe.lightGreen[300],Ppe.lightGreen[100]],[Ppe.lime[900],Ppe.lime[700],Ppe.lime[500],Ppe.lime[300],Ppe.lime[100]],[Ppe.yellow[900],Ppe.yellow[700],Ppe.yellow[500],Ppe.yellow[300],Ppe.yellow[100]],[Ppe.amber[900],Ppe.amber[700],Ppe.amber[500],Ppe.amber[300],Ppe.amber[100]],[Ppe.orange[900],Ppe.orange[700],Ppe.orange[500],Ppe.orange[300],Ppe.orange[100]],[Ppe.deepOrange[900],Ppe.deepOrange[700],Ppe.deepOrange[500],Ppe.deepOrange[300],Ppe.deepOrange[100]],[Ppe.brown[900],Ppe.brown[700],Ppe.brown[500],Ppe.brown[300],Ppe.brown[100]],[Ppe.blueGrey[900],Ppe.blueGrey[700],Ppe.blueGrey[500],Ppe.blueGrey[300],Ppe.blueGrey[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}},spe.default=(0,Dpe.ColorWrap)(Ipe);var jpe={};Object.defineProperty(jpe,"__esModule",{value:!0}),jpe.Twitter=void 0;var Lpe=Hpe(a.default),Fpe=Hpe(Fle.exports),Gpe=Hpe(nae),Bpe=Hpe(sU),zpe=Hpe(K$),Upe=Hpe(ace),Vpe=Yae;function Hpe(e){return e&&e.__esModule?e:{default:e}}var Wpe=jpe.Twitter=function(e){var t=e.onChange,n=e.onSwatchHover,r=e.hex,i=e.colors,o=e.width,s=e.triangle,a=e.styles,l=void 0===a?{}:a,c=e.className,u=void 0===c?"":c,h=(0,Gpe.default)((0,zpe.default)({default:{card:{width:o,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},l),{"hide-triangle":"hide"===s,"top-left-triangle":"top-left"===s,"top-right-triangle":"top-right"===s}),d=function(e,n){Upe.default.isValidHex(e)&&t({hex:e,source:"hex"},n)};return Lpe.default.createElement("div",{style:h.card,className:"twitter-picker "+u},Lpe.default.createElement("div",{style:h.triangleShadow}),Lpe.default.createElement("div",{style:h.triangle}),Lpe.default.createElement("div",{style:h.body},(0,Bpe.default)(i,(function(e,t){return Lpe.default.createElement(Vpe.Swatch,{key:t,color:e,hex:e,style:h.swatch,onClick:d,onHover:n,focusStyle:{boxShadow:"0 0 4px "+e}})})),Lpe.default.createElement("div",{style:h.hash},"#"),Lpe.default.createElement(Vpe.EditableInput,{style:{input:h.input},value:r.replace("#",""),onChange:d}),Lpe.default.createElement("div",{style:h.clear})))};Wpe.propTypes={width:Fpe.default.oneOfType([Fpe.default.string,Fpe.default.number]),triangle:Fpe.default.oneOf(["hide","top-left","top-right"]),colors:Fpe.default.arrayOf(Fpe.default.string),styles:Fpe.default.object},Wpe.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}},jpe.default=(0,Vpe.ColorWrap)(Wpe),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CustomPicker=e.TwitterPicker=e.SwatchesPicker=e.SliderPicker=e.SketchPicker=e.PhotoshopPicker=e.MaterialPicker=e.HuePicker=e.GithubPicker=e.CompactPicker=e.ChromePicker=e.default=e.CirclePicker=e.BlockPicker=e.AlphaPicker=void 0;var t=tae;Object.defineProperty(e,"AlphaPicker",{enumerable:!0,get:function(){return m(t).default}});var n=Xce;Object.defineProperty(e,"BlockPicker",{enumerable:!0,get:function(){return m(n).default}});var r=uue;Object.defineProperty(e,"CirclePicker",{enumerable:!0,get:function(){return m(r).default}});var i=Mue;Object.defineProperty(e,"ChromePicker",{enumerable:!0,get:function(){return m(i).default}});var o=uhe;Object.defineProperty(e,"CompactPicker",{enumerable:!0,get:function(){return m(o).default}});var s=Ihe;Object.defineProperty(e,"GithubPicker",{enumerable:!0,get:function(){return m(s).default}});var a=Jhe;Object.defineProperty(e,"HuePicker",{enumerable:!0,get:function(){return m(a).default}});var l=fde;Object.defineProperty(e,"MaterialPicker",{enumerable:!0,get:function(){return m(l).default}});var c=wde;Object.defineProperty(e,"PhotoshopPicker",{enumerable:!0,get:function(){return m(c).default}});var u=lfe;Object.defineProperty(e,"SketchPicker",{enumerable:!0,get:function(){return m(u).default}});var h=Rfe;Object.defineProperty(e,"SliderPicker",{enumerable:!0,get:function(){return m(h).default}});var d=spe;Object.defineProperty(e,"SwatchesPicker",{enumerable:!0,get:function(){return m(d).default}});var f=jpe;Object.defineProperty(e,"TwitterPicker",{enumerable:!0,get:function(){return m(f).default}});var p=sce;Object.defineProperty(e,"CustomPicker",{enumerable:!0,get:function(){return m(p).default}});var g=m(i);function m(e){return e&&e.__esModule?e:{default:e}}e.default=g.default}(eae);var $pe=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Xpe=e=>{const{idx:t,menuOptions:n,target:r,modelService:i,commandService:o,onHide:s}=e,{id:l,label:c,isEnabled:u=!0,isVisible:h=!0,iconName:d,submenu:f=[],active:p,hotkey:g,render:m,onClick:v}=n;if(!h)return null;if("separator"===n.type)return a.default.createElement(Mre.Divider,{key:String(n.id)+t});if("root"===n.type)return a.default.createElement(Mre,{hasIcon:!0},f.map(((e,t)=>Xpe({idx:t,target:r,commandService:o,modelService:i,menuOptions:e,onHide:s}))));if(n.submenu&&Array.isArray(n.submenu)){const e=qne.get(d),t=!u;return a.default.createElement(Mre.SubMenu,{key:String(l),text:c,disabled:t||0===f.length,icon:e?a.default.createElement(e,null):null,active:p,hotkey:g},f.map(((e,t)=>Xpe({idx:t,target:r,commandService:o,modelService:i,menuOptions:e,onHide:s}))))}const y=qne.get(d);return m?a.default.createElement(m,{menuItem:n,target:r,commandService:o,modelService:i,onHide:s},[a.default.createElement(Mre.Item,{key:String(l),text:c,disabled:!u,icon:y?a.default.createElement(y,null):null,active:p,hotkey:g})]):a.default.createElement(Mre.Item,{key:String(l),text:c,disabled:!u,icon:y?a.default.createElement(y,null):null,active:p,hotkey:g,onClick:()=>$pe(void 0,void 0,void 0,(function*(){yield v({menuItem:n,target:r,commandService:o,modelService:i}),s&&s()}))})},Ype=e=>{const{menuModel:t,target:n,onHide:r}=e,{modelService:i,commandService:o}=eA(),[s]=Dne(t);return Xpe({idx:-1,target:n,commandService:o,modelService:i,menuOptions:s,onHide:r})};var qpe=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Kpe=({toDispose:e})=>(a.default.useEffect((()=>()=>{e.dispose()}),[e]),null),Zpe=()=>{const e=a.default.useRef(),t=eA(),[n,,r]=Rne({getModel:()=>qpe(void 0,void 0,void 0,(function*(){return yield fre.getModel(t.modelService)})),initialState:{anchor:null,menuModel:null,target:null,customRender:null,toDispose:null}}),{target:i,anchor:o,menuModel:s,customRender:l,toDispose:c}=n;if(!i||!o||!s)return null;const u=()=>{r.setValue({anchor:null,menuModel:null,target:null,customRender:null,toDispose:null})},h=l?a.default.createElement(l,{target:i,modelService:t.modelService,onHide:u}):a.default.createElement(Ype,{target:i,menuModel:s,onHide:u});return a.default.createElement("div",{className:"xflow-menu-mask",ref:e,onClick:u,onContextMenu:e=>{e.preventDefault(),e.stopPropagation()}},a.default.createElement(Kpe,{toDispose:c}),a.default.createElement(Yse,{visible:!0,getPopupContainer:()=>e.current,overlay:h},a.default.createElement("div",{className:"xflow-context-menu-anchor",style:{top:o.y,left:o.x}})))},Jpe="CanvasToolbar";class Qpe{constructor(){this.CONFIG_TYPE=Jpe,this.setToolbarName=e=>{this.moduleId="CanvasToolbar__"+e},this.setToolbarModelService=e=>{this.toolbarModelService=e},this.setCustomToolbarRender=e=>{this.customRenderService=e},this.getConfig=()=>({CONFIG_TYPE:this.CONFIG_TYPE,toolbarCustomRender:this.customRenderService,toolbarModelService:this.toolbarModelService}),this.moduleId="CanvasToolbar__"+eS()}dispose(){}}const ege=e=>{const t=eA(),{item:n,layout:r}=e,i=qne.get(n.iconName),o=hr({"xflow-toolbar-item":!0}),s="vertical"===r?"":n.text,l=i?a.default.createElement(i,null):null,c=n.render,{isEnabled:u=!0}=n,{commandService:h,modelService:d}=t,f=()=>{n.onClick&&n.onClick({toolbarItem:n,commandService:h,modelService:d})};return c?a.default.createElement(c,Object.assign({},n,{onClick:f}),a.default.createElement(Qse.Item,Object.assign({},n,{icon:l,text:s,className:o,disabled:!u,tooltip:n.tooltip||n.text,tooltipProps:Object.assign({placement:"vertical"===r?"left":"bottom"},n.tooltipProps),onClick:()=>{}}))):a.default.createElement(Qse.Item,Object.assign({},n,{icon:l,text:s,className:o,hidden:!n,disabled:!u,tooltip:n.tooltip||n.text,onClick:f,tooltipProps:Object.assign(Object.assign({},n.tooltipProps),{placement:"vertical"===r?"left":"bottom"})}))},tge=e=>{const{group:t,layout:n}=e,r=a.default.useMemo((()=>t.name||eS()),[t.name]),{items:i=[]}=t;if(0===i.length)return null;const o=hr({"xflow-toolbar-group":!0});return a.default.createElement(Qse.Group,{className:o,key:r},i.map((e=>a.default.createElement(ege,{item:e,layout:n,key:e.id}))))};var nge=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const rge=e=>{const{idx:t,groups:n,layout:r,toolbarOptions:i}=e,{hoverEffect:o=!0}=i;return a.default.createElement(Qse,{hoverEffect:o},n.map(((e,n)=>{const i=t+n;return a.default.createElement(tge,{key:i,group:e,layout:r})})))},ige=a.default.memo((e=>{const{isModelReady:t,state:n}=(e=>{const{config:t}=e,n=t.moduleId,r=eA(),[i,o,s,l]=Nne({name:n,layout:e.layout,mainGroups:[],extraGroups:[],customRender:null});return a.default.useEffect((()=>{const e=new V_;if(!r.modelService.findDeferredModel(n)){const{toolbarCustomRender:i,toolbarModelService:o}=t.getConfig(),a=r.modelService.registerModel({id:n,modelFactory:()=>s,watchChange:t=>nge(void 0,void 0,void 0,(function*(){if(o&&(yield o(t,r.modelService,e)),i){const e=e=>{t.setValue((t=>t.customRender=e))};yield i(r.modelService,e)}return e}))});e.push(a)}return()=>{e.dispose()}}),[]),{isModelReady:l,state:i,setState:o,toolbarModel:s}})(e),r=lP(e.position),{mainGroups:o=[],extraGroups:s=[],layout:l,customRender:c}=n,u=hr(e.className,l,"xflow-toolbar"),h=hr({[l]:!0,"xflow-toolbar-root":!0});return t?c?a.default.createElement("div",{className:u,style:Object.assign(Object.assign({},r),e.style)},a.default.createElement(c,{config:n})):a.default.createElement("div",{className:u,style:Object.assign(Object.assign({},r),e.style)},a.default.createElement("div",{className:h},o.length>0&&a.default.createElement(rge,{idx:"mainGroups",groups:o,layout:l,toolbarOptions:n}),s.length>0&&a.default.createElement(rge,{idx:"extraGroups",groups:s,layout:l,toolbarOptions:n}))):a.default.createElement("div",{className:u,style:Object.assign(Object.assign({},r),e.style)},a.default.createElement(i.Spin,{spinning:!0,size:"small"}))})),oge=e=>{const t=!!eA(),n=a.default.useMemo((()=>e.config?e.config:new Qpe),[e.config]);return t?a.default.createElement(ige,Object.assign({},e,{config:n})):null},sge=e=>t=>{const n=a.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const r=a.default.useMemo((()=>{const t=new Qpe;return e(t,n),t}),[n]);return r};var age,lge=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};e.CANVAS_SCALE_TOOLBAR_CONFIG=void 0,age=e.CANVAS_SCALE_TOOLBAR_CONFIG||(e.CANVAS_SCALE_TOOLBAR_CONFIG={}),qne.set("ZoomInOutlined",qO),qne.set("ZoomOutOutlined",JO),qne.set("OneToOneOutlined",LO),qne.set("CompressOutlined",uO),age.ZOOM_IN=e.XFlowGraphCommands.GRAPH_ZOOM.id+"-zoom-in",age.ZOOM_OUT=e.XFlowGraphCommands.GRAPH_ZOOM.id+"-zoom-out",age.SCALE_TO_ONE=e.XFlowGraphCommands.GRAPH_ZOOM.id+"-scale-to-one",age.SCALE_TO_FIT=e.XFlowGraphCommands.GRAPH_ZOOM.id+"-scale-to-fit",age.MAX_SCALE=1.5,age.MIN_SCALE=.05,age.zoomOptions={maxScale:age.MAX_SCALE,minScale:age.MIN_SCALE},age.getToolbarConfig=t=>[{name:"main",items:[{id:age.ZOOM_IN,tooltip:"放大",iconName:"ZoomInOutlined",onClick:({commandService:t})=>{t.executeCommand(e.XFlowGraphCommands.GRAPH_ZOOM.id,{factor:.1,zoomOptions:age.zoomOptions})}},{id:age.ZOOM_OUT,tooltip:"缩小",iconName:"ZoomOutOutlined",onClick:({commandService:t})=>{t.executeCommand(e.XFlowGraphCommands.GRAPH_ZOOM.id,{factor:-.1,zoomOptions:age.zoomOptions})}},{id:age.SCALE_TO_ONE,iconName:"OneToOneOutlined",tooltip:"缩放到1:1",isEnabled:1!==t,onClick:({commandService:t})=>{t.executeCommand(e.XFlowGraphCommands.GRAPH_ZOOM.id,{factor:"real",zoomOptions:age.zoomOptions})}},{id:age.SCALE_TO_FIT,tooltip:"缩放到适应屏幕",iconName:"CompressOutlined",onClick:({commandService:t})=>{t.executeCommand(e.XFlowGraphCommands.GRAPH_ZOOM.id,{factor:"fit",zoomOptions:age.zoomOptions})}}]}];const cge=sge((t=>{t.setToolbarModelService(((t,n)=>lge(void 0,void 0,void 0,(function*(){const r=yield NT.useValue(n);t.setValue((t=>{t.mainGroups=e.CANVAS_SCALE_TOOLBAR_CONFIG.getToolbarConfig(r.zoomFactor)}));(yield NT.getModel(n)).watch((({zoomFactor:n})=>{t.setValue((t=>{t.mainGroups=e.CANVAS_SCALE_TOOLBAR_CONFIG.getToolbarConfig(n)}))}))}))))}));const uge=Symbol("IMinimapConfigProvider");var hge=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},dge=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},fge=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let pge=class{constructor(){this.toDispose=new V_,this.registerHookHub=()=>fge(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{}))})),this.registerHook=t=>fge(this,void 0,void 0,(function*(){const n=new V_,r=[t.graphOptions.registerHook({name:"add minimap options",handler:e=>fge(this,void 0,void 0,(function*(){const t=yield this.minimapConfig.getConfig();e.minimap=Object.assign({},t)}))})];return n.pushAll(r),e.Disposable.create((()=>{}))}))}};hge([Wn(uge),dge("design:type",Object)],pge.prototype,"minimapConfig",void 0),pge=hge([Hn({contrib:AM})],pge);const gge=e=>rr((t=>{t(uge,{useDynamic:()=>e}),t(pge)}));class mge extends _C{renderMarkup(){return this.renderJSONMarkup({tagName:"rect",selector:"body"})}update(){super.update({body:{refWidth:"100%",refHeight:"100%",fill:mge.nodeFillColor}})}}mge.nodeFillColor="#31d0c6",mge.setNodeFillColor=e=>{mge.nodeFillColor=e};var vge=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};class yge{constructor(){this.getValue=()=>({})}dispose(){this.getValue=()=>null}}const bge=a.default.createContext({propsProxy:null,commandService:null,modelService:null}),xge=()=>a.default.useContext(bge),wge=e=>{const{className:t,position:n,style:r,children:i}=e,o=eA(),s=lP(n),l=a.default.useMemo((()=>new yge),[]);if(a.default.useEffect((()=>()=>{l.dispose()}),[l]),!o||!o.modelService)return null;l.getValue=()=>e;const c=hr({[t]:!!t,"xflow-workspace-panel":!0}),{commandService:u,modelService:h}=o;return a.default.createElement(bge.Provider,{value:{propsProxy:l,commandService:u,modelService:h}},a.default.createElement("div",{className:c,style:Object.assign(Object.assign({},s),r)},i))},Cge="xflow-node-horizontal-edge",Ege="xflow-node-vertical-edge",_ge="xflow-group-vertical-edge",Sge="xflow-edge",Oge="XFLOW_NODE_SHAPE",Age="processing";var kge;let Mge;e.GRAPH_STATUS_INFO=void 0,(kge=e.GRAPH_STATUS_INFO||(e.GRAPH_STATUS_INFO={})).id="GRAPH_STATUS_INFO",function(e){e.SUCCESS="success",e.PROCESSING="processing",e.ERROR="error",e.DEFAULT="default",e.WARNING="warning"}(kge.StatusEnum||(kge.StatusEnum={})),kge.getModel=vT(kge.id),kge.useValue=yT(kge.id),e.XFlowDagCommands=void 0,(e.XFlowDagCommands||(e.XFlowDagCommands={})).QUERY_GRAPH_STATUS={id:"xflow:query-graph-status",label:"查询画布节点状态"};const{AnchorGroup:Tge}=e.NsGraph;Mge=hC.registry.exist(Oge)?hC.registry.get(Oge):hP.define({width:160,height:32,shape:Oge,view:W_,ports:{groups:{top:{zIndex:2,position:{name:Tge.TOP}},bottom:{zIndex:2,position:{name:Tge.BOTTOM}},right:{zIndex:2,position:{name:Tge.RIGHT}},left:{zIndex:2,position:{name:Tge.LEFT}}}},attrs:{body:{magnet:!1,fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%",zIndex:1}},portMarkup:[{tagName:"g",selector:"xflow-port-group",className:"xflow-port-group",attrs:{width:8,height:8,x:-4,y:-4,zIndex:10,magnet:"true"},children:[{tagName:"circle",selector:"xflow-port",className:"xflow-port",attrs:{r:4,fill:"#fff",stroke:"#d9d9d9",zIndex:12}},{tagName:"polygon",selector:"xflow-port-arrow",className:"xflow-port-arrow",attrs:{points:"0,0 8,0 4,4 ",fill:"#d9d9d9",stroke:"#d9d9d9",zIndex:13,transform:"translate(-4,0)"}}]}]});var Pge=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const{DirectoryTree:Dge,TreeNode:Nge}=i.Tree,Rge=({expanded:e})=>e?a.default.createElement(kO,null):a.default.createElement(SO,null),Ige=e=>new Mge(e),jge=e=>{const{nodeConfig:t,onMouseDown:n,graphConfig:r,modelService:i,commandService:o}=e;if(!r)return a.default.createElement("div",null);if(t.renderComponent)return a.default.createElement("div",{onMouseDown:n},a.default.createElement(t.renderComponent,{data:t,isNodeTreePanel:!0}));const s=r.nodeTypeParser(t)||Y_,l=r.nodeRender.get(s);return a.default.createElement("div",{onMouseDown:n},a.default.createElement(l,{commandService:o,modelService:i,data:t,isNodeTreePanel:!0}))},Lge=e=>{const[t,n]=a.default.useState(!1),{prefixClz:r,graphConfig:o,commandService:s,modelService:l,popoverContent:c,onMouseDown:u,item:h}=e;return a.default.createElement(a.default.Fragment,null,c&&a.default.createElement(i.Popover,{placement:"right",destroyTooltipOnHide:!0,content:c,visible:t,onVisibleChange:e=>{n(e)}},a.default.createElement("div",{className:`${r}-node-wrapper`,onMouseEnter:()=>{n(!0)}},jge({graphConfig:o,commandService:s,onMouseDown:u,modelService:l,nodeConfig:h}))),!c&&a.default.createElement("div",{className:`${r}-node-wrapper`,onMouseEnter:()=>{n(!0)}},jge({graphConfig:o,commandService:s,onMouseDown:u,modelService:l,nodeConfig:h})))},Fge=e=>{const{x6NodeFactory:t,dndOptions:n,onNodeDrop:r,state:o,onFolderExpand:s,prefixClz:l}=e,{graphProvider:c,modelService:u,commandService:h}=eA(),[d,f]=a.default.useState(),[p,g]=a.default.useState(),[m,v]=a.default.useState();c.getGraphInstance().then((e=>{v(e)})),a.default.useEffect((()=>{if(c.getGraphOptions().then((e=>{f(e)})),!m)return;const e=new M_(Object.assign(Object.assign({scaled:!1,animation:!1},n),{target:m,validateNode:e=>Pge(void 0,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e.getData()),e.getPosition());return r?yield r(t,h,u):console.error("onNodeDrop method is required in NodeTree Panel"),!1}))}));g(e)}),[h,n,m,c,u,r]);const y=a.default.useCallback((e=>n=>{if(!m||!p||!d)return;const r=d.nodeTypeParser(e),i=eT(e.renderComponent?e.renderComponent:d.nodeRender.get(r),h,u),o={data:e,width:e.width||180,height:e.height||40,view:d.graphId,component:i},s=t?t(o):Ige(o);p.start(s,n.nativeEvent)}),[h,p,m,d,u,t]),b=a.default.useCallback(((e=[])=>e.map((e=>{const{isDirectory:t,children:n,popoverContent:r}=e;return t?a.default.createElement(Nge,{icon:Rge,key:e.id,title:e.label,className:`${l}-tree-folder`},b(n)):a.default.createElement(Nge,{isLeaf:!0,key:e.id,className:`${l}-tree-leaf`,icon:a.default.createElement("span",null),title:a.default.createElement(Lge,{item:e,onMouseDown:y(e),popoverContent:r,prefixClz:l,modelService:u,commandService:h,graphConfig:d})})}))),[h,d,u,y,l]);return a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:`${l}-body`,style:e.style},!o.keyword&&a.default.createElement(Dge,{showIcon:!0,selectable:!1,autoExpandParent:!1,onExpand:s,expandedKeys:o.expandedKeys,className:`${l}-tree`},b(o.treeData)),o.searchList.length>0&&a.default.createElement("ul",{className:`${l}-body-list`},o.searchList.map((e=>a.default.createElement("li",{className:`${l}-body-list-item`},a.default.createElement(Lge,{item:e,onMouseDown:y(e),popoverContent:e.popoverContent,prefixClz:l,modelService:u,commandService:h,graphConfig:d}))))),o.keyword&&0===o.searchList.length&&a.default.createElement(i.Empty,{style:{marginTop:"48px"}})))},Gge=e=>{const{prefixClz:t,onKeywordChange:n}=e,{propsProxy:r}=xge(),o=r.getValue();return a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:`${t}-header`,style:e.style},o.header&&a.default.isValidElement(o.header)&&o.header,o.searchService&&a.default.createElement("div",{className:`${t}-header-search`},a.default.createElement(i.Input,{placeholder:"搜索组件",allowClear:!0,onChange:e=>n(e.target.value),style:{width:"100%",border:0}}))))},Bge=e=>{const{prefixClz:t}=e,{propsProxy:n}=xge(),r=n.getValue();return a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:`${t}-footer`,style:e.style},r.footer&&a.default.isValidElement(r.footer)&&r.footer))},zge="XFLOW_TREE_PANEL_ROOT_ID",Uge=e=>{const t=e&&e.headerPosition&&e.headerPosition.height||40,n=e.footerPosition&&e.footerPosition.height||40;return{headerStyle:lP(Object.assign({height:t,lineHeight:t,top:0,left:0,right:0},e.headerPosition)),bodyStyle:lP(Object.assign({left:0,right:0,top:t,bottom:n},e.bodyPosition)),footerStyle:lP(Object.assign({left:0,right:0,lineHeight:n,height:n,bottom:0},e.footerPosition))}};var Vge=Pz,Hge=BV;var Wge=function(e,t){return e&&e.length?Hge(e,Vge(t)):[]},$ge=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};e.NsNodeTreePanelModel=void 0,function(e){e.id="TREE_PANEL_MODEL",e.useModel=t=>$ge(this,void 0,void 0,(function*(){return t.awaitModel(e.id)}))}(e.NsNodeTreePanelModel||(e.NsNodeTreePanelModel={}));const Xge=t=>{const{treeDataService:n,searchService:r}=t,{modelService:i}=eA(),[o,s,l]=Nne({treeData:[],searchList:[],treeNodeList:[],expandedKeys:[],defaultExpandAll:!1,keyword:""});a.default.useEffect((()=>{i.findDeferredModel(e.NsNodeTreePanelModel.id)||i.registerModel({id:e.NsNodeTreePanelModel.id,modelFactory:()=>l,watchChange:t=>$ge(void 0,void 0,void 0,(function*(){const r=yield DT.getModel(i),o=e=>$ge(void 0,void 0,void 0,(function*(){const r=yield n(e,i),{treeData:o,rootNodes:s}=function(e=[]){const t=e=>{const t=Wge(e,"id").reduce(((e,t)=>{const n=t.parentId||zge;e.has(n)||e.set(n,[]);return e.get(n).push(t),e}),new Map);return t},n=t(tW(e));function r(e,t){return e.map((e=>{if(t.has(e.id)){const n=t.get(e.id);e.key=e.id,e.isDirectory=!0,e.children=r(n,t)||[]}else e.isLeaf=!0;return e}))}const i=n.get(zge)||[];return{treeData:r(i,n),rootNodes:i}}(r),a=yield t.getValidValue(),l=a.expandedKeys.length>0?a.expandedKeys:s.map((e=>e.id));return{listData:r,treeData:o,expandedKeys:l}})),s=r.watch((e=>$ge(void 0,void 0,void 0,(function*(){const n=yield o(e);t.setValue({treeNodeList:n.listData,treeData:n.treeData,expandedKeys:n.expandedKeys,defaultExpandAll:!1,keyword:"",searchList:[]})}))));return e.Disposable.create((()=>{s.dispose()}))}))})}),[]);const c=a.default.useCallback((e=>{s((t=>{t.expandedKeys=e}))}),[s]),u=a.default.useCallback((e=>$ge(void 0,void 0,void 0,(function*(){if(!r)return console.warn("searchService is not defined");if(e){const t=yield r(o.treeNodeList,e);s((n=>{n.keyword=e,n.searchList=t}))}else s((e=>{e.keyword="",e.searchList=[]}))}))),[r,o.treeNodeList]);return{state:o,setState:s,onKeywordChange:u,onFolderExpand:c}};var Yge;!function(e){e.id="TREE_PANEL_DATA"}(Yge||(Yge={}));var qge=Object.freeze({__proto__:null,get NsTreePanelData(){return Yge}});const Kge=e=>{const{headerStyle:t,bodyStyle:n,footerStyle:r}=Uge(e),{state:i,onFolderExpand:o,onKeywordChange:s}=Xge(e);return a.default.createElement(a.default.Fragment,null,a.default.createElement(Gge,Object.assign({},e,{state:i,style:t,onKeywordChange:s})),a.default.createElement(Fge,Object.assign({},e,{state:i,style:n,onFolderExpand:o})),a.default.createElement(Bge,Object.assign({},e,{state:i,style:r})))},Zge=e=>{const{state:t}=e,{propsProxy:n}=xge(),r=n.getValue(),i=eA(),o=r.footer&&"function"==typeof r.footer;return a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:`${e.prefixClz}-footer`,style:e.style},o&&a.default.createElement(r.footer,Object.assign(Object.assign({},e),{headerStyle:{},bodyStyle:{},footerStyle:e.style,targetData:t.targetData,targetType:t.targetType,modelService:i.modelService,commandService:i.commandService})),!r.footer&&a.default.createElement("div",{className:`${e.prefixClz}-footer-title`},r.footerText)))},Jge=e=>{const{prefixClz:t,hasSchema:n,state:r}=e,{propsProxy:i}=xge(),o=i.getValue(),s=eA();if(n)return null;const l=o.header&&"function"==typeof o.header;return a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:`${t}-header`,style:e.style},l&&a.default.createElement(o.header,Object.assign(Object.assign({},e),{headerStyle:e.style,bodyStyle:{},footerStyle:{},targetData:r.targetData,targetType:r.targetType,modelService:s.modelService,commandService:s.commandService})),!o.header&&a.default.createElement("div",{className:`${t}-header-title`},o.headerText||"Panel")))};var Qge=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const eme=e=>{const{text:t}=e,n=Qge(e,["text"]);return t?a.default.createElement(i.Tooltip,Object.assign({placement:"left",title:t},n),a.default.createElement("div",{className:"text-truncate"},t)):null};function tme(e){if(e)return a.default.createElement(eme,{text:e})}const nme=e=>{const{schema:n,children:r}=e,[o,s]=t.useState(),{dependencies:l,value:c,defaultValue:u,hidden:h,disabled:d}=n,f=t.useMemo((()=>(null==l?void 0:l.length)?function(e,t){return(n,r)=>e.some((e=>"function"==typeof(null==e?void 0:e.condition)))?("function"==typeof t&&t(void 0),!0):e.some((e=>{const{name:i}=e;return i?!(JB(n,i)===JB(r,i)||("function"==typeof t&&t(i),0)):(console.error("[Schema form]: A dependent name must be provided in the updater when the dependency condition is not a function."),!1)}))}(l,s):void 0),[l]);if("function"!=typeof r)throw new Error("[Schema Form]: chilren of FormItemWrapper should be a render prop.");const p=""===(g=c)||void 0===g?u:c;var g;return f?a.default.createElement(i.Form.Item,{noStyle:!0,shouldUpdate:f},(e=>{const{hidden:t,disabled:i}=function(e,t,n){const{getFieldValue:r,getFieldsValue:i}=e,{dependencies:o,hidden:s,disabled:a}=t;let l=s,c=a;return null==o||o.forEach((e=>{const{name:t,condition:o,hidden:s,disabled:a}=e;if("function"!=typeof o&&n&&t!==n)return;let u=!1;if("function"==typeof o)u=!!o(i());else{if(!t)return void console.error("[Schema form]: A dependent name must be provided in the props genarator when the dependency condition is not a function.");u=r(t)===o}u&&(void 0!==s&&(l=s),void 0!==a&&(c=a))})),{hidden:l,disabled:c}}(e,n,o);return r({hidden:t,disabled:i,initialValue:p})})):r({hidden:h,disabled:d,initialValue:p})},rme=e=>{const{controlSchema:t}=e,{required:n,tooltip:r,extra:o,name:s,label:l,placeholder:c,rules:u}=t;return a.default.createElement(nme,{schema:t},(({disabled:e,hidden:t,initialValue:h})=>a.default.createElement(i.Form.Item,{name:s,label:l,initialValue:h,tooltip:r,extra:tme(o),required:n,hidden:t,rules:u},a.default.createElement(i.Input,{className:"xflow-form-input",allowClear:!0,placeholder:c,disabled:e}))))};var ime={exports:{}};!function(e,t){e.exports=function(){var t,n;function r(){return t.apply(null,arguments)}function i(e){t=e}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function s(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(a(e,t))return!1;return!0}function c(e){return void 0===e}function u(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function h(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function f(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function p(e,t){for(var n in t)a(t,n)&&(e[n]=t[n]);return a(t,"toString")&&(e.toString=t.toString),a(t,"valueOf")&&(e.valueOf=t.valueOf),e}function g(e,t,n,r){return Yn(e,t,n,r,!0).utc()}function m(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function v(e){return null==e._pf&&(e._pf=m()),e._pf}function y(e){if(null==e._isValid){var t=v(e),r=n.call(t.parsedDateParts,(function(e){return null!=e})),i=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return i;e._isValid=i}return e._isValid}function b(e){var t=g(NaN);return null!=e?p(v(t),e):v(t).userInvalidated=!0,t}n=Array.prototype.some?Array.prototype.some:function(e){var t,n=Object(this),r=n.length>>>0;for(t=0;t<r;t++)if(t in n&&e.call(this,n[t],t,n))return!0;return!1};var x=r.momentProperties=[],w=!1;function C(e,t){var n,r,i;if(c(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),c(t._i)||(e._i=t._i),c(t._f)||(e._f=t._f),c(t._l)||(e._l=t._l),c(t._strict)||(e._strict=t._strict),c(t._tzm)||(e._tzm=t._tzm),c(t._isUTC)||(e._isUTC=t._isUTC),c(t._offset)||(e._offset=t._offset),c(t._pf)||(e._pf=v(t)),c(t._locale)||(e._locale=t._locale),x.length>0)for(n=0;n<x.length;n++)c(i=t[r=x[n]])||(e[r]=i);return e}function E(e){C(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===w&&(w=!0,r.updateOffset(this),w=!1)}function _(e){return e instanceof E||null!=e&&null!=e._isAMomentObject}function S(e){!1===r.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function O(e,t){var n=!0;return p((function(){if(null!=r.deprecationHandler&&r.deprecationHandler(null,e),n){var i,o,s,l=[];for(o=0;o<arguments.length;o++){if(i="","object"==typeof arguments[o]){for(s in i+="\n["+o+"] ",arguments[0])a(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];l.push(i)}S(e+"\nArguments: "+Array.prototype.slice.call(l).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)}),t)}var A,k={};function M(e,t){null!=r.deprecationHandler&&r.deprecationHandler(e,t),k[e]||(S(t),k[e]=!0)}function T(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function P(e){var t,n;for(n in e)a(e,n)&&(T(t=e[n])?this[n]=t:this["_"+n]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function D(e,t){var n,r=p({},e);for(n in t)a(t,n)&&(s(e[n])&&s(t[n])?(r[n]={},p(r[n],e[n]),p(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)a(e,n)&&!a(t,n)&&s(e[n])&&(r[n]=p({},r[n]));return r}function N(e){null!=e&&this.set(e)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null,A=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)a(e,t)&&n.push(t);return n};var R={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function I(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return T(r)?r.call(t,n):r}function j(e,t,n){var r=""+Math.abs(e),i=t-r.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var L=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,F=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,G={},B={};function z(e,t,n,r){var i=r;"string"==typeof r&&(i=function(){return this[r]()}),e&&(B[e]=i),t&&(B[t[0]]=function(){return j(i.apply(this,arguments),t[1],t[2])}),n&&(B[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function U(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function V(e){var t,n,r=e.match(L);for(t=0,n=r.length;t<n;t++)B[r[t]]?r[t]=B[r[t]]:r[t]=U(r[t]);return function(t){var i,o="";for(i=0;i<n;i++)o+=T(r[i])?r[i].call(t,e):r[i];return o}}function H(e,t){return e.isValid()?(t=W(t,e.localeData()),G[t]=G[t]||V(t),G[t](e)):e.localeData().invalidDate()}function W(e,t){var n=5;function r(e){return t.longDateFormat(e)||e}for(F.lastIndex=0;n>=0&&F.test(e);)e=e.replace(F,r),F.lastIndex=0,n-=1;return e}var $={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function X(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.match(L).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])}var Y="Invalid date";function q(){return this._invalidDate}var K="%d",Z=/\d{1,2}/;function J(e){return this._ordinal.replace("%d",e)}var Q={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function ee(e,t,n,r){var i=this._relativeTime[n];return T(i)?i(e,t,n,r):i.replace(/%d/i,e)}function te(e,t){var n=this._relativeTime[e>0?"future":"past"];return T(n)?n(t):n.replace(/%s/i,t)}var ne={};function re(e,t){var n=e.toLowerCase();ne[n]=ne[n+"s"]=ne[t]=e}function ie(e){return"string"==typeof e?ne[e]||ne[e.toLowerCase()]:void 0}function oe(e){var t,n,r={};for(n in e)a(e,n)&&(t=ie(n))&&(r[t]=e[n]);return r}var se={};function ae(e,t){se[e]=t}function le(e){var t,n=[];for(t in e)a(e,t)&&n.push({unit:t,priority:se[t]});return n.sort((function(e,t){return e.priority-t.priority})),n}function ce(e){return e%4==0&&e%100!=0||e%400==0}function ue(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function he(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=ue(t)),n}function de(e,t){return function(n){return null!=n?(pe(this,e,n),r.updateOffset(this,t),this):fe(this,e)}}function fe(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function pe(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&ce(e.year())&&1===e.month()&&29===e.date()?(n=he(n),e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),et(n,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function ge(e){return T(this[e=ie(e)])?this[e]():this}function me(e,t){if("object"==typeof e){var n,r=le(e=oe(e));for(n=0;n<r.length;n++)this[r[n].unit](e[r[n].unit])}else if(T(this[e=ie(e)]))return this[e](t);return this}var ve,ye=/\d/,be=/\d\d/,xe=/\d{3}/,we=/\d{4}/,Ce=/[+-]?\d{6}/,Ee=/\d\d?/,_e=/\d\d\d\d?/,Se=/\d\d\d\d\d\d?/,Oe=/\d{1,3}/,Ae=/\d{1,4}/,ke=/[+-]?\d{1,6}/,Me=/\d+/,Te=/[+-]?\d+/,Pe=/Z|[+-]\d\d:?\d\d/gi,De=/Z|[+-]\d\d(?::?\d\d)?/gi,Ne=/[+-]?\d+(\.\d{1,3})?/,Re=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function Ie(e,t,n){ve[e]=T(t)?t:function(e,r){return e&&n?n:t}}function je(e,t){return a(ve,e)?ve[e](t._strict,t._locale):new RegExp(Le(e))}function Le(e){return Fe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,r,i){return t||n||r||i})))}function Fe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}ve={};var Ge={};function Be(e,t){var n,r=t;for("string"==typeof e&&(e=[e]),u(t)&&(r=function(e,n){n[t]=he(e)}),n=0;n<e.length;n++)Ge[e[n]]=r}function ze(e,t){Be(e,(function(e,n,r,i){r._w=r._w||{},t(e,r._w,r,i)}))}function Ue(e,t,n){null!=t&&a(Ge,e)&&Ge[e](t,n._a,n,e)}var Ve,He=0,We=1,$e=2,Xe=3,Ye=4,qe=5,Ke=6,Ze=7,Je=8;function Qe(e,t){return(e%t+t)%t}function et(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=Qe(t,12);return e+=(t-n)/12,1===n?ce(e)?29:28:31-n%7%2}Ve=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},z("M",["MM",2],"Mo",(function(){return this.month()+1})),z("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),z("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),re("month","M"),ae("month",8),Ie("M",Ee),Ie("MM",Ee,be),Ie("MMM",(function(e,t){return t.monthsShortRegex(e)})),Ie("MMMM",(function(e,t){return t.monthsRegex(e)})),Be(["M","MM"],(function(e,t){t[We]=he(e)-1})),Be(["MMM","MMMM"],(function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);null!=i?t[We]=i:v(n).invalidMonth=e}));var tt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),nt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),rt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,it=Re,ot=Re;function st(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||rt).test(t)?"format":"standalone"][e.month()]:o(this._months)?this._months:this._months.standalone}function at(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[rt.test(t)?"format":"standalone"][e.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function lt(e,t,n){var r,i,o,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=g([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=Ve.call(this._shortMonthsParse,s))?i:null:-1!==(i=Ve.call(this._longMonthsParse,s))?i:null:"MMM"===t?-1!==(i=Ve.call(this._shortMonthsParse,s))||-1!==(i=Ve.call(this._longMonthsParse,s))?i:null:-1!==(i=Ve.call(this._longMonthsParse,s))||-1!==(i=Ve.call(this._shortMonthsParse,s))?i:null}function ct(e,t,n){var r,i,o;if(this._monthsParseExact)return lt.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=g([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function ut(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=he(t);else if(!u(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),et(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function ht(e){return null!=e?(ut(this,e),r.updateOffset(this,!0),this):fe(this,"Month")}function dt(){return et(this.year(),this.month())}function ft(e){return this._monthsParseExact?(a(this,"_monthsRegex")||gt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(a(this,"_monthsShortRegex")||(this._monthsShortRegex=it),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function pt(e){return this._monthsParseExact?(a(this,"_monthsRegex")||gt.call(this),e?this._monthsStrictRegex:this._monthsRegex):(a(this,"_monthsRegex")||(this._monthsRegex=ot),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function gt(){function e(e,t){return t.length-e.length}var t,n,r=[],i=[],o=[];for(t=0;t<12;t++)n=g([2e3,t]),r.push(this.monthsShort(n,"")),i.push(this.months(n,"")),o.push(this.months(n,"")),o.push(this.monthsShort(n,""));for(r.sort(e),i.sort(e),o.sort(e),t=0;t<12;t++)r[t]=Fe(r[t]),i[t]=Fe(i[t]);for(t=0;t<24;t++)o[t]=Fe(o[t]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function mt(e){return ce(e)?366:365}z("Y",0,0,(function(){var e=this.year();return e<=9999?j(e,4):"+"+e})),z(0,["YY",2],0,(function(){return this.year()%100})),z(0,["YYYY",4],0,"year"),z(0,["YYYYY",5],0,"year"),z(0,["YYYYYY",6,!0],0,"year"),re("year","y"),ae("year",1),Ie("Y",Te),Ie("YY",Ee,be),Ie("YYYY",Ae,we),Ie("YYYYY",ke,Ce),Ie("YYYYYY",ke,Ce),Be(["YYYYY","YYYYYY"],He),Be("YYYY",(function(e,t){t[He]=2===e.length?r.parseTwoDigitYear(e):he(e)})),Be("YY",(function(e,t){t[He]=r.parseTwoDigitYear(e)})),Be("Y",(function(e,t){t[He]=parseInt(e,10)})),r.parseTwoDigitYear=function(e){return he(e)+(he(e)>68?1900:2e3)};var vt=de("FullYear",!0);function yt(){return ce(this.year())}function bt(e,t,n,r,i,o,s){var a;return e<100&&e>=0?(a=new Date(e+400,t,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(e)):a=new Date(e,t,n,r,i,o,s),a}function xt(e){var t,n;return e<100&&e>=0?((n=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function wt(e,t,n){var r=7+t-n;return-(7+xt(e,0,r).getUTCDay()-t)%7+r-1}function Ct(e,t,n,r,i){var o,s,a=1+7*(t-1)+(7+n-r)%7+wt(e,r,i);return a<=0?s=mt(o=e-1)+a:a>mt(e)?(o=e+1,s=a-mt(e)):(o=e,s=a),{year:o,dayOfYear:s}}function Et(e,t,n){var r,i,o=wt(e.year(),t,n),s=Math.floor((e.dayOfYear()-o-1)/7)+1;return s<1?r=s+_t(i=e.year()-1,t,n):s>_t(e.year(),t,n)?(r=s-_t(e.year(),t,n),i=e.year()+1):(i=e.year(),r=s),{week:r,year:i}}function _t(e,t,n){var r=wt(e,t,n),i=wt(e+1,t,n);return(mt(e)-r+i)/7}function St(e){return Et(e,this._week.dow,this._week.doy).week}z("w",["ww",2],"wo","week"),z("W",["WW",2],"Wo","isoWeek"),re("week","w"),re("isoWeek","W"),ae("week",5),ae("isoWeek",5),Ie("w",Ee),Ie("ww",Ee,be),Ie("W",Ee),Ie("WW",Ee,be),ze(["w","ww","W","WW"],(function(e,t,n,r){t[r.substr(0,1)]=he(e)}));var Ot={dow:0,doy:6};function At(){return this._week.dow}function kt(){return this._week.doy}function Mt(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Tt(e){var t=Et(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Pt(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function Dt(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Nt(e,t){return e.slice(t,7).concat(e.slice(0,t))}z("d",0,"do","day"),z("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),z("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),z("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),z("e",0,0,"weekday"),z("E",0,0,"isoWeekday"),re("day","d"),re("weekday","e"),re("isoWeekday","E"),ae("day",11),ae("weekday",11),ae("isoWeekday",11),Ie("d",Ee),Ie("e",Ee),Ie("E",Ee),Ie("dd",(function(e,t){return t.weekdaysMinRegex(e)})),Ie("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),Ie("dddd",(function(e,t){return t.weekdaysRegex(e)})),ze(["dd","ddd","dddd"],(function(e,t,n,r){var i=n._locale.weekdaysParse(e,r,n._strict);null!=i?t.d=i:v(n).invalidWeekday=e})),ze(["d","e","E"],(function(e,t,n,r){t[r]=he(e)}));var Rt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),It="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),jt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Lt=Re,Ft=Re,Gt=Re;function Bt(e,t){var n=o(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?Nt(n,this._week.dow):e?n[e.day()]:n}function zt(e){return!0===e?Nt(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Ut(e){return!0===e?Nt(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Vt(e,t,n){var r,i,o,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=g([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=Ve.call(this._weekdaysParse,s))?i:null:"ddd"===t?-1!==(i=Ve.call(this._shortWeekdaysParse,s))?i:null:-1!==(i=Ve.call(this._minWeekdaysParse,s))?i:null:"dddd"===t?-1!==(i=Ve.call(this._weekdaysParse,s))||-1!==(i=Ve.call(this._shortWeekdaysParse,s))||-1!==(i=Ve.call(this._minWeekdaysParse,s))?i:null:"ddd"===t?-1!==(i=Ve.call(this._shortWeekdaysParse,s))||-1!==(i=Ve.call(this._weekdaysParse,s))||-1!==(i=Ve.call(this._minWeekdaysParse,s))?i:null:-1!==(i=Ve.call(this._minWeekdaysParse,s))||-1!==(i=Ve.call(this._weekdaysParse,s))||-1!==(i=Ve.call(this._shortWeekdaysParse,s))?i:null}function Ht(e,t,n){var r,i,o;if(this._weekdaysParseExact)return Vt.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=g([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}}function Wt(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Pt(e,this.localeData()),this.add(e-t,"d")):t}function $t(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Xt(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Dt(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function Yt(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||Zt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(a(this,"_weekdaysRegex")||(this._weekdaysRegex=Lt),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function qt(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||Zt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(a(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ft),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Kt(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||Zt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(a(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Gt),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Zt(){function e(e,t){return t.length-e.length}var t,n,r,i,o,s=[],a=[],l=[],c=[];for(t=0;t<7;t++)n=g([2e3,1]).day(t),r=Fe(this.weekdaysMin(n,"")),i=Fe(this.weekdaysShort(n,"")),o=Fe(this.weekdays(n,"")),s.push(r),a.push(i),l.push(o),c.push(r),c.push(i),c.push(o);s.sort(e),a.sort(e),l.sort(e),c.sort(e),this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Jt(){return this.hours()%12||12}function Qt(){return this.hours()||24}function en(e,t){z(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function tn(e,t){return t._meridiemParse}function nn(e){return"p"===(e+"").toLowerCase().charAt(0)}z("H",["HH",2],0,"hour"),z("h",["hh",2],0,Jt),z("k",["kk",2],0,Qt),z("hmm",0,0,(function(){return""+Jt.apply(this)+j(this.minutes(),2)})),z("hmmss",0,0,(function(){return""+Jt.apply(this)+j(this.minutes(),2)+j(this.seconds(),2)})),z("Hmm",0,0,(function(){return""+this.hours()+j(this.minutes(),2)})),z("Hmmss",0,0,(function(){return""+this.hours()+j(this.minutes(),2)+j(this.seconds(),2)})),en("a",!0),en("A",!1),re("hour","h"),ae("hour",13),Ie("a",tn),Ie("A",tn),Ie("H",Ee),Ie("h",Ee),Ie("k",Ee),Ie("HH",Ee,be),Ie("hh",Ee,be),Ie("kk",Ee,be),Ie("hmm",_e),Ie("hmmss",Se),Ie("Hmm",_e),Ie("Hmmss",Se),Be(["H","HH"],Xe),Be(["k","kk"],(function(e,t,n){var r=he(e);t[Xe]=24===r?0:r})),Be(["a","A"],(function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e})),Be(["h","hh"],(function(e,t,n){t[Xe]=he(e),v(n).bigHour=!0})),Be("hmm",(function(e,t,n){var r=e.length-2;t[Xe]=he(e.substr(0,r)),t[Ye]=he(e.substr(r)),v(n).bigHour=!0})),Be("hmmss",(function(e,t,n){var r=e.length-4,i=e.length-2;t[Xe]=he(e.substr(0,r)),t[Ye]=he(e.substr(r,2)),t[qe]=he(e.substr(i)),v(n).bigHour=!0})),Be("Hmm",(function(e,t,n){var r=e.length-2;t[Xe]=he(e.substr(0,r)),t[Ye]=he(e.substr(r))})),Be("Hmmss",(function(e,t,n){var r=e.length-4,i=e.length-2;t[Xe]=he(e.substr(0,r)),t[Ye]=he(e.substr(r,2)),t[qe]=he(e.substr(i))}));var rn=/[ap]\.?m?\.?/i,on=de("Hours",!0);function sn(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}var an,ln={calendar:R,longDateFormat:$,invalidDate:Y,ordinal:K,dayOfMonthOrdinalParse:Z,relativeTime:Q,months:tt,monthsShort:nt,week:Ot,weekdays:Rt,weekdaysMin:jt,weekdaysShort:It,meridiemParse:rn},cn={},un={};function hn(e,t){var n,r=Math.min(e.length,t.length);for(n=0;n<r;n+=1)if(e[n]!==t[n])return n;return r}function dn(e){return e?e.toLowerCase().replace("_","-"):e}function fn(e){for(var t,n,r,i,o=0;o<e.length;){for(t=(i=dn(e[o]).split("-")).length,n=(n=dn(e[o+1]))?n.split("-"):null;t>0;){if(r=pn(i.slice(0,t).join("-")))return r;if(n&&n.length>=t&&hn(i,n)>=t-1)break;t--}o++}return an}function pn(t){var n=null;if(void 0===cn[t]&&e&&e.exports)try{n=an._abbr,d("./locale/"+t),gn(n)}catch(e){cn[t]=null}return cn[t]}function gn(e,t){var n;return e&&((n=c(t)?yn(e):mn(e,t))?an=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),an._abbr}function mn(e,t){if(null!==t){var n,r=ln;if(t.abbr=e,null!=cn[e])M("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=cn[e]._config;else if(null!=t.parentLocale)if(null!=cn[t.parentLocale])r=cn[t.parentLocale]._config;else{if(null==(n=pn(t.parentLocale)))return un[t.parentLocale]||(un[t.parentLocale]=[]),un[t.parentLocale].push({name:e,config:t}),null;r=n._config}return cn[e]=new N(D(r,t)),un[e]&&un[e].forEach((function(e){mn(e.name,e.config)})),gn(e),cn[e]}return delete cn[e],null}function vn(e,t){if(null!=t){var n,r,i=ln;null!=cn[e]&&null!=cn[e].parentLocale?cn[e].set(D(cn[e]._config,t)):(null!=(r=pn(e))&&(i=r._config),t=D(i,t),null==r&&(t.abbr=e),(n=new N(t)).parentLocale=cn[e],cn[e]=n),gn(e)}else null!=cn[e]&&(null!=cn[e].parentLocale?(cn[e]=cn[e].parentLocale,e===gn()&&gn(e)):null!=cn[e]&&delete cn[e]);return cn[e]}function yn(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return an;if(!o(e)){if(t=pn(e))return t;e=[e]}return fn(e)}function bn(){return A(cn)}function xn(e){var t,n=e._a;return n&&-2===v(e).overflow&&(t=n[We]<0||n[We]>11?We:n[$e]<1||n[$e]>et(n[He],n[We])?$e:n[Xe]<0||n[Xe]>24||24===n[Xe]&&(0!==n[Ye]||0!==n[qe]||0!==n[Ke])?Xe:n[Ye]<0||n[Ye]>59?Ye:n[qe]<0||n[qe]>59?qe:n[Ke]<0||n[Ke]>999?Ke:-1,v(e)._overflowDayOfYear&&(t<He||t>$e)&&(t=$e),v(e)._overflowWeeks&&-1===t&&(t=Ze),v(e)._overflowWeekday&&-1===t&&(t=Je),v(e).overflow=t),e}var wn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Cn=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,En=/Z|[+-]\d\d(?::?\d\d)?/,_n=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Sn=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],On=/^\/?Date\((-?\d+)/i,An=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,kn={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Mn(e){var t,n,r,i,o,s,a=e._i,l=wn.exec(a)||Cn.exec(a);if(l){for(v(e).iso=!0,t=0,n=_n.length;t<n;t++)if(_n[t][1].exec(l[1])){i=_n[t][0],r=!1!==_n[t][2];break}if(null==i)return void(e._isValid=!1);if(l[3]){for(t=0,n=Sn.length;t<n;t++)if(Sn[t][1].exec(l[3])){o=(l[2]||" ")+Sn[t][0];break}if(null==o)return void(e._isValid=!1)}if(!r&&null!=o)return void(e._isValid=!1);if(l[4]){if(!En.exec(l[4]))return void(e._isValid=!1);s="Z"}e._f=i+(o||"")+(s||""),zn(e)}else e._isValid=!1}function Tn(e,t,n,r,i,o){var s=[Pn(e),nt.indexOf(t),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function Pn(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Dn(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Nn(e,t,n){return!e||It.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(v(n).weekdayMismatch=!0,n._isValid=!1,!1)}function Rn(e,t,n){if(e)return kn[e];if(t)return 0;var r=parseInt(n,10),i=r%100;return(r-i)/100*60+i}function In(e){var t,n=An.exec(Dn(e._i));if(n){if(t=Tn(n[4],n[3],n[2],n[5],n[6],n[7]),!Nn(n[1],t,e))return;e._a=t,e._tzm=Rn(n[8],n[9],n[10]),e._d=xt.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),v(e).rfc2822=!0}else e._isValid=!1}function jn(e){var t=On.exec(e._i);null===t?(Mn(e),!1===e._isValid&&(delete e._isValid,In(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:r.createFromInputFallback(e)))):e._d=new Date(+t[1])}function Ln(e,t,n){return null!=e?e:null!=t?t:n}function Fn(e){var t=new Date(r.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Gn(e){var t,n,r,i,o,s=[];if(!e._d){for(r=Fn(e),e._w&&null==e._a[$e]&&null==e._a[We]&&Bn(e),null!=e._dayOfYear&&(o=Ln(e._a[He],r[He]),(e._dayOfYear>mt(o)||0===e._dayOfYear)&&(v(e)._overflowDayOfYear=!0),n=xt(o,0,e._dayOfYear),e._a[We]=n.getUTCMonth(),e._a[$e]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=s[t]=r[t];for(;t<7;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Xe]&&0===e._a[Ye]&&0===e._a[qe]&&0===e._a[Ke]&&(e._nextDay=!0,e._a[Xe]=0),e._d=(e._useUTC?xt:bt).apply(null,s),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Xe]=24),e._w&&void 0!==e._w.d&&e._w.d!==i&&(v(e).weekdayMismatch=!0)}}function Bn(e){var t,n,r,i,o,s,a,l,c;null!=(t=e._w).GG||null!=t.W||null!=t.E?(o=1,s=4,n=Ln(t.GG,e._a[He],Et(qn(),1,4).year),r=Ln(t.W,1),((i=Ln(t.E,1))<1||i>7)&&(l=!0)):(o=e._locale._week.dow,s=e._locale._week.doy,c=Et(qn(),o,s),n=Ln(t.gg,e._a[He],c.year),r=Ln(t.w,c.week),null!=t.d?((i=t.d)<0||i>6)&&(l=!0):null!=t.e?(i=t.e+o,(t.e<0||t.e>6)&&(l=!0)):i=o),r<1||r>_t(n,o,s)?v(e)._overflowWeeks=!0:null!=l?v(e)._overflowWeekday=!0:(a=Ct(n,r,i,o,s),e._a[He]=a.year,e._dayOfYear=a.dayOfYear)}function zn(e){if(e._f!==r.ISO_8601)if(e._f!==r.RFC_2822){e._a=[],v(e).empty=!0;var t,n,i,o,s,a,l=""+e._i,c=l.length,u=0;for(i=W(e._f,e._locale).match(L)||[],t=0;t<i.length;t++)o=i[t],(n=(l.match(je(o,e))||[])[0])&&((s=l.substr(0,l.indexOf(n))).length>0&&v(e).unusedInput.push(s),l=l.slice(l.indexOf(n)+n.length),u+=n.length),B[o]?(n?v(e).empty=!1:v(e).unusedTokens.push(o),Ue(o,n,e)):e._strict&&!n&&v(e).unusedTokens.push(o);v(e).charsLeftOver=c-u,l.length>0&&v(e).unusedInput.push(l),e._a[Xe]<=12&&!0===v(e).bigHour&&e._a[Xe]>0&&(v(e).bigHour=void 0),v(e).parsedDateParts=e._a.slice(0),v(e).meridiem=e._meridiem,e._a[Xe]=Un(e._locale,e._a[Xe],e._meridiem),null!==(a=v(e).era)&&(e._a[He]=e._locale.erasConvertYear(a,e._a[He])),Gn(e),xn(e)}else In(e);else Mn(e)}function Un(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((r=e.isPM(n))&&t<12&&(t+=12),r||12!==t||(t=0),t):t}function Vn(e){var t,n,r,i,o,s,a=!1;if(0===e._f.length)return v(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<e._f.length;i++)o=0,s=!1,t=C({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],zn(t),y(t)&&(s=!0),o+=v(t).charsLeftOver,o+=10*v(t).unusedTokens.length,v(t).score=o,a?o<r&&(r=o,n=t):(null==r||o<r||s)&&(r=o,n=t,s&&(a=!0));p(e,n||t)}function Hn(e){if(!e._d){var t=oe(e._i),n=void 0===t.day?t.date:t.day;e._a=f([t.year,t.month,n,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),Gn(e)}}function Wn(e){var t=new E(xn($n(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function $n(e){var t=e._i,n=e._f;return e._locale=e._locale||yn(e._l),null===t||void 0===n&&""===t?b({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),_(t)?new E(xn(t)):(h(t)?e._d=t:o(n)?Vn(e):n?zn(e):Xn(e),y(e)||(e._d=null),e))}function Xn(e){var t=e._i;c(t)?e._d=new Date(r.now()):h(t)?e._d=new Date(t.valueOf()):"string"==typeof t?jn(e):o(t)?(e._a=f(t.slice(0),(function(e){return parseInt(e,10)})),Gn(e)):s(t)?Hn(e):u(t)?e._d=new Date(t):r.createFromInputFallback(e)}function Yn(e,t,n,r,i){var a={};return!0!==t&&!1!==t||(r=t,t=void 0),!0!==n&&!1!==n||(r=n,n=void 0),(s(e)&&l(e)||o(e)&&0===e.length)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=i,a._l=n,a._i=e,a._f=t,a._strict=r,Wn(a)}function qn(e,t,n,r){return Yn(e,t,n,r,!1)}r.createFromInputFallback=O("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),r.ISO_8601=function(){},r.RFC_2822=function(){};var Kn=O("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=qn.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:b()})),Zn=O("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=qn.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:b()}));function Jn(e,t){var n,r;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return qn();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}function Qn(){return Jn("isBefore",[].slice.call(arguments,0))}function er(){return Jn("isAfter",[].slice.call(arguments,0))}var tr=function(){return Date.now?Date.now():+new Date},nr=["year","quarter","month","week","day","hour","minute","second","millisecond"];function rr(e){var t,n,r=!1;for(t in e)if(a(e,t)&&(-1===Ve.call(nr,t)||null!=e[t]&&isNaN(e[t])))return!1;for(n=0;n<nr.length;++n)if(e[nr[n]]){if(r)return!1;parseFloat(e[nr[n]])!==he(e[nr[n]])&&(r=!0)}return!0}function ir(){return this._isValid}function or(){return kr(NaN)}function sr(e){var t=oe(e),n=t.year||0,r=t.quarter||0,i=t.month||0,o=t.week||t.isoWeek||0,s=t.day||0,a=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=rr(t),this._milliseconds=+u+1e3*c+6e4*l+1e3*a*60*60,this._days=+s+7*o,this._months=+i+3*r+12*n,this._data={},this._locale=yn(),this._bubble()}function ar(e){return e instanceof sr}function lr(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function cr(e,t,n){var r,i=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),s=0;for(r=0;r<i;r++)(n&&e[r]!==t[r]||!n&&he(e[r])!==he(t[r]))&&s++;return s+o}function ur(e,t){z(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+j(~~(e/60),2)+t+j(~~e%60,2)}))}ur("Z",":"),ur("ZZ",""),Ie("Z",De),Ie("ZZ",De),Be(["Z","ZZ"],(function(e,t,n){n._useUTC=!0,n._tzm=dr(De,e)}));var hr=/([\+\-]|\d\d)/gi;function dr(e,t){var n,r,i=(t||"").match(e);return null===i?null:0===(r=60*(n=((i[i.length-1]||[])+"").match(hr)||["-",0,0])[1]+he(n[2]))?0:"+"===n[0]?r:-r}function fr(e,t){var n,i;return t._isUTC?(n=t.clone(),i=(_(e)||h(e)?e.valueOf():qn(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),r.updateOffset(n,!1),n):qn(e).local()}function pr(e){return-Math.round(e._d.getTimezoneOffset())}function gr(e,t,n){var i,o=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=dr(De,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(i=pr(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),o!==e&&(!t||this._changeInProgress?Nr(this,kr(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:pr(this)}function mr(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function vr(e){return this.utcOffset(0,e)}function yr(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(pr(this),"m")),this}function br(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=dr(Pe,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function xr(e){return!!this.isValid()&&(e=e?qn(e).utcOffset():0,(this.utcOffset()-e)%60==0)}function wr(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Cr(){if(!c(this._isDSTShifted))return this._isDSTShifted;var e,t={};return C(t,this),(t=$n(t))._a?(e=t._isUTC?g(t._a):qn(t._a),this._isDSTShifted=this.isValid()&&cr(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Er(){return!!this.isValid()&&!this._isUTC}function _r(){return!!this.isValid()&&this._isUTC}function Sr(){return!!this.isValid()&&this._isUTC&&0===this._offset}r.updateOffset=function(){};var Or=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Ar=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function kr(e,t){var n,r,i,o=e,s=null;return ar(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:u(e)||!isNaN(+e)?(o={},t?o[t]=+e:o.milliseconds=+e):(s=Or.exec(e))?(n="-"===s[1]?-1:1,o={y:0,d:he(s[$e])*n,h:he(s[Xe])*n,m:he(s[Ye])*n,s:he(s[qe])*n,ms:he(lr(1e3*s[Ke]))*n}):(s=Ar.exec(e))?(n="-"===s[1]?-1:1,o={y:Mr(s[2],n),M:Mr(s[3],n),w:Mr(s[4],n),d:Mr(s[5],n),h:Mr(s[6],n),m:Mr(s[7],n),s:Mr(s[8],n)}):null==o?o={}:"object"==typeof o&&("from"in o||"to"in o)&&(i=Pr(qn(o.from),qn(o.to)),(o={}).ms=i.milliseconds,o.M=i.months),r=new sr(o),ar(e)&&a(e,"_locale")&&(r._locale=e._locale),ar(e)&&a(e,"_isValid")&&(r._isValid=e._isValid),r}function Mr(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Tr(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Pr(e,t){var n;return e.isValid()&&t.isValid()?(t=fr(t,e),e.isBefore(t)?n=Tr(e,t):((n=Tr(t,e)).milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function Dr(e,t){return function(n,r){var i;return null===r||isNaN(+r)||(M(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=r,r=i),Nr(this,kr(n,r),e),this}}function Nr(e,t,n,i){var o=t._milliseconds,s=lr(t._days),a=lr(t._months);e.isValid()&&(i=null==i||i,a&&ut(e,fe(e,"Month")+a*n),s&&pe(e,"Date",fe(e,"Date")+s*n),o&&e._d.setTime(e._d.valueOf()+o*n),i&&r.updateOffset(e,s||a))}kr.fn=sr.prototype,kr.invalid=or;var Rr=Dr(1,"add"),Ir=Dr(-1,"subtract");function jr(e){return"string"==typeof e||e instanceof String}function Lr(e){return _(e)||h(e)||jr(e)||u(e)||Gr(e)||Fr(e)||null==e}function Fr(e){var t,n,r=s(e)&&!l(e),i=!1,o=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"];for(t=0;t<o.length;t+=1)n=o[t],i=i||a(e,n);return r&&i}function Gr(e){var t=o(e),n=!1;return t&&(n=0===e.filter((function(t){return!u(t)&&jr(e)})).length),t&&n}function Br(e){var t,n,r=s(e)&&!l(e),i=!1,o=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<o.length;t+=1)n=o[t],i=i||a(e,n);return r&&i}function zr(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Ur(e,t){1===arguments.length&&(arguments[0]?Lr(arguments[0])?(e=arguments[0],t=void 0):Br(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var n=e||qn(),i=fr(n,this).startOf("day"),o=r.calendarFormat(this,i)||"sameElse",s=t&&(T(t[o])?t[o].call(this,n):t[o]);return this.format(s||this.localeData().calendar(o,this,qn(n)))}function Vr(){return new E(this)}function Hr(e,t){var n=_(e)?e:qn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=ie(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function Wr(e,t){var n=_(e)?e:qn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=ie(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function $r(e,t,n,r){var i=_(e)?e:qn(e),o=_(t)?t:qn(t);return!!(this.isValid()&&i.isValid()&&o.isValid())&&("("===(r=r||"()")[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(")"===r[1]?this.isBefore(o,n):!this.isAfter(o,n))}function Xr(e,t){var n,r=_(e)?e:qn(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=ie(t)||"millisecond")?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function Yr(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function qr(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Kr(e,t,n){var r,i,o;if(!this.isValid())return NaN;if(!(r=fr(e,this)).isValid())return NaN;switch(i=6e4*(r.utcOffset()-this.utcOffset()),t=ie(t)){case"year":o=Zr(this,r)/12;break;case"month":o=Zr(this,r);break;case"quarter":o=Zr(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:ue(o)}function Zr(e,t){if(e.date()<t.date())return-Zr(t,e);var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,"months");return-(n+(t-r<0?(t-r)/(r-e.clone().add(n-1,"months")):(t-r)/(e.clone().add(n+1,"months")-r)))||0}function Jr(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Qr(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?H(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):T(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",H(n,"Z")):H(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function ei(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,n,r,i="moment",o="";return this.isLocal()||(i=0===this.utcOffset()?"moment.utc":"moment.parseZone",o="Z"),e="["+i+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n="-MM-DD[T]HH:mm:ss.SSS",r=o+'[")]',this.format(e+t+n+r)}function ti(e){e||(e=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var t=H(this,e);return this.localeData().postformat(t)}function ni(e,t){return this.isValid()&&(_(e)&&e.isValid()||qn(e).isValid())?kr({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ri(e){return this.from(qn(),e)}function ii(e,t){return this.isValid()&&(_(e)&&e.isValid()||qn(e).isValid())?kr({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function oi(e){return this.to(qn(),e)}function si(e){var t;return void 0===e?this._locale._abbr:(null!=(t=yn(e))&&(this._locale=t),this)}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var ai=O("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function li(){return this._locale}var ci=1e3,ui=60*ci,hi=60*ui,di=3506328*hi;function fi(e,t){return(e%t+t)%t}function pi(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-di:new Date(e,t,n).valueOf()}function gi(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-di:Date.UTC(e,t,n)}function mi(e){var t,n;if(void 0===(e=ie(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?gi:pi,e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=fi(t+(this._isUTC?0:this.utcOffset()*ui),hi);break;case"minute":t=this._d.valueOf(),t-=fi(t,ui);break;case"second":t=this._d.valueOf(),t-=fi(t,ci)}return this._d.setTime(t),r.updateOffset(this,!0),this}function vi(e){var t,n;if(void 0===(e=ie(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?gi:pi,e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=hi-fi(t+(this._isUTC?0:this.utcOffset()*ui),hi)-1;break;case"minute":t=this._d.valueOf(),t+=ui-fi(t,ui)-1;break;case"second":t=this._d.valueOf(),t+=ci-fi(t,ci)-1}return this._d.setTime(t),r.updateOffset(this,!0),this}function yi(){return this._d.valueOf()-6e4*(this._offset||0)}function bi(){return Math.floor(this.valueOf()/1e3)}function xi(){return new Date(this.valueOf())}function wi(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Ci(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Ei(){return this.isValid()?this.toISOString():null}function _i(){return y(this)}function Si(){return p({},v(this))}function Oi(){return v(this).overflow}function Ai(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function ki(e,t){var n,i,o,s=this._eras||yn("en")._eras;for(n=0,i=s.length;n<i;++n)switch("string"==typeof s[n].since&&(o=r(s[n].since).startOf("day"),s[n].since=o.valueOf()),typeof s[n].until){case"undefined":s[n].until=1/0;break;case"string":o=r(s[n].until).startOf("day").valueOf(),s[n].until=o.valueOf()}return s}function Mi(e,t,n){var r,i,o,s,a,l=this.eras();for(e=e.toUpperCase(),r=0,i=l.length;r<i;++r)if(o=l[r].name.toUpperCase(),s=l[r].abbr.toUpperCase(),a=l[r].narrow.toUpperCase(),n)switch(t){case"N":case"NN":case"NNN":if(s===e)return l[r];break;case"NNNN":if(o===e)return l[r];break;case"NNNNN":if(a===e)return l[r]}else if([o,s,a].indexOf(e)>=0)return l[r]}function Ti(e,t){var n=e.since<=e.until?1:-1;return void 0===t?r(e.since).year():r(e.since).year()+(t-e.offset)*n}function Pi(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].name;if(r[e].until<=n&&n<=r[e].since)return r[e].name}return""}function Di(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].narrow;if(r[e].until<=n&&n<=r[e].since)return r[e].narrow}return""}function Ni(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].abbr;if(r[e].until<=n&&n<=r[e].since)return r[e].abbr}return""}function Ri(){var e,t,n,i,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(n=o[e].since<=o[e].until?1:-1,i=this.clone().startOf("day").valueOf(),o[e].since<=i&&i<=o[e].until||o[e].until<=i&&i<=o[e].since)return(this.year()-r(o[e].since).year())*n+o[e].offset;return this.year()}function Ii(e){return a(this,"_erasNameRegex")||Ui.call(this),e?this._erasNameRegex:this._erasRegex}function ji(e){return a(this,"_erasAbbrRegex")||Ui.call(this),e?this._erasAbbrRegex:this._erasRegex}function Li(e){return a(this,"_erasNarrowRegex")||Ui.call(this),e?this._erasNarrowRegex:this._erasRegex}function Fi(e,t){return t.erasAbbrRegex(e)}function Gi(e,t){return t.erasNameRegex(e)}function Bi(e,t){return t.erasNarrowRegex(e)}function zi(e,t){return t._eraYearOrdinalRegex||Me}function Ui(){var e,t,n=[],r=[],i=[],o=[],s=this.eras();for(e=0,t=s.length;e<t;++e)r.push(Fe(s[e].name)),n.push(Fe(s[e].abbr)),i.push(Fe(s[e].narrow)),o.push(Fe(s[e].name)),o.push(Fe(s[e].abbr)),o.push(Fe(s[e].narrow));this._erasRegex=new RegExp("^("+o.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+r.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+i.join("|")+")","i")}function Vi(e,t){z(0,[e,e.length],0,t)}function Hi(e){return Ki.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Wi(e){return Ki.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function $i(){return _t(this.year(),1,4)}function Xi(){return _t(this.isoWeekYear(),1,4)}function Yi(){var e=this.localeData()._week;return _t(this.year(),e.dow,e.doy)}function qi(){var e=this.localeData()._week;return _t(this.weekYear(),e.dow,e.doy)}function Ki(e,t,n,r,i){var o;return null==e?Et(this,r,i).year:(t>(o=_t(e,r,i))&&(t=o),Zi.call(this,e,t,n,r,i))}function Zi(e,t,n,r,i){var o=Ct(e,t,n,r,i),s=xt(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}function Ji(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}z("N",0,0,"eraAbbr"),z("NN",0,0,"eraAbbr"),z("NNN",0,0,"eraAbbr"),z("NNNN",0,0,"eraName"),z("NNNNN",0,0,"eraNarrow"),z("y",["y",1],"yo","eraYear"),z("y",["yy",2],0,"eraYear"),z("y",["yyy",3],0,"eraYear"),z("y",["yyyy",4],0,"eraYear"),Ie("N",Fi),Ie("NN",Fi),Ie("NNN",Fi),Ie("NNNN",Gi),Ie("NNNNN",Bi),Be(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,n,r){var i=n._locale.erasParse(e,r,n._strict);i?v(n).era=i:v(n).invalidEra=e})),Ie("y",Me),Ie("yy",Me),Ie("yyy",Me),Ie("yyyy",Me),Ie("yo",zi),Be(["y","yy","yyy","yyyy"],He),Be(["yo"],(function(e,t,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=e.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?t[He]=n._locale.eraYearOrdinalParse(e,i):t[He]=parseInt(e,10)})),z(0,["gg",2],0,(function(){return this.weekYear()%100})),z(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),Vi("gggg","weekYear"),Vi("ggggg","weekYear"),Vi("GGGG","isoWeekYear"),Vi("GGGGG","isoWeekYear"),re("weekYear","gg"),re("isoWeekYear","GG"),ae("weekYear",1),ae("isoWeekYear",1),Ie("G",Te),Ie("g",Te),Ie("GG",Ee,be),Ie("gg",Ee,be),Ie("GGGG",Ae,we),Ie("gggg",Ae,we),Ie("GGGGG",ke,Ce),Ie("ggggg",ke,Ce),ze(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,n,r){t[r.substr(0,2)]=he(e)})),ze(["gg","GG"],(function(e,t,n,i){t[i]=r.parseTwoDigitYear(e)})),z("Q",0,"Qo","quarter"),re("quarter","Q"),ae("quarter",7),Ie("Q",ye),Be("Q",(function(e,t){t[We]=3*(he(e)-1)})),z("D",["DD",2],"Do","date"),re("date","D"),ae("date",9),Ie("D",Ee),Ie("DD",Ee,be),Ie("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),Be(["D","DD"],$e),Be("Do",(function(e,t){t[$e]=he(e.match(Ee)[0])}));var Qi=de("Date",!0);function eo(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}z("DDD",["DDDD",3],"DDDo","dayOfYear"),re("dayOfYear","DDD"),ae("dayOfYear",4),Ie("DDD",Oe),Ie("DDDD",xe),Be(["DDD","DDDD"],(function(e,t,n){n._dayOfYear=he(e)})),z("m",["mm",2],0,"minute"),re("minute","m"),ae("minute",14),Ie("m",Ee),Ie("mm",Ee,be),Be(["m","mm"],Ye);var to=de("Minutes",!1);z("s",["ss",2],0,"second"),re("second","s"),ae("second",15),Ie("s",Ee),Ie("ss",Ee,be),Be(["s","ss"],qe);var no,ro,io=de("Seconds",!1);for(z("S",0,0,(function(){return~~(this.millisecond()/100)})),z(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),z(0,["SSS",3],0,"millisecond"),z(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),z(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),z(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),z(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),z(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),z(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),re("millisecond","ms"),ae("millisecond",16),Ie("S",Oe,ye),Ie("SS",Oe,be),Ie("SSS",Oe,xe),no="SSSS";no.length<=9;no+="S")Ie(no,Me);function oo(e,t){t[Ke]=he(1e3*("0."+e))}for(no="S";no.length<=9;no+="S")Be(no,oo);function so(){return this._isUTC?"UTC":""}function ao(){return this._isUTC?"Coordinated Universal Time":""}ro=de("Milliseconds",!1),z("z",0,0,"zoneAbbr"),z("zz",0,0,"zoneName");var lo=E.prototype;function co(e){return qn(1e3*e)}function uo(){return qn.apply(null,arguments).parseZone()}function ho(e){return e}lo.add=Rr,lo.calendar=Ur,lo.clone=Vr,lo.diff=Kr,lo.endOf=vi,lo.format=ti,lo.from=ni,lo.fromNow=ri,lo.to=ii,lo.toNow=oi,lo.get=ge,lo.invalidAt=Oi,lo.isAfter=Hr,lo.isBefore=Wr,lo.isBetween=$r,lo.isSame=Xr,lo.isSameOrAfter=Yr,lo.isSameOrBefore=qr,lo.isValid=_i,lo.lang=ai,lo.locale=si,lo.localeData=li,lo.max=Zn,lo.min=Kn,lo.parsingFlags=Si,lo.set=me,lo.startOf=mi,lo.subtract=Ir,lo.toArray=wi,lo.toObject=Ci,lo.toDate=xi,lo.toISOString=Qr,lo.inspect=ei,"undefined"!=typeof Symbol&&null!=Symbol.for&&(lo[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),lo.toJSON=Ei,lo.toString=Jr,lo.unix=bi,lo.valueOf=yi,lo.creationData=Ai,lo.eraName=Pi,lo.eraNarrow=Di,lo.eraAbbr=Ni,lo.eraYear=Ri,lo.year=vt,lo.isLeapYear=yt,lo.weekYear=Hi,lo.isoWeekYear=Wi,lo.quarter=lo.quarters=Ji,lo.month=ht,lo.daysInMonth=dt,lo.week=lo.weeks=Mt,lo.isoWeek=lo.isoWeeks=Tt,lo.weeksInYear=Yi,lo.weeksInWeekYear=qi,lo.isoWeeksInYear=$i,lo.isoWeeksInISOWeekYear=Xi,lo.date=Qi,lo.day=lo.days=Wt,lo.weekday=$t,lo.isoWeekday=Xt,lo.dayOfYear=eo,lo.hour=lo.hours=on,lo.minute=lo.minutes=to,lo.second=lo.seconds=io,lo.millisecond=lo.milliseconds=ro,lo.utcOffset=gr,lo.utc=vr,lo.local=yr,lo.parseZone=br,lo.hasAlignedHourOffset=xr,lo.isDST=wr,lo.isLocal=Er,lo.isUtcOffset=_r,lo.isUtc=Sr,lo.isUTC=Sr,lo.zoneAbbr=so,lo.zoneName=ao,lo.dates=O("dates accessor is deprecated. Use date instead.",Qi),lo.months=O("months accessor is deprecated. Use month instead",ht),lo.years=O("years accessor is deprecated. Use year instead",vt),lo.zone=O("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",mr),lo.isDSTShifted=O("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Cr);var fo=N.prototype;function po(e,t,n,r){var i=yn(),o=g().set(r,t);return i[n](o,e)}function go(e,t,n){if(u(e)&&(t=e,e=void 0),e=e||"",null!=t)return po(e,t,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=po(e,r,n,"month");return i}function mo(e,t,n,r){"boolean"==typeof e?(u(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,u(t)&&(n=t,t=void 0),t=t||"");var i,o=yn(),s=e?o._week.dow:0,a=[];if(null!=n)return po(t,(n+s)%7,r,"day");for(i=0;i<7;i++)a[i]=po(t,(i+s)%7,r,"day");return a}function vo(e,t){return go(e,t,"months")}function yo(e,t){return go(e,t,"monthsShort")}function bo(e,t,n){return mo(e,t,n,"weekdays")}function xo(e,t,n){return mo(e,t,n,"weekdaysShort")}function wo(e,t,n){return mo(e,t,n,"weekdaysMin")}fo.calendar=I,fo.longDateFormat=X,fo.invalidDate=q,fo.ordinal=J,fo.preparse=ho,fo.postformat=ho,fo.relativeTime=ee,fo.pastFuture=te,fo.set=P,fo.eras=ki,fo.erasParse=Mi,fo.erasConvertYear=Ti,fo.erasAbbrRegex=ji,fo.erasNameRegex=Ii,fo.erasNarrowRegex=Li,fo.months=st,fo.monthsShort=at,fo.monthsParse=ct,fo.monthsRegex=pt,fo.monthsShortRegex=ft,fo.week=St,fo.firstDayOfYear=kt,fo.firstDayOfWeek=At,fo.weekdays=Bt,fo.weekdaysMin=Ut,fo.weekdaysShort=zt,fo.weekdaysParse=Ht,fo.weekdaysRegex=Yt,fo.weekdaysShortRegex=qt,fo.weekdaysMinRegex=Kt,fo.isPM=nn,fo.meridiem=sn,gn("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===he(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),r.lang=O("moment.lang is deprecated. Use moment.locale instead.",gn),r.langData=O("moment.langData is deprecated. Use moment.localeData instead.",yn);var Co=Math.abs;function Eo(){var e=this._data;return this._milliseconds=Co(this._milliseconds),this._days=Co(this._days),this._months=Co(this._months),e.milliseconds=Co(e.milliseconds),e.seconds=Co(e.seconds),e.minutes=Co(e.minutes),e.hours=Co(e.hours),e.months=Co(e.months),e.years=Co(e.years),this}function _o(e,t,n,r){var i=kr(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function So(e,t){return _o(this,e,t,1)}function Oo(e,t){return _o(this,e,t,-1)}function Ao(e){return e<0?Math.floor(e):Math.ceil(e)}function ko(){var e,t,n,r,i,o=this._milliseconds,s=this._days,a=this._months,l=this._data;return o>=0&&s>=0&&a>=0||o<=0&&s<=0&&a<=0||(o+=864e5*Ao(To(a)+s),s=0,a=0),l.milliseconds=o%1e3,e=ue(o/1e3),l.seconds=e%60,t=ue(e/60),l.minutes=t%60,n=ue(t/60),l.hours=n%24,s+=ue(n/24),a+=i=ue(Mo(s)),s-=Ao(To(i)),r=ue(a/12),a%=12,l.days=s,l.months=a,l.years=r,this}function Mo(e){return 4800*e/146097}function To(e){return 146097*e/4800}function Po(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;if("month"===(e=ie(e))||"quarter"===e||"year"===e)switch(t=this._days+r/864e5,n=this._months+Mo(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(To(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function Do(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*he(this._months/12):NaN}function No(e){return function(){return this.as(e)}}var Ro=No("ms"),Io=No("s"),jo=No("m"),Lo=No("h"),Fo=No("d"),Go=No("w"),Bo=No("M"),zo=No("Q"),Uo=No("y");function Vo(){return kr(this)}function Ho(e){return e=ie(e),this.isValid()?this[e+"s"]():NaN}function Wo(e){return function(){return this.isValid()?this._data[e]:NaN}}var $o=Wo("milliseconds"),Xo=Wo("seconds"),Yo=Wo("minutes"),qo=Wo("hours"),Ko=Wo("days"),Zo=Wo("months"),Jo=Wo("years");function Qo(){return ue(this.days()/7)}var es=Math.round,ts={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function ns(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function rs(e,t,n,r){var i=kr(e).abs(),o=es(i.as("s")),s=es(i.as("m")),a=es(i.as("h")),l=es(i.as("d")),c=es(i.as("M")),u=es(i.as("w")),h=es(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return null!=n.w&&(d=d||u<=1&&["w"]||u<n.w&&["ww",u]),(d=d||c<=1&&["M"]||c<n.M&&["MM",c]||h<=1&&["y"]||["yy",h])[2]=t,d[3]=+e>0,d[4]=r,ns.apply(null,d)}function is(e){return void 0===e?es:"function"==typeof e&&(es=e,!0)}function os(e,t){return void 0!==ts[e]&&(void 0===t?ts[e]:(ts[e]=t,"s"===e&&(ts.ss=t-1),!0))}function ss(e,t){if(!this.isValid())return this.localeData().invalidDate();var n,r,i=!1,o=ts;return"object"==typeof e&&(t=e,e=!1),"boolean"==typeof e&&(i=e),"object"==typeof t&&(o=Object.assign({},ts,t),null!=t.s&&null==t.ss&&(o.ss=t.s-1)),r=rs(this,!i,o,n=this.localeData()),i&&(r=n.pastFuture(+this,r)),n.postformat(r)}var as=Math.abs;function ls(e){return(e>0)-(e<0)||+e}function cs(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,r,i,o,s,a,l=as(this._milliseconds)/1e3,c=as(this._days),u=as(this._months),h=this.asSeconds();return h?(e=ue(l/60),t=ue(e/60),l%=60,e%=60,n=ue(u/12),u%=12,r=l?l.toFixed(3).replace(/\.?0+$/,""):"",i=h<0?"-":"",o=ls(this._months)!==ls(h)?"-":"",s=ls(this._days)!==ls(h)?"-":"",a=ls(this._milliseconds)!==ls(h)?"-":"",i+"P"+(n?o+n+"Y":"")+(u?o+u+"M":"")+(c?s+c+"D":"")+(t||e||l?"T":"")+(t?a+t+"H":"")+(e?a+e+"M":"")+(l?a+r+"S":"")):"P0D"}var us=sr.prototype;return us.isValid=ir,us.abs=Eo,us.add=So,us.subtract=Oo,us.as=Po,us.asMilliseconds=Ro,us.asSeconds=Io,us.asMinutes=jo,us.asHours=Lo,us.asDays=Fo,us.asWeeks=Go,us.asMonths=Bo,us.asQuarters=zo,us.asYears=Uo,us.valueOf=Do,us._bubble=ko,us.clone=Vo,us.get=Ho,us.milliseconds=$o,us.seconds=Xo,us.minutes=Yo,us.hours=qo,us.days=Ko,us.weeks=Qo,us.months=Zo,us.years=Jo,us.humanize=ss,us.toISOString=cs,us.toString=cs,us.toJSON=cs,us.locale=si,us.localeData=li,us.toIsoString=O("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",cs),us.lang=ai,z("X",0,0,"unix"),z("x",0,0,"valueOf"),Ie("x",Te),Ie("X",Ne),Be("X",(function(e,t,n){n._d=new Date(1e3*parseFloat(e))})),Be("x",(function(e,t,n){n._d=new Date(he(e))})),
//! moment.js
r.version="2.29.1",i(qn),r.fn=lo,r.min=Qn,r.max=er,r.now=tr,r.utc=g,r.unix=co,r.months=vo,r.isDate=h,r.locale=gn,r.invalid=b,r.duration=kr,r.isMoment=_,r.weekdays=bo,r.parseZone=uo,r.localeData=yn,r.isDuration=ar,r.monthsShort=yo,r.weekdaysMin=wo,r.defineLocale=mn,r.updateLocale=vn,r.locales=bn,r.weekdaysShort=xo,r.normalizeUnits=ie,r.relativeTimeRounding=is,r.relativeTimeThreshold=os,r.calendarFormat=zr,r.prototype=lo,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},r}()}(ime);var ome=ime.exports;const sme=e=>{const{className:n,style:r,disabled:o,value:s,onChange:l}=e,[c,u]=t.useState(s?ome(s):void 0),h=t.useRef(!1);t.useEffect((()=>{if(!h.current)return void(h.current=!0);const e=ome(s);e.isValid()&&u(e)}),[s]);const d=t.useCallback(((e,t)=>{const n=ome(t);u(n.isValid()?n:void 0),"function"==typeof l&&l(n.isValid()?n.format("YYYY-MM-DD HH:mm:ss"):"")}),[l]);return a.default.createElement(i.DatePicker,{showTime:!0,allowClear:!0,className:n,style:r,disabled:o,value:c,onChange:d})};function ame(e){const t=Number(e);return Number.isNaN(t)?void 0:t}const lme=e=>{const{disabled:n,placeholder:r,value:o,onChange:s}=e,[l,c]=t.useState(ame(o)),u=t.useRef(!1);t.useEffect((()=>{u.current||(u.current=!0),c(ame(o))}),[o]);const h=t.useCallback((e=>{c(e),"function"==typeof s&&(void 0===e?s(""):"number"==typeof ame(e)&&s(ame(e)))}),[s]);return a.default.createElement(i.InputNumber,{style:{width:"100%"},size:"small",placeholder:r,value:l,onChange:h,disabled:n})};var cme;!function(e){e.INPUT="input",e.CHECKBOX="checkbox",e.TEXTAREA="textArea",e.SELECT="select",e.DATETIME="datetime",e.FLOAT="float"}(cme||(cme={}));var ume=Object.freeze({__proto__:null,get ControlShape(){return cme}});const hme=[[cme.INPUT,rme],[cme.CHECKBOX,e=>{const{controlSchema:t}=e,{required:n,tooltip:r,extra:o,name:s,label:l,rules:c}=t;return a.default.createElement(nme,{schema:t},(({hidden:e,disabled:t,initialValue:u})=>a.default.createElement(i.Form.Item,{className:"xflow-form-checkbox",name:s,rules:c,initialValue:u,tooltip:r,extra:tme(o),required:n,hidden:e,valuePropName:"checked",getValueProps:e=>({checked:!!{true:!0,false:!1}[e]})},a.default.createElement(i.Checkbox,{disabled:t},l))))}],[cme.TEXTAREA,e=>{const{controlSchema:t}=e,{required:n,tooltip:r,extra:o,name:s,label:l,placeholder:c,rules:u}=t;return a.default.createElement(nme,{schema:t},(({hidden:e,disabled:t,initialValue:h})=>a.default.createElement(i.Form.Item,{name:s,label:l,initialValue:h,tooltip:r,extra:tme(o),required:n,hidden:e,rules:u},a.default.createElement(i.Input.TextArea,{allowClear:!0,placeholder:c,rows:3,disabled:t}))))}],[cme.DATETIME,e=>{const{controlSchema:t}=e,{required:n,tooltip:r,extra:o,name:s,label:l,rules:c}=t;return a.default.createElement(nme,{schema:t},(({disabled:e,hidden:t,initialValue:u})=>a.default.createElement(i.Form.Item,{name:s,label:l,initialValue:u,tooltip:r,extra:tme(o),required:n,hidden:t,rules:c},a.default.createElement(sme,{style:{width:"100%"},disabled:e}))))}],[cme.SELECT,e=>{const{controlSchema:t}=e,{required:n,tooltip:r,extra:o,name:s,label:l,placeholder:c,options:u=[],rules:h}=t;return a.default.createElement(nme,{schema:t},(({hidden:e,disabled:t,initialValue:d})=>a.default.createElement(i.Form.Item,{name:s,label:l,initialValue:d,tooltip:r,extra:tme(o),required:n,hidden:e,rules:h},a.default.createElement(i.Select,{disabled:t,placeholder:c},u.map((e=>{const{title:t,value:n}=e;return a.default.createElement(i.Select.Option,{key:n.toString(),value:n},t)}))))))}],[cme.FLOAT,e=>{const{controlSchema:t}=e,{required:n,tooltip:r,extra:o,name:s,label:l,placeholder:c,rules:u}=t;return a.default.createElement(nme,{schema:t},(({disabled:e,hidden:t,initialValue:h})=>a.default.createElement(i.Form.Item,{name:s,label:l,initialValue:h,tooltip:r,extra:tme(o),required:n,hidden:t,rules:u},a.default.createElement(lme,{placeholder:c,disabled:e}))))}]],dme=e=>{const t=new Map;return e.forEach((e=>{const[n,r]=e,i=n.toLowerCase();t.has(i)&&console.error(`${n} is duplicated in controlMap:`,t),t.set(i,r)})),t};var fme=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const{TabPane:pme}=i.Tabs,gme=e=>{var n;const{schema:r,form:o,className:s,triggerUpdate:l,defaultControlRender:c,afterUpdatingCb:u,controlMap:h}=e,d=fme(e,["schema","form","className","triggerUpdate","defaultControlRender","afterUpdatingCb","controlMap"]),{tabs:f}=r,[p]=i.Form.useForm(o),g=a.default.useMemo((()=>e.controlMap?e.controlMap:dme(hme)),[e.controlMap]),m=t.useCallback((e=>{"function"==typeof l&&l(p,e)}),[p,l]);t.useEffect((()=>{p.setFieldsValue({})}),[p]);const v=t.useCallback((()=>{requestAnimationFrame((()=>{p.setFieldsValue({})}))}),[p]);return a.default.createElement(i.Form,Object.assign({size:"small",form:p,layout:"vertical",className:hr("xflow-json-form",s)},d),a.default.createElement(i.Tabs,{type:"card",defaultActiveKey:null===(n=f[0])||void 0===n?void 0:n.name,className:hr({tabs:!0,xTab:!0,singleTab:1===(null==f?void 0:f.length),coupleTab:2===(null==f?void 0:f.length),ternateTab:3===(null==f?void 0:f.length)}),onTabClick:v},f.map((e=>{const{name:t,groups:n}=e;return a.default.createElement(pme,{key:t,tab:t},0===n.length&&a.default.createElement(i.Empty,{style:{padding:"24px 0"}}),n.length>0&&n.map((e=>{const{controls:t=[]}=e;return 0===t.length?a.default.createElement(i.Empty,{style:{padding:"24px 0"}}):t.map((e=>{const{shape:t,name:n}=e,r=((e,t,n=rme)=>{if(t.has(e))return t.get(e);const r=e.toLowerCase();return t.has(r)?t.get(r):(console.warn(`${e} is not exist in controlmap, fallback to defaultControl`),n)})(t,g,c);return r?a.default.createElement(r,{key:n,form:p,controlSchema:e,triggerUpdate:m,afterUpdatingCb:u}):(console.error("未找到对应的控件:",t),null)}))})))}))))},mme=e=>{const{schema:t={tabs:[]},triggerUpdate:n,onFieldsChange:r,afterUpdatingCb:o,defaultControlRender:s,loading:l,controlMapService:c,defaultControls:u=[]}=e,h=a.default.useMemo((()=>{const e=dme([...hme,...u]);return c&&c(e),e}),[c,u]);return l?a.default.createElement("div",{className:`${e.prefixClz}-body`,style:Object.assign(Object.assign({},e.style),{display:"flex",justifyContent:"center",alignItems:"center"})},a.default.createElement(i.Spin,{spinning:!0})):a.default.createElement("div",{className:`${e.prefixClz}-body`,style:e.style},t.tabs.length>0&&a.default.createElement(gme,{schema:t,onFieldsChange:r,controlMap:h,defaultControlRender:s,afterUpdatingCb:o,triggerUpdate:n}),0===t.tabs.length&&a.default.createElement(i.Empty,{style:{paddingTop:"64px"}}))};var vme=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};e.NsJsonSchemaFormModel=void 0,function(e){e.id="XFLOW_JSON_SCHEMA_FORM",e.useModel=t=>vme(this,void 0,void 0,(function*(){return t.awaitModel(e.id)}))}(e.NsJsonSchemaFormModel||(e.NsJsonSchemaFormModel={}));const yme=t=>{const n=eA(),{commandService:r,modelService:i}=n,{formSchemaService:o}=t,[s,l,c,u]=Nne({schema:{tabs:[]},targetType:null,targetData:null,targetCell:null,loading:!1});return a.default.useEffect((()=>{if(!n||!n.modelService)return;const s=new V_;if(!n.modelService.findDeferredModel(e.NsJsonSchemaFormModel.id)){const a=n.modelService.registerModel({id:e.NsJsonSchemaFormModel.id,modelFactory:()=>c,watchChange:(n,a)=>vme(void 0,void 0,void 0,(function*(){const l=(yield ET.getModel(a)).watch((e=>vme(void 0,void 0,void 0,(function*(){const s=(a=e)?a.isNode&&a.isNode()&&a.getProp("isGroup")?"group":a.isNode&&a.isNode()?"node":a.isEdge&&a.isEdge()?"edge":"canvas":"canvas";var a;(t.targetType||["node","canvas"]).includes(s)&&(yield((e,t)=>vme(void 0,void 0,void 0,(function*(){n.setValue((e=>{e.loading=!0,e.schema={tabs:[]},e.targetType=null,e.targetData=null,e.targetCell=null}));const s=e?e.getData():null;if(!o)return;const a=yield o({commandService:r,modelService:i,targetData:s,cell:e,targetType:t});n.setValue({loading:!1,schema:a,targetType:t,targetCell:e,targetData:s})})))(e,s))}))));return e.Disposable.create((()=>{l.dispose(),s.push(l)}))}))});s.push(a)}return()=>{s.dispose()}}),[]),{commandService:r,modelService:i,state:s,setState:l,model:c,isModelReady:u}};var bme=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const xme=e=>{const{prefixClz:t}=e,{getCustomRenderComponent:n,afterUpdatingCb:r,formValueUpdateService:i=(()=>{})}=e,{state:o,commandService:s,modelService:l}=yme(e),c=a.default.useCallback(((e,t={})=>bme(void 0,void 0,void 0,(function*(){e.setFieldsValue(t);const n=Object.entries(t).map((([e,t])=>({name:e,value:t}))),a=Object.entries(o.targetData).map((([e,t])=>({name:e,value:t}))),c=yield i({allFields:a,values:n,modelService:l,commandService:s,targetData:o.targetData,targetType:o.targetType});r&&r(c)}))),[r,s,i,l,o.targetData,o.targetType]),u=a.default.useCallback(((e,t)=>bme(void 0,void 0,void 0,(function*(){const n=yield i({values:e,allFields:t,modelService:l,commandService:s,targetData:o.targetData,targetType:o.targetType});r&&r(n)}))),[r,s,i,l,o.targetData,o.targetType]),h=a.default.useMemo((()=>{try{return 0===o.schema.tabs.length||!o.schema}catch(e){return!0}}),[o.schema]),{headerStyle:d,bodyStyle:f,footerStyle:p}=((e,t)=>{const n=e&&e.headerPosition&&e.headerPosition.height||40,r=e.footerPosition&&e.footerPosition.height||40;return{headerStyle:lP(Object.assign(Object.assign({height:0,top:0,left:0,right:0},t?{height:n,lineHeight:n}:{}),e.headerPosition)),bodyStyle:lP(Object.assign(Object.assign({left:0,right:0,top:0},t?{top:n,bottom:r}:{bottom:r}),e.bodyPosition)),footerStyle:lP(Object.assign(Object.assign({left:0,right:0,lineHeight:r,height:r,bottom:0},t?{lineHeight:r,height:r}:{bottom:0}),e.footerPosition))}})(e,h);if(n){const t=n(o.targetType,o.targetData,l,s);if(t)return a.default.createElement(t,Object.assign(Object.assign({},e),{headerStyle:d,bodyStyle:f,footerStyle:p,targetData:o.targetData,targetType:o.targetType,modelService:l,commandService:s}))}return a.default.createElement("div",{className:t},a.default.createElement(Jge,Object.assign({hasSchema:!h},e,{state:o,style:d,prefixClz:e.prefixClz})),a.default.createElement(mme,Object.assign({},e,{key:o.targetData&&o.targetData.id,style:f,prefixClz:e.prefixClz,loading:o.loading,schema:o.schema,triggerUpdate:c,onFieldsChange:u})),a.default.createElement(Zge,Object.assign({},e,{state:o,style:p})))},wme=e=>{const t=oP("json-schema-form");return a.default.createElement(wge,Object.assign({},e,{className:t}),a.default.createElement(xme,Object.assign({},e,{prefixClz:t})))};Qw.registry.exist(Ege)||y_.registerConnector(Ege,((e,t)=>{const n=Math.abs(t.y-e.y),r=Math.floor(n/3*2),i=e.x,o=e.y+16+r,s=t.x,a=t.y-16-r;return Qm.normalize(`M ${e.x} ${e.y}\n         L ${e.x} ${e.y+16}\n         C ${i} ${o} ${s} ${a} ${t.x} ${t.y-16}\n         L ${t.x} ${t.y}\n        `)}),!0),Qw.registry.exist(_ge)||y_.registerConnector(_ge,((e,t)=>{const n=Math.abs(t.y-e.y),r=e.x,i=e.y+4+n,o=t.x,s=t.y-4-n;return Qm.normalize(`M ${e.x} ${e.y}\n       L ${e.x} ${e.y+4}\n       C ${r} ${i} ${o} ${s} ${t.x} ${t.y-4}\n       L ${t.x} ${t.y}\n      `)}),!0),Qw.registry.exist(Cge)||y_.registerConnector(Cge,((e,t)=>{const n=Math.abs(t.y-e.y),r=Math.floor(n/3*2),i=e.x,o=e.y+4+r,s=t.x,a=t.y-4-r;return Qm.normalize(`M ${e.x} ${e.y}\n         L ${e.x} ${e.y+4}\n         C ${i} ${o} ${s} ${a} ${t.x} ${t.y-4}\n         L ${t.x} ${t.y}\n        `)}),!0);let Cme=FC.registry.get(Sge);FC.registry.exist(Sge)||(Cme=FC.registry.register(Sge,FC.define({zIndex:1,highlight:!1,connector:{name:Ege},shape:Sge}),!0));var Eme=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},_me=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Sme=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};e.NsGraphStatusCommand=void 0,function(t){let n;t.MODEL=e.GRAPH_STATUS_INFO,t.command=e.XFlowDagCommands.QUERY_GRAPH_STATUS,t.hookKey="queryGraphStatus",function(e){e.SUCCESS="success",e.PROCESSING="processing",e.ERROR="error",e.DEFAULT="default",e.WARNING="warning"}(n=t.StatusEnum||(t.StatusEnum={})),t.initStatusMap=()=>({[t.StatusEnum.DEFAULT]:[],[t.StatusEnum.PROCESSING]:[],[t.StatusEnum.ERROR]:[],[t.StatusEnum.WARNING]:[],[t.StatusEnum.SUCCESS]:[]}),t.groupByStatus=e=>{const n=t.initStatusMap();return Object.entries(e).reduce(((e,[t,n])=>(e[n.status].push(t),e)),n)},t.statusDiff=(e,t)=>{const n=new Set([...e,...t]),r={current:[],add:[],remove:[]};return n.forEach((n=>{t.includes(n)&&!e.includes(n)&&r.add.push(n),!t.includes(n)&&e.includes(n)&&r.remove.push(n)})),r},t.shouldStop=e=>Sme(this,void 0,void 0,(function*(){return[n.ERROR,n.SUCCESS].includes(e.graphStatus)}))}(e.NsGraphStatusCommand||(e.NsGraphStatusCommand={}));let Ome=class{constructor(){this.statusInfo=e.NsGraphStatusCommand.initStatusMap(),this.getStatusModel=()=>Sme(this,void 0,void 0,(function*(){const t=this.contextProvider().getModelService();return yield e.GRAPH_STATUS_INFO.getModel(t)})),this.updateModelValue=e=>Sme(this,void 0,void 0,(function*(){(yield this.getStatusModel()).setValue(e)})),this.stopCurrentStatusLooping=()=>Sme(this,void 0,void 0,(function*(){const e=yield this.getStatusModel(),{subscription:t}=yield e.getValidValue();t.dispose()})),this.addStopDispose=()=>Sme(this,void 0,void 0,(function*(){const t=yield this.getStatusModel(),{subscription:n}=yield t.getValidValue();n.push({dispose:()=>{this.updateEdges(this.statusInfo,e.NsGraphStatusCommand.initStatusMap()),this.isLooping=!1}})})),this.updateGraph=(e,t,n)=>{this.updateNodes(e,t,n),this.updateEdges(e,t)},this.updateNodeData=(e,t)=>{const n=this.x6Graph.getCellById(e);n&&n.setData(Object.assign(Object.assign(Object.assign(Object.assign({},n.getData()),n.getSize()),n.getPosition()),t))},this.updateNodes=(t,n,r)=>{Object.keys(t).forEach((i=>{const o=e.NsGraphStatusCommand.statusDiff(t[i],n[i]);o.add.forEach((e=>{this.updateNodeData(e,r[e])})),o.remove.forEach((e=>{this.updateNodeData(e,r[e])}))}))},this.updateEdges=(t,n)=>{const r=e.NsGraphStatusCommand.statusDiff(t.processing,n.processing);this.x6Graph.getEdges().forEach((e=>{var t;const n=null===(t=this.x6Graph)||void 0===t?void 0:t.findViewByCell(e.id),i=e.getTargetCellId();if(!i)return;const o=i.toString();return n?r.add.includes(o)?n.addClass(Age):r.remove.includes(o)?n.removeClass(Age):void 0:void 0}))},this.execute=()=>Sme(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:r}=t.getArgs(),i=t.getHooks();this.x6Graph=yield t.getX6Graph();const o=yield i.queryGraphStatus.call(n,(t=>Sme(this,void 0,void 0,(function*(){const{graphStatusService:n,shouldStop:r=e.NsGraphStatusCommand.shouldStop,doOnce:i}=t;yield this.stopCurrentStatusLooping();const o=(n,i=1e4)=>Sme(this,void 0,void 0,(function*(){const s=yield n(t);this.updateModelValue((e=>{Object.entries(s.statusMap).forEach((([t,n])=>{e.statusMap.set(t,n)})),e.graphStatus=s.graphStatus}));const a=e.NsGraphStatusCommand.groupByStatus(s.statusMap);if(this.updateGraph(this.statusInfo,a,s.statusMap),this.statusInfo=a,yield Yne(i),this.isLooping){if(r){if(yield r(s,t))return}yield o(n,i)}}));return this.isLooping=void 0===t.loop||t.loop,yield this.addStopDispose(),i&&(yield i(t)),o(n,t.loopInterval),{}}))),r);return t.setResult(o),this})),this.undo=()=>Sme(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>Sme(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};Eme([Wn(oM),_me("design:type",Object)],Ome.prototype,"contextProvider",void 0),Ome=Eme([Vn({token:{token:iM,named:e.NsGraphStatusCommand.command.id}})],Ome);var Ame,kme=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Mme=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Tme=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.EVENT_NAME="ADD_EDGE_CMD_EVENT"}(Ame||(Ame={}));const Pme={keyboard:{enabled:!0},selecting:{enabled:!0,multiple:!0,selectCellOnMoved:!0,showNodeSelectionBox:!1,rubberEdge:!0,rubberNode:!0,movable:!0},connecting:{sourceAnchor:"bottom",targetAnchor:"center",connectionPoint:"anchor",snap:{radius:20},router:{name:"manhattan"},connector:{name:Ege,args:{radius:15}},highlight:!0,dangling:!1,createEdge(){const e=this,t=new Cme({attrs:{line:{strokeDasharray:"5 5",stroke:"#888",strokeWidth:1,targetMarker:{name:"block",args:{size:"6"}}}}});return e.once("edge:connected",(n=>{const{isNew:r}=n,i=n.edge;if(r&&i.isEdge()){const n=i.getTargetPortId(),r=i.getTargetCell();if(r&&r.isNode()){r.setPortProp(n,"connected",!1),i.attr({line:{strokeDasharray:"",targetMarker:"",stroke:"#d5d5d5"}});const o=i.getTargetPortId(),s=i.getSourcePortId(),a=i.getSourceCellId(),l=i.getTargetCellId();e.trigger(Ame.EVENT_NAME,{targetPortId:o,sourcePortId:s,source:a,target:l,edge:t})}}})),t},validateEdge:e=>{var t;const{edge:n}=e;return!!(null===(t=null==n?void 0:n.target)||void 0===t?void 0:t.port)},validateMagnet:({magnet:t})=>t.getAttribute("port-group")!==e.NsGraph.AnchorGroup.TOP,validateConnection({sourceView:t,targetView:n,sourceMagnet:r,targetMagnet:i}){if(t===n)return!1;if(!r||r.getAttribute("port-group")===e.NsGraph.AnchorGroup.TOP)return!1;if(!i||i.getAttribute("port-group")!==e.NsGraph.AnchorGroup.TOP)return!1;const o=n.cell,s=i.getAttribute("port"),a=o.getPort(s);return!(a&&a.connected)}},highlighting:{nodeAvailable:{name:"className",args:{className:"available"}},magnetAvailable:{name:"className",args:{className:"available"}},magnetAdsorbed:{name:"className",args:{className:"adsorbed"}}},scaling:{max:1.05,min:.01}};let Dme=class{constructor(){this.registerGraphCommands=t=>{t.registerCommand(e.NsGraphStatusCommand.command,{createCommand:this.commandFactory})},this.toDispose=new V_,this.registerHook=t=>Tme(this,void 0,void 0,(function*(){const n=new V_,r=[t.addNode.registerHook({name:"dag-add-node",handler:e=>Tme(this,void 0,void 0,(function*(){e.cellFactory=e=>Tme(this,void 0,void 0,(function*(){return new Mge(Object.assign({},e))}))}))}),t.addEdge.registerHook({name:"dag-add-edge",handler:e=>Tme(this,void 0,void 0,(function*(){e.cellFactory=e=>Tme(this,void 0,void 0,(function*(){return new Cme(Object.assign(Object.assign({},e),{id:e.id,source:{cell:e.source,port:e.sourcePortId,anchor:{name:"bottom"}},target:{cell:e.target,port:e.targetPortId,anchor:{name:"center"}},attrs:{line:{strokeDasharray:"",targetMarker:"",stroke:"#d5d5d5",strokeWidth:1}},data:Object.assign({},e)}))}))}))}),t.addEdge.registerHook({name:"after add edge, set target port props",handler:(e,t)=>Tme(this,void 0,void 0,(function*(){return e=>Tme(this,void 0,void 0,(function*(){const n=yield t(e),r=n.edgeCell.getTargetCell(),i=n.edgeCell.getTargetPortId();return r.setPortProp(i,"connected",!0),n}))}))}),t.delEdge.registerHook({name:"afetr del edge, reset target node port props",handler:(e,t)=>Tme(this,void 0,void 0,(function*(){return e=>Tme(this,void 0,void 0,(function*(){const n=yield t(e),{targetCell:r,targetPortId:i}=n;return r&&r.isNode()&&i&&r.setPortProp(i,"connected",!1),n}))}))}),t.afterGraphInit.registerHook({name:"call add edge to replace temp edge",handler:t=>Tme(this,void 0,void 0,(function*(){const{commandService:n,graph:r}=t;r.on(Ame.EVENT_NAME,(t=>{n.executeCommand(e.XFlowEdgeCommands.ADD_EDGE.id,{edgeConfig:t}),t.edge.remove()}))}))}),t.graphOptions.registerHook({name:"dag-extension-x6-options",handler:e=>Tme(this,void 0,void 0,(function*(){Object.assign(e,Pme)}))})];return n.pushAll(r),e.Disposable.create((()=>{}))})),this.registerHookHub=t=>Tme(this,void 0,void 0,(function*(){return t.registerHookHub(e.NsGraphStatusCommand.hookKey,new SM)}))}registerModel(t){t.registerModel({id:e.GRAPH_STATUS_INFO.id,getInitialValue:()=>({statusMap:new Map,subscription:new V_,graphStatus:e.GRAPH_STATUS_INFO.StatusEnum.DEFAULT}),watchChange:e=>Tme(this,void 0,void 0,(function*(){const{subscription:t}=yield e.getValidValue();return t}))})}};kme([Wn(sM),Mme("design:type",Function)],Dme.prototype,"commandFactory",void 0),Dme=kme([Hn({contrib:[AM,gM,aM]})],Dme);const Nme=()=>rr((e=>{e(Dme),e(Ome)}));var Rme=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Ime="XFLOW_FLOW_NODE_SHAPE";let jme;const{AnchorGroup:Lme}=e.NsGraph,Fme={circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}};jme=hC.registry.exist(Ime)?hC.registry.get(Ime):hP.define({width:150,height:60,shape:Ime,view:W_,ports:{groups:{top:{position:Lme.TOP,attrs:Fme},bottom:{position:Lme.BOTTOM,attrs:Fme},right:{position:Lme.RIGHT,attrs:Fme},left:{position:Lme.LEFT,attrs:Fme}}},attrs:{body:{magnet:!1,fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"}}});var Gme=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Bme=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const zme={grid:!0,mousewheel:{enabled:!0,zoomAtMousePosition:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:8}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,snap:{radius:20},createEdge:()=>new FC({attrs:{line:{stroke:"#A2B1C3",strokeWidth:2,targetMarker:{name:"block",width:12,height:8}}},zIndex:0}),validateConnection:({targetMagnet:e})=>!!e},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},resizing:!0,rotating:!0,selecting:{enabled:!0,rubberband:!0,showNodeSelectionBox:!0,modifiers:"shift"},snapline:!0,keyboard:!0,clipboard:!0};let Ume=class{constructor(){this.toDispose=new V_,this.registerHookHub=()=>Bme(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{}))})),this.registerHook=t=>Bme(this,void 0,void 0,(function*(){const n=new V_,r=[t.addNode.registerHook({name:"flow-add-node",handler:e=>Bme(this,void 0,void 0,(function*(){e.cellFactory=e=>Bme(this,void 0,void 0,(function*(){return new jme(Object.assign({},e))}))}))}),t.addEdge.registerHook({name:"flow-add-edge",handler:e=>Bme(this,void 0,void 0,(function*(){e.cellFactory=e=>Bme(this,void 0,void 0,(function*(){delete e.id;return new FC({source:{cell:e.source,port:e.sourcePortId},target:{cell:e.target,port:e.targetPortId},attrs:{line:{stroke:"#A2B1C3",strokeWidth:2,targetMarker:{name:"block",width:12,height:8}}},zIndex:-1,data:Object.assign({},e)})}))}))}),t.graphOptions.registerHook({name:"assign options ",handler:e=>Bme(this,void 0,void 0,(function*(){Object.assign(e,zme)}))})];return n.pushAll(r),e.Disposable.create((()=>{}))}))}};Ume=Gme([Hn({contrib:AM})],Ume);const Vme=()=>rr((e=>{e(Ume)}));var Hme=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Wme="xflow-node-panel-collpase",$me=60,Xme=40,Yme={stroke:"#A2B1C3",fill:"#FFFFFF",fontFill:"#000",fontSize:12,label:""},qme=[{name:"Terminal"},{name:"Process"},{name:"Decision"},{name:"Multi Document"},{name:"Connector",width:Xme,height:Xme},{name:"DataIO",ports:["top","bottom"]},{name:"Database"},{name:"Hard Disk"},{name:"Stroed Data"},{name:"Document"},{name:"Predefined Process"},{name:"Extract"},{name:"Merge"},{name:"Or",width:Xme,height:Xme},{name:"Manual Input"},{name:"Preparation"},{name:"Delay"},{name:"Manual Operation"},{name:"Display"},{name:"Off Page Link"},{name:"Note Left",label:"≣"},{name:"Note Right",label:"≣"},{name:"Internal Storage"},{name:"Text",label:"text"}],Kme=["Connector","Or"];var Zme=Object.freeze({__proto__:null,ProcessNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=[["M",1,1],["L",c-2,1],["L",c-2,u-2],["L",1,u-2],["Z"]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(h),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},DecisionNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=[["M",c/2,1],["L",c-2,u/2],["L",c/2,u-2],["L",1,u/2],["Z"]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(h),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},ConnectorNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=u-2;return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:`M 1,${u/2} a ${h/2} ${h/2} 0 1 1 0 1 z`,fill:o,stroke:r}),a.default.createElement("text",{x:u/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},DataIONode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=u/2,d=[["M",h-1,1],["L",c-2,1],["L",c-h,u-2],["L",1,u-2],["Z"]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(d),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},TerminalNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=Math.min(u,c)/2,d=[["M",h,1],["L",c-h,1],["C",c-2,1,c-2,u/2],["",c-2,u/2],["C",c-2,u/2,c-2,u-2],["",c-h,u-2],["L",h,u-2],["C",1,u-2,1,u/2],["",1,u/2],["C",1,u/2,1,1],["",h,1]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(d),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},DatabaseNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=c/4,d=Math.min(u/10,12),f=[["M",1,1+d],["C",1+h,1,1+c-h,1],["",c-2,1+d],["L",c-2,u-2-d],["C",c-2-h,u-2,1+h,u-2],["",1,u-2-d],["Z"]],p=[["M",1,1+d],["C",1+h,1+2*d,1+c-h,1+2*d],["",c-2,1+d]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(f),fill:o,stroke:r}),a.default.createElement("path",{d:rve(p),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},HardDiskNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=Math.min(c/10,u/4),d=Math.min(u/4,c/4),f=[["M",1+h,1],["L",c-2-h,1],["C",c-2,1+d,c-2,u-2-d],["",c-2-h,u-2],["L",1+h,u-2],["C",1,u-2-d,1,1+d],["",1+h,1]],p=[["M",c-2-h,1],["C",c-2-2*h,1+d,c-2-2*h,u-2-d],["",c-2-h,u-2]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(f),fill:o,stroke:r}),a.default.createElement("path",{d:rve(p),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},StroedDataNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=Math.min(c/10,u/4),d=Math.min(u/4,c/4),f=[["M",1+h,1],["L",c-2-h,1],["C",c-2-2*h,1+d,c-2-2*h,u-2-d],["",c-2-h,u-2],["L",1+h,u-2],["C",1,u-2-d,1,1+d],["",1+h,1]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(f),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},DocumentNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=c/8,d=u/8,f=[["M",1,1],["L",c-2,1],["L",c-2,u-2-d],["C",c-2-h,u-2-2*d,c/2+h,u-2-2*d],["",c/2,u-2-d],["S",c/4,u-2,1,u-2-2*d],["L",1,1]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(f),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},MultiDocumentNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n;let{width:c,height:u}=t;c+=6,u+=6;const h=c/8,d=u/8,f=[["M",4,1],["L",c-2,1],["L",c-2,u-2-d],["C",c-2-h,u-2-2*d,c/2+h,u-2-2*d],["",c/2,u-2-d],["S",c/4,u-2,4,u-2-2*d],["L",4,1]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(f),fill:o,stroke:r}),a.default.createElement("path",{d:rve(f,-3,3),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},PredefinedProcessNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=c/8,d=[["M",1,1],["L",c-2,1],["L",c-2,u-2],["L",1,u-2],["Z"]],f=[["M",h,1],["L",h,u-2]],p=[["M",c-h,1],["L",c-h,u-2]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(d),fill:o,stroke:r}),a.default.createElement("path",{d:rve(f),stroke:r}),a.default.createElement("path",{d:rve(p),stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},ExtractNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=[["M",c/2,1],["L",c-2,u-2],["L",1,u-2],["Z"]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(h),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},MergeNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=[["M",1,1],["L",c-2,1],["L",c/2,u-2],["Z"]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(h),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},OrNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=[["M",u/2,1],["L",u/2,u-2]],d=[["M",1,u/2],["L",u-2,u/2]],f=u-2;return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:`M 1,${u/2} a ${f/2} ${f/2} 0 1 1 0 1 z`,fill:o,stroke:r}),a.default.createElement("path",{d:rve(h),stroke:r}),a.default.createElement("path",{d:rve(d),stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},ManualInputNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=[["M",1,u/5],["L",c-2,1],["L",c-2,u-2],["L",1,u-2],["Z"]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(h),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},PreparationNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=Math.tan(Math.PI/6)*(u/2),d=[["M",h,1],["L",c-h,1],["L",c-2,u/2],["L",c-h,u-2],["L",h,u-2],["L",1,u/2],["Z"]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(d),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},DelayNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=Math.min(u,c)/2,d=[["M",1,1],["L",c-h,1],["C",c-2,1,c-2,u/2],["",c-2,u/2],["C",c-2,u/2,c-2,u-2],["",c-h,u-2],["L",1,u-2],["Z"]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(d),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},ManualOperationNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=Math.min(Math.tan(Math.PI/6)*u,c/2),d=[["M",1,1],["L",c-2,1],["L",c-h,u-2],["L",h,u-2],["Z"]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(d),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},DisplayNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=Math.min(u,c)/3,d=Math.min(Math.tan(Math.PI/6)*(u/2),c/3),f=[["M",d,1],["L",c-h,1],["C",c-2,1,c-2,u/2],["",c-2,u/2],["C",c-2,u/2,c-2,u-2],["",c-h,u-2],["L",d,u-2],["L",1,u/2],["Z"]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(f),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},OffPageLinkNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=Math.min(Math.tan(Math.PI/6)*(c/2),u/4),d=[["M",1,1],["L",c-2,1],["L",c-2,u-h],["L",c/2,u-2],["L",1,u-h],["Z"]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(d),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},NoteLeftNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o="transparent",fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=c-2,d=[["M",h,1],["C",h-6,1,h-6,6],["",h-6,(u-6)/2],["L",h-12,u/2],["L",h-6,(u+6)/2],["L",h-6,u-2-6],["C",h-6,u-2,h,u-2],["",h,u-2]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(d),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},NoteRightNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o="transparent",fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=[["M",1,1],["C",6,1,6,6],["",6,(u-6)/2],["L",12,u/2],["L",6,(u+6)/2],["L",6,u-2-6],["C",6,u-2,1,u-2],["",1,u-2]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(h),fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},InternalStorageNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{stroke:r=Yme.stroke,label:i=Yme.label,fill:o=Yme.fill,fontFill:s=Yme.fontFill,fontSize:l=Yme.fontSize}=n,{width:c,height:u}=t,h=c-2,d=u-2,f=[["M",1,1],["L",h-6,1],["C",h,1,h,6],["",h,u/2],["L",h,d-6],["C",h,d,h-6,d],["",h-6,d],["L",6,d],["C",1,d,1,d-6],["",1,d-6],["Z"]];return a.default.createElement("svg",{viewBox:`0 0 ${c} ${u}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("path",{d:rve(f),fill:o,stroke:r}),a.default.createElement("path",{d:`M 1,6 L ${h-1} 6 `,fill:o,stroke:r}),a.default.createElement("path",{d:`M 6,1 L 6 ${d} `,fill:o,stroke:r}),a.default.createElement("text",{x:c/2,y:u/2,fill:s,textAnchor:"middle",alignmentBaseline:"middle",fontSize:l},i),"Sorry, your browser does not support inline SVG.")},TextNode:e=>{const{size:t={width:$me,height:Xme},data:n={}}=e,{label:r=Yme.label,fontFill:i=Yme.fontFill,fontSize:o=Yme.fontSize}=n,{width:s,height:l}=t;return a.default.createElement("svg",{viewBox:`0 0 ${s/2} ${l/2}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},a.default.createElement("text",{x:s/4,y:l/4,fill:i,textAnchor:"middle",alignmentBaseline:"middle",fontSize:o},r),"Sorry, your browser does not support inline SVG.")}}),Jme=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Qme=e=>({position:{name:e},attrs:{circle:{r:4,magnet:!0,stroke:"#31d0c6",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}},zIndex:10}),eve=(e=["top","right","bottom","left"])=>({items:e.map((e=>({group:e,id:eS()}))),groups:{top:Qme("top"),right:Qme("right"),bottom:Qme("bottom"),left:Qme("left")}}),tve=e=>Jme(void 0,void 0,void 0,(function*(){const t=(e=>(e||[]).map((e=>{const{name:t,popover:n,label:r="",width:i=Xme,height:o=Xme,ports:s}=e;return{id:eS(),renderKey:t,name:t,label:r,popoverContent:n,width:i,height:o,ports:s||eve(),originData:Object.assign({},e),isCustom:!0}})))(e);return[...t,...qme.map((({name:e,ports:t,width:n=$me,height:r=Xme,label:i=""})=>({id:eS(),renderKey:e,name:e,label:i,popoverContent:()=>e,width:n,height:r,ports:eve(t)})))]})),nve=(e,t=[])=>{(null==t?void 0:t.length)&&t.forEach((t=>{const{name:n,component:r}=t;e.setNodeRender(n,r)})),e.nodeRender.get("Terminal")||qme.forEach((t=>{e.setNodeRender(t.name,Zme[`${t.name.replace(/\s+/g,"")}Node`])}))},rve=(e,t=0,n=0)=>{if(!e.length)return null;let i="";return e.forEach((e=>{const[o,s,a,l,c]=e;i+=r.isNumber(a)?` ${o} ${s+t} ${a+n}`:` ${o}`,c&&(i+=` ${l+t} ${c+n}`)})),i};var ive=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const ove={config:{}},sve=e=>{var t;return null===(t=ove.config)||void 0===t?void 0:t[e]},ave=new Map,lve=new Map,cve=()=>ave.get("x6graph"),uve=()=>ive(void 0,void 0,void 0,(function*(){return lve.get("app").getGraphData()})),hve=r.debounce((e=>{const t=sve("onConfigChange");if(t&&"function"==typeof t)return t(Object.assign({data:uve()},e))}),300,{trailing:!0});var dve=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const fve=(e,t)=>{const n=(e=>{var t;let n=null===(t=null==e?void 0:e.e)||void 0===t?void 0:t.currentTarget;if(!n)return document.getElementsByClassName("xflow-canvas-root");let r=null;for(;!r;){const e=n.getElementsByClassName("xflow-canvas-root");(null==e?void 0:e.length)>0&&(r=e),n=n.parentNode}return r})(t);Array.from(n).forEach((t=>{var n,r;const i=t.querySelectorAll(".x6-port-body"),o=null===(r=null===(n=cve().getSelectedCells())||void 0===n?void 0:n[0])||void 0===r?void 0:r.isNode();for(let t=0,n=i.length;t<n;t+=1)i[t].style.visibility=!o&&e?"visible":"hidden"}))};var pve=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const{Panel:gve}=i.Collapse,mve=n=>{const{x6NodeFactory:o,dndOptions:s,state:l,prefixClz:c,registerNode:u,defaultActiveKey:h=["official","custom"]}=n,{title:d="复制节点"}=null!=u?u:{},{graphProvider:f,modelService:p,commandService:g}=eA(),[m,v]=a.default.useState(),[y,b]=a.default.useState();let x;f.getGraphInstance().then((e=>{b(e)})),f.getGraphOptions().then((e=>{nve(sve("graphConfig"),r.get(n,"registerNode.nodes",[])),x=e}));const w=t.useCallback((t=>pve(void 0,void 0,void 0,(function*(){var n;const{ports:r}=t,i=Object.assign(Object.assign({},t),{id:`node-${eS()}`,zIndex:10,ports:Object.assign(Object.assign({},r),{items:null===(n=r.items)||void 0===n?void 0:n.map((e=>Object.assign(Object.assign({},e),{id:eS()})))})}),o={nodeConfig:i};yield g.executeCommand(e.XFlowNodeCommands.ADD_NODE.id,o);const s=sve("onAddNode");"function"==typeof s&&s(i)}))),[g]);a.default.useEffect((()=>{if(!y)return;const e=new M_(Object.assign(Object.assign({scaled:!1,animation:!1},s),{target:y,validateNode:e=>pve(void 0,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},e.getData()),e.getPosition());return yield w(t),!1}))}));v(e)}),[g,s,y,p,w]);const C=a.default.useCallback((e=>t=>{if(!y||!m||!x)return;const n=x.nodeTypeParser(e),{width:r=180,height:i=40}=e,s=eT(x.nodeRender.get(n),g,p),a={data:e,width:r,height:i,view:x.graphId,component:s},l=o?o(a):Ige(a);m.start(l,t.nativeEvent)}),[g,m,y,x,p,o]),E=a.default.useCallback(((e=[])=>e.map((e=>{const{popoverContent:t}=e;return a.default.createElement(Lge,{item:e,key:e.id,onMouseDown:C(e),popoverContent:t,prefixClz:c,modelService:p,commandService:g,graphConfig:x})}))),[g,x,p,C,c]),_=l.nodeList.filter((e=>e.isCustom)),S=l.nodeList.filter((e=>!e.isCustom)),O=l.searchList.filter((e=>e.isCustom)),A=l.searchList.filter((e=>!e.isCustom)),k=_.length>0;return a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:`${c}-body`},a.default.createElement(i.Collapse,{defaultActiveKey:h,style:{border:"none"}},a.default.createElement(gve,{header:"通用节点",key:"official",style:{border:"none"}},!l.keyword&&a.default.createElement("div",{className:`${c}-official`},E(S)),l.searchList.length>0&&a.default.createElement("div",{className:`${c}-official`},E(A))),k&&a.default.createElement(gve,{header:d,key:"custom",style:{border:"none"}},!l.keyword&&a.default.createElement("div",{className:`${c}-custom`},E(_)),l.searchList.length>0&&a.default.createElement("div",{className:`${c}-custom`},E(O)))),l.keyword&&0===l.searchList.length&&a.default.createElement(i.Empty,{style:{marginTop:"48px"}})))},vve=e=>{const{prefixClz:t,onKeywordChange:n}=e,{propsProxy:r}=xge(),o=r.getValue();return a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:`${t}-header`,style:Object.assign({zIndex:1},e.style)},o.header&&a.default.isValidElement(o.header)&&o.header,a.default.createElement("div",{className:`${t}-header-search`},a.default.createElement(i.Input,{placeholder:"搜索组件",allowClear:!0,onChange:e=>n(e.target.value),style:{width:"100%",border:0}}))))};var yve,bve=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.id="NODE_PANEL_DATA"}(yve||(yve={}));const xve=(e=[],t)=>bve(void 0,void 0,void 0,(function*(){const n=e.filter((e=>{var n,r;return e.isDirectory||(null===(n=e.label)||void 0===n?void 0:n.includes(t))||(null===(r=e.name)||void 0===r?void 0:r.includes(t))}));return n})),wve=t=>{const{registerNode:n,searchService:r=xve}=t,{nodes:i}=null!=n?n:{},{modelService:o}=eA(),[s,l,c]=Nne({searchList:[],nodeList:[],defaultExpandAll:!1,keyword:""});a.default.useEffect((()=>{o.findDeferredModel(yve.id)||o.registerModel({id:yve.id,modelFactory:()=>c,watchChange:t=>bve(void 0,void 0,void 0,(function*(){const n=yield DT.getModel(o),r=n.watch((()=>bve(void 0,void 0,void 0,(function*(){const e=yield bve(void 0,void 0,void 0,(function*(){return{listData:yield tve(i)}}));t.setValue({nodeList:e.listData,defaultExpandAll:!1,keyword:"",searchList:[]})}))));return e.Disposable.create((()=>{r.dispose()}))}))})}),[]);const u=a.default.useCallback((e=>bve(void 0,void 0,void 0,(function*(){if(r)if(e){const t=yield r(s.nodeList,e);l((n=>{n.keyword=e,n.searchList=t}))}else l((e=>{e.keyword="",e.searchList=[]}))}))),[r,s.nodeList,l]);return{state:s,setState:l,onKeywordChange:u}},Cve=t=>{const{cell:n,data:{label:r,stroke:i,fill:o,fontSize:s,fontFill:l,width:c=200,isCollapsed:u=!1}}=t,h=eA();return a.default.createElement("div",{className:"xflow-group-node",style:{borderColor:i,backgroundColor:o,fontSize:s,color:l}},a.default.createElement("div",{className:"xflow-group-header"},a.default.createElement("div",{className:"header-left"},r),a.default.createElement("div",{className:"header-right"},u&&a.default.createElement(BO,{onClick:()=>{h.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:n.id,isCollapsed:!1,collapsedSize:{width:c,height:40}})}}),!u&&a.default.createElement(RO,{onClick:()=>{h.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:n.id,isCollapsed:!0,collapsedSize:{width:c,height:40},gap:3})}}))))};var Eve;!function(e){e.id="FLOWCHART_PANEL_DATA"}(Eve||(Eve={}));var _ve=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Sve=e=>{const{prefixClz:t,position:n={width:240,top:0,bottom:0,left:0},showHeader:r=!0}=e,i=_ve(e,["prefixClz","position","showHeader"]),{width:o=200}=n,{headerStyle:s,bodyStyle:l}=Uge(e),{state:c,onKeywordChange:u}=wve(e);return a.default.createElement(a.default.Fragment,null,r&&a.default.createElement(wge,Object.assign({},i,{position:{top:0,left:0,height:40,width:o}}),a.default.createElement(vve,Object.assign({},e,{state:c,style:s,onKeywordChange:u}))),a.default.createElement(wge,Object.assign({className:`${Wme}-nodes`},i,{position:Object.assign(Object.assign({},n),{top:r?40:0})}),a.default.createElement(mve,Object.assign({},e,{state:c,style:l}))))};var Ove;!function(e){e.EVENT_NAME="ADD_FLOWCHART_EDGE_CMD_EVENT"}(Ove||(Ove={}));const Ave=FC.registry.register("xflow",FC.define({zIndex:1,highlight:!0,name:"flowchart-connecting-edge",label:"",anchor:{name:"midSide",args:{dx:10}},attrs:{line:{stroke:"#A2B1C3",targetMarker:{name:"block",width:12,height:8},strokeDasharray:"5 5",strokeWidth:1}},data:{label:""}}),!0),kve=fA(((t,n)=>{const{config:o={}}=n.getValue();var s;t.setEdgeTypeParser((e=>null==e?void 0:e.renderKey)),nve(t),(e=>{e.setNodeRender("GROUP_NODE_RENDER_ID",Cve)})(t),s=Object.assign(Object.assign({},n.getValue()),{graphConfig:t}),ove.config=s,t.setX6Config(Object.assign({grid:!0,history:!0,resizing:{enabled:!0,minWidth:Xme,minHeight:Xme,preserveAspectRatio:e=>{const{data:t}=e;return Kme.includes(t.name)}},snapline:{enabled:!0},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:8}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,snap:{radius:20},createEdge(){const e=new Ave({});return this.once("edge:connected",(e=>{const{edge:t,isNew:n}=e;if(n&&t.isEdge()){const e=t.getTargetCell();if(e&&e.isNode()){const e=t.getTargetPortId(),n=t.getSourcePortId(),r=t.getSourceCellId(),i=t.getTargetCellId();this.trigger(Ove.EVENT_NAME,{targetPortId:e,sourcePortId:n,source:r,target:i,edge:t})}}})),e},validateEdge:e=>{var t;const{edge:n}=e;return!!(null===(t=null==n?void 0:n.target)||void 0===t?void 0:t.port)},validateMagnet:()=>!0,validateConnection({sourceView:e,targetView:t,targetMagnet:n}){if(e===t)return!1;const r=t.cell;if(n){const e=n.getAttribute("port"),t=r.getPort(e);return!(t&&t.connected)}}},highlighting:{nodeAvailable:{name:"className",args:{className:"available"}},magnetAvailable:{name:"className",args:{className:"available"}},magnetAdsorbed:{name:"className",args:{className:"adsorbed"}}},onPortRendered(e){const{port:t}=e,{contentSelectors:n}=e,r=n&&n.content,o=t.group,s=hr("xflow-port",{connected:t.connected});r&&c.default.render(a.default.createElement(i.ConfigProvider,{prefixCls:"ant"},a.default.createElement(i.Tooltip,{title:t.tooltip,placement:o},a.default.createElement("span",{className:s}))),r)}},o)),t.setEvents([{eventName:"node:selected",callback:()=>{fve(!1)}},{eventName:"edge:dblclick",callback:e=>{(e=>{dve(void 0,void 0,void 0,(function*(){const{edge:t}=e;t&&t.addTools("vertices","ondbclick")}))})(e)}},{eventName:"edge:mouseleave",callback:(t,n)=>{((t,n)=>{dve(void 0,void 0,void 0,(function*(){const{edge:i}=t;i&&i.hasTools("ondbclick")&&(n.executeCommand(e.XFlowEdgeCommands.UPDATE_EDGE.id,{edgeConfig:Object.assign(Object.assign({},r.get(i,"data")),{vertices:i.getVertices()})}),i.removeTools())}))})(t,n)}},{eventName:"node:mouseenter",callback:e=>{fve(!0,e)}},{eventName:"node:mouseleave",callback:e=>{fve(!1,e)}},{eventName:"node:moved",callback:(t,n)=>{((t,n)=>{dve(void 0,void 0,void 0,(function*(){const{node:r}=t;if(!r)return;const{data:i}=r;if(null==i?void 0:i.groupChildren){const t=cve();null==i||i.groupChildren.forEach((r=>dve(void 0,void 0,void 0,(function*(){var i,o;const s=t.getCellById(r);s&&s.isNode()&&(yield n.executeCommand(e.XFlowNodeCommands.UPDATE_NODE.id,{nodeConfig:Object.assign(Object.assign(Object.assign({},s.data),null===(i=s.getSize)||void 0===i?void 0:i.call(s)),null===(o=s.getPosition)||void 0===o?void 0:o.call(s))}))}))))}const o=Object.assign(Object.assign(Object.assign({},r.data),r.getPosition()),r.getSize());yield n.executeCommand(e.XFlowNodeCommands.UPDATE_NODE.id,{nodeConfig:o}),hve({type:"move:node",config:o})}))})(t,n)}},{eventName:"node:resized",callback:(t,n)=>{((t,n)=>{dve(void 0,void 0,void 0,(function*(){const{node:r}=t;if(!r)return;const i=Object.assign(Object.assign(Object.assign({},r.data),r.getPosition()),r.size());yield n.executeCommand(e.XFlowNodeCommands.UPDATE_NODE.id,{nodeConfig:i}),hve({type:"resize:node",config:i})}))})(t,n)}}])}));var Mve=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Tve=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},Pve=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};let Dve=class{constructor(){this.toDispose=new V_,this.registerHookHub=()=>Tve(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{}))})),this.registerHook=t=>Tve(this,void 0,void 0,(function*(){const n=new V_,r=[t.afterGraphInit.registerHook({name:"call add edge to replace temp edge",handler:t=>Tve(this,void 0,void 0,(function*(){const{commandService:n,graph:r}=t;r.on(Ove.EVENT_NAME,(t=>Tve(this,void 0,void 0,(function*(){const r=Pve(t,["edge"]),i={edgeConfig:Object.assign(Object.assign({},r),{source:{cell:r.source,port:r.sourcePortId},target:{cell:r.target,port:r.targetPortId},zIndex:1,attrs:{line:{stroke:"#A2B1C3",targetMarker:{name:"block",width:12,height:8},strokeDasharray:"5 5",strokeWidth:1}},data:Object.assign({},r)})};yield n.executeCommand(e.XFlowEdgeCommands.ADD_EDGE.id,i);const o=sve("onAddEdge");"function"==typeof o&&o(i),t.edge.remove()}))))}))})];return n.pushAll(r),e.Disposable.create((()=>{}))}))}};Dve=Mve([Hn({contrib:AM})],Dve);var Nve=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Rve=()=>rr((e=>{e(Dve)})),Ive=e=>{const{position:n={top:40,left:240,right:240,bottom:0}}=e,r=kve(e),i=eA();return t.useEffect((()=>{i&&(e=>{ive(void 0,void 0,void 0,(function*(){const t=yield e.getGraphInstance();ave.set("x6graph",t),lve.set("app",e)}))})(i)}),[i]),a.default.createElement(xP,Object.assign({},e,{config:r,position:n}),e.children)};Ive.defaultProps={isXFlowCanvas:!0};var jve=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Lve=e=>jve(void 0,void 0,void 0,(function*(){var t;const{targetType:n}=e;return(null===(t=e.targetData)||void 0===t?void 0:t.isGroup)?{tabs:[{name:"设置",groups:[{name:"groupName",controls:[{label:"分组名",name:"group-service",shape:"group-service",placeholder:"分组名称"}]}]}]}:"node"===n?{tabs:[{name:"设置",groups:[{name:"groupName",controls:[{label:"节点名",name:"node-service",shape:"node-service",placeholder:"节点名称"}]}]}]}:"edge"===n?{tabs:[{name:"设置",groups:[{name:"groupName",controls:[{label:"边",name:"edge-service",shape:"edge-service",placeholder:"边名称"}]}]}]}:{tabs:[{name:"设置",groups:[{name:"groupName",controls:[{label:"",name:"canvas-service",shape:"canvas-service"}]}]}]}}));var Fve=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Gve=n=>{const{controlSchema:r,children:i,type:o="node"}=n,{commandService:s,modelService:l}=xge(),c=t.useCallback((()=>Fve(void 0,void 0,void 0,(function*(){const{data:e}=yield ST.useValue(l);return e}))),[l]),u=t.useCallback((()=>Fve(void 0,void 0,void 0,(function*(){const e=yield ET.useValue(l),t=e.getData();return Object.assign({id:e.id},t)}))),[l]),{data:h,loading:d}=function(e){const[n,r]=t.useState({loading:!0}),i=t.useCallback((()=>{e().then((e=>{r({loading:!1,data:e})}),(e=>{r({loading:!1}),console.error(e)}))}),[e]);return t.useEffect((()=>{i()}),[i]),n}("edge"===o?u:c);a.default.useEffect((()=>{s.executeCommand(e.XFlowGraphCommands.SAVE_GRAPH_DATA.id,{saveGraphDataService:(e,t)=>Fve(void 0,void 0,void 0,(function*(){return{err:null,data:t,meta:e}}))})}),[s]);const f=t=>Fve(void 0,void 0,void 0,(function*(){const n=yield c(),r=Object.assign(Object.assign({},n),t);yield s.executeCommand(e.XFlowNodeCommands.UPDATE_NODE.id,{nodeConfig:r}),hve({type:"update:node",config:r})})),p=(t,n="line",r)=>Fve(void 0,void 0,void 0,(function*(){var i;const o=yield u(),a=Object.assign(Object.assign(Object.assign({},o),r?t[r]:t),{attrs:Object.assign(Object.assign({},o.attrs),{[n]:Object.assign(Object.assign({},null===(i=o.attrs)||void 0===i?void 0:i[n]),r?t[r]:t)})});yield s.executeCommand(e.XFlowEdgeCommands.UPDATE_EDGE.id,{edgeConfig:a}),hve({type:"update:edge",config:a})})),g=t=>Fve(void 0,void 0,void 0,(function*(){const n=yield c(),r=Object.assign(Object.assign({},n),t);yield s.executeCommand(e.XFlowNodeCommands.UPDATE_NODE.id,{nodeConfig:r}),hve({type:"update:group",config:r})}));return d?null:a.default.createElement(nme,{schema:r},(()=>i(Object.assign({},h),{updateNode:f,updateEdge:p,updateGroup:g})))},Bve="flowchart-editor",zve={attrs:{line:{stroke:"#A2B1C3",strokeWidth:1},text:{fill:"#000",fontSize:12,textAnchor:"middle",textVerticalAnchor:"middle"}}},Uve={width:12,height:8,name:"block"},Vve={width:0,height:0,name:""},Hve={target:{sourceMarker:Vve,targetMarker:Uve},source:{sourceMarker:Uve,targetMarker:Vve},all:{sourceMarker:Uve,targetMarker:Uve},none:{sourceMarker:Vve,targetMarker:Vve}},Wve={solid:[0,0],dash:[5,5]},$ve=e=>{const{label:t="标签",value:n,onChange:r}=e;return a.default.createElement("div",{className:"group"},a.default.createElement("label",null,t),a.default.createElement(i.Input,{value:n,style:{height:24},onChange:e=>{null==r||r(e.target.value)}}))};var Xve=t.memo((e=>{const{label:r,value:o="",onChange:s}=e,[l,c]=t.useState(!1),u=t.useRef(o),{graphProvider:h}=eA(),d=t.useRef();h.getGraphOptions().then((e=>{d.current=e}));const f=()=>a.default.createElement("div",{className:`${Bve}-pick-color-container`},a.default.createElement("div",{className:`${Bve}-popover`},a.default.createElement(eae.SketchPicker,{onChange:e=>{u.current=e.hex}}),a.default.createElement("div",{className:"foolter"},a.default.createElement(i.Button,{onClick:()=>{c(!1)}},"取消"),a.default.createElement(i.Button,{type:"primary",onClick:()=>{null==s||s(u.current),c(!1)}},"确认"))));return a.default.createElement("div",{className:"group"},r&&a.default.createElement("label",null,r),a.default.createElement("div",{className:`${Bve}-color-container`,onClick:()=>{c(!0)}},a.default.createElement("div",{className:`${Bve}-color`,style:{backgroundColor:o,height:"100%"}})),(e=>{const t=document.getElementsByClassName(`${Bve}-pick-color-container`);if(t.length&&Array.from(t).forEach((e=>{var t;null===(t=e.parentNode)||void 0===t||t.removeChild(e)})),!e)return;const r=document.createElement("div");n.render(n.createPortal(a.default.createElement(f,null),document.getElementsByTagName("body")[0]),r)})(l))}),((e,t)=>e.label===t.label&&e.value===t.value));const Yve=e=>{const{label:t,value:n,onChange:r,min:o,width:s}=e;return a.default.createElement("div",{className:"group"},t&&a.default.createElement("label",null,t),a.default.createElement(i.InputNumber,{value:n,min:o,style:{width:s,height:24},onChange:e=>{null==r||r(e)}}))},qve=({value:e,onChangeItem:t,addonBefore:n})=>a.default.createElement("div",{className:"addon-before-group"},a.default.createElement(i.InputNumber,{value:e,style:{height:24,border:"none"},onChange:e=>{t(e)}}),a.default.createElement("span",null,n)),Kve=e=>{const{x:t,y:n,onChange:r}=e;return a.default.createElement("div",{className:"group"},a.default.createElement("label",null,"位置"),a.default.createElement("div",{className:"split"},a.default.createElement(qve,{addonBefore:"X",value:t,onChangeItem:e=>{null==r||r("x",e)}}),a.default.createElement(qve,{addonBefore:"Y",value:n,onChangeItem:e=>{null==r||r("y",e)}})))},Zve=e=>{const{width:t,height:n,onChange:r}=e;return a.default.createElement("div",{className:"group"},a.default.createElement("label",null,"尺寸"),a.default.createElement("div",{className:"split"},a.default.createElement(qve,{addonBefore:"W",value:t,onChangeItem:e=>{null==r||r("width",e)}}),a.default.createElement(qve,{addonBefore:"H",value:n,onChangeItem:e=>{null==r||r("height",e)}})))},{Option:Jve}=i.Select,Qve=e=>{const{label:t="箭头",value:n,onChange:r,options:o=[],width:s}=e;return a.default.createElement("div",{className:"group"},a.default.createElement("label",null,t),a.default.createElement(i.Select,{size:"small",value:n,style:{width:s,height:24},getPopupContainer:e=>e.parentNode,optionFilterProp:"children",onChange:e=>{null==r||r(e)},filterOption:(e,t)=>(null==t?void 0:t.children.toLowerCase().indexOf(e.toLowerCase()))>=0},o.map((e=>a.default.createElement(Jve,{key:e.label,value:e.value},e.label)))))},eye=e=>{const{config:n,plugin:r={}}=e,{updateNode:i}=r,[o,s]=t.useState(Object.assign(Object.assign({},Yme),n)),l=(e,t)=>{s(Object.assign(Object.assign({},o),{[e]:t})),i({[e]:t})};return t.useEffect((()=>{s(Object.assign(Object.assign({},Yme),n))}),[n]),a.default.createElement("div",{className:`${Bve}-panel-body`},a.default.createElement("div",{className:`${Bve}-panel-group`},a.default.createElement("h5",null,"内容"),a.default.createElement($ve,{label:"标题",value:o.label,onChange:e=>{l("label",e)}})),a.default.createElement("div",{className:`${Bve}-panel-group`},a.default.createElement("h5",null,"样式"),a.default.createElement(Kve,{x:o.x,y:o.y,onChange:(e,t)=>{l(e,t)}}),a.default.createElement(Zve,{width:o.width,height:o.height,onChange:(e,t)=>{l(e,t)}}),a.default.createElement(Xve,{label:"填充",value:o.fill,onChange:e=>{l("fill",e)}}),a.default.createElement(Xve,{label:"边框",value:o.stroke,onChange:e=>{l("stroke",e)}}),a.default.createElement("div",{className:`${Bve}-node-text-style`},a.default.createElement(Yve,{label:"字号",value:o.fontSize,width:68,onChange:e=>{l("fontSize",e)}}),a.default.createElement(Xve,{value:o.fontFill,onChange:e=>{l("fontFill",e)}}))))},tye=e=>a.default.createElement(Gve,Object.assign({},e),((t,n)=>a.default.createElement(eye,Object.assign({},e,{plugin:n,config:t})))),nye=e=>{const{config:n,plugin:r={}}=e,{updateEdge:i}=r,[o,s]=t.useState(Object.assign(Object.assign({},zve),n));t.useEffect((()=>{s(Object.assign(Object.assign({},zve),n))}),[n]);const l=(e,t="line")=>{var n;const{attrs:r={}}=o;return null===(n=r[t])||void 0===n?void 0:n[e]},c=(e,t,n="line")=>{var r,a;s("arrow"===e?Object.assign(Object.assign({},o),{attrs:Object.assign(Object.assign({},o.attrs),{[n]:Object.assign(Object.assign({},null===(r=o.attrs)||void 0===r?void 0:r[n]),t)})}):Object.assign(Object.assign({},o),{[e]:t,attrs:Object.assign(Object.assign({},o.attrs),{[n]:Object.assign(Object.assign({},null===(a=o.attrs)||void 0===a?void 0:a[n]),{[e]:t})})})),i({[e]:t},n,"arrow"===e?"arrow":"")};return a.default.createElement("div",{className:`${Bve}-panel-body`},a.default.createElement("div",{className:`${Bve}-panel-group`},a.default.createElement("h5",null,"内容"),a.default.createElement($ve,{label:"标签",value:o.label,onChange:e=>{c("label",e)}})),a.default.createElement("h5",{style:{marginBottom:12}},"样式"),a.default.createElement("div",{className:`${Bve}-panel-group`,style:{marginBottom:0}},a.default.createElement("h5",null,"线"),a.default.createElement(Qve,{label:"箭头",value:(()=>{var e,t,n,r,i;const{attrs:s={}}=o,{line:a={}}=s;return(null===(e=a.sourceMarker)||void 0===e?void 0:e.name)&&(null===(t=a.targetMarker)||void 0===t?void 0:t.name)?"all":(null===(n=a.sourceMarker)||void 0===n?void 0:n.name)||(null===(r=a.targetMarker)||void 0===r?void 0:r.name)?(null===(i=a.sourceMarker)||void 0===i?void 0:i.name)?"source":"target":"none"})(),width:"100%",options:[{label:"正向",value:"target"},{label:"逆向",value:"source"},{label:"双向",value:"all"},{label:"无",value:"none"}],onChange:e=>{c("arrow",Hve[e],"line")}}),a.default.createElement("div",{className:`${Bve}-edge-stroke-style`},a.default.createElement(Qve,{label:"线形",width:68,value:(()=>{const{attrs:e={}}=o,{line:t={}}=e;return t.strokeDasharray?"dash":"solid"})(),options:[{label:"实线",value:"solid"},{label:"虚线",value:"dash"}],onChange:e=>{c("strokeDasharray",Wve[e],"line")}}),a.default.createElement(Yve,{value:l("strokeWidth"),min:1,onChange:e=>{c("strokeWidth",e,"line")}})),a.default.createElement(Xve,{label:"边框",value:l("stroke"),onChange:e=>{c("stroke",e,"line")}})),a.default.createElement("div",{className:`${Bve}-panel-group`},a.default.createElement("h5",null,"标签"),a.default.createElement("div",{className:`${Bve}-edge-text-style`},a.default.createElement(Yve,{label:"字号",min:10,width:68,value:l("fontSize","text")||12,onChange:e=>{c("fontSize",e,"text")}}),a.default.createElement(Xve,{value:l("fill","text")||"#000",onChange:e=>{c("fill",e,"text")}}))))},rye=e=>a.default.createElement(Gve,Object.assign({},e,{type:"edge"}),((t,n)=>a.default.createElement(nye,Object.assign({},e,{plugin:n,config:t})))),iye=e=>{const{config:n,plugin:r={}}=e,{updateGroup:i}=r,[o,s]=t.useState(Object.assign(Object.assign({},Yme),n)),l=(e,t)=>{s(Object.assign(Object.assign({},o),{[e]:t})),i({[e]:t})};return t.useEffect((()=>{s(Object.assign(Object.assign({},Yme),n))}),[n]),a.default.createElement("div",{className:`${Bve}-panel-body`},a.default.createElement("div",{className:`${Bve}-panel-group`},a.default.createElement("h5",null,"内容"),a.default.createElement($ve,{label:"标题",value:o.label,onChange:e=>{l("label",e)}})),a.default.createElement("div",{className:`${Bve}-panel-group`},a.default.createElement("h5",null,"样式"),a.default.createElement(Kve,{x:o.x,y:o.y,onChange:(e,t)=>{l(e,t)}}),a.default.createElement(Zve,{width:o.width,height:o.height,onChange:(e,t)=>{l(e,t)}}),a.default.createElement(Xve,{label:"填充",value:o.fill,onChange:e=>{l("fill",e)}}),a.default.createElement(Xve,{label:"边框",value:o.stroke,onChange:e=>{l("stroke",e)}}),a.default.createElement("div",{className:`${Bve}-node-text-style`},a.default.createElement(Yve,{label:"字号",value:o.fontSize,width:68,onChange:e=>{l("fontSize",e)}}),a.default.createElement(Xve,{value:o.fontFill,onChange:e=>{l("fontFill",e)}}))))},oye=e=>a.default.createElement(Gve,Object.assign({},e),((t,n)=>a.default.createElement(iye,Object.assign({},e,{plugin:n,config:t})))),sye=()=>a.default.createElement("div",{className:`${Bve}-canvas-panel`},a.default.createElement("span",null,"未选中")),aye=e=>(e.set("node-service",tye),e.set("edge-service",rye),e.set("group-service",oye),e.set("canvas-service",sye),e);var lye=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const cye="xflow-editor-panel-collpase";e.AppContext=QM,e.CanvasContextMenu=e=>{const t=!!eA(),n=a.default.useMemo((()=>e.config?e.config:new gre),[e.config]);return a.default.createElement(aP,{createModule:Cre,config:n},t&&a.default.createElement(Zpe,{config:n}))},e.CanvasMiniMap=e=>{const{nodeFillColor:t,borderColor:n="#ced4de",handlerColor:r="rgba(0,0,0,.3)",miniMapClz:i="",position:o={bottom:12,right:12},minimapOptions:s={}}=e,l=a.default.useRef(null),c=a.default.useRef(e.minimapOptions),u=a.default.useMemo((()=>new Set([i,"xflow-minimap","minimap-instacne-"+Date.now().toString()])),[i]),h=a.default.useMemo((()=>()=>vge(void 0,void 0,void 0,(function*(){return Object.assign(Object.assign(Object.assign({},{grid:!1,enabled:!0,width:200,height:120,padding:8,graphOptions:{async:!0,getCellView(e){if(e.isNode())return mge},createCellView(e){if(e.isEdge())return null}}}),c.current),{container:l.current})}))),[l]),d=lP(o);a.default.useEffect((()=>{c.current=s}),[c,s]),a.default.useEffect((()=>{t&&mge.setNodeFillColor(t)}),[t]),a.default.useEffect((()=>{const e=Array.from(u).reduce(((e,t)=>t?`${e}.${t}`:e),""),t=UM(`\n      ${e} .x6-widget-minimap-viewport {\n        border: 1px solid ${n};\n        margin: 0;\n      }\n      ${e} .x6-widget-minimap-viewport-zoom {\n        border: 1px solid ${r}; \n      }\n    `);return()=>{document.head.removeChild(t)}}),[n,u,r]);const f=Array.from(u).join(" ");return a.default.createElement(aP,{config:{getConfig:h,CONFIG_TYPE:"CanvasMiniMap"},createModule:gge},a.default.createElement("div",{ref:l,className:f,style:d}))},e.CanvasNodePortTooltip=e=>{const t=a.default.useCallback((()=>ure(void 0,void 0,void 0,(function*(){return null}))),[]);return a.default.createElement(aP,{createModule:cre,config:{CONFIG_TYPE:"CanvasNodePortTooltip",getConfig:t}},a.default.createElement(hre,Object.assign({},e)))},e.CanvasScaleToolbar=e=>{const t=cge(e);return a.default.createElement(oge,Object.assign({layout:"vertical"},e,{config:t,position:e.position||{top:12,right:12}}))},e.CanvasSnapline=e=>{const{color:t=tre}=e,n=ZM(),r=a.default.useMemo((()=>({CONFIG_TYPE:"CanvasSnapline",getConfig:()=>ere(void 0,void 0,void 0,(function*(){return{}}))})),[]);return a.default.useEffect((()=>{const e=`xflow-snapline-${Date.now()}`;n.addContainerClassNames(e);const r=UM(`\n    .${e} .xflow-snapline .x6-widget-snapline-horizontal, \n    .${e} .xflow-snapline .x6-widget-snapline-vertical {\n      border-color: ${t};\n    }`);return()=>{document.head.removeChild(r)}}),[t,n]),a.default.createElement(aP,{config:r,createModule:Qne})},e.CanvasToolbar=oge,e.DagGraphExtension=e=>{const t=ZM();a.default.useEffect((()=>{t.addContainerClassNames("dag-extension-container")}),[t]);const n=a.default.useMemo((()=>({CONFIG_TYPE:"DAG_EXTENSION",getConfig:()=>Rme(void 0,void 0,void 0,(function*(){return e}))})),[e]);return a.default.createElement(aP,{config:n,createModule:Nme})},e.Deferred=H_,e.DisposableCollection=V_,e.ExtensionRegistryContext=KM,e.FlowGraphExtension=()=>{const e=ZM(),t=a.default.useMemo((()=>({CONFIG_TYPE:"DAG_EXTENSION",getConfig:()=>Hme(void 0,void 0,void 0,(function*(){}))})),[]);return a.default.useEffect((()=>{const n=e.addExtension({config:t,createModule:Vme});return e.addContainerClassNames("flow-extension-container"),()=>{n.dispose()}}),[t,e]),null},e.FlowchartCanvas=Ive,e.FlowchartExtension=()=>{const e=ZM(),t=a.default.useMemo((()=>({CONFIG_TYPE:"FLOWCHART_EXTENSION",getConfig:()=>Nve(void 0,void 0,void 0,(function*(){}))})),[]);return a.default.useEffect((()=>{const n=e.addExtension({config:t,createModule:Rve});return e.addContainerClassNames("flowchart-extension-container"),()=>{n.dispose()}}),[t,e]),null},e.FlowchartFormPanel=e=>{const[n,r]=t.useState(!1),{controlMapService:i=aye,formSchemaService:o=Lve,position:s={width:240,top:0,bottom:0,right:0},show:l=!0}=e,c=lye(e,["controlMapService","formSchemaService","position","show"]);if(!l)return null;const{width:u=200,right:h}=s;return a.default.createElement(wge,{className:cye,position:Object.assign(Object.assign({},s),{right:n?-u:h})},a.default.createElement("div",{className:`${cye}-wrapper`},a.default.createElement(wme,Object.assign({targetType:["node","edge","canvas","group"],controlMapService:i,formSchemaService:o,position:Object.assign(Object.assign({},s),{top:0}),prefixClz:"xflow-form-editor"},c)),a.default.createElement("div",{className:`${cye}-icon`,style:{top:21,left:n?-20:-10,borderRadius:n?"50% 0 0  50%":"50%",borderRight:n?"none":""},onClick:()=>{r(!n)}},n?a.default.createElement(mO,null):a.default.createElement(bO,null))))},e.FlowchartFormWrapper=Gve,e.FlowchartNodePanel=e=>{const n=oP("node-panel"),[r,i]=t.useState(!1),{show:o=!0,position:s={width:240,top:40,bottom:0,left:0}}=e,l=_ve(e,["show","position"]);if(!o)return null;const{width:c=200,left:u}=s;return a.default.createElement(wge,{className:Wme,position:Object.assign(Object.assign({},s),{left:r?-c:u})},a.default.createElement("div",{className:`${Wme}-wrapper`},a.default.createElement(wge,Object.assign({className:n},l,{position:{top:0,bottom:0,left:0,right:0}}),a.default.createElement(Sve,Object.assign({},e,{prefixClz:n,position:s}))),a.default.createElement("div",{className:`${Wme}-icon`,style:{top:21,right:r?-20:-10,borderRadius:r?"0 50% 50% 0":"50%",borderLeft:r?"none":""},onClick:()=>{i(!r)}},r?a.default.createElement(bO,null):a.default.createElement(mO,null))))},e.FormBuilder=function(e){const{className:t,layout:n,initialValues:r,form:o,formItems:s=[],onFinish:l,submitButton:c,buttonProps:u}=e;if(!o)return null;const h="vertical"===n?{padding:"0px 12px"}:{padding:"8px 12px"};return a.default.createElement(i.Form,{size:"small",form:o,style:h,layout:n,onFinish:l,className:t,initialValues:r,labelCol:"vertical"===n?{span:24}:{span:8},wrapperCol:"vertical"===n?{span:24}:{span:16}},s.map((e=>a.default.createElement(i.Form.Item,Object.assign({label:e.label,name:e.name,rules:e.rules},e.itemProps),a.default.createElement(e.render,e.renderProps)))),a.default.createElement(i.Form.Item,{wrapperCol:{offset:0,span:24}},c||a.default.createElement(i.Button,Object.assign({type:"primary",htmlType:"submit",style:{width:"100%"}},u),"执行命令")))},e.FormItemWrapper=nme,e.HookHub=SM,e.IApplicationContribution=nM,e.ICommandContextProvider=oM,e.ICommandHandler=iM,e.IGraphCommandContribution=aM,e.IGraphCommandFactory=sM,e.IGraphCommandService=rM,e.IGraphProvider=iT,e.IHookContribution=AM,e.IHookService=OM,e.IKeyBindingContribution=jne,e.IMenuContribution=xne,e.IMenuService=bne,e.IModelContribution=gM,e.IModelService=pM,e.IToolbarContribution=rne,e.IToolbarService=nne,e.IconStore=qne,e.JsonSchemaForm=wme,e.KeyBindings=e=>{const{config:t}=e,n=ZM(),r=a.default.useMemo((()=>t||new Xne),[t]);return a.default.useEffect((()=>{const e=n.addCoreModule({config:r,createModule:Vne});return r.setMountState(),()=>{e.dispose(),r.dispose()}}),[n,r]),null},e.KeybindingConfig=Xne,e.MODELS=GT,e.ManaSyringe=lr,e.MenuRegistry=Ane,e.NodeTreePanel=e=>{const t=oP("node-dnd-panel");return a.default.createElement(wge,Object.assign({},e,{className:t}),a.default.createElement(Kge,Object.assign({},e,{prefixClz:t})))},e.NsJsonSchemaForm=ume,e.NsNodeTreePanel=qge,e.RxModel=tM,e.ToolbarRegistry=yne,e.WorkspacePanel=wge,e.XFlow=Mne,e.XFlowAppContext=QO,e.XFlowAppExtensionMoudle=aP,e.XFlowAppProvider=rA,e.XFlowCanvas=xP,e.XFlowConfigProviderContext=iP,e.XFlowConstants=Q_,e.commandRegistryModule=fM,e.createCmdConfig=e=>t=>{const n=a.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const r=a.default.useMemo((()=>{const t=new AP;return e(t,n),t}),[n]);return r},e.createComponentModel=Nne,e.createCtxMenuConfig=e=>t=>{const n=a.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const r=a.default.useMemo((()=>{const t=new gre;return e(t,n),t}),[n]);return r},e.createGraphConfig=fA,e.createHookConfig=e=>t=>{const n=a.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const r=a.default.useMemo((()=>{const t=new PM;return e(t,n),t}),[n]);return r},e.createKeybindingConfig=e=>t=>{const n=a.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const r=a.default.useMemo((()=>{const t=new Xne;return e(t,n),t}),[n]);return r},e.createModelServiceConfig=e=>t=>{const n=a.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const r=a.default.useMemo((()=>{const t=new hT;return e(t,n),t}),[n]);return r},e.createToolbarConfig=sge,e.delay=Yne,e.executeJsonSchemaFormCommand=(t,n)=>{t.executeCommand(e.XFlowModelCommands.UPDATE_MODEL.id,{getModel:t=>vme(void 0,void 0,void 0,(function*(){return e.NsJsonSchemaFormModel.useModel(t)})),updateModel:n})},e.getNodeReactComponent=eT,e.insertCss=UM,e.randomInt=function(e,t){return Math.floor(Math.random()*(t-e)+e)},e.useAppContext=()=>a.default.useContext(QM),e.useExtensionRegistry=ZM,e.useIsMountedRef=Pne,e.useModel=Dne,e.useModelAsync=Rne,e.usePanelContext=xge,e.usePositionStyle=lP,e.useXFlowApp=eA,e.useXflowPrefixCls=oP,e.uuidv4=eS,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.js.map
